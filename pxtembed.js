/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved. 
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0  
 
THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE, 
MERCHANTABLITY OR NON-INFRINGEMENT. 
 
See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
"use strict";var __assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts;!function(e){!function(e){e[e.Unknown=0]="Unknown",e[e.EndOfFileToken=1]="EndOfFileToken",e[e.SingleLineCommentTrivia=2]="SingleLineCommentTrivia",e[e.MultiLineCommentTrivia=3]="MultiLineCommentTrivia",e[e.NewLineTrivia=4]="NewLineTrivia",e[e.WhitespaceTrivia=5]="WhitespaceTrivia",e[e.ShebangTrivia=6]="ShebangTrivia",e[e.ConflictMarkerTrivia=7]="ConflictMarkerTrivia",e[e.NumericLiteral=8]="NumericLiteral",e[e.StringLiteral=9]="StringLiteral",e[e.JsxText=10]="JsxText",e[e.JsxTextAllWhiteSpaces=11]="JsxTextAllWhiteSpaces",e[e.RegularExpressionLiteral=12]="RegularExpressionLiteral",e[e.NoSubstitutionTemplateLiteral=13]="NoSubstitutionTemplateLiteral",e[e.TemplateHead=14]="TemplateHead",e[e.TemplateMiddle=15]="TemplateMiddle",e[e.TemplateTail=16]="TemplateTail",e[e.OpenBraceToken=17]="OpenBraceToken",e[e.CloseBraceToken=18]="CloseBraceToken",e[e.OpenParenToken=19]="OpenParenToken",e[e.CloseParenToken=20]="CloseParenToken",e[e.OpenBracketToken=21]="OpenBracketToken",e[e.CloseBracketToken=22]="CloseBracketToken",e[e.DotToken=23]="DotToken",e[e.DotDotDotToken=24]="DotDotDotToken",e[e.SemicolonToken=25]="SemicolonToken",e[e.CommaToken=26]="CommaToken",e[e.LessThanToken=27]="LessThanToken",e[e.LessThanSlashToken=28]="LessThanSlashToken",e[e.GreaterThanToken=29]="GreaterThanToken",e[e.LessThanEqualsToken=30]="LessThanEqualsToken",e[e.GreaterThanEqualsToken=31]="GreaterThanEqualsToken",e[e.EqualsEqualsToken=32]="EqualsEqualsToken",e[e.ExclamationEqualsToken=33]="ExclamationEqualsToken",e[e.EqualsEqualsEqualsToken=34]="EqualsEqualsEqualsToken",e[e.ExclamationEqualsEqualsToken=35]="ExclamationEqualsEqualsToken",e[e.EqualsGreaterThanToken=36]="EqualsGreaterThanToken",e[e.PlusToken=37]="PlusToken",e[e.MinusToken=38]="MinusToken",e[e.AsteriskToken=39]="AsteriskToken",e[e.AsteriskAsteriskToken=40]="AsteriskAsteriskToken",e[e.SlashToken=41]="SlashToken",e[e.PercentToken=42]="PercentToken",e[e.PlusPlusToken=43]="PlusPlusToken",e[e.MinusMinusToken=44]="MinusMinusToken",e[e.LessThanLessThanToken=45]="LessThanLessThanToken",e[e.GreaterThanGreaterThanToken=46]="GreaterThanGreaterThanToken",e[e.GreaterThanGreaterThanGreaterThanToken=47]="GreaterThanGreaterThanGreaterThanToken",e[e.AmpersandToken=48]="AmpersandToken",e[e.BarToken=49]="BarToken",e[e.CaretToken=50]="CaretToken",e[e.ExclamationToken=51]="ExclamationToken",e[e.TildeToken=52]="TildeToken",e[e.AmpersandAmpersandToken=53]="AmpersandAmpersandToken",e[e.BarBarToken=54]="BarBarToken",e[e.QuestionToken=55]="QuestionToken",e[e.ColonToken=56]="ColonToken",e[e.AtToken=57]="AtToken",e[e.EqualsToken=58]="EqualsToken",e[e.PlusEqualsToken=59]="PlusEqualsToken",e[e.MinusEqualsToken=60]="MinusEqualsToken",e[e.AsteriskEqualsToken=61]="AsteriskEqualsToken",e[e.AsteriskAsteriskEqualsToken=62]="AsteriskAsteriskEqualsToken",e[e.SlashEqualsToken=63]="SlashEqualsToken",e[e.PercentEqualsToken=64]="PercentEqualsToken",e[e.LessThanLessThanEqualsToken=65]="LessThanLessThanEqualsToken",e[e.GreaterThanGreaterThanEqualsToken=66]="GreaterThanGreaterThanEqualsToken",e[e.GreaterThanGreaterThanGreaterThanEqualsToken=67]="GreaterThanGreaterThanGreaterThanEqualsToken",e[e.AmpersandEqualsToken=68]="AmpersandEqualsToken",e[e.BarEqualsToken=69]="BarEqualsToken",e[e.CaretEqualsToken=70]="CaretEqualsToken",e[e.Identifier=71]="Identifier",e[e.BreakKeyword=72]="BreakKeyword",e[e.CaseKeyword=73]="CaseKeyword",e[e.CatchKeyword=74]="CatchKeyword",e[e.ClassKeyword=75]="ClassKeyword",e[e.ConstKeyword=76]="ConstKeyword",e[e.ContinueKeyword=77]="ContinueKeyword",e[e.DebuggerKeyword=78]="DebuggerKeyword",e[e.DefaultKeyword=79]="DefaultKeyword",e[e.DeleteKeyword=80]="DeleteKeyword",e[e.DoKeyword=81]="DoKeyword",e[e.ElseKeyword=82]="ElseKeyword",e[e.EnumKeyword=83]="EnumKeyword",e[e.ExportKeyword=84]="ExportKeyword",e[e.ExtendsKeyword=85]="ExtendsKeyword",e[e.FalseKeyword=86]="FalseKeyword",e[e.FinallyKeyword=87]="FinallyKeyword",e[e.ForKeyword=88]="ForKeyword",e[e.FunctionKeyword=89]="FunctionKeyword",e[e.IfKeyword=90]="IfKeyword",e[e.ImportKeyword=91]="ImportKeyword",e[e.InKeyword=92]="InKeyword",e[e.InstanceOfKeyword=93]="InstanceOfKeyword",e[e.NewKeyword=94]="NewKeyword",e[e.NullKeyword=95]="NullKeyword",e[e.ReturnKeyword=96]="ReturnKeyword",e[e.SuperKeyword=97]="SuperKeyword",e[e.SwitchKeyword=98]="SwitchKeyword",e[e.ThisKeyword=99]="ThisKeyword",e[e.ThrowKeyword=100]="ThrowKeyword",e[e.TrueKeyword=101]="TrueKeyword",e[e.TryKeyword=102]="TryKeyword",e[e.TypeOfKeyword=103]="TypeOfKeyword",e[e.VarKeyword=104]="VarKeyword",e[e.VoidKeyword=105]="VoidKeyword",e[e.WhileKeyword=106]="WhileKeyword",e[e.WithKeyword=107]="WithKeyword",e[e.ImplementsKeyword=108]="ImplementsKeyword",e[e.InterfaceKeyword=109]="InterfaceKeyword",e[e.LetKeyword=110]="LetKeyword",e[e.PackageKeyword=111]="PackageKeyword",e[e.PrivateKeyword=112]="PrivateKeyword",e[e.ProtectedKeyword=113]="ProtectedKeyword",e[e.PublicKeyword=114]="PublicKeyword",e[e.StaticKeyword=115]="StaticKeyword",e[e.YieldKeyword=116]="YieldKeyword",e[e.AbstractKeyword=117]="AbstractKeyword",e[e.AsKeyword=118]="AsKeyword",e[e.AnyKeyword=119]="AnyKeyword",e[e.AsyncKeyword=120]="AsyncKeyword",e[e.AwaitKeyword=121]="AwaitKeyword",e[e.BooleanKeyword=122]="BooleanKeyword",e[e.ConstructorKeyword=123]="ConstructorKeyword",e[e.DeclareKeyword=124]="DeclareKeyword",e[e.GetKeyword=125]="GetKeyword",e[e.IsKeyword=126]="IsKeyword",e[e.KeyOfKeyword=127]="KeyOfKeyword",e[e.ModuleKeyword=128]="ModuleKeyword",e[e.NamespaceKeyword=129]="NamespaceKeyword",e[e.NeverKeyword=130]="NeverKeyword",e[e.ReadonlyKeyword=131]="ReadonlyKeyword",e[e.RequireKeyword=132]="RequireKeyword",e[e.NumberKeyword=133]="NumberKeyword",e[e.ObjectKeyword=134]="ObjectKeyword",e[e.SetKeyword=135]="SetKeyword",e[e.StringKeyword=136]="StringKeyword",e[e.SymbolKeyword=137]="SymbolKeyword",e[e.TypeKeyword=138]="TypeKeyword",e[e.UndefinedKeyword=139]="UndefinedKeyword",e[e.FromKeyword=140]="FromKeyword",e[e.GlobalKeyword=141]="GlobalKeyword",e[e.OfKeyword=142]="OfKeyword",e[e.QualifiedName=143]="QualifiedName",e[e.ComputedPropertyName=144]="ComputedPropertyName",e[e.TypeParameter=145]="TypeParameter",e[e.Parameter=146]="Parameter",e[e.Decorator=147]="Decorator",e[e.PropertySignature=148]="PropertySignature",e[e.PropertyDeclaration=149]="PropertyDeclaration",e[e.MethodSignature=150]="MethodSignature",e[e.MethodDeclaration=151]="MethodDeclaration",e[e.Constructor=152]="Constructor",e[e.GetAccessor=153]="GetAccessor",e[e.SetAccessor=154]="SetAccessor",e[e.CallSignature=155]="CallSignature",e[e.ConstructSignature=156]="ConstructSignature",e[e.IndexSignature=157]="IndexSignature",e[e.TypePredicate=158]="TypePredicate",e[e.TypeReference=159]="TypeReference",e[e.FunctionType=160]="FunctionType",e[e.ConstructorType=161]="ConstructorType",e[e.TypeQuery=162]="TypeQuery",e[e.TypeLiteral=163]="TypeLiteral",e[e.ArrayType=164]="ArrayType",e[e.TupleType=165]="TupleType",e[e.UnionType=166]="UnionType",e[e.IntersectionType=167]="IntersectionType",e[e.ParenthesizedType=168]="ParenthesizedType",e[e.ThisType=169]="ThisType",e[e.TypeOperator=170]="TypeOperator",e[e.IndexedAccessType=171]="IndexedAccessType",e[e.MappedType=172]="MappedType",e[e.LiteralType=173]="LiteralType",e[e.ObjectBindingPattern=174]="ObjectBindingPattern",e[e.ArrayBindingPattern=175]="ArrayBindingPattern",e[e.BindingElement=176]="BindingElement",e[e.ArrayLiteralExpression=177]="ArrayLiteralExpression",e[e.ObjectLiteralExpression=178]="ObjectLiteralExpression",e[e.PropertyAccessExpression=179]="PropertyAccessExpression",e[e.ElementAccessExpression=180]="ElementAccessExpression",e[e.CallExpression=181]="CallExpression",e[e.NewExpression=182]="NewExpression",e[e.TaggedTemplateExpression=183]="TaggedTemplateExpression",e[e.TypeAssertionExpression=184]="TypeAssertionExpression",e[e.ParenthesizedExpression=185]="ParenthesizedExpression",e[e.FunctionExpression=186]="FunctionExpression",e[e.ArrowFunction=187]="ArrowFunction",e[e.DeleteExpression=188]="DeleteExpression",e[e.TypeOfExpression=189]="TypeOfExpression",e[e.VoidExpression=190]="VoidExpression",e[e.AwaitExpression=191]="AwaitExpression",e[e.PrefixUnaryExpression=192]="PrefixUnaryExpression",e[e.PostfixUnaryExpression=193]="PostfixUnaryExpression",e[e.BinaryExpression=194]="BinaryExpression",e[e.ConditionalExpression=195]="ConditionalExpression",e[e.TemplateExpression=196]="TemplateExpression",e[e.YieldExpression=197]="YieldExpression",e[e.SpreadElement=198]="SpreadElement",e[e.ClassExpression=199]="ClassExpression",e[e.OmittedExpression=200]="OmittedExpression",e[e.ExpressionWithTypeArguments=201]="ExpressionWithTypeArguments",e[e.AsExpression=202]="AsExpression",e[e.NonNullExpression=203]="NonNullExpression",e[e.MetaProperty=204]="MetaProperty",e[e.TemplateSpan=205]="TemplateSpan",e[e.SemicolonClassElement=206]="SemicolonClassElement",e[e.Block=207]="Block",e[e.VariableStatement=208]="VariableStatement",e[e.EmptyStatement=209]="EmptyStatement",e[e.ExpressionStatement=210]="ExpressionStatement",e[e.IfStatement=211]="IfStatement",e[e.DoStatement=212]="DoStatement",e[e.WhileStatement=213]="WhileStatement",e[e.ForStatement=214]="ForStatement",e[e.ForInStatement=215]="ForInStatement",e[e.ForOfStatement=216]="ForOfStatement",e[e.ContinueStatement=217]="ContinueStatement",e[e.BreakStatement=218]="BreakStatement",e[e.ReturnStatement=219]="ReturnStatement",e[e.WithStatement=220]="WithStatement",e[e.SwitchStatement=221]="SwitchStatement",e[e.LabeledStatement=222]="LabeledStatement",e[e.ThrowStatement=223]="ThrowStatement",e[e.TryStatement=224]="TryStatement",e[e.DebuggerStatement=225]="DebuggerStatement",e[e.VariableDeclaration=226]="VariableDeclaration",e[e.VariableDeclarationList=227]="VariableDeclarationList",e[e.FunctionDeclaration=228]="FunctionDeclaration",e[e.ClassDeclaration=229]="ClassDeclaration",e[e.InterfaceDeclaration=230]="InterfaceDeclaration",e[e.TypeAliasDeclaration=231]="TypeAliasDeclaration",e[e.EnumDeclaration=232]="EnumDeclaration",e[e.ModuleDeclaration=233]="ModuleDeclaration",e[e.ModuleBlock=234]="ModuleBlock",e[e.CaseBlock=235]="CaseBlock",e[e.NamespaceExportDeclaration=236]="NamespaceExportDeclaration",e[e.ImportEqualsDeclaration=237]="ImportEqualsDeclaration",e[e.ImportDeclaration=238]="ImportDeclaration",e[e.ImportClause=239]="ImportClause",e[e.NamespaceImport=240]="NamespaceImport",e[e.NamedImports=241]="NamedImports",e[e.ImportSpecifier=242]="ImportSpecifier",e[e.ExportAssignment=243]="ExportAssignment",e[e.ExportDeclaration=244]="ExportDeclaration",e[e.NamedExports=245]="NamedExports",e[e.ExportSpecifier=246]="ExportSpecifier",e[e.MissingDeclaration=247]="MissingDeclaration",e[e.ExternalModuleReference=248]="ExternalModuleReference",e[e.JsxElement=249]="JsxElement",e[e.JsxSelfClosingElement=250]="JsxSelfClosingElement",e[e.JsxOpeningElement=251]="JsxOpeningElement",e[e.JsxClosingElement=252]="JsxClosingElement",e[e.JsxAttribute=253]="JsxAttribute",e[e.JsxAttributes=254]="JsxAttributes",e[e.JsxSpreadAttribute=255]="JsxSpreadAttribute",e[e.JsxExpression=256]="JsxExpression",e[e.CaseClause=257]="CaseClause",e[e.DefaultClause=258]="DefaultClause",e[e.HeritageClause=259]="HeritageClause",e[e.CatchClause=260]="CatchClause",e[e.PropertyAssignment=261]="PropertyAssignment",e[e.ShorthandPropertyAssignment=262]="ShorthandPropertyAssignment",e[e.SpreadAssignment=263]="SpreadAssignment",e[e.EnumMember=264]="EnumMember",e[e.SourceFile=265]="SourceFile",e[e.Bundle=266]="Bundle",e[e.JSDocTypeExpression=267]="JSDocTypeExpression",e[e.JSDocAllType=268]="JSDocAllType",e[e.JSDocUnknownType=269]="JSDocUnknownType",e[e.JSDocNullableType=270]="JSDocNullableType",e[e.JSDocNonNullableType=271]="JSDocNonNullableType",e[e.JSDocOptionalType=272]="JSDocOptionalType",e[e.JSDocFunctionType=273]="JSDocFunctionType",e[e.JSDocVariadicType=274]="JSDocVariadicType",e[e.JSDocComment=275]="JSDocComment",e[e.JSDocTag=276]="JSDocTag",e[e.JSDocAugmentsTag=277]="JSDocAugmentsTag",e[e.JSDocClassTag=278]="JSDocClassTag",e[e.JSDocParameterTag=279]="JSDocParameterTag",e[e.JSDocReturnTag=280]="JSDocReturnTag",e[e.JSDocTypeTag=281]="JSDocTypeTag",e[e.JSDocTemplateTag=282]="JSDocTemplateTag",e[e.JSDocTypedefTag=283]="JSDocTypedefTag",e[e.JSDocPropertyTag=284]="JSDocPropertyTag",e[e.JSDocTypeLiteral=285]="JSDocTypeLiteral",e[e.SyntaxList=286]="SyntaxList",e[e.NotEmittedStatement=287]="NotEmittedStatement",e[e.PartiallyEmittedExpression=288]="PartiallyEmittedExpression",e[e.CommaListExpression=289]="CommaListExpression",e[e.MergeDeclarationMarker=290]="MergeDeclarationMarker",e[e.EndOfDeclarationMarker=291]="EndOfDeclarationMarker",e[e.Count=292]="Count",e[e.FirstAssignment=58]="FirstAssignment",e[e.LastAssignment=70]="LastAssignment",e[e.FirstCompoundAssignment=59]="FirstCompoundAssignment",e[e.LastCompoundAssignment=70]="LastCompoundAssignment",e[e.FirstReservedWord=72]="FirstReservedWord",e[e.LastReservedWord=107]="LastReservedWord",e[e.FirstKeyword=72]="FirstKeyword",e[e.LastKeyword=142]="LastKeyword",e[e.FirstFutureReservedWord=108]="FirstFutureReservedWord",e[e.LastFutureReservedWord=116]="LastFutureReservedWord",e[e.FirstTypeNode=158]="FirstTypeNode",e[e.LastTypeNode=173]="LastTypeNode",e[e.FirstPunctuation=17]="FirstPunctuation",e[e.LastPunctuation=70]="LastPunctuation",e[e.FirstToken=0]="FirstToken",e[e.LastToken=142]="LastToken",e[e.FirstTriviaToken=2]="FirstTriviaToken",e[e.LastTriviaToken=7]="LastTriviaToken",e[e.FirstLiteralToken=8]="FirstLiteralToken",e[e.LastLiteralToken=13]="LastLiteralToken",e[e.FirstTemplateToken=13]="FirstTemplateToken",e[e.LastTemplateToken=16]="LastTemplateToken",e[e.FirstBinaryOperator=27]="FirstBinaryOperator",e[e.LastBinaryOperator=70]="LastBinaryOperator",e[e.FirstNode=143]="FirstNode",e[e.FirstJSDocNode=267]="FirstJSDocNode",e[e.LastJSDocNode=285]="LastJSDocNode",e[e.FirstJSDocTagNode=276]="FirstJSDocTagNode",e[e.LastJSDocTagNode=285]="LastJSDocTagNode"}(e.SyntaxKind||(e.SyntaxKind={})),function(e){e[e.None=0]="None",e[e.Let=1]="Let",e[e.Const=2]="Const",e[e.NestedNamespace=4]="NestedNamespace",e[e.Synthesized=8]="Synthesized",e[e.Namespace=16]="Namespace",e[e.ExportContext=32]="ExportContext",e[e.ContainsThis=64]="ContainsThis",e[e.HasImplicitReturn=128]="HasImplicitReturn",e[e.HasExplicitReturn=256]="HasExplicitReturn",e[e.GlobalAugmentation=512]="GlobalAugmentation",e[e.HasAsyncFunctions=1024]="HasAsyncFunctions",e[e.DisallowInContext=2048]="DisallowInContext",e[e.YieldContext=4096]="YieldContext",e[e.DecoratorContext=8192]="DecoratorContext",e[e.AwaitContext=16384]="AwaitContext",e[e.ThisNodeHasError=32768]="ThisNodeHasError",e[e.JavaScriptFile=65536]="JavaScriptFile",e[e.ThisNodeOrAnySubNodesHasError=131072]="ThisNodeOrAnySubNodesHasError",e[e.HasAggregatedChildData=262144]="HasAggregatedChildData",e[e.PossiblyContainsDynamicImport=524288]="PossiblyContainsDynamicImport",e[e.JSDoc=1048576]="JSDoc",e[e.BlockScoped=3]="BlockScoped",e[e.ReachabilityCheckFlags=384]="ReachabilityCheckFlags",e[e.ReachabilityAndEmitFlags=1408]="ReachabilityAndEmitFlags",e[e.ContextFlags=96256]="ContextFlags",e[e.TypeExcludesFlags=20480]="TypeExcludesFlags"}(e.NodeFlags||(e.NodeFlags={})),function(e){e[e.None=0]="None",e[e.Export=1]="Export",e[e.Ambient=2]="Ambient",e[e.Public=4]="Public",e[e.Private=8]="Private",e[e.Protected=16]="Protected",e[e.Static=32]="Static",e[e.Readonly=64]="Readonly",e[e.Abstract=128]="Abstract",e[e.Async=256]="Async",e[e.Default=512]="Default",e[e.Const=2048]="Const",e[e.HasComputedFlags=536870912]="HasComputedFlags",e[e.AccessibilityModifier=28]="AccessibilityModifier",e[e.ParameterPropertyModifier=92]="ParameterPropertyModifier",e[e.NonPublicAccessibilityModifier=24]="NonPublicAccessibilityModifier",e[e.TypeScriptModifier=2270]="TypeScriptModifier",e[e.ExportDefault=513]="ExportDefault"}(e.ModifierFlags||(e.ModifierFlags={})),function(e){e[e.None=0]="None",e[e.IntrinsicNamedElement=1]="IntrinsicNamedElement",e[e.IntrinsicIndexedElement=2]="IntrinsicIndexedElement",e[e.IntrinsicElement=3]="IntrinsicElement"}(e.JsxFlags||(e.JsxFlags={})),function(e){e[e.Succeeded=1]="Succeeded",e[e.Failed=2]="Failed",e[e.FailedAndReported=3]="FailedAndReported"}(e.RelationComparisonResult||(e.RelationComparisonResult={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Loop=2]="Loop",e[e.Unique=3]="Unique",e[e.Node=4]="Node"}(e.GeneratedIdentifierKind||(e.GeneratedIdentifierKind={})),function(e){e[e.None=0]="None",e[e.Scientific=2]="Scientific",e[e.Octal=4]="Octal",e[e.HexSpecifier=8]="HexSpecifier",e[e.BinarySpecifier=16]="BinarySpecifier",e[e.OctalSpecifier=32]="OctalSpecifier",e[e.BinaryOrOctalSpecifier=48]="BinaryOrOctalSpecifier"}(e.NumericLiteralFlags||(e.NumericLiteralFlags={})),function(e){e[e.Unreachable=1]="Unreachable",e[e.Start=2]="Start",e[e.BranchLabel=4]="BranchLabel",e[e.LoopLabel=8]="LoopLabel",e[e.Assignment=16]="Assignment",e[e.TrueCondition=32]="TrueCondition",e[e.FalseCondition=64]="FalseCondition",e[e.SwitchClause=128]="SwitchClause",e[e.ArrayMutation=256]="ArrayMutation",e[e.Referenced=512]="Referenced",e[e.Shared=1024]="Shared",e[e.PreFinally=2048]="PreFinally",e[e.AfterFinally=4096]="AfterFinally",e[e.Label=12]="Label",e[e.Condition=96]="Condition"}(e.FlowFlags||(e.FlowFlags={}));var t=function(){};e.OperationCanceledException=t,function(e){e[e.Not=0]="Not",e[e.SafeModules=1]="SafeModules",e[e.Completely=2]="Completely"}(e.StructureIsReused||(e.StructureIsReused={})),function(e){e[e.Success=0]="Success",e[e.DiagnosticsPresent_OutputsSkipped=1]="DiagnosticsPresent_OutputsSkipped",e[e.DiagnosticsPresent_OutputsGenerated=2]="DiagnosticsPresent_OutputsGenerated"}(e.ExitStatus||(e.ExitStatus={})),function(e){e[e.None=0]="None",e[e.NoTruncation=1]="NoTruncation",e[e.WriteArrayAsGenericType=2]="WriteArrayAsGenericType",e[e.WriteTypeArgumentsOfSignature=32]="WriteTypeArgumentsOfSignature",e[e.UseFullyQualifiedType=64]="UseFullyQualifiedType",e[e.SuppressAnyReturnType=256]="SuppressAnyReturnType",e[e.WriteTypeParametersInQualifiedName=512]="WriteTypeParametersInQualifiedName",e[e.AllowThisInObjectLiteral=1024]="AllowThisInObjectLiteral",e[e.AllowQualifedNameInPlaceOfIdentifier=2048]="AllowQualifedNameInPlaceOfIdentifier",e[e.AllowAnonymousIdentifier=8192]="AllowAnonymousIdentifier",e[e.AllowEmptyUnionOrIntersection=16384]="AllowEmptyUnionOrIntersection",e[e.AllowEmptyTuple=32768]="AllowEmptyTuple",e[e.IgnoreErrors=60416]="IgnoreErrors",e[e.InObjectTypeLiteral=1048576]="InObjectTypeLiteral",e[e.InTypeAlias=8388608]="InTypeAlias"}(e.NodeBuilderFlags||(e.NodeBuilderFlags={})),function(e){e[e.None=0]="None",e[e.WriteArrayAsGenericType=1]="WriteArrayAsGenericType",e[e.UseTypeOfFunction=4]="UseTypeOfFunction",e[e.NoTruncation=8]="NoTruncation",e[e.WriteArrowStyleSignature=16]="WriteArrowStyleSignature",e[e.WriteOwnNameForAnyLike=32]="WriteOwnNameForAnyLike",e[e.WriteTypeArgumentsOfSignature=64]="WriteTypeArgumentsOfSignature",e[e.InElementType=128]="InElementType",e[e.UseFullyQualifiedType=256]="UseFullyQualifiedType",e[e.InFirstTypeArgument=512]="InFirstTypeArgument",e[e.InTypeAlias=1024]="InTypeAlias",e[e.SuppressAnyReturnType=4096]="SuppressAnyReturnType",e[e.AddUndefined=8192]="AddUndefined",e[e.WriteClassExpressionAsTypeLiteral=16384]="WriteClassExpressionAsTypeLiteral",e[e.InArrayType=32768]="InArrayType",e[e.UseAliasDefinedOutsideCurrentScope=65536]="UseAliasDefinedOutsideCurrentScope"}(e.TypeFormatFlags||(e.TypeFormatFlags={})),function(e){e[e.None=0]="None",e[e.WriteTypeParametersOrArguments=1]="WriteTypeParametersOrArguments",e[e.UseOnlyExternalAliasing=2]="UseOnlyExternalAliasing"}(e.SymbolFormatFlags||(e.SymbolFormatFlags={})),function(e){e[e.Accessible=0]="Accessible",e[e.NotAccessible=1]="NotAccessible",e[e.CannotBeNamed=2]="CannotBeNamed"}(e.SymbolAccessibility||(e.SymbolAccessibility={})),function(e){e[e.UnionOrIntersection=0]="UnionOrIntersection",e[e.Spread=1]="Spread"}(e.SyntheticSymbolKind||(e.SyntheticSymbolKind={})),function(e){e[e.This=0]="This",e[e.Identifier=1]="Identifier"}(e.TypePredicateKind||(e.TypePredicateKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.TypeWithConstructSignatureAndValue=1]="TypeWithConstructSignatureAndValue",e[e.VoidNullableOrNeverType=2]="VoidNullableOrNeverType",e[e.NumberLikeType=3]="NumberLikeType",e[e.StringLikeType=4]="StringLikeType",e[e.BooleanType=5]="BooleanType",e[e.ArrayLikeType=6]="ArrayLikeType",e[e.ESSymbolType=7]="ESSymbolType",e[e.Promise=8]="Promise",e[e.TypeWithCallSignature=9]="TypeWithCallSignature",e[e.ObjectType=10]="ObjectType"}(e.TypeReferenceSerializationKind||(e.TypeReferenceSerializationKind={})),function(e){e[e.None=0]="None",e[e.FunctionScopedVariable=1]="FunctionScopedVariable",e[e.BlockScopedVariable=2]="BlockScopedVariable",e[e.Property=4]="Property",e[e.EnumMember=8]="EnumMember",e[e.Function=16]="Function",e[e.Class=32]="Class",e[e.Interface=64]="Interface",e[e.ConstEnum=128]="ConstEnum",e[e.RegularEnum=256]="RegularEnum",e[e.ValueModule=512]="ValueModule",e[e.NamespaceModule=1024]="NamespaceModule",e[e.TypeLiteral=2048]="TypeLiteral",e[e.ObjectLiteral=4096]="ObjectLiteral",e[e.Method=8192]="Method",e[e.Constructor=16384]="Constructor",e[e.GetAccessor=32768]="GetAccessor",e[e.SetAccessor=65536]="SetAccessor",e[e.Signature=131072]="Signature",e[e.TypeParameter=262144]="TypeParameter",e[e.TypeAlias=524288]="TypeAlias",e[e.ExportValue=1048576]="ExportValue",e[e.Alias=2097152]="Alias",e[e.Prototype=4194304]="Prototype",e[e.ExportStar=8388608]="ExportStar",e[e.Optional=16777216]="Optional",e[e.Transient=33554432]="Transient",e[e.Enum=384]="Enum",e[e.Variable=3]="Variable",e[e.Value=107455]="Value",e[e.Type=793064]="Type",e[e.Namespace=1920]="Namespace",e[e.Module=1536]="Module",e[e.Accessor=98304]="Accessor",e[e.FunctionScopedVariableExcludes=107454]="FunctionScopedVariableExcludes",e[e.BlockScopedVariableExcludes=107455]="BlockScopedVariableExcludes",e[e.ParameterExcludes=107455]="ParameterExcludes",e[e.PropertyExcludes=0]="PropertyExcludes",e[e.EnumMemberExcludes=900095]="EnumMemberExcludes",e[e.FunctionExcludes=106927]="FunctionExcludes",e[e.ClassExcludes=899519]="ClassExcludes",e[e.InterfaceExcludes=792968]="InterfaceExcludes",e[e.RegularEnumExcludes=899327]="RegularEnumExcludes",e[e.ConstEnumExcludes=899967]="ConstEnumExcludes",e[e.ValueModuleExcludes=106639]="ValueModuleExcludes",e[e.NamespaceModuleExcludes=0]="NamespaceModuleExcludes",e[e.MethodExcludes=99263]="MethodExcludes",e[e.GetAccessorExcludes=41919]="GetAccessorExcludes",e[e.SetAccessorExcludes=74687]="SetAccessorExcludes",e[e.TypeParameterExcludes=530920]="TypeParameterExcludes",e[e.TypeAliasExcludes=793064]="TypeAliasExcludes",e[e.AliasExcludes=2097152]="AliasExcludes",e[e.ModuleMember=2623475]="ModuleMember",e[e.ExportHasLocal=944]="ExportHasLocal",e[e.HasExports=1952]="HasExports",e[e.HasMembers=6240]="HasMembers",e[e.BlockScoped=418]="BlockScoped",e[e.PropertyOrAccessor=98308]="PropertyOrAccessor",e[e.ClassMember=106500]="ClassMember",e[e.Classifiable=788448]="Classifiable"}(e.SymbolFlags||(e.SymbolFlags={})),function(e){e[e.Numeric=0]="Numeric",e[e.Literal=1]="Literal"}(e.EnumKind||(e.EnumKind={})),function(e){e[e.Instantiated=1]="Instantiated",e[e.SyntheticProperty=2]="SyntheticProperty",e[e.SyntheticMethod=4]="SyntheticMethod",e[e.Readonly=8]="Readonly",e[e.Partial=16]="Partial",e[e.HasNonUniformType=32]="HasNonUniformType",e[e.ContainsPublic=64]="ContainsPublic",e[e.ContainsProtected=128]="ContainsProtected",e[e.ContainsPrivate=256]="ContainsPrivate",e[e.ContainsStatic=512]="ContainsStatic",e[e.Synthetic=6]="Synthetic"}(e.CheckFlags||(e.CheckFlags={})),function(e){e.Call="__call",e.Constructor="__constructor",e.New="__new",e.Index="__index",e.ExportStar="__export",e.Global="__global",e.Missing="__missing",e.Type="__type",e.Object="__object",e.JSXAttributes="__jsxAttributes",e.Class="__class",e.Function="__function",e.Computed="__computed",e.Resolving="__resolving__",e.ExportEquals="export=",e.Default="default"}(e.InternalSymbolName||(e.InternalSymbolName={})),function(e){e[e.TypeChecked=1]="TypeChecked",e[e.LexicalThis=2]="LexicalThis",e[e.CaptureThis=4]="CaptureThis",e[e.CaptureNewTarget=8]="CaptureNewTarget",e[e.SuperInstance=256]="SuperInstance",e[e.SuperStatic=512]="SuperStatic",e[e.ContextChecked=1024]="ContextChecked",e[e.AsyncMethodWithSuper=2048]="AsyncMethodWithSuper",e[e.AsyncMethodWithSuperBinding=4096]="AsyncMethodWithSuperBinding",e[e.CaptureArguments=8192]="CaptureArguments",e[e.EnumValuesComputed=16384]="EnumValuesComputed",e[e.LexicalModuleMergesWithClass=32768]="LexicalModuleMergesWithClass",e[e.LoopWithCapturedBlockScopedBinding=65536]="LoopWithCapturedBlockScopedBinding",e[e.CapturedBlockScopedBinding=131072]="CapturedBlockScopedBinding",e[e.BlockScopedBindingInLoop=262144]="BlockScopedBindingInLoop",e[e.ClassWithBodyScopedClassBinding=524288]="ClassWithBodyScopedClassBinding",e[e.BodyScopedClassBinding=1048576]="BodyScopedClassBinding",e[e.NeedsLoopOutParameter=2097152]="NeedsLoopOutParameter",e[e.AssignmentsMarked=4194304]="AssignmentsMarked",e[e.ClassWithConstructorReference=8388608]="ClassWithConstructorReference",e[e.ConstructorReferenceInClass=16777216]="ConstructorReferenceInClass"}(e.NodeCheckFlags||(e.NodeCheckFlags={})),function(e){e[e.Any=1]="Any",e[e.String=2]="String",e[e.Number=4]="Number",e[e.Boolean=8]="Boolean",e[e.Enum=16]="Enum",e[e.StringLiteral=32]="StringLiteral",e[e.NumberLiteral=64]="NumberLiteral",e[e.BooleanLiteral=128]="BooleanLiteral",e[e.EnumLiteral=256]="EnumLiteral",e[e.ESSymbol=512]="ESSymbol",e[e.Void=1024]="Void",e[e.Undefined=2048]="Undefined",e[e.Null=4096]="Null",e[e.Never=8192]="Never",e[e.TypeParameter=16384]="TypeParameter",e[e.Object=32768]="Object",e[e.Union=65536]="Union",e[e.Intersection=131072]="Intersection",e[e.Index=262144]="Index",e[e.IndexedAccess=524288]="IndexedAccess",e[e.FreshLiteral=1048576]="FreshLiteral",e[e.ContainsWideningType=2097152]="ContainsWideningType",e[e.ContainsObjectLiteral=4194304]="ContainsObjectLiteral",e[e.ContainsAnyFunctionType=8388608]="ContainsAnyFunctionType",e[e.NonPrimitive=16777216]="NonPrimitive",e[e.JsxAttributes=33554432]="JsxAttributes",e[e.MarkerType=67108864]="MarkerType",e[e.Nullable=6144]="Nullable",e[e.Literal=224]="Literal",e[e.Unit=6368]="Unit",e[e.StringOrNumberLiteral=96]="StringOrNumberLiteral",e[e.DefinitelyFalsy=7392]="DefinitelyFalsy",e[e.PossiblyFalsy=7406]="PossiblyFalsy",e[e.Intrinsic=16793231]="Intrinsic",e[e.Primitive=8190]="Primitive",e[e.StringLike=262178]="StringLike",e[e.NumberLike=84]="NumberLike",e[e.BooleanLike=136]="BooleanLike",e[e.EnumLike=272]="EnumLike",e[e.UnionOrIntersection=196608]="UnionOrIntersection",e[e.StructuredType=229376]="StructuredType",e[e.StructuredOrTypeVariable=1032192]="StructuredOrTypeVariable",e[e.TypeVariable=540672]="TypeVariable",e[e.Narrowable=17810175]="Narrowable",e[e.NotUnionOrUnit=16810497]="NotUnionOrUnit",e[e.RequiresWidening=6291456]="RequiresWidening",e[e.PropagatingFlags=14680064]="PropagatingFlags"}(e.TypeFlags||(e.TypeFlags={})),function(e){e[e.Class=1]="Class",e[e.Interface=2]="Interface",e[e.Reference=4]="Reference",e[e.Tuple=8]="Tuple",e[e.Anonymous=16]="Anonymous",e[e.Mapped=32]="Mapped",e[e.Instantiated=64]="Instantiated",e[e.ObjectLiteral=128]="ObjectLiteral",e[e.EvolvingArray=256]="EvolvingArray",e[e.ObjectLiteralPatternWithComputedProperties=512]="ObjectLiteralPatternWithComputedProperties",e[e.ClassOrInterface=3]="ClassOrInterface"}(e.ObjectFlags||(e.ObjectFlags={})),function(e){e[e.Invariant=0]="Invariant",e[e.Covariant=1]="Covariant",e[e.Contravariant=2]="Contravariant",e[e.Bivariant=3]="Bivariant",e[e.Independent=4]="Independent"}(e.Variance||(e.Variance={})),function(e){e[e.Call=0]="Call",e[e.Construct=1]="Construct"}(e.SignatureKind||(e.SignatureKind={})),function(e){e[e.String=0]="String",e[e.Number=1]="Number"}(e.IndexKind||(e.IndexKind={})),function(e){e[e.Contravariant=1]="Contravariant",e[e.NakedTypeVariable=2]="NakedTypeVariable",e[e.MappedType=4]="MappedType",e[e.ReturnType=8]="ReturnType"}(e.InferencePriority||(e.InferencePriority={})),function(e){e[e.InferUnionTypes=1]="InferUnionTypes",e[e.NoDefault=2]="NoDefault",e[e.AnyDefault=4]="AnyDefault"}(e.InferenceFlags||(e.InferenceFlags={})),function(e){e[e.False=0]="False",e[e.Maybe=1]="Maybe",e[e.True=-1]="True"}(e.Ternary||(e.Ternary={})),function(e){e[e.None=0]="None",e[e.ExportsProperty=1]="ExportsProperty",e[e.ModuleExports=2]="ModuleExports",e[e.PrototypeProperty=3]="PrototypeProperty",e[e.ThisProperty=4]="ThisProperty",e[e.Property=5]="Property"}(e.SpecialPropertyAssignmentKind||(e.SpecialPropertyAssignmentKind={})),function(e){e[e.Warning=0]="Warning",e[e.Error=1]="Error",e[e.Message=2]="Message"}(e.DiagnosticCategory||(e.DiagnosticCategory={})),function(e){e[e.Classic=1]="Classic",e[e.NodeJs=2]="NodeJs"}(e.ModuleResolutionKind||(e.ModuleResolutionKind={})),function(e){e[e.None=0]="None",e[e.CommonJS=1]="CommonJS",e[e.AMD=2]="AMD",e[e.UMD=3]="UMD",e[e.System=4]="System",e[e.ES2015=5]="ES2015",e[e.ESNext=6]="ESNext"}(e.ModuleKind||(e.ModuleKind={})),function(e){e[e.None=0]="None",e[e.Preserve=1]="Preserve",e[e.React=2]="React",e[e.ReactNative=3]="ReactNative"}(e.JsxEmit||(e.JsxEmit={})),function(e){e[e.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",e[e.LineFeed=1]="LineFeed"}(e.NewLineKind||(e.NewLineKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.JS=1]="JS",e[e.JSX=2]="JSX",e[e.TS=3]="TS",e[e.TSX=4]="TSX",e[e.External=5]="External",e[e.JSON=6]="JSON"}(e.ScriptKind||(e.ScriptKind={})),function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES2015=2]="ES2015",e[e.ES2016=3]="ES2016",e[e.ES2017=4]="ES2017",e[e.ESNext=5]="ESNext",e[e.Latest=5]="Latest"}(e.ScriptTarget||(e.ScriptTarget={})),function(e){e[e.Standard=0]="Standard",e[e.JSX=1]="JSX"}(e.LanguageVariant||(e.LanguageVariant={})),function(e){e[e.Simple=0]="Simple",e[e.Pretty=1]="Pretty"}(e.DiagnosticStyle||(e.DiagnosticStyle={})),function(e){e[e.None=0]="None",e[e.Recursive=1]="Recursive"}(e.WatchDirectoryFlags||(e.WatchDirectoryFlags={})),function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.backtick=96]="backtick",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.hash=35]="hash",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"}(e.CharacterCodes||(e.CharacterCodes={})),function(e){e.Ts=".ts",e.Tsx=".tsx",e.Dts=".d.ts",e.Js=".js",e.Jsx=".jsx",e.Json=".json"}(e.Extension||(e.Extension={})),function(e){e[e.None=0]="None",e[e.TypeScript=1]="TypeScript",e[e.ContainsTypeScript=2]="ContainsTypeScript",e[e.ContainsJsx=4]="ContainsJsx",e[e.ContainsESNext=8]="ContainsESNext",e[e.ContainsES2017=16]="ContainsES2017",e[e.ContainsES2016=32]="ContainsES2016",e[e.ES2015=64]="ES2015",e[e.ContainsES2015=128]="ContainsES2015",e[e.Generator=256]="Generator",e[e.ContainsGenerator=512]="ContainsGenerator",e[e.DestructuringAssignment=1024]="DestructuringAssignment",e[e.ContainsDestructuringAssignment=2048]="ContainsDestructuringAssignment",e[e.ContainsDecorators=4096]="ContainsDecorators",e[e.ContainsPropertyInitializer=8192]="ContainsPropertyInitializer",e[e.ContainsLexicalThis=16384]="ContainsLexicalThis",e[e.ContainsCapturedLexicalThis=32768]="ContainsCapturedLexicalThis",e[e.ContainsLexicalThisInComputedPropertyName=65536]="ContainsLexicalThisInComputedPropertyName",e[e.ContainsDefaultValueAssignments=131072]="ContainsDefaultValueAssignments",e[e.ContainsParameterPropertyAssignments=262144]="ContainsParameterPropertyAssignments",e[e.ContainsSpread=524288]="ContainsSpread",e[e.ContainsObjectSpread=1048576]="ContainsObjectSpread",e[e.ContainsRest=524288]="ContainsRest",e[e.ContainsObjectRest=1048576]="ContainsObjectRest",e[e.ContainsComputedPropertyName=2097152]="ContainsComputedPropertyName",e[e.ContainsBlockScopedBinding=4194304]="ContainsBlockScopedBinding",e[e.ContainsBindingPattern=8388608]="ContainsBindingPattern",e[e.ContainsYield=16777216]="ContainsYield",e[e.ContainsHoistedDeclarationOrCompletion=33554432]="ContainsHoistedDeclarationOrCompletion",e[e.ContainsDynamicImport=67108864]="ContainsDynamicImport",e[e.HasComputedFlags=536870912]="HasComputedFlags",e[e.AssertTypeScript=3]="AssertTypeScript",e[e.AssertJsx=4]="AssertJsx",e[e.AssertESNext=8]="AssertESNext",e[e.AssertES2017=16]="AssertES2017",e[e.AssertES2016=32]="AssertES2016",e[e.AssertES2015=192]="AssertES2015",e[e.AssertGenerator=768]="AssertGenerator",e[e.AssertDestructuringAssignment=3072]="AssertDestructuringAssignment",e[e.NodeExcludes=536872257]="NodeExcludes",e[e.ArrowFunctionExcludes=601249089]="ArrowFunctionExcludes",e[e.FunctionExcludes=601281857]="FunctionExcludes",e[e.ConstructorExcludes=601015617]="ConstructorExcludes",e[e.MethodOrAccessorExcludes=601015617]="MethodOrAccessorExcludes",e[e.ClassExcludes=539358529]="ClassExcludes",e[e.ModuleExcludes=574674241]="ModuleExcludes",e[e.TypeExcludes=-3]="TypeExcludes",e[e.ObjectLiteralExcludes=540087617]="ObjectLiteralExcludes",e[e.ArrayLiteralOrCallOrNewExcludes=537396545]="ArrayLiteralOrCallOrNewExcludes",e[e.VariableDeclarationListExcludes=546309441]="VariableDeclarationListExcludes",e[e.ParameterExcludes=536872257]="ParameterExcludes",e[e.CatchClauseExcludes=537920833]="CatchClauseExcludes",e[e.BindingPatternExcludes=537396545]="BindingPatternExcludes",e[e.TypeScriptClassSyntaxMask=274432]="TypeScriptClassSyntaxMask",e[e.ES2015FunctionSyntaxMask=163840]="ES2015FunctionSyntaxMask"}(e.TransformFlags||(e.TransformFlags={})),function(e){e[e.SingleLine=1]="SingleLine",e[e.AdviseOnEmitNode=2]="AdviseOnEmitNode",e[e.NoSubstitution=4]="NoSubstitution",e[e.CapturesThis=8]="CapturesThis",e[e.NoLeadingSourceMap=16]="NoLeadingSourceMap",e[e.NoTrailingSourceMap=32]="NoTrailingSourceMap",e[e.NoSourceMap=48]="NoSourceMap",e[e.NoNestedSourceMaps=64]="NoNestedSourceMaps",e[e.NoTokenLeadingSourceMaps=128]="NoTokenLeadingSourceMaps",e[e.NoTokenTrailingSourceMaps=256]="NoTokenTrailingSourceMaps",e[e.NoTokenSourceMaps=384]="NoTokenSourceMaps",e[e.NoLeadingComments=512]="NoLeadingComments",e[e.NoTrailingComments=1024]="NoTrailingComments",e[e.NoComments=1536]="NoComments",e[e.NoNestedComments=2048]="NoNestedComments",e[e.HelperName=4096]="HelperName",e[e.ExportName=8192]="ExportName",e[e.LocalName=16384]="LocalName",e[e.InternalName=32768]="InternalName",e[e.Indented=65536]="Indented",e[e.NoIndentation=131072]="NoIndentation",e[e.AsyncFunctionBody=262144]="AsyncFunctionBody",e[e.ReuseTempVariableScope=524288]="ReuseTempVariableScope",e[e.CustomPrologue=1048576]="CustomPrologue",e[e.NoHoisting=2097152]="NoHoisting",e[e.HasEndOfDeclarationMarker=4194304]="HasEndOfDeclarationMarker",e[e.Iterator=8388608]="Iterator",e[e.NoAsciiEscaping=16777216]="NoAsciiEscaping",e[e.TypeScriptClassWrapper=33554432]="TypeScriptClassWrapper"}(e.EmitFlags||(e.EmitFlags={})),function(e){e[e.Extends=1]="Extends",e[e.Assign=2]="Assign",e[e.Rest=4]="Rest",e[e.Decorate=8]="Decorate",e[e.Metadata=16]="Metadata",e[e.Param=32]="Param",e[e.Awaiter=64]="Awaiter",e[e.Generator=128]="Generator",e[e.Values=256]="Values",e[e.Read=512]="Read",e[e.Spread=1024]="Spread",e[e.Await=2048]="Await",e[e.AsyncGenerator=4096]="AsyncGenerator",e[e.AsyncDelegator=8192]="AsyncDelegator",e[e.AsyncValues=16384]="AsyncValues",e[e.ExportStar=32768]="ExportStar",e[e.MakeTemplateObject=65536]="MakeTemplateObject",e[e.FirstEmitHelper=1]="FirstEmitHelper",e[e.LastEmitHelper=65536]="LastEmitHelper",e[e.ForOfIncludes=256]="ForOfIncludes",e[e.ForAwaitOfIncludes=16384]="ForAwaitOfIncludes",e[e.AsyncGeneratorIncludes=6144]="AsyncGeneratorIncludes",e[e.AsyncDelegatorIncludes=26624]="AsyncDelegatorIncludes",e[e.SpreadIncludes=1536]="SpreadIncludes"}(e.ExternalEmitHelpers||(e.ExternalEmitHelpers={})),function(e){e[e.SourceFile=0]="SourceFile",e[e.Expression=1]="Expression",e[e.IdentifierName=2]="IdentifierName",e[e.MappedTypeParameter=3]="MappedTypeParameter",e[e.Unspecified=4]="Unspecified"}(e.EmitHint||(e.EmitHint={}))}(ts||(ts={})),function(e){e.timestamp="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now?Date.now:function(){return+new Date}}(ts||(ts={})),function(e){!function(t){var n,r,i,s="function"==typeof onProfilerEvent&&!0===onProfilerEvent.profiler?onProfilerEvent:function(e){},o=!1,a=0;t.mark=function(t){o&&(r.set(t,e.timestamp()),n.set(t,(n.get(t)||0)+1),s(t))},t.measure=function(t,n,s){if(o){var l=s&&r.get(s)||e.timestamp(),c=n&&r.get(n)||a;i.set(t,(i.get(t)||0)+(l-c))}},t.getCount=function(e){return n&&n.get(e)||0},t.getDuration=function(e){return i&&i.get(e)||0},t.forEachMeasure=function(e){i.forEach((function(t,n){e(n,t)}))},t.enable=function(){n=e.createMap(),r=e.createMap(),i=e.createMap(),o=!0,a=e.timestamp()},t.disable=function(){o=!1}}(e.performance||(e.performance={}))}(ts||(ts={})),function(e){e.versionMajorMinor="2.6",e.version=e.versionMajorMinor+".1"}(ts||(ts={})),function(e){e.isExternalModuleNameRelative=function(t){return e.pathIsRelative(t)||e.isRootedDiskPath(t)}}(ts||(ts={})),function(e){function t(){var e=Object.create(null);return e.__=void 0,delete e.__,e}function n(){return new i}e.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?new Intl.Collator(void 0,{usage:"sort",sensitivity:"accent"}):void 0,e.localeCompareIsCorrect=e.collator&&e.collator.compare("a","B")<0,e.createMap=n,e.createUnderscoreEscapedMap=function(){return new i},e.createSymbolTable=function(e){var t=n();if(e)for(var r=0,i=e;r<i.length;r++){var s=i[r];t.set(s.escapedName,s)}return t},e.createMapFromTemplate=function(e){var t=new i;for(var n in e)E.call(e,n)&&t.set(n,e[n]);return t};var r,i="undefined"!=typeof Map&&"entries"in Map.prototype?Map:(r=function(){function e(e,t){this.index=0,this.data=e,this.selector=t,this.keys=Object.keys(e)}return e.prototype.next=function(){var e=this.index;return e<this.keys.length?(this.index++,{value:this.selector(this.data,this.keys[e]),done:!1}):{value:void 0,done:!0}},e}(),function(){function e(){this.data=t(),this.size=0}return e.prototype.get=function(e){return this.data[e]},e.prototype.set=function(e,t){return this.has(e)||this.size++,this.data[e]=t,this},e.prototype.has=function(e){return e in this.data},e.prototype.delete=function(e){return!!this.has(e)&&(this.size--,delete this.data[e],!0)},e.prototype.clear=function(){this.data=t(),this.size=0},e.prototype.keys=function(){return new r(this.data,(function(e,t){return t}))},e.prototype.values=function(){return new r(this.data,(function(e,t){return e[t]}))},e.prototype.entries=function(){return new r(this.data,(function(e,t){return[t,e[t]]}))},e.prototype.forEach=function(e){for(var t in this.data)e(this.data[t],t)},e}());function s(e,t){if(e)for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r)return r}}function o(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r,n))return r}}function a(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n))return n;return-1}function l(e,t){if(e)for(var n=0,r=e;n<r.length;n++){if(r[n]===t)return!0}return!1}function c(e,t,n){for(var r=n||0;r<e.length;r++)if(l(t,e.charCodeAt(r)))return r;return-1}function u(e,t){for(var n=0,r=0;r<e.length;r++)t(e[r],r,e)&&(e[n]=e[r],n++);e.length=n}function d(e,t){var n;if(e){n=[];for(var r=0;r<e.length;r++)n.push(t(e[r],r))}return n}function p(e){var t;if(e){t=[];for(var n=0,r=e;n<r.length;n++){var i=r[n];i&&(N(i)?y(t,i):t.push(i))}}return t}function h(e,t){var n;if(e){n=[];for(var r=0;r<e.length;r++){var i=t(e[r],r);i&&(N(i)?y(n,i):n.push(i))}}return n}function f(e,t){if(e){if(!t)return e.length>0;for(var n=0,r=e;n<r.length;n++){if(t(r[n]))return!0}}return!1}function m(e,t){var n;if(e){n=[];e:for(var r=0,i=e;r<i.length;r++){for(var s=i[r],o=0,a=n;o<a.length;o++){var l=a[o];if(t?t(l,s):l===s)continue e}n.push(s)}}return n}function _(e,t,n){if(!e||!t)return e===t;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){if(!(n?n(e[r],t[r]):e[r]===t[r]))return!1}return!0}function g(e,t){return t<0?e.length+t:t}function y(e,t,n,r){if(void 0===t||0===t.length)return e;if(void 0===e)return t.slice(n,r);n=void 0===n?0:g(t,n),r=void 0===r?t.length:g(t,r);for(var i=n;i<r&&i<t.length;i++){void 0!==t[i]&&e.push(t[i])}return e}function b(e,t){return!l(e,t)&&(e.push(t),!0)}function v(e,t){if(e&&(t=g(e,t))<e.length)return e[t]}function T(e){return v(e,-1)}function k(e,t,n,r,i){if(e&&e.length>0){var s=e.length;if(s>0){var o=void 0===r||r<0?0:r,a=void 0===i||o+i>s-1?s-1:o+i,l=void 0;for(arguments.length<=2?(l=e[o],o++):l=n;o<=a;)l=t(l,e[o],o),o++;return l}}return n}e.toPath=function(e,t,n){return n(Z(e)?K(e):ne(e,t))},function(e){e[e.LessThan=-1]="LessThan",e[e.EqualTo=0]="EqualTo",e[e.GreaterThan=1]="GreaterThan"}(e.Comparison||(e.Comparison={})),e.length=function(e){return e?e.length:0},e.forEach=s,e.firstDefined=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(void 0!==r)return r}},e.findAncestor=function(e,t){for(;e;){var n=t(e);if("quit"===n)return;if(n)return e;e=e.parent}},e.zipWith=function(e,t,n){var r=[];Pe.assert(e.length===t.length);for(var i=0;i<e.length;i++)r.push(n(e[i],t[i],i));return r},e.zipToMap=function(e,t){Pe.assert(e.length===t.length);for(var r=n(),i=0;i<e.length;++i)r.set(e[i],t[i]);return r},e.every=function(e,t){if(e)for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0},e.find=o,e.findLast=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(t(r,n))return r}},e.findIndex=a,e.findMap=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r)return r}Pe.fail()},e.contains=l,e.indexOf=function(e,t){if(e)for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},e.indexOfAnyCharCode=c,e.countWhere=function(e,t){var n=0;if(e)for(var r=0;r<e.length;r++){t(e[r],r)&&n++}return n},e.filter=function(e,t){if(e){for(var n=e.length,r=0;r<n&&t(e[r]);)r++;if(r<n){var i=e.slice(0,r);for(r++;r<n;){var s=e[r];t(s)&&i.push(s),r++}return i}}return e},e.filterMutate=u,e.clear=function(e){e.length=0},e.map=d,e.sameMap=function(e,t){var n;if(e)for(var r=0;r<e.length;r++)if(n)n.push(t(e[r],r));else{var i=e[r],s=t(i,r);i!==s&&(n=e.slice(0,r)).push(s)}return n||e},e.flatten=p,e.flatMap=h,e.flatMapIter=function(e,t){for(var n=[];;){var r=e.next(),i=r.value;if(r.done)break;var s=t(i);s&&(N(s)?n.push.apply(n,s):n.push(s))}return n},e.sameFlatMap=function(e,t){var n;if(e)for(var r=0;r<e.length;r++){var i=e[r],s=t(i,r);(n||i!==s||N(s))&&(n||(n=e.slice(0,r)),N(s)?y(n,s):n.push(s))}return n||e},e.mapDefined=function(e,t){var n=[];if(e)for(var r=0;r<e.length;r++){var i=t(e[r],r);void 0!==i&&n.push(i)}return n},e.mapDefinedIter=function(e,t){for(var n=[];;){var r=e.next(),i=r.value;if(r.done)break;var s=t(i);void 0!==s&&n.push(s)}return n},e.span=function(e,t){if(e){for(var n=0;n<e.length;n++)if(!t(e[n],n))return[e.slice(0,n),e.slice(n)];return[e.slice(0),[]]}},e.spanMap=function(e,t,n){var r;if(e){r=[];for(var i=e.length,s=void 0,o=void 0,a=0,l=0;a<i;){for(;l<i;){if(o=t(e[l],l),0===l)s=o;else if(o!==s)break;l++}if(a<l){var c=n(e.slice(a,l),s,a,l);c&&r.push(c),a=l}s=o,l++}}return r},e.mapEntries=function(e,t){if(e){var r=n();return e.forEach((function(e,n){var i=t(n,e),s=i[0],o=i[1];r.set(s,o)})),r}},e.some=f,e.concatenate=function(e,t){return f(t)?f(e)?e.concat(t):t:e},e.deduplicate=m,e.arrayIsEqualTo=_,e.changesAffectModuleResolution=function(e,t){return!(e&&e.module===t.module&&e.moduleResolution===t.moduleResolution&&e.noResolve===t.noResolve&&e.target===t.target&&e.noLib===t.noLib&&e.jsx===t.jsx&&e.allowJs===t.allowJs&&e.rootDir===t.rootDir&&e.configFilePath===t.configFilePath&&e.baseUrl===t.baseUrl&&e.maxNodeModuleJsDepth===t.maxNodeModuleJsDepth&&_(e.lib,t.lib)&&_(e.typeRoots,t.typeRoots)&&_(e.rootDirs,t.rootDirs)&&C(e.paths,t.paths))},e.compact=function(e){var t;if(e)for(var n=0;n<e.length;n++){var r=e[n];!t&&r||(t||(t=e.slice(0,n)),r&&t.push(r))}return t||e},e.relativeComplement=function(e,t,n,r,i){if(void 0===n&&(n=M),void 0===r&&(r=0),void 0===i&&(i=0),!t||!e||0===t.length||0===e.length)return t;var s=[];e:for(;i<t.length;i++){t:for(;r<e.length;r++)switch(n(t[i],e[r])){case-1:break t;case 0:continue e;case 1:continue t}s.push(t[i])}return s},e.sum=function(e,t){for(var n=0,r=0,i=e;r<i.length;r++){n+=i[r][t]}return n},e.append=function(e,t){return void 0===t?e:void 0===e?[t]:(e.push(t),e)},e.addRange=y,e.pushIfUnique=b,e.appendIfUnique=function(e,t){return e?(b(e,t),e):[t]},e.stableSort=function(e,t){return void 0===t&&(t=M),e.map((function(e,t){return t})).sort((function(n,r){return t(e[n],e[r])||M(n,r)})).map((function(t){return e[t]}))},e.rangeEquals=function(e,t,n,r){for(;n<r;){if(e[n]!==t[n])return!1;n++}return!0},e.elementAt=v,e.firstOrUndefined=function(e){return v(e,0)},e.first=function(e){return Pe.assert(0!==e.length),e[0]},e.lastOrUndefined=T,e.last=function(e){return Pe.assert(0!==e.length),e[e.length-1]},e.singleOrUndefined=function(e){return e&&1===e.length?e[0]:void 0},e.singleOrMany=function(e){return e&&1===e.length?e[0]:e},e.replaceElement=function(e,t,n){var r=e.slice(0);return r[t]=n,r},e.binarySearch=function(e,t,n,r){if(!e||0===e.length)return-1;var i=r||0,s=e.length-1;for(n=void 0!==n?n:function(e,t){return e<t?-1:e>t?1:0};i<=s;){var o=i+(s-i>>1),a=e[o];if(0===n(a,t))return o;n(a,t)>0?s=o-1:i=o+1}return~i},e.reduceLeft=k,e.reduceRight=function(e,t,n,r,i){if(e){var s=e.length;if(s>0){var o=void 0===r||r>s-1?s-1:r,a=void 0===i||o-i<0?0:o-i,l=void 0;for(arguments.length<=2?(l=e[o],o--):l=n;o>=a;)l=t(l,e[o],o),o--;return l}}return n};var E=Object.prototype.hasOwnProperty;function x(e,t){return E.call(e,t)}function S(e,t){e.forEach((function(e,n){t.set(n,e)}))}function C(e,t,n){if(e===t)return!0;if(!e||!t)return!1;for(var r in e)if(E.call(e,r)){if(void 0===!E.call(t,r))return!1;if(n?!n(e[r],t[r]):e[r]!==t[r])return!1}for(var r in t)if(E.call(t,r)&&!E.call(e,r))return!1;return!0}function I(e,t,r){for(var i=n(),s=0,o=e;s<o.length;s++){var a=o[s];i.set(t(a),r?r(a):a)}return i}function A(e,t){var n=this.get(e);return n?n.push(t):this.set(e,n=[t]),n}function w(e,t){var n=this.get(e);n&&(ze(n,t),n.length||this.delete(e))}function N(e){return Array.isArray?Array.isArray(e):e instanceof Array}function D(e){return"string"==typeof e}function O(e){var t;return function(){return e&&(t=e(),e=void 0),t}}function R(e,t,n,r,i){if(i){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return function(e){return k(s,(function(e,t){return t(e)}),e)}}return r?function(i){return r(n(t(e(i))))}:n?function(r){return n(t(e(r)))}:t?function(n){return t(e(n))}:e?function(t){return e(t)}:function(e){return e}}function L(e,t,n){return n=n||0,e.replace(/{(\d+)}/g,(function(e,r){return t[+r+n]}))}function P(t){return e.localizedDiagnosticMessages&&e.localizedDiagnosticMessages[t.key]||t.message}function M(e,t){return e===t?0:void 0===e?-1:void 0===t?1:e<t?-1:1}function F(t,n,r){if(t===n)return 0;if(void 0===t)return-1;if(void 0===n)return 1;if(r){if(e.collator){var i=e.localeCompareIsCorrect?e.collator.compare(t,n):t.localeCompare(n,void 0,{usage:"sort",sensitivity:"accent"});return i<0?-1:i>0?1:0}if((t=t.toUpperCase())===(n=n.toUpperCase()))return 0}return t<n?-1:1}function $(e,t){return F(e,t,!0)}function B(e){return e.file?e.file.fileName:void 0}function U(e,t){return M(B(e),B(t))||M(e.start,t.start)||M(e.length,t.length)||M(e.code,t.code)||function(e,t){for(;e&&t;){var n=M(D(e)?e:e.messageText,D(t)?t:t.messageText);if(n)return n;e=D(e)?void 0:e.next,t=D(t)?void 0:t.next}if(!e&&!t)return 0;return e?1:-1}(e.messageText,t.messageText)||0}function V(e){if(e.length<2)return e;for(var t=[e[0]],n=e[0],r=1;r<e.length;r++){var i=e[r];0===U(i,n)||(t.push(i),n=i)}return t}function H(e){return e.replace(/\\/g,"/")}function G(e){if(47===e.charCodeAt(0)){if(47!==e.charCodeAt(1))return 1;var t=e.indexOf("/",2);if(t<0)return 2;var n=e.indexOf("/",t+1);return n<0?t+1:n+1}if(58===e.charCodeAt(1))return 47===e.charCodeAt(2)?3:2;if(0===e.lastIndexOf("file:///",0))return"file:///".length;var r=e.indexOf("://");return-1!==r?r+"://".length:0}e.hasProperty=x,e.getProperty=function(e,t){return E.call(e,t)?e[t]:void 0},e.getOwnKeys=function(e){var t=[];for(var n in e)E.call(e,n)&&t.push(n);return t},e.getOwnValues=function(e){var t=[];for(var n in e)E.call(e,n)&&t.push(e[n]);return t},e.arrayFrom=function(e,t){for(var n,r=[],i=e.next(),s=i.value,o=i.done;!o;s=(n=e.next()).value,o=n.done,n)r.push(t?t(s):s);return r},e.forEachEntry=function(e,t){for(var n,r=e.entries(),i=r.next(),s=i.value,o=i.done;!o;s=(n=r.next()).value,o=n.done,n){var a=s[0],l=t(s[1],a);if(l)return l}},e.forEachKey=function(e,t){for(var n,r=e.keys(),i=r.next(),s=i.value,o=i.done;!o;s=(n=r.next()).value,o=n.done,n){var a=t(s);if(a)return a}},e.copyEntries=S,e.assign=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var s=i[r];for(var o in s)x(s,o)&&(e[o]=s[o])}return e},e.equalOwnProperties=C,e.arrayToMap=I,e.arrayToNumericMap=function(e,t){for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];n[t(s)]=s}return n},e.arrayToSet=function(e,t){return I(e,t||function(e){return e},(function(){return!0}))},e.cloneMap=function(e){var t=n();return S(e,t),t},e.clone=function(e){var t={};for(var n in e)E.call(e,n)&&(t[n]=e[n]);return t},e.extend=function(e,t){var n={};for(var r in t)E.call(t,r)&&(n[r]=t[r]);for(var r in e)E.call(e,r)&&(n[r]=e[r]);return n},e.createMultiMap=function(){var e=n();return e.add=A,e.remove=w,e},e.isArray=N,e.isString=D,e.tryCast=function(e,t){return void 0!==e&&t(e)?e:void 0},e.cast=function(e,t){if(void 0!==e&&t(e))return e;Pe.fail("Invalid cast. The supplied value did not pass the test '"+Pe.getFunctionName(t)+"'.")},e.noop=function(){},e.returnFalse=function(){return!1},e.returnTrue=function(){return!0},e.identity=function(e){return e},e.notImplemented=function(){throw new Error("Not implemented")},e.memoize=O,e.chain=function(e,t,n,r,i){if(i){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];return function(e){return R.apply(void 0,d(s,(function(t){return t(e)})))}}return r?function(i){return R(e(i),t(i),n(i),r(i))}:n?function(r){return R(e(r),t(r),n(r))}:t?function(n){return R(e(n),t(n))}:e?function(t){return R(e(t))}:function(e){return function(e){return e}}},e.compose=R,e.formatStringFromArgs=L,e.localizedDiagnosticMessages=void 0,e.getLocaleSpecificMessage=P,e.createFileDiagnostic=function(e,t,n,r){Pe.assertGreaterThanOrEqual(t,0),Pe.assertGreaterThanOrEqual(n,0),e&&(Pe.assertLessThanOrEqual(t,e.text.length),Pe.assertLessThanOrEqual(t+n,e.text.length));var i=P(r);return arguments.length>4&&(i=L(i,arguments,4)),{file:e,start:t,length:n,messageText:i,category:r.category,code:r.code}},e.formatMessage=function(e,t){var n=P(t);return arguments.length>2&&(n=L(n,arguments,2)),n},e.createCompilerDiagnostic=function(e){var t=P(e);return arguments.length>1&&(t=L(t,arguments,1)),{file:void 0,start:void 0,length:void 0,messageText:t,category:e.category,code:e.code}},e.createCompilerDiagnosticFromMessageChain=function(e){return{file:void 0,start:void 0,length:void 0,code:e.code,category:e.category,messageText:e.next?e:e.messageText}},e.chainDiagnosticMessages=function(e,t){var n=P(t);return arguments.length>2&&(n=L(n,arguments,2)),{messageText:n,category:t.category,code:t.code,next:e}},e.concatenateDiagnosticMessageChains=function(e,t){for(var n=e;n.next;)n=n.next;return n.next=t,e},e.compareValues=M,e.compareStrings=F,e.compareStringsCaseInsensitive=$,e.compareDiagnostics=U,e.sortAndDeduplicateDiagnostics=function(e){return V(e.sort(U))},e.deduplicateSortedDiagnostics=V,e.normalizeSlashes=H,e.getRootLength=G,e.directorySeparator="/";function j(t,n){for(var r=[],i=0,s=t.substr(n).split(e.directorySeparator);i<s.length;i++){var o=s[i];"."!==o&&(".."===o&&r.length>0&&".."!==T(r)?r.pop():o&&r.push(o))}return r}function K(e){return W(e).path}function W(t){var n=G(t=H(t)),r=t.substr(0,n),i=j(t,n);if(i.length){var s=r+i.join(e.directorySeparator);return{path:z(t)?s+e.directorySeparator:s,parts:i}}return{path:r,parts:i}}function z(e){return 47===e.charCodeAt(e.length-1)}function q(t){return t.substr(0,Math.max(G(t),t.lastIndexOf(e.directorySeparator)))}function J(e){return e&&!Z(e)&&pe(e,"://")}function Y(e){return e.target||0}function X(t){return"number"==typeof t.module?t.module:Y(t)>=2?e.ModuleKind.ES2015:e.ModuleKind.CommonJS}function Q(e){for(var t=!1,n=0;n<e.length;n++)if(42===e.charCodeAt(n)){if(t)return!1;t=!0}return!0}function Z(e){return e&&0!==G(e)}function ee(e,t){var n=j(e,t);return[e.substr(0,t)].concat(n)}function te(e,t){var n=G(e=H(e));return 0===n&&(n=G(e=ae(H(t),e))),ee(e,n)}function ne(e,t){return re(te(e,t))}function re(t){if(t&&t.length)return t[0]+t.slice(1).join(e.directorySeparator)}function ie(t,n){return J(t)?function(t){for(var n=t.length,r=t.indexOf("://")+"://".length;r<n&&47===t.charCodeAt(r);)r++;if(r===n)return[t];var i=t.indexOf(e.directorySeparator,r);return-1!==i?ee(t,r=i+1):[t+e.directorySeparator]}(t):te(t,n)}function se(t,n,r,i,s){var o,a=ie(n,r),l=ie(t,r);for(l.length>1&&""===T(l)&&l.pop(),o=0;o<a.length&&o<l.length&&i(l[o])===i(a[o]);o++);if(o){for(var c="",u=a.slice(o,a.length);o<l.length;o++)""!==l[o]&&(c=c+".."+e.directorySeparator);return c+u.join(e.directorySeparator)}var d=re(a);return s&&Z(d)&&(d="file:///"+d),d}function oe(t){if(void 0!==t){var n=t.lastIndexOf(e.directorySeparator);return n<0?t:t.substring(n+1)}}function ae(t,n){return t&&t.length?n&&n.length?0!==G(n)?n:t.charAt(t.length-1)===e.directorySeparator?t+n:t+e.directorySeparator+n:t:n}function le(t){return t.charAt(t.length-1)===e.directorySeparator?t.substr(0,t.length-1):t}function ce(e,t,n,r){if(void 0===e||void 0===t)return!1;if(e===t)return!0;if((e=le(e))===(t=le(t)))return!0;var i=te(e,n),s=te(t,n);if(s.length<i.length)return!1;for(var o=0;o<i.length;o++){if(0!==F(i[o],s[o],r))return!1}return!0}function ue(e,t){return 0===e.lastIndexOf(t,0)}function de(e,t){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}function pe(e,t){return-1!==e.indexOf(t)}function he(e){return pe(oe(e),".")}function fe(e,t){return e.length>t.length&&de(e,t)}function me(e,t){for(var n=0,r=t;n<r.length;n++){if(fe(e,r[n]))return!0}return!1}e.normalizePath=K,e.normalizePathAndParts=W,e.pathEndsWithDirectorySeparator=z,e.getDirectoryPath=q,e.isUrl=J,e.pathIsRelative=function(e){return/^\.\.?($|[\\/])/.test(e)},e.moduleHasNonRelativeName=function(t){return!e.isExternalModuleNameRelative(t)},e.getEmitScriptTarget=Y,e.getEmitModuleKind=X,e.getEmitModuleResolutionKind=function(t){var n=t.moduleResolution;return void 0===n&&(n=X(t)===e.ModuleKind.CommonJS?e.ModuleResolutionKind.NodeJs:e.ModuleResolutionKind.Classic),n},e.hasZeroOrOneAsteriskCharacter=Q,e.isRootedDiskPath=Z,e.convertToRelativePath=function(e,t,n){return Z(e)?se(t,e,t,n,!1):e},e.getNormalizedPathComponents=te,e.getNormalizedAbsolutePath=ne,e.getNormalizedPathFromPathComponents=re,e.getRelativePathToDirectoryOrUrl=se,e.getBaseFileName=oe,e.combinePaths=ae,e.removeTrailingDirectorySeparator=le,e.ensureTrailingDirectorySeparator=function(t){return t.charAt(t.length-1)!==e.directorySeparator?t+e.directorySeparator:t},e.comparePaths=function(e,t,n,r){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;e=le(e),t=le(t);for(var i=te(e,n),s=te(t,n),o=Math.min(i.length,s.length),a=0;a<o;a++){var l=F(i[a],s[a],r);if(0!==l)return l}return M(i.length,s.length)},e.containsPath=ce,e.startsWith=ue,e.removePrefix=function(e,t){return ue(e,t)?e.substr(t.length):e},e.endsWith=de,e.stringContains=pe,e.hasExtension=he,e.fileExtensionIs=fe,e.fileExtensionIsOneOf=me;var _e=/[^\w\s\/]/g,ge=[42,63];e.commonPackageFolders=["node_modules","bower_components","jspm_packages"];var ye="(?!("+e.commonPackageFolders.join("|")+")(/|$))",be={singleAsteriskRegexFragment:"([^./]|(\\.(?!min\\.js$))?)*",doubleAsteriskRegexFragment:"(/"+ye+"[^/.][^/]*)*?",replaceWildcardCharacter:function(e){return Ce(e,be.singleAsteriskRegexFragment)}},ve={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/"+ye+"[^/.][^/]*)*?",replaceWildcardCharacter:function(e){return Ce(e,ve.singleAsteriskRegexFragment)}},Te={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/.+?)?",replaceWildcardCharacter:function(e){return Ce(e,Te.singleAsteriskRegexFragment)}},ke={files:be,directories:ve,exclude:Te};function Ee(e,t,n){var r=xe(e,t,n);if(r&&r.length)return"^("+r.map((function(e){return"("+e+")"})).join("|")+")"+("exclude"===n?"($|/)":"$")}function xe(t,n,r){if(void 0!==t&&0!==t.length)return h(t,(function(t){return t&&function(t,n,r,i){var s=i.singleAsteriskRegexFragment,o=i.doubleAsteriskRegexFragment,a=i.replaceWildcardCharacter,l="",c=!1,u=!1,d=te(t,n),p=T(d);if("exclude"!==r&&"**"===p)return;d[0]=le(d[0]),Se(p)&&d.push("**","*");for(var h=0,f=0,m=d;f<m.length;f++){var _=m[f];if("**"===_){if(c)return;l+=o,c=!0}else if("directories"===r&&(l+="(",h++),u&&(l+=e.directorySeparator),"exclude"!==r){var g="";42===_.charCodeAt(0)?(g+="([^./]"+s+")?",_=_.substr(1)):63===_.charCodeAt(0)&&(g+="[^./]",_=_.substr(1)),(g+=_.replace(_e,a))!==_&&(l+=ye),l+=g}else l+=_.replace(_e,a);u=!0}for(;h>0;)l+=")?",h--;return l}(t,n,r,ke[r])}))}function Se(e){return!/[.*?]/.test(e)}function Ce(e,t){return"*"===e?t:"?"===e?"[^/]":"\\"+e}function Ie(e,t,n,r,i){e=K(e);var s=ae(i=K(i),e);return{includeFilePatterns:d(xe(n,s,"files"),(function(e){return"^"+e+"$"})),includeFilePattern:Ee(n,s,"files"),includeDirectoryPattern:Ee(n,s,"directories"),excludePattern:Ee(t,s,"exclude"),basePaths:we(e,n,r)}}function Ae(e,t,n,r,i,s,o,l){for(var c=Ie(e=K(e),n,r,i,s=K(s)),u=i?"":"i",d=c.includeFilePatterns&&c.includeFilePatterns.map((function(e){return new RegExp(e,u)})),h=c.includeDirectoryPattern&&new RegExp(c.includeDirectoryPattern,u),f=c.excludePattern&&new RegExp(c.excludePattern,u),m=d?d.map((function(){return[]})):[[]],_=i?F:$,g=0,y=c.basePaths;g<y.length;g++){var b=y[g];v(b,ae(s,b),o)}return p(m);function v(e,n,r){for(var i=l(e),s=i.files,o=i.directories,c=function(r){var i=ae(e,r),s=ae(n,r);if(t&&!me(i,t))return"continue";if(f&&f.test(s))return"continue";if(d){var o=a(d,(function(e){return e.test(s)}));-1!==o&&m[o].push(i)}else m[0].push(i)},u=0,p=s=s.slice().sort(_);u<p.length;u++){c(b=p[u])}if(void 0===r||0!=--r)for(var g=0,y=o=o.slice().sort(_);g<y.length;g++){var b=y[g],T=ae(e,b),k=ae(n,b);h&&!h.test(k)||f&&f.test(k)||v(T,k,r)}}}function we(t,n,r){var i=[t];if(n){for(var s=[],o=0,a=n;o<a.length;o++){var l=a[o],c=Z(l)?l:K(ae(t,l));s.push(Ne(c))}s.sort(r?F:$);for(var u=function(n){e.every(i,(function(e){return!ce(e,n,t,!r)}))&&i.push(n)},d=0,p=s;d<p.length;d++){u(p[d])}}return i}function Ne(t){var n=c(t,ge);return n<0?he(t)?le(q(t)):t:t.substring(0,t.lastIndexOf(e.directorySeparator,n))}function De(e){switch(e.substr(e.lastIndexOf(".")).toLowerCase()){case".js":return 1;case".jsx":return 2;case".ts":return 3;case".tsx":return 4;case".json":return 6;default:return 0}}e.getRegularExpressionForWildcard=Ee,e.isImplicitGlob=Se,e.getFileMatcherPatterns=Ie,e.matchFiles=Ae,e.ensureScriptKind=function(e,t){return t||De(e)||3},e.getScriptKindFromFileName=De,e.supportedTypeScriptExtensions=[".ts",".tsx",".d.ts"],e.supportedTypescriptExtensionsForExtractExtension=[".d.ts",".ts",".tsx"],e.supportedJavascriptExtensions=[".js",".jsx"];var Oe=e.supportedTypeScriptExtensions.concat(e.supportedJavascriptExtensions);function Re(t,n){var r=t&&t.allowJs;return n&&0!==n.length&&r?m(Oe.concat(n.map((function(e){return e.extension})))):r?Oe:e.supportedTypeScriptExtensions}function Le(e,t){return e<2?0:e<t.length?2:t.length}e.getSupportedExtensions=Re,e.hasJavaScriptFileExtension=function(t){return s(e.supportedJavascriptExtensions,(function(e){return fe(t,e)}))},e.hasTypeScriptFileExtension=function(t){return s(e.supportedTypeScriptExtensions,(function(e){return fe(t,e)}))},e.isSupportedSourceFileName=function(e,t,n){if(!e)return!1;for(var r=0,i=Re(t,n);r<i.length;r++){if(fe(e,i[r]))return!0}return!1},function(e){e[e.TypeScriptFiles=0]="TypeScriptFiles",e[e.DeclarationAndJavaScriptFiles=2]="DeclarationAndJavaScriptFiles",e[e.Highest=0]="Highest",e[e.Lowest=2]="Lowest"}(e.ExtensionPriority||(e.ExtensionPriority={})),e.getExtensionPriority=function(e,t){for(var n=t.length-1;n>=0;n--)if(fe(e,t[n]))return Le(n,t);return 0},e.adjustExtensionPriority=Le,e.getNextLowestExtensionPriority=function(e,t){return e<2?2:t.length};var Pe,Me=[".d.ts",".ts",".js",".tsx",".jsx"];function Fe(e){for(var t=0,n=Me;t<n.length;t++){var r=$e(e,n[t]);if(void 0!==r)return r}return e}function $e(e,t){return fe(e,t)?Be(e,t):void 0}function Be(e,t){return e.substring(0,e.length-t.length)}function Ue(e,t){this.flags=e,this.escapedName=t,this.declarations=void 0}function Ve(e,t){this.flags=t,Pe.isDebugging&&(this.checker=e)}function He(){}function Ge(e,t,n){this.id=0,this.kind=e,this.pos=t,this.end=n,this.flags=0,this.modifierFlagsCache=0,this.transformFlags=0,this.parent=void 0,this.original=void 0}function je(e,t,n){this.fileName=e,this.text=t,this.skipTrivia=n||function(e){return e}}function Ke(e,t){for(var n=t;n<e.length-1;n++)e[n]=e[n+1];e.pop()}function We(e,t){e[t]=e[e.length-1],e.pop()}function ze(e,t){!function(e,t){for(var n=0;n<e.length;n++)if(t(e[n])){We(e,n);break}}(e,(function(e){return e===t}))}function qe(e){return e?function(e){return e}:function(e){return e.toLowerCase()}}function Je(e,t,n){for(var r=void 0,i=-1,s=0,o=e;s<o.length;s++){var a=o[s],l=t(a);Ye(l,n)&&l.prefix.length>i&&(i=l.prefix.length,r=a)}return r}function Ye(e,t){var n=e.prefix,r=e.suffix;return t.length>=n.length+r.length&&ue(t,n)&&de(t,r)}function Xe(e){Pe.assert(Q(e));var t=e.indexOf("*");return-1===t?void 0:{prefix:e.substr(0,t),suffix:e.substr(t+1)}}function Qe(t){return o(e.supportedTypescriptExtensionsForExtractExtension,(function(e){return fe(t,e)}))||o(e.supportedJavascriptExtensions,(function(e){return fe(t,e)}))}e.removeFileExtension=Fe,e.tryRemoveExtension=$e,e.removeExtension=Be,e.changeExtension=function(e,t){return Fe(e)+t},e.objectAllocator={getNodeConstructor:function(){return Ge},getTokenConstructor:function(){return Ge},getIdentifierConstructor:function(){return Ge},getSourceFileConstructor:function(){return Ge},getSymbolConstructor:function(){return Ue},getTypeConstructor:function(){return Ve},getSignatureConstructor:function(){return He},getSourceMapSourceConstructor:function(){return je}},function(e){e[e.None=0]="None",e[e.Normal=1]="Normal",e[e.Aggressive=2]="Aggressive",e[e.VeryAggressive=3]="VeryAggressive"}(e.AssertionLevel||(e.AssertionLevel={})),function(e){function t(e,n){var r=new Error(e?"Debug Failure. "+e:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(r,n||t),r}e.currentAssertionLevel=0,e.isDebugging=!1,e.shouldAssert=function(t){return e.currentAssertionLevel>=t},e.assert=function e(n,r,i,s){n||(i&&(r+="\r\nVerbose Debug Information: "+("string"==typeof i?i:i())),t(r?"False expression: "+r:"False expression.",s||e))},e.assertEqual=function(e,n,r,i){e!==n&&t("Expected "+e+" === "+n+". "+(r?i?r+" "+i:r:""))},e.assertLessThan=function(e,n,r){e>=n&&t("Expected "+e+" < "+n+". "+(r||""))},e.assertLessThanOrEqual=function(e,n){e>n&&t("Expected "+e+" <= "+n)},e.assertGreaterThanOrEqual=function(e,n){e<n&&t("Expected "+e+" >= "+n)},e.fail=t,e.assertNever=function e(n,r,i){return t(r||"Illegal value: "+n,i||e)},e.getFunctionName=function(e){if("function"!=typeof e)return"";if(e.hasOwnProperty("name"))return e.name;var t=Function.prototype.toString.call(e),n=/^function\s+([\w\$]+)\s*\(/.exec(t);return n?n[1]:""}}(Pe=e.Debug||(e.Debug={})),e.orderedRemoveItem=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return Ke(e,n),!0;return!1},e.orderedRemoveItemAt=Ke,e.unorderedRemoveItemAt=We,e.unorderedRemoveItem=ze,e.createGetCanonicalFileName=qe,e.matchPatternOrExact=function(e,t){for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=Xe(s);if(o)n.push(o);else if(s===t)return s}return Je(n,(function(e){return e}),t)},e.patternText=function(e){return e.prefix+"*"+e.suffix},e.matchedText=function(e,t){return Pe.assert(Ye(e,t)),t.substr(e.prefix.length,t.length-e.suffix.length)},e.findBestPatternMatch=Je,e.tryParsePattern=Xe,e.positionIsSynthesized=function(e){return!(e>=0)},e.extensionIsTypeScript=function(e){return".ts"===e||".tsx"===e||".d.ts"===e},e.extensionFromPath=function(e){var t=Qe(e);if(void 0!==t)return t;Pe.fail("File "+e+" has unknown extension.")},e.isAnySupportedFileExtension=function(e){return void 0!==Qe(e)},e.tryGetExtensionFromPath=Qe,e.getAnyExtensionFromPath=function(e){var t=oe(e),n=t.lastIndexOf(".");if(n>=0)return t.substring(n)},e.isCheckJsEnabledForFile=function(e,t){return e.checkJsDirective?e.checkJsDirective.enabled:t.checkJs},e.and=function(e,t){return function(n){return e(n)&&t(n)}},e.assertTypeIsNever=function(e){},e.createCachedDirectoryStructureHost=function(t){var r=n(),i=O((function(){return t.getCurrentDirectory()})),s=qe(t.useCaseSensitiveFileNames);return{useCaseSensitiveFileNames:t.useCaseSensitiveFileNames,newLine:t.newLine,readFile:function(e,n){return t.readFile(e,n)},write:function(e){return t.write(e)},writeFile:function(e,n,r){var i=l(o(e));i&&y(i,c(e),!0);return t.writeFile(e,n,r)},fileExists:function(e){var n=l(o(e));return n&&_(n.files,c(e))||t.fileExists(e)},directoryExists:function(e){var n=o(e);return r.has(n)||t.directoryExists(e)},createDirectory:function(e){var n=l(o(e)),r=c(e);n&&g(n.directories,r,!0);t.createDirectory(e)},getCurrentDirectory:i,getDirectories:function(e){var n=o(e),r=h(e,n);if(r)return r.directories.slice();return t.getDirectories(e)},readDirectory:function(e,n,r,s,l){var c=o(e),u=h(e,c);if(u)return Ae(e,n,r,s,t.useCaseSensitiveFileNames,i(),l,(function(e){var t=o(e);if(t===c)return u;return a(t)||p(e,t)}));return t.readDirectory(e,n,r,s,l)},addOrDeleteFileOrDirectory:function(e,n){if(a(n))t.directoryExists(e)||r.delete(n);else{var i=l(n);if(i){var s=c(e);if(i){var o={fileExists:t.fileExists(n),directoryExists:t.directoryExists(n)};return y(i,s,o.fileExists),g(i.directories,s,o.directoryExists),o}}}},addOrDeleteFile:function(t,n,r){if(r===e.FileWatcherEventKind.Changed)return;var i=l(n);i&&y(i,c(t),r===e.FileWatcherEventKind.Created)},clearCache:function(){r.clear()},exit:function(e){return t.exit(e)}};function o(t){return e.toPath(t,i(),s)}function a(e){return r.get(e)}function l(e){return a(q(e))}function c(e){return oe(K(e))}function p(e,n){var i={files:d(t.readDirectory(e,void 0,void 0,["*.*"]),c)||[],directories:t.getDirectories(e)||[]};return r.set(n,i),i}function h(e,t){var n=a(t);if(n)return n;try{return p(e,t)}catch(e){return void Pe.assert(!r.has(t))}}function m(e,t){return s(e)===s(t)}function _(e,t){return f(e,(function(e){return m(e,t)}))}function g(e,t,n){if(_(e,t)){if(!n)return u(e,(function(e){return!m(e,t)}))}else if(n)return e.push(t)}function y(e,t,n){g(e.files,t,n)}}}(ts||(ts={})),function(e){var t;function n(){if("undefined"!=typeof process){var e=process.version;if(e){var t=e.indexOf(".");if(-1!==t)return parseInt(e.substring(1,t))}}}e.setStackTraceLimit=function(){Error.stackTraceLimit<100&&(Error.stackTraceLimit=100)},function(e){e[e.Created=0]="Created",e[e.Changed=1]="Changed",e[e.Deleted=2]="Deleted"}(t=e.FileWatcherEventKind||(e.FileWatcherEventKind={})),e.getNodeMajorVersion=n,e.sys=function(){function r(t,n){var i=e.getDirectoryPath(t),s=""!==i&&t!==i&&!n.directoryExists(i);s&&r(i,n),!s&&n.directoryExists(t)||n.createDirectory(t)}var i,s;if("undefined"!=typeof ChakraHost?(s=ChakraHost.realpath&&function(e){return ChakraHost.realpath(e)},i={newLine:ChakraHost.newLine||"\r\n",args:ChakraHost.args,useCaseSensitiveFileNames:!!ChakraHost.useCaseSensitiveFileNames,write:ChakraHost.echo,readFile:function(e,t){return ChakraHost.readFile(e)},writeFile:function(e,t,n){n&&(t="\ufeff"+t),ChakraHost.writeFile(e,t)},resolvePath:ChakraHost.resolvePath,fileExists:ChakraHost.fileExists,directoryExists:ChakraHost.directoryExists,createDirectory:ChakraHost.createDirectory,getExecutingFilePath:function(){return ChakraHost.executingFile},getCurrentDirectory:function(){return ChakraHost.currentDirectory},getDirectories:ChakraHost.getDirectories,getEnvironmentVariable:ChakraHost.getEnvironmentVariable||function(){return""},readDirectory:function(t,n,r,i,s){var o=e.getFileMatcherPatterns(t,r,i,!!ChakraHost.useCaseSensitiveFileNames,ChakraHost.currentDirectory);return ChakraHost.readDirectory(t,n,o.basePaths,o.excludePattern,o.includeFilePattern,o.includeDirectoryPattern)},exit:ChakraHost.quit,realpath:s}):"undefined"!=typeof process&&process.nextTick&&!process.browser&&"undefined"!=typeof require&&(i=function(){var r,i,s=require("fs"),o=require("path"),a=require("os"),l=require("crypto"),c=process.env.TSC_NONPOLLING_WATCHER,u=function(){var n=e.createMap(),r=e.createMultiMap();return{addFile:function(t,n){return s(t,n),i(e.getDirectoryPath(t)),{fileName:t,callback:n}},removeFile:function(t){var i,s,o,a,l;a=t.fileName,l=t.callback,r.remove(a,l),i=t.fileName,s=e.getDirectoryPath(i),(o=n.get(s))&&(o.referenceCount-=1,o.referenceCount<=0&&(o.close(),n.delete(s)))}};function i(i){var s=n.get(i);s?s.referenceCount+=1:((s=m(i||".",(function(n,s){return function(n,i,s){var o=e.isString(i)?e.getNormalizedAbsolutePath(i,s):void 0;if("change"===n||"rename"===n){var a=r.get(o);if(a)for(var l=0,c=a;l<c.length;l++)(0,c[l])(o,t.Changed)}}(n,s,i)}))).referenceCount=1,n.set(i,s))}function s(e,t){r.add(e,t)}}(),d=n()>=4,p=a.platform(),h="win32"!==p&&"win64"!==p&&!y((r=__filename,r.replace(/\w/g,(function(e){var t=e.toUpperCase();return e===t?e.toLowerCase():t}))));function f(e,n,r){return s.watchFile(e,{persistent:!0,interval:r||250},i),{close:function(){return s.unwatchFile(e,i)}};function i(r,i){var s=0==+r.mtime,o=0==+i.mtime,a=s&&!o,l=!s&&o?t.Created:a?t.Deleted:t.Changed;l===t.Changed&&+r.mtime<=+i.mtime||n(e,l)}}function m(e,n,r){var i,o=b(e)?a():l();return{close:function(){o.close()}};function a(){void 0===i&&(i=!d||"win32"!==process.platform&&"darwin"!==process.platform?{persistent:!0}:{persistent:!0,recursive:!!r});var t=s.watch(e,i,n);return t.on("error",(function(){b(e)||(o=l(),n("rename",""))})),t}function l(){return f(e,(function(r,i){i===t.Created&&b(e)&&(o.close(),o=a(),n("rename",""))}))}}function _(t){try{for(var n=s.readdirSync(t||".").sort(),r=[],i=[],o=0,a=n;o<a.length;o++){var l=a[o];if("."!==l&&".."!==l){var c=e.combinePaths(t,l),u=void 0;try{u=s.statSync(c)}catch(e){continue}u.isFile()?r.push(l):u.isDirectory()&&i.push(l)}}return{files:r,directories:i}}catch(e){return{files:[],directories:[]}}}function g(e,t){try{var n=s.statSync(e);switch(t){case 0:return n.isFile();case 1:return n.isDirectory()}}catch(e){return!1}}function y(e){return g(e,0)}function b(e){return g(e,1)}!function(e){e[e.File=0]="File",e[e.Directory=1]="Directory"}(i||(i={}));var v={args:process.argv.slice(2),newLine:a.EOL,useCaseSensitiveFileNames:h,write:function(e){process.stdout.write(e)},readFile:function(e,t){if(y(e)){var n=s.readFileSync(e),r=n.length;if(r>=2&&254===n[0]&&255===n[1]){r&=-2;for(var i=0;i<r;i+=2){var o=n[i];n[i]=n[i+1],n[i+1]=o}return n.toString("utf16le",2)}return r>=2&&255===n[0]&&254===n[1]?n.toString("utf16le",2):r>=3&&239===n[0]&&187===n[1]&&191===n[2]?n.toString("utf8",3):n.toString("utf8")}},writeFile:function(e,t,n){var r;n&&(t="\ufeff"+t);try{r=s.openSync(e,"w"),s.writeSync(r,t,void 0,"utf8")}finally{void 0!==r&&s.closeSync(r)}},watchFile:function(e,t,n){if(c){var r=u.addFile(e,t);return{close:function(){return u.removeFile(r)}}}return f(e,t,n)},watchDirectory:function(t,n,r){return m(t,(function(r,i){"rename"===r&&n(i?e.normalizePath(e.combinePaths(t,i)):i)}),r)},resolvePath:function(e){return o.resolve(e)},fileExists:y,directoryExists:b,createDirectory:function(e){v.directoryExists(e)||s.mkdirSync(e)},getExecutingFilePath:function(){return __filename},getCurrentDirectory:function(){return process.cwd()},getDirectories:function(t){return e.filter(s.readdirSync(t),(function(n){return g(e.combinePaths(t,n),1)}))},getEnvironmentVariable:function(e){return process.env[e]||""},readDirectory:function(t,n,r,i,s){return e.matchFiles(t,n,r,i,h,process.cwd(),s,_)},getModifiedTime:function(e){try{return s.statSync(e).mtime}catch(e){return}},createHash:function(e){var t=l.createHash("md5");return t.update(e),t.digest("hex")},getMemoryUsage:function(){return global.gc&&global.gc(),process.memoryUsage().heapUsed},getFileSize:function(e){try{var t=s.statSync(e);if(t.isFile())return t.size}catch(e){}return 0},exit:function(e){process.exit(e)},realpath:function(e){return s.realpathSync(e)},debugMode:e.some(process.execArgv,(function(e){return/^--(inspect|debug)(-brk)?(=\d+)?$/i.test(e)})),tryEnableSourceMapsForHost:function(){try{require("source-map-support").install()}catch(e){}},setTimeout:setTimeout,clearTimeout:clearTimeout};return v}()),i){var o=i.writeFile;i.writeFile=function(t,n,s){var a=e.getDirectoryPath(e.normalizeSlashes(t));a&&!i.directoryExists(a)&&r(a,i),o.call(i,t,n,s)}}return i}(),e.sys&&e.sys.getEnvironmentVariable&&(e.Debug.currentAssertionLevel=/^development$/i.test(e.sys.getEnvironmentVariable("NODE_ENV"))?1:0),e.sys&&e.sys.debugMode&&(e.Debug.isDebugging=!0)}(ts||(ts={})),function(e){function t(e,t,n,r){return{code:e,category:t,key:n,message:r}}e.Diagnostics={Unterminated_string_literal:t(1002,e.DiagnosticCategory.Error,"Unterminated_string_literal_1002","Unterminated string literal."),Identifier_expected:t(1003,e.DiagnosticCategory.Error,"Identifier_expected_1003","Identifier expected."),_0_expected:t(1005,e.DiagnosticCategory.Error,"_0_expected_1005","'{0}' expected."),A_file_cannot_have_a_reference_to_itself:t(1006,e.DiagnosticCategory.Error,"A_file_cannot_have_a_reference_to_itself_1006","A file cannot have a reference to itself."),Trailing_comma_not_allowed:t(1009,e.DiagnosticCategory.Error,"Trailing_comma_not_allowed_1009","Trailing comma not allowed."),Asterisk_Slash_expected:t(1010,e.DiagnosticCategory.Error,"Asterisk_Slash_expected_1010","'*/' expected."),Unexpected_token:t(1012,e.DiagnosticCategory.Error,"Unexpected_token_1012","Unexpected token."),A_rest_parameter_must_be_last_in_a_parameter_list:t(1014,e.DiagnosticCategory.Error,"A_rest_parameter_must_be_last_in_a_parameter_list_1014","A rest parameter must be last in a parameter list."),Parameter_cannot_have_question_mark_and_initializer:t(1015,e.DiagnosticCategory.Error,"Parameter_cannot_have_question_mark_and_initializer_1015","Parameter cannot have question mark and initializer."),A_required_parameter_cannot_follow_an_optional_parameter:t(1016,e.DiagnosticCategory.Error,"A_required_parameter_cannot_follow_an_optional_parameter_1016","A required parameter cannot follow an optional parameter."),An_index_signature_cannot_have_a_rest_parameter:t(1017,e.DiagnosticCategory.Error,"An_index_signature_cannot_have_a_rest_parameter_1017","An index signature cannot have a rest parameter."),An_index_signature_parameter_cannot_have_an_accessibility_modifier:t(1018,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_an_accessibility_modifier_1018","An index signature parameter cannot have an accessibility modifier."),An_index_signature_parameter_cannot_have_a_question_mark:t(1019,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_a_question_mark_1019","An index signature parameter cannot have a question mark."),An_index_signature_parameter_cannot_have_an_initializer:t(1020,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_an_initializer_1020","An index signature parameter cannot have an initializer."),An_index_signature_must_have_a_type_annotation:t(1021,e.DiagnosticCategory.Error,"An_index_signature_must_have_a_type_annotation_1021","An index signature must have a type annotation."),An_index_signature_parameter_must_have_a_type_annotation:t(1022,e.DiagnosticCategory.Error,"An_index_signature_parameter_must_have_a_type_annotation_1022","An index signature parameter must have a type annotation."),An_index_signature_parameter_type_must_be_string_or_number:t(1023,e.DiagnosticCategory.Error,"An_index_signature_parameter_type_must_be_string_or_number_1023","An index signature parameter type must be 'string' or 'number'."),readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature:t(1024,e.DiagnosticCategory.Error,"readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature_1024","'readonly' modifier can only appear on a property declaration or index signature."),Accessibility_modifier_already_seen:t(1028,e.DiagnosticCategory.Error,"Accessibility_modifier_already_seen_1028","Accessibility modifier already seen."),_0_modifier_must_precede_1_modifier:t(1029,e.DiagnosticCategory.Error,"_0_modifier_must_precede_1_modifier_1029","'{0}' modifier must precede '{1}' modifier."),_0_modifier_already_seen:t(1030,e.DiagnosticCategory.Error,"_0_modifier_already_seen_1030","'{0}' modifier already seen."),_0_modifier_cannot_appear_on_a_class_element:t(1031,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_class_element_1031","'{0}' modifier cannot appear on a class element."),super_must_be_followed_by_an_argument_list_or_member_access:t(1034,e.DiagnosticCategory.Error,"super_must_be_followed_by_an_argument_list_or_member_access_1034","'super' must be followed by an argument list or member access."),Only_ambient_modules_can_use_quoted_names:t(1035,e.DiagnosticCategory.Error,"Only_ambient_modules_can_use_quoted_names_1035","Only ambient modules can use quoted names."),Statements_are_not_allowed_in_ambient_contexts:t(1036,e.DiagnosticCategory.Error,"Statements_are_not_allowed_in_ambient_contexts_1036","Statements are not allowed in ambient contexts."),A_declare_modifier_cannot_be_used_in_an_already_ambient_context:t(1038,e.DiagnosticCategory.Error,"A_declare_modifier_cannot_be_used_in_an_already_ambient_context_1038","A 'declare' modifier cannot be used in an already ambient context."),Initializers_are_not_allowed_in_ambient_contexts:t(1039,e.DiagnosticCategory.Error,"Initializers_are_not_allowed_in_ambient_contexts_1039","Initializers are not allowed in ambient contexts."),_0_modifier_cannot_be_used_in_an_ambient_context:t(1040,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_in_an_ambient_context_1040","'{0}' modifier cannot be used in an ambient context."),_0_modifier_cannot_be_used_with_a_class_declaration:t(1041,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_with_a_class_declaration_1041","'{0}' modifier cannot be used with a class declaration."),_0_modifier_cannot_be_used_here:t(1042,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_here_1042","'{0}' modifier cannot be used here."),_0_modifier_cannot_appear_on_a_data_property:t(1043,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_data_property_1043","'{0}' modifier cannot appear on a data property."),_0_modifier_cannot_appear_on_a_module_or_namespace_element:t(1044,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_module_or_namespace_element_1044","'{0}' modifier cannot appear on a module or namespace element."),A_0_modifier_cannot_be_used_with_an_interface_declaration:t(1045,e.DiagnosticCategory.Error,"A_0_modifier_cannot_be_used_with_an_interface_declaration_1045","A '{0}' modifier cannot be used with an interface declaration."),A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file:t(1046,e.DiagnosticCategory.Error,"A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file_1046","A 'declare' modifier is required for a top level declaration in a .d.ts file."),A_rest_parameter_cannot_be_optional:t(1047,e.DiagnosticCategory.Error,"A_rest_parameter_cannot_be_optional_1047","A rest parameter cannot be optional."),A_rest_parameter_cannot_have_an_initializer:t(1048,e.DiagnosticCategory.Error,"A_rest_parameter_cannot_have_an_initializer_1048","A rest parameter cannot have an initializer."),A_set_accessor_must_have_exactly_one_parameter:t(1049,e.DiagnosticCategory.Error,"A_set_accessor_must_have_exactly_one_parameter_1049","A 'set' accessor must have exactly one parameter."),A_set_accessor_cannot_have_an_optional_parameter:t(1051,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_an_optional_parameter_1051","A 'set' accessor cannot have an optional parameter."),A_set_accessor_parameter_cannot_have_an_initializer:t(1052,e.DiagnosticCategory.Error,"A_set_accessor_parameter_cannot_have_an_initializer_1052","A 'set' accessor parameter cannot have an initializer."),A_set_accessor_cannot_have_rest_parameter:t(1053,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_rest_parameter_1053","A 'set' accessor cannot have rest parameter."),A_get_accessor_cannot_have_parameters:t(1054,e.DiagnosticCategory.Error,"A_get_accessor_cannot_have_parameters_1054","A 'get' accessor cannot have parameters."),Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value:t(1055,e.DiagnosticCategory.Error,"Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Prom_1055","Type '{0}' is not a valid async function return type in ES5/ES3 because it does not refer to a Promise-compatible constructor value."),Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher:t(1056,e.DiagnosticCategory.Error,"Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher_1056","Accessors are only available when targeting ECMAScript 5 and higher."),An_async_function_or_method_must_have_a_valid_awaitable_return_type:t(1057,e.DiagnosticCategory.Error,"An_async_function_or_method_must_have_a_valid_awaitable_return_type_1057","An async function or method must have a valid awaitable return type."),The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1058,e.DiagnosticCategory.Error,"The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_t_1058","The return type of an async function must either be a valid promise or must not contain a callable 'then' member."),A_promise_must_have_a_then_method:t(1059,e.DiagnosticCategory.Error,"A_promise_must_have_a_then_method_1059","A promise must have a 'then' method."),The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback:t(1060,e.DiagnosticCategory.Error,"The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback_1060","The first parameter of the 'then' method of a promise must be a callback."),Enum_member_must_have_initializer:t(1061,e.DiagnosticCategory.Error,"Enum_member_must_have_initializer_1061","Enum member must have initializer."),Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method:t(1062,e.DiagnosticCategory.Error,"Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method_1062","Type is referenced directly or indirectly in the fulfillment callback of its own 'then' method."),An_export_assignment_cannot_be_used_in_a_namespace:t(1063,e.DiagnosticCategory.Error,"An_export_assignment_cannot_be_used_in_a_namespace_1063","An export assignment cannot be used in a namespace."),The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type:t(1064,e.DiagnosticCategory.Error,"The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type_1064","The return type of an async function or method must be the global Promise<T> type."),In_ambient_enum_declarations_member_initializer_must_be_constant_expression:t(1066,e.DiagnosticCategory.Error,"In_ambient_enum_declarations_member_initializer_must_be_constant_expression_1066","In ambient enum declarations member initializer must be constant expression."),Unexpected_token_A_constructor_method_accessor_or_property_was_expected:t(1068,e.DiagnosticCategory.Error,"Unexpected_token_A_constructor_method_accessor_or_property_was_expected_1068","Unexpected token. A constructor, method, accessor, or property was expected."),_0_modifier_cannot_appear_on_a_type_member:t(1070,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_type_member_1070","'{0}' modifier cannot appear on a type member."),_0_modifier_cannot_appear_on_an_index_signature:t(1071,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_an_index_signature_1071","'{0}' modifier cannot appear on an index signature."),A_0_modifier_cannot_be_used_with_an_import_declaration:t(1079,e.DiagnosticCategory.Error,"A_0_modifier_cannot_be_used_with_an_import_declaration_1079","A '{0}' modifier cannot be used with an import declaration."),Invalid_reference_directive_syntax:t(1084,e.DiagnosticCategory.Error,"Invalid_reference_directive_syntax_1084","Invalid 'reference' directive syntax."),Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0:t(1085,e.DiagnosticCategory.Error,"Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0_1085","Octal literals are not available when targeting ECMAScript 5 and higher. Use the syntax '{0}'."),An_accessor_cannot_be_declared_in_an_ambient_context:t(1086,e.DiagnosticCategory.Error,"An_accessor_cannot_be_declared_in_an_ambient_context_1086","An accessor cannot be declared in an ambient context."),_0_modifier_cannot_appear_on_a_constructor_declaration:t(1089,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_constructor_declaration_1089","'{0}' modifier cannot appear on a constructor declaration."),_0_modifier_cannot_appear_on_a_parameter:t(1090,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_parameter_1090","'{0}' modifier cannot appear on a parameter."),Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement:t(1091,e.DiagnosticCategory.Error,"Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement_1091","Only a single variable declaration is allowed in a 'for...in' statement."),Type_parameters_cannot_appear_on_a_constructor_declaration:t(1092,e.DiagnosticCategory.Error,"Type_parameters_cannot_appear_on_a_constructor_declaration_1092","Type parameters cannot appear on a constructor declaration."),Type_annotation_cannot_appear_on_a_constructor_declaration:t(1093,e.DiagnosticCategory.Error,"Type_annotation_cannot_appear_on_a_constructor_declaration_1093","Type annotation cannot appear on a constructor declaration."),An_accessor_cannot_have_type_parameters:t(1094,e.DiagnosticCategory.Error,"An_accessor_cannot_have_type_parameters_1094","An accessor cannot have type parameters."),A_set_accessor_cannot_have_a_return_type_annotation:t(1095,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_a_return_type_annotation_1095","A 'set' accessor cannot have a return type annotation."),An_index_signature_must_have_exactly_one_parameter:t(1096,e.DiagnosticCategory.Error,"An_index_signature_must_have_exactly_one_parameter_1096","An index signature must have exactly one parameter."),_0_list_cannot_be_empty:t(1097,e.DiagnosticCategory.Error,"_0_list_cannot_be_empty_1097","'{0}' list cannot be empty."),Type_parameter_list_cannot_be_empty:t(1098,e.DiagnosticCategory.Error,"Type_parameter_list_cannot_be_empty_1098","Type parameter list cannot be empty."),Type_argument_list_cannot_be_empty:t(1099,e.DiagnosticCategory.Error,"Type_argument_list_cannot_be_empty_1099","Type argument list cannot be empty."),Invalid_use_of_0_in_strict_mode:t(1100,e.DiagnosticCategory.Error,"Invalid_use_of_0_in_strict_mode_1100","Invalid use of '{0}' in strict mode."),with_statements_are_not_allowed_in_strict_mode:t(1101,e.DiagnosticCategory.Error,"with_statements_are_not_allowed_in_strict_mode_1101","'with' statements are not allowed in strict mode."),delete_cannot_be_called_on_an_identifier_in_strict_mode:t(1102,e.DiagnosticCategory.Error,"delete_cannot_be_called_on_an_identifier_in_strict_mode_1102","'delete' cannot be called on an identifier in strict mode."),A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator:t(1103,e.DiagnosticCategory.Error,"A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator_1103","A 'for-await-of' statement is only allowed within an async function or async generator."),A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement:t(1104,e.DiagnosticCategory.Error,"A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement_1104","A 'continue' statement can only be used within an enclosing iteration statement."),A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement:t(1105,e.DiagnosticCategory.Error,"A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement_1105","A 'break' statement can only be used within an enclosing iteration or switch statement."),Jump_target_cannot_cross_function_boundary:t(1107,e.DiagnosticCategory.Error,"Jump_target_cannot_cross_function_boundary_1107","Jump target cannot cross function boundary."),A_return_statement_can_only_be_used_within_a_function_body:t(1108,e.DiagnosticCategory.Error,"A_return_statement_can_only_be_used_within_a_function_body_1108","A 'return' statement can only be used within a function body."),Expression_expected:t(1109,e.DiagnosticCategory.Error,"Expression_expected_1109","Expression expected."),Type_expected:t(1110,e.DiagnosticCategory.Error,"Type_expected_1110","Type expected."),A_default_clause_cannot_appear_more_than_once_in_a_switch_statement:t(1113,e.DiagnosticCategory.Error,"A_default_clause_cannot_appear_more_than_once_in_a_switch_statement_1113","A 'default' clause cannot appear more than once in a 'switch' statement."),Duplicate_label_0:t(1114,e.DiagnosticCategory.Error,"Duplicate_label_0_1114","Duplicate label '{0}'."),A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement:t(1115,e.DiagnosticCategory.Error,"A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement_1115","A 'continue' statement can only jump to a label of an enclosing iteration statement."),A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement:t(1116,e.DiagnosticCategory.Error,"A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement_1116","A 'break' statement can only jump to a label of an enclosing statement."),An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode:t(1117,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode_1117","An object literal cannot have multiple properties with the same name in strict mode."),An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name:t(1118,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name_1118","An object literal cannot have multiple get/set accessors with the same name."),An_object_literal_cannot_have_property_and_accessor_with_the_same_name:t(1119,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_property_and_accessor_with_the_same_name_1119","An object literal cannot have property and accessor with the same name."),An_export_assignment_cannot_have_modifiers:t(1120,e.DiagnosticCategory.Error,"An_export_assignment_cannot_have_modifiers_1120","An export assignment cannot have modifiers."),Octal_literals_are_not_allowed_in_strict_mode:t(1121,e.DiagnosticCategory.Error,"Octal_literals_are_not_allowed_in_strict_mode_1121","Octal literals are not allowed in strict mode."),A_tuple_type_element_list_cannot_be_empty:t(1122,e.DiagnosticCategory.Error,"A_tuple_type_element_list_cannot_be_empty_1122","A tuple type element list cannot be empty."),Variable_declaration_list_cannot_be_empty:t(1123,e.DiagnosticCategory.Error,"Variable_declaration_list_cannot_be_empty_1123","Variable declaration list cannot be empty."),Digit_expected:t(1124,e.DiagnosticCategory.Error,"Digit_expected_1124","Digit expected."),Hexadecimal_digit_expected:t(1125,e.DiagnosticCategory.Error,"Hexadecimal_digit_expected_1125","Hexadecimal digit expected."),Unexpected_end_of_text:t(1126,e.DiagnosticCategory.Error,"Unexpected_end_of_text_1126","Unexpected end of text."),Invalid_character:t(1127,e.DiagnosticCategory.Error,"Invalid_character_1127","Invalid character."),Declaration_or_statement_expected:t(1128,e.DiagnosticCategory.Error,"Declaration_or_statement_expected_1128","Declaration or statement expected."),Statement_expected:t(1129,e.DiagnosticCategory.Error,"Statement_expected_1129","Statement expected."),case_or_default_expected:t(1130,e.DiagnosticCategory.Error,"case_or_default_expected_1130","'case' or 'default' expected."),Property_or_signature_expected:t(1131,e.DiagnosticCategory.Error,"Property_or_signature_expected_1131","Property or signature expected."),Enum_member_expected:t(1132,e.DiagnosticCategory.Error,"Enum_member_expected_1132","Enum member expected."),Variable_declaration_expected:t(1134,e.DiagnosticCategory.Error,"Variable_declaration_expected_1134","Variable declaration expected."),Argument_expression_expected:t(1135,e.DiagnosticCategory.Error,"Argument_expression_expected_1135","Argument expression expected."),Property_assignment_expected:t(1136,e.DiagnosticCategory.Error,"Property_assignment_expected_1136","Property assignment expected."),Expression_or_comma_expected:t(1137,e.DiagnosticCategory.Error,"Expression_or_comma_expected_1137","Expression or comma expected."),Parameter_declaration_expected:t(1138,e.DiagnosticCategory.Error,"Parameter_declaration_expected_1138","Parameter declaration expected."),Type_parameter_declaration_expected:t(1139,e.DiagnosticCategory.Error,"Type_parameter_declaration_expected_1139","Type parameter declaration expected."),Type_argument_expected:t(1140,e.DiagnosticCategory.Error,"Type_argument_expected_1140","Type argument expected."),String_literal_expected:t(1141,e.DiagnosticCategory.Error,"String_literal_expected_1141","String literal expected."),Line_break_not_permitted_here:t(1142,e.DiagnosticCategory.Error,"Line_break_not_permitted_here_1142","Line break not permitted here."),or_expected:t(1144,e.DiagnosticCategory.Error,"or_expected_1144","'{' or ';' expected."),Declaration_expected:t(1146,e.DiagnosticCategory.Error,"Declaration_expected_1146","Declaration expected."),Import_declarations_in_a_namespace_cannot_reference_a_module:t(1147,e.DiagnosticCategory.Error,"Import_declarations_in_a_namespace_cannot_reference_a_module_1147","Import declarations in a namespace cannot reference a module."),Cannot_use_imports_exports_or_module_augmentations_when_module_is_none:t(1148,e.DiagnosticCategory.Error,"Cannot_use_imports_exports_or_module_augmentations_when_module_is_none_1148","Cannot use imports, exports, or module augmentations when '--module' is 'none'."),File_name_0_differs_from_already_included_file_name_1_only_in_casing:t(1149,e.DiagnosticCategory.Error,"File_name_0_differs_from_already_included_file_name_1_only_in_casing_1149","File name '{0}' differs from already included file name '{1}' only in casing."),new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead:t(1150,e.DiagnosticCategory.Error,"new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead_1150","'new T[]' cannot be used to create an array. Use 'new Array<T>()' instead."),const_declarations_must_be_initialized:t(1155,e.DiagnosticCategory.Error,"const_declarations_must_be_initialized_1155","'const' declarations must be initialized."),const_declarations_can_only_be_declared_inside_a_block:t(1156,e.DiagnosticCategory.Error,"const_declarations_can_only_be_declared_inside_a_block_1156","'const' declarations can only be declared inside a block."),let_declarations_can_only_be_declared_inside_a_block:t(1157,e.DiagnosticCategory.Error,"let_declarations_can_only_be_declared_inside_a_block_1157","'let' declarations can only be declared inside a block."),Unterminated_template_literal:t(1160,e.DiagnosticCategory.Error,"Unterminated_template_literal_1160","Unterminated template literal."),Unterminated_regular_expression_literal:t(1161,e.DiagnosticCategory.Error,"Unterminated_regular_expression_literal_1161","Unterminated regular expression literal."),An_object_member_cannot_be_declared_optional:t(1162,e.DiagnosticCategory.Error,"An_object_member_cannot_be_declared_optional_1162","An object member cannot be declared optional."),A_yield_expression_is_only_allowed_in_a_generator_body:t(1163,e.DiagnosticCategory.Error,"A_yield_expression_is_only_allowed_in_a_generator_body_1163","A 'yield' expression is only allowed in a generator body."),Computed_property_names_are_not_allowed_in_enums:t(1164,e.DiagnosticCategory.Error,"Computed_property_names_are_not_allowed_in_enums_1164","Computed property names are not allowed in enums."),A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol:t(1165,e.DiagnosticCategory.Error,"A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol_1165","A computed property name in an ambient context must directly refer to a built-in symbol."),A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol:t(1166,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol_1166","A computed property name in a class property declaration must directly refer to a built-in symbol."),A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol:t(1168,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol_1168","A computed property name in a method overload must directly refer to a built-in symbol."),A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol:t(1169,e.DiagnosticCategory.Error,"A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol_1169","A computed property name in an interface must directly refer to a built-in symbol."),A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol:t(1170,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol_1170","A computed property name in a type literal must directly refer to a built-in symbol."),A_comma_expression_is_not_allowed_in_a_computed_property_name:t(1171,e.DiagnosticCategory.Error,"A_comma_expression_is_not_allowed_in_a_computed_property_name_1171","A comma expression is not allowed in a computed property name."),extends_clause_already_seen:t(1172,e.DiagnosticCategory.Error,"extends_clause_already_seen_1172","'extends' clause already seen."),extends_clause_must_precede_implements_clause:t(1173,e.DiagnosticCategory.Error,"extends_clause_must_precede_implements_clause_1173","'extends' clause must precede 'implements' clause."),Classes_can_only_extend_a_single_class:t(1174,e.DiagnosticCategory.Error,"Classes_can_only_extend_a_single_class_1174","Classes can only extend a single class."),implements_clause_already_seen:t(1175,e.DiagnosticCategory.Error,"implements_clause_already_seen_1175","'implements' clause already seen."),Interface_declaration_cannot_have_implements_clause:t(1176,e.DiagnosticCategory.Error,"Interface_declaration_cannot_have_implements_clause_1176","Interface declaration cannot have 'implements' clause."),Binary_digit_expected:t(1177,e.DiagnosticCategory.Error,"Binary_digit_expected_1177","Binary digit expected."),Octal_digit_expected:t(1178,e.DiagnosticCategory.Error,"Octal_digit_expected_1178","Octal digit expected."),Unexpected_token_expected:t(1179,e.DiagnosticCategory.Error,"Unexpected_token_expected_1179","Unexpected token. '{' expected."),Property_destructuring_pattern_expected:t(1180,e.DiagnosticCategory.Error,"Property_destructuring_pattern_expected_1180","Property destructuring pattern expected."),Array_element_destructuring_pattern_expected:t(1181,e.DiagnosticCategory.Error,"Array_element_destructuring_pattern_expected_1181","Array element destructuring pattern expected."),A_destructuring_declaration_must_have_an_initializer:t(1182,e.DiagnosticCategory.Error,"A_destructuring_declaration_must_have_an_initializer_1182","A destructuring declaration must have an initializer."),An_implementation_cannot_be_declared_in_ambient_contexts:t(1183,e.DiagnosticCategory.Error,"An_implementation_cannot_be_declared_in_ambient_contexts_1183","An implementation cannot be declared in ambient contexts."),Modifiers_cannot_appear_here:t(1184,e.DiagnosticCategory.Error,"Modifiers_cannot_appear_here_1184","Modifiers cannot appear here."),Merge_conflict_marker_encountered:t(1185,e.DiagnosticCategory.Error,"Merge_conflict_marker_encountered_1185","Merge conflict marker encountered."),A_rest_element_cannot_have_an_initializer:t(1186,e.DiagnosticCategory.Error,"A_rest_element_cannot_have_an_initializer_1186","A rest element cannot have an initializer."),A_parameter_property_may_not_be_declared_using_a_binding_pattern:t(1187,e.DiagnosticCategory.Error,"A_parameter_property_may_not_be_declared_using_a_binding_pattern_1187","A parameter property may not be declared using a binding pattern."),Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement:t(1188,e.DiagnosticCategory.Error,"Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement_1188","Only a single variable declaration is allowed in a 'for...of' statement."),The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer:t(1189,e.DiagnosticCategory.Error,"The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer_1189","The variable declaration of a 'for...in' statement cannot have an initializer."),The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer:t(1190,e.DiagnosticCategory.Error,"The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer_1190","The variable declaration of a 'for...of' statement cannot have an initializer."),An_import_declaration_cannot_have_modifiers:t(1191,e.DiagnosticCategory.Error,"An_import_declaration_cannot_have_modifiers_1191","An import declaration cannot have modifiers."),Module_0_has_no_default_export:t(1192,e.DiagnosticCategory.Error,"Module_0_has_no_default_export_1192","Module '{0}' has no default export."),An_export_declaration_cannot_have_modifiers:t(1193,e.DiagnosticCategory.Error,"An_export_declaration_cannot_have_modifiers_1193","An export declaration cannot have modifiers."),Export_declarations_are_not_permitted_in_a_namespace:t(1194,e.DiagnosticCategory.Error,"Export_declarations_are_not_permitted_in_a_namespace_1194","Export declarations are not permitted in a namespace."),Catch_clause_variable_cannot_have_a_type_annotation:t(1196,e.DiagnosticCategory.Error,"Catch_clause_variable_cannot_have_a_type_annotation_1196","Catch clause variable cannot have a type annotation."),Catch_clause_variable_cannot_have_an_initializer:t(1197,e.DiagnosticCategory.Error,"Catch_clause_variable_cannot_have_an_initializer_1197","Catch clause variable cannot have an initializer."),An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive:t(1198,e.DiagnosticCategory.Error,"An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive_1198","An extended Unicode escape value must be between 0x0 and 0x10FFFF inclusive."),Unterminated_Unicode_escape_sequence:t(1199,e.DiagnosticCategory.Error,"Unterminated_Unicode_escape_sequence_1199","Unterminated Unicode escape sequence."),Line_terminator_not_permitted_before_arrow:t(1200,e.DiagnosticCategory.Error,"Line_terminator_not_permitted_before_arrow_1200","Line terminator not permitted before arrow."),Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_ns_from_mod_import_a_from_mod_import_d_from_mod_or_another_module_format_instead:t(1202,e.DiagnosticCategory.Error,"Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_1202","Import assignment cannot be used when targeting ECMAScript modules. Consider using 'import * as ns from \"mod\"', 'import {a} from \"mod\"', 'import d from \"mod\"', or another module format instead."),Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or_another_module_format_instead:t(1203,e.DiagnosticCategory.Error,"Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or__1203","Export assignment cannot be used when targeting ECMAScript modules. Consider using 'export default' or another module format instead."),Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided:t(1205,e.DiagnosticCategory.Error,"Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided_1205","Cannot re-export a type when the '--isolatedModules' flag is provided."),Decorators_are_not_valid_here:t(1206,e.DiagnosticCategory.Error,"Decorators_are_not_valid_here_1206","Decorators are not valid here."),Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name:t(1207,e.DiagnosticCategory.Error,"Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name_1207","Decorators cannot be applied to multiple get/set accessors of the same name."),Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided:t(1208,e.DiagnosticCategory.Error,"Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided_1208","Cannot compile namespaces when the '--isolatedModules' flag is provided."),Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided:t(1209,e.DiagnosticCategory.Error,"Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided_1209","Ambient const enums are not allowed when the '--isolatedModules' flag is provided."),Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode:t(1210,e.DiagnosticCategory.Error,"Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode_1210","Invalid use of '{0}'. Class definitions are automatically in strict mode."),A_class_declaration_without_the_default_modifier_must_have_a_name:t(1211,e.DiagnosticCategory.Error,"A_class_declaration_without_the_default_modifier_must_have_a_name_1211","A class declaration without the 'default' modifier must have a name."),Identifier_expected_0_is_a_reserved_word_in_strict_mode:t(1212,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_1212","Identifier expected. '{0}' is a reserved word in strict mode."),Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_strict_mode:t(1213,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_stric_1213","Identifier expected. '{0}' is a reserved word in strict mode. Class definitions are automatically in strict mode."),Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode:t(1214,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode_1214","Identifier expected. '{0}' is a reserved word in strict mode. Modules are automatically in strict mode."),Invalid_use_of_0_Modules_are_automatically_in_strict_mode:t(1215,e.DiagnosticCategory.Error,"Invalid_use_of_0_Modules_are_automatically_in_strict_mode_1215","Invalid use of '{0}'. Modules are automatically in strict mode."),Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules:t(1216,e.DiagnosticCategory.Error,"Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules_1216","Identifier expected. '__esModule' is reserved as an exported marker when transforming ECMAScript modules."),Export_assignment_is_not_supported_when_module_flag_is_system:t(1218,e.DiagnosticCategory.Error,"Export_assignment_is_not_supported_when_module_flag_is_system_1218","Export assignment is not supported when '--module' flag is 'system'."),Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning:t(1219,e.DiagnosticCategory.Error,"Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_t_1219","Experimental support for decorators is a feature that is subject to change in a future release. Set the 'experimentalDecorators' option to remove this warning."),Generators_are_only_available_when_targeting_ECMAScript_2015_or_higher:t(1220,e.DiagnosticCategory.Error,"Generators_are_only_available_when_targeting_ECMAScript_2015_or_higher_1220","Generators are only available when targeting ECMAScript 2015 or higher."),Generators_are_not_allowed_in_an_ambient_context:t(1221,e.DiagnosticCategory.Error,"Generators_are_not_allowed_in_an_ambient_context_1221","Generators are not allowed in an ambient context."),An_overload_signature_cannot_be_declared_as_a_generator:t(1222,e.DiagnosticCategory.Error,"An_overload_signature_cannot_be_declared_as_a_generator_1222","An overload signature cannot be declared as a generator."),_0_tag_already_specified:t(1223,e.DiagnosticCategory.Error,"_0_tag_already_specified_1223","'{0}' tag already specified."),Signature_0_must_be_a_type_predicate:t(1224,e.DiagnosticCategory.Error,"Signature_0_must_be_a_type_predicate_1224","Signature '{0}' must be a type predicate."),Cannot_find_parameter_0:t(1225,e.DiagnosticCategory.Error,"Cannot_find_parameter_0_1225","Cannot find parameter '{0}'."),Type_predicate_0_is_not_assignable_to_1:t(1226,e.DiagnosticCategory.Error,"Type_predicate_0_is_not_assignable_to_1_1226","Type predicate '{0}' is not assignable to '{1}'."),Parameter_0_is_not_in_the_same_position_as_parameter_1:t(1227,e.DiagnosticCategory.Error,"Parameter_0_is_not_in_the_same_position_as_parameter_1_1227","Parameter '{0}' is not in the same position as parameter '{1}'."),A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods:t(1228,e.DiagnosticCategory.Error,"A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods_1228","A type predicate is only allowed in return type position for functions and methods."),A_type_predicate_cannot_reference_a_rest_parameter:t(1229,e.DiagnosticCategory.Error,"A_type_predicate_cannot_reference_a_rest_parameter_1229","A type predicate cannot reference a rest parameter."),A_type_predicate_cannot_reference_element_0_in_a_binding_pattern:t(1230,e.DiagnosticCategory.Error,"A_type_predicate_cannot_reference_element_0_in_a_binding_pattern_1230","A type predicate cannot reference element '{0}' in a binding pattern."),An_export_assignment_can_only_be_used_in_a_module:t(1231,e.DiagnosticCategory.Error,"An_export_assignment_can_only_be_used_in_a_module_1231","An export assignment can only be used in a module."),An_import_declaration_can_only_be_used_in_a_namespace_or_module:t(1232,e.DiagnosticCategory.Error,"An_import_declaration_can_only_be_used_in_a_namespace_or_module_1232","An import declaration can only be used in a namespace or module."),An_export_declaration_can_only_be_used_in_a_module:t(1233,e.DiagnosticCategory.Error,"An_export_declaration_can_only_be_used_in_a_module_1233","An export declaration can only be used in a module."),An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file:t(1234,e.DiagnosticCategory.Error,"An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file_1234","An ambient module declaration is only allowed at the top level in a file."),A_namespace_declaration_is_only_allowed_in_a_namespace_or_module:t(1235,e.DiagnosticCategory.Error,"A_namespace_declaration_is_only_allowed_in_a_namespace_or_module_1235","A namespace declaration is only allowed in a namespace or module."),The_return_type_of_a_property_decorator_function_must_be_either_void_or_any:t(1236,e.DiagnosticCategory.Error,"The_return_type_of_a_property_decorator_function_must_be_either_void_or_any_1236","The return type of a property decorator function must be either 'void' or 'any'."),The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any:t(1237,e.DiagnosticCategory.Error,"The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any_1237","The return type of a parameter decorator function must be either 'void' or 'any'."),Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression:t(1238,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression_1238","Unable to resolve signature of class decorator when called as an expression."),Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression:t(1239,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression_1239","Unable to resolve signature of parameter decorator when called as an expression."),Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression:t(1240,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression_1240","Unable to resolve signature of property decorator when called as an expression."),Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression:t(1241,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression_1241","Unable to resolve signature of method decorator when called as an expression."),abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration:t(1242,e.DiagnosticCategory.Error,"abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration_1242","'abstract' modifier can only appear on a class, method, or property declaration."),_0_modifier_cannot_be_used_with_1_modifier:t(1243,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_with_1_modifier_1243","'{0}' modifier cannot be used with '{1}' modifier."),Abstract_methods_can_only_appear_within_an_abstract_class:t(1244,e.DiagnosticCategory.Error,"Abstract_methods_can_only_appear_within_an_abstract_class_1244","Abstract methods can only appear within an abstract class."),Method_0_cannot_have_an_implementation_because_it_is_marked_abstract:t(1245,e.DiagnosticCategory.Error,"Method_0_cannot_have_an_implementation_because_it_is_marked_abstract_1245","Method '{0}' cannot have an implementation because it is marked abstract."),An_interface_property_cannot_have_an_initializer:t(1246,e.DiagnosticCategory.Error,"An_interface_property_cannot_have_an_initializer_1246","An interface property cannot have an initializer."),A_type_literal_property_cannot_have_an_initializer:t(1247,e.DiagnosticCategory.Error,"A_type_literal_property_cannot_have_an_initializer_1247","A type literal property cannot have an initializer."),A_class_member_cannot_have_the_0_keyword:t(1248,e.DiagnosticCategory.Error,"A_class_member_cannot_have_the_0_keyword_1248","A class member cannot have the '{0}' keyword."),A_decorator_can_only_decorate_a_method_implementation_not_an_overload:t(1249,e.DiagnosticCategory.Error,"A_decorator_can_only_decorate_a_method_implementation_not_an_overload_1249","A decorator can only decorate a method implementation, not an overload."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5:t(1250,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_1250","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_definitions_are_automatically_in_strict_mode:t(1251,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_d_1251","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'. Class definitions are automatically in strict mode."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_are_automatically_in_strict_mode:t(1252,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_1252","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'. Modules are automatically in strict mode."),_0_tag_cannot_be_used_independently_as_a_top_level_JSDoc_tag:t(1253,e.DiagnosticCategory.Error,"_0_tag_cannot_be_used_independently_as_a_top_level_JSDoc_tag_1253","'{0}' tag cannot be used independently as a top level JSDoc tag."),A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal:t(1254,e.DiagnosticCategory.Error,"A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal_1254","A 'const' initializer in an ambient context must be a string or numeric literal."),with_statements_are_not_allowed_in_an_async_function_block:t(1300,e.DiagnosticCategory.Error,"with_statements_are_not_allowed_in_an_async_function_block_1300","'with' statements are not allowed in an async function block."),await_expression_is_only_allowed_within_an_async_function:t(1308,e.DiagnosticCategory.Error,"await_expression_is_only_allowed_within_an_async_function_1308","'await' expression is only allowed within an async function."),can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment:t(1312,e.DiagnosticCategory.Error,"can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment_1312","'=' can only be used in an object literal property inside a destructuring assignment."),The_body_of_an_if_statement_cannot_be_the_empty_statement:t(1313,e.DiagnosticCategory.Error,"The_body_of_an_if_statement_cannot_be_the_empty_statement_1313","The body of an 'if' statement cannot be the empty statement."),Global_module_exports_may_only_appear_in_module_files:t(1314,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_in_module_files_1314","Global module exports may only appear in module files."),Global_module_exports_may_only_appear_in_declaration_files:t(1315,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_in_declaration_files_1315","Global module exports may only appear in declaration files."),Global_module_exports_may_only_appear_at_top_level:t(1316,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_at_top_level_1316","Global module exports may only appear at top level."),A_parameter_property_cannot_be_declared_using_a_rest_parameter:t(1317,e.DiagnosticCategory.Error,"A_parameter_property_cannot_be_declared_using_a_rest_parameter_1317","A parameter property cannot be declared using a rest parameter."),An_abstract_accessor_cannot_have_an_implementation:t(1318,e.DiagnosticCategory.Error,"An_abstract_accessor_cannot_have_an_implementation_1318","An abstract accessor cannot have an implementation."),A_default_export_can_only_be_used_in_an_ECMAScript_style_module:t(1319,e.DiagnosticCategory.Error,"A_default_export_can_only_be_used_in_an_ECMAScript_style_module_1319","A default export can only be used in an ECMAScript-style module."),Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1320,e.DiagnosticCategory.Error,"Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member_1320","Type of 'await' operand must either be a valid promise or must not contain a callable 'then' member."),Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1321,e.DiagnosticCategory.Error,"Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_cal_1321","Type of 'yield' operand in an async generator must either be a valid promise or must not contain a callable 'then' member."),Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1322,e.DiagnosticCategory.Error,"Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_con_1322","Type of iterated elements of a 'yield*' operand must either be a valid promise or must not contain a callable 'then' member."),Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules:t(1323,e.DiagnosticCategory.Error,"Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules_1323","Dynamic import cannot be used when targeting ECMAScript 2015 modules."),Dynamic_import_must_have_one_specifier_as_an_argument:t(1324,e.DiagnosticCategory.Error,"Dynamic_import_must_have_one_specifier_as_an_argument_1324","Dynamic import must have one specifier as an argument."),Specifier_of_dynamic_import_cannot_be_spread_element:t(1325,e.DiagnosticCategory.Error,"Specifier_of_dynamic_import_cannot_be_spread_element_1325","Specifier of dynamic import cannot be spread element."),Dynamic_import_cannot_have_type_arguments:t(1326,e.DiagnosticCategory.Error,"Dynamic_import_cannot_have_type_arguments_1326","Dynamic import cannot have type arguments"),String_literal_with_double_quotes_expected:t(1327,e.DiagnosticCategory.Error,"String_literal_with_double_quotes_expected_1327","String literal with double quotes expected."),Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_literal:t(1328,e.DiagnosticCategory.Error,"Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_li_1328","Property value can only be string literal, numeric literal, 'true', 'false', 'null', object literal or array literal."),_0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0:t(1329,e.DiagnosticCategory.Error,"_0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write__1329","'{0}' accepts too few arguments to be used as a decorator here. Did you mean to call it first and write '@{0}()'?"),Duplicate_identifier_0:t(2300,e.DiagnosticCategory.Error,"Duplicate_identifier_0_2300","Duplicate identifier '{0}'."),Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor:t(2301,e.DiagnosticCategory.Error,"Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor_2301","Initializer of instance member variable '{0}' cannot reference identifier '{1}' declared in the constructor."),Static_members_cannot_reference_class_type_parameters:t(2302,e.DiagnosticCategory.Error,"Static_members_cannot_reference_class_type_parameters_2302","Static members cannot reference class type parameters."),Circular_definition_of_import_alias_0:t(2303,e.DiagnosticCategory.Error,"Circular_definition_of_import_alias_0_2303","Circular definition of import alias '{0}'."),Cannot_find_name_0:t(2304,e.DiagnosticCategory.Error,"Cannot_find_name_0_2304","Cannot find name '{0}'."),Module_0_has_no_exported_member_1:t(2305,e.DiagnosticCategory.Error,"Module_0_has_no_exported_member_1_2305","Module '{0}' has no exported member '{1}'."),File_0_is_not_a_module:t(2306,e.DiagnosticCategory.Error,"File_0_is_not_a_module_2306","File '{0}' is not a module."),Cannot_find_module_0:t(2307,e.DiagnosticCategory.Error,"Cannot_find_module_0_2307","Cannot find module '{0}'."),Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambiguity:t(2308,e.DiagnosticCategory.Error,"Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambig_2308","Module {0} has already exported a member named '{1}'. Consider explicitly re-exporting to resolve the ambiguity."),An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements:t(2309,e.DiagnosticCategory.Error,"An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements_2309","An export assignment cannot be used in a module with other exported elements."),Type_0_recursively_references_itself_as_a_base_type:t(2310,e.DiagnosticCategory.Error,"Type_0_recursively_references_itself_as_a_base_type_2310","Type '{0}' recursively references itself as a base type."),A_class_may_only_extend_another_class:t(2311,e.DiagnosticCategory.Error,"A_class_may_only_extend_another_class_2311","A class may only extend another class."),An_interface_may_only_extend_a_class_or_another_interface:t(2312,e.DiagnosticCategory.Error,"An_interface_may_only_extend_a_class_or_another_interface_2312","An interface may only extend a class or another interface."),Type_parameter_0_has_a_circular_constraint:t(2313,e.DiagnosticCategory.Error,"Type_parameter_0_has_a_circular_constraint_2313","Type parameter '{0}' has a circular constraint."),Generic_type_0_requires_1_type_argument_s:t(2314,e.DiagnosticCategory.Error,"Generic_type_0_requires_1_type_argument_s_2314","Generic type '{0}' requires {1} type argument(s)."),Type_0_is_not_generic:t(2315,e.DiagnosticCategory.Error,"Type_0_is_not_generic_2315","Type '{0}' is not generic."),Global_type_0_must_be_a_class_or_interface_type:t(2316,e.DiagnosticCategory.Error,"Global_type_0_must_be_a_class_or_interface_type_2316","Global type '{0}' must be a class or interface type."),Global_type_0_must_have_1_type_parameter_s:t(2317,e.DiagnosticCategory.Error,"Global_type_0_must_have_1_type_parameter_s_2317","Global type '{0}' must have {1} type parameter(s)."),Cannot_find_global_type_0:t(2318,e.DiagnosticCategory.Error,"Cannot_find_global_type_0_2318","Cannot find global type '{0}'."),Named_property_0_of_types_1_and_2_are_not_identical:t(2319,e.DiagnosticCategory.Error,"Named_property_0_of_types_1_and_2_are_not_identical_2319","Named property '{0}' of types '{1}' and '{2}' are not identical."),Interface_0_cannot_simultaneously_extend_types_1_and_2:t(2320,e.DiagnosticCategory.Error,"Interface_0_cannot_simultaneously_extend_types_1_and_2_2320","Interface '{0}' cannot simultaneously extend types '{1}' and '{2}'."),Excessive_stack_depth_comparing_types_0_and_1:t(2321,e.DiagnosticCategory.Error,"Excessive_stack_depth_comparing_types_0_and_1_2321","Excessive stack depth comparing types '{0}' and '{1}'."),Type_0_is_not_assignable_to_type_1:t(2322,e.DiagnosticCategory.Error,"Type_0_is_not_assignable_to_type_1_2322","Type '{0}' is not assignable to type '{1}'."),Cannot_redeclare_exported_variable_0:t(2323,e.DiagnosticCategory.Error,"Cannot_redeclare_exported_variable_0_2323","Cannot redeclare exported variable '{0}'."),Property_0_is_missing_in_type_1:t(2324,e.DiagnosticCategory.Error,"Property_0_is_missing_in_type_1_2324","Property '{0}' is missing in type '{1}'."),Property_0_is_private_in_type_1_but_not_in_type_2:t(2325,e.DiagnosticCategory.Error,"Property_0_is_private_in_type_1_but_not_in_type_2_2325","Property '{0}' is private in type '{1}' but not in type '{2}'."),Types_of_property_0_are_incompatible:t(2326,e.DiagnosticCategory.Error,"Types_of_property_0_are_incompatible_2326","Types of property '{0}' are incompatible."),Property_0_is_optional_in_type_1_but_required_in_type_2:t(2327,e.DiagnosticCategory.Error,"Property_0_is_optional_in_type_1_but_required_in_type_2_2327","Property '{0}' is optional in type '{1}' but required in type '{2}'."),Types_of_parameters_0_and_1_are_incompatible:t(2328,e.DiagnosticCategory.Error,"Types_of_parameters_0_and_1_are_incompatible_2328","Types of parameters '{0}' and '{1}' are incompatible."),Index_signature_is_missing_in_type_0:t(2329,e.DiagnosticCategory.Error,"Index_signature_is_missing_in_type_0_2329","Index signature is missing in type '{0}'."),Index_signatures_are_incompatible:t(2330,e.DiagnosticCategory.Error,"Index_signatures_are_incompatible_2330","Index signatures are incompatible."),this_cannot_be_referenced_in_a_module_or_namespace_body:t(2331,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_module_or_namespace_body_2331","'this' cannot be referenced in a module or namespace body."),this_cannot_be_referenced_in_current_location:t(2332,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_current_location_2332","'this' cannot be referenced in current location."),this_cannot_be_referenced_in_constructor_arguments:t(2333,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_constructor_arguments_2333","'this' cannot be referenced in constructor arguments."),this_cannot_be_referenced_in_a_static_property_initializer:t(2334,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_static_property_initializer_2334","'this' cannot be referenced in a static property initializer."),super_can_only_be_referenced_in_a_derived_class:t(2335,e.DiagnosticCategory.Error,"super_can_only_be_referenced_in_a_derived_class_2335","'super' can only be referenced in a derived class."),super_cannot_be_referenced_in_constructor_arguments:t(2336,e.DiagnosticCategory.Error,"super_cannot_be_referenced_in_constructor_arguments_2336","'super' cannot be referenced in constructor arguments."),Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors:t(2337,e.DiagnosticCategory.Error,"Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors_2337","Super calls are not permitted outside constructors or in nested functions inside constructors."),super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_derived_class:t(2338,e.DiagnosticCategory.Error,"super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_der_2338","'super' property access is permitted only in a constructor, member function, or member accessor of a derived class."),Property_0_does_not_exist_on_type_1:t(2339,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_type_1_2339","Property '{0}' does not exist on type '{1}'."),Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword:t(2340,e.DiagnosticCategory.Error,"Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword_2340","Only public and protected methods of the base class are accessible via the 'super' keyword."),Property_0_is_private_and_only_accessible_within_class_1:t(2341,e.DiagnosticCategory.Error,"Property_0_is_private_and_only_accessible_within_class_1_2341","Property '{0}' is private and only accessible within class '{1}'."),An_index_expression_argument_must_be_of_type_string_number_symbol_or_any:t(2342,e.DiagnosticCategory.Error,"An_index_expression_argument_must_be_of_type_string_number_symbol_or_any_2342","An index expression argument must be of type 'string', 'number', 'symbol', or 'any'."),This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1:t(2343,e.DiagnosticCategory.Error,"This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1_2343","This syntax requires an imported helper named '{1}', but module '{0}' has no exported member '{1}'."),Type_0_does_not_satisfy_the_constraint_1:t(2344,e.DiagnosticCategory.Error,"Type_0_does_not_satisfy_the_constraint_1_2344","Type '{0}' does not satisfy the constraint '{1}'."),Argument_of_type_0_is_not_assignable_to_parameter_of_type_1:t(2345,e.DiagnosticCategory.Error,"Argument_of_type_0_is_not_assignable_to_parameter_of_type_1_2345","Argument of type '{0}' is not assignable to parameter of type '{1}'."),Call_target_does_not_contain_any_signatures:t(2346,e.DiagnosticCategory.Error,"Call_target_does_not_contain_any_signatures_2346","Call target does not contain any signatures."),Untyped_function_calls_may_not_accept_type_arguments:t(2347,e.DiagnosticCategory.Error,"Untyped_function_calls_may_not_accept_type_arguments_2347","Untyped function calls may not accept type arguments."),Value_of_type_0_is_not_callable_Did_you_mean_to_include_new:t(2348,e.DiagnosticCategory.Error,"Value_of_type_0_is_not_callable_Did_you_mean_to_include_new_2348","Value of type '{0}' is not callable. Did you mean to include 'new'?"),Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures:t(2349,e.DiagnosticCategory.Error,"Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatur_2349","Cannot invoke an expression whose type lacks a call signature. Type '{0}' has no compatible call signatures."),Only_a_void_function_can_be_called_with_the_new_keyword:t(2350,e.DiagnosticCategory.Error,"Only_a_void_function_can_be_called_with_the_new_keyword_2350","Only a void function can be called with the 'new' keyword."),Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature:t(2351,e.DiagnosticCategory.Error,"Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature_2351","Cannot use 'new' with an expression whose type lacks a call or construct signature."),Type_0_cannot_be_converted_to_type_1:t(2352,e.DiagnosticCategory.Error,"Type_0_cannot_be_converted_to_type_1_2352","Type '{0}' cannot be converted to type '{1}'."),Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1:t(2353,e.DiagnosticCategory.Error,"Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1_2353","Object literal may only specify known properties, and '{0}' does not exist in type '{1}'."),This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found:t(2354,e.DiagnosticCategory.Error,"This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found_2354","This syntax requires an imported helper but module '{0}' cannot be found."),A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value:t(2355,e.DiagnosticCategory.Error,"A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value_2355","A function whose declared type is neither 'void' nor 'any' must return a value."),An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type:t(2356,e.DiagnosticCategory.Error,"An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type_2356","An arithmetic operand must be of type 'any', 'number' or an enum type."),The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access:t(2357,e.DiagnosticCategory.Error,"The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access_2357","The operand of an increment or decrement operator must be a variable or a property access."),The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2358,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_paramete_2358","The left-hand side of an 'instanceof' expression must be of type 'any', an object type or a type parameter."),The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_Function_interface_type:t(2359,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_F_2359","The right-hand side of an 'instanceof' expression must be of type 'any' or of a type assignable to the 'Function' interface type."),The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol:t(2360,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol_2360","The left-hand side of an 'in' expression must be of type 'any', 'string', 'number', or 'symbol'."),The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2361,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter_2361","The right-hand side of an 'in' expression must be of type 'any', an object type or a type parameter."),The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type:t(2362,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type_2362","The left-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type."),The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type:t(2363,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type_2363","The right-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type."),The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access:t(2364,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access_2364","The left-hand side of an assignment expression must be a variable or a property access."),Operator_0_cannot_be_applied_to_types_1_and_2:t(2365,e.DiagnosticCategory.Error,"Operator_0_cannot_be_applied_to_types_1_and_2_2365","Operator '{0}' cannot be applied to types '{1}' and '{2}'."),Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined:t(2366,e.DiagnosticCategory.Error,"Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined_2366","Function lacks ending return statement and return type does not include 'undefined'."),Type_parameter_name_cannot_be_0:t(2368,e.DiagnosticCategory.Error,"Type_parameter_name_cannot_be_0_2368","Type parameter name cannot be '{0}'."),A_parameter_property_is_only_allowed_in_a_constructor_implementation:t(2369,e.DiagnosticCategory.Error,"A_parameter_property_is_only_allowed_in_a_constructor_implementation_2369","A parameter property is only allowed in a constructor implementation."),A_rest_parameter_must_be_of_an_array_type:t(2370,e.DiagnosticCategory.Error,"A_rest_parameter_must_be_of_an_array_type_2370","A rest parameter must be of an array type."),A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation:t(2371,e.DiagnosticCategory.Error,"A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation_2371","A parameter initializer is only allowed in a function or constructor implementation."),Parameter_0_cannot_be_referenced_in_its_initializer:t(2372,e.DiagnosticCategory.Error,"Parameter_0_cannot_be_referenced_in_its_initializer_2372","Parameter '{0}' cannot be referenced in its initializer."),Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it:t(2373,e.DiagnosticCategory.Error,"Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it_2373","Initializer of parameter '{0}' cannot reference identifier '{1}' declared after it."),Duplicate_string_index_signature:t(2374,e.DiagnosticCategory.Error,"Duplicate_string_index_signature_2374","Duplicate string index signature."),Duplicate_number_index_signature:t(2375,e.DiagnosticCategory.Error,"Duplicate_number_index_signature_2375","Duplicate number index signature."),A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_properties_or_has_parameter_properties:t(2376,e.DiagnosticCategory.Error,"A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_proper_2376","A 'super' call must be the first statement in the constructor when a class contains initialized properties or has parameter properties."),Constructors_for_derived_classes_must_contain_a_super_call:t(2377,e.DiagnosticCategory.Error,"Constructors_for_derived_classes_must_contain_a_super_call_2377","Constructors for derived classes must contain a 'super' call."),A_get_accessor_must_return_a_value:t(2378,e.DiagnosticCategory.Error,"A_get_accessor_must_return_a_value_2378","A 'get' accessor must return a value."),Getter_and_setter_accessors_do_not_agree_in_visibility:t(2379,e.DiagnosticCategory.Error,"Getter_and_setter_accessors_do_not_agree_in_visibility_2379","Getter and setter accessors do not agree in visibility."),get_and_set_accessor_must_have_the_same_type:t(2380,e.DiagnosticCategory.Error,"get_and_set_accessor_must_have_the_same_type_2380","'get' and 'set' accessor must have the same type."),A_signature_with_an_implementation_cannot_use_a_string_literal_type:t(2381,e.DiagnosticCategory.Error,"A_signature_with_an_implementation_cannot_use_a_string_literal_type_2381","A signature with an implementation cannot use a string literal type."),Specialized_overload_signature_is_not_assignable_to_any_non_specialized_signature:t(2382,e.DiagnosticCategory.Error,"Specialized_overload_signature_is_not_assignable_to_any_non_specialized_signature_2382","Specialized overload signature is not assignable to any non-specialized signature."),Overload_signatures_must_all_be_exported_or_non_exported:t(2383,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_exported_or_non_exported_2383","Overload signatures must all be exported or non-exported."),Overload_signatures_must_all_be_ambient_or_non_ambient:t(2384,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_ambient_or_non_ambient_2384","Overload signatures must all be ambient or non-ambient."),Overload_signatures_must_all_be_public_private_or_protected:t(2385,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_public_private_or_protected_2385","Overload signatures must all be public, private or protected."),Overload_signatures_must_all_be_optional_or_required:t(2386,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_optional_or_required_2386","Overload signatures must all be optional or required."),Function_overload_must_be_static:t(2387,e.DiagnosticCategory.Error,"Function_overload_must_be_static_2387","Function overload must be static."),Function_overload_must_not_be_static:t(2388,e.DiagnosticCategory.Error,"Function_overload_must_not_be_static_2388","Function overload must not be static."),Function_implementation_name_must_be_0:t(2389,e.DiagnosticCategory.Error,"Function_implementation_name_must_be_0_2389","Function implementation name must be '{0}'."),Constructor_implementation_is_missing:t(2390,e.DiagnosticCategory.Error,"Constructor_implementation_is_missing_2390","Constructor implementation is missing."),Function_implementation_is_missing_or_not_immediately_following_the_declaration:t(2391,e.DiagnosticCategory.Error,"Function_implementation_is_missing_or_not_immediately_following_the_declaration_2391","Function implementation is missing or not immediately following the declaration."),Multiple_constructor_implementations_are_not_allowed:t(2392,e.DiagnosticCategory.Error,"Multiple_constructor_implementations_are_not_allowed_2392","Multiple constructor implementations are not allowed."),Duplicate_function_implementation:t(2393,e.DiagnosticCategory.Error,"Duplicate_function_implementation_2393","Duplicate function implementation."),Overload_signature_is_not_compatible_with_function_implementation:t(2394,e.DiagnosticCategory.Error,"Overload_signature_is_not_compatible_with_function_implementation_2394","Overload signature is not compatible with function implementation."),Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local:t(2395,e.DiagnosticCategory.Error,"Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local_2395","Individual declarations in merged declaration '{0}' must be all exported or all local."),Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters:t(2396,e.DiagnosticCategory.Error,"Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters_2396","Duplicate identifier 'arguments'. Compiler uses 'arguments' to initialize rest parameters."),Declaration_name_conflicts_with_built_in_global_identifier_0:t(2397,e.DiagnosticCategory.Error,"Declaration_name_conflicts_with_built_in_global_identifier_0_2397","Declaration name conflicts with built-in global identifier '{0}'."),Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference:t(2399,e.DiagnosticCategory.Error,"Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference_2399","Duplicate identifier '_this'. Compiler uses variable declaration '_this' to capture 'this' reference."),Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference:t(2400,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference_2400","Expression resolves to variable declaration '_this' that compiler uses to capture 'this' reference."),Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference:t(2401,e.DiagnosticCategory.Error,"Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference_2401","Duplicate identifier '_super'. Compiler uses '_super' to capture base class reference."),Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference:t(2402,e.DiagnosticCategory.Error,"Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference_2402","Expression resolves to '_super' that compiler uses to capture base class reference."),Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2:t(2403,e.DiagnosticCategory.Error,"Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_t_2403","Subsequent variable declarations must have the same type.  Variable '{0}' must be of type '{1}', but here has type '{2}'."),The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation:t(2404,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation_2404","The left-hand side of a 'for...in' statement cannot use a type annotation."),The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any:t(2405,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any_2405","The left-hand side of a 'for...in' statement must be of type 'string' or 'any'."),The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access:t(2406,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access_2406","The left-hand side of a 'for...in' statement must be a variable or a property access."),The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2407,e.DiagnosticCategory.Error,"The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter_2407","The right-hand side of a 'for...in' statement must be of type 'any', an object type or a type parameter."),Setters_cannot_return_a_value:t(2408,e.DiagnosticCategory.Error,"Setters_cannot_return_a_value_2408","Setters cannot return a value."),Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class:t(2409,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class_2409","Return type of constructor signature must be assignable to the instance type of the class."),The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any:t(2410,e.DiagnosticCategory.Error,"The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any_2410","The 'with' statement is not supported. All symbols in a 'with' block will have type 'any'."),Property_0_of_type_1_is_not_assignable_to_string_index_type_2:t(2411,e.DiagnosticCategory.Error,"Property_0_of_type_1_is_not_assignable_to_string_index_type_2_2411","Property '{0}' of type '{1}' is not assignable to string index type '{2}'."),Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2:t(2412,e.DiagnosticCategory.Error,"Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2_2412","Property '{0}' of type '{1}' is not assignable to numeric index type '{2}'."),Numeric_index_type_0_is_not_assignable_to_string_index_type_1:t(2413,e.DiagnosticCategory.Error,"Numeric_index_type_0_is_not_assignable_to_string_index_type_1_2413","Numeric index type '{0}' is not assignable to string index type '{1}'."),Class_name_cannot_be_0:t(2414,e.DiagnosticCategory.Error,"Class_name_cannot_be_0_2414","Class name cannot be '{0}'."),Class_0_incorrectly_extends_base_class_1:t(2415,e.DiagnosticCategory.Error,"Class_0_incorrectly_extends_base_class_1_2415","Class '{0}' incorrectly extends base class '{1}'."),Class_static_side_0_incorrectly_extends_base_class_static_side_1:t(2417,e.DiagnosticCategory.Error,"Class_static_side_0_incorrectly_extends_base_class_static_side_1_2417","Class static side '{0}' incorrectly extends base class static side '{1}'."),Class_0_incorrectly_implements_interface_1:t(2420,e.DiagnosticCategory.Error,"Class_0_incorrectly_implements_interface_1_2420","Class '{0}' incorrectly implements interface '{1}'."),A_class_may_only_implement_another_class_or_interface:t(2422,e.DiagnosticCategory.Error,"A_class_may_only_implement_another_class_or_interface_2422","A class may only implement another class or interface."),Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_accessor:t(2423,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_access_2423","Class '{0}' defines instance member function '{1}', but extended class '{2}' defines it as instance member accessor."),Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_property:t(2424,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_proper_2424","Class '{0}' defines instance member function '{1}', but extended class '{2}' defines it as instance member property."),Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_function:t(2425,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_functi_2425","Class '{0}' defines instance member property '{1}', but extended class '{2}' defines it as instance member function."),Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_function:t(2426,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_functi_2426","Class '{0}' defines instance member accessor '{1}', but extended class '{2}' defines it as instance member function."),Interface_name_cannot_be_0:t(2427,e.DiagnosticCategory.Error,"Interface_name_cannot_be_0_2427","Interface name cannot be '{0}'."),All_declarations_of_0_must_have_identical_type_parameters:t(2428,e.DiagnosticCategory.Error,"All_declarations_of_0_must_have_identical_type_parameters_2428","All declarations of '{0}' must have identical type parameters."),Interface_0_incorrectly_extends_interface_1:t(2430,e.DiagnosticCategory.Error,"Interface_0_incorrectly_extends_interface_1_2430","Interface '{0}' incorrectly extends interface '{1}'."),Enum_name_cannot_be_0:t(2431,e.DiagnosticCategory.Error,"Enum_name_cannot_be_0_2431","Enum name cannot be '{0}'."),In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enum_element:t(2432,e.DiagnosticCategory.Error,"In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enu_2432","In an enum with multiple declarations, only one declaration can omit an initializer for its first enum element."),A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merged:t(2433,e.DiagnosticCategory.Error,"A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merg_2433","A namespace declaration cannot be in a different file from a class or function with which it is merged."),A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged:t(2434,e.DiagnosticCategory.Error,"A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged_2434","A namespace declaration cannot be located prior to a class or function with which it is merged."),Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces:t(2435,e.DiagnosticCategory.Error,"Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces_2435","Ambient modules cannot be nested in other modules or namespaces."),Ambient_module_declaration_cannot_specify_relative_module_name:t(2436,e.DiagnosticCategory.Error,"Ambient_module_declaration_cannot_specify_relative_module_name_2436","Ambient module declaration cannot specify relative module name."),Module_0_is_hidden_by_a_local_declaration_with_the_same_name:t(2437,e.DiagnosticCategory.Error,"Module_0_is_hidden_by_a_local_declaration_with_the_same_name_2437","Module '{0}' is hidden by a local declaration with the same name."),Import_name_cannot_be_0:t(2438,e.DiagnosticCategory.Error,"Import_name_cannot_be_0_2438","Import name cannot be '{0}'."),Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relative_module_name:t(2439,e.DiagnosticCategory.Error,"Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relati_2439","Import or export declaration in an ambient module declaration cannot reference module through relative module name."),Import_declaration_conflicts_with_local_declaration_of_0:t(2440,e.DiagnosticCategory.Error,"Import_declaration_conflicts_with_local_declaration_of_0_2440","Import declaration conflicts with local declaration of '{0}'."),Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module:t(2441,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_2441","Duplicate identifier '{0}'. Compiler reserves name '{1}' in top level scope of a module."),Types_have_separate_declarations_of_a_private_property_0:t(2442,e.DiagnosticCategory.Error,"Types_have_separate_declarations_of_a_private_property_0_2442","Types have separate declarations of a private property '{0}'."),Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2:t(2443,e.DiagnosticCategory.Error,"Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2_2443","Property '{0}' is protected but type '{1}' is not a class derived from '{2}'."),Property_0_is_protected_in_type_1_but_public_in_type_2:t(2444,e.DiagnosticCategory.Error,"Property_0_is_protected_in_type_1_but_public_in_type_2_2444","Property '{0}' is protected in type '{1}' but public in type '{2}'."),Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses:t(2445,e.DiagnosticCategory.Error,"Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses_2445","Property '{0}' is protected and only accessible within class '{1}' and its subclasses."),Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1:t(2446,e.DiagnosticCategory.Error,"Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1_2446","Property '{0}' is protected and only accessible through an instance of class '{1}'."),The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead:t(2447,e.DiagnosticCategory.Error,"The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead_2447","The '{0}' operator is not allowed for boolean types. Consider using '{1}' instead."),Block_scoped_variable_0_used_before_its_declaration:t(2448,e.DiagnosticCategory.Error,"Block_scoped_variable_0_used_before_its_declaration_2448","Block-scoped variable '{0}' used before its declaration."),Class_0_used_before_its_declaration:t(2449,e.DiagnosticCategory.Error,"Class_0_used_before_its_declaration_2449","Class '{0}' used before its declaration."),Enum_0_used_before_its_declaration:t(2450,e.DiagnosticCategory.Error,"Enum_0_used_before_its_declaration_2450","Enum '{0}' used before its declaration."),Cannot_redeclare_block_scoped_variable_0:t(2451,e.DiagnosticCategory.Error,"Cannot_redeclare_block_scoped_variable_0_2451","Cannot redeclare block-scoped variable '{0}'."),An_enum_member_cannot_have_a_numeric_name:t(2452,e.DiagnosticCategory.Error,"An_enum_member_cannot_have_a_numeric_name_2452","An enum member cannot have a numeric name."),The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_type_arguments_explicitly:t(2453,e.DiagnosticCategory.Error,"The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_typ_2453","The type argument for type parameter '{0}' cannot be inferred from the usage. Consider specifying the type arguments explicitly."),Variable_0_is_used_before_being_assigned:t(2454,e.DiagnosticCategory.Error,"Variable_0_is_used_before_being_assigned_2454","Variable '{0}' is used before being assigned."),Type_argument_candidate_1_is_not_a_valid_type_argument_because_it_is_not_a_supertype_of_candidate_0:t(2455,e.DiagnosticCategory.Error,"Type_argument_candidate_1_is_not_a_valid_type_argument_because_it_is_not_a_supertype_of_candidate_0_2455","Type argument candidate '{1}' is not a valid type argument because it is not a supertype of candidate '{0}'."),Type_alias_0_circularly_references_itself:t(2456,e.DiagnosticCategory.Error,"Type_alias_0_circularly_references_itself_2456","Type alias '{0}' circularly references itself."),Type_alias_name_cannot_be_0:t(2457,e.DiagnosticCategory.Error,"Type_alias_name_cannot_be_0_2457","Type alias name cannot be '{0}'."),An_AMD_module_cannot_have_multiple_name_assignments:t(2458,e.DiagnosticCategory.Error,"An_AMD_module_cannot_have_multiple_name_assignments_2458","An AMD module cannot have multiple name assignments."),Type_0_has_no_property_1_and_no_string_index_signature:t(2459,e.DiagnosticCategory.Error,"Type_0_has_no_property_1_and_no_string_index_signature_2459","Type '{0}' has no property '{1}' and no string index signature."),Type_0_has_no_property_1:t(2460,e.DiagnosticCategory.Error,"Type_0_has_no_property_1_2460","Type '{0}' has no property '{1}'."),Type_0_is_not_an_array_type:t(2461,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_2461","Type '{0}' is not an array type."),A_rest_element_must_be_last_in_a_destructuring_pattern:t(2462,e.DiagnosticCategory.Error,"A_rest_element_must_be_last_in_a_destructuring_pattern_2462","A rest element must be last in a destructuring pattern."),A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature:t(2463,e.DiagnosticCategory.Error,"A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature_2463","A binding pattern parameter cannot be optional in an implementation signature."),A_computed_property_name_must_be_of_type_string_number_symbol_or_any:t(2464,e.DiagnosticCategory.Error,"A_computed_property_name_must_be_of_type_string_number_symbol_or_any_2464","A computed property name must be of type 'string', 'number', 'symbol', or 'any'."),this_cannot_be_referenced_in_a_computed_property_name:t(2465,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_computed_property_name_2465","'this' cannot be referenced in a computed property name."),super_cannot_be_referenced_in_a_computed_property_name:t(2466,e.DiagnosticCategory.Error,"super_cannot_be_referenced_in_a_computed_property_name_2466","'super' cannot be referenced in a computed property name."),A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type:t(2467,e.DiagnosticCategory.Error,"A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type_2467","A computed property name cannot reference a type parameter from its containing type."),Cannot_find_global_value_0:t(2468,e.DiagnosticCategory.Error,"Cannot_find_global_value_0_2468","Cannot find global value '{0}'."),The_0_operator_cannot_be_applied_to_type_symbol:t(2469,e.DiagnosticCategory.Error,"The_0_operator_cannot_be_applied_to_type_symbol_2469","The '{0}' operator cannot be applied to type 'symbol'."),Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object:t(2470,e.DiagnosticCategory.Error,"Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object_2470","'Symbol' reference does not refer to the global Symbol constructor object."),A_computed_property_name_of_the_form_0_must_be_of_type_symbol:t(2471,e.DiagnosticCategory.Error,"A_computed_property_name_of_the_form_0_must_be_of_type_symbol_2471","A computed property name of the form '{0}' must be of type 'symbol'."),Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher:t(2472,e.DiagnosticCategory.Error,"Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher_2472","Spread operator in 'new' expressions is only available when targeting ECMAScript 5 and higher."),Enum_declarations_must_all_be_const_or_non_const:t(2473,e.DiagnosticCategory.Error,"Enum_declarations_must_all_be_const_or_non_const_2473","Enum declarations must all be const or non-const."),In_const_enum_declarations_member_initializer_must_be_constant_expression:t(2474,e.DiagnosticCategory.Error,"In_const_enum_declarations_member_initializer_must_be_constant_expression_2474","In 'const' enum declarations member initializer must be constant expression."),const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_import_declaration_or_export_assignment:t(2475,e.DiagnosticCategory.Error,"const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_im_2475","'const' enums can only be used in property or index access expressions or the right hand side of an import declaration or export assignment."),A_const_enum_member_can_only_be_accessed_using_a_string_literal:t(2476,e.DiagnosticCategory.Error,"A_const_enum_member_can_only_be_accessed_using_a_string_literal_2476","A const enum member can only be accessed using a string literal."),const_enum_member_initializer_was_evaluated_to_a_non_finite_value:t(2477,e.DiagnosticCategory.Error,"const_enum_member_initializer_was_evaluated_to_a_non_finite_value_2477","'const' enum member initializer was evaluated to a non-finite value."),const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN:t(2478,e.DiagnosticCategory.Error,"const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN_2478","'const' enum member initializer was evaluated to disallowed value 'NaN'."),Property_0_does_not_exist_on_const_enum_1:t(2479,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_const_enum_1_2479","Property '{0}' does not exist on 'const' enum '{1}'."),let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations:t(2480,e.DiagnosticCategory.Error,"let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations_2480","'let' is not allowed to be used as a name in 'let' or 'const' declarations."),Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1:t(2481,e.DiagnosticCategory.Error,"Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1_2481","Cannot initialize outer scoped variable '{0}' in the same scope as block scoped declaration '{1}'."),The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation:t(2483,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation_2483","The left-hand side of a 'for...of' statement cannot use a type annotation."),Export_declaration_conflicts_with_exported_declaration_of_0:t(2484,e.DiagnosticCategory.Error,"Export_declaration_conflicts_with_exported_declaration_of_0_2484","Export declaration conflicts with exported declaration of '{0}'."),The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access:t(2487,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access_2487","The left-hand side of a 'for...of' statement must be a variable or a property access."),Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2488,e.DiagnosticCategory.Error,"Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator_2488","Type must have a '[Symbol.iterator]()' method that returns an iterator."),An_iterator_must_have_a_next_method:t(2489,e.DiagnosticCategory.Error,"An_iterator_must_have_a_next_method_2489","An iterator must have a 'next()' method."),The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property:t(2490,e.DiagnosticCategory.Error,"The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property_2490","The type returned by the 'next()' method of an iterator must have a 'value' property."),The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern:t(2491,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern_2491","The left-hand side of a 'for...in' statement cannot be a destructuring pattern."),Cannot_redeclare_identifier_0_in_catch_clause:t(2492,e.DiagnosticCategory.Error,"Cannot_redeclare_identifier_0_in_catch_clause_2492","Cannot redeclare identifier '{0}' in catch clause."),Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2:t(2493,e.DiagnosticCategory.Error,"Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2_2493","Tuple type '{0}' with length '{1}' cannot be assigned to tuple with length '{2}'."),Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher:t(2494,e.DiagnosticCategory.Error,"Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher_2494","Using a string in a 'for...of' statement is only supported in ECMAScript 5 and higher."),Type_0_is_not_an_array_type_or_a_string_type:t(2495,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_a_string_type_2495","Type '{0}' is not an array type or a string type."),The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_standard_function_expression:t(2496,e.DiagnosticCategory.Error,"The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_stand_2496","The 'arguments' object cannot be referenced in an arrow function in ES3 and ES5. Consider using a standard function expression."),Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct:t(2497,e.DiagnosticCategory.Error,"Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct_2497","Module '{0}' resolves to a non-module entity and cannot be imported using this construct."),Module_0_uses_export_and_cannot_be_used_with_export_Asterisk:t(2498,e.DiagnosticCategory.Error,"Module_0_uses_export_and_cannot_be_used_with_export_Asterisk_2498","Module '{0}' uses 'export =' and cannot be used with 'export *'."),An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments:t(2499,e.DiagnosticCategory.Error,"An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments_2499","An interface can only extend an identifier/qualified-name with optional type arguments."),A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments:t(2500,e.DiagnosticCategory.Error,"A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments_2500","A class can only implement an identifier/qualified-name with optional type arguments."),A_rest_element_cannot_contain_a_binding_pattern:t(2501,e.DiagnosticCategory.Error,"A_rest_element_cannot_contain_a_binding_pattern_2501","A rest element cannot contain a binding pattern."),_0_is_referenced_directly_or_indirectly_in_its_own_type_annotation:t(2502,e.DiagnosticCategory.Error,"_0_is_referenced_directly_or_indirectly_in_its_own_type_annotation_2502","'{0}' is referenced directly or indirectly in its own type annotation."),Cannot_find_namespace_0:t(2503,e.DiagnosticCategory.Error,"Cannot_find_namespace_0_2503","Cannot find namespace '{0}'."),Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator:t(2504,e.DiagnosticCategory.Error,"Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator_2504","Type must have a '[Symbol.asyncIterator]()' method that returns an async iterator."),A_generator_cannot_have_a_void_type_annotation:t(2505,e.DiagnosticCategory.Error,"A_generator_cannot_have_a_void_type_annotation_2505","A generator cannot have a 'void' type annotation."),_0_is_referenced_directly_or_indirectly_in_its_own_base_expression:t(2506,e.DiagnosticCategory.Error,"_0_is_referenced_directly_or_indirectly_in_its_own_base_expression_2506","'{0}' is referenced directly or indirectly in its own base expression."),Type_0_is_not_a_constructor_function_type:t(2507,e.DiagnosticCategory.Error,"Type_0_is_not_a_constructor_function_type_2507","Type '{0}' is not a constructor function type."),No_base_constructor_has_the_specified_number_of_type_arguments:t(2508,e.DiagnosticCategory.Error,"No_base_constructor_has_the_specified_number_of_type_arguments_2508","No base constructor has the specified number of type arguments."),Base_constructor_return_type_0_is_not_a_class_or_interface_type:t(2509,e.DiagnosticCategory.Error,"Base_constructor_return_type_0_is_not_a_class_or_interface_type_2509","Base constructor return type '{0}' is not a class or interface type."),Base_constructors_must_all_have_the_same_return_type:t(2510,e.DiagnosticCategory.Error,"Base_constructors_must_all_have_the_same_return_type_2510","Base constructors must all have the same return type."),Cannot_create_an_instance_of_the_abstract_class_0:t(2511,e.DiagnosticCategory.Error,"Cannot_create_an_instance_of_the_abstract_class_0_2511","Cannot create an instance of the abstract class '{0}'."),Overload_signatures_must_all_be_abstract_or_non_abstract:t(2512,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_abstract_or_non_abstract_2512","Overload signatures must all be abstract or non-abstract."),Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression:t(2513,e.DiagnosticCategory.Error,"Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression_2513","Abstract method '{0}' in class '{1}' cannot be accessed via super expression."),Classes_containing_abstract_methods_must_be_marked_abstract:t(2514,e.DiagnosticCategory.Error,"Classes_containing_abstract_methods_must_be_marked_abstract_2514","Classes containing abstract methods must be marked abstract."),Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2:t(2515,e.DiagnosticCategory.Error,"Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2_2515","Non-abstract class '{0}' does not implement inherited abstract member '{1}' from class '{2}'."),All_declarations_of_an_abstract_method_must_be_consecutive:t(2516,e.DiagnosticCategory.Error,"All_declarations_of_an_abstract_method_must_be_consecutive_2516","All declarations of an abstract method must be consecutive."),Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type:t(2517,e.DiagnosticCategory.Error,"Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type_2517","Cannot assign an abstract constructor type to a non-abstract constructor type."),A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard:t(2518,e.DiagnosticCategory.Error,"A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard_2518","A 'this'-based type guard is not compatible with a parameter-based type guard."),An_async_iterator_must_have_a_next_method:t(2519,e.DiagnosticCategory.Error,"An_async_iterator_must_have_a_next_method_2519","An async iterator must have a 'next()' method."),Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions:t(2520,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions_2520","Duplicate identifier '{0}'. Compiler uses declaration '{1}' to support async functions."),Expression_resolves_to_variable_declaration_0_that_compiler_uses_to_support_async_functions:t(2521,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_0_that_compiler_uses_to_support_async_functions_2521","Expression resolves to variable declaration '{0}' that compiler uses to support async functions."),The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_using_a_standard_function_or_method:t(2522,e.DiagnosticCategory.Error,"The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_usi_2522","The 'arguments' object cannot be referenced in an async function or method in ES3 and ES5. Consider using a standard function or method."),yield_expressions_cannot_be_used_in_a_parameter_initializer:t(2523,e.DiagnosticCategory.Error,"yield_expressions_cannot_be_used_in_a_parameter_initializer_2523","'yield' expressions cannot be used in a parameter initializer."),await_expressions_cannot_be_used_in_a_parameter_initializer:t(2524,e.DiagnosticCategory.Error,"await_expressions_cannot_be_used_in_a_parameter_initializer_2524","'await' expressions cannot be used in a parameter initializer."),Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value:t(2525,e.DiagnosticCategory.Error,"Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value_2525","Initializer provides no value for this binding element and the binding element has no default value."),A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface:t(2526,e.DiagnosticCategory.Error,"A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface_2526","A 'this' type is available only in a non-static member of a class or interface."),The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary:t(2527,e.DiagnosticCategory.Error,"The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary_2527","The inferred type of '{0}' references an inaccessible 'this' type. A type annotation is necessary."),A_module_cannot_have_multiple_default_exports:t(2528,e.DiagnosticCategory.Error,"A_module_cannot_have_multiple_default_exports_2528","A module cannot have multiple default exports."),Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_functions:t(2529,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_func_2529","Duplicate identifier '{0}'. Compiler reserves name '{1}' in top level scope of a module containing async functions."),Property_0_is_incompatible_with_index_signature:t(2530,e.DiagnosticCategory.Error,"Property_0_is_incompatible_with_index_signature_2530","Property '{0}' is incompatible with index signature."),Object_is_possibly_null:t(2531,e.DiagnosticCategory.Error,"Object_is_possibly_null_2531","Object is possibly 'null'."),Object_is_possibly_undefined:t(2532,e.DiagnosticCategory.Error,"Object_is_possibly_undefined_2532","Object is possibly 'undefined'."),Object_is_possibly_null_or_undefined:t(2533,e.DiagnosticCategory.Error,"Object_is_possibly_null_or_undefined_2533","Object is possibly 'null' or 'undefined'."),A_function_returning_never_cannot_have_a_reachable_end_point:t(2534,e.DiagnosticCategory.Error,"A_function_returning_never_cannot_have_a_reachable_end_point_2534","A function returning 'never' cannot have a reachable end point."),Enum_type_0_has_members_with_initializers_that_are_not_literals:t(2535,e.DiagnosticCategory.Error,"Enum_type_0_has_members_with_initializers_that_are_not_literals_2535","Enum type '{0}' has members with initializers that are not literals."),Type_0_cannot_be_used_to_index_type_1:t(2536,e.DiagnosticCategory.Error,"Type_0_cannot_be_used_to_index_type_1_2536","Type '{0}' cannot be used to index type '{1}'."),Type_0_has_no_matching_index_signature_for_type_1:t(2537,e.DiagnosticCategory.Error,"Type_0_has_no_matching_index_signature_for_type_1_2537","Type '{0}' has no matching index signature for type '{1}'."),Type_0_cannot_be_used_as_an_index_type:t(2538,e.DiagnosticCategory.Error,"Type_0_cannot_be_used_as_an_index_type_2538","Type '{0}' cannot be used as an index type."),Cannot_assign_to_0_because_it_is_not_a_variable:t(2539,e.DiagnosticCategory.Error,"Cannot_assign_to_0_because_it_is_not_a_variable_2539","Cannot assign to '{0}' because it is not a variable."),Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property:t(2540,e.DiagnosticCategory.Error,"Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property_2540","Cannot assign to '{0}' because it is a constant or a read-only property."),The_target_of_an_assignment_must_be_a_variable_or_a_property_access:t(2541,e.DiagnosticCategory.Error,"The_target_of_an_assignment_must_be_a_variable_or_a_property_access_2541","The target of an assignment must be a variable or a property access."),Index_signature_in_type_0_only_permits_reading:t(2542,e.DiagnosticCategory.Error,"Index_signature_in_type_0_only_permits_reading_2542","Index signature in type '{0}' only permits reading."),Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_meta_property_reference:t(2543,e.DiagnosticCategory.Error,"Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_me_2543","Duplicate identifier '_newTarget'. Compiler uses variable declaration '_newTarget' to capture 'new.target' meta-property reference."),Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta_property_reference:t(2544,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta__2544","Expression resolves to variable declaration '_newTarget' that compiler uses to capture 'new.target' meta-property reference."),A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any:t(2545,e.DiagnosticCategory.Error,"A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any_2545","A mixin class must have a constructor with a single rest parameter of type 'any[]'."),Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1:t(2546,e.DiagnosticCategory.Error,"Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1_2546","Property '{0}' has conflicting declarations and is inaccessible in type '{1}'."),The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property:t(2547,e.DiagnosticCategory.Error,"The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value__2547","The type returned by the 'next()' method of an async iterator must be a promise for a type with a 'value' property."),Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2548,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator_2548","Type '{0}' is not an array type or does not have a '[Symbol.iterator]()' method that returns an iterator."),Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2549,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns__2549","Type '{0}' is not an array type or a string type or does not have a '[Symbol.iterator]()' method that returns an iterator."),Generic_type_instantiation_is_excessively_deep_and_possibly_infinite:t(2550,e.DiagnosticCategory.Error,"Generic_type_instantiation_is_excessively_deep_and_possibly_infinite_2550","Generic type instantiation is excessively deep and possibly infinite."),Property_0_does_not_exist_on_type_1_Did_you_mean_2:t(2551,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_type_1_Did_you_mean_2_2551","Property '{0}' does not exist on type '{1}'. Did you mean '{2}'?"),Cannot_find_name_0_Did_you_mean_1:t(2552,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_1_2552","Cannot find name '{0}'. Did you mean '{1}'?"),Computed_values_are_not_permitted_in_an_enum_with_string_valued_members:t(2553,e.DiagnosticCategory.Error,"Computed_values_are_not_permitted_in_an_enum_with_string_valued_members_2553","Computed values are not permitted in an enum with string valued members."),Expected_0_arguments_but_got_1:t(2554,e.DiagnosticCategory.Error,"Expected_0_arguments_but_got_1_2554","Expected {0} arguments, but got {1}."),Expected_at_least_0_arguments_but_got_1:t(2555,e.DiagnosticCategory.Error,"Expected_at_least_0_arguments_but_got_1_2555","Expected at least {0} arguments, but got {1}."),Expected_0_arguments_but_got_a_minimum_of_1:t(2556,e.DiagnosticCategory.Error,"Expected_0_arguments_but_got_a_minimum_of_1_2556","Expected {0} arguments, but got a minimum of {1}."),Expected_at_least_0_arguments_but_got_a_minimum_of_1:t(2557,e.DiagnosticCategory.Error,"Expected_at_least_0_arguments_but_got_a_minimum_of_1_2557","Expected at least {0} arguments, but got a minimum of {1}."),Expected_0_type_arguments_but_got_1:t(2558,e.DiagnosticCategory.Error,"Expected_0_type_arguments_but_got_1_2558","Expected {0} type arguments, but got {1}."),Type_0_has_no_properties_in_common_with_type_1:t(2559,e.DiagnosticCategory.Error,"Type_0_has_no_properties_in_common_with_type_1_2559","Type '{0}' has no properties in common with type '{1}'."),Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it:t(2560,e.DiagnosticCategory.Error,"Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it_2560","Value of type '{0}' has no properties in common with type '{1}'. Did you mean to call it?"),Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_write_2:t(2561,e.DiagnosticCategory.Error,"Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_writ_2561","Object literal may only specify known properties, but '{0}' does not exist in type '{1}'. Did you mean to write '{2}'?"),Base_class_expressions_cannot_reference_class_type_parameters:t(2562,e.DiagnosticCategory.Error,"Base_class_expressions_cannot_reference_class_type_parameters_2562","Base class expressions cannot reference class type parameters."),The_containing_function_or_module_body_is_too_large_for_control_flow_analysis:t(2563,e.DiagnosticCategory.Error,"The_containing_function_or_module_body_is_too_large_for_control_flow_analysis_2563","The containing function or module body is too large for control flow analysis."),JSX_element_attributes_type_0_may_not_be_a_union_type:t(2600,e.DiagnosticCategory.Error,"JSX_element_attributes_type_0_may_not_be_a_union_type_2600","JSX element attributes type '{0}' may not be a union type."),The_return_type_of_a_JSX_element_constructor_must_return_an_object_type:t(2601,e.DiagnosticCategory.Error,"The_return_type_of_a_JSX_element_constructor_must_return_an_object_type_2601","The return type of a JSX element constructor must return an object type."),JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist:t(2602,e.DiagnosticCategory.Error,"JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist_2602","JSX element implicitly has type 'any' because the global type 'JSX.Element' does not exist."),Property_0_in_type_1_is_not_assignable_to_type_2:t(2603,e.DiagnosticCategory.Error,"Property_0_in_type_1_is_not_assignable_to_type_2_2603","Property '{0}' in type '{1}' is not assignable to type '{2}'."),JSX_element_type_0_does_not_have_any_construct_or_call_signatures:t(2604,e.DiagnosticCategory.Error,"JSX_element_type_0_does_not_have_any_construct_or_call_signatures_2604","JSX element type '{0}' does not have any construct or call signatures."),JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements:t(2605,e.DiagnosticCategory.Error,"JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements_2605","JSX element type '{0}' is not a constructor function for JSX elements."),Property_0_of_JSX_spread_attribute_is_not_assignable_to_target_property:t(2606,e.DiagnosticCategory.Error,"Property_0_of_JSX_spread_attribute_is_not_assignable_to_target_property_2606","Property '{0}' of JSX spread attribute is not assignable to target property."),JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property:t(2607,e.DiagnosticCategory.Error,"JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property_2607","JSX element class does not support attributes because it does not have a '{0}' property."),The_global_type_JSX_0_may_not_have_more_than_one_property:t(2608,e.DiagnosticCategory.Error,"The_global_type_JSX_0_may_not_have_more_than_one_property_2608","The global type 'JSX.{0}' may not have more than one property."),JSX_spread_child_must_be_an_array_type:t(2609,e.DiagnosticCategory.Error,"JSX_spread_child_must_be_an_array_type_2609","JSX spread child must be an array type."),Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity:t(2649,e.DiagnosticCategory.Error,"Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity_2649","Cannot augment module '{0}' with value exports because it resolves to a non-module entity."),A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums:t(2651,e.DiagnosticCategory.Error,"A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_memb_2651","A member initializer in a enum declaration cannot reference members declared after it, including members defined in other enums."),Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_default_0_declaration_instead:t(2652,e.DiagnosticCategory.Error,"Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_d_2652","Merged declaration '{0}' cannot include a default export declaration. Consider adding a separate 'export default {0}' declaration instead."),Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1:t(2653,e.DiagnosticCategory.Error,"Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1_2653","Non-abstract class expression does not implement inherited abstract member '{0}' from class '{1}'."),Exported_external_package_typings_file_cannot_contain_tripleslash_references_Please_contact_the_package_author_to_update_the_package_definition:t(2654,e.DiagnosticCategory.Error,"Exported_external_package_typings_file_cannot_contain_tripleslash_references_Please_contact_the_pack_2654","Exported external package typings file cannot contain tripleslash references. Please contact the package author to update the package definition."),Exported_external_package_typings_file_0_is_not_a_module_Please_contact_the_package_author_to_update_the_package_definition:t(2656,e.DiagnosticCategory.Error,"Exported_external_package_typings_file_0_is_not_a_module_Please_contact_the_package_author_to_update_2656","Exported external package typings file '{0}' is not a module. Please contact the package author to update the package definition."),JSX_expressions_must_have_one_parent_element:t(2657,e.DiagnosticCategory.Error,"JSX_expressions_must_have_one_parent_element_2657","JSX expressions must have one parent element."),Type_0_provides_no_match_for_the_signature_1:t(2658,e.DiagnosticCategory.Error,"Type_0_provides_no_match_for_the_signature_1_2658","Type '{0}' provides no match for the signature '{1}'."),super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_higher:t(2659,e.DiagnosticCategory.Error,"super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_highe_2659","'super' is only allowed in members of object literal expressions when option 'target' is 'ES2015' or higher."),super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions:t(2660,e.DiagnosticCategory.Error,"super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions_2660","'super' can only be referenced in members of derived classes or object literal expressions."),Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module:t(2661,e.DiagnosticCategory.Error,"Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module_2661","Cannot export '{0}'. Only local declarations can be exported from a module."),Cannot_find_name_0_Did_you_mean_the_static_member_1_0:t(2662,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_the_static_member_1_0_2662","Cannot find name '{0}'. Did you mean the static member '{1}.{0}'?"),Cannot_find_name_0_Did_you_mean_the_instance_member_this_0:t(2663,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_the_instance_member_this_0_2663","Cannot find name '{0}'. Did you mean the instance member 'this.{0}'?"),Invalid_module_name_in_augmentation_module_0_cannot_be_found:t(2664,e.DiagnosticCategory.Error,"Invalid_module_name_in_augmentation_module_0_cannot_be_found_2664","Invalid module name in augmentation, module '{0}' cannot be found."),Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augmented:t(2665,e.DiagnosticCategory.Error,"Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augm_2665","Invalid module name in augmentation. Module '{0}' resolves to an untyped module at '{1}', which cannot be augmented."),Exports_and_export_assignments_are_not_permitted_in_module_augmentations:t(2666,e.DiagnosticCategory.Error,"Exports_and_export_assignments_are_not_permitted_in_module_augmentations_2666","Exports and export assignments are not permitted in module augmentations."),Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_module:t(2667,e.DiagnosticCategory.Error,"Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_mod_2667","Imports are not permitted in module augmentations. Consider moving them to the enclosing external module."),export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always_visible:t(2668,e.DiagnosticCategory.Error,"export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always__2668","'export' modifier cannot be applied to ambient modules and module augmentations since they are always visible."),Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations:t(2669,e.DiagnosticCategory.Error,"Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_2669","Augmentations for the global scope can only be directly nested in external modules or ambient module declarations."),Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambient_context:t(2670,e.DiagnosticCategory.Error,"Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambien_2670","Augmentations for the global scope should have 'declare' modifier unless they appear in already ambient context."),Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity:t(2671,e.DiagnosticCategory.Error,"Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity_2671","Cannot augment module '{0}' because it resolves to a non-module entity."),Cannot_assign_a_0_constructor_type_to_a_1_constructor_type:t(2672,e.DiagnosticCategory.Error,"Cannot_assign_a_0_constructor_type_to_a_1_constructor_type_2672","Cannot assign a '{0}' constructor type to a '{1}' constructor type."),Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration:t(2673,e.DiagnosticCategory.Error,"Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration_2673","Constructor of class '{0}' is private and only accessible within the class declaration."),Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration:t(2674,e.DiagnosticCategory.Error,"Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration_2674","Constructor of class '{0}' is protected and only accessible within the class declaration."),Cannot_extend_a_class_0_Class_constructor_is_marked_as_private:t(2675,e.DiagnosticCategory.Error,"Cannot_extend_a_class_0_Class_constructor_is_marked_as_private_2675","Cannot extend a class '{0}'. Class constructor is marked as private."),Accessors_must_both_be_abstract_or_non_abstract:t(2676,e.DiagnosticCategory.Error,"Accessors_must_both_be_abstract_or_non_abstract_2676","Accessors must both be abstract or non-abstract."),A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type:t(2677,e.DiagnosticCategory.Error,"A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type_2677","A type predicate's type must be assignable to its parameter's type."),Type_0_is_not_comparable_to_type_1:t(2678,e.DiagnosticCategory.Error,"Type_0_is_not_comparable_to_type_1_2678","Type '{0}' is not comparable to type '{1}'."),A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void:t(2679,e.DiagnosticCategory.Error,"A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void_2679","A function that is called with the 'new' keyword cannot have a 'this' type that is 'void'."),A_0_parameter_must_be_the_first_parameter:t(2680,e.DiagnosticCategory.Error,"A_0_parameter_must_be_the_first_parameter_2680","A '{0}' parameter must be the first parameter."),A_constructor_cannot_have_a_this_parameter:t(2681,e.DiagnosticCategory.Error,"A_constructor_cannot_have_a_this_parameter_2681","A constructor cannot have a 'this' parameter."),get_and_set_accessor_must_have_the_same_this_type:t(2682,e.DiagnosticCategory.Error,"get_and_set_accessor_must_have_the_same_this_type_2682","'get' and 'set' accessor must have the same 'this' type."),this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation:t(2683,e.DiagnosticCategory.Error,"this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_2683","'this' implicitly has type 'any' because it does not have a type annotation."),The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1:t(2684,e.DiagnosticCategory.Error,"The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1_2684","The 'this' context of type '{0}' is not assignable to method's 'this' of type '{1}'."),The_this_types_of_each_signature_are_incompatible:t(2685,e.DiagnosticCategory.Error,"The_this_types_of_each_signature_are_incompatible_2685","The 'this' types of each signature are incompatible."),_0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead:t(2686,e.DiagnosticCategory.Error,"_0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead_2686","'{0}' refers to a UMD global, but the current file is a module. Consider adding an import instead."),All_declarations_of_0_must_have_identical_modifiers:t(2687,e.DiagnosticCategory.Error,"All_declarations_of_0_must_have_identical_modifiers_2687","All declarations of '{0}' must have identical modifiers."),Cannot_find_type_definition_file_for_0:t(2688,e.DiagnosticCategory.Error,"Cannot_find_type_definition_file_for_0_2688","Cannot find type definition file for '{0}'."),Cannot_extend_an_interface_0_Did_you_mean_implements:t(2689,e.DiagnosticCategory.Error,"Cannot_extend_an_interface_0_Did_you_mean_implements_2689","Cannot extend an interface '{0}'. Did you mean 'implements'?"),An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead:t(2691,e.DiagnosticCategory.Error,"An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead_2691","An import path cannot end with a '{0}' extension. Consider importing '{1}' instead."),_0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible:t(2692,e.DiagnosticCategory.Error,"_0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible_2692","'{0}' is a primitive, but '{1}' is a wrapper object. Prefer using '{0}' when possible."),_0_only_refers_to_a_type_but_is_being_used_as_a_value_here:t(2693,e.DiagnosticCategory.Error,"_0_only_refers_to_a_type_but_is_being_used_as_a_value_here_2693","'{0}' only refers to a type, but is being used as a value here."),Namespace_0_has_no_exported_member_1:t(2694,e.DiagnosticCategory.Error,"Namespace_0_has_no_exported_member_1_2694","Namespace '{0}' has no exported member '{1}'."),Left_side_of_comma_operator_is_unused_and_has_no_side_effects:t(2695,e.DiagnosticCategory.Error,"Left_side_of_comma_operator_is_unused_and_has_no_side_effects_2695","Left side of comma operator is unused and has no side effects."),The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead:t(2696,e.DiagnosticCategory.Error,"The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead_2696","The 'Object' type is assignable to very few other types. Did you mean to use the 'any' type instead?"),An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:t(2697,e.DiagnosticCategory.Error,"An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_in_2697","An async function or method must return a 'Promise'. Make sure you have a declaration for 'Promise' or include 'ES2015' in your `--lib` option."),Spread_types_may_only_be_created_from_object_types:t(2698,e.DiagnosticCategory.Error,"Spread_types_may_only_be_created_from_object_types_2698","Spread types may only be created from object types."),Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1:t(2699,e.DiagnosticCategory.Error,"Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1_2699","Static property '{0}' conflicts with built-in property 'Function.{0}' of constructor function '{1}'."),Rest_types_may_only_be_created_from_object_types:t(2700,e.DiagnosticCategory.Error,"Rest_types_may_only_be_created_from_object_types_2700","Rest types may only be created from object types."),The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access:t(2701,e.DiagnosticCategory.Error,"The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access_2701","The target of an object rest assignment must be a variable or a property access."),_0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here:t(2702,e.DiagnosticCategory.Error,"_0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here_2702","'{0}' only refers to a type, but is being used as a namespace here."),The_operand_of_a_delete_operator_must_be_a_property_reference:t(2703,e.DiagnosticCategory.Error,"The_operand_of_a_delete_operator_must_be_a_property_reference_2703","The operand of a delete operator must be a property reference."),The_operand_of_a_delete_operator_cannot_be_a_read_only_property:t(2704,e.DiagnosticCategory.Error,"The_operand_of_a_delete_operator_cannot_be_a_read_only_property_2704","The operand of a delete operator cannot be a read-only property."),An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:t(2705,e.DiagnosticCategory.Error,"An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_de_2705","An async function or method in ES5/ES3 requires the 'Promise' constructor.  Make sure you have a declaration for the 'Promise' constructor or include 'ES2015' in your `--lib` option."),Required_type_parameters_may_not_follow_optional_type_parameters:t(2706,e.DiagnosticCategory.Error,"Required_type_parameters_may_not_follow_optional_type_parameters_2706","Required type parameters may not follow optional type parameters."),Generic_type_0_requires_between_1_and_2_type_arguments:t(2707,e.DiagnosticCategory.Error,"Generic_type_0_requires_between_1_and_2_type_arguments_2707","Generic type '{0}' requires between {1} and {2} type arguments."),Cannot_use_namespace_0_as_a_value:t(2708,e.DiagnosticCategory.Error,"Cannot_use_namespace_0_as_a_value_2708","Cannot use namespace '{0}' as a value."),Cannot_use_namespace_0_as_a_type:t(2709,e.DiagnosticCategory.Error,"Cannot_use_namespace_0_as_a_type_2709","Cannot use namespace '{0}' as a type."),_0_are_specified_twice_The_attribute_named_0_will_be_overwritten:t(2710,e.DiagnosticCategory.Error,"_0_are_specified_twice_The_attribute_named_0_will_be_overwritten_2710","'{0}' are specified twice. The attribute named '{0}' will be overwritten."),A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:t(2711,e.DiagnosticCategory.Error,"A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES20_2711","A dynamic import call returns a 'Promise'. Make sure you have a declaration for 'Promise' or include 'ES2015' in your `--lib` option."),A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:t(2712,e.DiagnosticCategory.Error,"A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declarat_2712","A dynamic import call in ES5/ES3 requires the 'Promise' constructor.  Make sure you have a declaration for the 'Promise' constructor or include 'ES2015' in your `--lib` option."),Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1:t(2713,e.DiagnosticCategory.Error,"Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_p_2713","Cannot access '{0}.{1}' because '{0}' is a type, but not a namespace. Did you mean to retrieve the type of the property '{1}' in '{0}' with '{0}[\"{1}\"]'?"),The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context:t(2714,e.DiagnosticCategory.Error,"The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context_2714","The expression of an export assignment must be an identifier or qualified name in an ambient context."),Type_parameter_0_has_a_circular_default:t(2716,e.DiagnosticCategory.Error,"Type_parameter_0_has_a_circular_default_2716","Type parameter '{0}' has a circular default."),Import_declaration_0_is_using_private_name_1:t(4e3,e.DiagnosticCategory.Error,"Import_declaration_0_is_using_private_name_1_4000","Import declaration '{0}' is using private name '{1}'."),Type_parameter_0_of_exported_class_has_or_is_using_private_name_1:t(4002,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_class_has_or_is_using_private_name_1_4002","Type parameter '{0}' of exported class has or is using private name '{1}'."),Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1:t(4004,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1_4004","Type parameter '{0}' of exported interface has or is using private name '{1}'."),Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1:t(4006,e.DiagnosticCategory.Error,"Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1_4006","Type parameter '{0}' of constructor signature from exported interface has or is using private name '{1}'."),Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1:t(4008,e.DiagnosticCategory.Error,"Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1_4008","Type parameter '{0}' of call signature from exported interface has or is using private name '{1}'."),Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:t(4010,e.DiagnosticCategory.Error,"Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1_4010","Type parameter '{0}' of public static method from exported class has or is using private name '{1}'."),Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:t(4012,e.DiagnosticCategory.Error,"Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1_4012","Type parameter '{0}' of public method from exported class has or is using private name '{1}'."),Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1:t(4014,e.DiagnosticCategory.Error,"Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1_4014","Type parameter '{0}' of method from exported interface has or is using private name '{1}'."),Type_parameter_0_of_exported_function_has_or_is_using_private_name_1:t(4016,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_function_has_or_is_using_private_name_1_4016","Type parameter '{0}' of exported function has or is using private name '{1}'."),Implements_clause_of_exported_class_0_has_or_is_using_private_name_1:t(4019,e.DiagnosticCategory.Error,"Implements_clause_of_exported_class_0_has_or_is_using_private_name_1_4019","Implements clause of exported class '{0}' has or is using private name '{1}'."),extends_clause_of_exported_class_0_has_or_is_using_private_name_1:t(4020,e.DiagnosticCategory.Error,"extends_clause_of_exported_class_0_has_or_is_using_private_name_1_4020","'extends' clause of exported class '{0}' has or is using private name '{1}'."),extends_clause_of_exported_interface_0_has_or_is_using_private_name_1:t(4022,e.DiagnosticCategory.Error,"extends_clause_of_exported_interface_0_has_or_is_using_private_name_1_4022","'extends' clause of exported interface '{0}' has or is using private name '{1}'."),Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4023,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named_4023","Exported variable '{0}' has or is using name '{1}' from external module {2} but cannot be named."),Exported_variable_0_has_or_is_using_name_1_from_private_module_2:t(4024,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_name_1_from_private_module_2_4024","Exported variable '{0}' has or is using name '{1}' from private module '{2}'."),Exported_variable_0_has_or_is_using_private_name_1:t(4025,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_private_name_1_4025","Exported variable '{0}' has or is using private name '{1}'."),Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4026,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot__4026","Public static property '{0}' of exported class has or is using name '{1}' from external module {2} but cannot be named."),Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:t(4027,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2_4027","Public static property '{0}' of exported class has or is using name '{1}' from private module '{2}'."),Public_static_property_0_of_exported_class_has_or_is_using_private_name_1:t(4028,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_private_name_1_4028","Public static property '{0}' of exported class has or is using private name '{1}'."),Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4029,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_name_4029","Public property '{0}' of exported class has or is using name '{1}' from external module {2} but cannot be named."),Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:t(4030,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2_4030","Public property '{0}' of exported class has or is using name '{1}' from private module '{2}'."),Public_property_0_of_exported_class_has_or_is_using_private_name_1:t(4031,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_private_name_1_4031","Public property '{0}' of exported class has or is using private name '{1}'."),Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4032,e.DiagnosticCategory.Error,"Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2_4032","Property '{0}' of exported interface has or is using name '{1}' from private module '{2}'."),Property_0_of_exported_interface_has_or_is_using_private_name_1:t(4033,e.DiagnosticCategory.Error,"Property_0_of_exported_interface_has_or_is_using_private_name_1_4033","Property '{0}' of exported interface has or is using private name '{1}'."),Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4034,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_4034","Parameter '{0}' of public static property setter from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1:t(4035,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1_4035","Parameter '{0}' of public static property setter from exported class has or is using private name '{1}'."),Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4036,e.DiagnosticCategory.Error,"Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_4036","Parameter '{0}' of public property setter from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1:t(4037,e.DiagnosticCategory.Error,"Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1_4037","Parameter '{0}' of public property setter from exported class has or is using private name '{1}'."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4038,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_externa_4038","Return type of public static property getter from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4039,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_4039","Return type of public static property getter from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0:t(4040,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0_4040","Return type of public static property getter from exported class has or is using private name '{0}'."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4041,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_modul_4041","Return type of public property getter from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4042,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_4042","Return type of public property getter from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0:t(4043,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0_4043","Return type of public property getter from exported class has or is using private name '{0}'."),Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4044,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_mod_4044","Return type of constructor signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0:t(4045,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0_4045","Return type of constructor signature from exported interface has or is using private name '{0}'."),Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4046,e.DiagnosticCategory.Error,"Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4046","Return type of call signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0:t(4047,e.DiagnosticCategory.Error,"Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0_4047","Return type of call signature from exported interface has or is using private name '{0}'."),Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4048,e.DiagnosticCategory.Error,"Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4048","Return type of index signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0:t(4049,e.DiagnosticCategory.Error,"Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0_4049","Return type of index signature from exported interface has or is using private name '{0}'."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4050,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module__4050","Return type of public static method from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4051,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1_4051","Return type of public static method from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0:t(4052,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0_4052","Return type of public static method from exported class has or is using private name '{0}'."),Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4053,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_c_4053","Return type of public method from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4054,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1_4054","Return type of public method from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0:t(4055,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0_4055","Return type of public method from exported class has or is using private name '{0}'."),Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4056,e.DiagnosticCategory.Error,"Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4056","Return type of method from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0:t(4057,e.DiagnosticCategory.Error,"Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0_4057","Return type of method from exported interface has or is using private name '{0}'."),Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4058,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named_4058","Return type of exported function has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1:t(4059,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1_4059","Return type of exported function has or is using name '{0}' from private module '{1}'."),Return_type_of_exported_function_has_or_is_using_private_name_0:t(4060,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_private_name_0_4060","Return type of exported function has or is using private name '{0}'."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4061,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_can_4061","Parameter '{0}' of constructor from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4062,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2_4062","Parameter '{0}' of constructor from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1:t(4063,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1_4063","Parameter '{0}' of constructor from exported class has or is using private name '{1}'."),Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4064,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_mod_4064","Parameter '{0}' of constructor signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1:t(4065,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1_4065","Parameter '{0}' of constructor signature from exported interface has or is using private name '{1}'."),Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4066,e.DiagnosticCategory.Error,"Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4066","Parameter '{0}' of call signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1:t(4067,e.DiagnosticCategory.Error,"Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1_4067","Parameter '{0}' of call signature from exported interface has or is using private name '{1}'."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4068,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module__4068","Parameter '{0}' of public static method from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4069,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2_4069","Parameter '{0}' of public static method from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:t(4070,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1_4070","Parameter '{0}' of public static method from exported class has or is using private name '{1}'."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4071,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_c_4071","Parameter '{0}' of public method from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4072,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2_4072","Parameter '{0}' of public method from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:t(4073,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1_4073","Parameter '{0}' of public method from exported class has or is using private name '{1}'."),Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4074,e.DiagnosticCategory.Error,"Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4074","Parameter '{0}' of method from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1:t(4075,e.DiagnosticCategory.Error,"Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1_4075","Parameter '{0}' of method from exported interface has or is using private name '{1}'."),Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4076,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named_4076","Parameter '{0}' of exported function has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2:t(4077,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2_4077","Parameter '{0}' of exported function has or is using name '{1}' from private module '{2}'."),Parameter_0_of_exported_function_has_or_is_using_private_name_1:t(4078,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_private_name_1_4078","Parameter '{0}' of exported function has or is using private name '{1}'."),Exported_type_alias_0_has_or_is_using_private_name_1:t(4081,e.DiagnosticCategory.Error,"Exported_type_alias_0_has_or_is_using_private_name_1_4081","Exported type alias '{0}' has or is using private name '{1}'."),Default_export_of_the_module_has_or_is_using_private_name_0:t(4082,e.DiagnosticCategory.Error,"Default_export_of_the_module_has_or_is_using_private_name_0_4082","Default export of the module has or is using private name '{0}'."),Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1:t(4083,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1_4083","Type parameter '{0}' of exported type alias has or is using private name '{1}'."),Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_library_to_resolve_the_conflict:t(4090,e.DiagnosticCategory.Message,"Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_librar_4090","Conflicting definitions for '{0}' found at '{1}' and '{2}'. Consider installing a specific version of this library to resolve the conflict."),Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4091,e.DiagnosticCategory.Error,"Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4091","Parameter '{0}' of index signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1:t(4092,e.DiagnosticCategory.Error,"Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1_4092","Parameter '{0}' of index signature from exported interface has or is using private name '{1}'."),Property_0_of_exported_class_expression_may_not_be_private_or_protected:t(4094,e.DiagnosticCategory.Error,"Property_0_of_exported_class_expression_may_not_be_private_or_protected_4094","Property '{0}' of exported class expression may not be private or protected."),The_current_host_does_not_support_the_0_option:t(5001,e.DiagnosticCategory.Error,"The_current_host_does_not_support_the_0_option_5001","The current host does not support the '{0}' option."),Cannot_find_the_common_subdirectory_path_for_the_input_files:t(5009,e.DiagnosticCategory.Error,"Cannot_find_the_common_subdirectory_path_for_the_input_files_5009","Cannot find the common subdirectory path for the input files."),File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:t(5010,e.DiagnosticCategory.Error,"File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0_5010","File specification cannot end in a recursive directory wildcard ('**'): '{0}'."),File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0:t(5011,e.DiagnosticCategory.Error,"File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0_5011","File specification cannot contain multiple recursive directory wildcards ('**'): '{0}'."),Cannot_read_file_0_Colon_1:t(5012,e.DiagnosticCategory.Error,"Cannot_read_file_0_Colon_1_5012","Cannot read file '{0}': {1}."),Failed_to_parse_file_0_Colon_1:t(5014,e.DiagnosticCategory.Error,"Failed_to_parse_file_0_Colon_1_5014","Failed to parse file '{0}': {1}."),Unknown_compiler_option_0:t(5023,e.DiagnosticCategory.Error,"Unknown_compiler_option_0_5023","Unknown compiler option '{0}'."),Compiler_option_0_requires_a_value_of_type_1:t(5024,e.DiagnosticCategory.Error,"Compiler_option_0_requires_a_value_of_type_1_5024","Compiler option '{0}' requires a value of type {1}."),Could_not_write_file_0_Colon_1:t(5033,e.DiagnosticCategory.Error,"Could_not_write_file_0_Colon_1_5033","Could not write file '{0}': {1}."),Option_project_cannot_be_mixed_with_source_files_on_a_command_line:t(5042,e.DiagnosticCategory.Error,"Option_project_cannot_be_mixed_with_source_files_on_a_command_line_5042","Option 'project' cannot be mixed with source files on a command line."),Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES2015_or_higher:t(5047,e.DiagnosticCategory.Error,"Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES_5047","Option 'isolatedModules' can only be used when either option '--module' is provided or option 'target' is 'ES2015' or higher."),Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided:t(5051,e.DiagnosticCategory.Error,"Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided_5051","Option '{0} can only be used when either option '--inlineSourceMap' or option '--sourceMap' is provided."),Option_0_cannot_be_specified_without_specifying_option_1:t(5052,e.DiagnosticCategory.Error,"Option_0_cannot_be_specified_without_specifying_option_1_5052","Option '{0}' cannot be specified without specifying option '{1}'."),Option_0_cannot_be_specified_with_option_1:t(5053,e.DiagnosticCategory.Error,"Option_0_cannot_be_specified_with_option_1_5053","Option '{0}' cannot be specified with option '{1}'."),A_tsconfig_json_file_is_already_defined_at_Colon_0:t(5054,e.DiagnosticCategory.Error,"A_tsconfig_json_file_is_already_defined_at_Colon_0_5054","A 'tsconfig.json' file is already defined at: '{0}'."),Cannot_write_file_0_because_it_would_overwrite_input_file:t(5055,e.DiagnosticCategory.Error,"Cannot_write_file_0_because_it_would_overwrite_input_file_5055","Cannot write file '{0}' because it would overwrite input file."),Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files:t(5056,e.DiagnosticCategory.Error,"Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files_5056","Cannot write file '{0}' because it would be overwritten by multiple input files."),Cannot_find_a_tsconfig_json_file_at_the_specified_directory_Colon_0:t(5057,e.DiagnosticCategory.Error,"Cannot_find_a_tsconfig_json_file_at_the_specified_directory_Colon_0_5057","Cannot find a tsconfig.json file at the specified directory: '{0}'."),The_specified_path_does_not_exist_Colon_0:t(5058,e.DiagnosticCategory.Error,"The_specified_path_does_not_exist_Colon_0_5058","The specified path does not exist: '{0}'."),Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier:t(5059,e.DiagnosticCategory.Error,"Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier_5059","Invalid value for '--reactNamespace'. '{0}' is not a valid identifier."),Option_paths_cannot_be_used_without_specifying_baseUrl_option:t(5060,e.DiagnosticCategory.Error,"Option_paths_cannot_be_used_without_specifying_baseUrl_option_5060","Option 'paths' cannot be used without specifying '--baseUrl' option."),Pattern_0_can_have_at_most_one_Asterisk_character:t(5061,e.DiagnosticCategory.Error,"Pattern_0_can_have_at_most_one_Asterisk_character_5061","Pattern '{0}' can have at most one '*' character."),Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character:t(5062,e.DiagnosticCategory.Error,"Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character_5062","Substitution '{0}' in pattern '{1}' in can have at most one '*' character."),Substitutions_for_pattern_0_should_be_an_array:t(5063,e.DiagnosticCategory.Error,"Substitutions_for_pattern_0_should_be_an_array_5063","Substitutions for pattern '{0}' should be an array."),Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2:t(5064,e.DiagnosticCategory.Error,"Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2_5064","Substitution '{0}' for pattern '{1}' has incorrect type, expected 'string', got '{2}'."),File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:t(5065,e.DiagnosticCategory.Error,"File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildca_5065","File specification cannot contain a parent directory ('..') that appears after a recursive directory wildcard ('**'): '{0}'."),Substitutions_for_pattern_0_shouldn_t_be_an_empty_array:t(5066,e.DiagnosticCategory.Error,"Substitutions_for_pattern_0_shouldn_t_be_an_empty_array_5066","Substitutions for pattern '{0}' shouldn't be an empty array."),Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name:t(5067,e.DiagnosticCategory.Error,"Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name_5067","Invalid value for 'jsxFactory'. '{0}' is not a valid identifier or qualified-name."),Concatenate_and_emit_output_to_single_file:t(6001,e.DiagnosticCategory.Message,"Concatenate_and_emit_output_to_single_file_6001","Concatenate and emit output to single file."),Generates_corresponding_d_ts_file:t(6002,e.DiagnosticCategory.Message,"Generates_corresponding_d_ts_file_6002","Generates corresponding '.d.ts' file."),Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations:t(6003,e.DiagnosticCategory.Message,"Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations_6003","Specify the location where debugger should locate map files instead of generated locations."),Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations:t(6004,e.DiagnosticCategory.Message,"Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations_6004","Specify the location where debugger should locate TypeScript files instead of source locations."),Watch_input_files:t(6005,e.DiagnosticCategory.Message,"Watch_input_files_6005","Watch input files."),Redirect_output_structure_to_the_directory:t(6006,e.DiagnosticCategory.Message,"Redirect_output_structure_to_the_directory_6006","Redirect output structure to the directory."),Do_not_erase_const_enum_declarations_in_generated_code:t(6007,e.DiagnosticCategory.Message,"Do_not_erase_const_enum_declarations_in_generated_code_6007","Do not erase const enum declarations in generated code."),Do_not_emit_outputs_if_any_errors_were_reported:t(6008,e.DiagnosticCategory.Message,"Do_not_emit_outputs_if_any_errors_were_reported_6008","Do not emit outputs if any errors were reported."),Do_not_emit_comments_to_output:t(6009,e.DiagnosticCategory.Message,"Do_not_emit_comments_to_output_6009","Do not emit comments to output."),Do_not_emit_outputs:t(6010,e.DiagnosticCategory.Message,"Do_not_emit_outputs_6010","Do not emit outputs."),Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typechecking:t(6011,e.DiagnosticCategory.Message,"Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typech_6011","Allow default imports from modules with no default export. This does not affect code emit, just typechecking."),Skip_type_checking_of_declaration_files:t(6012,e.DiagnosticCategory.Message,"Skip_type_checking_of_declaration_files_6012","Skip type checking of declaration files."),Do_not_resolve_the_real_path_of_symlinks:t(6013,e.DiagnosticCategory.Message,"Do_not_resolve_the_real_path_of_symlinks_6013","Do not resolve the real path of symlinks."),Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT:t(6015,e.DiagnosticCategory.Message,"Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT_6015","Specify ECMAScript target version: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', or 'ESNEXT'."),Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext:t(6016,e.DiagnosticCategory.Message,"Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext_6016","Specify module code generation: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'."),Print_this_message:t(6017,e.DiagnosticCategory.Message,"Print_this_message_6017","Print this message."),Print_the_compiler_s_version:t(6019,e.DiagnosticCategory.Message,"Print_the_compiler_s_version_6019","Print the compiler's version."),Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json:t(6020,e.DiagnosticCategory.Message,"Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json_6020","Compile the project given the path to its configuration file, or to a folder with a 'tsconfig.json'."),Syntax_Colon_0:t(6023,e.DiagnosticCategory.Message,"Syntax_Colon_0_6023","Syntax: {0}"),options:t(6024,e.DiagnosticCategory.Message,"options_6024","options"),file:t(6025,e.DiagnosticCategory.Message,"file_6025","file"),Examples_Colon_0:t(6026,e.DiagnosticCategory.Message,"Examples_Colon_0_6026","Examples: {0}"),Options_Colon:t(6027,e.DiagnosticCategory.Message,"Options_Colon_6027","Options:"),Version_0:t(6029,e.DiagnosticCategory.Message,"Version_0_6029","Version {0}"),Insert_command_line_options_and_files_from_a_file:t(6030,e.DiagnosticCategory.Message,"Insert_command_line_options_and_files_from_a_file_6030","Insert command line options and files from a file."),File_change_detected_Starting_incremental_compilation:t(6032,e.DiagnosticCategory.Message,"File_change_detected_Starting_incremental_compilation_6032","File change detected. Starting incremental compilation..."),KIND:t(6034,e.DiagnosticCategory.Message,"KIND_6034","KIND"),FILE:t(6035,e.DiagnosticCategory.Message,"FILE_6035","FILE"),VERSION:t(6036,e.DiagnosticCategory.Message,"VERSION_6036","VERSION"),LOCATION:t(6037,e.DiagnosticCategory.Message,"LOCATION_6037","LOCATION"),DIRECTORY:t(6038,e.DiagnosticCategory.Message,"DIRECTORY_6038","DIRECTORY"),STRATEGY:t(6039,e.DiagnosticCategory.Message,"STRATEGY_6039","STRATEGY"),FILE_OR_DIRECTORY:t(6040,e.DiagnosticCategory.Message,"FILE_OR_DIRECTORY_6040","FILE OR DIRECTORY"),Compilation_complete_Watching_for_file_changes:t(6042,e.DiagnosticCategory.Message,"Compilation_complete_Watching_for_file_changes_6042","Compilation complete. Watching for file changes."),Generates_corresponding_map_file:t(6043,e.DiagnosticCategory.Message,"Generates_corresponding_map_file_6043","Generates corresponding '.map' file."),Compiler_option_0_expects_an_argument:t(6044,e.DiagnosticCategory.Error,"Compiler_option_0_expects_an_argument_6044","Compiler option '{0}' expects an argument."),Unterminated_quoted_string_in_response_file_0:t(6045,e.DiagnosticCategory.Error,"Unterminated_quoted_string_in_response_file_0_6045","Unterminated quoted string in response file '{0}'."),Argument_for_0_option_must_be_Colon_1:t(6046,e.DiagnosticCategory.Error,"Argument_for_0_option_must_be_Colon_1_6046","Argument for '{0}' option must be: {1}."),Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1:t(6048,e.DiagnosticCategory.Error,"Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1_6048","Locale must be of the form <language> or <language>-<territory>. For example '{0}' or '{1}'."),Unsupported_locale_0:t(6049,e.DiagnosticCategory.Error,"Unsupported_locale_0_6049","Unsupported locale '{0}'."),Unable_to_open_file_0:t(6050,e.DiagnosticCategory.Error,"Unable_to_open_file_0_6050","Unable to open file '{0}'."),Corrupted_locale_file_0:t(6051,e.DiagnosticCategory.Error,"Corrupted_locale_file_0_6051","Corrupted locale file {0}."),Raise_error_on_expressions_and_declarations_with_an_implied_any_type:t(6052,e.DiagnosticCategory.Message,"Raise_error_on_expressions_and_declarations_with_an_implied_any_type_6052","Raise error on expressions and declarations with an implied 'any' type."),File_0_not_found:t(6053,e.DiagnosticCategory.Error,"File_0_not_found_6053","File '{0}' not found."),File_0_has_unsupported_extension_The_only_supported_extensions_are_1:t(6054,e.DiagnosticCategory.Error,"File_0_has_unsupported_extension_The_only_supported_extensions_are_1_6054","File '{0}' has unsupported extension. The only supported extensions are {1}."),Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures:t(6055,e.DiagnosticCategory.Message,"Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures_6055","Suppress noImplicitAny errors for indexing objects lacking index signatures."),Do_not_emit_declarations_for_code_that_has_an_internal_annotation:t(6056,e.DiagnosticCategory.Message,"Do_not_emit_declarations_for_code_that_has_an_internal_annotation_6056","Do not emit declarations for code that has an '@internal' annotation."),Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir:t(6058,e.DiagnosticCategory.Message,"Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir_6058","Specify the root directory of input files. Use to control the output directory structure with --outDir."),File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files:t(6059,e.DiagnosticCategory.Error,"File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files_6059","File '{0}' is not under 'rootDir' '{1}'. 'rootDir' is expected to contain all source files."),Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix:t(6060,e.DiagnosticCategory.Message,"Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix_6060","Specify the end of line sequence to be used when emitting files: 'CRLF' (dos) or 'LF' (unix)."),NEWLINE:t(6061,e.DiagnosticCategory.Message,"NEWLINE_6061","NEWLINE"),Option_0_can_only_be_specified_in_tsconfig_json_file:t(6064,e.DiagnosticCategory.Error,"Option_0_can_only_be_specified_in_tsconfig_json_file_6064","Option '{0}' can only be specified in 'tsconfig.json' file."),Enables_experimental_support_for_ES7_decorators:t(6065,e.DiagnosticCategory.Message,"Enables_experimental_support_for_ES7_decorators_6065","Enables experimental support for ES7 decorators."),Enables_experimental_support_for_emitting_type_metadata_for_decorators:t(6066,e.DiagnosticCategory.Message,"Enables_experimental_support_for_emitting_type_metadata_for_decorators_6066","Enables experimental support for emitting type metadata for decorators."),Enables_experimental_support_for_ES7_async_functions:t(6068,e.DiagnosticCategory.Message,"Enables_experimental_support_for_ES7_async_functions_6068","Enables experimental support for ES7 async functions."),Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6:t(6069,e.DiagnosticCategory.Message,"Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6_6069","Specify module resolution strategy: 'node' (Node.js) or 'classic' (TypeScript pre-1.6)."),Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file:t(6070,e.DiagnosticCategory.Message,"Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file_6070","Initializes a TypeScript project and creates a tsconfig.json file."),Successfully_created_a_tsconfig_json_file:t(6071,e.DiagnosticCategory.Message,"Successfully_created_a_tsconfig_json_file_6071","Successfully created a tsconfig.json file."),Suppress_excess_property_checks_for_object_literals:t(6072,e.DiagnosticCategory.Message,"Suppress_excess_property_checks_for_object_literals_6072","Suppress excess property checks for object literals."),Stylize_errors_and_messages_using_color_and_context_experimental:t(6073,e.DiagnosticCategory.Message,"Stylize_errors_and_messages_using_color_and_context_experimental_6073","Stylize errors and messages using color and context (experimental)."),Do_not_report_errors_on_unused_labels:t(6074,e.DiagnosticCategory.Message,"Do_not_report_errors_on_unused_labels_6074","Do not report errors on unused labels."),Report_error_when_not_all_code_paths_in_function_return_a_value:t(6075,e.DiagnosticCategory.Message,"Report_error_when_not_all_code_paths_in_function_return_a_value_6075","Report error when not all code paths in function return a value."),Report_errors_for_fallthrough_cases_in_switch_statement:t(6076,e.DiagnosticCategory.Message,"Report_errors_for_fallthrough_cases_in_switch_statement_6076","Report errors for fallthrough cases in switch statement."),Do_not_report_errors_on_unreachable_code:t(6077,e.DiagnosticCategory.Message,"Do_not_report_errors_on_unreachable_code_6077","Do not report errors on unreachable code."),Disallow_inconsistently_cased_references_to_the_same_file:t(6078,e.DiagnosticCategory.Message,"Disallow_inconsistently_cased_references_to_the_same_file_6078","Disallow inconsistently-cased references to the same file."),Specify_library_files_to_be_included_in_the_compilation_Colon:t(6079,e.DiagnosticCategory.Message,"Specify_library_files_to_be_included_in_the_compilation_Colon_6079","Specify library files to be included in the compilation: "),Specify_JSX_code_generation_Colon_preserve_react_native_or_react:t(6080,e.DiagnosticCategory.Message,"Specify_JSX_code_generation_Colon_preserve_react_native_or_react_6080","Specify JSX code generation: 'preserve', 'react-native', or 'react'."),File_0_has_an_unsupported_extension_so_skipping_it:t(6081,e.DiagnosticCategory.Message,"File_0_has_an_unsupported_extension_so_skipping_it_6081","File '{0}' has an unsupported extension, so skipping it."),Only_amd_and_system_modules_are_supported_alongside_0:t(6082,e.DiagnosticCategory.Error,"Only_amd_and_system_modules_are_supported_alongside_0_6082","Only 'amd' and 'system' modules are supported alongside --{0}."),Base_directory_to_resolve_non_absolute_module_names:t(6083,e.DiagnosticCategory.Message,"Base_directory_to_resolve_non_absolute_module_names_6083","Base directory to resolve non-absolute module names."),Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react_JSX_emit:t(6084,e.DiagnosticCategory.Message,"Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react__6084","[Deprecated] Use '--jsxFactory' instead. Specify the object invoked for createElement when targeting 'react' JSX emit"),Enable_tracing_of_the_name_resolution_process:t(6085,e.DiagnosticCategory.Message,"Enable_tracing_of_the_name_resolution_process_6085","Enable tracing of the name resolution process."),Resolving_module_0_from_1:t(6086,e.DiagnosticCategory.Message,"Resolving_module_0_from_1_6086","======== Resolving module '{0}' from '{1}'. ========"),Explicitly_specified_module_resolution_kind_Colon_0:t(6087,e.DiagnosticCategory.Message,"Explicitly_specified_module_resolution_kind_Colon_0_6087","Explicitly specified module resolution kind: '{0}'."),Module_resolution_kind_is_not_specified_using_0:t(6088,e.DiagnosticCategory.Message,"Module_resolution_kind_is_not_specified_using_0_6088","Module resolution kind is not specified, using '{0}'."),Module_name_0_was_successfully_resolved_to_1:t(6089,e.DiagnosticCategory.Message,"Module_name_0_was_successfully_resolved_to_1_6089","======== Module name '{0}' was successfully resolved to '{1}'. ========"),Module_name_0_was_not_resolved:t(6090,e.DiagnosticCategory.Message,"Module_name_0_was_not_resolved_6090","======== Module name '{0}' was not resolved. ========"),paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0:t(6091,e.DiagnosticCategory.Message,"paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0_6091","'paths' option is specified, looking for a pattern to match module name '{0}'."),Module_name_0_matched_pattern_1:t(6092,e.DiagnosticCategory.Message,"Module_name_0_matched_pattern_1_6092","Module name '{0}', matched pattern '{1}'."),Trying_substitution_0_candidate_module_location_Colon_1:t(6093,e.DiagnosticCategory.Message,"Trying_substitution_0_candidate_module_location_Colon_1_6093","Trying substitution '{0}', candidate module location: '{1}'."),Resolving_module_name_0_relative_to_base_url_1_2:t(6094,e.DiagnosticCategory.Message,"Resolving_module_name_0_relative_to_base_url_1_2_6094","Resolving module name '{0}' relative to base url '{1}' - '{2}'."),Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1:t(6095,e.DiagnosticCategory.Message,"Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1_6095","Loading module as file / folder, candidate module location '{0}', target file type '{1}'."),File_0_does_not_exist:t(6096,e.DiagnosticCategory.Message,"File_0_does_not_exist_6096","File '{0}' does not exist."),File_0_exist_use_it_as_a_name_resolution_result:t(6097,e.DiagnosticCategory.Message,"File_0_exist_use_it_as_a_name_resolution_result_6097","File '{0}' exist - use it as a name resolution result."),Loading_module_0_from_node_modules_folder_target_file_type_1:t(6098,e.DiagnosticCategory.Message,"Loading_module_0_from_node_modules_folder_target_file_type_1_6098","Loading module '{0}' from 'node_modules' folder, target file type '{1}'."),Found_package_json_at_0:t(6099,e.DiagnosticCategory.Message,"Found_package_json_at_0_6099","Found 'package.json' at '{0}'."),package_json_does_not_have_a_0_field:t(6100,e.DiagnosticCategory.Message,"package_json_does_not_have_a_0_field_6100","'package.json' does not have a '{0}' field."),package_json_has_0_field_1_that_references_2:t(6101,e.DiagnosticCategory.Message,"package_json_has_0_field_1_that_references_2_6101","'package.json' has '{0}' field '{1}' that references '{2}'."),Allow_javascript_files_to_be_compiled:t(6102,e.DiagnosticCategory.Message,"Allow_javascript_files_to_be_compiled_6102","Allow javascript files to be compiled."),Option_0_should_have_array_of_strings_as_a_value:t(6103,e.DiagnosticCategory.Error,"Option_0_should_have_array_of_strings_as_a_value_6103","Option '{0}' should have array of strings as a value."),Checking_if_0_is_the_longest_matching_prefix_for_1_2:t(6104,e.DiagnosticCategory.Message,"Checking_if_0_is_the_longest_matching_prefix_for_1_2_6104","Checking if '{0}' is the longest matching prefix for '{1}' - '{2}'."),Expected_type_of_0_field_in_package_json_to_be_string_got_1:t(6105,e.DiagnosticCategory.Message,"Expected_type_of_0_field_in_package_json_to_be_string_got_1_6105","Expected type of '{0}' field in 'package.json' to be 'string', got '{1}'."),baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1:t(6106,e.DiagnosticCategory.Message,"baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1_6106","'baseUrl' option is set to '{0}', using this value to resolve non-relative module name '{1}'."),rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0:t(6107,e.DiagnosticCategory.Message,"rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0_6107","'rootDirs' option is set, using it to resolve relative module name '{0}'."),Longest_matching_prefix_for_0_is_1:t(6108,e.DiagnosticCategory.Message,"Longest_matching_prefix_for_0_is_1_6108","Longest matching prefix for '{0}' is '{1}'."),Loading_0_from_the_root_dir_1_candidate_location_2:t(6109,e.DiagnosticCategory.Message,"Loading_0_from_the_root_dir_1_candidate_location_2_6109","Loading '{0}' from the root dir '{1}', candidate location '{2}'."),Trying_other_entries_in_rootDirs:t(6110,e.DiagnosticCategory.Message,"Trying_other_entries_in_rootDirs_6110","Trying other entries in 'rootDirs'."),Module_resolution_using_rootDirs_has_failed:t(6111,e.DiagnosticCategory.Message,"Module_resolution_using_rootDirs_has_failed_6111","Module resolution using 'rootDirs' has failed."),Do_not_emit_use_strict_directives_in_module_output:t(6112,e.DiagnosticCategory.Message,"Do_not_emit_use_strict_directives_in_module_output_6112","Do not emit 'use strict' directives in module output."),Enable_strict_null_checks:t(6113,e.DiagnosticCategory.Message,"Enable_strict_null_checks_6113","Enable strict null checks."),Unknown_option_excludes_Did_you_mean_exclude:t(6114,e.DiagnosticCategory.Error,"Unknown_option_excludes_Did_you_mean_exclude_6114","Unknown option 'excludes'. Did you mean 'exclude'?"),Raise_error_on_this_expressions_with_an_implied_any_type:t(6115,e.DiagnosticCategory.Message,"Raise_error_on_this_expressions_with_an_implied_any_type_6115","Raise error on 'this' expressions with an implied 'any' type."),Resolving_type_reference_directive_0_containing_file_1_root_directory_2:t(6116,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_1_root_directory_2_6116","======== Resolving type reference directive '{0}', containing file '{1}', root directory '{2}'. ========"),Resolving_using_primary_search_paths:t(6117,e.DiagnosticCategory.Message,"Resolving_using_primary_search_paths_6117","Resolving using primary search paths..."),Resolving_from_node_modules_folder:t(6118,e.DiagnosticCategory.Message,"Resolving_from_node_modules_folder_6118","Resolving from node_modules folder..."),Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2:t(6119,e.DiagnosticCategory.Message,"Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2_6119","======== Type reference directive '{0}' was successfully resolved to '{1}', primary: {2}. ========"),Type_reference_directive_0_was_not_resolved:t(6120,e.DiagnosticCategory.Message,"Type_reference_directive_0_was_not_resolved_6120","======== Type reference directive '{0}' was not resolved. ========"),Resolving_with_primary_search_path_0:t(6121,e.DiagnosticCategory.Message,"Resolving_with_primary_search_path_0_6121","Resolving with primary search path '{0}'."),Root_directory_cannot_be_determined_skipping_primary_search_paths:t(6122,e.DiagnosticCategory.Message,"Root_directory_cannot_be_determined_skipping_primary_search_paths_6122","Root directory cannot be determined, skipping primary search paths."),Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set:t(6123,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set_6123","======== Resolving type reference directive '{0}', containing file '{1}', root directory not set. ========"),Type_declaration_files_to_be_included_in_compilation:t(6124,e.DiagnosticCategory.Message,"Type_declaration_files_to_be_included_in_compilation_6124","Type declaration files to be included in compilation."),Looking_up_in_node_modules_folder_initial_location_0:t(6125,e.DiagnosticCategory.Message,"Looking_up_in_node_modules_folder_initial_location_0_6125","Looking up in 'node_modules' folder, initial location '{0}'."),Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_modules_folder:t(6126,e.DiagnosticCategory.Message,"Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_mod_6126","Containing file is not specified and root directory cannot be determined, skipping lookup in 'node_modules' folder."),Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1:t(6127,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1_6127","======== Resolving type reference directive '{0}', containing file not set, root directory '{1}'. ========"),Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set:t(6128,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set_6128","======== Resolving type reference directive '{0}', containing file not set, root directory not set. ========"),Resolving_real_path_for_0_result_1:t(6130,e.DiagnosticCategory.Message,"Resolving_real_path_for_0_result_1_6130","Resolving real path for '{0}', result '{1}'."),Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system:t(6131,e.DiagnosticCategory.Error,"Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system_6131","Cannot compile modules using option '{0}' unless the '--module' flag is 'amd' or 'system'."),File_name_0_has_a_1_extension_stripping_it:t(6132,e.DiagnosticCategory.Message,"File_name_0_has_a_1_extension_stripping_it_6132","File name '{0}' has a '{1}' extension - stripping it."),_0_is_declared_but_its_value_is_never_read:t(6133,e.DiagnosticCategory.Error,"_0_is_declared_but_its_value_is_never_read_6133","'{0}' is declared but its value is never read."),Report_errors_on_unused_locals:t(6134,e.DiagnosticCategory.Message,"Report_errors_on_unused_locals_6134","Report errors on unused locals."),Report_errors_on_unused_parameters:t(6135,e.DiagnosticCategory.Message,"Report_errors_on_unused_parameters_6135","Report errors on unused parameters."),The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files:t(6136,e.DiagnosticCategory.Message,"The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files_6136","The maximum dependency depth to search under node_modules and load JavaScript files."),Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1:t(6137,e.DiagnosticCategory.Error,"Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1_6137","Cannot import type declaration files. Consider importing '{0}' instead of '{1}'."),Property_0_is_declared_but_its_value_is_never_read:t(6138,e.DiagnosticCategory.Error,"Property_0_is_declared_but_its_value_is_never_read_6138","Property '{0}' is declared but its value is never read."),Import_emit_helpers_from_tslib:t(6139,e.DiagnosticCategory.Message,"Import_emit_helpers_from_tslib_6139","Import emit helpers from 'tslib'."),Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using_cache_location_2:t(6140,e.DiagnosticCategory.Error,"Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using__6140","Auto discovery for typings is enabled in project '{0}'. Running extra resolution pass for module '{1}' using cache location '{2}'."),Parse_in_strict_mode_and_emit_use_strict_for_each_source_file:t(6141,e.DiagnosticCategory.Message,"Parse_in_strict_mode_and_emit_use_strict_for_each_source_file_6141",'Parse in strict mode and emit "use strict" for each source file.'),Module_0_was_resolved_to_1_but_jsx_is_not_set:t(6142,e.DiagnosticCategory.Error,"Module_0_was_resolved_to_1_but_jsx_is_not_set_6142","Module '{0}' was resolved to '{1}', but '--jsx' is not set."),Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1:t(6144,e.DiagnosticCategory.Message,"Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1_6144","Module '{0}' was resolved as locally declared ambient module in file '{1}'."),Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified:t(6145,e.DiagnosticCategory.Message,"Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified_6145","Module '{0}' was resolved as ambient module declared in '{1}' since this file was not modified."),Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h:t(6146,e.DiagnosticCategory.Message,"Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h_6146","Specify the JSX factory function to use when targeting 'react' JSX emit, e.g. 'React.createElement' or 'h'."),Resolution_for_module_0_was_found_in_cache:t(6147,e.DiagnosticCategory.Message,"Resolution_for_module_0_was_found_in_cache_6147","Resolution for module '{0}' was found in cache."),Directory_0_does_not_exist_skipping_all_lookups_in_it:t(6148,e.DiagnosticCategory.Message,"Directory_0_does_not_exist_skipping_all_lookups_in_it_6148","Directory '{0}' does not exist, skipping all lookups in it."),Show_diagnostic_information:t(6149,e.DiagnosticCategory.Message,"Show_diagnostic_information_6149","Show diagnostic information."),Show_verbose_diagnostic_information:t(6150,e.DiagnosticCategory.Message,"Show_verbose_diagnostic_information_6150","Show verbose diagnostic information."),Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file:t(6151,e.DiagnosticCategory.Message,"Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file_6151","Emit a single file with source maps instead of having a separate file."),Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap_to_be_set:t(6152,e.DiagnosticCategory.Message,"Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap__6152","Emit the source alongside the sourcemaps within a single file; requires '--inlineSourceMap' or '--sourceMap' to be set."),Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule:t(6153,e.DiagnosticCategory.Message,"Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule_6153","Transpile each file as a separate module (similar to 'ts.transpileModule')."),Print_names_of_generated_files_part_of_the_compilation:t(6154,e.DiagnosticCategory.Message,"Print_names_of_generated_files_part_of_the_compilation_6154","Print names of generated files part of the compilation."),Print_names_of_files_part_of_the_compilation:t(6155,e.DiagnosticCategory.Message,"Print_names_of_files_part_of_the_compilation_6155","Print names of files part of the compilation."),The_locale_used_when_displaying_messages_to_the_user_e_g_en_us:t(6156,e.DiagnosticCategory.Message,"The_locale_used_when_displaying_messages_to_the_user_e_g_en_us_6156","The locale used when displaying messages to the user (e.g. 'en-us')"),Do_not_generate_custom_helper_functions_like_extends_in_compiled_output:t(6157,e.DiagnosticCategory.Message,"Do_not_generate_custom_helper_functions_like_extends_in_compiled_output_6157","Do not generate custom helper functions like '__extends' in compiled output."),Do_not_include_the_default_library_file_lib_d_ts:t(6158,e.DiagnosticCategory.Message,"Do_not_include_the_default_library_file_lib_d_ts_6158","Do not include the default library file (lib.d.ts)."),Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files:t(6159,e.DiagnosticCategory.Message,"Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files_6159","Do not add triple-slash references or imported modules to the list of compiled files."),Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files:t(6160,e.DiagnosticCategory.Message,"Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files_6160","[Deprecated] Use '--skipLibCheck' instead. Skip type checking of default library declaration files."),List_of_folders_to_include_type_definitions_from:t(6161,e.DiagnosticCategory.Message,"List_of_folders_to_include_type_definitions_from_6161","List of folders to include type definitions from."),Disable_size_limitations_on_JavaScript_projects:t(6162,e.DiagnosticCategory.Message,"Disable_size_limitations_on_JavaScript_projects_6162","Disable size limitations on JavaScript projects."),The_character_set_of_the_input_files:t(6163,e.DiagnosticCategory.Message,"The_character_set_of_the_input_files_6163","The character set of the input files."),Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files:t(6164,e.DiagnosticCategory.Message,"Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files_6164","Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files."),Do_not_truncate_error_messages:t(6165,e.DiagnosticCategory.Message,"Do_not_truncate_error_messages_6165","Do not truncate error messages."),Output_directory_for_generated_declaration_files:t(6166,e.DiagnosticCategory.Message,"Output_directory_for_generated_declaration_files_6166","Output directory for generated declaration files."),A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl:t(6167,e.DiagnosticCategory.Message,"A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl_6167","A series of entries which re-map imports to lookup locations relative to the 'baseUrl'."),List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime:t(6168,e.DiagnosticCategory.Message,"List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime_6168","List of root folders whose combined content represents the structure of the project at runtime."),Show_all_compiler_options:t(6169,e.DiagnosticCategory.Message,"Show_all_compiler_options_6169","Show all compiler options."),Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file:t(6170,e.DiagnosticCategory.Message,"Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file_6170","[Deprecated] Use '--outFile' instead. Concatenate and emit output to single file"),Command_line_Options:t(6171,e.DiagnosticCategory.Message,"Command_line_Options_6171","Command-line Options"),Basic_Options:t(6172,e.DiagnosticCategory.Message,"Basic_Options_6172","Basic Options"),Strict_Type_Checking_Options:t(6173,e.DiagnosticCategory.Message,"Strict_Type_Checking_Options_6173","Strict Type-Checking Options"),Module_Resolution_Options:t(6174,e.DiagnosticCategory.Message,"Module_Resolution_Options_6174","Module Resolution Options"),Source_Map_Options:t(6175,e.DiagnosticCategory.Message,"Source_Map_Options_6175","Source Map Options"),Additional_Checks:t(6176,e.DiagnosticCategory.Message,"Additional_Checks_6176","Additional Checks"),Experimental_Options:t(6177,e.DiagnosticCategory.Message,"Experimental_Options_6177","Experimental Options"),Advanced_Options:t(6178,e.DiagnosticCategory.Message,"Advanced_Options_6178","Advanced Options"),Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3:t(6179,e.DiagnosticCategory.Message,"Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3_6179","Provide full support for iterables in 'for-of', spread, and destructuring when targeting 'ES5' or 'ES3'."),Enable_all_strict_type_checking_options:t(6180,e.DiagnosticCategory.Message,"Enable_all_strict_type_checking_options_6180","Enable all strict type-checking options."),List_of_language_service_plugins:t(6181,e.DiagnosticCategory.Message,"List_of_language_service_plugins_6181","List of language service plugins."),Scoped_package_detected_looking_in_0:t(6182,e.DiagnosticCategory.Message,"Scoped_package_detected_looking_in_0_6182","Scoped package detected, looking in '{0}'"),Reusing_resolution_of_module_0_to_file_1_from_old_program:t(6183,e.DiagnosticCategory.Message,"Reusing_resolution_of_module_0_to_file_1_from_old_program_6183","Reusing resolution of module '{0}' to file '{1}' from old program."),Reusing_module_resolutions_originating_in_0_since_resolutions_are_unchanged_from_old_program:t(6184,e.DiagnosticCategory.Message,"Reusing_module_resolutions_originating_in_0_since_resolutions_are_unchanged_from_old_program_6184","Reusing module resolutions originating in '{0}' since resolutions are unchanged from old program."),Disable_strict_checking_of_generic_signatures_in_function_types:t(6185,e.DiagnosticCategory.Message,"Disable_strict_checking_of_generic_signatures_in_function_types_6185","Disable strict checking of generic signatures in function types."),Enable_strict_checking_of_function_types:t(6186,e.DiagnosticCategory.Message,"Enable_strict_checking_of_function_types_6186","Enable strict checking of function types."),Variable_0_implicitly_has_an_1_type:t(7005,e.DiagnosticCategory.Error,"Variable_0_implicitly_has_an_1_type_7005","Variable '{0}' implicitly has an '{1}' type."),Parameter_0_implicitly_has_an_1_type:t(7006,e.DiagnosticCategory.Error,"Parameter_0_implicitly_has_an_1_type_7006","Parameter '{0}' implicitly has an '{1}' type."),Member_0_implicitly_has_an_1_type:t(7008,e.DiagnosticCategory.Error,"Member_0_implicitly_has_an_1_type_7008","Member '{0}' implicitly has an '{1}' type."),new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type:t(7009,e.DiagnosticCategory.Error,"new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type_7009","'new' expression, whose target lacks a construct signature, implicitly has an 'any' type."),_0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type:t(7010,e.DiagnosticCategory.Error,"_0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type_7010","'{0}', which lacks return-type annotation, implicitly has an '{1}' return type."),Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type:t(7011,e.DiagnosticCategory.Error,"Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type_7011","Function expression, which lacks return-type annotation, implicitly has an '{0}' return type."),Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type:t(7013,e.DiagnosticCategory.Error,"Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type_7013","Construct signature, which lacks return-type annotation, implicitly has an 'any' return type."),Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number:t(7015,e.DiagnosticCategory.Error,"Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number_7015","Element implicitly has an 'any' type because index expression is not of type 'number'."),Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type:t(7016,e.DiagnosticCategory.Error,"Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type_7016","Could not find a declaration file for module '{0}'. '{1}' implicitly has an 'any' type."),Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature:t(7017,e.DiagnosticCategory.Error,"Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature_7017","Element implicitly has an 'any' type because type '{0}' has no index signature."),Object_literal_s_property_0_implicitly_has_an_1_type:t(7018,e.DiagnosticCategory.Error,"Object_literal_s_property_0_implicitly_has_an_1_type_7018","Object literal's property '{0}' implicitly has an '{1}' type."),Rest_parameter_0_implicitly_has_an_any_type:t(7019,e.DiagnosticCategory.Error,"Rest_parameter_0_implicitly_has_an_any_type_7019","Rest parameter '{0}' implicitly has an 'any[]' type."),Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type:t(7020,e.DiagnosticCategory.Error,"Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type_7020","Call signature, which lacks return-type annotation, implicitly has an 'any' return type."),_0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or_indirectly_in_its_own_initializer:t(7022,e.DiagnosticCategory.Error,"_0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or__7022","'{0}' implicitly has type 'any' because it does not have a type annotation and is referenced directly or indirectly in its own initializer."),_0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions:t(7023,e.DiagnosticCategory.Error,"_0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_reference_7023","'{0}' implicitly has return type 'any' because it does not have a return type annotation and is referenced directly or indirectly in one of its return expressions."),Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions:t(7024,e.DiagnosticCategory.Error,"Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_ref_7024","Function implicitly has return type 'any' because it does not have a return type annotation and is referenced directly or indirectly in one of its return expressions."),Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_type:t(7025,e.DiagnosticCategory.Error,"Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_typ_7025","Generator implicitly has type '{0}' because it does not yield any values. Consider supplying a return type."),JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists:t(7026,e.DiagnosticCategory.Error,"JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists_7026","JSX element implicitly has type 'any' because no interface 'JSX.{0}' exists."),Unreachable_code_detected:t(7027,e.DiagnosticCategory.Error,"Unreachable_code_detected_7027","Unreachable code detected."),Unused_label:t(7028,e.DiagnosticCategory.Error,"Unused_label_7028","Unused label."),Fallthrough_case_in_switch:t(7029,e.DiagnosticCategory.Error,"Fallthrough_case_in_switch_7029","Fallthrough case in switch."),Not_all_code_paths_return_a_value:t(7030,e.DiagnosticCategory.Error,"Not_all_code_paths_return_a_value_7030","Not all code paths return a value."),Binding_element_0_implicitly_has_an_1_type:t(7031,e.DiagnosticCategory.Error,"Binding_element_0_implicitly_has_an_1_type_7031","Binding element '{0}' implicitly has an '{1}' type."),Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation:t(7032,e.DiagnosticCategory.Error,"Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation_7032","Property '{0}' implicitly has type 'any', because its set accessor lacks a parameter type annotation."),Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation:t(7033,e.DiagnosticCategory.Error,"Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation_7033","Property '{0}' implicitly has type 'any', because its get accessor lacks a return type annotation."),Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined:t(7034,e.DiagnosticCategory.Error,"Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined_7034","Variable '{0}' implicitly has type '{1}' in some locations where its type cannot be determined."),Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_module_0:t(7035,e.DiagnosticCategory.Error,"Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_mod_7035","Try `npm install @types/{0}` if it exists or add a new declaration (.d.ts) file containing `declare module '{0}';`"),Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0:t(7036,e.DiagnosticCategory.Error,"Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0_7036","Dynamic import's specifier must be of type 'string', but here has type '{0}'."),You_cannot_rename_this_element:t(8e3,e.DiagnosticCategory.Error,"You_cannot_rename_this_element_8000","You cannot rename this element."),You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library:t(8001,e.DiagnosticCategory.Error,"You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library_8001","You cannot rename elements that are defined in the standard TypeScript library."),import_can_only_be_used_in_a_ts_file:t(8002,e.DiagnosticCategory.Error,"import_can_only_be_used_in_a_ts_file_8002","'import ... =' can only be used in a .ts file."),export_can_only_be_used_in_a_ts_file:t(8003,e.DiagnosticCategory.Error,"export_can_only_be_used_in_a_ts_file_8003","'export=' can only be used in a .ts file."),type_parameter_declarations_can_only_be_used_in_a_ts_file:t(8004,e.DiagnosticCategory.Error,"type_parameter_declarations_can_only_be_used_in_a_ts_file_8004","'type parameter declarations' can only be used in a .ts file."),implements_clauses_can_only_be_used_in_a_ts_file:t(8005,e.DiagnosticCategory.Error,"implements_clauses_can_only_be_used_in_a_ts_file_8005","'implements clauses' can only be used in a .ts file."),interface_declarations_can_only_be_used_in_a_ts_file:t(8006,e.DiagnosticCategory.Error,"interface_declarations_can_only_be_used_in_a_ts_file_8006","'interface declarations' can only be used in a .ts file."),module_declarations_can_only_be_used_in_a_ts_file:t(8007,e.DiagnosticCategory.Error,"module_declarations_can_only_be_used_in_a_ts_file_8007","'module declarations' can only be used in a .ts file."),type_aliases_can_only_be_used_in_a_ts_file:t(8008,e.DiagnosticCategory.Error,"type_aliases_can_only_be_used_in_a_ts_file_8008","'type aliases' can only be used in a .ts file."),_0_can_only_be_used_in_a_ts_file:t(8009,e.DiagnosticCategory.Error,"_0_can_only_be_used_in_a_ts_file_8009","'{0}' can only be used in a .ts file."),types_can_only_be_used_in_a_ts_file:t(8010,e.DiagnosticCategory.Error,"types_can_only_be_used_in_a_ts_file_8010","'types' can only be used in a .ts file."),type_arguments_can_only_be_used_in_a_ts_file:t(8011,e.DiagnosticCategory.Error,"type_arguments_can_only_be_used_in_a_ts_file_8011","'type arguments' can only be used in a .ts file."),parameter_modifiers_can_only_be_used_in_a_ts_file:t(8012,e.DiagnosticCategory.Error,"parameter_modifiers_can_only_be_used_in_a_ts_file_8012","'parameter modifiers' can only be used in a .ts file."),non_null_assertions_can_only_be_used_in_a_ts_file:t(8013,e.DiagnosticCategory.Error,"non_null_assertions_can_only_be_used_in_a_ts_file_8013","'non-null assertions' can only be used in a .ts file."),enum_declarations_can_only_be_used_in_a_ts_file:t(8015,e.DiagnosticCategory.Error,"enum_declarations_can_only_be_used_in_a_ts_file_8015","'enum declarations' can only be used in a .ts file."),type_assertion_expressions_can_only_be_used_in_a_ts_file:t(8016,e.DiagnosticCategory.Error,"type_assertion_expressions_can_only_be_used_in_a_ts_file_8016","'type assertion expressions' can only be used in a .ts file."),Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0:t(8017,e.DiagnosticCategory.Error,"Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0_8017","Octal literal types must use ES2015 syntax. Use the syntax '{0}'."),Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0:t(8018,e.DiagnosticCategory.Error,"Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0_8018","Octal literals are not allowed in enums members initializer. Use the syntax '{0}'."),Report_errors_in_js_files:t(8019,e.DiagnosticCategory.Message,"Report_errors_in_js_files_8019","Report errors in .js files."),JSDoc_types_can_only_be_used_inside_documentation_comments:t(8020,e.DiagnosticCategory.Error,"JSDoc_types_can_only_be_used_inside_documentation_comments_8020","JSDoc types can only be used inside documentation comments."),JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags:t(8021,e.DiagnosticCategory.Error,"JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags_8021","JSDoc '@typedef' tag should either have a type annotation or be followed by '@property' or '@member' tags."),JSDoc_0_is_not_attached_to_a_class:t(8022,e.DiagnosticCategory.Error,"JSDoc_0_is_not_attached_to_a_class_8022","JSDoc '@{0}' is not attached to a class."),JSDoc_0_1_does_not_match_the_extends_2_clause:t(8023,e.DiagnosticCategory.Error,"JSDoc_0_1_does_not_match_the_extends_2_clause_8023","JSDoc '@{0} {1}' does not match the 'extends {2}' clause."),JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name:t(8024,e.DiagnosticCategory.Error,"JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name_8024","JSDoc '@param' tag has name '{0}', but there is no parameter with that name."),Class_declarations_cannot_have_more_than_one_augments_or_extends_tag:t(8025,e.DiagnosticCategory.Error,"Class_declarations_cannot_have_more_than_one_augments_or_extends_tag_8025","Class declarations cannot have more than one `@augments` or `@extends` tag."),Only_identifiers_Slashqualified_names_with_optional_type_arguments_are_currently_supported_in_a_class_extends_clause:t(9002,e.DiagnosticCategory.Error,"Only_identifiers_Slashqualified_names_with_optional_type_arguments_are_currently_supported_in_a_clas_9002","Only identifiers/qualified-names with optional type arguments are currently supported in a class 'extends' clause."),class_expressions_are_not_currently_supported:t(9003,e.DiagnosticCategory.Error,"class_expressions_are_not_currently_supported_9003","'class' expressions are not currently supported."),Language_service_is_disabled:t(9004,e.DiagnosticCategory.Error,"Language_service_is_disabled_9004","Language service is disabled."),JSX_attributes_must_only_be_assigned_a_non_empty_expression:t(17e3,e.DiagnosticCategory.Error,"JSX_attributes_must_only_be_assigned_a_non_empty_expression_17000","JSX attributes must only be assigned a non-empty 'expression'."),JSX_elements_cannot_have_multiple_attributes_with_the_same_name:t(17001,e.DiagnosticCategory.Error,"JSX_elements_cannot_have_multiple_attributes_with_the_same_name_17001","JSX elements cannot have multiple attributes with the same name."),Expected_corresponding_JSX_closing_tag_for_0:t(17002,e.DiagnosticCategory.Error,"Expected_corresponding_JSX_closing_tag_for_0_17002","Expected corresponding JSX closing tag for '{0}'."),JSX_attribute_expected:t(17003,e.DiagnosticCategory.Error,"JSX_attribute_expected_17003","JSX attribute expected."),Cannot_use_JSX_unless_the_jsx_flag_is_provided:t(17004,e.DiagnosticCategory.Error,"Cannot_use_JSX_unless_the_jsx_flag_is_provided_17004","Cannot use JSX unless the '--jsx' flag is provided."),A_constructor_cannot_contain_a_super_call_when_its_class_extends_null:t(17005,e.DiagnosticCategory.Error,"A_constructor_cannot_contain_a_super_call_when_its_class_extends_null_17005","A constructor cannot contain a 'super' call when its class extends 'null'."),An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses:t(17006,e.DiagnosticCategory.Error,"An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_ex_17006","An unary expression with the '{0}' operator is not allowed in the left-hand side of an exponentiation expression. Consider enclosing the expression in parentheses."),A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses:t(17007,e.DiagnosticCategory.Error,"A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Con_17007","A type assertion expression is not allowed in the left-hand side of an exponentiation expression. Consider enclosing the expression in parentheses."),JSX_element_0_has_no_corresponding_closing_tag:t(17008,e.DiagnosticCategory.Error,"JSX_element_0_has_no_corresponding_closing_tag_17008","JSX element '{0}' has no corresponding closing tag."),super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class:t(17009,e.DiagnosticCategory.Error,"super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class_17009","'super' must be called before accessing 'this' in the constructor of a derived class."),Unknown_type_acquisition_option_0:t(17010,e.DiagnosticCategory.Error,"Unknown_type_acquisition_option_0_17010","Unknown type acquisition option '{0}'."),super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class:t(17011,e.DiagnosticCategory.Error,"super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class_17011","'super' must be called before accessing a property of 'super' in the constructor of a derived class."),_0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2:t(17012,e.DiagnosticCategory.Error,"_0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2_17012","'{0}' is not a valid meta-property for keyword '{1}'. Did you mean '{2}'?"),Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constructor:t(17013,e.DiagnosticCategory.Error,"Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constru_17013","Meta-property '{0}' is only allowed in the body of a function declaration, function expression, or constructor."),Circularity_detected_while_resolving_configuration_Colon_0:t(18e3,e.DiagnosticCategory.Error,"Circularity_detected_while_resolving_configuration_Colon_0_18000","Circularity detected while resolving configuration: {0}"),A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not:t(18001,e.DiagnosticCategory.Error,"A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not_18001","A path in an 'extends' option must be relative or rooted, but '{0}' is not."),The_files_list_in_config_file_0_is_empty:t(18002,e.DiagnosticCategory.Error,"The_files_list_in_config_file_0_is_empty_18002","The 'files' list in config file '{0}' is empty."),No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2:t(18003,e.DiagnosticCategory.Error,"No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2_18003","No inputs were found in config file '{0}'. Specified 'include' paths were '{1}' and 'exclude' paths were '{2}'."),Add_missing_super_call:t(90001,e.DiagnosticCategory.Message,"Add_missing_super_call_90001","Add missing 'super()' call."),Make_super_call_the_first_statement_in_the_constructor:t(90002,e.DiagnosticCategory.Message,"Make_super_call_the_first_statement_in_the_constructor_90002","Make 'super()' call the first statement in the constructor."),Change_extends_to_implements:t(90003,e.DiagnosticCategory.Message,"Change_extends_to_implements_90003","Change 'extends' to 'implements'."),Remove_declaration_for_Colon_0:t(90004,e.DiagnosticCategory.Message,"Remove_declaration_for_Colon_0_90004","Remove declaration for: '{0}'."),Implement_interface_0:t(90006,e.DiagnosticCategory.Message,"Implement_interface_0_90006","Implement interface '{0}'."),Implement_inherited_abstract_class:t(90007,e.DiagnosticCategory.Message,"Implement_inherited_abstract_class_90007","Implement inherited abstract class."),Add_this_to_unresolved_variable:t(90008,e.DiagnosticCategory.Message,"Add_this_to_unresolved_variable_90008","Add 'this.' to unresolved variable."),Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript_files_Learn_more_at_https_Colon_Slash_Slashaka_ms_Slashtsconfig:t(90009,e.DiagnosticCategory.Error,"Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript__90009","Adding a tsconfig.json file will help organize projects that contain both TypeScript and JavaScript files. Learn more at https://aka.ms/tsconfig."),Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated:t(90010,e.DiagnosticCategory.Error,"Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated_90010","Type '{0}' is not assignable to type '{1}'. Two different types with this name exist, but they are unrelated."),Import_0_from_1:t(90013,e.DiagnosticCategory.Message,"Import_0_from_1_90013","Import '{0}' from \"{1}\"."),Change_0_to_1:t(90014,e.DiagnosticCategory.Message,"Change_0_to_1_90014","Change '{0}' to '{1}'."),Add_0_to_existing_import_declaration_from_1:t(90015,e.DiagnosticCategory.Message,"Add_0_to_existing_import_declaration_from_1_90015","Add '{0}' to existing import declaration from \"{1}\"."),Declare_property_0:t(90016,e.DiagnosticCategory.Message,"Declare_property_0_90016","Declare property '{0}'."),Add_index_signature_for_property_0:t(90017,e.DiagnosticCategory.Message,"Add_index_signature_for_property_0_90017","Add index signature for property '{0}'."),Disable_checking_for_this_file:t(90018,e.DiagnosticCategory.Message,"Disable_checking_for_this_file_90018","Disable checking for this file."),Ignore_this_error_message:t(90019,e.DiagnosticCategory.Message,"Ignore_this_error_message_90019","Ignore this error message."),Initialize_property_0_in_the_constructor:t(90020,e.DiagnosticCategory.Message,"Initialize_property_0_in_the_constructor_90020","Initialize property '{0}' in the constructor."),Initialize_static_property_0:t(90021,e.DiagnosticCategory.Message,"Initialize_static_property_0_90021","Initialize static property '{0}'."),Change_spelling_to_0:t(90022,e.DiagnosticCategory.Message,"Change_spelling_to_0_90022","Change spelling to '{0}'."),Declare_method_0:t(90023,e.DiagnosticCategory.Message,"Declare_method_0_90023","Declare method '{0}'."),Declare_static_method_0:t(90024,e.DiagnosticCategory.Message,"Declare_static_method_0_90024","Declare static method '{0}'."),Prefix_0_with_an_underscore:t(90025,e.DiagnosticCategory.Message,"Prefix_0_with_an_underscore_90025","Prefix '{0}' with an underscore."),Rewrite_as_the_indexed_access_type_0:t(90026,e.DiagnosticCategory.Message,"Rewrite_as_the_indexed_access_type_0_90026","Rewrite as the indexed access type '{0}'."),Declare_static_property_0:t(90027,e.DiagnosticCategory.Message,"Declare_static_property_0_90027","Declare static property '{0}'."),Call_decorator_expression:t(90028,e.DiagnosticCategory.Message,"Call_decorator_expression_90028","Call decorator expression."),Convert_function_to_an_ES2015_class:t(95001,e.DiagnosticCategory.Message,"Convert_function_to_an_ES2015_class_95001","Convert function to an ES2015 class"),Convert_function_0_to_class:t(95002,e.DiagnosticCategory.Message,"Convert_function_0_to_class_95002","Convert function '{0}' to class"),Extract_symbol:t(95003,e.DiagnosticCategory.Message,"Extract_symbol_95003","Extract symbol"),Extract_to_0_in_1:t(95004,e.DiagnosticCategory.Message,"Extract_to_0_in_1_95004","Extract to {0} in {1}"),Extract_function:t(95005,e.DiagnosticCategory.Message,"Extract_function_95005","Extract function"),Extract_constant:t(95006,e.DiagnosticCategory.Message,"Extract_constant_95006","Extract constant"),Extract_to_0_in_enclosing_scope:t(95007,e.DiagnosticCategory.Message,"Extract_to_0_in_enclosing_scope_95007","Extract to {0} in enclosing scope"),Extract_to_0_in_1_scope:t(95008,e.DiagnosticCategory.Message,"Extract_to_0_in_1_scope_95008","Extract to {0} in {1} scope"),Annotate_with_type_from_JSDoc:t(95009,e.DiagnosticCategory.Message,"Annotate_with_type_from_JSDoc_95009","Annotate with type from JSDoc"),Annotate_with_types_from_JSDoc:t(95010,e.DiagnosticCategory.Message,"Annotate_with_types_from_JSDoc_95010","Annotate with types from JSDoc"),Infer_type_of_0_from_usage:t(95011,e.DiagnosticCategory.Message,"Infer_type_of_0_from_usage_95011","Infer type of '{0}' from usage."),Infer_parameter_types_from_usage:t(95012,e.DiagnosticCategory.Message,"Infer_parameter_types_from_usage_95012","Infer parameter types from usage.")}}(ts||(ts={})),function(e){function t(e){return e>=71}e.tokenIsIdentifierOrKeyword=t;var n=e.createMapFromTemplate({abstract:117,any:119,as:118,boolean:122,break:72,case:73,catch:74,class:75,continue:77,const:76,constructor:123,debugger:78,declare:124,default:79,delete:80,do:81,else:82,enum:83,export:84,extends:85,false:86,finally:87,for:88,from:140,function:89,get:125,if:90,implements:108,import:91,in:92,instanceof:93,interface:109,is:126,keyof:127,let:110,module:128,namespace:129,never:130,new:94,null:95,number:133,object:134,package:111,private:112,protected:113,public:114,readonly:131,require:132,global:141,return:96,set:135,static:115,string:136,super:97,switch:98,symbol:137,this:99,throw:100,true:101,try:102,type:138,typeof:103,undefined:139,var:104,void:105,while:106,with:107,yield:116,async:120,await:121,of:142,"{":17,"}":18,"(":19,")":20,"[":21,"]":22,".":23,"...":24,";":25,",":26,"<":27,">":29,"<=":30,">=":31,"==":32,"!=":33,"===":34,"!==":35,"=>":36,"+":37,"-":38,"**":40,"*":39,"/":41,"%":42,"++":43,"--":44,"<<":45,"</":28,">>":46,">>>":47,"&":48,"|":49,"^":50,"!":51,"~":52,"&&":53,"||":54,"?":55,":":56,"=":58,"+=":59,"-=":60,"*=":61,"**=":62,"/=":63,"%=":64,"<<=":65,">>=":66,">>>=":67,"&=":68,"|=":69,"^=":70,"@":57}),r=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1569,1594,1600,1610,1649,1747,1749,1749,1765,1766,1786,1788,1808,1808,1810,1836,1920,1957,2309,2361,2365,2365,2384,2384,2392,2401,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2784,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2877,2877,2908,2909,2911,2913,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3294,3294,3296,3297,3333,3340,3342,3344,3346,3368,3370,3385,3424,3425,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3946,3976,3979,4096,4129,4131,4135,4137,4138,4176,4181,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6067,6176,6263,6272,6312,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8319,8319,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12329,12337,12341,12344,12346,12353,12436,12445,12446,12449,12538,12540,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65138,65140,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],i=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,768,846,864,866,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1155,1158,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1425,1441,1443,1465,1467,1469,1471,1471,1473,1474,1476,1476,1488,1514,1520,1522,1569,1594,1600,1621,1632,1641,1648,1747,1749,1756,1759,1768,1770,1773,1776,1788,1808,1836,1840,1866,1920,1968,2305,2307,2309,2361,2364,2381,2384,2388,2392,2403,2406,2415,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2492,2494,2500,2503,2504,2507,2509,2519,2519,2524,2525,2527,2531,2534,2545,2562,2562,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2649,2652,2654,2654,2662,2676,2689,2691,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2784,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2876,2883,2887,2888,2891,2893,2902,2903,2908,2909,2911,2913,2918,2927,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3006,3010,3014,3016,3018,3021,3031,3031,3047,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3134,3140,3142,3144,3146,3149,3157,3158,3168,3169,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3262,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3297,3302,3311,3330,3331,3333,3340,3342,3344,3346,3368,3370,3385,3390,3395,3398,3400,3402,3405,3415,3415,3424,3425,3430,3439,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3805,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3946,3953,3972,3974,3979,3984,3991,3993,4028,4038,4038,4096,4129,4131,4135,4137,4138,4140,4146,4150,4153,4160,4169,4176,4185,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,4969,4977,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6099,6112,6121,6160,6169,6176,6263,6272,6313,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8255,8256,8319,8319,8400,8412,8417,8417,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12335,12337,12341,12344,12346,12353,12436,12441,12442,12445,12446,12449,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65056,65059,65075,65076,65101,65103,65136,65138,65140,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65381,65470,65474,65479,65482,65487,65490,65495,65498,65500],s=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],o=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500];function a(e,t){if(e<t[0])return!1;for(var n,r=0,i=t.length;r+1<i;){if(n=r+(i-r)/2,t[n-=n%2]<=e&&e<=t[n+1])return!0;e<t[n]?i=n:r=n+2}return!1}function l(e,t){return a(e,t>=1?s:r)}e.isUnicodeIdentifierStart=l;var c,u=(c=[],n.forEach((function(e,t){c[e]=t})),c);function d(e){for(var t=new Array,n=0,r=0;n<e.length;){var i=e.charCodeAt(n);switch(n++,i){case 13:10===e.charCodeAt(n)&&n++;case 10:t.push(r),r=n;break;default:i>127&&g(i)&&(t.push(r),r=n)}}return t.push(r),t}function p(t,n,r,i){e.Debug.assert(n>=0&&n<t.length);var s=t[n]+r;return n<t.length-1?e.Debug.assert(s<t[n+1]):void 0!==i&&e.Debug.assert(s<=i.length),s}function h(e){return e.lineMap||(e.lineMap=d(e.text))}function f(t,n){var r=e.binarySearch(t,n);return r<0&&(r=~r-1,e.Debug.assert(-1!==r,"position cannot precede the beginning of the file")),{line:r,character:n-t[r]}}function m(e){return _(e)||g(e)}function _(e){return 32===e||9===e||11===e||12===e||160===e||133===e||5760===e||e>=8192&&e<=8203||8239===e||8287===e||12288===e||65279===e}function g(e){return 10===e||13===e||8232===e||8233===e}function y(e){return e>=48&&e<=57}function b(e){return e>=48&&e<=55}e.tokenToString=function(e){return u[e]},e.stringToToken=function(e){return n.get(e)},e.computeLineStarts=d,e.getPositionOfLineAndCharacter=function(e,t,n){return p(h(e),t,n,e.text)},e.computePositionOfLineAndCharacter=p,e.getLineStarts=h,e.computeLineAndCharacterOfPosition=f,e.getLineAndCharacterOfPosition=function(e,t){return f(h(e),t)},e.isWhiteSpaceLike=m,e.isWhiteSpaceSingleLine=_,e.isLineBreak=g,e.isOctalDigit=b,e.couldStartTrivia=function(e,t){var n=e.charCodeAt(t);switch(n){case 13:case 10:case 9:case 11:case 12:case 32:case 47:case 60:case 124:case 61:case 62:return!0;case 35:return 0===t;default:return n>127}},e.skipTrivia=function(t,n,r,i){if(void 0===i&&(i=!1),e.positionIsSynthesized(n))return n;for(;;){var s=t.charCodeAt(n);switch(s){case 13:10===t.charCodeAt(n+1)&&n++;case 10:if(n++,r)return n;continue;case 9:case 11:case 12:case 32:n++;continue;case 47:if(i)break;if(47===t.charCodeAt(n+1)){for(n+=2;n<t.length&&!g(t.charCodeAt(n));)n++;continue}if(42===t.charCodeAt(n+1)){for(n+=2;n<t.length;){if(42===t.charCodeAt(n)&&47===t.charCodeAt(n+1)){n+=2;break}n++}continue}break;case 60:case 124:case 61:case 62:if(T(t,n)){n=k(t,n);continue}break;case 35:if(0===n&&x(t,n)){n=S(t,n);continue}break;default:if(s>127&&m(s)){n++;continue}}return n}};var v="<<<<<<<".length;function T(t,n){if(e.Debug.assert(n>=0),0===n||g(t.charCodeAt(n-1))){var r=t.charCodeAt(n);if(n+v<t.length){for(var i=0;i<v;i++)if(t.charCodeAt(n+i)!==r)return!1;return 61===r||32===t.charCodeAt(n+v)}}return!1}function k(t,n,r){r&&r(e.Diagnostics.Merge_conflict_marker_encountered,v);var i=t.charCodeAt(n),s=t.length;if(60===i||62===i)for(;n<s&&!g(t.charCodeAt(n));)n++;else for(e.Debug.assert(124===i||61===i);n<s;){var o=t.charCodeAt(n);if((61===o||62===o)&&o!==i&&T(t,n))break;n++}return n}var E=/^#!.*/;function x(t,n){return e.Debug.assert(0===n),E.test(t)}function S(e,t){return t+=E.exec(e)[0].length}function C(e,t,n,r,i,s,o){var a,l,c,u,d=!1,p=r||0===n,h=o;e:for(;n>=0&&n<t.length;){var f=t.charCodeAt(n);switch(f){case 13:10===t.charCodeAt(n+1)&&n++;case 10:if(n++,r)break e;p=!0,d&&(u=!0);continue;case 9:case 11:case 12:case 32:n++;continue;case 47:var _=t.charCodeAt(n+1),y=!1;if(47===_||42===_){var b=47===_?2:3,v=n;if(n+=2,47===_)for(;n<t.length;){if(g(t.charCodeAt(n))){y=!0;break}n++}else for(;n<t.length;){if(42===t.charCodeAt(n)&&47===t.charCodeAt(n+1)){n+=2;break}n++}if(p){if(d){if(h=i(a,l,c,u,s,h),!e&&h)return h;d=!1}a=v,l=n,c=b,u=y,d=!0}continue}break e;default:if(f>127&&m(f)){d&&g(f)&&(u=!0),n++;continue}break e}}return d&&(h=i(a,l,c,u,s,h)),h}function I(e,t,n,r,i){return C(!0,e,t,!1,n,r,i)}function A(e,t,n,r,i){return C(!0,e,t,!0,n,r,i)}function w(e,t,n,r,i,s){return s||(s=[]),s.push({kind:n,pos:e,end:t,hasTrailingNewLine:r}),s}function N(e,t){return e>=65&&e<=90||e>=97&&e<=122||36===e||95===e||e>127&&l(e,t)}function D(e,t){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||36===e||95===e||e>127&&function(e,t){return a(e,t>=1?o:i)}(e,t)}e.forEachLeadingCommentRange=function(e,t,n,r){return C(!1,e,t,!1,n,r)},e.forEachTrailingCommentRange=function(e,t,n,r){return C(!1,e,t,!0,n,r)},e.reduceEachLeadingCommentRange=I,e.reduceEachTrailingCommentRange=A,e.getLeadingCommentRanges=function(e,t){return I(e,t,w,void 0,void 0)},e.getTrailingCommentRanges=function(e,t){return A(e,t,w,void 0,void 0)},e.getShebang=function(e){var t=E.exec(e);if(t)return t[0]},e.isIdentifierStart=N,e.isIdentifierPart=D,e.isIdentifierText=function(e,t){if(!N(e.charCodeAt(0),t))return!1;for(var n=1;n<e.length;n++)if(!D(e.charCodeAt(n),t))return!1;return!0},e.createScanner=function(r,i,s,o,a,l,c){var u,d,p,h,f,v,E,C,I,A;return void 0===s&&(s=0),q(o,l,c),{getStartPos:function(){return p},getTextPos:function(){return u},getToken:function(){return f},getTokenPos:function(){return h},getTokenText:function(){return o.substring(h,u)},getTokenValue:function(){return v},hasExtendedUnicodeEscape:function(){return C},hasPrecedingLineBreak:function(){return E},isIdentifier:function(){return 71===f||f>107},isReservedWord:function(){return f>=72&&f<=107},isUnterminated:function(){return I},getNumericLiteralFlags:function(){return A},reScanGreaterToken:function(){if(29===f){if(62===o.charCodeAt(u))return 62===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=67):(u+=2,f=47):61===o.charCodeAt(u+1)?(u+=2,f=66):(u++,f=46);if(61===o.charCodeAt(u))return u++,f=31}return f},reScanSlashToken:function(){if(41===f||63===f){for(var t=h+1,n=!1,i=!1;;){if(t>=d){I=!0,w(e.Diagnostics.Unterminated_regular_expression_literal);break}var s=o.charCodeAt(t);if(g(s)){I=!0,w(e.Diagnostics.Unterminated_regular_expression_literal);break}if(n)n=!1;else{if(47===s&&!i){t++;break}91===s?i=!0:92===s?n=!0:93===s&&(i=!1)}t++}for(;t<d&&D(o.charCodeAt(t),r);)t++;u=t,v=o.substring(h,u),f=12}return f},reScanTemplateToken:function(){return e.Debug.assert(18===f,"'reScanTemplateToken' should only be called on a '}'"),u=h,f=$()},scanJsxIdentifier:function(){if(t(f)){for(var e=u;u<d;){var n=o.charCodeAt(u);if(45!==n&&!(e===u?N(n,r):D(n,r)))break;u++}v+=o.substr(e,u-e)}return f},scanJsxAttributeValue:function(){switch(p=u,o.charCodeAt(u)){case 34:case 39:return v=F(!1),f=9;default:return K()}},reScanJsxToken:function(){return u=h=p,f=W()},scanJsxToken:W,scanJSDocToken:function(){if(u>=d)return f=1;p=u,h=u;var e=o.charCodeAt(u);switch(e){case 9:case 11:case 12:case 32:for(;u<d&&_(o.charCodeAt(u));)u++;return f=5;case 64:return u++,f=57;case 10:case 13:return u++,f=4;case 42:return u++,f=39;case 123:return u++,f=17;case 125:return u++,f=18;case 91:return u++,f=21;case 93:return u++,f=22;case 60:return u++,f=27;case 62:return u++,f=29;case 61:return u++,f=58;case 44:return u++,f=26;case 46:return u++,f=23}if(N(e,5)){for(u++;D(o.charCodeAt(u),5)&&u<d;)u++;return f=71}return u+=1,f=0},scan:K,getText:function(){return o},setText:q,setScriptTarget:function(e){r=e},setLanguageVariant:function(e){s=e},setOnError:function(e){a=e},setTextPos:J,tryScan:function(e){return z(e,!1)},lookAhead:function(e){return z(e,!0)},scanRange:function(e,t,n){var r=d,i=u,s=p,a=h,l=f,c=E,m=v,_=C,g=I;q(o,e,t);var y=n();return d=r,u=i,p=s,h=a,f=l,E=c,v=m,C=_,I=g,y}};function w(e,t){a&&a(e,t||0)}function O(){for(var t=u;y(o.charCodeAt(u));)u++;if(46===o.charCodeAt(u))for(u++;y(o.charCodeAt(u));)u++;var n=u;if(69===o.charCodeAt(u)||101===o.charCodeAt(u))if(u++,A=2,43!==o.charCodeAt(u)&&45!==o.charCodeAt(u)||u++,y(o.charCodeAt(u))){for(u++;y(o.charCodeAt(u));)u++;n=u}else w(e.Diagnostics.Digit_expected);return""+ +o.substring(t,n)}function R(){for(var e=u;b(o.charCodeAt(u));)u++;return+o.substring(e,u)}function L(e){return M(e,!1)}function P(e){return M(e,!0)}function M(e,t){for(var n=0,r=0;n<e||t;){var i=o.charCodeAt(u);if(i>=48&&i<=57)r=16*r+i-48;else if(i>=65&&i<=70)r=16*r+i-65+10;else{if(!(i>=97&&i<=102))break;r=16*r+i-97+10}u++,n++}return n<e&&(r=-1),r}function F(t){void 0===t&&(t=!0);for(var n=o.charCodeAt(u),r="",i=++u;;){if(u>=d){r+=o.substring(i,u),I=!0,w(e.Diagnostics.Unterminated_string_literal);break}var s=o.charCodeAt(u);if(s===n){r+=o.substring(i,u),u++;break}if(92===s&&t)r+=o.substring(i,u),r+=B(),i=u;else{if(g(s)){r+=o.substring(i,u),I=!0,w(e.Diagnostics.Unterminated_string_literal);break}u++}}return r}function $(){for(var t,n=96===o.charCodeAt(u),r=++u,i="";;){if(u>=d){i+=o.substring(r,u),I=!0,w(e.Diagnostics.Unterminated_template_literal),t=n?13:16;break}var s=o.charCodeAt(u);if(96===s){i+=o.substring(r,u),u++,t=n?13:16;break}if(36===s&&u+1<d&&123===o.charCodeAt(u+1)){i+=o.substring(r,u),u+=2,t=n?14:15;break}92!==s?13!==s?u++:(i+=o.substring(r,u),++u<d&&10===o.charCodeAt(u)&&u++,i+="\n",r=u):(i+=o.substring(r,u),i+=B(),r=u)}return e.Debug.assert(void 0!==t),v=i,t}function B(){if(++u>=d)return w(e.Diagnostics.Unexpected_end_of_text),"";var t=o.charCodeAt(u);switch(u++,t){case 48:return"\0";case 98:return"\b";case 116:return"\t";case 110:return"\n";case 118:return"\v";case 102:return"\f";case 114:return"\r";case 39:return"'";case 34:return'"';case 117:return u<d&&123===o.charCodeAt(u)?(C=!0,u++,function(){var t=P(1),n=!1;t<0?(w(e.Diagnostics.Hexadecimal_digit_expected),n=!0):t>1114111&&(w(e.Diagnostics.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive),n=!0);u>=d?(w(e.Diagnostics.Unexpected_end_of_text),n=!0):125===o.charCodeAt(u)?u++:(w(e.Diagnostics.Unterminated_Unicode_escape_sequence),n=!0);if(n)return"";return function(t){if(e.Debug.assert(0<=t&&t<=1114111),t<=65535)return String.fromCharCode(t);var n=Math.floor((t-65536)/1024)+55296,r=(t-65536)%1024+56320;return String.fromCharCode(n,r)}(t)}()):U(4);case 120:return U(2);case 13:u<d&&10===o.charCodeAt(u)&&u++;case 10:case 8232:case 8233:return"";default:return String.fromCharCode(t)}}function U(t){var n=L(t);return n>=0?String.fromCharCode(n):(w(e.Diagnostics.Hexadecimal_digit_expected),"")}function V(){if(u+5<d&&117===o.charCodeAt(u+1)){var e=u;u+=2;var t=L(4);return u=e,t}return-1}function H(){for(var e="",t=u;u<d;){var n=o.charCodeAt(u);if(D(n,r))u++;else{if(92!==n)break;if(!((n=V())>=0&&D(n,r)))break;e+=o.substring(t,u),e+=String.fromCharCode(n),t=u+=6}}return e+=o.substring(t,u)}function G(){var e=v.length;if(e>=2&&e<=11){var t=v.charCodeAt(0);if(t>=97&&t<=122&&void 0!==(f=n.get(v)))return f}return f=71}function j(t){e.Debug.assert(2===t||8===t,"Expected either base 2 or base 8");for(var n=0,r=0;;){var i=o.charCodeAt(u),s=i-48;if(!y(i)||s>=t)break;n=n*t+s,u++,r++}return 0===r?-1:n}function K(){for(p=u,C=!1,E=!1,I=!1,A=0;;){if(h=u,u>=d)return f=1;var t=o.charCodeAt(u);if(35===t&&0===u&&x(o,u)){if(u=S(o,u),i)continue;return f=6}switch(t){case 10:case 13:if(E=!0,i){u++;continue}return 13===t&&u+1<d&&10===o.charCodeAt(u+1)?u+=2:u++,f=4;case 9:case 11:case 12:case 32:if(i){u++;continue}for(;u<d&&_(o.charCodeAt(u));)u++;return f=5;case 33:return 61===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=35):(u+=2,f=33):(u++,f=51);case 34:case 39:return v=F(),f=9;case 96:return f=$();case 37:return 61===o.charCodeAt(u+1)?(u+=2,f=64):(u++,f=42);case 38:return 38===o.charCodeAt(u+1)?(u+=2,f=53):61===o.charCodeAt(u+1)?(u+=2,f=68):(u++,f=48);case 40:return u++,f=19;case 41:return u++,f=20;case 42:return 61===o.charCodeAt(u+1)?(u+=2,f=61):42===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=62):(u+=2,f=40):(u++,f=39);case 43:return 43===o.charCodeAt(u+1)?(u+=2,f=43):61===o.charCodeAt(u+1)?(u+=2,f=59):(u++,f=37);case 44:return u++,f=26;case 45:return 45===o.charCodeAt(u+1)?(u+=2,f=44):61===o.charCodeAt(u+1)?(u+=2,f=60):(u++,f=38);case 46:return y(o.charCodeAt(u+1))?(v=O(),f=8):46===o.charCodeAt(u+1)&&46===o.charCodeAt(u+2)?(u+=3,f=24):(u++,f=23);case 47:if(47===o.charCodeAt(u+1)){for(u+=2;u<d&&!g(o.charCodeAt(u));)u++;if(i)continue;return f=2}if(42===o.charCodeAt(u+1)){u+=2;for(var n=!1;u<d;){var a=o.charCodeAt(u);if(42===a&&47===o.charCodeAt(u+1)){u+=2,n=!0;break}g(a)&&(E=!0),u++}if(n||w(e.Diagnostics.Asterisk_Slash_expected),i)continue;return I=!n,f=3}return 61===o.charCodeAt(u+1)?(u+=2,f=63):(u++,f=41);case 48:var l;if(u+2<d&&(88===o.charCodeAt(u+1)||120===o.charCodeAt(u+1)))return u+=2,(l=P(1))<0&&(w(e.Diagnostics.Hexadecimal_digit_expected),l=0),v=""+l,A=8,f=8;if(u+2<d&&(66===o.charCodeAt(u+1)||98===o.charCodeAt(u+1)))return u+=2,(l=j(2))<0&&(w(e.Diagnostics.Binary_digit_expected),l=0),v=""+l,A=16,f=8;if(u+2<d&&(79===o.charCodeAt(u+1)||111===o.charCodeAt(u+1)))return u+=2,(l=j(8))<0&&(w(e.Diagnostics.Octal_digit_expected),l=0),v=""+l,A=32,f=8;if(u+1<d&&b(o.charCodeAt(u+1)))return v=""+R(),A=4,f=8;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return v=O(),f=8;case 58:return u++,f=56;case 59:return u++,f=25;case 60:if(T(o,u)){if(u=k(o,u,w),i)continue;return f=7}return 60===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=65):(u+=2,f=45):61===o.charCodeAt(u+1)?(u+=2,f=30):1===s&&47===o.charCodeAt(u+1)&&42!==o.charCodeAt(u+2)?(u+=2,f=28):(u++,f=27);case 61:if(T(o,u)){if(u=k(o,u,w),i)continue;return f=7}return 61===o.charCodeAt(u+1)?61===o.charCodeAt(u+2)?(u+=3,f=34):(u+=2,f=32):62===o.charCodeAt(u+1)?(u+=2,f=36):(u++,f=58);case 62:if(T(o,u)){if(u=k(o,u,w),i)continue;return f=7}return u++,f=29;case 63:return u++,f=55;case 91:return u++,f=21;case 93:return u++,f=22;case 94:return 61===o.charCodeAt(u+1)?(u+=2,f=70):(u++,f=50);case 123:return u++,f=17;case 124:if(T(o,u)){if(u=k(o,u,w),i)continue;return f=7}return 124===o.charCodeAt(u+1)?(u+=2,f=54):61===o.charCodeAt(u+1)?(u+=2,f=69):(u++,f=49);case 125:return u++,f=18;case 126:return u++,f=52;case 64:return u++,f=57;case 92:var c=V();return c>=0&&N(c,r)?(u+=6,v=String.fromCharCode(c)+H(),f=G()):(w(e.Diagnostics.Invalid_character),u++,f=0);default:if(N(t,r)){for(u++;u<d&&D(t=o.charCodeAt(u),r);)u++;return v=o.substring(h,u),92===t&&(v+=H()),f=G()}if(_(t)){u++;continue}if(g(t)){E=!0,u++;continue}return w(e.Diagnostics.Invalid_character),u++,f=0}}}function W(){if(p=h=u,u>=d)return f=1;var e=o.charCodeAt(u);if(60===e)return 47===o.charCodeAt(u+1)?(u+=2,f=28):(u++,f=27);if(123===e)return u++,f=17;for(var t=0;u<d&&123!==(e=o.charCodeAt(u));){if(60===e){if(T(o,u))return u=k(o,u,w),f=7;break}g(e)&&0===t?t=-1:m(e)||(t=u),u++}return-1===t?11:10}function z(e,t){var n=u,r=p,i=h,s=f,o=v,a=E,l=e();return l&&!t||(u=n,p=r,h=i,f=s,v=o,E=a),l}function q(e,t,n){o=e||"",d=void 0===n?o.length:t+n,J(t||0)}function J(t){e.Debug.assert(t>=0),u=t,p=t,h=t,f=0,E=!1,v=void 0,C=!1,I=!1}}}(ts||(ts={})),function(e){e.emptyArray=[],e.emptyMap=e.createMap(),e.externalHelpersModuleNameText="tslib",e.getDeclarationOfKind=function(e,t){var n=e.declarations;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s.kind===t)return s}};var t,n,r=(t="",{string:function(){return t},writeKeyword:n=function(e){return t+=e},writeOperator:n,writePunctuation:n,writeSpace:n,writeStringLiteral:n,writeParameter:n,writeProperty:n,writeSymbol:n,writeLine:function(){return t+=" "},increaseIndent:e.noop,decreaseIndent:e.noop,clear:function(){return t=""},trackSymbol:e.noop,reportInaccessibleThisError:e.noop,reportPrivateInBaseOfClassExpression:e.noop});function i(e){return e.end-e.pos}function s(t){return function(t){if(!(262144&t.flags)){(0!=(32768&t.flags)||e.forEachChild(t,s))&&(t.flags|=131072),t.flags|=262144}}(t),0!=(131072&t.flags)}function o(e){for(;e&&265!==e.kind;)e=e.parent;return e}function a(t,n){e.Debug.assert(t>=0);var r=e.getLineStarts(n),i=t,s=n.text;if(i+1===r.length)return s.length-1;var o=r[i],a=r[i+1]-1;for(e.Debug.assert(e.isLineBreak(s.charCodeAt(a)));o<=a&&e.isLineBreak(s.charCodeAt(a));)a--;return a}function l(e){return void 0===e||e.pos===e.end&&e.pos>=0&&1!==e.kind}function c(e){return!l(e)}function u(e,t){return 42===e.charCodeAt(t.pos+1)&&33===e.charCodeAt(t.pos+2)}function d(t,n,r){return l(t)?t.pos:e.isJSDocNode(t)?e.skipTrivia((n||o(t)).text,t.pos,!1,!0):r&&e.hasJSDocNodes(t)?d(t.jsDoc[0]):286===t.kind&&t._children.length>0?d(t._children[0],n,r):e.skipTrivia((n||o(t)).text,t.pos)}function p(t,n,r){if(void 0===r&&(r=!1),l(n))return"";var i=t.text;return i.substring(r?n.pos:e.skipTrivia(i,n.pos),n.end)}function h(t,n){return l(n)?"":t.substring(e.skipTrivia(t,n.pos),n.end)}function f(e,t){return void 0===t&&(t=!1),p(o(e),e,t)}function m(e,t){var n=e.pos,r=t.pos;return n<r?-1:r<n?1:0}function _(e){var t=e.emitNode;return t&&t.flags}function g(e){return e.length>=2&&95===e.charCodeAt(0)&&95===e.charCodeAt(1)?"_"+e:e}function y(e){var t=le(e);return 226===t.kind&&260===t.parent.kind}function b(e){return e&&233===e.kind&&(9===e.name.kind||T(e))}function v(t){return e.isModuleDeclaration(t)&&9===t.name.kind}function T(e){return!!(512&e.flags)}function k(t,n){switch(t.kind){case 265:case 235:case 260:case 233:case 214:case 215:case 216:case 152:case 151:case 153:case 154:case 228:case 186:case 187:return!0;case 207:return n&&!e.isFunctionLike(n)}return!1}function E(e){return 0===i(e)?"(Missing)":f(e)}function x(e){switch(e.kind){case 71:return e.escapedText;case 9:case 8:return g(e.text);case 144:if(te(e.expression))return g(e.expression.text)}}function S(t,n,r,i,s,o){var a=I(t,n);return e.createFileDiagnostic(t,a.start,a.length,r,i,s,o)}function C(t,n){var r=e.createScanner(t.languageVersion,!0,t.languageVariant,t.text,void 0,n);r.scan();var i=r.getTokenPos();return e.createTextSpanFromBounds(i,r.getTextPos())}function I(t,n){var r=n;switch(n.kind){case 265:var i=e.skipTrivia(t.text,0,!1);return i===t.text.length?e.createTextSpan(0,0):C(t,i);case 226:case 176:case 229:case 199:case 230:case 233:case 232:case 264:case 228:case 186:case 151:case 153:case 154:case 231:r=n.name;break;case 187:return function(t,n){var r=e.skipTrivia(t.text,n.pos);if(n.body&&207===n.body.kind){var i=e.getLineAndCharacterOfPosition(t,n.body.pos).line;if(i<e.getLineAndCharacterOfPosition(t,n.body.end).line)return e.createTextSpan(r,a(i,t)-r+1)}return e.createTextSpanFromBounds(r,n.end)}(t,n)}if(void 0===r)return C(t,n.pos);var s=l(r)?r.pos:e.skipTrivia(t.text,r.pos);return e.createTextSpanFromBounds(s,r.end)}function A(t){return!!(2&e.getCombinedNodeFlags(t))||!!(2048&e.getCombinedModifierFlags(t))}e.usingSingleLineStringWriter=function(e){var t=r.string();try{return e(r),r.string()}finally{r.clear(),r.writeKeyword(t)}},e.getFullWidth=i,e.getResolvedModule=function(e,t){return e&&e.resolvedModules&&e.resolvedModules.get(t)},e.setResolvedModule=function(t,n,r){t.resolvedModules||(t.resolvedModules=e.createMap()),t.resolvedModules.set(n,r)},e.setResolvedTypeReferenceDirective=function(t,n,r){t.resolvedTypeReferenceDirectiveNames||(t.resolvedTypeReferenceDirectiveNames=e.createMap()),t.resolvedTypeReferenceDirectiveNames.set(n,r)},e.moduleResolutionIsEqualTo=function(e,t){return e.isExternalLibraryImport===t.isExternalLibraryImport&&e.extension===t.extension&&e.resolvedFileName===t.resolvedFileName&&(n=e.packageId,r=t.packageId,n===r||n&&r&&n.name===r.name&&n.subModuleName===r.subModuleName&&n.version===r.version);var n,r},e.typeDirectiveIsEqualTo=function(e,t){return e.resolvedFileName===t.resolvedFileName&&e.primary===t.primary},e.hasChangesInResolutions=function(t,n,r,i){e.Debug.assert(t.length===n.length);for(var s=0;s<t.length;s++){var o=n[s],a=r&&r.get(t[s]);if(a?!o||!i(a,o):o)return!0}return!1},e.containsParseError=s,e.getSourceFileOfNode=o,e.isStatementWithLocals=function(e){switch(e.kind){case 207:case 235:case 214:case 215:case 216:return!0}return!1},e.getStartPositionOfLine=function(t,n){return e.Debug.assert(t>=0),e.getLineStarts(n)[t]},e.nodePosToString=function(t){var n=o(t),r=e.getLineAndCharacterOfPosition(n,t.pos);return n.fileName+"("+(r.line+1)+","+(r.character+1)+")"},e.getEndLinePosition=a,e.nodeIsMissing=l,e.nodeIsPresent=c,e.isRecognizedTripleSlashComment=function(t,n,r){if(47===t.charCodeAt(n+1)&&n+2<r&&47===t.charCodeAt(n+2)){var i=t.substring(n,r);return!!(i.match(e.fullTripleSlashReferencePathRegEx)||i.match(e.fullTripleSlashAMDReferencePathRegEx)||i.match(w)||i.match(N))}return!1},e.isPinnedComment=u,e.getTokenPosOfNode=d,e.getNonDecoratorTokenPosOfNode=function(t,n){return l(t)||!t.decorators?d(t,n):e.skipTrivia((n||o(t)).text,t.decorators.end)},e.getSourceTextOfNodeFromSourceFile=p,e.getTextOfNodeFromSourceText=h,e.getTextOfNode=f,e.indexOfNode=function(t,n){return e.binarySearch(t,n,m)},e.getEmitFlags=_,e.getLiteralText=function(t,n){if(!ce(t)&&t.parent)return p(n,t);var r=16777216&_(t)?ye:Ee;switch(t.kind){case 9:return t.singleQuote?"'"+r(t.text,39)+"'":'"'+r(t.text,34)+'"';case 13:return"`"+r(t.text,96)+"`";case 14:return"`"+r(t.text,96)+"${";case 15:return"}"+r(t.text,96)+"${";case 16:return"}"+r(t.text,96)+"`";case 8:case 12:return t.text}e.Debug.fail("Literal kind '"+t.kind+"' not accounted for.")},e.getTextOfConstantValue=function(t){return e.isString(t)?'"'+Ee(t)+'"':""+t},e.escapeLeadingUnderscores=g,e.escapeIdentifier=function(e){return e},e.makeIdentifierFromModuleName=function(t){return e.getBaseFileName(t).replace(/^(\d)/,"_$1").replace(/\W/g,"_")},e.isBlockOrCatchScoped=function(t){return 0!=(3&e.getCombinedNodeFlags(t))||y(t)},e.isCatchClauseVariableDeclarationOrBindingElement=y,e.isAmbientModule=b,e.isModuleWithStringLiteralName=v,e.isNonGlobalAmbientModule=function(t){return e.isModuleDeclaration(t)&&e.isStringLiteral(t.name)},e.isShorthandAmbientModuleSymbol=function(e){return(t=e.valueDeclaration)&&233===t.kind&&!t.body;var t},e.isBlockScopedContainerTopLevel=function(t){return 265===t.kind||233===t.kind||e.isFunctionLike(t)},e.isGlobalScopeAugmentation=T,e.isExternalModuleAugmentation=function(t){if(!t||!b(t))return!1;switch(t.parent.kind){case 265:return e.isExternalModule(t.parent);case 234:return b(t.parent.parent)&&!e.isExternalModule(t.parent.parent.parent)}return!1},e.isEffectiveExternalModule=function(t,n){return e.isExternalModule(t)||n.isolatedModules},e.isBlockScope=k,e.isDeclarationWithTypeParameters=function(t){switch(t.kind){case 155:case 156:case 150:case 157:case 160:case 161:case 273:case 229:case 199:case 230:case 231:case 282:case 228:case 151:case 152:case 153:case 154:case 186:case 187:return!0;default:return e.assertTypeIsNever(t),!1}},e.isAnyImportSyntax=function(e){switch(e.kind){case 238:case 237:return!0;default:return!1}},e.getEnclosingBlockScopeContainer=function(e){for(var t=e.parent;t;){if(k(t,t.parent))return t;t=t.parent}},e.declarationNameToString=E,e.getNameFromIndexInfo=function(e){return e.declaration?E(e.declaration.parameters[0].name):void 0},e.getTextOfPropertyName=x,e.entityNameToString=function t(n){switch(n.kind){case 71:return 0===i(n)?e.idText(n):f(n);case 143:return t(n.left)+"."+t(n.right);case 179:return t(n.expression)+"."+t(n.name)}},e.createDiagnosticForNode=function(e,t,n,r,i){return S(o(e),e,t,n,r,i)},e.createDiagnosticForNodeInSourceFile=S,e.createDiagnosticForNodeFromMessageChain=function(e,t){var n=o(e),r=I(n,e);return{file:n,start:r.start,length:r.length,code:t.code,category:t.category,messageText:t.next?t:t.messageText}},e.getSpanOfTokenAtPosition=C,e.getErrorSpanForNode=I,e.isExternalOrCommonJsModule=function(e){return void 0!==(e.externalModuleIndicator||e.commonJsModuleIndicator)},e.isConstEnumDeclaration=function(e){return 232===e.kind&&A(e)},e.isConst=A,e.isLet=function(t){return!!(1&e.getCombinedNodeFlags(t))},e.isSuperCall=function(e){return 181===e.kind&&97===e.expression.kind},e.isImportCall=function(e){return 181===e.kind&&91===e.expression.kind},e.isPrologueDirective=function(e){return 210===e.kind&&9===e.expression.kind},e.getLeadingCommentRangesOfNode=function(t,n){return 10!==t.kind?e.getLeadingCommentRanges(n.text,t.pos):void 0},e.getJSDocCommentRanges=function(t,n){var r=146===t.kind||145===t.kind||186===t.kind||187===t.kind||185===t.kind?e.concatenate(e.getTrailingCommentRanges(n,t.pos),e.getLeadingCommentRanges(n,t.pos)):e.getLeadingCommentRanges(n,t.pos);return e.filter(r,(function(e){return 42===n.charCodeAt(e.pos+1)&&42===n.charCodeAt(e.pos+2)&&47!==n.charCodeAt(e.pos+3)}))},e.fullTripleSlashReferencePathRegEx=/^(\/\/\/\s*<reference\s+path\s*=\s*)('|")(.+?)\2.*?\/>/;var w=/^(\/\/\/\s*<reference\s+types\s*=\s*)('|")(.+?)\2.*?\/>/;e.fullTripleSlashAMDReferencePathRegEx=/^(\/\/\/\s*<amd-dependency\s+path\s*=\s*)('|")(.+?)\2.*?\/>/;var N=/^(\/\/\/\s*<reference\s+no-default-lib\s*=\s*)('|")(.+?)\2\s*\/>/;function D(t){if(158<=t.kind&&t.kind<=173)return!0;switch(t.kind){case 119:case 133:case 136:case 122:case 137:case 139:case 130:return!0;case 105:return 190!==t.parent.kind;case 201:return!Xe(t);case 71:(143===t.parent.kind&&t.parent.right===t||179===t.parent.kind&&t.parent.name===t)&&(t=t.parent),e.Debug.assert(71===t.kind||143===t.kind||179===t.kind,"'node' was expected to be a qualified name, identifier or property access in 'isPartOfTypeNode'.");case 143:case 179:case 99:var n=t.parent;if(162===n.kind)return!1;if(158<=n.kind&&n.kind<=173)return!0;switch(n.kind){case 201:return!Xe(n);case 145:return t===n.constraint;case 149:case 148:case 146:case 226:return t===n.type;case 228:case 186:case 187:case 152:case 151:case 150:case 153:case 154:return t===n.type;case 155:case 156:case 157:case 184:return t===n.type;case 181:case 182:return n.typeArguments&&e.indexOf(n.typeArguments,t)>=0;case 183:return!1}}return!1}function O(e){if(e)switch(e.kind){case 176:case 264:case 146:case 261:case 149:case 148:case 262:case 226:return!0}return!1}function R(t,n){for(;;){if(!(t=t.parent))return;switch(t.kind){case 144:if(e.isClassLike(t.parent.parent))return t;t=t.parent;break;case 147:146===t.parent.kind&&e.isClassElement(t.parent.parent)?t=t.parent.parent:e.isClassElement(t.parent)&&(t=t.parent);break;case 187:if(!n)continue;case 228:case 186:case 233:case 149:case 148:case 151:case 150:case 152:case 153:case 154:case 155:case 156:case 157:case 232:case 265:return t}}}function L(e){switch(e.kind){case 229:return!0;case 149:return 229===e.parent.kind;case 153:case 154:case 151:return void 0!==e.body&&229===e.parent.kind;case 146:return void 0!==e.parent.body&&(152===e.parent.kind||151===e.parent.kind||154===e.parent.kind)&&229===e.parent.parent.kind}return!1}function P(e){return void 0!==e.decorators&&L(e)}function M(e){return P(e)||F(e)}function F(t){switch(t.kind){case 229:return e.forEach(t.members,M);case 151:case 154:return e.forEach(t.parameters,P)}}function $(e){var t=e.parent;return(251===t.kind||250===t.kind||252===t.kind)&&t.tagName===e}function B(e){switch(e.kind){case 97:case 95:case 101:case 86:case 12:case 177:case 178:case 179:case 180:case 181:case 182:case 183:case 202:case 184:case 203:case 185:case 186:case 199:case 187:case 190:case 188:case 189:case 192:case 193:case 194:case 195:case 198:case 196:case 13:case 200:case 249:case 250:case 197:case 191:case 204:return!0;case 143:for(;143===e.parent.kind;)e=e.parent;return 162===e.parent.kind||$(e);case 71:if(162===e.parent.kind||$(e))return!0;case 8:case 9:case 99:return U(e);default:return!1}}function U(e){var t=e.parent;switch(t.kind){case 226:case 146:case 149:case 148:case 264:case 261:case 176:return t.initializer===e;case 210:case 211:case 212:case 213:case 219:case 220:case 221:case 257:case 223:return t.expression===e;case 214:var n=t;return n.initializer===e&&227!==n.initializer.kind||n.condition===e||n.incrementor===e;case 215:case 216:var r=t;return r.initializer===e&&227!==r.initializer.kind||r.expression===e;case 184:case 202:case 205:case 144:return e===t.expression;case 147:case 256:case 255:case 263:return!0;case 201:return t.expression===e&&Xe(t);default:return B(t)}}function V(e){return 237===e.kind&&248===e.moduleReference.kind}function H(e){return G(e)}function G(e){return e&&!!(65536&e.flags)}function j(e){if(!G(e))return 0;if(58!==e.operatorToken.kind||179!==e.left.kind)return 0;var t=e.left;if(71===t.expression.kind){var n=t.expression;return"exports"===n.escapedText?1:"module"===n.escapedText&&"exports"===t.name.escapedText?2:5}if(99===t.expression.kind)return 4;if(179===t.expression.kind){var r=t.expression;if(71===r.expression.kind){if("module"===r.expression.escapedText&&"exports"===r.name.escapedText)return 1;if("prototype"===r.name.escapedText)return 3}}return 0}function K(t){return e.isExpressionStatement(t)&&t.expression&&e.isBinaryExpression(t.expression)&&58===t.expression.operatorToken.kind&&t.expression.right}function W(t,n){return e.isVariableStatement(t)&&t.declarationList.declarations.length>0&&(!n||t.declarationList.declarations[0].initializer===n)&&t.declarationList.declarations[0].initializer}function z(t,n){return e.isVariableStatement(t)&&t.declarationList.declarations.length>0&&(!n||t.declarationList.declarations[0]===n)&&t.declarationList.declarations[0]}function q(e){return 233===e.kind&&e.body&&233===e.body.kind&&e.body}function J(t){var n;return function t(r){var i=r.parent;i&&(261===i.kind||q(i))&&t(i);i&&i.parent&&(z(i.parent,r)||K(i.parent))&&t(i.parent);i&&i.parent&&i.parent.parent&&W(i.parent.parent,r)&&t(i.parent.parent);146===r.kind&&(n=e.addRange(n,e.getJSDocParameterTags(r)));O(r)&&r.initializer&&e.hasJSDocNodes(r.initializer)&&(n=e.addRange(n,r.initializer.jsDoc));e.hasJSDocNodes(r)&&(n=e.addRange(n,r.jsDoc))}(t),n||e.emptyArray}function Y(t){return e.Debug.assert(275===t.parent.kind),t.parent.parent}function X(e){return void 0!==e.dotDotDotToken}function Q(e){for(var t=e.parent;;){switch(t.kind){case 194:var n=t.operatorToken.kind;return qe(n)&&t.left===e?58===n?1:2:0;case 192:case 193:var r=t.operator;return 43===r||44===r?2:0;case 215:case 216:return t.initializer===e?1:0;case 185:case 177:case 198:e=t;break;case 262:if(t.name!==e)return 0;e=t.parent;break;case 261:if(t.name===e)return 0;e=t.parent;break;default:return 0}t=e.parent}}function Z(e){return Qe(e.expression)}function ee(e,t){if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.token===t)return i}}function te(e){var t=e.kind;return 9===t||8===t}function ne(t){var n=e.getNameOfDeclaration(t);return n&&re(n)}function re(e){return 144===e.kind&&!te(e.expression)&&!ie(e.expression)}function ie(t){return e.isPropertyAccessExpression(t)&&ae(t.expression)}function se(t){if(71===t.kind)return t.escapedText;if(9===t.kind||8===t.kind)return g(t.text);if(144===t.kind){var n=t.expression;if(ie(n))return oe(e.idText(n.name));if(9===n.kind||8===n.kind)return g(n.text)}}function oe(e){return"__@"+e}function ae(e){return 71===e.kind&&"Symbol"===e.escapedText}function le(e){for(;176===e.kind;)e=e.parent.parent;return e}function ce(t){return e.positionIsSynthesized(t.pos)||e.positionIsSynthesized(t.end)}function ue(e,t,n){switch(e){case 182:return n?0:1;case 192:case 189:case 190:case 188:case 191:case 195:case 197:return 1;case 194:switch(t){case 40:case 58:case 59:case 60:case 62:case 61:case 63:case 64:case 65:case 66:case 67:case 68:case 70:case 69:return 1}}return 0}function de(e){return 194===e.kind?e.operatorToken.kind:192===e.kind||193===e.kind?e.operator:e.kind}function pe(e,t,n){switch(e){case 99:case 97:case 71:case 95:case 101:case 86:case 8:case 9:case 177:case 178:case 186:case 187:case 199:case 249:case 250:case 12:case 13:case 196:case 185:case 200:return 19;case 183:case 179:case 180:return 18;case 182:return n?18:17;case 181:return 17;case 193:return 16;case 192:case 189:case 190:case 188:case 191:return 15;case 194:switch(t){case 51:case 52:return 15;case 40:case 39:case 41:case 42:return 14;case 37:case 38:return 13;case 45:case 46:case 47:return 12;case 27:case 30:case 29:case 31:case 92:case 93:return 11;case 32:case 34:case 33:case 35:return 10;case 48:return 9;case 50:return 8;case 49:return 7;case 53:return 6;case 54:return 5;case 58:case 59:case 60:case 62:case 61:case 63:case 64:case 65:case 66:case 67:case 68:case 70:case 69:return 3;case 26:return 0;default:return-1}case 195:return 4;case 197:return 2;case 198:return 1;case 289:return 0;default:return-1}}e.isPartOfTypeNode=D,e.isChildOfNodeWithKind=function(e,t){for(;e;){if(e.kind===t)return!0;e=e.parent}return!1},e.forEachReturnStatement=function(t,n){return function t(r){switch(r.kind){case 219:return n(r);case 235:case 207:case 211:case 212:case 213:case 214:case 215:case 216:case 220:case 221:case 257:case 258:case 222:case 224:case 260:return e.forEachChild(r,t)}}(t)},e.forEachYieldExpression=function(t,n){return function t(r){switch(r.kind){case 197:n(r);var i=r.expression;return void(i&&t(i));case 232:case 230:case 233:case 231:case 229:case 199:return;default:if(e.isFunctionLike(r)){var s=r.name;if(s&&144===s.kind)return void t(s.expression)}else D(r)||e.forEachChild(r,t)}}(t)},e.getRestParameterElementType=function(t){return t&&164===t.kind?t.elementType:t&&159===t.kind?e.singleOrUndefined(t.typeArguments):void 0},e.isVariableLike=O,e.introducesArgumentsExoticObject=function(e){switch(e.kind){case 151:case 150:case 152:case 153:case 154:case 228:case 186:return!0}return!1},e.unwrapInnermostStatementOfLabel=function(e,t){for(;;){if(t&&t(e),222!==e.statement.kind)return e.statement;e=e.statement}},e.isFunctionBlock=function(t){return t&&207===t.kind&&e.isFunctionLike(t.parent)},e.isObjectLiteralMethod=function(e){return e&&151===e.kind&&178===e.parent.kind},e.isObjectLiteralOrClassExpressionMethod=function(e){return 151===e.kind&&(178===e.parent.kind||199===e.parent.kind)},e.isIdentifierTypePredicate=function(e){return e&&1===e.kind},e.isThisTypePredicate=function(e){return e&&0===e.kind},e.getPropertyAssignment=function(t,n,r){return e.filter(t.properties,(function(e){if(261===e.kind){var t=x(e.name);return n===t||r&&r===t}}))},e.getContainingFunction=function(t){return e.findAncestor(t.parent,e.isFunctionLike)},e.getContainingClass=function(t){return e.findAncestor(t.parent,e.isClassLike)},e.getThisContainer=R,e.getNewTargetContainer=function(e){var t=R(e,!1);if(t)switch(t.kind){case 152:case 228:case 186:return t}},e.getSuperContainer=function(t,n){for(;;){if(!(t=t.parent))return t;switch(t.kind){case 144:t=t.parent;break;case 228:case 186:case 187:if(!n)continue;case 149:case 148:case 151:case 150:case 152:case 153:case 154:return t;case 147:146===t.parent.kind&&e.isClassElement(t.parent.parent)?t=t.parent.parent:e.isClassElement(t.parent)&&(t=t.parent)}}},e.getImmediatelyInvokedFunctionExpression=function(e){if(186===e.kind||187===e.kind){for(var t=e,n=e.parent;185===n.kind;)t=n,n=n.parent;if(181===n.kind&&n.expression===t)return n}},e.isSuperProperty=function(e){var t=e.kind;return(179===t||180===t)&&97===e.expression.kind},e.getEntityNameFromTypeNode=function(e){switch(e.kind){case 159:return e.typeName;case 201:return Qe(e.expression)?e.expression:void 0;case 71:case 143:return e}},e.getInvokedExpression=function(t){return 183===t.kind?t.tag:e.isJsxOpeningLikeElement(t)?t.tagName:t.expression},e.nodeCanBeDecorated=L,e.nodeIsDecorated=P,e.nodeOrChildIsDecorated=M,e.childIsDecorated=F,e.isJSXTagName=$,e.isPartOfExpression=B,e.isInExpressionContext=U,e.isExternalModuleImportEqualsDeclaration=V,e.getExternalModuleImportEqualsDeclarationExpression=function(t){return e.Debug.assert(V(t)),t.moduleReference.expression},e.isInternalModuleImportEqualsDeclaration=function(e){return 237===e.kind&&248!==e.moduleReference.kind},e.isSourceFileJavaScript=H,e.isInJavaScriptFile=G,e.isInJSDoc=function(e){return e&&!!(1048576&e.flags)},e.isJSDocIndexSignature=function(t){return e.isTypeReferenceNode(t)&&e.isIdentifier(t.typeName)&&"Object"===t.typeName.escapedText&&t.typeArguments&&2===t.typeArguments.length&&(136===t.typeArguments[0].kind||133===t.typeArguments[0].kind)},e.isRequireCall=function(e,t){if(181!==e.kind)return!1;var n=e,r=n.expression,i=n.arguments;if(71!==r.kind||"require"!==r.escapedText)return!1;if(1!==i.length)return!1;var s=i[0];return!t||9===s.kind||13===s.kind},e.isSingleOrDoubleQuote=function(e){return 39===e||34===e},e.isStringDoubleQuoted=function(e,t){return 34===p(t,e).charCodeAt(0)},e.isDeclarationOfFunctionOrClassExpression=function(e){if(e.valueDeclaration&&226===e.valueDeclaration.kind){var t=e.valueDeclaration;return t.initializer&&(186===t.initializer.kind||199===t.initializer.kind)}return!1},e.getRightMostAssignedExpression=function(e){for(;Ye(e,!0);)e=e.right;return e},e.isExportsIdentifier=function(t){return e.isIdentifier(t)&&"exports"===t.escapedText},e.isModuleExportsPropertyAccessExpression=function(t){return e.isPropertyAccessExpression(t)&&e.isIdentifier(t.expression)&&"module"===t.expression.escapedText&&"exports"===t.name.escapedText},e.getSpecialPropertyAssignmentKind=j,e.getExternalModuleName=function(e){if(238===e.kind)return e.moduleSpecifier;if(237===e.kind){var t=e.moduleReference;if(248===t.kind)return t.expression}return 244===e.kind?e.moduleSpecifier:v(e)?e.name:void 0},e.getNamespaceDeclarationNode=function(e){if(237===e.kind)return e;var t=e.importClause;return t&&t.namedBindings&&240===t.namedBindings.kind?t.namedBindings:void 0},e.isDefaultImport=function(e){return 238===e.kind&&e.importClause&&!!e.importClause.name},e.hasQuestionToken=function(e){if(e)switch(e.kind){case 146:case 151:case 150:case 262:case 261:case 149:case 148:return void 0!==e.questionToken}return!1},e.isJSDocConstructSignature=function(e){return 273===e.kind&&e.parameters.length>0&&e.parameters[0].name&&"new"===e.parameters[0].name.escapedText},e.getAllJSDocs=function(t){return e.isJSDocTypedefTag(t)?[t.parent]:J(t)},e.getSourceOfAssignment=K,e.getSingleInitializerOfVariableStatement=W,e.getSingleVariableOfVariableStatement=z,e.getNestedModuleDeclaration=q,e.getJSDocCommentsAndTags=J,e.getParameterSymbolFromJSDoc=function(t){if(t.symbol)return t.symbol;if(e.isIdentifier(t.name)){var n=t.name.escapedText,r=Y(t),i=K(r)||W(r)||z(r)||q(r)||r;if(i&&e.isFunctionLike(i)){var s=e.find(i.parameters,(function(e){return 71===e.name.kind&&e.name.escapedText===n}));return s&&s.symbol}}},e.getJSDocHost=Y,e.getTypeParameterFromJsDoc=function(t){var n=t.name.escapedText,r=t.parent.parent.parent.typeParameters;return e.find(r,(function(e){return e.name.escapedText===n}))},e.hasRestParameter=function(t){var n=e.lastOrUndefined(t.parameters);return n&&X(n)},e.isRestParameter=X,function(e){e[e.None=0]="None",e[e.Definite=1]="Definite",e[e.Compound=2]="Compound"}(e.AssignmentKind||(e.AssignmentKind={})),e.getAssignmentTargetKind=Q,e.isAssignmentTarget=function(e){return 0!==Q(e)},e.isDeleteTarget=function(e){if(179!==e.kind&&180!==e.kind)return!1;for(e=e.parent;e&&185===e.kind;)e=e.parent;return e&&188===e.kind},e.isNodeDescendantOf=function(e,t){for(;e;){if(e===t)return!0;e=e.parent}return!1},e.isInAmbientContext=function(e){for(;e;){if(Ge(e,2)||265===e.kind&&e.isDeclarationFile)return!0;e=e.parent}return!1},e.isDeclarationName=function(t){switch(t.kind){case 71:case 9:case 8:return e.isDeclaration(t.parent)&&t.parent.name===t;default:return!1}},e.isAnyDeclarationName=function(t){switch(t.kind){case 71:case 9:case 8:if(e.isDeclaration(t.parent))return t.parent.name===t;var n=t.parent.parent;return e.isBinaryExpression(n)&&0!==j(n)&&e.getNameOfDeclaration(n)===t;default:return!1}},e.isLiteralComputedPropertyDeclarationName=function(t){return(9===t.kind||8===t.kind)&&144===t.parent.kind&&e.isDeclaration(t.parent.parent)},e.isIdentifierName=function(e){var t=e.parent;switch(t.kind){case 149:case 148:case 151:case 150:case 153:case 154:case 264:case 261:case 179:return t.name===e;case 143:if(t.right===e){for(;143===t.kind;)t=t.parent;return 162===t.kind}return!1;case 176:case 242:return t.propertyName===e;case 246:case 253:return!0}return!1},e.isAliasSymbolDeclaration=function(e){return 237===e.kind||236===e.kind||239===e.kind&&!!e.name||240===e.kind||242===e.kind||246===e.kind||243===e.kind&&Z(e)},e.exportAssignmentIsAlias=Z,e.getClassExtendsHeritageClauseElement=function(e){var t=ee(e.heritageClauses,85);return t&&t.types.length>0?t.types[0]:void 0},e.getClassImplementsHeritageClauseElements=function(e){var t=ee(e.heritageClauses,108);return t?t.types:void 0},e.getInterfaceBaseTypeNodes=function(e){var t=ee(e.heritageClauses,85);return t?t.types:void 0},e.getHeritageClause=ee,e.tryResolveScriptReference=function(t,n,r){if(!t.getCompilerOptions().noResolve){var i=e.isRootedDiskPath(r.fileName)?r.fileName:e.combinePaths(e.getDirectoryPath(n.fileName),r.fileName);return t.getSourceFile(i)}},e.getAncestor=function(e,t){for(;e;){if(e.kind===t)return e;e=e.parent}},e.getFileReferenceFromReferencePath=function(t,n){var r=new RegExp(N.source,"gim");if(/^\/\/\/\s*<reference\s+/gim.test(t)){if(r.test(t))return{isNoDefaultLib:!0};var i=e.fullTripleSlashReferencePathRegEx.exec(t),s=!i&&w.exec(t),o=i||s;if(o){var a=n.pos+o[1].length+o[2].length;return{fileReference:{pos:a,end:a+o[3].length,fileName:o[3]},isNoDefaultLib:!1,isTypeReferenceDirective:!!s}}return{diagnosticMessage:e.Diagnostics.Invalid_reference_directive_syntax,isNoDefaultLib:!1}}},e.isKeyword=function(e){return 72<=e&&e<=142},e.isTrivia=function(e){return 2<=e&&e<=7},function(e){e[e.Normal=0]="Normal",e[e.Generator=1]="Generator",e[e.Async=2]="Async",e[e.Invalid=4]="Invalid",e[e.AsyncGenerator=3]="AsyncGenerator"}(e.FunctionFlags||(e.FunctionFlags={})),e.getFunctionFlags=function(e){if(!e)return 4;var t=0;switch(e.kind){case 228:case 186:case 151:e.asteriskToken&&(t|=1);case 187:Ge(e,256)&&(t|=2)}return e.body||(t|=4),t},e.isAsyncFunction=function(e){switch(e.kind){case 228:case 186:case 187:case 151:return void 0!==e.body&&void 0===e.asteriskToken&&Ge(e,256)}return!1},e.isStringOrNumericLiteral=te,e.hasDynamicName=ne,e.isDynamicName=re,e.isWellKnownSymbolSyntactically=ie,e.getPropertyNameForPropertyNameNode=se,e.getTextOfIdentifierOrLiteral=function(t){if(t){if(71===t.kind)return e.idText(t);if(9===t.kind||8===t.kind)return t.text}},e.getEscapedTextOfIdentifierOrLiteral=function(e){if(e){if(71===e.kind)return e.escapedText;if(9===e.kind||8===e.kind)return g(e.text)}},e.getPropertyNameForKnownSymbolName=oe,e.isESSymbolIdentifier=ae,e.isPushOrUnshiftIdentifier=function(e){return"push"===e.escapedText||"unshift"===e.escapedText},e.isParameterDeclaration=function(e){return 146===le(e).kind},e.getRootDeclaration=le,e.nodeStartsNewLexicalEnvironment=function(e){var t=e.kind;return 152===t||186===t||228===t||187===t||151===t||153===t||154===t||233===t||265===t},e.nodeIsSynthesized=ce,e.getOriginalSourceFile=function(t){return e.getParseTreeNode(t,e.isSourceFile)||t},function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(e.Associativity||(e.Associativity={})),e.getExpressionAssociativity=function(e){var t=de(e),n=182===e.kind&&void 0!==e.arguments;return ue(e.kind,t,n)},e.getOperatorAssociativity=ue,e.getExpressionPrecedence=function(e){var t=de(e),n=182===e.kind&&void 0!==e.arguments;return pe(e.kind,t,n)},e.getOperator=de,e.getOperatorPrecedence=pe,e.createDiagnosticCollection=function(){var t=[],n=e.createMap(),r=!1,i=0;return{add:function(e){var s;e.file?(s=n.get(e.file.fileName))||(s=[],n.set(e.file.fileName,s)):s=t;s.push(e),r=!0,i++},getGlobalDiagnostics:function(){return s(),t},getDiagnostics:function(r){if(s(),r)return n.get(r)||[];var i=[];function o(e){i.push(e)}return e.forEach(t,o),n.forEach((function(t){e.forEach(t,o)})),e.sortAndDeduplicateDiagnostics(i)},getModificationCount:function(){return i},reattachFileDiagnostics:function(t){e.forEach(n.get(t.fileName),(function(e){return e.file=t}))}};function s(){r&&(r=!1,t=e.sortAndDeduplicateDiagnostics(t),n.forEach((function(t,r){n.set(r,e.sortAndDeduplicateDiagnostics(t))})))}};var he=/[\\\"\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,fe=/[\\\'\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,me=/[\\\`\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,_e=e.createMapFromTemplate({"\0":"\\0","\t":"\\t","\v":"\\v","\f":"\\f","\b":"\\b","\r":"\\r","\n":"\\n","\\":"\\\\",'"':'\\"',"'":"\\'","`":"\\`","\u2028":"\\u2028","\u2029":"\\u2029","":"\\u0085"}),ge=/\\0[0-9]/g;function ye(e,t){var n=96===t?me:39===t?fe:he;return e.replace(n,ve).replace(ge,be)}function be(e){return"\\x00"+e.charAt(e.length-1)}function ve(e){return _e.get(e)||Te(e.charCodeAt(0))}function Te(e){return"\\u"+("0000"+e.toString(16).toUpperCase()).slice(-4)}e.escapeString=ye,e.isIntrinsicJsxName=function(e){var t=e.substr(0,1);return t.toLowerCase()===t};var ke=/[^\u0000-\u007F]/g;function Ee(e,t){return e=ye(e,t),ke.test(e)?e.replace(ke,(function(e){return Te(e.charCodeAt(0))})):e}e.escapeNonAsciiString=Ee;var xe=["","    "];function Se(e){return void 0===xe[e]&&(xe[e]=Se(e-1)+xe[1]),xe[e]}function Ce(){return xe[1].length}function Ie(e,t){return t.moduleName||Ae(e,t.fileName)}function Ae(t,n){var r=function(e){return t.getCanonicalFileName(e)},i=e.toPath(t.getCommonSourceDirectory(),t.getCurrentDirectory(),r),s=e.getNormalizedAbsolutePath(n,t.getCurrentDirectory()),o=e.getRelativePathToDirectoryOrUrl(i,s,i,r,!1);return e.removeFileExtension(o)}function we(e,t,n){return!(t.noEmitForJsFiles&&H(e)||e.isDeclarationFile||n(e))}function Ne(t,n,r){var i=e.getNormalizedAbsolutePath(t.fileName,n.getCurrentDirectory()),s=n.getCommonSourceDirectory();return i=0===n.getCanonicalFileName(i).indexOf(n.getCanonicalFileName(s))?i.substring(s.length):i,e.combinePaths(r,i)}function De(t,n){return e.getLineAndCharacterOfPosition(t,n).line}function Oe(t,n){return e.computeLineAndCharacterOfPosition(t,n).line}function Re(e){if(e&&e.parameters.length>0){var t=2===e.parameters.length&&Le(e.parameters[0]);return e.parameters[t?1:0]}}function Le(e){return Pe(e.name)}function Pe(e){return e&&71===e.kind&&Me(e)}function Me(e){return 99===e.originalKeywordKind}function Fe(t,n){return t.type?t.type:n||G(t)?e.getJSDocType(t):void 0}function $e(e,t,n,r){Be(e,t,n.pos,r)}function Be(e,t,n,r){r&&r.length&&n!==r[0].pos&&Oe(e,n)!==Oe(e,r[0].pos)&&t.writeLine()}function Ue(e,t,n,r,i,s,o,a){if(r&&r.length>0){i&&n.write(" ");for(var l=!1,c=0,u=r;c<u.length;c++){var d=u[c];l&&(n.write(" "),l=!1),a(e,t,n,d.pos,d.end,o),d.hasTrailingNewLine?n.writeLine():l=!0}l&&s&&n.write(" ")}}function Ve(e,t,n,r,i,s){var o=Math.min(t,s-1),a=e.substring(i,o).replace(/^\s+|\s+$/g,"");a?(n.write(a),o!==t&&n.writeLine()):n.writeLiteral(r)}function He(t,n,r){for(var i=0;n<r&&e.isWhiteSpaceSingleLine(t.charCodeAt(n));n++)9===t.charCodeAt(n)?i+=Ce()-i%Ce():i++;return i}function Ge(e,t){return!!je(e,t)}function je(e,t){return Ke(e)&t}function Ke(e){if(536870912&e.modifierFlagsCache)return-536870913&e.modifierFlagsCache;var t=We(e);return e.modifierFlagsCache=536870912|t,t}function We(e){var t=0;if(e.modifiers)for(var n=0,r=e.modifiers;n<r.length;n++){t|=ze(r[n].kind)}return(4&e.flags||71===e.kind&&e.isInJSDocNamespace)&&(t|=1),t}function ze(e){switch(e){case 115:return 32;case 114:return 4;case 113:return 16;case 112:return 8;case 117:return 128;case 84:return 1;case 124:return 2;case 76:return 2048;case 79:return 512;case 120:return 256;case 131:return 64}return 0}function qe(e){return e>=58&&e<=70}function Je(t){if(201===t.kind&&85===t.parent.token&&e.isClassLike(t.parent.parent))return t.parent.parent}function Ye(t,n){return e.isBinaryExpression(t)&&(n?58===t.operatorToken.kind:qe(t.operatorToken.kind))&&e.isLeftHandSideExpression(t.left)}function Xe(e){return void 0!==Je(e)}function Qe(e){return 71===e.kind||179===e.kind&&Qe(e.expression)}e.getIndentString=Se,e.getIndentSize=Ce,e.createTextWriter=function(t){var n,r,i,s,o;function a(e){e&&e.length&&(i&&(n+=Se(r),i=!1),n+=e)}function l(){n="",r=0,i=!0,s=0,o=0}return l(),{write:a,rawWrite:function(e){void 0!==e&&(i&&(i=!1),n+=e)},writeTextOfNode:function(e,t){a(h(e,t))},writeLiteral:function(t){if(t&&t.length){a(t);var r=e.computeLineStarts(t);r.length>1&&(s=s+r.length-1,o=n.length-t.length+e.lastOrUndefined(r))}},writeLine:function(){i||(s++,o=(n+=t).length,i=!0)},increaseIndent:function(){r++},decreaseIndent:function(){r--},getIndent:function(){return r},getTextPos:function(){return n.length},getLine:function(){return s+1},getColumn:function(){return i?r*Ce()+1:n.length-o+1},getText:function(){return n},isAtStartOfLine:function(){return i},reset:l}},e.getResolvedExternalModuleName=Ie,e.getExternalModuleNameFromDeclaration=function(e,t,n){var r=t.getExternalModuleFileFromDeclaration(n);if(r&&!r.isDeclarationFile)return Ie(e,r)},e.getExternalModuleNameFromPath=Ae,e.getOwnEmitOutputFilePath=function(t,n,r){var i=n.getCompilerOptions();return(i.outDir?e.removeFileExtension(Ne(t,n,i.outDir)):e.removeFileExtension(t.fileName))+r},e.getDeclarationEmitOutputFilePath=function(t,n){var r=n.getCompilerOptions(),i=r.declarationDir||r.outDir,s=i?Ne(t,n,i):t.fileName;return e.removeFileExtension(s)+".d.ts"},e.getSourceFilesToEmit=function(t,n){var r=t.getCompilerOptions(),i=function(e){return t.isSourceFileFromExternalLibrary(e)};if(r.outFile||r.out){var s=e.getEmitModuleKind(r),o=s===e.ModuleKind.AMD||s===e.ModuleKind.System;return e.filter(t.getSourceFiles(),(function(t){return(o||!e.isExternalModule(t))&&we(t,r,i)}))}var a=void 0===n?t.getSourceFiles():[n];return e.filter(a,(function(e){return we(e,r,i)}))},e.sourceFileMayBeEmitted=we,e.getSourceFilePathInNewDir=Ne,e.writeFile=function(t,n,r,i,s,o){t.writeFile(r,i,s,(function(t){n.add(e.createCompilerDiagnostic(e.Diagnostics.Could_not_write_file_0_Colon_1,r,t))}),o)},e.getLineOfLocalPosition=De,e.getLineOfLocalPositionFromLineMap=Oe,e.getFirstConstructorWithBody=function(t){return e.forEach(t.members,(function(e){if(152===e.kind&&c(e.body))return e}))},e.getSetAccessorTypeAnnotationNode=function(e){var t=Re(e);return t&&t.type},e.getThisParameter=function(e){if(e.parameters.length){var t=e.parameters[0];if(Le(t))return t}},e.parameterIsThisKeyword=Le,e.isThisIdentifier=Pe,e.identifierIsThisKeyword=Me,e.getAllAccessorDeclarations=function(t,n){var r,i,s,o;return ne(n)?(r=n,153===n.kind?s=n:154===n.kind?o=n:e.Debug.fail("Accessor has wrong kind")):e.forEach(t,(function(e){153!==e.kind&&154!==e.kind||Ge(e,32)!==Ge(n,32)||se(e.name)===se(n.name)&&(r?i||(i=e):r=e,153!==e.kind||s||(s=e),154!==e.kind||o||(o=e))})),{firstAccessor:r,secondAccessor:i,getAccessor:s,setAccessor:o}},e.getEffectiveTypeAnnotationNode=Fe,e.getEffectiveReturnTypeNode=function(t,n){return t.type?t.type:n||G(t)?e.getJSDocReturnType(t):void 0},e.getEffectiveTypeParameterDeclarations=function(t,n){if(t.typeParameters)return t.typeParameters;if(n||G(t)){var r=e.getJSDocTemplateTag(t);return r&&r.typeParameters}},e.getEffectiveSetAccessorTypeAnnotationNode=function(e,t){var n=Re(e);return n&&Fe(n,t)},e.emitNewLineBeforeLeadingComments=$e,e.emitNewLineBeforeLeadingCommentsOfPosition=Be,e.emitNewLineBeforeLeadingCommentOfPosition=function(e,t,n,r){n!==r&&Oe(e,n)!==Oe(e,r)&&t.writeLine()},e.emitComments=Ue,e.emitDetachedComments=function(t,n,r,i,s,o,a){var l,c;if(a?0===s.pos&&(l=e.filter(e.getLeadingCommentRanges(t,s.pos),(function(e){return u(t,e)}))):l=e.getLeadingCommentRanges(t,s.pos),l){for(var d=[],p=void 0,h=0,f=l;h<f.length;h++){var m=f[h];if(p){var _=Oe(n,p.end);if(Oe(n,m.pos)>=_+2)break}d.push(m),p=m}if(d.length){_=Oe(n,e.lastOrUndefined(d).end);Oe(n,e.skipTrivia(t,s.pos))>=_+2&&($e(n,r,s,l),Ue(t,n,r,d,!1,!0,o,i),c={nodePos:s.pos,detachedCommentEndPos:e.lastOrUndefined(d).end})}}return c},e.writeCommentRange=function(t,n,r,i,s,o){if(42===t.charCodeAt(i+1))for(var a=e.computeLineAndCharacterOfPosition(n,i),l=n.length,c=void 0,u=i,d=a.line;u<s;d++){var p=d+1===l?t.length+1:n[d+1];if(u!==i){void 0===c&&(c=He(t,n[a.line],i));var h=r.getIndent()*Ce()-c+He(t,u,p);if(h>0){var f=h%Ce(),m=Se((h-f)/Ce());for(r.rawWrite(m);f;)r.rawWrite(" "),f--}else r.rawWrite("")}Ve(t,s,r,o,u,p),u=p}else r.write(t.substring(i,s))},e.hasModifiers=function(e){return 0!==Ke(e)},e.hasModifier=Ge,e.getSelectedModifierFlags=je,e.getModifierFlags=Ke,e.getModifierFlagsNoCache=We,e.modifierToFlag=ze,e.isLogicalOperator=function(e){return 54===e||53===e||51===e},e.isAssignmentOperator=qe,e.tryGetClassExtendingExpressionWithTypeArguments=Je,e.isAssignmentExpression=Ye,e.isDestructuringAssignment=function(e){if(Ye(e,!0)){var t=e.left.kind;return 178===t||177===t}return!1},e.isExpressionWithTypeArgumentsInClassExtendsClause=Xe,e.isExpressionWithTypeArgumentsInClassImplementsClause=function(t){return 201===t.kind&&Qe(t.expression)&&t.parent&&108===t.parent.token&&t.parent.parent&&e.isClassLike(t.parent.parent)},e.isEntityNameExpression=Qe,e.isRightSideOfQualifiedNameOrPropertyAccess=function(e){return 143===e.parent.kind&&e.parent.right===e||179===e.parent.kind&&e.parent.name===e},e.isEmptyObjectLiteral=function(e){return 178===e.kind&&0===e.properties.length},e.isEmptyArrayLiteral=function(e){return 177===e.kind&&0===e.elements.length},e.getLocalSymbolForExportDefault=function(t){return function(t){return t&&e.length(t.declarations)>0&&Ge(t.declarations[0],512)}(t)?t.declarations[0].localSymbol:void 0},e.tryExtractTypeScriptExtension=function(t){return e.find(e.supportedTypescriptExtensionsForExtractExtension,(function(n){return e.fileExtensionIs(t,n)}))};var Ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.convertToBase64=function(t){for(var n,r,i,s,o="",a=function(t){for(var n=[],r=t.length,i=0;i<r;i++){var s=t.charCodeAt(i);s<128?n.push(s):s<2048?(n.push(s>>6|192),n.push(63&s|128)):s<65536?(n.push(s>>12|224),n.push(s>>6&63|128),n.push(63&s|128)):s<131072?(n.push(s>>18|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(63&s|128)):e.Debug.assert(!1,"Unexpected code point")}return n}(t),l=0,c=a.length;l<c;)n=a[l]>>2,r=(3&a[l])<<4|a[l+1]>>4,i=(15&a[l+1])<<2|a[l+2]>>6,s=63&a[l+2],l+1>=c?i=s=64:l+2>=c&&(s=64),o+=Ze.charAt(n)+Ze.charAt(r)+Ze.charAt(i)+Ze.charAt(s),l+=3;return o};var et;function tt(t,n,r){void 0===t&&(t=0);var i=function(t){var n=[];for(var r in t){var i=t[r];"number"==typeof i&&n.push([i,r])}return e.stableSort(n,(function(t,n){return e.compareValues(t[0],n[0])}))}(n);if(0===t)return i.length>0&&0===i[0][0]?i[0][1]:"0";if(r){for(var s="",o=t,a=i.length-1;a>=0&&0!==o;a--){var l=i[a],c=l[0],u=l[1];0!==c&&(o&c)===c&&(o&=~c,s=u+(s?", ":"")+s)}if(0===o)return s}else for(var d=0,p=i;d<p.length;d++){var h=p[d];c=h[0],u=h[1];if(c===t)return u}return t.toString()}function nt(e,t){return{pos:e,end:t}}function rt(e,t){return nt(t,e.end)}function it(e){return e.decorators&&e.decorators.length>0?rt(e,e.decorators.end):e}function st(e,t,n){return ot(at(e,n),t.end,n)}function ot(e,t,n){return e===t||De(n,e)===De(n,t)}function at(t,n){return e.positionIsSynthesized(t.pos)?-1:e.skipTrivia(n.text,t.pos)}function lt(e){return void 0!==e.initializer}function ct(e){return 33554432&e.flags?e.checkFlags:0}function ut(e){var t=e.parent;if(!t)return 0;switch(t.kind){case 193:case 192:var n=t.operator;return 43===n||44===n?o():0;case 194:var r=t,i=r.left,s=r.operatorToken;return i===e&&qe(s.kind)?o():0;case 179:return t.name!==e?0:ut(t);default:return 0}function o(){return t.parent&&210===t.parent.kind?1:2}}e.getNewLineCharacter=function(t,n){switch(t.newLine){case 0:return"\r\n";case 1:return"\n"}return n?n.newLine:e.sys?e.sys.newLine:"\r\n"},e.formatSyntaxKind=function(t){return tt(t,e.SyntaxKind,!1)},e.formatModifierFlags=function(t){return tt(t,e.ModifierFlags,!0)},e.formatTransformFlags=function(t){return tt(t,e.TransformFlags,!0)},e.formatEmitFlags=function(t){return tt(t,e.EmitFlags,!0)},e.formatSymbolFlags=function(t){return tt(t,e.SymbolFlags,!0)},e.formatTypeFlags=function(t){return tt(t,e.TypeFlags,!0)},e.formatObjectFlags=function(t){return tt(t,e.ObjectFlags,!0)},e.createRange=nt,e.moveRangeEnd=function(e,t){return nt(e.pos,t)},e.moveRangePos=rt,e.moveRangePastDecorators=it,e.moveRangePastModifiers=function(e){return e.modifiers&&e.modifiers.length>0?rt(e,e.modifiers.end):it(e)},e.isCollapsedRange=function(e){return e.pos===e.end},e.createTokenRange=function(t,n){return nt(t,t+e.tokenToString(n).length)},e.rangeIsOnSingleLine=function(e,t){return st(e,e,t)},e.rangeStartPositionsAreOnSameLine=function(e,t,n){return ot(at(e,n),at(t,n),n)},e.rangeEndPositionsAreOnSameLine=function(e,t,n){return ot(e.end,t.end,n)},e.rangeStartIsOnSameLineAsRangeEnd=st,e.rangeEndIsOnSameLineAsRangeStart=function(e,t,n){return ot(e.end,at(t,n),n)},e.positionsAreOnSameLine=ot,e.getStartPositionOfRange=at,e.isDeclarationNameOfEnumOrNamespace=function(t){var n=e.getParseTreeNode(t);if(n)switch(n.parent.kind){case 232:case 233:return n===n.parent.name}return!1},e.getInitializedVariables=function(t){return e.filter(t.declarations,lt)},e.isWatchSet=function(e){return e.watch&&e.hasOwnProperty("watch")},e.getCheckFlags=ct,e.getDeclarationModifierFlagsFromSymbol=function(t){if(t.valueDeclaration){var n=e.getCombinedModifierFlags(t.valueDeclaration);return t.parent&&32&t.parent.flags?n:-29&n}if(6&ct(t)){var r=t.checkFlags;return(256&r?8:64&r?4:16)|(512&r?32:0)}return 4194304&t.flags?36:0},e.levenshtein=function(e,t){for(var n=new Array(t.length+1),r=new Array(t.length+1),i=0;i<t.length+1;i++)n[i]=i,r[i]=-1;for(i=1;i<e.length+1;i++){r[0]=i;for(var s=1;s<t.length+1;s++)r[s]=Math.min(n[s]+1,r[s-1]+1,n[s-1]+(e[i-1]===t[s-1]?0:2));var o=n;n=r,r=o}return n[n.length-1]},e.skipAlias=function(e,t){return 2097152&e.flags?t.getAliasedSymbol(e):e},e.getCombinedLocalAndExportSymbolFlags=function(e){return e.exportSymbol?e.exportSymbol.flags|e.flags:e.flags},e.isWriteOnlyAccess=function(e){return 1===ut(e)},e.isWriteAccess=function(e){return 0!==ut(e)},function(e){e[e.Read=0]="Read",e[e.Write=1]="Write",e[e.ReadWrite=2]="ReadWrite"}(et||(et={})),e.compareDataObjects=function e(t,n){if(!t||!n||Object.keys(t).length!==Object.keys(n).length)return!1;for(var r in t)if("object"==typeof t[r]){if(!e(t[r],n[r]))return!1}else if("function"!=typeof t[r]&&t[r]!==n[r])return!1;return!0},e.clearMap=function(e,t){e.forEach(t),e.clear()},e.mutateMap=function(e,t,n){var r=n.createNewValue,i=n.onDeleteValue,s=n.onExistingValue;e.forEach((function(n,r){var o=t.get(r);void 0===o?(e.delete(r),i(n,r)):s&&s(n,o,r)})),t.forEach((function(t,n){e.has(n)||e.set(n,r(n,t))}))},e.forEachAncestorDirectory=function(t,n){for(;;){var r=n(t);if(void 0!==r)return r;var i=e.getDirectoryPath(t);if(i===t)return;t=i}}}(ts||(ts={})),function(e){function t(e){return e.start+e.length}function n(e){return 0===e.length}function r(e,t){if(e<0)throw new Error("start < 0");if(t<0)throw new Error("length < 0");return{start:e,length:t}}function i(e,t){return r(e,t-e)}function s(e,t){if(t<0)throw new Error("newLength < 0");return{span:e,newLength:t}}function o(t){return!!e.isBindingPattern(t)&&e.every(t.elements,a)}function a(t){return!!e.isOmittedExpression(t)||o(t.name)}function l(t){for(;t&&(176===t.kind||e.isBindingPattern(t));)t=t.parent;return t}function c(e,t){if(e)for(;void 0!==e.original;)e=e.original;return!t||t(e)?e:void 0}function u(e){return 0==(8&e.flags)}function d(e){var t=e;return t.length>=3&&95===t.charCodeAt(0)&&95===t.charCodeAt(1)&&95===t.charCodeAt(2)?t.substr(1):t}function p(t){var n=f(t);return e.isIdentifier(n)?n:void 0}function h(t){return t.name||function(t){var n=t.parent.parent;if(n){if(e.isDeclaration(n))return p(n);switch(n.kind){case 208:return n.declarationList&&n.declarationList.declarations[0]?p(n.declarationList.declarations[0]):void 0;case 210:var r=n.expression;switch(r.kind){case 179:return r.name;case 180:var i=r.argumentExpression;if(e.isIdentifier(i))return i}return;case 1:return;case 185:return p(n.expression);case 222:return e.isDeclaration(n.statement)||e.isExpression(n.statement)?p(n.statement):void 0;default:e.Debug.assertNever(n,"Found typedef tag attached to node which it should not be!")}}}(t)}function f(t){if(t){switch(t.kind){case 284:case 279:var n=t.name;if(143===n.kind)return n.right;break;case 194:var r=t;switch(e.getSpecialPropertyAssignmentKind(r)){case 1:case 4:case 5:case 3:return r.left.name;default:return}case 283:return h(t);case 243:var i=t.expression;return e.isIdentifier(i)?i:void 0}return t.name}}function m(t){if(t.name&&e.isIdentifier(t.name)){var n=t.name.escapedText;return g(t.parent).filter((function(t){return e.isJSDocParameterTag(t)&&e.isIdentifier(t.name)&&t.name.escapedText===n}))}}function _(e){return y(e,280)}function g(t){var n=t.jsDocCache;return void 0===n&&(t.jsDocCache=n=e.flatMap(e.getJSDocCommentsAndTags(t),(function(t){return e.isJSDoc(t)?t.tags:t}))),n}function y(t,n){var r=g(t);return e.find(r,(function(e){return e.kind===n}))}e.getDefaultLibFileName=function(e){switch(e.target){case 5:return"lib.esnext.full.d.ts";case 4:return"lib.es2017.full.d.ts";case 3:return"lib.es2016.full.d.ts";case 2:return"lib.es6.d.ts";default:return"lib.d.ts"}},e.textSpanEnd=t,e.textSpanIsEmpty=n,e.textSpanContainsPosition=function(e,n){return n>=e.start&&n<t(e)},e.textSpanContainsTextSpan=function(e,n){return n.start>=e.start&&t(n)<=t(e)},e.textSpanOverlapsWith=function(e,n){return Math.max(e.start,n.start)<Math.min(t(e),t(n))},e.textSpanOverlap=function(e,n){var r=Math.max(e.start,n.start),s=Math.min(t(e),t(n));if(r<s)return i(r,s)},e.textSpanIntersectsWithTextSpan=function(e,n){return n.start<=t(e)&&t(n)>=e.start},e.textSpanIntersectsWith=function(e,n,r){var i=n+r;return n<=t(e)&&i>=e.start},e.decodedTextSpanIntersectsWith=function(e,t,n,r){return n<=e+t&&n+r>=e},e.textSpanIntersectsWithPosition=function(e,n){return n<=t(e)&&n>=e.start},e.textSpanIntersection=function(e,n){var r=Math.max(e.start,n.start),s=Math.min(t(e),t(n));if(r<=s)return i(r,s)},e.createTextSpan=r,e.createTextSpanFromBounds=i,e.textChangeRangeNewSpan=function(e){return r(e.span.start,e.newLength)},e.textChangeRangeIsUnchanged=function(e){return n(e.span)&&0===e.newLength},e.createTextChangeRange=s,e.unchangedTextChangeRange=s(r(0,0),0),e.collapseTextChangeRangesAcrossMultipleVersions=function(n){if(0===n.length)return e.unchangedTextChangeRange;if(1===n.length)return n[0];for(var r=n[0],o=r.span.start,a=t(r.span),l=o+r.newLength,c=1;c<n.length;c++){var u=n[c],d=o,p=a,h=l,f=u.span.start,m=t(u.span),_=f+u.newLength;o=Math.min(d,f),a=Math.max(p,p+(m-h)),l=Math.max(_,_+(h-m))}return s(i(o,a),l-o)},e.getTypeParameterOwner=function(t){if(t&&145===t.kind)for(var n=t;n;n=n.parent)if(e.isFunctionLike(n)||e.isClassLike(n)||230===n.kind)return n},e.isParameterPropertyDeclaration=function(t){return e.hasModifier(t,92)&&152===t.parent.kind&&e.isClassLike(t.parent.parent)},e.isEmptyBindingPattern=o,e.isEmptyBindingElement=a,e.getCombinedModifierFlags=function(t){t=l(t);var n=e.getModifierFlags(t);return 226===t.kind&&(t=t.parent),t&&227===t.kind&&(n|=e.getModifierFlags(t),t=t.parent),t&&208===t.kind&&(n|=e.getModifierFlags(t)),n},e.getCombinedNodeFlags=function(e){var t=(e=l(e)).flags;return 226===e.kind&&(e=e.parent),e&&227===e.kind&&(t|=e.flags,e=e.parent),e&&208===e.kind&&(t|=e.flags),t},e.validateLocaleAndSetLanguage=function(t,n,r){var i=/^([a-z]+)([_\-]([a-z]+))?$/.exec(t.toLowerCase());if(i){var s=i[1];o(s,i[3],r)||o(s,void 0,r)}else r&&r.push(e.createCompilerDiagnostic(e.Diagnostics.Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1,"en","ja-jp"));function o(t,r,i){var s=e.normalizePath(n.getExecutingFilePath()),o=e.getDirectoryPath(s),a=e.combinePaths(o,t);if(r&&(a=a+"-"+r),a=n.resolvePath(e.combinePaths(a,"diagnosticMessages.generated.json")),!n.fileExists(a))return!1;var l="";try{l=n.readFile(a)}catch(t){return i&&i.push(e.createCompilerDiagnostic(e.Diagnostics.Unable_to_open_file_0,a)),!1}try{e.localizedDiagnosticMessages=JSON.parse(l)}catch(t){return i&&i.push(e.createCompilerDiagnostic(e.Diagnostics.Corrupted_locale_file_0,a)),!1}return!0}},e.getOriginalNode=c,e.isParseTreeNode=u,e.getParseTreeNode=function(e,t){return void 0===e||u(e)?e:!u(e=c(e))||t&&!t(e)?void 0:e},e.unescapeLeadingUnderscores=d,e.idText=function(e){return d(e.escapedText)},e.symbolName=function(e){return d(e.escapedName)},e.unescapeIdentifier=function(e){return e},e.getNameOfJSDocTypedef=h,e.getNameOfDeclaration=f,e.getJSDocParameterTags=m,e.hasJSDocParameterTags=function(e){return!!y(e,279)},e.getJSDocAugmentsTag=function(e){return y(e,277)},e.getJSDocClassTag=function(e){return y(e,278)},e.getJSDocReturnTag=_,e.getJSDocTemplateTag=function(e){return y(e,282)},e.getJSDocTypeTag=function(e){var t=y(e,281);if(t&&t.typeExpression&&t.typeExpression.type)return t},e.getJSDocType=function(t){var n=y(t,281);if(!n&&146===t.kind){var r=m(t);r&&(n=e.find(r,(function(e){return!!e.typeExpression})))}return n&&n.typeExpression&&n.typeExpression.type},e.getJSDocReturnType=function(e){var t=_(e);return t&&t.typeExpression&&t.typeExpression.type},e.getJSDocTags=g,e.getAllJSDocTagsOfKind=function(t,n){var r=g(t);return e.filter(r,(function(e){return e.kind===n}))}}(ts||(ts={})),function(e){e.isNumericLiteral=function(e){return 8===e.kind},e.isStringLiteral=function(e){return 9===e.kind},e.isJsxText=function(e){return 10===e.kind},e.isRegularExpressionLiteral=function(e){return 12===e.kind},e.isNoSubstitutionTemplateLiteral=function(e){return 13===e.kind},e.isTemplateHead=function(e){return 14===e.kind},e.isTemplateMiddle=function(e){return 15===e.kind},e.isTemplateTail=function(e){return 16===e.kind},e.isIdentifier=function(e){return 71===e.kind},e.isQualifiedName=function(e){return 143===e.kind},e.isComputedPropertyName=function(e){return 144===e.kind},e.isTypeParameterDeclaration=function(e){return 145===e.kind},e.isParameter=function(e){return 146===e.kind},e.isDecorator=function(e){return 147===e.kind},e.isPropertySignature=function(e){return 148===e.kind},e.isPropertyDeclaration=function(e){return 149===e.kind},e.isMethodSignature=function(e){return 150===e.kind},e.isMethodDeclaration=function(e){return 151===e.kind},e.isConstructorDeclaration=function(e){return 152===e.kind},e.isGetAccessorDeclaration=function(e){return 153===e.kind},e.isSetAccessorDeclaration=function(e){return 154===e.kind},e.isCallSignatureDeclaration=function(e){return 155===e.kind},e.isConstructSignatureDeclaration=function(e){return 156===e.kind},e.isIndexSignatureDeclaration=function(e){return 157===e.kind},e.isTypePredicateNode=function(e){return 158===e.kind},e.isTypeReferenceNode=function(e){return 159===e.kind},e.isFunctionTypeNode=function(e){return 160===e.kind},e.isConstructorTypeNode=function(e){return 161===e.kind},e.isTypeQueryNode=function(e){return 162===e.kind},e.isTypeLiteralNode=function(e){return 163===e.kind},e.isArrayTypeNode=function(e){return 164===e.kind},e.isTupleTypeNode=function(e){return 165===e.kind},e.isUnionTypeNode=function(e){return 166===e.kind},e.isIntersectionTypeNode=function(e){return 167===e.kind},e.isParenthesizedTypeNode=function(e){return 168===e.kind},e.isThisTypeNode=function(e){return 169===e.kind},e.isTypeOperatorNode=function(e){return 170===e.kind},e.isIndexedAccessTypeNode=function(e){return 171===e.kind},e.isMappedTypeNode=function(e){return 172===e.kind},e.isLiteralTypeNode=function(e){return 173===e.kind},e.isObjectBindingPattern=function(e){return 174===e.kind},e.isArrayBindingPattern=function(e){return 175===e.kind},e.isBindingElement=function(e){return 176===e.kind},e.isArrayLiteralExpression=function(e){return 177===e.kind},e.isObjectLiteralExpression=function(e){return 178===e.kind},e.isPropertyAccessExpression=function(e){return 179===e.kind},e.isElementAccessExpression=function(e){return 180===e.kind},e.isCallExpression=function(e){return 181===e.kind},e.isNewExpression=function(e){return 182===e.kind},e.isTaggedTemplateExpression=function(e){return 183===e.kind},e.isTypeAssertion=function(e){return 184===e.kind},e.isParenthesizedExpression=function(e){return 185===e.kind},e.skipPartiallyEmittedExpressions=function(e){for(;288===e.kind;)e=e.expression;return e},e.isFunctionExpression=function(e){return 186===e.kind},e.isArrowFunction=function(e){return 187===e.kind},e.isDeleteExpression=function(e){return 188===e.kind},e.isTypeOfExpression=function(e){return 191===e.kind},e.isVoidExpression=function(e){return 190===e.kind},e.isAwaitExpression=function(e){return 191===e.kind},e.isPrefixUnaryExpression=function(e){return 192===e.kind},e.isPostfixUnaryExpression=function(e){return 193===e.kind},e.isBinaryExpression=function(e){return 194===e.kind},e.isConditionalExpression=function(e){return 195===e.kind},e.isTemplateExpression=function(e){return 196===e.kind},e.isYieldExpression=function(e){return 197===e.kind},e.isSpreadElement=function(e){return 198===e.kind},e.isClassExpression=function(e){return 199===e.kind},e.isOmittedExpression=function(e){return 200===e.kind},e.isExpressionWithTypeArguments=function(e){return 201===e.kind},e.isAsExpression=function(e){return 202===e.kind},e.isNonNullExpression=function(e){return 203===e.kind},e.isMetaProperty=function(e){return 204===e.kind},e.isTemplateSpan=function(e){return 205===e.kind},e.isSemicolonClassElement=function(e){return 206===e.kind},e.isBlock=function(e){return 207===e.kind},e.isVariableStatement=function(e){return 208===e.kind},e.isEmptyStatement=function(e){return 209===e.kind},e.isExpressionStatement=function(e){return 210===e.kind},e.isIfStatement=function(e){return 211===e.kind},e.isDoStatement=function(e){return 212===e.kind},e.isWhileStatement=function(e){return 213===e.kind},e.isForStatement=function(e){return 214===e.kind},e.isForInStatement=function(e){return 215===e.kind},e.isForOfStatement=function(e){return 216===e.kind},e.isContinueStatement=function(e){return 217===e.kind},e.isBreakStatement=function(e){return 218===e.kind},e.isReturnStatement=function(e){return 219===e.kind},e.isWithStatement=function(e){return 220===e.kind},e.isSwitchStatement=function(e){return 221===e.kind},e.isLabeledStatement=function(e){return 222===e.kind},e.isThrowStatement=function(e){return 223===e.kind},e.isTryStatement=function(e){return 224===e.kind},e.isDebuggerStatement=function(e){return 225===e.kind},e.isVariableDeclaration=function(e){return 226===e.kind},e.isVariableDeclarationList=function(e){return 227===e.kind},e.isFunctionDeclaration=function(e){return 228===e.kind},e.isClassDeclaration=function(e){return 229===e.kind},e.isInterfaceDeclaration=function(e){return 230===e.kind},e.isTypeAliasDeclaration=function(e){return 231===e.kind},e.isEnumDeclaration=function(e){return 232===e.kind},e.isModuleDeclaration=function(e){return 233===e.kind},e.isModuleBlock=function(e){return 234===e.kind},e.isCaseBlock=function(e){return 235===e.kind},e.isNamespaceExportDeclaration=function(e){return 236===e.kind},e.isImportEqualsDeclaration=function(e){return 237===e.kind},e.isImportDeclaration=function(e){return 238===e.kind},e.isImportClause=function(e){return 239===e.kind},e.isNamespaceImport=function(e){return 240===e.kind},e.isNamedImports=function(e){return 241===e.kind},e.isImportSpecifier=function(e){return 242===e.kind},e.isExportAssignment=function(e){return 243===e.kind},e.isExportDeclaration=function(e){return 244===e.kind},e.isNamedExports=function(e){return 245===e.kind},e.isExportSpecifier=function(e){return 246===e.kind},e.isMissingDeclaration=function(e){return 247===e.kind},e.isExternalModuleReference=function(e){return 248===e.kind},e.isJsxElement=function(e){return 249===e.kind},e.isJsxSelfClosingElement=function(e){return 250===e.kind},e.isJsxOpeningElement=function(e){return 251===e.kind},e.isJsxClosingElement=function(e){return 252===e.kind},e.isJsxAttribute=function(e){return 253===e.kind},e.isJsxAttributes=function(e){return 254===e.kind},e.isJsxSpreadAttribute=function(e){return 255===e.kind},e.isJsxExpression=function(e){return 256===e.kind},e.isCaseClause=function(e){return 257===e.kind},e.isDefaultClause=function(e){return 258===e.kind},e.isHeritageClause=function(e){return 259===e.kind},e.isCatchClause=function(e){return 260===e.kind},e.isPropertyAssignment=function(e){return 261===e.kind},e.isShorthandPropertyAssignment=function(e){return 262===e.kind},e.isSpreadAssignment=function(e){return 263===e.kind},e.isEnumMember=function(e){return 264===e.kind},e.isSourceFile=function(e){return 265===e.kind},e.isBundle=function(e){return 266===e.kind},e.isJSDocTypeExpression=function(e){return 267===e.kind},e.isJSDocAllType=function(e){return 268===e.kind},e.isJSDocUnknownType=function(e){return 269===e.kind},e.isJSDocNullableType=function(e){return 270===e.kind},e.isJSDocNonNullableType=function(e){return 271===e.kind},e.isJSDocOptionalType=function(e){return 272===e.kind},e.isJSDocFunctionType=function(e){return 273===e.kind},e.isJSDocVariadicType=function(e){return 274===e.kind},e.isJSDoc=function(e){return 275===e.kind},e.isJSDocAugmentsTag=function(e){return 277===e.kind},e.isJSDocParameterTag=function(e){return 279===e.kind},e.isJSDocReturnTag=function(e){return 280===e.kind},e.isJSDocTypeTag=function(e){return 281===e.kind},e.isJSDocTemplateTag=function(e){return 282===e.kind},e.isJSDocTypedefTag=function(e){return 283===e.kind},e.isJSDocPropertyTag=function(e){return 284===e.kind},e.isJSDocPropertyLikeTag=function(e){return 284===e.kind||279===e.kind},e.isJSDocTypeLiteral=function(e){return 285===e.kind}}(ts||(ts={})),function(e){function t(e){return e>=143}function n(e){return 8<=e&&e<=13}function r(e){switch(e){case 117:case 120:case 76:case 124:case 79:case 84:case 114:case 112:case 113:case 131:case 115:return!0}return!1}function i(e){return e&&o(e.kind)}function s(e){switch(e){case 228:case 151:case 152:case 153:case 154:case 186:case 187:return!0;default:return!1}}function o(e){switch(e){case 150:case 155:case 156:case 157:case 160:case 273:case 161:return!0;default:return s(e)}}function a(e){switch(e.kind){case 174:case 178:return!0}return!1}function l(e){switch(e.kind){case 175:case 177:return!0}return!1}function c(e){switch(e){case 179:case 180:case 182:case 181:case 249:case 250:case 183:case 177:case 185:case 178:case 199:case 186:case 71:case 12:case 8:case 9:case 13:case 196:case 86:case 95:case 99:case 101:case 97:case 203:case 204:case 91:return!0;default:return!1}}function u(e){switch(e){case 192:case 193:case 188:case 189:case 190:case 191:case 184:return!0;default:return c(e)}}function d(t){return function(e){switch(e){case 195:case 197:case 187:case 194:case 198:case 202:case 200:case 289:case 288:return!0;default:return u(e)}}(e.skipPartiallyEmittedExpressions(t).kind)}function p(e){return 288===e.kind}function h(e){return 287===e.kind}function f(e){return 228===e||247===e||229===e||230===e||231===e||232===e||233===e||238===e||237===e||244===e||243===e||236===e}function m(e){return 218===e||217===e||225===e||212===e||210===e||209===e||215===e||216===e||214===e||211===e||222===e||219===e||221===e||223===e||224===e||208===e||213===e||220===e||287===e||291===e||290===e}function _(e){return e.kind>=276&&e.kind<=285}e.isSyntaxList=function(e){return 286===e.kind},e.isNode=function(e){return t(e.kind)},e.isNodeKind=t,e.isToken=function(e){return e.kind>=0&&e.kind<=142},e.isNodeArray=function(e){return e.hasOwnProperty("pos")&&e.hasOwnProperty("end")},e.isLiteralKind=n,e.isLiteralExpression=function(e){return n(e.kind)},e.isTemplateLiteralKind=function(e){return 13<=e&&e<=16},e.isTemplateMiddleOrTemplateTail=function(e){var t=e.kind;return 15===t||16===t},e.isStringTextContainingNode=function(e){switch(e.kind){case 9:case 14:case 15:case 16:case 13:return!0;default:return!1}},e.isGeneratedIdentifier=function(t){return e.isIdentifier(t)&&t.autoGenerateKind>0},e.isModifierKind=r,e.isModifier=function(e){return r(e.kind)},e.isEntityName=function(e){var t=e.kind;return 143===t||71===t},e.isPropertyName=function(e){var t=e.kind;return 71===t||9===t||8===t||144===t},e.isBindingName=function(e){var t=e.kind;return 71===t||174===t||175===t},e.isFunctionLike=i,e.isFunctionLikeDeclaration=function(e){return e&&s(e.kind)},e.isFunctionLikeKind=o,e.isFunctionOrModuleBlock=function(t){return e.isSourceFile(t)||e.isModuleBlock(t)||e.isBlock(t)&&i(t.parent)},e.isClassElement=function(e){var t=e.kind;return 152===t||149===t||151===t||153===t||154===t||157===t||206===t||247===t},e.isClassLike=function(e){return e&&(229===e.kind||199===e.kind)},e.isAccessor=function(e){return e&&(153===e.kind||154===e.kind)},e.isTypeElement=function(e){var t=e.kind;return 156===t||155===t||148===t||150===t||157===t||247===t},e.isObjectLiteralElementLike=function(e){var t=e.kind;return 261===t||262===t||263===t||151===t||153===t||154===t||247===t},e.isTypeNode=function(e){return(t=e.kind)>=158&&t<=173||119===t||133===t||134===t||122===t||136===t||137===t||99===t||105===t||139===t||95===t||130===t||201===t||268===t||269===t||270===t||271===t||272===t||273===t||274===t;var t},e.isFunctionOrConstructorTypeNode=function(e){switch(e.kind){case 160:case 161:return!0}return!1},e.isBindingPattern=function(e){if(e){var t=e.kind;return 175===t||174===t}return!1},e.isAssignmentPattern=function(e){var t=e.kind;return 177===t||178===t},e.isArrayBindingElement=function(e){var t=e.kind;return 176===t||200===t},e.isDeclarationBindingElement=function(e){switch(e.kind){case 226:case 146:case 176:return!0}return!1},e.isBindingOrAssignmentPattern=function(e){return a(e)||l(e)},e.isObjectBindingOrAssignmentPattern=a,e.isArrayBindingOrAssignmentPattern=l,e.isPropertyAccessOrQualifiedName=function(e){var t=e.kind;return 179===t||143===t},e.isCallLikeExpression=function(e){switch(e.kind){case 251:case 250:case 181:case 182:case 183:case 147:return!0;default:return!1}},e.isCallOrNewExpression=function(e){return 181===e.kind||182===e.kind},e.isTemplateLiteral=function(e){var t=e.kind;return 196===t||13===t},e.isLeftHandSideExpression=function(t){return c(e.skipPartiallyEmittedExpressions(t).kind)},e.isUnaryExpression=function(t){return u(e.skipPartiallyEmittedExpressions(t).kind)},e.isUnaryExpressionWithWrite=function(e){switch(e.kind){case 193:return!0;case 192:return 43===e.operator||44===e.operator;default:return!1}},e.isExpression=d,e.isAssertionExpression=function(e){var t=e.kind;return 184===t||202===t},e.isPartiallyEmittedExpression=p,e.isNotEmittedStatement=h,e.isNotEmittedOrPartiallyEmittedNode=function(e){return h(e)||p(e)},e.isIterationStatement=function e(t,n){switch(t.kind){case 214:case 215:case 216:case 212:case 213:return!0;case 222:return n&&e(t.statement,n)}return!1},e.isForInOrOfStatement=function(e){return 215===e.kind||216===e.kind},e.isConciseBody=function(t){return e.isBlock(t)||d(t)},e.isFunctionBody=function(t){return e.isBlock(t)},e.isForInitializer=function(t){return e.isVariableDeclarationList(t)||d(t)},e.isModuleBody=function(e){var t=e.kind;return 234===t||233===t||71===t},e.isNamespaceBody=function(e){var t=e.kind;return 234===t||233===t},e.isJSDocNamespaceBody=function(e){var t=e.kind;return 71===t||233===t},e.isNamedImportBindings=function(e){var t=e.kind;return 241===t||240===t},e.isModuleOrEnumDeclaration=function(e){return 233===e.kind||232===e.kind},e.isDeclaration=function(t){return 145===t.kind?282!==t.parent.kind||e.isInJavaScriptFile(t):187===(n=t.kind)||176===n||229===n||199===n||152===n||232===n||264===n||246===n||228===n||186===n||153===n||239===n||237===n||242===n||230===n||253===n||151===n||150===n||233===n||236===n||240===n||146===n||261===n||149===n||148===n||154===n||262===n||231===n||145===n||226===n||283===n;var n},e.isDeclarationStatement=function(e){return f(e.kind)},e.isStatementButNotDeclaration=function(e){return m(e.kind)},e.isStatement=function(t){var n=t.kind;return m(n)||f(n)||function(t){if(207!==t.kind)return!1;if(void 0!==t.parent&&(224===t.parent.kind||260===t.parent.kind))return!1;return!e.isFunctionBlock(t)}(t)},e.isModuleReference=function(e){var t=e.kind;return 248===t||143===t||71===t},e.isJsxTagNameExpression=function(e){var t=e.kind;return 99===t||71===t||179===t},e.isJsxChild=function(e){var t=e.kind;return 249===t||256===t||250===t||10===t},e.isJsxAttributeLike=function(e){var t=e.kind;return 253===t||255===t},e.isStringLiteralOrJsxExpression=function(e){var t=e.kind;return 9===t||256===t},e.isJsxOpeningLikeElement=function(e){var t=e.kind;return 251===t||250===t},e.isCaseOrDefaultClause=function(e){var t=e.kind;return 257===t||258===t},e.isJSDocNode=function(e){return e.kind>=267&&e.kind<=285},e.isJSDocCommentContainingNode=function(e){return 275===e.kind||_(e)},e.isJSDocTag=_,e.isSetAccessor=function(e){return 154===e.kind},e.isGetAccessor=function(e){return 153===e.kind},e.hasJSDocNodes=function(e){return!!e.jsDoc&&e.jsDoc.length>0}}(ts||(ts={})),function(e){var t,n,r,i,s,o,a;function l(e,t){return t&&e(t)}function c(e,t,n){if(n){if(t)return t(n);for(var r=0,i=n;r<i.length;r++){var s=e(i[r]);if(s)return s}}}function u(e,t,n){if(e&&!(e.kind<=142))switch(e.kind){case 143:return l(t,e.left)||l(t,e.right);case 145:return l(t,e.name)||l(t,e.constraint)||l(t,e.default)||l(t,e.expression);case 262:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||l(t,e.questionToken)||l(t,e.equalsToken)||l(t,e.objectAssignmentInitializer);case 263:return l(t,e.expression);case 146:case 149:case 148:case 261:case 226:case 176:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.propertyName)||l(t,e.dotDotDotToken)||l(t,e.name)||l(t,e.questionToken)||l(t,e.type)||l(t,e.initializer);case 160:case 161:case 155:case 156:case 157:return c(t,n,e.decorators)||c(t,n,e.modifiers)||c(t,n,e.typeParameters)||c(t,n,e.parameters)||l(t,e.type);case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.asteriskToken)||l(t,e.name)||l(t,e.questionToken)||c(t,n,e.typeParameters)||c(t,n,e.parameters)||l(t,e.type)||l(t,e.equalsGreaterThanToken)||l(t,e.body);case 159:return l(t,e.typeName)||c(t,n,e.typeArguments);case 158:return l(t,e.parameterName)||l(t,e.type);case 162:return l(t,e.exprName);case 163:return c(t,n,e.members);case 164:return l(t,e.elementType);case 165:return c(t,n,e.elementTypes);case 166:case 167:return c(t,n,e.types);case 168:case 170:return l(t,e.type);case 171:return l(t,e.objectType)||l(t,e.indexType);case 172:return l(t,e.readonlyToken)||l(t,e.typeParameter)||l(t,e.questionToken)||l(t,e.type);case 173:return l(t,e.literal);case 174:case 175:case 177:return c(t,n,e.elements);case 178:return c(t,n,e.properties);case 179:return l(t,e.expression)||l(t,e.name);case 180:return l(t,e.expression)||l(t,e.argumentExpression);case 181:case 182:return l(t,e.expression)||c(t,n,e.typeArguments)||c(t,n,e.arguments);case 183:return l(t,e.tag)||l(t,e.template);case 184:return l(t,e.type)||l(t,e.expression);case 185:case 188:case 189:case 190:return l(t,e.expression);case 192:return l(t,e.operand);case 197:return l(t,e.asteriskToken)||l(t,e.expression);case 191:return l(t,e.expression);case 193:return l(t,e.operand);case 194:return l(t,e.left)||l(t,e.operatorToken)||l(t,e.right);case 202:return l(t,e.expression)||l(t,e.type);case 203:return l(t,e.expression);case 204:return l(t,e.name);case 195:return l(t,e.condition)||l(t,e.questionToken)||l(t,e.whenTrue)||l(t,e.colonToken)||l(t,e.whenFalse);case 198:return l(t,e.expression);case 207:case 234:return c(t,n,e.statements);case 265:return c(t,n,e.statements)||l(t,e.endOfFileToken);case 208:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.declarationList);case 227:return c(t,n,e.declarations);case 210:return l(t,e.expression);case 211:return l(t,e.expression)||l(t,e.thenStatement)||l(t,e.elseStatement);case 212:return l(t,e.statement)||l(t,e.expression);case 213:return l(t,e.expression)||l(t,e.statement);case 214:return l(t,e.initializer)||l(t,e.condition)||l(t,e.incrementor)||l(t,e.statement);case 215:return l(t,e.initializer)||l(t,e.expression)||l(t,e.statement);case 216:return l(t,e.awaitModifier)||l(t,e.initializer)||l(t,e.expression)||l(t,e.statement);case 217:case 218:return l(t,e.label);case 219:return l(t,e.expression);case 220:return l(t,e.expression)||l(t,e.statement);case 221:return l(t,e.expression)||l(t,e.caseBlock);case 235:return c(t,n,e.clauses);case 257:return l(t,e.expression)||c(t,n,e.statements);case 258:return c(t,n,e.statements);case 222:return l(t,e.label)||l(t,e.statement);case 223:return l(t,e.expression);case 224:return l(t,e.tryBlock)||l(t,e.catchClause)||l(t,e.finallyBlock);case 260:return l(t,e.variableDeclaration)||l(t,e.block);case 147:return l(t,e.expression);case 229:case 199:case 230:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||c(t,n,e.typeParameters)||c(t,n,e.heritageClauses)||c(t,n,e.members);case 231:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||c(t,n,e.typeParameters)||l(t,e.type);case 232:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||c(t,n,e.members);case 264:return l(t,e.name)||l(t,e.initializer);case 233:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||l(t,e.body);case 237:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.name)||l(t,e.moduleReference);case 238:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.importClause)||l(t,e.moduleSpecifier);case 239:return l(t,e.name)||l(t,e.namedBindings);case 236:case 240:return l(t,e.name);case 241:case 245:return c(t,n,e.elements);case 244:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.exportClause)||l(t,e.moduleSpecifier);case 242:case 246:return l(t,e.propertyName)||l(t,e.name);case 243:return c(t,n,e.decorators)||c(t,n,e.modifiers)||l(t,e.expression);case 196:return l(t,e.head)||c(t,n,e.templateSpans);case 205:return l(t,e.expression)||l(t,e.literal);case 144:return l(t,e.expression);case 259:return c(t,n,e.types);case 201:return l(t,e.expression)||c(t,n,e.typeArguments);case 248:return l(t,e.expression);case 247:return c(t,n,e.decorators);case 289:return c(t,n,e.elements);case 249:return l(t,e.openingElement)||c(t,n,e.children)||l(t,e.closingElement);case 250:case 251:return l(t,e.tagName)||l(t,e.attributes);case 254:return c(t,n,e.properties);case 253:return l(t,e.name)||l(t,e.initializer);case 255:return l(t,e.expression);case 256:return l(t,e.dotDotDotToken)||l(t,e.expression);case 252:return l(t,e.tagName);case 267:case 271:case 270:case 272:return l(t,e.type);case 273:return c(t,n,e.parameters)||l(t,e.type);case 274:return l(t,e.type);case 275:return c(t,n,e.tags);case 279:case 284:return e.isNameFirst?l(t,e.name)||l(t,e.typeExpression):l(t,e.typeExpression)||l(t,e.name);case 280:case 281:return l(t,e.typeExpression);case 277:return l(t,e.class);case 282:return c(t,n,e.typeParameters);case 283:return e.typeExpression&&267===e.typeExpression.kind?l(t,e.typeExpression)||l(t,e.fullName):l(t,e.fullName)||l(t,e.typeExpression);case 285:if(e.jsDocPropertyTags)for(var r=0,i=e.jsDocPropertyTags;r<i.length;r++){l(t,i[r])}return;case 288:return l(t,e.expression)}}!function(e){e[e.None=0]="None",e[e.Yield=1]="Yield",e[e.Await=2]="Await",e[e.Type=4]="Type",e[e.RequireCompleteParameterList=8]="RequireCompleteParameterList",e[e.IgnoreMissingOpenBrace=16]="IgnoreMissingOpenBrace",e[e.JSDoc=32]="JSDoc"}(t||(t={})),e.createNode=function(t,o,a){return 265===t?new(s||(s=e.objectAllocator.getSourceFileConstructor()))(t,o,a):71===t?new(i||(i=e.objectAllocator.getIdentifierConstructor()))(t,o,a):e.isNodeKind(t)?new(n||(n=e.objectAllocator.getNodeConstructor()))(t,o,a):new(r||(r=e.objectAllocator.getTokenConstructor()))(t,o,a)},e.forEachChild=u,e.createSourceFile=function(t,n,r,i,s){void 0===i&&(i=!1),e.performance.mark("beforeParse");var a=o.parseSourceFile(t,n,r,void 0,i,s);return e.performance.mark("afterParse"),e.performance.measure("Parse","beforeParse","afterParse"),a},e.parseIsolatedEntityName=function(e,t){return o.parseIsolatedEntityName(e,t)},e.parseJsonText=function(e,t){return o.parseJsonText(e,t)},e.isExternalModule=function(e){return void 0!==e.externalModuleIndicator},e.updateSourceFile=function(e,t,n,r){var i=a.updateSourceFile(e,t,n,r);return i.flags|=524288&e.flags,i},e.parseIsolatedJSDocComment=function(e,t,n){var r=o.JSDocParser.parseIsolatedJSDocComment(e,t,n);return r&&r.jsDoc&&o.fixupParentReferences(r.jsDoc),r},e.parseJSDocTypeExpressionForTests=function(e,t,n){return o.JSDocParser.parseJSDocTypeExpressionForTests(e,t,n)},function(t){var n,r,i,s,o,a,l,c,d,p,h,f,m,_,g,y,b,v=e.createScanner(5,!0),T=10240,k=!1;function E(e){return 4===e||2===e||1===e||6===e?1:0}function x(t,o,c,u){n=e.objectAllocator.getNodeConstructor(),r=e.objectAllocator.getTokenConstructor(),i=e.objectAllocator.getIdentifierConstructor(),s=e.objectAllocator.getSourceFileConstructor(),d=t,l=c,a=[],m=0,h=e.createMap(),f=0,p=0,_=1===u||2===u||6===u?65536:0,k=!1,v.setText(d),v.setOnError(K),v.setScriptTarget(o),v.setLanguageVariant(E(u))}function S(){v.setText(""),v.setOnError(void 0),a=void 0,o=void 0,h=void 0,l=void 0,d=void 0}function C(t){var n=e.getJSDocCommentRanges(t,o.text);if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],a=b.parseJSDocComment(t,s.pos,s.end-s.pos);a&&(t.jsDoc||(t.jsDoc=[]),t.jsDoc.push(a))}return t}function I(t){var n=t;return void u(t,(function t(r){if(r.parent!==n){r.parent=n;var i=n;if(n=r,u(r,t),e.hasJSDocNodes(r))for(var s=0,o=r.jsDoc;s<o.length;s++){var a=o[s];a.parent=r,n=a,u(a,t)}n=i}}))}function A(t,n,r){var i=new s(265,0,d.length);return p++,i.text=d,i.bindDiagnostics=[],i.languageVersion=n,i.fileName=e.normalizePath(t),i.languageVariant=E(r),i.isDeclarationFile=e.fileExtensionIs(i.fileName,".d.ts"),i.scriptKind=r,i}function w(e,t){e?_|=t:_&=~t}function N(e){w(e,2048)}function D(e){w(e,4096)}function O(e){w(e,8192)}function R(e){w(e,16384)}function L(e,t){var n=e&_;if(n){w(!1,n);var r=t();return w(!0,n),r}return t()}function P(e,t){var n=e&~_;if(n){w(!0,n);var r=t();return w(!1,n),r}return t()}function M(e){return L(2048,e)}function F(e){return P(16384,e)}function $(e){return 0!=(_&e)}function B(){return $(4096)}function U(){return $(2048)}function V(){return $(8192)}function H(){return $(16384)}function G(e,t){var n=v.getTokenPos();j(n,v.getTextPos()-n,e,t)}function j(t,n,r,i){var s=e.lastOrUndefined(a);s&&t===s.start||a.push(e.createFileDiagnostic(o,t,n,r,i)),k=!0}function K(e,t){j(v.getTextPos(),t||0,e)}function W(){return v.getStartPos()}function z(){return c}function q(){return c=v.scan()}function J(){return c=v.reScanGreaterToken()}function Y(){return c=v.scanJsxIdentifier()}function X(){return c=v.scanJsxToken()}function Q(t,n){var r=c,i=a.length,s=k,o=_,l=n?v.lookAhead(t):v.tryScan(t);return e.Debug.assert(o===_),l&&!n||(c=r,a.length=i,k=s),l}function Z(e){return Q(e,!0)}function ee(e){return Q(e,!1)}function te(){return 71===z()||(116!==z()||!B())&&((121!==z()||!H())&&z()>107)}function ne(t,n,r){return void 0===r&&(r=!0),z()===t?(r&&q(),!0):(n?G(n):G(e.Diagnostics._0_expected,e.tokenToString(t)),!1)}function re(e){return z()===e&&(q(),!0)}function ie(e){if(z()===e)return oe()}function se(e,t,n,r){return ie(e)||pe(e,t,n,r)}function oe(){var e=ce(z());return q(),de(e)}function ae(){return 25===z()||(18===z()||1===z()||v.hasPrecedingLineBreak())}function le(){return ae()?(25===z()&&q(),!0):ne(25)}function ce(t,s){return p++,s>=0||(s=v.getStartPos()),e.isNodeKind(t)?new n(t,s,s):71===t?new i(t,s,s):new r(t,s,s)}function ue(e,t,n){var r=e.length,i=r>=1&&r<=4?e.slice():e;return i.pos=t,i.end=void 0===n?v.getStartPos():n,i}function de(e,t){return e.end=void 0===t?v.getStartPos():t,_&&(e.flags|=_),k&&(k=!1,e.flags|=32768),e}function pe(t,n,r,i){n?j(v.getStartPos(),0,r,i):G(r,i);var s=ce(t,v.getStartPos());return 71===t?s.escapedText="":(e.isLiteralKind(t)||e.isTemplateLiteralKind(t))&&(s.text=""),de(s)}function he(e){var t=h.get(e);return void 0===t&&h.set(e,t=e),t}function fe(t,n){if(f++,t){var r=ce(71);return 71!==z()&&(r.originalKeywordKind=z()),r.escapedText=e.escapeLeadingUnderscores(he(v.getTokenValue())),q(),de(r)}return pe(71,1===z(),n||e.Diagnostics.Identifier_expected)}function me(e){return fe(te(),e)}function _e(t){return fe(e.tokenIsIdentifierOrKeyword(z()),t)}function ge(){return e.tokenIsIdentifierOrKeyword(z())||9===z()||8===z()}function ye(e){if(9===z()||8===z()){var t=je();return t.text=he(t.text),t}return e&&21===z()?function(){var e=ce(144);return ne(21),e.expression=M(Nt),ne(22),de(e)}():_e()}function be(){return ye(!0)}function ve(e){return z()===e&&ee(ke)}function Te(){return q(),!v.hasPrecedingLineBreak()&&Ee()}function ke(){return 76===z()?83===q():84===z()?(q(),79===z()?Z(xe):39!==z()&&118!==z()&&17!==z()&&Ee()):79===z()?xe():115===z()?(q(),Ee()):Te()}function Ee(){return 21===z()||17===z()||39===z()||24===z()||ge()}function xe(){return q(),75===z()||89===z()||109===z()||117===z()&&Z(vn)||120===z()&&Z(Tn)}function Se(t,n){if(Le(t))return!0;switch(t){case 0:case 1:case 3:return!(25===z()&&n)&&Sn();case 2:return 73===z()||79===z();case 4:return Z(ot);case 5:return Z(Kn)||25===z()&&!n;case 6:return 21===z()||ge();case 12:return 21===z()||39===z()||24===z()||ge();case 17:return ge();case 9:return 21===z()||24===z()||ge();case 7:return 17===z()?Z(Ce):n?te()&&!we():At()&&!we();case 8:return Rn();case 10:return 26===z()||24===z()||Rn();case 18:return te();case 11:case 15:return 26===z()||24===z()||wt();case 16:return Qe();case 19:case 20:return 26===z()||gt();case 21:return nr();case 22:return e.tokenIsIdentifierOrKeyword(z());case 13:return e.tokenIsIdentifierOrKeyword(z())||17===z();case 14:return!0}e.Debug.fail("Non-exhaustive case in 'isListElement'.")}function Ce(){if(e.Debug.assert(17===z()),18===q()){var t=q();return 26===t||17===t||85===t||108===t}return!0}function Ie(){return q(),te()}function Ae(){return q(),e.tokenIsIdentifierOrKeyword(z())}function we(){return(108===z()||85===z())&&Z(Ne)}function Ne(){return q(),wt()}function De(e){if(1===z())return!0;switch(e){case 1:case 2:case 4:case 5:case 6:case 12:case 9:case 22:return 18===z();case 3:return 18===z()||73===z()||79===z();case 7:return 17===z()||85===z()||108===z();case 8:return function(){if(ae())return!0;if(Ut(z()))return!0;if(36===z())return!0;return!1}();case 18:return 29===z()||19===z()||17===z()||85===z()||108===z();case 11:return 20===z()||25===z();case 15:case 20:case 10:return 22===z();case 16:case 17:return 20===z()||22===z();case 19:return 26!==z();case 21:return 17===z()||18===z();case 13:return 29===z()||41===z();case 14:return 27===z()&&Z(lr)}}function Oe(e,t){var n=m;m|=1<<e;for(var r=[],i=W();!De(e);)if(Se(e,!1)){var s=Re(e,t);r.push(s)}else if(Pe(e))break;return m=n,ue(r,i)}function Re(e,t){var n=Le(e);return n?function(e){return v.setTextPos(e.end),q(),e}(n):t()}function Le(t){if(!k&&l){var n=l.currentNode(v.getStartPos());if(!e.nodeIsMissing(n))if(!n.intersectsChange)if(!e.containsParseError(n))if((96256&n.flags)===_&&function(e,t){switch(t){case 5:return function(e){if(e)switch(e.kind){case 152:case 157:case 153:case 154:case 149:case 206:return!0;case 151:var t=e;return!(71===t.name.kind&&123===t.name.originalKeywordKind)}return!1}(e);case 2:return function(e){if(e)switch(e.kind){case 257:case 258:return!0}return!1}(e);case 0:case 1:case 3:return function(e){if(e)switch(e.kind){case 228:case 208:case 207:case 211:case 210:case 223:case 219:case 221:case 218:case 217:case 215:case 216:case 214:case 213:case 220:case 209:case 224:case 222:case 212:case 225:case 238:case 237:case 244:case 243:case 233:case 229:case 230:case 232:case 231:return!0}return!1}(e);case 6:return function(e){return 264===e.kind}(e);case 4:return function(e){if(e)switch(e.kind){case 156:case 150:case 157:case 148:case 155:return!0}return!1}(e);case 8:return function(e){if(226!==e.kind)return!1;return void 0===e.initializer}(e);case 16:return function(e){if(146!==e.kind)return!1;return void 0===e.initializer}(e);case 17:return!1}return!1}(n,t))return n}}function Pe(t){return G(function(t){switch(t){case 0:case 1:return e.Diagnostics.Declaration_or_statement_expected;case 2:return e.Diagnostics.case_or_default_expected;case 3:return e.Diagnostics.Statement_expected;case 17:case 4:return e.Diagnostics.Property_or_signature_expected;case 5:return e.Diagnostics.Unexpected_token_A_constructor_method_accessor_or_property_was_expected;case 6:return e.Diagnostics.Enum_member_expected;case 7:return e.Diagnostics.Expression_expected;case 8:return e.Diagnostics.Variable_declaration_expected;case 9:return e.Diagnostics.Property_destructuring_pattern_expected;case 10:return e.Diagnostics.Array_element_destructuring_pattern_expected;case 11:return e.Diagnostics.Argument_expression_expected;case 12:return e.Diagnostics.Property_assignment_expected;case 15:return e.Diagnostics.Expression_or_comma_expected;case 16:return e.Diagnostics.Parameter_declaration_expected;case 18:return e.Diagnostics.Type_parameter_declaration_expected;case 19:return e.Diagnostics.Type_argument_expected;case 20:return e.Diagnostics.Type_expected;case 21:return e.Diagnostics.Unexpected_token_expected;case 22:case 13:case 14:return e.Diagnostics.Identifier_expected}}(t)),!!function(){for(var e=0;e<23;e++)if(m&1<<e&&(Se(e,!0)||De(e)))return!0;return!1}()||(q(),!1)}function Me(e,t,n){var r=m;m|=1<<e;for(var i=[],s=W(),o=-1;;)if(Se(e,!1)){var a=v.getStartPos();if(i.push(Re(e,t)),o=v.getTokenPos(),re(26))continue;if(o=-1,De(e))break;ne(26),n&&25===z()&&!v.hasPrecedingLineBreak()&&q(),a===v.getStartPos()&&q()}else{if(De(e))break;if(Pe(e))break}m=r;var l=ue(i,s);return o>=0&&(l.hasTrailingComma=!0),l}function Fe(){return ue([],W())}function $e(e,t,n,r){if(ne(n)){var i=Me(e,t);return ne(r),i}return Fe()}function Be(e,t){for(var n=e?_e(t):me(t),r=v.getStartPos();re(23);){if(27===z()){n.jsdocDotPos=r;break}r=v.getStartPos(),n=Ue(n,Ve(e))}return n}function Ue(e,t){var n=ce(143,e.pos);return n.left=e,n.right=t,de(n)}function Ve(t){if(v.hasPrecedingLineBreak()&&e.tokenIsIdentifierOrKeyword(z())&&Z(bn))return pe(71,!0,e.Diagnostics.Identifier_expected);return t?_e():me()}function He(){var t,n=ce(196);n.head=(t=Ke(z()),e.Debug.assert(14===t.kind,"Template head has wrong token kind"),t),e.Debug.assert(14===n.head.kind,"Template head has wrong token kind");var r=[],i=W();do{r.push(Ge())}while(15===e.lastOrUndefined(r).literal.kind);return n.templateSpans=ue(r,i),de(n)}function Ge(){var t,n,r=ce(205);return r.expression=M(Nt),18===z()?(c=v.reScanTemplateToken(),n=Ke(z()),e.Debug.assert(15===n.kind||16===n.kind,"Template fragment has wrong token kind"),t=n):t=se(16,!1,e.Diagnostics._0_expected,e.tokenToString(18)),r.literal=t,de(r)}function je(){return Ke(z())}function Ke(e){var t=ce(e),n=v.getTokenValue();return t.text=n,v.hasExtendedUnicodeEscape()&&(t.hasExtendedUnicodeEscape=!0),v.isUnterminated()&&(t.isUnterminated=!0),8===t.kind&&(t.numericLiteralFlags=v.getNumericLiteralFlags()),q(),de(t),t}function We(){var t=ce(159);return t.typeName=Be(!0,e.Diagnostics.Type_expected),v.hasPrecedingLineBreak()||27!==z()||(t.typeArguments=$e(19,St,27,29)),de(t)}function ze(){var e=ce(146);return 99!==z()&&94!==z()||(e.name=_e(),ne(56)),e.type=St(),de(e)}function qe(e){var t=ce(e);return q(),t.type=_t(),de(t)}function Je(){var e=ce(145);return e.name=me(),re(85)&&(gt()||!wt()?e.constraint=St():e.expression=Kt()),re(58)&&(e.default=St()),de(e)}function Ye(){if(27===z())return $e(18,Je,27,29)}function Xe(){if(re(56))return St()}function Qe(){return 24===z()||Rn()||e.isModifierKind(z())||57===z()||gt(!0)}function Ze(t){var n=ce(146);return 99===z()?(n.name=fe(!0),n.type=Xe(),de(n)):(n.decorators=Wn(),n.modifiers=zn(),n.dotDotDotToken=ie(24),n.name=Ln(),0===e.getFullWidth(n.name)&&!e.hasModifiers(n)&&e.isModifierKind(z())&&q(),n.questionToken=ie(55),n.type=Xe(),n.initializer=Dt(!0,t),C(de(n)))}function et(t,n,r){32&n||(r.typeParameters=Ye()),r.parameters=function(e){if(ne(19)){var t=B(),n=H();D(!!(1&e)),R(!!(2&e));var r=Me(16,32&e?ze:function(){return Ze(!!(8&e))});if(D(t),R(n),!ne(20)&&8&e)return;return r}return 8&e?void 0:Fe()}(n),r.type=function(t,n){return function(t,n){if(36===t)return ne(t),!0;if(re(56))return!0;if(n&&36===z())return G(e.Diagnostics._0_expected,e.tokenToString(56)),q(),!0;return!1}(t,n)?function(){var e=te()&&ee(xt),t=St();if(e){var n=ce(158,e.pos);return n.parameterName=e,n.type=t,de(n)}return t}():void 0}(t,!!(4&n))}function tt(){re(26)||le()}function nt(e){var t=ce(e);return 156===e&&ne(94),et(56,4,t),tt(),C(de(t))}function rt(){return 21===z()&&Z(it)}function it(){if(q(),24===z()||22===z())return!0;if(e.isModifierKind(z())){if(q(),te())return!0}else{if(!te())return!1;q()}return 56===z()||26===z()||55===z()&&(q(),56===z()||26===z()||22===z())}function st(e,t,n){var r=ce(157,e);return r.decorators=t,r.modifiers=n,r.parameters=$e(16,Ze,21,22),r.type=It(),tt(),C(de(r))}function ot(){if(19===z()||27===z())return!0;for(var t;e.isModifierKind(z());)t=!0,q();return 21===z()||(ge()&&(t=!0,q()),!!t&&(19===z()||27===z()||55===z()||56===z()||26===z()||ae()))}function at(){if(19===z()||27===z())return nt(155);if(94===z()&&Z(lt))return nt(156);var e=W(),t=zn();return rt()?st(e,void 0,t):function(e,t){var n=be(),r=ie(55);if(19===z()||27===z()){var i=ce(150,e);return i.modifiers=t,i.name=n,i.questionToken=r,et(56,4,i),tt(),C(de(i))}var s=ce(148,e);return s.modifiers=t,s.name=n,s.questionToken=r,s.type=It(),58===z()&&(s.initializer=Hn()),tt(),C(de(s))}(e,t)}function lt(){return q(),19===z()||27===z()}function ct(){var e;return ne(17)?(e=Oe(4,at),ne(18)):e=Fe(),e}function ut(){return q(),131===z()&&q(),21===z()&&Ie()&&92===q()}function dt(){var e=ce(172);return ne(17),e.readonlyToken=ie(131),ne(21),e.typeParameter=function(){var e=ce(145);return e.name=me(),ne(92),e.constraint=St(),de(e)}(),ne(22),e.questionToken=ie(55),e.type=It(),le(),ne(18),de(e)}function pt(e){var t=ce(e);return 161===e&&ne(94),et(36,4,t),C(de(t))}function ht(){var e=oe();return 23===z()?void 0:e}function ft(e){var t,n=ce(173);e&&((t=ce(192)).operator=38,q());var r=101===z()||86===z()?oe():Ke(z());return e&&(t.operand=r,de(t),r=t),n.literal=r,de(n)}function mt(){return 8===q()}function _t(){switch(z()){case 119:case 136:case 133:case 122:case 137:case 139:case 130:case 134:return ee(ht)||We();case 39:return n=ce(268),q(),de(n);case 55:return function(){var e,t=v.getStartPos();return q(),26===z()||18===z()||20===z()||29===z()||58===z()||49===z()?de(e=ce(269,t)):((e=ce(270,t)).type=St(),de(e))}();case 89:return function(){if(Z(ar)){var e=ce(273);return q(),et(56,36,e),C(de(e))}var t=ce(159);return t.typeName=_e(),de(t)}();case 24:return qe(274);case 51:return qe(271);case 13:case 9:case 8:case 101:case 86:return ft();case 38:return Z(mt)?ft(!0):We();case 105:case 95:return oe();case 99:var e=(t=ce(169),q(),de(t));return 126!==z()||v.hasPrecedingLineBreak()?e:function(e){q();var t=ce(158,e.pos);return t.parameterName=e,t.type=St(),de(t)}(e);case 103:return function(){var e=ce(162);return ne(103),e.exprName=Be(!0),de(e)}();case 17:return Z(ut)?dt():function(){var e=ce(163);return e.members=ct(),de(e)}();case 21:return function(){var e=ce(165);return e.elementTypes=$e(20,St,21,22),de(e)}();case 19:return function(){var e=ce(168);return ne(19),e.type=St(),ne(20),de(e)}();default:return We()}var t,n}function gt(e){switch(z()){case 119:case 136:case 133:case 122:case 137:case 105:case 139:case 95:case 99:case 103:case 130:case 17:case 21:case 27:case 49:case 48:case 94:case 9:case 8:case 101:case 86:case 134:case 39:case 55:case 51:case 24:return!0;case 38:return!e&&Z(mt);case 19:return!e&&Z(yt);default:return te()}}function yt(){return q(),20===z()||Qe()||gt()}function bt(e,t){q();var n=ce(e,t.pos);return n.type=t,de(n)}function vt(){switch(z()){case 127:return e=127,t=ce(170),ne(e),t.operator=e,t.type=vt(),de(t)}var e,t;return function(){for(var e=_t();!v.hasPrecedingLineBreak();)switch(z()){case 58:if(!(1048576&_))return e;e=bt(272,e);break;case 51:e=bt(271,e);break;case 55:e=bt(270,e);break;case 21:var t;ne(21),gt()?((t=ce(171,e.pos)).objectType=e,t.indexType=St(),ne(22),e=de(t)):((t=ce(164,e.pos)).elementType=e,ne(22),e=de(t));break;default:return e}return e}()}function Tt(e,t,n){re(n);var r=t();if(z()===n){for(var i=[r];re(n);)i.push(t());var s=ce(e,r.pos);s.types=ue(i,r.pos),r=de(s)}return r}function kt(){return Tt(167,vt,48)}function Et(){if(q(),20===z()||24===z())return!0;if(function(){if(e.isModifierKind(z())&&zn(),te()||99===z())return q(),!0;if(21===z()||17===z()){var t=a.length;return Ln(),t===a.length}return!1}()){if(56===z()||26===z()||55===z()||58===z())return!0;if(20===z()&&(q(),36===z()))return!0}return!1}function xt(){var e=me();if(126===z()&&!v.hasPrecedingLineBreak())return q(),e}function St(){return L(20480,Ct)}function Ct(){return 27===z()||19===z()&&Z(Et)?pt(160):94===z()?pt(161):Tt(166,kt,49)}function It(){return re(56)?St():void 0}function At(){switch(z()){case 99:case 97:case 95:case 101:case 86:case 8:case 9:case 13:case 14:case 19:case 21:case 17:case 89:case 75:case 94:case 41:case 63:case 71:return!0;case 91:return Z(lt);default:return te()}}function wt(){if(At())return!0;switch(z()){case 37:case 38:case 52:case 51:case 80:case 103:case 105:case 43:case 44:case 27:case 121:case 116:return!0;default:return!!function(){if(U()&&92===z())return!1;return Ht()>0}()||te()}}function Nt(){var e=V();e&&O(!1);for(var t,n=Ot();t=ie(26);)n=Gt(n,t,Ot());return e&&O(!0),n}function Dt(t,n){if(58!==z()){if(v.hasPrecedingLineBreak()||t&&17===z()||!wt())return;if(t&&n){var r=pe(71,!0,e.Diagnostics._0_expected,"=");return r.escapedText="= not found",r}}return ne(58),Ot()}function Ot(){if(function(){if(116===z())return!!B()||Z(kn);return!1}())return t=ce(197),q(),v.hasPrecedingLineBreak()||39!==z()&&!wt()||(t.asteriskToken=ie(39),t.expression=Ot()),de(t);var t,n=function(){var t=function(){if(19===z()||27===z()||120===z())return Z(Lt);if(36===z())return 1;return 0}();if(0===t)return;var n=1===t?Ft(!0):ee(Pt);if(!n)return;var r=e.hasModifier(n,256),i=z();return n.equalsGreaterThanToken=se(36,!1,e.Diagnostics._0_expected,"=>"),n.body=36===i||17===i?$t(r):me(),C(de(n))}()||function(){if(120===z()&&1===Z(Mt)){var e=qn();return Rt(Bt(0),e)}return}();if(n)return n;var r=Bt(0);return 71===r.kind&&36===z()?Rt(r):e.isLeftHandSideExpression(r)&&e.isAssignmentOperator(J())?Gt(r,oe(),Ot()):function(t){var n=ie(55);if(!n)return t;var r=ce(195,t.pos);return r.condition=t,r.questionToken=n,r.whenTrue=L(T,Ot),r.colonToken=se(56,!1,e.Diagnostics._0_expected,e.tokenToString(56)),r.whenFalse=Ot(),de(r)}(r)}function Rt(t,n){var r;e.Debug.assert(36===z(),"parseSimpleArrowFunctionExpression should only have been called if we had a =>"),n?(r=ce(187,n.pos)).modifiers=n:r=ce(187,t.pos);var i=ce(146,t.pos);return i.name=t,de(i),r.parameters=ue([i],i.pos,i.end),r.equalsGreaterThanToken=se(36,!1,e.Diagnostics._0_expected,"=>"),r.body=$t(!!n),C(de(r))}function Lt(){if(120===z()){if(q(),v.hasPrecedingLineBreak())return 0;if(19!==z()&&27!==z())return 0}var t=z(),n=q();if(19===t){if(20===n)switch(q()){case 36:case 56:case 17:return 1;default:return 0}return 21===n||17===n?2:24===n?1:te()?56===q()?1:2:0}return e.Debug.assert(27===t),te()?1===o.languageVariant?Z((function(){var e=q();if(85===e)switch(q()){case 58:case 29:return!1;default:return!0}else if(26===e)return!0;return!1}))?1:0:2:0}function Pt(){return Ft(!1)}function Mt(){if(120===z()){if(q(),v.hasPrecedingLineBreak()||36===z())return 0;var e=Bt(0);if(!v.hasPrecedingLineBreak()&&71===e.kind&&36===z())return 1}return 0}function Ft(t){var n=ce(187);if(n.modifiers=qn(),et(56,(e.hasModifier(n,256)?2:0)|(t?0:8),n),n.parameters&&(t||!(36!==z()&&17!==z()||e.find(n.parameters,(function(t){return t.initializer&&e.isIdentifier(t.initializer)&&"= not found"===t.initializer.escapedText})))))return n}function $t(e){return 17===z()?fn(e?2:0):25===z()||89===z()||75===z()||!Sn()||17!==z()&&89!==z()&&75!==z()&&57!==z()&&wt()?e?F(Ot):L(16384,Ot):fn(16|(e?2:0))}function Bt(e){return Vt(e,Kt())}function Ut(e){return 92===e||142===e}function Vt(e,t){for(;;){J();var n=Ht();if(!(40===z()?n>=e:n>e))break;if(92===z()&&U())break;if(118===z()){if(v.hasPrecedingLineBreak())break;q(),t=jt(t,St())}else t=Gt(t,oe(),Bt(n))}return t}function Ht(){switch(z()){case 54:return 1;case 53:return 2;case 49:return 3;case 50:return 4;case 48:return 5;case 32:case 33:case 34:case 35:return 6;case 27:case 29:case 30:case 31:case 93:case 92:case 118:return 7;case 45:case 46:case 47:return 8;case 37:case 38:return 9;case 39:case 41:case 42:return 10;case 40:return 11}return-1}function Gt(e,t,n){var r=ce(194,e.pos);return r.left=e,r.operatorToken=t,r.right=n,de(r)}function jt(e,t){var n=ce(202,e.pos);return n.expression=e,n.type=t,de(n)}function Kt(){if(function(){switch(z()){case 37:case 38:case 52:case 51:case 80:case 103:case 105:case 121:return!1;case 27:if(1!==o.languageVariant)return!1;default:return!0}}()){var t=zt();return 40===z()?Vt(Ht(),t):t}var n=z(),r=Wt();if(40===z()){var i=e.skipTrivia(d,r.pos);184===r.kind?j(i,r.end-i,e.Diagnostics.A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses):j(i,r.end-i,e.Diagnostics.An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses,e.tokenToString(n))}return r}function Wt(){switch(z()){case 37:case 38:case 52:case 51:return(e=ce(192)).operator=z(),q(),e.operand=Wt(),de(e);case 80:return function(){var e=ce(188);return q(),e.expression=Wt(),de(e)}();case 103:return function(){var e=ce(189);return q(),e.expression=Wt(),de(e)}();case 105:return function(){var e=ce(190);return q(),e.expression=Wt(),de(e)}();case 27:return function(){var e=ce(184);return ne(27),e.type=St(),ne(29),e.expression=Wt(),de(e)}();case 121:if(121===z()&&(H()||Z(kn)))return function(){var e=ce(191);return q(),e.expression=Wt(),de(e)}();default:return zt()}var e}function zt(){if(43===z()||44===z())return(t=ce(192)).operator=z(),q(),t.operand=qt(),de(t);if(1===o.languageVariant&&27===z()&&Z(Ae))return Xt(!0);var t,n=qt();return e.Debug.assert(e.isLeftHandSideExpression(n)),43!==z()&&44!==z()||v.hasPrecedingLineBreak()?n:((t=ce(193,n.pos)).operand=n,t.operator=z(),q(),de(t))}function qt(){var t;return 91===z()&&Z(lt)?(o.flags|=524288,t=oe()):t=97===z()?function(){var t=oe();if(19===z()||23===z()||21===z())return t;var n=ce(179,t.pos);return n.expression=t,se(23,!1,e.Diagnostics.super_must_be_followed_by_an_argument_list_or_member_access),n.name=Ve(!0),de(n)}():Jt(),function(e){for(;;)if(e=nn(e),27!==z()){if(19!==z())return e;(t=ce(181,e.pos)).expression=e,t.arguments=rn(),e=de(t)}else{var t,n=ee(sn);if(!n)return e;(t=ce(181,e.pos)).expression=e,t.typeArguments=n,t.arguments=rn(),e=de(t)}}(t)}function Jt(){return nn(function(){switch(z()){case 8:case 9:case 13:return je();case 99:case 97:case 95:case 101:case 86:return oe();case 19:return t=ce(185),ne(19),t.expression=M(Nt),ne(20),C(de(t));case 21:return function(){var e=ce(177);ne(21),v.hasPrecedingLineBreak()&&(e.multiLine=!0);return e.elements=Me(15,on),ne(22),de(e)}();case 17:return un();case 120:if(!Z(Tn))break;return dn();case 75:return Xn(v.getStartPos(),void 0,void 0,199);case 89:return dn();case 94:return function(){var e=v.getStartPos();if(ne(94),re(23)){var t=ce(204,e);return t.keywordToken=94,t.name=_e(),de(t)}var n=ce(182,e);n.expression=Jt(),n.typeArguments=ee(sn),(n.typeArguments||19===z())&&(n.arguments=rn());return de(n)}();case 41:case 63:if(12===(c=v.reScanSlashToken()))return je();break;case 14:return He()}var t;return me(e.Diagnostics.Expression_expected)}())}function Yt(e,t){return e.kind===t.kind&&(71===e.kind?e.escapedText===t.escapedText:99===e.kind||e.name.escapedText===t.name.escapedText&&Yt(e.expression,t.expression))}function Xt(t){var n,r=function(e){var t=v.getStartPos();ne(27);var n,r=Zt(),i=(s=ce(254),s.properties=Oe(13,tn),de(s));var s;29===z()?(n=ce(251,t),X()):(ne(41),e?ne(29):(ne(29,void 0,!1),X()),n=ce(250,t));return n.tagName=r,n.attributes=i,de(n)}(t);if(251===r.kind){var i=ce(249,r.pos);i.openingElement=r,i.children=function(t){var n=[],r=W(),i=m;m|=16384;for(;c=v.reScanJsxToken(),28!==z();){if(1===z()){j(t.pos,t.end-t.pos,e.Diagnostics.JSX_element_0_has_no_corresponding_closing_tag,e.getTextOfNodeFromSourceText(d,t));break}if(7===z())break;var s=Qt();s&&n.push(s)}return m=i,ue(n,r)}(i.openingElement.tagName),i.closingElement=function(e){var t=ce(252);ne(28),t.tagName=Zt(),e?ne(29):(ne(29,void 0,!1),X());return de(t)}(t),Yt(i.openingElement.tagName,i.closingElement.tagName)||j(i.closingElement.pos,i.closingElement.end-i.closingElement.pos,e.Diagnostics.Expected_corresponding_JSX_closing_tag_for_0,e.getTextOfNodeFromSourceText(d,i.openingElement.tagName)),n=de(i)}else e.Debug.assert(250===r.kind),n=r;if(t&&27===z()){var s=ee((function(){return Xt(!0)}));if(s){G(e.Diagnostics.JSX_expressions_must_have_one_parent_element);var o=ce(194,n.pos);return o.end=s.end,o.left=n,o.right=s,o.operatorToken=pe(26,!1,void 0),o.operatorToken.pos=o.operatorToken.end=o.right.pos,o}}return n}function Qt(){switch(z()){case 10:case 11:return(t=ce(10,v.getStartPos())).containsOnlyWhiteSpaces=11===c,c=v.scanJsxToken(),de(t);case 17:return en(!1);case 27:return Xt(!1)}var t;e.Debug.fail("Unknown JSX child kind "+z())}function Zt(){Y();for(var e=99===z()?oe():_e();re(23);){var t=ce(179,e.pos);t.expression=e,t.name=Ve(!0),e=de(t)}return e}function en(e){var t=ce(256);return ne(17),18!==z()&&(t.dotDotDotToken=ie(24),t.expression=Ot()),e?ne(18):(ne(18,void 0,!1),X()),de(t)}function tn(){if(17===z())return function(){var e=ce(255);return ne(17),ne(24),e.expression=Nt(),ne(18),de(e)}();Y();var e=ce(253);if(e.name=_e(),58===z())switch(c=v.scanJsxAttributeValue()){case 9:e.initializer=je();break;default:e.initializer=en(!0)}return de(e)}function nn(e){for(;;){if(ie(23)){var t=ce(179,e.pos);t.expression=e,t.name=Ve(!0),e=de(t)}else if(51!==z()||v.hasPrecedingLineBreak())if(V()||!re(21)){if(13!==z()&&14!==z())return e;var n=ce(183,e.pos);n.tag=e,n.template=13===z()?je():He(),e=de(n)}else{var r=ce(180,e.pos);if(r.expression=e,22!==z()&&(r.argumentExpression=M(Nt),9===r.argumentExpression.kind||8===r.argumentExpression.kind)){var i=r.argumentExpression;i.text=he(i.text)}ne(22),e=de(r)}else{q();var s=ce(203,e.pos);s.expression=e,e=de(s)}}}function rn(){ne(19);var e=Me(11,an);return ne(20),e}function sn(){if(re(27)){var e=Me(19,St);if(ne(29))return e&&function(){switch(z()){case 19:case 23:case 20:case 22:case 56:case 25:case 55:case 32:case 34:case 33:case 35:case 53:case 54:case 50:case 48:case 49:case 18:case 1:return!0;case 26:case 17:default:return!1}}()?e:void 0}}function on(){return 24===z()?(e=ce(198),ne(24),e.expression=Ot(),de(e)):26===z()?ce(200):Ot();var e}function an(){return L(T,on)}function ln(e,t,n){return ve(125)?Gn(153,e,t,n):ve(135)?Gn(154,e,t,n):void 0}function cn(){var e=v.getStartPos();if(ie(24)){var t=ce(263,e);return t.expression=Ot(),C(de(t))}var n=Wn(),r=zn(),i=ln(e,n,r);if(i)return i;var s=ie(39),o=te(),a=be(),l=ie(55);if(s||19===z()||27===z())return Un(e,n,r,s,a,l);if(o&&(26===z()||18===z()||58===z())){var c=ce(262,e);c.name=a,c.questionToken=l;var u=ie(58);return u&&(c.equalsToken=u,c.objectAssignmentInitializer=M(Ot)),C(de(c))}var d=ce(261,e);return d.modifiers=r,d.name=a,d.questionToken=l,ne(56),d.initializer=M(Ot),C(de(d))}function un(){var e=ce(178);return ne(17),v.hasPrecedingLineBreak()&&(e.multiLine=!0),e.properties=Me(12,cn,!0),ne(18),de(e)}function dn(){var t=V();t&&O(!1);var n=ce(186);n.modifiers=zn(),ne(89),n.asteriskToken=ie(39);var r=n.asteriskToken?1:0,i=e.hasModifier(n,256)?2:0;return n.name=r&&i?P(20480,pn):r?function(e){return P(4096,e)}(pn):i?F(pn):pn(),et(56,r|i,n),n.body=fn(r|i),t&&O(!0),C(de(n))}function pn(){return te()?me():void 0}function hn(e,t){var n=ce(207);return ne(17,t)||e?(v.hasPrecedingLineBreak()&&(n.multiLine=!0),n.statements=Oe(1,In),ne(18)):n.statements=Fe(),de(n)}function fn(e,t){var n=B();D(!!(1&e));var r=H();R(!!(2&e));var i=V();i&&O(!1);var s=hn(!!(16&e),t);return i&&O(!0),D(n),R(r),s}function mn(){var e=W();ne(88);var t=ie(121);ne(19);var n,r=void 0;if(25!==z()&&(r=104===z()||110===z()||76===z()?Mn(!0):P(2048,Nt)),t?ne(142):re(142)){var i=ce(216,e);i.awaitModifier=t,i.initializer=r,i.expression=M(Ot),ne(20),n=i}else if(re(92)){var s=ce(215,e);s.initializer=r,s.expression=M(Nt),ne(20),n=s}else{var o=ce(214,e);o.initializer=r,ne(25),25!==z()&&20!==z()&&(o.condition=M(Nt)),ne(25),20!==z()&&(o.incrementor=M(Nt)),ne(20),n=o}return n.statement=In(),de(n)}function _n(e){var t=ce(e);return ne(218===e?72:77),ae()||(t.label=me()),le(),de(t)}function gn(){return 73===z()?(e=ce(257),ne(73),e.expression=M(Nt),ne(56),e.statements=Oe(3,In),de(e)):function(){var e=ce(258);return ne(79),ne(56),e.statements=Oe(3,In),de(e)}();var e}function yn(){var e=ce(224);return ne(102),e.tryBlock=hn(!1),e.catchClause=74===z()?function(){var e=ce(260);ne(74),re(19)?(e.variableDeclaration=Pn(),ne(20)):e.variableDeclaration=void 0;return e.block=hn(!1),de(e)}():void 0,e.catchClause&&87!==z()||(ne(87),e.finallyBlock=hn(!1)),de(e)}function bn(){return q(),e.tokenIsIdentifierOrKeyword(z())&&!v.hasPrecedingLineBreak()}function vn(){return q(),75===z()&&!v.hasPrecedingLineBreak()}function Tn(){return q(),89===z()&&!v.hasPrecedingLineBreak()}function kn(){return q(),(e.tokenIsIdentifierOrKeyword(z())||8===z()||9===z())&&!v.hasPrecedingLineBreak()}function En(){for(;;)switch(z()){case 104:case 110:case 76:case 89:case 75:case 83:return!0;case 109:case 138:return q(),!v.hasPrecedingLineBreak()&&te();case 128:case 129:return wn();case 117:case 120:case 124:case 112:case 113:case 114:case 131:if(q(),v.hasPrecedingLineBreak())return!1;continue;case 141:return q(),17===z()||71===z()||84===z();case 91:return q(),9===z()||39===z()||17===z()||e.tokenIsIdentifierOrKeyword(z());case 84:if(q(),58===z()||39===z()||17===z()||79===z()||118===z())return!0;continue;case 115:q();continue;default:return!1}}function xn(){return Z(En)}function Sn(){switch(z()){case 57:case 25:case 17:case 104:case 110:case 89:case 75:case 83:case 90:case 81:case 106:case 88:case 77:case 72:case 96:case 107:case 98:case 100:case 102:case 78:case 74:case 87:return!0;case 91:return xn()||Z(lt);case 76:case 84:return xn();case 120:case 124:case 109:case 128:case 129:case 138:case 141:return!0;case 114:case 112:case 113:case 115:case 131:return xn()||!Z(bn);default:return wt()}}function Cn(){return q(),te()||17===z()||21===z()}function In(){switch(z()){case 25:return e=ce(209),ne(25),de(e);case 17:return hn(!1);case 104:return $n(v.getStartPos(),void 0,void 0);case 110:if(Z(Cn))return $n(v.getStartPos(),void 0,void 0);break;case 89:return Bn(v.getStartPos(),void 0,void 0);case 75:return Yn(v.getStartPos(),void 0,void 0);case 90:return function(){var e=ce(211);return ne(90),ne(19),e.expression=M(Nt),ne(20),e.thenStatement=In(),e.elseStatement=re(82)?In():void 0,de(e)}();case 81:return function(){var e=ce(212);return ne(81),e.statement=In(),ne(106),ne(19),e.expression=M(Nt),ne(20),re(25),de(e)}();case 106:return function(){var e=ce(213);return ne(106),ne(19),e.expression=M(Nt),ne(20),e.statement=In(),de(e)}();case 88:return mn();case 77:return _n(217);case 72:return _n(218);case 96:return function(){var e=ce(219);return ne(96),ae()||(e.expression=M(Nt)),le(),de(e)}();case 107:return function(){var e=ce(220);return ne(107),ne(19),e.expression=M(Nt),ne(20),e.statement=In(),de(e)}();case 98:return function(){var e=ce(221);ne(98),ne(19),e.expression=M(Nt),ne(20);var t=ce(235,v.getStartPos());return ne(17),t.clauses=Oe(2,gn),ne(18),e.caseBlock=de(t),de(e)}();case 100:return function(){var e=ce(223);return ne(100),e.expression=v.hasPrecedingLineBreak()?void 0:M(Nt),le(),de(e)}();case 102:case 74:case 87:return yn();case 78:return function(){var e=ce(225);return ne(78),le(),de(e)}();case 57:return An();case 120:case 109:case 138:case 128:case 129:case 124:case 76:case 83:case 84:case 91:case 112:case 113:case 114:case 117:case 115:case 131:case 141:if(xn())return An()}var e;return function(){var e=v.getStartPos(),t=M(Nt);if(71===t.kind&&re(56)){var n=ce(222,e);return n.label=t,n.statement=In(),C(de(n))}var r=ce(210,e);return r.expression=t,le(),C(de(r))}()}function An(){var t=W(),n=Wn(),r=zn();switch(z()){case 104:case 110:case 76:return $n(t,n,r);case 89:return Bn(t,n,r);case 75:return Yn(t,n,r);case 109:return function(e,t,n){var r=ce(230,e);return r.decorators=t,r.modifiers=n,ne(109),r.name=me(),r.typeParameters=Ye(),r.heritageClauses=Qn(),r.members=ct(),C(de(r))}(t,n,r);case 138:return function(e,t,n){var r=ce(231,e);return r.decorators=t,r.modifiers=n,ne(138),r.name=me(),r.typeParameters=Ye(),ne(58),r.type=St(),le(),C(de(r))}(t,n,r);case 83:return function(e,t,n){var r=ce(232,e);r.decorators=t,r.modifiers=n,ne(83),r.name=me(),ne(17)?(r.members=Me(6,rr),ne(18)):r.members=Fe();return C(de(r))}(t,n,r);case 141:case 128:case 129:return function(e,t,n){var r=0;if(141===z())return or(e,t,n);if(re(129))r|=16;else if(ne(128),9===z())return or(e,t,n);return sr(e,t,n,r)}(t,n,r);case 91:return function(e,t,n){ne(91);var r,i=v.getStartPos();if(te()&&(r=me(),26!==z()&&140!==z()))return function(e,t,n,r){var i=ce(237,e);return i.decorators=t,i.modifiers=n,i.name=r,ne(58),i.moduleReference=function(){return 132===z()&&Z(ar)?function(){var e=ce(248);return ne(132),ne(19),e.expression=cr(),ne(20),de(e)}():Be(!1)}(),le(),C(de(i))}(e,t,n,r);var s=ce(238,e);s.decorators=t,s.modifiers=n,(r||39===z()||17===z())&&(s.importClause=function(e,t){var n=ce(239,t);e&&(n.name=e);n.name&&!re(26)||(n.namedBindings=39===z()?(r=ce(240),ne(39),ne(118),r.name=me(),de(r)):ur(241));var r;return de(n)}(r,i),ne(140));return s.moduleSpecifier=cr(),le(),de(s)}(t,n,r);case 84:switch(q(),z()){case 79:case 58:return function(e,t,n){var r=ce(243,e);r.decorators=t,r.modifiers=n,re(58)?r.isExportEquals=!0:ne(79);return r.expression=Ot(),le(),de(r)}(t,n,r);case 118:return function(e,t,n){var r=ce(236,e);return r.decorators=t,r.modifiers=n,ne(118),ne(129),r.name=me(),le(),de(r)}(t,n,r);default:return function(e,t,n){var r=ce(244,e);r.decorators=t,r.modifiers=n,re(39)?(ne(140),r.moduleSpecifier=cr()):(r.exportClause=ur(245),(140===z()||9===z()&&!v.hasPrecedingLineBreak())&&(ne(140),r.moduleSpecifier=cr()));return le(),de(r)}(t,n,r)}default:if(n||r){var i=pe(247,!0,e.Diagnostics.Declaration_expected);return i.pos=t,i.decorators=n,i.modifiers=r,de(i)}}}function wn(){return q(),!v.hasPrecedingLineBreak()&&(te()||9===z())}function Nn(e,t){if(17===z()||!ae())return fn(e,t);le()}function Dn(){if(26===z())return ce(200);var e=ce(176);return e.dotDotDotToken=ie(24),e.name=Ln(),e.initializer=Dt(!1),de(e)}function On(){var e=ce(176);e.dotDotDotToken=ie(24);var t=te(),n=be();return t&&56!==z()?e.name=n:(ne(56),e.propertyName=n,e.name=Ln()),e.initializer=Dt(!1),de(e)}function Rn(){return 17===z()||21===z()||te()}function Ln(){return 21===z()?(e=ce(175),ne(21),e.elements=Me(10,Dn),ne(22),de(e)):17===z()?function(){var e=ce(174);return ne(17),e.elements=Me(9,On),ne(18),de(e)}():me();var e}function Pn(){var e=ce(226);return e.name=Ln(),e.type=It(),Ut(z())||(e.initializer=Hn()),de(e)}function Mn(t){var n=ce(227);switch(z()){case 104:break;case 110:n.flags|=1;break;case 76:n.flags|=2;break;default:e.Debug.fail()}if(q(),142===z()&&Z(Fn))n.declarations=Fe();else{var r=U();N(t),n.declarations=Me(8,Pn),N(r)}return de(n)}function Fn(){return Ie()&&20===q()}function $n(e,t,n){var r=ce(208,e);return r.decorators=t,r.modifiers=n,r.declarationList=Mn(!1),le(),C(de(r))}function Bn(t,n,r){var i=ce(228,t);i.decorators=n,i.modifiers=r,ne(89),i.asteriskToken=ie(39),i.name=e.hasModifier(i,512)?pn():me();var s=i.asteriskToken?1:0,o=e.hasModifier(i,256)?2:0;return et(56,s|o,i),i.body=Nn(s|o,e.Diagnostics.or_expected),C(de(i))}function Un(t,n,r,i,s,o,a){var l=ce(151,t);l.decorators=n,l.modifiers=r,l.asteriskToken=i,l.name=s,l.questionToken=o;var c=i?1:0,u=e.hasModifier(l,256)?2:0;return et(56,c|u,l),l.body=Nn(c|u,a),C(de(l))}function Vn(t,n,r,i,s){var o=ce(149,t);return o.decorators=n,o.modifiers=r,o.name=i,o.questionToken=s,o.type=It(),o.initializer=e.hasModifier(o,32)?M(Hn):L(6144,Hn),le(),C(de(o))}function Hn(){return Dt(!1)}function Gn(e,t,n,r){var i=ce(e,t);return i.decorators=n,i.modifiers=r,i.name=be(),et(56,0,i),i.body=Nn(0),C(de(i))}function jn(e){switch(e){case 114:case 112:case 113:case 115:case 131:return!0;default:return!1}}function Kn(){var t;if(57===z())return!0;for(;e.isModifierKind(z());){if(jn(t=z()))return!0;q()}if(39===z())return!0;if(ge()&&(t=z(),q()),21===z())return!0;if(void 0!==t){if(!e.isKeyword(t)||135===t||125===t)return!0;switch(z()){case 19:case 27:case 56:case 58:case 55:return!0;default:return ae()}}return!1}function Wn(){for(var e,t=W();;){var n=W();if(!re(57))break;var r=ce(147,n);r.expression=P(8192,qt),de(r),(e||(e=[])).push(r)}return e&&ue(e,t)}function zn(t){for(var n,r=W();;){var i=v.getStartPos(),s=z();if(76===z()&&t){if(!ee(Te))break}else if(!e.isModifierKind(z())||!ee(ke))break;var o=de(ce(s,i));(n||(n=[])).push(o)}return n&&ue(n,r)}function qn(){var e;if(120===z()){var t=v.getStartPos(),n=z();q(),e=ue([de(ce(n,t))],t)}return e}function Jn(){if(25===z()){var t=ce(206);return q(),de(t)}var n=W(),r=Wn(),i=zn(!0),s=ln(n,r,i);return s||(123===z()?function(t,n,r){var i=ce(152,t);return i.decorators=n,i.modifiers=r,ne(123),et(56,0,i),i.body=Nn(0,e.Diagnostics.or_expected),C(de(i))}(n,r,i):rt()?st(n,r,i):e.tokenIsIdentifierOrKeyword(z())||9===z()||8===z()||39===z()||21===z()?function(t,n,r){var i=ie(39),s=be(),o=ie(55);return i||19===z()||27===z()?Un(t,n,r,i,s,o,e.Diagnostics.or_expected):Vn(t,n,r,s,o)}(n,r,i):r||i?Vn(n,r,i,pe(71,!0,e.Diagnostics.Declaration_expected),void 0):void e.Debug.fail("Should not have attempted to parse class member declaration."))}function Yn(e,t,n){return Xn(e,t,n,229)}function Xn(e,t,n,r){var i=ce(r,e);return i.decorators=t,i.modifiers=n,ne(75),i.name=!te()||108===z()&&Z(Ae)?void 0:me(),i.typeParameters=Ye(),i.heritageClauses=Qn(),ne(17)?(i.members=Oe(5,Jn),ne(18)):i.members=Fe(),C(de(i))}function Qn(){if(nr())return Oe(21,Zn)}function Zn(){var e=z();if(85===e||108===e){var t=ce(259);return t.token=e,q(),t.types=Me(7,er),de(t)}}function er(){var e=ce(201);return e.expression=qt(),e.typeArguments=tr(),de(e)}function tr(){return 27===z()?$e(19,St,27,29):void 0}function nr(){return 85===z()||108===z()}function rr(){var e=ce(264,v.getStartPos());return e.name=be(),e.initializer=M(Hn),C(de(e))}function ir(){var e=ce(234,v.getStartPos());return ne(17)?(e.statements=Oe(1,In),ne(18)):e.statements=Fe(),de(e)}function sr(e,t,n,r){var i=ce(233,e),s=16&r;return i.decorators=t,i.modifiers=n,i.flags|=r,i.name=me(),i.body=re(23)?sr(W(),void 0,void 0,4|s):ir(),C(de(i))}function or(e,t,n){var r=ce(233,e);return r.decorators=t,r.modifiers=n,141===z()?(r.name=me(),r.flags|=512):(r.name=je(),r.name.text=he(r.name.text)),17===z()?r.body=ir():le(),de(r)}function ar(){return 19===q()}function lr(){return 41===q()}function cr(){if(9===z()){var e=je();return e.text=he(e.text),e}return Nt()}function ur(e){var t=ce(e);return t.elements=$e(22,241===e?pr:dr,17,18),de(t)}function dr(){return hr(246)}function pr(){return hr(242)}function hr(t){var n=ce(t),r=e.isKeyword(z())&&!te(),i=v.getTokenPos(),s=v.getTextPos(),o=_e();return 118===z()?(n.propertyName=o,ne(118),r=e.isKeyword(z())&&!te(),i=v.getTokenPos(),s=v.getTextPos(),n.name=_e()):n.name=o,242===t&&r&&j(i,s-i,e.Diagnostics.Identifier_expected),de(n)}function fr(t){for(var n,r=e.createScanner(t.languageVersion,!1,0,d),i=[],s=[],o=[],l=void 0;;){var c=r.scan();if(2!==c){if(e.isTrivia(c))continue;break}var u={kind:r.getToken(),pos:r.getTokenPos(),end:r.getTextPos()},p=d.substring(u.pos,u.end),h=e.getFileReferenceFromReferencePath(p,u);if(h){var f=h.fileReference;t.hasNoDefaultLib=h.isNoDefaultLib;var m=h.diagnosticMessage;f&&(h.isTypeReferenceDirective?s.push(f):i.push(f)),m&&a.push(e.createFileDiagnostic(t,u.pos,u.end-u.pos,m))}else{var _=/^\/\/\/\s*<amd-module\s+name\s*=\s*('|")(.+?)\1/gim.exec(p);_&&(n&&a.push(e.createFileDiagnostic(t,u.pos,u.end-u.pos,e.Diagnostics.An_AMD_module_cannot_have_multiple_name_assignments)),n=_[2]);if(/^\/\/\/\s*<amd-dependency\s/gim.exec(p)){var g=/\spath\s*=\s*('|")(.+?)\1/gim.exec(p),y=/\sname\s*=\s*('|")(.+?)\1/gim.exec(p);if(g){var b={path:g[2],name:y?y[2]:void 0};o.push(b)}}var v=/^\/\/\/?\s*(@ts-check|@ts-nocheck)\s*$/gim.exec(p);v&&(l={enabled:0===e.compareStrings(v[1],"@ts-check",!0),end:u.end,pos:u.pos})}}t.referencedFiles=i,t.typeReferenceDirectives=s,t.amdDependencies=o,t.moduleName=n,t.checkJsDirective=l}t.parseSourceFile=function(t,n,r,i,s,l){x(n,r,i,l=e.ensureScriptKind(t,l));var c=function(t,n,r,i){(o=A(t,n,i)).flags=_,q(),fr(o),o.statements=Oe(0,In),e.Debug.assert(1===z()),o.endOfFileToken=C(oe()),function(t){t.externalModuleIndicator=e.forEach(t.statements,(function(t){return e.hasModifier(t,1)||237===t.kind&&248===t.moduleReference.kind||238===t.kind||243===t.kind||244===t.kind?t:void 0}))}(o),o.nodeCount=p,o.identifierCount=f,o.identifiers=h,o.parseDiagnostics=a,r&&I(o);return o}(t,r,s,l);return S(),c},t.parseIsolatedEntityName=function(e,t){x(e,t,void 0,1),q();var n=Be(!0),r=1===z()&&!a.length;return S(),r?n:void 0},t.parseJsonText=function(t,n){x(n,2,void 0,6);var r=o=A(t,2,6);return q(),1===z()?o.endOfFileToken=oe():17===z()||Z((function(){return 9===z()}))?(r.jsonObject=un(),o.endOfFileToken=se(1,!1,e.Diagnostics.Unexpected_token)):ne(17),o.parseDiagnostics=a,S(),r},t.fixupParentReferences=I,function(e){e[e.SourceElements=0]="SourceElements",e[e.BlockStatements=1]="BlockStatements",e[e.SwitchClauses=2]="SwitchClauses",e[e.SwitchClauseStatements=3]="SwitchClauseStatements",e[e.TypeMembers=4]="TypeMembers",e[e.ClassMembers=5]="ClassMembers",e[e.EnumMembers=6]="EnumMembers",e[e.HeritageClauseElement=7]="HeritageClauseElement",e[e.VariableDeclarations=8]="VariableDeclarations",e[e.ObjectBindingElements=9]="ObjectBindingElements",e[e.ArrayBindingElements=10]="ArrayBindingElements",e[e.ArgumentExpressions=11]="ArgumentExpressions",e[e.ObjectLiteralMembers=12]="ObjectLiteralMembers",e[e.JsxAttributes=13]="JsxAttributes",e[e.JsxChildren=14]="JsxChildren",e[e.ArrayLiteralMembers=15]="ArrayLiteralMembers",e[e.Parameters=16]="Parameters",e[e.RestProperties=17]="RestProperties",e[e.TypeParameters=18]="TypeParameters",e[e.TypeArguments=19]="TypeArguments",e[e.TupleElementTypes=20]="TupleElementTypes",e[e.HeritageClauses=21]="HeritageClauses",e[e.ImportOrExportSpecifiers=22]="ImportOrExportSpecifiers",e[e.Count=23]="Count"}(g||(g={})),function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.Unknown=2]="Unknown"}(y||(y={})),function(t){function n(e){var t=ce(267,v.getTokenPos());if(ne(17)||!e)return t.type=P(1048576,St),ne(18),I(t),de(t)}var r,i;function s(t,r){var i=d;t=t||0;var s,o,a,l=void 0===r?i.length:t+r;r=l-t,e.Debug.assert(t>=0),e.Debug.assert(t<=l),e.Debug.assert(l<=i.length);var u,p=[];return function(e,t){return 47===e.charCodeAt(t)&&42===e.charCodeAt(t+1)&&42===e.charCodeAt(t+2)&&42!==e.charCodeAt(t+3)}(i,t)?(v.scanRange(t+3,r-5,(function(){var e=!0,n=1,r=void 0,c=t-Math.max(i.lastIndexOf("\n",t),0)+4;function d(e){r||(r=c),p.push(e),c+=e.length}for(I();5===z();)I();for(4===z()&&(n=0,c=0,I());1!==z();){switch(z()){case 57:0===n||1===n?(f(p),_(c),n=0,e=!1,r=void 0,c++):d(v.getTokenText());break;case 4:p.push(v.getTokenText()),n=0,c=0;break;case 39:var m=v.getTokenText();1===n||2===n?(n=2,d(m)):(n=1,c+=m.length);break;case 71:d(v.getTokenText()),n=2;break;case 5:var g=v.getTokenText();2===n?p.push(g):void 0!==r&&c+g.length>r&&p.push(g.slice(r-c-1)),c+=g.length;break;case 1:break;default:n=2,d(v.getTokenText())}e?I():e=!0}h(p),f(p),u=function(){var e=ce(275,t);return e.tags=s&&ue(s,o,a),e.comment=p.length?p.join(""):void 0,de(e,l)}()})),u):u;function h(e){for(;e.length&&("\n"===e[0]||"\r"===e[0]);)e.shift()}function f(e){for(;e.length&&("\n"===e[e.length-1]||"\r"===e[e.length-1]);)e.pop()}function m(){for(;5===z()||4===z();)I()}function _(t){e.Debug.assert(57===z());var n=ce(57,v.getTokenPos());n.end=v.getTextPos(),I();var r=A();if(m(),r){var i;if(r)switch(r.escapedText){case"augments":case"extends":i=function(e,t){var n=ce(277,e.pos);return n.atToken=e,n.tagName=t,n.class=function(){var e=re(17),t=ce(201);t.expression=function(){var e=A(!0);for(;re(23);){var t=ce(179,e.pos);t.expression=e,t.name=A(),e=de(t)}return e}(),t.typeArguments=tr();var n=de(t);e&&ne(18);return n}(),de(n)}(n,r);break;case"class":case"constructor":i=function(e,t){var n=ce(278,e.pos);return n.atToken=e,n.tagName=t,de(n)}(n,r);break;case"arg":case"argument":case"param":i=k(n,r,1);break;case"return":case"returns":i=function(t,n){e.forEach(s,(function(e){return 280===e.kind}))&&j(n.pos,v.getTokenPos()-n.pos,e.Diagnostics._0_tag_already_specified,n.escapedText);var r=ce(280,t.pos);return r.atToken=t,r.tagName=n,r.typeExpression=y(),de(r)}(n,r);break;case"template":i=function(t,n){e.forEach(s,(function(e){return 282===e.kind}))&&j(n.pos,v.getTokenPos()-n.pos,e.Diagnostics._0_tag_already_specified,n.escapedText);var r=[],i=W();for(;;){var o=A();if(m(),!o)return void j(v.getStartPos(),0,e.Diagnostics.Identifier_expected);var a=ce(145,o.pos);if(a.name=o,de(a),r.push(a),26!==z())break;I(),m()}var l=ce(282,t.pos);return l.atToken=t,l.tagName=n,l.typeParameters=ue(r,i),de(l),l}(n,r);break;case"type":i=E(n,r);break;case"typedef":i=function(e,t){var n=y();m();var r=ce(283,e.pos);if(r.atToken=e,r.tagName=t,r.fullName=c(0),r.fullName)for(var i=r.fullName;;){if(71===i.kind||!i.body){r.name=71===i.kind?i:i.name;break}i=i.body}if(m(),r.typeExpression=n,!n||T(n.type)){for(var s=void 0,o=void 0,a=void 0,l=v.getStartPos();s=ee((function(){return S(0)}));)if(o||(o=ce(285,l)),281===s.kind){if(a)break;a=s}else o.jsDocPropertyTags||(o.jsDocPropertyTags=[]),o.jsDocPropertyTags.push(s);o&&(n&&164===n.type.kind&&(o.isArrayType=!0),r.typeExpression=a&&a.typeExpression&&!T(a.typeExpression.type)?a.typeExpression:de(o))}return de(r);function c(e){var t=v.getTokenPos(),n=A();if(n&&re(23)){var r=ce(233,t);return r.flags|=e,r.name=n,r.body=c(4),de(r)}return n&&4&e&&(n.isInJSDocNamespace=!0),n}}(n,r);break;default:i=g(n,r)}else i=g(n,r);i&&function(e,t){e.comment=t.join(""),s?s.push(e):(s=[e],o=e.pos);a=e.end}(i,function(e){var t,n=[],r=0;function i(r){t||(t=e),n.push(r),e+=r.length}for(;57!==z()&&1!==z();){switch(z()){case 4:r>=1&&(r=0,n.push(v.getTokenText())),e=0;break;case 57:break;case 5:if(2===r)i(v.getTokenText());else{var s=v.getTokenText();void 0!==t&&e+s.length>t&&n.push(s.slice(t-e-1)),e+=s.length}break;case 39:if(0===r){r=1,e+=v.getTokenText().length;break}default:r=2,i(v.getTokenText())}if(57===z())break;I()}return h(n),f(n),n}(t+i.end-i.pos))}}function g(e,t){var n=ce(276,e.pos);return n.atToken=e,n.tagName=t,de(n)}function y(){return m(),17===z()?n():void 0}function b(){var e=re(21),t=function(){var e=A(!0);re(21)&&ne(22);for(;re(23);){var t=A(!0);re(21)&&ne(22),e=Ue(e,t)}return e}();return e&&(m(),ie(58)&&Nt(),ne(22)),{name:t,isBracketed:e}}function T(t){switch(t.kind){case 134:return!0;case 164:return T(t.elementType);default:return e.isTypeReferenceNode(t)&&e.isIdentifier(t.typeName)&&"Object"===t.typeName.escapedText}}function k(e,t,n){var r=y(),i=!r;m();var s=b(),o=s.name,a=s.isBracketed;m(),i&&(r=y());var l=ce(1===n?279:284,e.pos),c=function(e,t){if(e&&T(e.type)){for(var n=ce(267,v.getTokenPos()),r=void 0,i=void 0,s=v.getStartPos(),o=void 0;r=ee((function(){return S(1,t)}));)o||(o=[]),o.push(r);if(o)return(i=ce(285,s)).jsDocPropertyTags=o,164===e.type.kind&&(i.isArrayType=!0),n.type=de(i),de(n)}}(r,o);return c&&(r=c,i=!0),l.atToken=e,l.tagName=t,l.typeExpression=r,l.name=o,l.isNameFirst=i,l.isBracketed=a,de(l)}function E(t,r){e.forEach(s,(function(e){return 281===e.kind}))&&j(r.pos,v.getTokenPos()-r.pos,e.Diagnostics._0_tag_already_specified,r.escapedText);var i=ce(281,t.pos);return i.atToken=t,i.tagName=r,i.typeExpression=n(!0),de(i)}function x(t,n){for(;!e.isIdentifier(t)||!e.isIdentifier(n);){if(e.isIdentifier(t)||e.isIdentifier(n)||t.right.escapedText!==n.right.escapedText)return!1;t=t.left,n=n.left}return t.escapedText===n.escapedText}function S(t,n){for(var r=!0,i=!1;;)switch(I(),z()){case 57:if(r){var s=C(t);return!(s&&279===s.kind&&(e.isIdentifier(s.name)||!x(n,s.name.left)))&&s}i=!1;break;case 4:r=!0,i=!1;break;case 39:i&&(r=!1),i=!0;break;case 71:r=!1;break;case 1:return!1}}function C(t){e.Debug.assert(57===z());var n=ce(57,v.getStartPos());n.end=v.getTextPos(),I();var r=A();if(m(),!r)return!1;switch(r.escapedText){case"type":return 0===t&&E(n,r);case"prop":case"property":return 0===t&&k(n,r,t);case"arg":case"argument":case"param":return 1===t&&k(n,r,t)}return!1}function I(){return c=v.scanJSDocToken()}function A(t){if(void 0===t&&(t=!1),!e.tokenIsIdentifierOrKeyword(z()))return t?pe(71,!0,e.Diagnostics.Identifier_expected):void G(e.Diagnostics.Identifier_expected);var n=v.getTokenPos(),r=v.getTextPos(),s=ce(71,n);return s.escapedText=e.escapeLeadingUnderscores(i.substring(n,r)),de(s,r),I(),s}}t.parseJSDocTypeExpressionForTests=function(e,t,r){x(e,5,void 0,1),o=A("file.js",5,1),v.setText(e,t,r),c=v.scan();var i=n(),s=a;return S(),i?{jsDocTypeExpression:i,diagnostics:s}:void 0},t.parseJSDocTypeExpression=n,t.parseIsolatedJSDocComment=function(e,t,n){x(e,5,void 0,1),o={languageVariant:0,text:e};var r=s(t,n),i=a;return S(),r?{jsDoc:r,diagnostics:i}:void 0},t.parseJSDocComment=function(t,n,r){var i,l=c,u=a.length,d=k,p=s(n,r);return p&&(p.parent=t),e.isInJavaScriptFile(t)&&(o.jsDocDiagnostics||(o.jsDocDiagnostics=[]),(i=o.jsDocDiagnostics).push.apply(i,a)),c=l,a.length=u,k=d,p},function(e){e[e.BeginningOfLine=0]="BeginningOfLine",e[e.SawAsterisk=1]="SawAsterisk",e[e.SavingComments=2]="SavingComments"}(r||(r={})),function(e){e[e.Property=0]="Property",e[e.Parameter=1]="Parameter"}(i||(i={})),t.parseJSDocCommentWorker=s}(b=t.JSDocParser||(t.JSDocParser={}))}(o||(o={})),function(t){function n(t,n,i,o,a,l){return void(n?d(t):c(t));function c(t){var n="";if(l&&r(t)&&(n=o.substring(t.pos,t.end)),t._children&&(t._children=void 0),t.pos+=i,t.end+=i,l&&r(t)&&e.Debug.assert(n===a.substring(t.pos,t.end)),u(t,c,d),e.hasJSDocNodes(t))for(var p=0,h=t.jsDoc;p<h.length;p++){u(h[p],c,d)}s(t,l)}function d(e){e._children=void 0,e.pos+=i,e.end+=i;for(var t=0,n=e;t<n.length;t++){c(n[t])}}}function r(e){switch(e.kind){case 9:case 8:case 71:return!0}return!1}function i(t,n,r,i,s){e.Debug.assert(t.end>=n,"Adjusting an element that was entirely before the change range"),e.Debug.assert(t.pos<=r,"Adjusting an element that was entirely after the change range"),e.Debug.assert(t.pos<=t.end),t.pos=Math.min(t.pos,i),t.end>=r?t.end+=s:t.end=Math.min(t.end,i),e.Debug.assert(t.pos<=t.end),t.parent&&(e.Debug.assert(t.pos>=t.parent.pos),e.Debug.assert(t.end<=t.parent.end))}function s(t,n){if(n){var r=t.pos;u(t,(function(t){e.Debug.assert(t.pos>=r),r=t.end})),e.Debug.assert(r<=t.end)}}function a(t,n){var r,i=t;if(u(t,(function t(s){if(e.nodeIsMissing(s))return;if(!(s.pos<=n))return e.Debug.assert(s.pos>n),!0;if(s.pos>=i.pos&&(i=s),n<s.end)return u(s,t),!0;e.Debug.assert(s.end<=n),r=s})),r){var s=function(e){for(;;){var t=o(e);if(!t)return e;e=t}}(r);s.pos>i.pos&&(i=s)}return i;function o(t){var n=void 0;return u(t,(function(t){e.nodeIsPresent(t)&&(n=t)})),n}}function l(t,n,r,i){var s=t.text;if(r&&(e.Debug.assert(s.length-r.span.length+r.newLength===n.length),i||e.Debug.shouldAssert(3))){var o=s.substr(0,r.span.start),a=n.substr(0,r.span.start);e.Debug.assert(o===a);var l=s.substring(e.textSpanEnd(r.span),s.length),c=n.substring(e.textSpanEnd(e.textChangeRangeNewSpan(r)),n.length);e.Debug.assert(l===c)}}var c;t.updateSourceFile=function(t,r,c,d){if(l(t,r,c,d=d||e.Debug.shouldAssert(2)),e.textChangeRangeIsUnchanged(c))return t;if(0===t.statements.length)return o.parseSourceFile(t.fileName,r,t.languageVersion,void 0,!0,t.scriptKind);var p=t;e.Debug.assert(!p.hasBeenIncrementallyParsed),p.hasBeenIncrementallyParsed=!0;var h=t.text,f=function(t){var n=t.statements,r=0;e.Debug.assert(r<n.length);var i=n[r],s=-1;return{currentNode:function(t){return t!==s&&(i&&i.end===t&&r<n.length-1&&(r++,i=n[r]),i&&i.pos===t||o(t)),s=t,e.Debug.assert(!i||i.pos===t),i}};function o(e){return n=void 0,r=-1,i=void 0,void u(t,s,o);function s(t){return e>=t.pos&&e<t.end&&(u(t,s,o),!0)}function o(t){if(e>=t.pos&&e<t.end)for(var a=0;a<t.length;a++){var l=t[a];if(l){if(l.pos===e)return n=t,r=a,i=l,!0;if(l.pos<e&&e<l.end)return u(l,s,o),!0}}return!1}}}(t),m=function(t,n){for(var r=1,i=n.span.start,s=0;i>0&&s<=r;s++){var o=a(t,i);e.Debug.assert(o.pos<=i);var l=o.pos;i=Math.max(0,l-1)}var c=e.createTextSpanFromBounds(i,e.textSpanEnd(n.span)),u=n.newLength+(n.span.start-i);return e.createTextChangeRange(c,u)}(t,c);l(t,r,m,d),e.Debug.assert(m.span.start<=c.span.start),e.Debug.assert(e.textSpanEnd(m.span)===e.textSpanEnd(c.span)),e.Debug.assert(e.textSpanEnd(e.textChangeRangeNewSpan(m))===e.textSpanEnd(e.textChangeRangeNewSpan(c)));var _=e.textChangeRangeNewSpan(m).length-m.span.length;return function(t,r,o,a,l,c,d,p){return void h(t);function h(t){if(e.Debug.assert(t.pos<=t.end),t.pos>o)n(t,!1,l,c,d,p);else{var m=t.end;if(m>=r)return t.intersectsChange=!0,t._children=void 0,i(t,r,o,a,l),u(t,h,f),void s(t,p);e.Debug.assert(m<r)}}function f(t){if(e.Debug.assert(t.pos<=t.end),t.pos>o)n(t,!0,l,c,d,p);else{var s=t.end;if(s>=r){t.intersectsChange=!0,t._children=void 0,i(t,r,o,a,l);for(var u=0,f=t;u<f.length;u++){h(f[u])}}else e.Debug.assert(s<r)}}}(p,m.span.start,e.textSpanEnd(m.span),e.textSpanEnd(e.textChangeRangeNewSpan(m)),_,h,r,d),o.parseSourceFile(t.fileName,r,t.languageVersion,f,!0,t.scriptKind)},function(e){e[e.Value=-1]="Value"}(c||(c={}))}(a||(a={}))}(ts||(ts={})),function(e){var t;function n(t){if(230===t.kind||231===t.kind)return 0;if(e.isConstEnumDeclaration(t))return 2;if(238!==t.kind&&237!==t.kind||e.hasModifier(t,1)){if(234===t.kind){var r=0;return e.forEachChild(t,(function(e){switch(n(e)){case 0:return!1;case 2:return r=2,!1;case 1:return r=1,!0}})),r}if(233===t.kind){var i=t.body;return i?n(i):1}return 71===t.kind&&t.isInJSDocNamespace?0:1}return 0}!function(e){e[e.NonInstantiated=0]="NonInstantiated",e[e.Instantiated=1]="Instantiated",e[e.ConstEnumOnly=2]="ConstEnumOnly"}(e.ModuleInstanceState||(e.ModuleInstanceState={})),e.getModuleInstanceState=n,function(e){e[e.None=0]="None",e[e.IsContainer=1]="IsContainer",e[e.IsBlockScopedContainer=2]="IsBlockScopedContainer",e[e.IsControlFlowContainer=4]="IsControlFlowContainer",e[e.IsFunctionLike=8]="IsFunctionLike",e[e.IsFunctionExpression=16]="IsFunctionExpression",e[e.HasLocals=32]="HasLocals",e[e.IsInterface=64]="IsInterface",e[e.IsObjectLiteralOrClassExpressionMethod=128]="IsObjectLiteralOrClassExpressionMethod"}(t||(t={}));var r=function(){var t,r,a,l,c,u,d,p,h,f,m,_,g,y,b,v,T,k,E,x,S,C,I=0,A={flags:1},w={flags:1},N=0;function D(n,r,i,s,o){return e.createDiagnosticForNodeInSourceFile(e.getSourceFileOfNode(n)||t,n,r,i,s,o)}return function(n,i){t=n,r=i,a=e.getEmitScriptTarget(r),E=function(e,t){return!(!(void 0===t.alwaysStrict?t.strict:t.alwaysStrict)||e.isDeclarationFile)||!!e.externalModuleIndicator}(t,i),S=e.createUnderscoreEscapedMap(),I=0,C=t.isDeclarationFile,x=e.objectAllocator.getSymbolConstructor(),t.locals||(ve(t),t.symbolCount=I,t.classifiableNames=S),t=void 0,r=void 0,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,p=!1,h=void 0,f=void 0,m=void 0,_=void 0,g=void 0,y=void 0,v=void 0,T=!1,k=0,N=0};function O(e,t){return I++,new x(e,t)}function R(t,n,r){if(t.flags|=r,n.symbol=t,t.declarations?t.declarations.push(n):t.declarations=[n],1952&r&&!t.exports&&(t.exports=e.createSymbolTable()),6240&r&&!t.members&&(t.members=e.createSymbolTable()),107455&r){var i=t.valueDeclaration;(!i||i.kind!==n.kind&&233===i.kind)&&(t.valueDeclaration=n)}}function L(t){if(243===t.kind)return t.isExportEquals?"export=":"default";var n=e.getNameOfDeclaration(t);if(n){if(e.isAmbientModule(t)){var r=e.getTextOfIdentifierOrLiteral(n);return e.isGlobalScopeAugmentation(t)?"__global":'"'+r+'"'}if(144===n.kind){var i=n.expression;return e.isStringOrNumericLiteral(i)?e.escapeLeadingUnderscores(i.text):(e.Debug.assert(e.isWellKnownSymbolSyntactically(i)),e.getPropertyNameForKnownSymbolName(e.idText(i.name)))}return e.getEscapedTextOfIdentifierOrLiteral(n)}switch(t.kind){case 152:return"__constructor";case 160:case 155:return"__call";case 161:case 156:return"__new";case 157:return"__index";case 244:return"__export";case 194:if(2===e.getSpecialPropertyAssignmentKind(t))return"export=";e.Debug.fail("Unknown binary declaration kind");break;case 228:case 229:return e.hasModifier(t,512)?"default":void 0;case 273:return e.isJSDocConstructSignature(t)?"__new":"__call";case 146:e.Debug.assert(273===t.parent.kind);var s=t.parent;return"arg"+e.indexOf(s.parameters,t);case 283:var o=e.getNameOfJSDocTypedef(t);return void 0!==o?o.escapedText:void 0}}function P(t){return t.name?e.declarationNameToString(t.name):e.unescapeLeadingUnderscores(L(t))}function M(n,r,i,s,o,a){e.Debug.assert(!e.hasDynamicName(i));var l,c=e.hasModifier(i,512),u=c&&r?"default":L(i);if(void 0===u)l=O(0,"__missing");else if(l=n.get(u),788448&s&&S.set(u,!0),l){if(a&&!l.isReplaceableByMethod)return l;if(l.flags&o)if(l.isReplaceableByMethod)n.set(u,l=O(0,u));else{i.name&&(i.name.parent=i);var d=2&l.flags?e.Diagnostics.Cannot_redeclare_block_scoped_variable_0:e.Diagnostics.Duplicate_identifier_0;l.declarations&&l.declarations.length&&(c||l.declarations&&l.declarations.length&&(c||243===i.kind&&!i.isExportEquals))&&(d=e.Diagnostics.A_module_cannot_have_multiple_default_exports),e.forEach(l.declarations,(function(n){t.bindDiagnostics.push(D(e.getNameOfDeclaration(n)||n,d,P(n)))})),t.bindDiagnostics.push(D(e.getNameOfDeclaration(i)||i,d,P(i))),l=O(0,u)}}else n.set(u,l=O(0,u)),a&&(l.isReplaceableByMethod=!0);return R(l,i,s),l.parent=r,l}function F(t,n,r){var i=1&e.getCombinedModifierFlags(t);if(2097152&n)return 246===t.kind||237===t.kind&&i?M(c.symbol.exports,c.symbol,t,n,r):M(c.locals,void 0,t,n,r);283===t.kind&&e.Debug.assert(e.isInJavaScriptFile(t));var s=283===t.kind&&t.name&&71===t.name.kind&&t.name.isInJSDocNamespace;if(!e.isAmbientModule(t)&&(i||32&c.flags)||s){var o=107455&n?1048576:0,a=M(c.locals,void 0,t,o,r);return a.exportSymbol=M(c.symbol.exports,c.symbol,t,n,r),t.localSymbol=a,a}return M(c.locals,void 0,t,n,r)}function $(e){if(C)V(e);else if(536870912&e.transformFlags)C=!0,V(e),C=!1,N|=e.transformFlags&~s(e.kind);else{var t=N;N=0,V(e),N=t|i(e,N)}}function B(t){if(void 0!==t)if(C)e.forEach(t,ve);else{var n=N;N=0;for(var r=0,i=0,s=t;i<s.length;i++){var o=s[i];ve(o),r|=-536870913&o.transformFlags}t.transformFlags=536870912|r,N|=n}}function U(t){e.forEachChild(t,ve,B)}function V(i){if(e.hasJSDocNodes(i))if(e.isInJavaScriptFile(i))for(var s=0,a=i.jsDoc;s<a.length;s++){ve(a[s])}else for(var l=0,c=i.jsDoc;l<c.length;l++){o(i,c[l])}if(function(t){if(!(1&h.flags))return!1;if(h===A){if(e.isStatementButNotDeclaration(t)&&209!==t.kind||229===t.kind||233===t.kind&&function(e){var t=n(e);return 1===t||2===t&&r.preserveConstEnums}(t)||232===t.kind&&(!e.isConstEnumDeclaration(t)||r.preserveConstEnums))h=w,!r.allowUnreachableCode&&!e.isInAmbientContext(t)&&(208!==t.kind||3&e.getCombinedNodeFlags(t.declarationList)||e.forEach(t.declarationList.declarations,(function(e){return e.initializer})))&&be(t,e.Diagnostics.Unreachable_code_detected)}return!0}(i))U(i);else switch(i.kind){case 213:!function(e){var t=z(),n=W(),r=W();J(t,h),h=t,ne(e.expression,n,r),h=ee(n),re(e.statement,r,t),J(t,h),h=ee(r)}(i);break;case 212:!function(t){var n=z(),r=222===t.parent.kind?e.lastOrUndefined(v):void 0,i=r?r.continueTarget:W(),s=r?r.breakTarget:W();J(n,h),h=n,re(t.statement,s,i),J(i,h),h=ee(i),ne(t.expression,n,s),h=ee(s)}(i);break;case 214:!function(e){var t=z(),n=W(),r=W();ve(e.initializer),J(t,h),h=t,ne(e.condition,n,r),h=ee(n),re(e.statement,r,t),ve(e.incrementor),J(t,h),h=ee(r)}(i);break;case 215:case 216:!function(e){var t=z(),n=W();J(t,h),h=t,216===e.kind&&ve(e.awaitModifier);ve(e.expression),J(n,h),ve(e.initializer),227!==e.initializer.kind&&oe(e.initializer);re(e.statement,n,t),J(t,h),h=ee(n)}(i);break;case 211:!function(e){var t=W(),n=W(),r=W();ne(e.expression,t,n),h=ee(t),ve(e.thenStatement),J(r,h),h=ee(n),ve(e.elseStatement),J(r,h),h=ee(r)}(i);break;case 219:case 223:!function(e){ve(e.expression),219===e.kind&&(T=!0,_&&J(_,h));h=A}(i);break;case 218:case 217:!function(e){if(ve(e.label),e.label){var t=function(e){if(v)for(var t=0,n=v;t<n.length;t++){var r=n[t];if(r.name===e)return r}return}(e.label.escapedText);t&&(t.referenced=!0,ie(e,t.breakTarget,t.continueTarget))}else ie(e,f,m)}(i);break;case 224:!function(e){var t=W(),n=h;ve(e.tryBlock),J(t,h);var r=h,i=A;e.catchClause&&(h=n,ve(e.catchClause),J(t,h),i=h);if(e.finallyBlock){var s={flags:2048,antecedent:n,lock:{}};if(J(t,s),h=ee(t),ve(e.finallyBlock),1&h.flags||1&r.flags&&1&i.flags&&(h=r===w||i===w?w:A),!(1&h.flags)){var o={flags:4096,antecedent:h};s.lock=o,h=o}}else h=ee(t)}(i);break;case 221:!function(t){var n=W();ve(t.expression);var r=f,i=b;f=n,b=h,ve(t.caseBlock),J(n,h);var s=e.forEach(t.caseBlock.clauses,(function(e){return 258===e.kind}));t.possiblyExhaustive=!s&&!n.antecedents,s||J(n,X(b,t,0,0));f=r,b=i,h=ee(n)}(i);break;case 235:!function(t){var n=N;N=0;for(var i=t.clauses,s=A,o=0;o<i.length;o++){for(var a=o;!i[o].statements.length&&o+1<i.length;)ve(i[o]),o++;var l=W();J(l,X(b,t.parent,a,o+1)),J(l,s),h=ee(l);var c=i[o];ve(c),s=h,1&h.flags||o===i.length-1||!r.noFallthroughCasesInSwitch||be(c,e.Diagnostics.Fallthrough_case_in_switch)}i.transformFlags=536870912|N,N|=n}(i);break;case 257:!function(e){var t=h;h=b,ve(e.expression),h=t,B(e.statements)}(i);break;case 222:!function(n){var i=z(),s=W();ve(n.label),J(i,h);var o=function(e,t,n){var r={name:e,breakTarget:t,continueTarget:n,referenced:!1};return(v||(v=[])).push(r),r}(n.label.escapedText,s,i);ve(n.statement),v.pop(),o.referenced||r.allowUnusedLabels||t.bindDiagnostics.push(D(n.label,e.Diagnostics.Unused_label));n.statement&&212===n.statement.kind||(J(s,h),h=ee(s))}(i);break;case 192:!function(e){if(51===e.operator){var t=g;g=y,y=t,U(e),y=g,g=t}else U(e),43!==e.operator&&44!==e.operator||oe(e.operand)}(i);break;case 193:!function(e){U(e),(43===e.operator||44===e.operator)&&oe(e.operand)}(i);break;case 194:!function(t){var n=t.operatorToken.kind;if(53===n||54===n)if(function(e){for(;185===e.parent.kind||192===e.parent.kind&&51===e.parent.operator;)e=e.parent;return!function(e){var t=e.parent;switch(t.kind){case 211:case 213:case 212:return t.expression===e;case 214:case 195:return t.condition===e}return!1}(e)&&!te(e.parent)}(t)){var r=W();ae(t,r,r),h=ee(r)}else ae(t,g,y);else{if(U(t),e.isAssignmentOperator(n)&&!e.isAssignmentTarget(t))if(oe(t.left),58===n&&180===t.left.kind)K(t.left.expression)&&(h=Z(h,t))}}(i);break;case 188:!function(e){U(e),179===e.expression.kind&&oe(e.expression)}(i);break;case 195:!function(e){var t=W(),n=W(),r=W();ne(e.condition,t,n),h=ee(t),ve(e.questionToken),ve(e.whenTrue),J(r,h),h=ee(n),ve(e.colonToken),ve(e.whenFalse),J(r,h),h=ee(r)}(i);break;case 226:!function(t){U(t),(t.initializer||e.isForInOrOfStatement(t.parent.parent))&&le(t)}(i);break;case 181:!function(t){var n=t.expression;for(;185===n.kind;)n=n.expression;186===n.kind||187===n.kind?(B(t.typeArguments),B(t.arguments),ve(t.expression)):U(t);if(179===t.expression.kind){var r=t.expression;K(r.expression)&&e.isPushOrUnshiftIdentifier(r.name)&&(h=Z(h,t))}}(i);break;case 275:!function(t){e.forEachChild(t,(function(e){283!==e.kind&&ve(e)}))}(i);break;case 283:!function(t){e.forEachChild(t,(function(e){t.fullName&&e===t.name&&71!==t.fullName.kind||ve(e)}))}(i);break;default:U(i)}}function H(e){switch(e.kind){case 71:case 99:case 179:return G(e);case 181:return function(e){if(e.arguments)for(var t=0,n=e.arguments;t<n.length;t++){if(G(n[t]))return!0}if(179===e.expression.kind&&G(e.expression.expression))return!0;return!1}(e);case 185:return H(e.expression);case 194:return function(e){switch(e.operatorToken.kind){case 58:return G(e.left);case 32:case 33:case 34:case 35:return K(e.left)||K(e.right)||j(e.right,e.left)||j(e.left,e.right);case 93:return K(e.left);case 26:return H(e.right)}return!1}(e);case 192:return 51===e.operator&&H(e.operand)}return!1}function G(e){return 71===e.kind||99===e.kind||97===e.kind||179===e.kind&&G(e.expression)}function j(e,t){return 189===e.kind&&K(e.expression)&&9===t.kind}function K(e){switch(e.kind){case 185:return K(e.expression);case 194:switch(e.operatorToken.kind){case 58:return K(e.left);case 26:return K(e.right)}}return G(e)}function W(){return{flags:4,antecedents:void 0}}function z(){return{flags:8,antecedents:void 0}}function q(e){e.flags|=512&e.flags?1024:512}function J(t,n){1&n.flags||e.contains(t.antecedents,n)||((t.antecedents||(t.antecedents=[])).push(n),q(n))}function Y(e,t,n){return 1&t.flags?t:n?101===n.kind&&64&e||86===n.kind&&32&e?A:H(n)?(q(t),{flags:e,expression:n,antecedent:t}):t:32&e?t:A}function X(e,t,n,r){return H(t.expression)?(q(e),{flags:128,switchStatement:t,clauseStart:n,clauseEnd:r,antecedent:e}):e}function Q(e,t){return q(e),{flags:16,antecedent:e,node:t}}function Z(e,t){return q(e),{flags:256,antecedent:e,node:t}}function ee(e){var t=e.antecedents;return t?1===t.length?t[0]:e:A}function te(e){for(;;)if(185===e.kind)e=e.expression;else{if(192!==e.kind||51!==e.operator)return 194===e.kind&&(53===e.operatorToken.kind||54===e.operatorToken.kind);e=e.operand}}function ne(e,t,n){var r=g,i=y;g=t,y=n,ve(e),g=r,y=i,e&&te(e)||(J(t,Y(32,h,e)),J(n,Y(64,h,e)))}function re(e,t,n){var r=f,i=m;f=t,m=n,ve(e),f=r,m=i}function ie(e,t,n){var r=218===e.kind?t:n;r&&(J(r,h),h=A)}function se(e){194===e.kind&&58===e.operatorToken.kind?oe(e.left):oe(e)}function oe(e){if(G(e))h=Q(h,e);else if(177===e.kind)for(var t=0,n=e.elements;t<n.length;t++){var r=n[t];198===r.kind?oe(r.expression):se(r)}else if(178===e.kind)for(var i=0,s=e.properties;i<s.length;i++){var o=s[i];261===o.kind?se(o.initializer):262===o.kind?oe(o.name):263===o.kind&&oe(o.expression)}}function ae(e,t,n){var r={flags:4,antecedents:void 0};53===e.operatorToken.kind?ne(e.left,r,n):ne(e.left,t,r),h=ee(r),ve(e.operatorToken),ne(e.right,t,n)}function le(t){var n=e.isOmittedExpression(t)?void 0:t.name;if(e.isBindingPattern(n))for(var r=0,i=n.elements;r<i.length;r++){le(i[r])}else h=Q(h,t)}function ce(e){d&&(d.nextContainer=e),d=e}function ue(n,r,i){switch(c.kind){case 233:return F(n,r,i);case 265:return function(n,r,i){return e.isExternalModule(t)?F(n,r,i):M(t.locals,void 0,n,r,i)}(n,r,i);case 199:case 229:return function(t,n,r){return e.hasModifier(t,32)?M(c.symbol.exports,c.symbol,t,n,r):M(c.symbol.members,c.symbol,t,n,r)}(n,r,i);case 232:return M(c.symbol.exports,c.symbol,n,r,i);case 163:case 285:case 178:case 230:case 254:return M(c.symbol.members,c.symbol,n,r,i);case 160:case 161:case 155:case 156:case 157:case 151:case 150:case 152:case 153:case 154:case 228:case 186:case 187:case 273:case 231:case 172:return M(c.locals,void 0,n,r,i)}}function de(t){e.isInAmbientContext(t)&&!function(e){var t=265===e.kind?e:e.body;if(t&&(265===t.kind||234===t.kind))for(var n=0,r=t.statements;n<r.length;n++){var i=r[n];if(244===i.kind||243===i.kind)return!0}return!1}(t)?t.flags|=32:t.flags&=-33}function pe(e){var t=n(e),r=0!==t;return ue(e,r?512:1024,r?106639:0),t}function he(e,t,n){var r=O(t,n);8&t&&(r.parent=c.symbol),R(r,e,t)}function fe(t,n,r){switch(u.kind){case 233:F(t,n,r);break;case 265:if(e.isExternalModule(c)){F(t,n,r);break}default:u.locals||(u.locals=e.createSymbolTable(),ce(u)),M(u.locals,void 0,t,n,r)}}function me(n){E&&n.originalKeywordKind>=108&&n.originalKeywordKind<=116&&!e.isIdentifierName(n)&&!e.isInAmbientContext(n)&&(t.parseDiagnostics.length||t.bindDiagnostics.push(D(n,function(n){if(e.getContainingClass(n))return e.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_strict_mode;if(t.externalModuleIndicator)return e.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode;return e.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode}(n),e.declarationNameToString(n))))}function _e(n,r){if(r&&71===r.kind){var i=r;if(o=i,e.isIdentifier(o)&&("eval"===o.escapedText||"arguments"===o.escapedText)){var s=e.getErrorSpanForNode(t,r);t.bindDiagnostics.push(e.createFileDiagnostic(t,s.start,s.length,function(n){if(e.getContainingClass(n))return e.Diagnostics.Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode;if(t.externalModuleIndicator)return e.Diagnostics.Invalid_use_of_0_Modules_are_automatically_in_strict_mode;return e.Diagnostics.Invalid_use_of_0_in_strict_mode}(n),e.idText(i)))}}var o}function ge(e){E&&_e(e,e.name)}function ye(n){if(a<2&&265!==u.kind&&233!==u.kind&&!e.isFunctionLike(u)){var r=e.getErrorSpanForNode(t,n);t.bindDiagnostics.push(e.createFileDiagnostic(t,r.start,r.length,function(n){return e.getContainingClass(n)?e.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_definitions_are_automatically_in_strict_mode:t.externalModuleIndicator?e.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_are_automatically_in_strict_mode:e.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5}(n)))}}function be(n,r,i,s,o){var a=e.getSpanOfTokenAtPosition(t,n.pos);t.bindDiagnostics.push(e.createFileDiagnostic(t,a.start,a.length,r,i,s,o))}function ve(n){if(n){n.parent=l;var r=E;if(e.isInJavaScriptFile(n)&&function(t){if(!e.hasJSDocNodes(t))return;for(var n=0,r=t.jsDoc;n<r.length;n++){var i=r[n];if(i.tags)for(var s=0,o=i.tags;s<o.length;s++){var a=o[s];if(283===a.kind){var c=l;l=i,ve(a),l=c}}}}(n),function(n){switch(n.kind){case 71:if(n.isInJSDocNamespace){for(var r=n.parent;r&&283!==r.kind;)r=r.parent;fe(r,524288,793064);break}case 99:return h&&(e.isExpression(n)||262===l.kind)&&(n.flowNode=h),me(n);case 179:h&&G(n)&&(n.flowNode=h);break;case 194:switch(e.getSpecialPropertyAssignmentKind(n)){case 1:xe(n);break;case 2:!function(n){var r=e.getRightMostAssignedExpression(n.right);if(e.isEmptyObjectLiteral(r)||Se(r))return void Ee(n);Ee(n),M(t.symbol.exports,t.symbol,n,1049092,0)}(n);break;case 3:!function(e){var t=e.left,n=t.expression,r=n.expression;t.parent=e,r.parent=n,n.parent=t,we(r.escapedText,t,!0)}(n);break;case 4:!function(t){e.Debug.assert(e.isInJavaScriptFile(t));var n=e.getThisContainer(t,!1);switch(n.kind){case 228:case 186:n.symbol.members=n.symbol.members||e.createSymbolTable(),M(n.symbol.members,n.symbol,t,4,0);break;case 152:case 149:case 151:case 153:case 154:var r=n.parent;M(e.hasModifier(n,32)?r.symbol.exports:r.symbol.members,r.symbol,t,4,0,!0)}}(n);break;case 5:!function(t){var n=t.left,r=n.expression;e.isIdentifier(r)&&(n.parent=t,r.parent=n,Ce(r)?xe(t):we(r.escapedText,n,!1))}(n);break;case 0:break;default:e.Debug.fail("Unknown special property assignment kind")}return function(t){E&&e.isLeftHandSideExpression(t.left)&&e.isAssignmentOperator(t.operatorToken.kind)&&_e(t,t.left)}(n);case 260:return function(e){E&&e.variableDeclaration&&_e(e,e.variableDeclaration.name)}(n);case 188:return function(n){if(E&&71===n.expression.kind){var r=e.getErrorSpanForNode(t,n.expression);t.bindDiagnostics.push(e.createFileDiagnostic(t,r.start,r.length,e.Diagnostics.delete_cannot_be_called_on_an_identifier_in_strict_mode))}}(n);case 8:return function(n){E&&4&n.numericLiteralFlags&&t.bindDiagnostics.push(D(n,e.Diagnostics.Octal_literals_are_not_allowed_in_strict_mode))}(n);case 193:return function(e){E&&_e(e,e.operand)}(n);case 192:return function(e){E&&(43!==e.operator&&44!==e.operator||_e(e,e.operand))}(n);case 220:return function(t){E&&be(t,e.Diagnostics.with_statements_are_not_allowed_in_strict_mode)}(n);case 169:return void(p=!0);case 158:return function(e){var t=e.parameterName,n=e.type;t&&71===t.kind&&me(t);t&&169===t.kind&&(p=!0);ve(n)}(n);case 145:return ue(n,262144,530920);case 146:return function(t){E&&!e.isInAmbientContext(t)&&_e(t,t.name);e.isBindingPattern(t.name)?he(t,1,"__"+e.indexOf(t.parent.parameters,t)):ue(t,1,107455);if(e.isParameterPropertyDeclaration(t)){var n=t.parent.parent;M(n.symbol.members,n.symbol,t,4|(t.questionToken?16777216:0),0)}}(n);case 226:return Ne(n);case 176:return n.flowNode=h,Ne(n);case 149:case 148:return function(e){return De(e,4|(e.questionToken?16777216:0),0)}(n);case 261:case 262:return De(n,4,0);case 264:return De(n,8,900095);case 155:case 156:case 157:return ue(n,131072,0);case 151:case 150:return De(n,8192|(n.questionToken?16777216:0),e.isObjectLiteralMethod(n)?0:99263);case 228:return function(n){t.isDeclarationFile||e.isInAmbientContext(n)||e.isAsyncFunction(n)&&(k|=1024);ge(n),E?(ye(n),fe(n,16,106927)):ue(n,16,106927)}(n);case 152:return ue(n,16384,0);case 153:return De(n,32768,41919);case 154:return De(n,65536,74687);case 160:case 273:case 161:return function(t){var n=O(131072,L(t));R(n,t,131072);var r=O(2048,"__type");R(r,t,2048),r.members=e.createSymbolTable(),r.members.set(n.escapedName,n)}(n);case 163:case 285:case 172:return function(e){return he(e,2048,"__type")}(n);case 178:return function(n){var r;if(function(e){e[e.Property=1]="Property",e[e.Accessor=2]="Accessor"}(r||(r={})),E)for(var i=e.createUnderscoreEscapedMap(),s=0,o=n.properties;s<o.length;s++){var a=o[s];if(263!==a.kind&&71===a.name.kind){var l=a.name,c=261===a.kind||262===a.kind||151===a.kind?1:2,u=i.get(l.escapedText);if(u){if(1===c&&1===u){var d=e.getErrorSpanForNode(t,l);t.bindDiagnostics.push(e.createFileDiagnostic(t,d.start,d.length,e.Diagnostics.An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode))}}else i.set(l.escapedText,c)}}return he(n,4096,"__object")}(n);case 186:case 187:return function(n){t.isDeclarationFile||e.isInAmbientContext(n)||e.isAsyncFunction(n)&&(k|=1024);h&&(n.flowNode=h);ge(n);var r=n.name?n.name.escapedText:"__function";return he(n,16,r)}(n);case 181:e.isInJavaScriptFile(n)&&function(n){!t.commonJsModuleIndicator&&e.isRequireCall(n,!1)&&Ee(n)}(n);break;case 199:case 229:return E=!0,function(n){if(229===n.kind)fe(n,32,899519);else{he(n,32,n.name?n.name.escapedText:"__class"),n.name&&S.set(n.name.escapedText,!0)}var r=n.symbol,i=O(4194308,"prototype"),s=r.exports.get(i.escapedName);s&&(n.name&&(n.name.parent=n),t.bindDiagnostics.push(D(s.declarations[0],e.Diagnostics.Duplicate_identifier_0,e.symbolName(i))));r.exports.set(i.escapedName,i),i.parent=r}(n);case 230:return fe(n,64,792968);case 231:return fe(n,524288,793064);case 232:return function(t){return e.isConst(t)?fe(t,128,899967):fe(t,256,899327)}(n);case 233:return function(n){if(de(n),e.isAmbientModule(n))if(e.hasModifier(n,1)&&be(n,e.Diagnostics.export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always_visible),e.isExternalModuleAugmentation(n))pe(n);else{var r=void 0;if(9===n.name.kind){var i=n.name.text;e.hasZeroOrOneAsteriskCharacter(i)?r=e.tryParsePattern(i):be(n.name,e.Diagnostics.Pattern_0_can_have_at_most_one_Asterisk_character,i)}var s=ue(n,512,106639);r&&(t.patternAmbientModules||(t.patternAmbientModules=[])).push({pattern:r,symbol:s})}else{var o=pe(n);if(0!==o)if(304&n.symbol.flags)n.symbol.constEnumOnlyModule=!1;else{var a=2===o;void 0===n.symbol.constEnumOnlyModule?n.symbol.constEnumOnlyModule=a:n.symbol.constEnumOnlyModule=n.symbol.constEnumOnlyModule&&a}}}(n);case 254:return function(e){return he(e,4096,"__jsxAttributes")}(n);case 253:return function(e,t,n){return ue(e,t,n)}(n,4,0);case 237:case 240:case 242:case 246:return ue(n,2097152,2097152);case 236:return function(n){n.modifiers&&n.modifiers.length&&t.bindDiagnostics.push(D(n,e.Diagnostics.Modifiers_cannot_appear_here));if(265!==n.parent.kind)return void t.bindDiagnostics.push(D(n,e.Diagnostics.Global_module_exports_may_only_appear_at_top_level));var r=n.parent;if(!e.isExternalModule(r))return void t.bindDiagnostics.push(D(n,e.Diagnostics.Global_module_exports_may_only_appear_in_module_files));if(!r.isDeclarationFile)return void t.bindDiagnostics.push(D(n,e.Diagnostics.Global_module_exports_may_only_appear_in_declaration_files));t.symbol.globalExports=t.symbol.globalExports||e.createSymbolTable(),M(t.symbol.globalExports,t.symbol,n,2097152,2097152)}(n);case 239:return function(e){e.name&&ue(e,2097152,2097152)}(n);case 244:return function(e){c.symbol&&c.symbol.exports?e.exportClause||M(c.symbol.exports,c.symbol,e,8388608,0):he(e,8388608,L(e))}(n);case 243:return function(t){if(c.symbol&&c.symbol.exports){var n=243===t.kind&&e.exportAssignmentIsAlias(t)?2097152:4;M(c.symbol.exports,c.symbol,t,n,2097204)}else he(t,2097152,L(t))}(n);case 265:return Te(n.statements),de(t),void(e.isExternalModule(t)&&ke());case 207:if(!e.isFunctionLike(n.parent))return;case 234:return Te(n.statements);case 279:if(285!==n.parent.kind)break;case 284:var i=n;return ue(i,i.isBracketed||i.typeExpression&&272===i.typeExpression.type.kind?16777220:4,0);case 283:var s=n.fullName;if(!s||71===s.kind)fe(n,524288,793064)}}(n),n.kind>142){var s=l;l=n;var o=function(t){switch(t.kind){case 199:case 229:case 232:case 178:case 163:case 285:case 254:return 1;case 230:return 65;case 233:case 231:case 172:return 33;case 265:return 37;case 151:if(e.isObjectLiteralOrClassExpressionMethod(t))return 173;case 152:case 228:case 150:case 153:case 154:case 155:case 273:case 160:case 156:case 157:case 161:return 45;case 186:case 187:return 61;case 234:return 4;case 149:return t.initializer?4:0;case 260:case 214:case 215:case 216:case 235:return 2;case 207:return e.isFunctionLike(t.parent)?0:2}return 0}(n);0===o?$(n):function(t,n){var r=c,i=u;if(1&n?(c=u=t,32&n&&(c.locals=e.createSymbolTable()),ce(c)):2&n&&((u=t).locals=void 0),4&n){var s=h,o=f,a=m,l=_,d=v,g=T,y=16&n&&!e.hasModifier(t,256)&&!!e.getImmediatelyInvokedFunctionExpression(t);y?_={flags:4,antecedents:void 0}:(h={flags:2},144&n&&(h.container=t),_=void 0),f=void 0,m=void 0,v=void 0,T=!1,$(t),t.flags&=-1409,!(1&h.flags)&&8&n&&e.nodeIsPresent(t.body)&&(t.flags|=128,T&&(t.flags|=256)),265===t.kind&&(t.flags|=k),y?(J(_,h),h=ee(_)):h=s,f=o,m=a,_=l,v=d,T=g}else 64&n?(p=!1,$(t),t.flags=p?64|t.flags:-65&t.flags):$(t);c=r,u=i}(n,o),l=s}else C||0!=(536870912&n.transformFlags)||(N|=i(n,0));E=r}}function Te(n){if(!E)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(!e.isPrologueDirective(s))return;if(o=s,a=void 0,'"use strict"'===(a=e.getTextOfNodeFromSourceText(t.text,o.expression))||"'use strict'"===a)return void(E=!0)}var o,a}function ke(){he(t,512,'"'+e.removeFileExtension(t.fileName)+'"')}function Ee(e){t.commonJsModuleIndicator||(t.commonJsModuleIndicator=e,t.externalModuleIndicator||ke())}function xe(e){Ee(e),M(t.symbol.exports,t.symbol,e.left,1048580,0)}function Se(t){return e.isExportsIdentifier(t)||e.isModuleExportsPropertyAccessExpression(t)||e.isIdentifier(t)&&Ce(t)}function Ce(t){var n=Ae(t.escapedText);return n&&n.valueDeclaration&&e.isVariableDeclaration(n.valueDeclaration)&&n.valueDeclaration.initializer&&Ie(n.valueDeclaration.initializer)}function Ie(t){return Se(t)||e.isAssignmentExpression(t,!0)&&(Ie(t.left)||Ie(t.right))}function Ae(e){return c.symbol&&c.symbol.exports&&c.symbol.exports.get(e)||c.locals&&c.locals.get(e)}function we(t,n,r){var i=Ae(t);(i&&e.isDeclarationOfFunctionOrClassExpression(i)&&(i=i.valueDeclaration.initializer.symbol),i&&48&i.flags)&&M(r?i.members||(i.members=e.createSymbolTable()):i.exports||(i.exports=e.createSymbolTable()),i,n,4,0)}function Ne(t){E&&_e(t,t.name),e.isBindingPattern(t.name)||(e.isBlockOrCatchScoped(t)?function(e){fe(e,2,107455)}(t):e.isParameterDeclaration(t)?ue(t,1,107455):ue(t,1,107454))}function De(n,r,i){return t.isDeclarationFile||e.isInAmbientContext(n)||!e.isAsyncFunction(n)||(k|=1024),h&&e.isObjectLiteralOrClassExpressionMethod(n)&&(n.flowNode=h),e.hasDynamicName(n)?he(n,r,"__computed"):ue(n,r,i)}}();function i(t,n){var r=t.kind;switch(r){case 181:return function(e,t){var n=t,r=e.expression,i=r.kind;e.typeArguments&&(n|=3);(524288&t||function(e,t){switch(t){case 97:return!0;case 179:case 180:return 97===e.expression.kind}return!1}(r,i))&&(n|=192);91===r.kind&&(n|=67108864,16384&t&&(n|=32768));return e.transformFlags=536870912|n,-537396546&n}(t,n);case 182:return function(e,t){var n=t;e.typeArguments&&(n|=3);524288&t&&(n|=192);return e.transformFlags=536870912|n,-537396546&n}(t,n);case 233:return function(t,n){var r=3;0==(2&e.getModifierFlags(t))&&(r|=n);return t.transformFlags=536870912|r,-574674242&r}(t,n);case 185:return function(e,t){var n=t,r=e.expression,i=r.kind,s=r.transformFlags;202!==i&&184!==i||(n|=3);1024&s&&(n|=1024);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 194:return function(e,t){var n=t,r=e.operatorToken.kind,i=e.left.kind;58===r&&178===i?n|=3272:58===r&&177===i?n|=3264:40!==r&&62!==r||(n|=32);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 210:return function(e,t){var n=t;1024&e.expression.transformFlags&&(n|=192);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 146:return function(t,n){var r=n,i=t.name,s=t.initializer,o=t.dotDotDotToken;(t.questionToken||t.type||4096&n||e.isThisIdentifier(i))&&(r|=3);e.hasModifier(t,92)&&(r|=262147);1048576&n&&(r|=8);(8388608&n||s||o)&&(r|=131264);return t.transformFlags=536870912|r,-536872258&r}(t,n);case 187:return function(t,n){var r=192|n;(e.hasModifier(t,2270)||t.typeParameters||t.type)&&(r|=3);e.hasModifier(t,256)&&(r|=16);1048576&n&&(r|=8);16384&n&&(r|=32768);return t.transformFlags=536870912|r,-601249090&r}(t,n);case 186:return function(t,n){var r=n;(e.hasModifier(t,2270)||t.typeParameters||t.type)&&(r|=3);e.hasModifier(t,256)&&(r|=t.asteriskToken?8:16);1048576&n&&(r|=8);163840&n&&(r|=192);t.asteriskToken&&(r|=768);return t.transformFlags=536870912|r,-601281858&r}(t,n);case 228:return function(t,n){var r,i=e.getModifierFlags(t);!t.body||2&i?r=3:(r=33554432|n,(2270&i||t.typeParameters||t.type)&&(r|=3),256&i&&(r|=t.asteriskToken?8:16),1048576&n&&(r|=8),163840&n&&(r|=192),t.asteriskToken&&(r|=768));return t.transformFlags=536870912|r,-601281858&r}(t,n);case 226:return function(e,t){var n=t;n|=8388800,1048576&t&&(n|=8);e.type&&(n|=3);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 227:return function(e,t){var n=33554432|t;8388608&t&&(n|=192);3&e.flags&&(n|=4194496);return e.transformFlags=536870912|n,-546309442&n}(t,n);case 208:return function(t,n){var r,i=t.declarationList.transformFlags;e.hasModifier(t,2)?r=3:(r=n,8388608&i&&(r|=192));return t.transformFlags=536870912|r,-536872258&r}(t,n);case 222:return function(t,n){var r=n;4194304&n&&e.isIterationStatement(t,!0)&&(r|=192);return t.transformFlags=536870912|r,-536872258&r}(t,n);case 229:return function(t,n){var r;e.hasModifier(t,2)?r=3:(r=192|n,(274432&n||t.typeParameters)&&(r|=3),65536&n&&(r|=16384));return t.transformFlags=536870912|r,-539358530&r}(t,n);case 199:return function(e,t){var n=192|t;(274432&t||e.typeParameters)&&(n|=3);65536&t&&(n|=16384);return e.transformFlags=536870912|n,-539358530&n}(t,n);case 259:return function(t,n){var r=n;switch(t.token){case 85:r|=192;break;case 108:r|=3;break;default:e.Debug.fail("Unexpected token for heritage clause")}return t.transformFlags=536870912|r,-536872258&r}(t,n);case 260:return function(t,n){var r=n;t.variableDeclaration?e.isBindingPattern(t.variableDeclaration.name)&&(r|=192):r|=8;return t.transformFlags=536870912|r,-537920834&r}(t,n);case 201:return function(e,t){var n=192|t;e.typeArguments&&(n|=3);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 152:return function(t,n){var r=n;!e.hasModifier(t,2270)&&t.body||(r|=3);1048576&n&&(r|=8);return t.transformFlags=536870912|r,-601015618&r}(t,n);case 149:return function(e,t){var n=3|t;e.initializer&&(n|=8192);return e.transformFlags=536870912|n,-536872258&n}(t,n);case 151:return function(t,n){var r=192|n;(t.decorators||e.hasModifier(t,2270)||t.typeParameters||t.type||!t.body)&&(r|=3);1048576&n&&(r|=8);e.hasModifier(t,256)&&(r|=t.asteriskToken?8:16);t.asteriskToken&&(r|=768);return t.transformFlags=536870912|r,-601015618&r}(t,n);case 153:case 154:return function(t,n){var r=n;(t.decorators||e.hasModifier(t,2270)||t.type||!t.body)&&(r|=3);1048576&n&&(r|=8);return t.transformFlags=536870912|r,-601015618&r}(t,n);case 237:return function(t,n){var r=n;e.isExternalModuleImportEqualsDeclaration(t)||(r|=3);return t.transformFlags=536870912|r,-536872258&r}(t,n);case 179:return function(e,t){var n=t;97===e.expression.kind&&(n|=16384);return e.transformFlags=536870912|n,-536872258&n}(t,n);default:return function(e,t,n){var r=n,i=536872257;switch(t){case 120:case 191:r|=24;break;case 114:case 112:case 113:case 117:case 124:case 76:case 232:case 264:case 184:case 202:case 203:case 131:r|=3;break;case 249:case 250:case 251:case 10:case 252:case 253:case 254:case 255:case 256:r|=4;break;case 13:case 14:case 15:case 16:case 196:case 183:case 262:case 115:case 204:r|=192;break;case 9:e.hasExtendedUnicodeEscape&&(r|=192);break;case 8:48&e.numericLiteralFlags&&(r|=192);break;case 216:e.awaitModifier&&(r|=8),r|=192;break;case 197:r|=16777416;break;case 119:case 133:case 130:case 134:case 136:case 122:case 137:case 105:case 145:case 148:case 150:case 155:case 156:case 157:case 158:case 159:case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 230:case 231:case 169:case 170:case 171:case 172:case 173:case 236:r=3,i=-3;break;case 144:r|=2097152,16384&n&&(r|=65536);break;case 198:r|=524480;break;case 263:r|=1048584;break;case 97:r|=192;break;case 99:r|=16384;break;case 174:r|=8388800,524288&n&&(r|=1048584),i=537396545;break;case 175:r|=8388800,i=537396545;break;case 176:r|=192,e.dotDotDotToken&&(r|=524288);break;case 147:r|=4099;break;case 178:i=540087617,2097152&n&&(r|=192),65536&n&&(r|=16384),1048576&n&&(r|=8);break;case 177:case 182:i=537396545,524288&n&&(r|=192);break;case 212:case 213:case 214:case 215:4194304&n&&(r|=192);break;case 265:32768&n&&(r|=192);break;case 219:case 217:case 218:r|=33554432}return e.transformFlags=536870912|r,r&~i}(t,r,n)}}function s(e){if(e>=158&&e<=173)return-3;switch(e){case 181:case 182:case 177:return 537396545;case 233:return 574674241;case 146:return 536872257;case 187:return 601249089;case 186:case 228:return 601281857;case 227:return 546309441;case 229:case 199:return 539358529;case 152:return 601015617;case 151:case 153:case 154:return 601015617;case 119:case 133:case 130:case 136:case 134:case 122:case 137:case 105:case 145:case 148:case 150:case 155:case 156:case 157:case 230:case 231:return-3;case 178:return 540087617;case 260:return 537920833;case 174:case 175:return 537396545;default:return 536872257}}function o(t,n){n.parent=t,e.forEachChild(n,(function(e){return o(n,e)}))}e.bindSourceFile=function(t,n){e.performance.mark("beforeBind"),r(t,n),e.performance.mark("afterBind"),e.performance.measure("Bind","beforeBind","afterBind")},e.computeTransformFlagsForNode=i,e.getTransformFlagsSubtreeExclusions=s}(ts||(ts={})),function(e){e.createGetSymbolWalker=function(t,n,r,i,s,o,a,l,c){return function(u){void 0===u&&(u=function(){return!0});var d=[],p=[];return{walkType:function(t){try{return h(t),{visitedTypes:e.getOwnValues(d),visitedSymbols:e.getOwnValues(p)}}finally{e.clear(d),e.clear(p)}},walkSymbol:function(t){try{return _(t),{visitedTypes:e.getOwnValues(d),visitedSymbols:e.getOwnValues(p)}}finally{e.clear(d),e.clear(p)}}};function h(t){if(t&&(!d[t.id]&&(d[t.id]=t,!_(t.symbol)))){if(32768&t.flags){var n=t,i=n.objectFlags;4&i&&function(t){h(t.target),e.forEach(t.typeArguments,h)}(t),32&i&&function(e){h(e.typeParameter),h(e.constraintType),h(e.templateType),h(e.modifiersType)}(t),3&i&&(m(s=t),e.forEach(s.typeParameters,h),e.forEach(r(s),h),h(s.thisType)),24&i&&m(n)}var s;16384&t.flags&&function(e){h(l(e))}(t),196608&t.flags&&function(t){e.forEach(t.types,h)}(t),262144&t.flags&&function(e){h(e.type)}(t),524288&t.flags&&function(e){h(e.objectType),h(e.indexType),h(e.constraint)}(t)}}function f(r){r.typePredicate&&h(r.typePredicate.type),e.forEach(r.typeParameters,h);for(var i=0,s=r.parameters;i<s.length;i++){_(s[i])}h(t(r)),h(n(r))}function m(e){h(a(e,0)),h(a(e,1));for(var t=i(e),n=0,r=t.callSignatures;n<r.length;n++){f(r[n])}for(var s=0,o=t.constructSignatures;s<o.length;s++){f(o[s])}for(var l=0,c=t.properties;l<c.length;l++){_(c[l])}}function _(t){if(t){var n=e.getSymbolId(t);if(!p[n]){if(p[n]=t,!u(t))return!0;h(s(t)),1952&t.flags&&t.exports.forEach(_),e.forEach(t.declarations,(function(e){if(e.type&&162===e.type.kind){var t=e.type;_(o(c(t.exprName)))}}))}}}}}}(ts||(ts={})),function(e){function t(t){t.trace(e.formatMessage.apply(void 0,arguments))}function n(e,t){return e.traceResolution&&void 0!==t.trace}function r(e,t){return t&&{path:t.path,extension:t.ext,packageId:e}}function i(e){return r(void 0,e)}var s;function o(t){if(t)return e.Debug.assert(e.extensionIsTypeScript(t.extension)),{fileName:t.path,packageId:t.packageId}}function a(e,t,n){return{resolvedModule:e&&{resolvedFileName:e.path,extension:e.extension,isExternalLibraryImport:t,packageId:e.packageId},failedLookupLocations:n}}function l(e,t){try{var n=t.readFile(e);return n?JSON.parse(n):{}}catch(e){return{}}}function c(t,n){return t.typeRoots?t.typeRoots:(t.configFilePath?r=e.getDirectoryPath(t.configFilePath):n.getCurrentDirectory&&(r=n.getCurrentDirectory()),void 0!==r?function(t,n){if(!n.directoryExists)return[e.combinePaths(t,u)];var r;return e.forEachAncestorDirectory(e.normalizePath(t),(function(t){var i=e.combinePaths(t,u);n.directoryExists(i)&&(r||(r=[])).push(i)})),r}(r,n):void 0);var r}e.trace=t,e.isTraceEnabled=n,function(e){e[e.TypeScript=0]="TypeScript",e[e.JavaScript=1]="JavaScript",e[e.DtsOnly=2]="DtsOnly"}(s||(s={})),e.getEffectiveTypeRoots=c;var u=e.combinePaths("node_modules","@types");function d(n,r,s,o,a,l){return e.isExternalModuleNameRelative(r)?function(n,r,i,s,o,a){if(!a.compilerOptions.rootDirs)return;a.traceEnabled&&t(a.host,e.Diagnostics.rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0,r);for(var l,c,u=e.normalizePath(e.combinePaths(i,r)),d=0,p=a.compilerOptions.rootDirs;d<p.length;d++){var h=p[d],f=e.normalizePath(h);e.endsWith(f,e.directorySeparator)||(f+=e.directorySeparator);var m=e.startsWith(u,f)&&(void 0===c||c.length<f.length);a.traceEnabled&&t(a.host,e.Diagnostics.Checking_if_0_is_the_longest_matching_prefix_for_1_2,f,u,m),m&&(c=f,l=h)}if(c){a.traceEnabled&&t(a.host,e.Diagnostics.Longest_matching_prefix_for_0_is_1,u,c);var g=u.substr(c.length);a.traceEnabled&&t(a.host,e.Diagnostics.Loading_0_from_the_root_dir_1_candidate_location_2,g,c,u);var y=s(n,u,o,!_(i,a.host),a);if(y)return y;a.traceEnabled&&t(a.host,e.Diagnostics.Trying_other_entries_in_rootDirs);for(var b=0,v=a.compilerOptions.rootDirs;b<v.length;b++){if((h=v[b])!==l){var T=e.combinePaths(e.normalizePath(h),g);a.traceEnabled&&t(a.host,e.Diagnostics.Loading_0_from_the_root_dir_1_candidate_location_2,g,h,T);var k=s(n,T,o,!_(e.getDirectoryPath(T),a.host),a);if(k)return k}}a.traceEnabled&&t(a.host,e.Diagnostics.Module_resolution_using_rootDirs_has_failed)}return}(n,r,s,o,a,l):function(n,r,s,o,a){if(!a.compilerOptions.baseUrl)return;a.traceEnabled&&t(a.host,e.Diagnostics.baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1,a.compilerOptions.baseUrl,r);var l=void 0;a.compilerOptions.paths&&(a.traceEnabled&&t(a.host,e.Diagnostics.paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0,r),l=e.matchPatternOrExact(e.getOwnKeys(a.compilerOptions.paths),r));if(l){var c=e.isString(l)?void 0:e.matchedText(l,r),u=e.isString(l)?l:e.patternText(l);return a.traceEnabled&&t(a.host,e.Diagnostics.Module_name_0_matched_pattern_1,r,u),e.forEach(a.compilerOptions.paths[u],(function(r){var l=c?r.replace("*",c):r,u=e.normalizePath(e.combinePaths(a.compilerOptions.baseUrl,l));a.traceEnabled&&t(a.host,e.Diagnostics.Trying_substitution_0_candidate_module_location_Colon_1,r,l);var d=e.tryGetExtensionFromPath(u);if(void 0!==d){var p=v(u,o,!1,a);if(void 0!==p)return i({path:p,ext:d})}return s(n,u,o,!_(e.getDirectoryPath(u),a.host),a)}))}var d=e.normalizePath(e.combinePaths(a.compilerOptions.baseUrl,r));return a.traceEnabled&&t(a.host,e.Diagnostics.Resolving_module_name_0_relative_to_base_url_1_2,r,a.compilerOptions.baseUrl,d),s(n,d,o,!_(e.getDirectoryPath(d),a.host),a)}(n,r,o,a,l)}function p(t,n,r,i,s){return h(t,e.getDirectoryPath(n),r,i,s,!1)}function h(r,i,o,l,c,u){var p=n(o,l),h=[],_={compilerOptions:o,host:l,traceEnabled:p},g=u?b(s.JavaScript):b(s.TypeScript)||b(s.JavaScript);if(g&&g.value){var y=g.value;return a(y.resolved,y.isExternalLibraryImport,h)}return{resolvedModule:void 0,failedLookupLocations:h};function b(n){var a=d(n,r,i,(function(e,t,n,r,i){return m(e,t,n,r,i,!0)}),h,_);if(a)return L({resolved:a,isExternalLibraryImport:!1});if(e.isExternalModuleNameRelative(r)){var u=e.normalizePathAndParts(e.combinePaths(i,r)),g=u.path,y=u.parts,b=m(n,g,h,!1,_,!0);return b&&L({resolved:b,isExternalLibraryImport:e.contains(y,"node_modules")})}p&&t(l,e.Diagnostics.Loading_module_0_from_node_modules_folder_target_file_type_1,r,s[n]);var v=I(n,r,i,h,_,c);if(v){var T=v.value;return o.preserveSymlinks||(T=T&&__assign({},v.value,{path:f(v.value.path,l,p),extension:v.value.extension})),{value:T&&{resolved:T,isExternalLibraryImport:!0}}}}}function f(n,r,i){if(!r.realpath)return n;var s=e.normalizePath(r.realpath(n));return i&&t(r,e.Diagnostics.Resolving_real_path_for_0_result_1,n,s),s}function m(n,r,o,a,l,c){if(l.traceEnabled&&t(l.host,e.Diagnostics.Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1,r,s[n]),!e.pathEndsWithDirectorySeparator(r)){if(!a){var u=e.getDirectoryPath(r);_(u,l.host)||(l.traceEnabled&&t(l.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,u),a=!0)}var d=y(n,r,o,a,l);if(d)return i(d)}a||(_(r,l.host)||(l.traceEnabled&&t(l.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,r),a=!0));return T(n,r,o,a,l,c)}function _(e,t){return!t.directoryExists||t.directoryExists(e)}function g(e,t,n,r,s){return i(y(e,t,n,r,s))}function y(n,r,i,s,o){var a=b(r,n,i,s,o);if(a)return a;if(e.hasJavaScriptFileExtension(r)){var l=e.removeFileExtension(r);if(o.traceEnabled){var c=r.substring(l.length);t(o.host,e.Diagnostics.File_name_0_has_a_1_extension_stripping_it,r,c)}return b(l,n,i,s,o)}}function b(t,n,r,i,o){if(!i){var a=e.getDirectoryPath(t);a&&(i=!_(a,o.host))}switch(n){case s.DtsOnly:return l(".d.ts");case s.TypeScript:return l(".ts")||l(".tsx")||l(".d.ts");case s.JavaScript:return l(".js")||l(".jsx")}function l(e){var n=v(t+e,r,i,o);return n&&{path:n,ext:e}}}function v(n,r,i,s){if(!i){if(s.host.fileExists(n))return s.traceEnabled&&t(s.host,e.Diagnostics.File_0_exist_use_it_as_a_name_resolution_result,n),n;s.traceEnabled&&t(s.host,e.Diagnostics.File_0_does_not_exist,n)}r.push(n)}function T(e,t,n,i,s,o){void 0===o&&(o=!0);var a=o?E(t,"",n,i,s):{packageJsonContent:void 0,packageId:void 0},l=a.packageJsonContent;return r(a.packageId,k(e,t,n,i,s,l))}function k(n,r,i,o,a,l){var c=l&&function(n,r,i,o,a){var l=function(n,r,i,s){return n?o("typings")||o("types"):o("main");function o(n){if(e.hasProperty(r,n)){var o=r[n];if(e.isString(o)){var a=e.normalizePath(e.combinePaths(i,o));return s.traceEnabled&&t(s.host,e.Diagnostics.package_json_has_0_field_1_that_references_2,n,o,a),a}s.traceEnabled&&t(s.host,e.Diagnostics.Expected_type_of_0_field_in_package_json_to_be_string_got_1,n,typeof o)}else s.traceEnabled&&t(s.host,e.Diagnostics.package_json_does_not_have_a_0_field,n)}}(r!==s.JavaScript,n,i,a);if(!l)return;var c=!_(e.getDirectoryPath(l),a.host),u=v(l,o,c,a);if(u){var d=u&&function(t,n){var r=e.tryGetExtensionFromPath(n);return void 0!==r&&function(e,t){switch(e){case s.JavaScript:return".js"===t||".jsx"===t;case s.TypeScript:return".ts"===t||".tsx"===t||".d.ts"===t;case s.DtsOnly:return".d.ts"===t}}(t,r)?{path:n,ext:r}:void 0}(r,u);if(d)return d;a.traceEnabled&&t(a.host,e.Diagnostics.File_0_has_an_unsupported_extension_so_skipping_it,u)}var p=m(r===s.DtsOnly?s.TypeScript:r,l,o,c,a,!1);if(p)return e.Debug.assert(void 0===p.packageId),{path:p.path,ext:p.extension}}(l,n,r,i,a);if(c)return c;var u=!o&&_(r,a.host);return y(n,e.combinePaths(r,"index"),i,!u,a)}function E(n,r,i,s,o){var a=o.host,c=o.traceEnabled,u=!s&&_(n,a),d=x(n);if(u&&a.fileExists(d)){c&&t(a,e.Diagnostics.Found_package_json_at_0,d);var p=l(d,a);return{found:!0,packageJsonContent:p,packageId:"string"==typeof p.name&&"string"==typeof p.version?{name:p.name,subModuleName:r,version:p.version}:void 0}}return u&&c&&t(a,e.Diagnostics.File_0_does_not_exist,d),i.push(d),{found:!1,packageJsonContent:void 0,packageId:void 0}}function x(t){return e.combinePaths(t,"package.json")}function S(t,n,i,s,o,a){var l,c,u=e.normalizePath(e.combinePaths(i,n)),d=E(u,"",o,!s,a);if(d.found)l=d.packageJsonContent,c=d.packageId;else{var p=C(n),h=p.packageName,f=p.rest;if(""!==f)c=E(e.combinePaths(i,h),f,o,!s,a).packageId}return r(c,y(t,u,o,!s,a)||k(t,u,o,!s,a,l))}function C(t){var n=t.indexOf(e.directorySeparator);return"@"===t[0]&&(n=t.indexOf(e.directorySeparator,n+1)),-1===n?{packageName:t,rest:""}:{packageName:t.slice(0,n),rest:t.slice(n+1)}}function I(e,t,n,r,i,s){return A(e,t,n,r,i,!1,s)}function A(t,n,r,i,s,o,a){var l=a&&a.getOrCreateCacheForModuleName(n);return e.forEachAncestorDirectory(e.normalizeSlashes(r),(function(r){if("node_modules"!==e.getBaseFileName(r)){var a=O(l,n,r,s.traceEnabled,s.host);return a||L(w(t,n,r,i,s,o))}}))}function w(n,r,i,o,a,l){void 0===l&&(l=!1);var c=e.combinePaths(i,"node_modules"),u=_(c,a.host);!u&&a.traceEnabled&&t(a.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,c);var d=l?void 0:S(n,r,c,u,o,a);if(d)return d;if(n!==s.JavaScript){var p=e.combinePaths(c,"@types"),h=u;return u&&!_(p,a.host)&&(a.traceEnabled&&t(a.host,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,p),h=!1),S(s.DtsOnly,function(n,r){var i=D(n);r.traceEnabled&&i!==n&&t(r.host,e.Diagnostics.Scoped_package_detected_looking_in_0,i);return i}(r,a),p,h,o,a)}}e.resolveTypeReferenceDirective=function(r,i,a,l){var u=n(a,l),d={compilerOptions:a,host:l,traceEnabled:u},p=c(a,l);u&&(void 0===i?void 0===p?t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set,r):t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1,r,p):void 0===p?t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set,r,i):t(l,e.Diagnostics.Resolving_type_reference_directive_0_containing_file_1_root_directory_2,r,i,p));var h,m=[],g=function(){if(p&&p.length)return u&&t(l,e.Diagnostics.Resolving_with_primary_search_path_0,p.join(", ")),e.forEach(p,(function(n){var i=e.combinePaths(n,r),a=e.getDirectoryPath(i),c=_(a,l);return!c&&u&&t(l,e.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,a),o(T(s.DtsOnly,i,m,!c,d))}));u&&t(l,e.Diagnostics.Root_directory_cannot_be_determined_skipping_primary_search_paths)}(),y=!0;return g||(g=function(){var n,a=i&&e.getDirectoryPath(i);if(void 0!==a){u&&t(l,e.Diagnostics.Looking_up_in_node_modules_folder_initial_location_0,a);var c=I(s.DtsOnly,r,a,m,d,void 0);return!(n=o(c&&c.value))&&u&&t(l,e.Diagnostics.Type_reference_directive_0_was_not_resolved,r),n}u&&t(l,e.Diagnostics.Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_modules_folder)}(),y=!1),g&&(a.preserveSymlinks||(g=__assign({},g,{fileName:f(g.fileName,l,u)})),u&&t(l,e.Diagnostics.Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2,r,g.fileName,y),h={primary:y,resolvedFileName:g.fileName,packageId:g.packageId}),{resolvedTypeReferenceDirective:h,failedLookupLocations:m}},e.getAutomaticTypeDirectiveNames=function(t,n){if(t.types)return t.types;var r=[];if(n.directoryExists&&n.getDirectories){var i=c(t,n);if(i)for(var s=0,o=i;s<o.length;s++){var a=o[s];if(n.directoryExists(a))for(var u=0,d=n.getDirectories(a);u<d.length;u++){var p=d[u],h=e.normalizePath(p),f=x(e.combinePaths(a,h));n.fileExists(f)&&null===l(f,n).typings||r.push(e.getBaseFileName(h))}}}return r},e.createModuleResolutionCache=function(t,n){var r=e.createMap(),i=e.createMap();return{getOrCreateCacheForDirectory:function(i){var s=e.toPath(i,t,n),o=r.get(s);o||(o=e.createMap(),r.set(s,o));return o},getOrCreateCacheForModuleName:function(r){if(e.isExternalModuleNameRelative(r))return;var s=i.get(r);s||(s=function(){var r=e.createMap();return{get:i,set:s};function i(i){return r.get(e.toPath(i,t,n))}function s(i,s){var a=e.toPath(i,t,n);if(!r.has(a)){r.set(a,s);for(var l=o(a,s.resolvedModule&&s.resolvedModule.resolvedFileName),c=a;;){var u=e.getDirectoryPath(c);if(u===c||r.has(u))break;if(r.set(u,s),(c=u)===l)break}}}function o(r,i){if(void 0!==i){for(var s=e.toPath(e.getDirectoryPath(i),t,n),o=0;o<Math.min(r.length,s.length)&&r.charCodeAt(o)===s.charCodeAt(o);)o++;var a=r.lastIndexOf(e.directorySeparator,o);if(!(a<0))return r.substr(0,a)}}}(),i.set(r,s));return s}}},e.resolveModuleName=function(r,i,s,o,a){var l=n(s,o);l&&t(o,e.Diagnostics.Resolving_module_0_from_1,r,i);var c=e.getDirectoryPath(i),u=a&&a.getOrCreateCacheForDirectory(c),d=u&&u.get(r);if(d)l&&t(o,e.Diagnostics.Resolution_for_module_0_was_found_in_cache,r);else{var h=s.moduleResolution;switch(void 0===h?(h=e.getEmitModuleKind(s)===e.ModuleKind.CommonJS?e.ModuleResolutionKind.NodeJs:e.ModuleResolutionKind.Classic,l&&t(o,e.Diagnostics.Module_resolution_kind_is_not_specified_using_0,e.ModuleResolutionKind[h])):l&&t(o,e.Diagnostics.Explicitly_specified_module_resolution_kind_Colon_0,e.ModuleResolutionKind[h]),h){case e.ModuleResolutionKind.NodeJs:d=p(r,i,s,o,a);break;case e.ModuleResolutionKind.Classic:d=R(r,i,s,o,a);break;default:e.Debug.fail("Unexpected moduleResolution: "+h)}if(u){u.set(r,d);var f=a.getOrCreateCacheForModuleName(r);f&&f.set(c,d)}}return l&&(d.resolvedModule?t(o,e.Diagnostics.Module_name_0_was_successfully_resolved_to_1,r,d.resolvedModule.resolvedFileName):t(o,e.Diagnostics.Module_name_0_was_not_resolved,r)),d},e.nodeModuleNameResolver=p,e.resolveJavaScriptModule=function(t,n,r){var i=h(t,n,{moduleResolution:e.ModuleResolutionKind.NodeJs,allowJs:!0},r,void 0,!0),s=i.resolvedModule,o=i.failedLookupLocations;if(!s)throw new Error("Could not resolve JS module '"+t+"' starting at '"+n+"'. Looked in: "+o.join(", "));return s.resolvedFileName},e.directoryProbablyExists=_,e.getPackageName=C;var N="__";function D(t){if(e.startsWith(t,"@")){var n=t.replace(e.directorySeparator,N);if(n!==t)return n.slice(1)}return t}function O(n,r,i,s,o){var a=n&&n.get(i);if(a)return s&&t(o,e.Diagnostics.Resolution_for_module_0_was_found_in_cache,r),{value:a.resolvedModule&&{path:a.resolvedModule.resolvedFileName,extension:a.resolvedModule.extension,packageId:a.resolvedModule.packageId}}}function R(t,r,i,o,l){var c=n(i,o),u={compilerOptions:i,host:o,traceEnabled:c},p=[],h=e.getDirectoryPath(r),f=m(s.TypeScript)||m(s.JavaScript);return a(f&&f.value,!1,p);function m(n){var r=d(n,t,h,g,p,u);if(r)return{value:r};var i=l&&l.getOrCreateCacheForModuleName(t);if(e.isExternalModuleNameRelative(t)){var a=e.normalizePath(e.combinePaths(h,t));return L(g(n,a,p,!1,u))}var f=e.forEachAncestorDirectory(h,(function(r){var s=O(i,t,r,c,o);if(s)return s;var a=e.normalizePath(e.combinePaths(r,t));return L(g(n,a,p,!1,u))}));return f||(n===s.TypeScript?function(e,t,n,r){return A(s.DtsOnly,e,t,n,r,!0,void 0)}(t,h,p,u):void 0)}}function L(e){return void 0!==e?{value:e}:void 0}e.getTypesPackageName=function(e){return"@types/"+D(e)},e.getPackageNameFromAtTypesDirectory=function(t){var n=e.removePrefix(t,"@types/");return n!==t?e.stringContains(n,N)?"@"+n.replace(N,e.directorySeparator):n:t},e.classicNameResolver=R,e.loadModuleFromGlobalCache=function(r,i,o,l,c){var u=n(o,l);u&&t(l,e.Diagnostics.Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using_cache_location_2,i,r,c);var d={compilerOptions:o,host:l,traceEnabled:u},p=[];return a(w(s.DtsOnly,r,c,p,d),!0,p)}}(ts||(ts={})),function(e){var t=/^".+"$/,n=1,r=1,i=1,s=1;function o(e){return e.id||(e.id=r,r++),e.id}function a(e){return e.id||(e.id=n,n++),e.id}function l(t,n){var r=e.getModuleInstanceState(t);return 1===r||n&&2===r}function c(t){switch(t.parent.kind){case 242:case 246:return!0;default:return e.isDeclarationName(t)}}function u(e){switch(e.kind){case 239:case 237:case 240:case 242:return!0;case 71:return 242===e.parent.kind;default:return!1}}e.getNodeId=o,e.getSymbolId=a,e.isInstantiatedModule=l,e.createTypeChecker=function(n,r){var d,p,h,f=e.objectAllocator.getSymbolConstructor(),m=e.objectAllocator.getTypeConstructor(),_=e.objectAllocator.getSignatureConstructor(),g=0,y=0,b=0,v=0,T=e.createSymbolTable(),k=e.identity,E=n.getCompilerOptions(),x=e.getEmitScriptTarget(E),S=e.getEmitModuleKind(E),C=!!E.noUnusedLocals||!!E.noUnusedParameters,I=void 0!==E.allowSyntheticDefaultImports?E.allowSyntheticDefaultImports:S===e.ModuleKind.System,A=void 0===E.strictNullChecks?E.strict:E.strictNullChecks,w=void 0===E.strictFunctionTypes?E.strict:E.strictFunctionTypes,N=void 0===E.noImplicitAny?E.strict:E.noImplicitAny,D=void 0===E.noImplicitThis?E.strict:E.noImplicitThis,O=function(){var t,r=n.getResolvedTypeReferenceDirectives();r&&(t=e.createMap(),r.forEach((function(e,r){if(e){var i=n.getSourceFile(e.resolvedFileName);t.set(i.path,r)}})));return{getReferencedExportContainer:Cf,getReferencedImportDeclaration:If,getReferencedDeclarationWithCollidingName:wf,isDeclarationWithCollidingName:Nf,isValueAliasDeclaration:function(t){return!(t=e.getParseTreeNode(t))||Df(t)},hasGlobalName:zf,isReferencedAliasDeclaration:function(t,n){return!(t=e.getParseTreeNode(t))||Pf(t,n)},getNodeCheckFlags:function(t){return(t=e.getParseTreeNode(t))?Bf(t):void 0},isTopLevelValueImportEqualsWithEntityName:Of,isDeclarationVisible:Pr,isImplementationOfOverload:Mf,isRequiredInitializedParameter:Ff,isOptionalUninitializedParameterProperty:$f,writeTypeOfDeclaration:jf,writeReturnTypeOfSignatureDeclaration:Kf,writeTypeOfExpression:Wf,isSymbolAccessible:gr,isEntityNameVisible:vr,getConstantValue:function(t){return(t=e.getParseTreeNode(t,Vf))?Hf(t):void 0},collectLinkedAliases:Mr,getReferencedValueDeclaration:Jf,getTypeReferenceSerializationKind:Gf,isOptionalParameter:Ns,moduleExportsSomeValue:Sf,isArgumentsLocalBinding:xf,getExternalModuleFileFromDeclaration:Qf,getTypeReferenceDirectivesForEntityName:function(e){if(!t)return;var n=179===e.kind||71===e.kind&&Kl(e)?1156031:794600,r=Vn(e,n,!0);return r&&r!==K?i(r,n):void 0},getTypeReferenceDirectivesForSymbol:i,isLiteralConstDeclaration:Yf,writeLiteralConstValue:Xf,getJsxFactoryEntity:function(){return Dt}};function i(n,r){if(t&&function(n){if(!n.declarations)return!1;var r=n;for(;;){var i=tr(r);if(!i)break;r=i}if(r.valueDeclaration&&265===r.valueDeclaration.kind&&512&r.flags)return!1;for(var s=0,o=n.declarations;s<o.length;s++){var a=o[s],l=e.getSourceFileOfNode(a);if(t.has(l.path))return!0}return!1}(n)){for(var i,s=0,o=n.declarations;s<o.length;s++){var a=o[s];if(a.symbol&&a.symbol.flags&r){var l=e.getSourceFileOfNode(a),c=t.get(l.path);if(!c)return;(i||(i=[])).push(c)}}return i}}}(),R=function(){return{typeToTypeNode:function(e,r,i){var s=t(r,i),o=n(e,s);return s.encounteredError?void 0:o},indexInfoToIndexSignatureDeclaration:function(e,n,r,s){var o=t(r,s),a=i(e,n,o);return o.encounteredError?void 0:a},signatureToSignatureDeclaration:function(e,n,r,i){var o=t(r,i),a=s(e,n,o);return o.encounteredError?void 0:a}};function t(e,t){return{enclosingDeclaration:e,flags:t,encounteredError:!1,symbolStack:void 0}}function n(t,a){var c=a.flags&e.NodeBuilderFlags.InTypeAlias;if(a.flags&=~e.NodeBuilderFlags.InTypeAlias,t){if(1&t.flags)return e.createKeywordTypeNode(119);if(2&t.flags)return e.createKeywordTypeNode(136);if(4&t.flags)return e.createKeywordTypeNode(133);if(8&t.flags)return e.createKeywordTypeNode(122);if(256&t.flags&&!(65536&t.flags)){var u=tr(t.symbol),d=l(u,a,793064,!1),p=Oi(u)===t?d:e.createQualifiedName(d,Rr(t.symbol,a));return e.createTypeReferenceNode(p,void 0)}if(272&t.flags){var h=l(t.symbol,a,793064,!1);return e.createTypeReferenceNode(h,void 0)}if(32&t.flags)return e.createLiteralTypeNode(e.setEmitFlags(e.createLiteral(t.value),16777216));if(64&t.flags)return e.createLiteralTypeNode(e.createLiteral(t.value));if(128&t.flags)return"true"===t.intrinsicName?e.createTrue():e.createFalse();if(1024&t.flags)return e.createKeywordTypeNode(105);if(2048&t.flags)return e.createKeywordTypeNode(139);if(4096&t.flags)return e.createKeywordTypeNode(95);if(8192&t.flags)return e.createKeywordTypeNode(130);if(512&t.flags)return e.createKeywordTypeNode(137);if(16777216&t.flags)return e.createKeywordTypeNode(134);if(16384&t.flags&&t.isThisType)return a.flags&e.NodeBuilderFlags.InObjectTypeLiteral&&(a.encounteredError||a.flags&e.NodeBuilderFlags.AllowThisInObjectLiteral||(a.encounteredError=!0)),e.createThis();var f=yn(t);if(4&f)return e.Debug.assert(!!(32768&t.flags)),function(t){var i=t.typeArguments||e.emptyArray;if(t.target===xe){if(a.flags&e.NodeBuilderFlags.WriteArrayAsGenericType){var s=n(i[0],a);return e.createTypeReferenceNode("Array",[s])}var o=n(i[0],a);return e.createArrayTypeNode(o)}if(8&t.target.objectFlags){if(i.length>0){var l=r(i.slice(0,Zs(t)),a);if(l&&l.length>0)return e.createTupleTypeNode(l)}return a.encounteredError||a.flags&e.NodeBuilderFlags.AllowEmptyTuple?e.createTupleTypeNode([]):void(a.encounteredError=!0)}var c=t.target.outerTypeParameters,u=0,d=void 0;if(c)for(var p=c.length;u<p;){var h=u,f=qs(c[u]);do{u++}while(u<p&&qs(c[u])===f);if(!e.rangeEquals(c,i,h,u)){var m=r(i.slice(h,u),a),_=m&&e.createNodeArray(m),g=v(f);(71===g.kind?g:g.right).typeArguments=_,d?(e.Debug.assert(!d.right),d=T(d,g),d=e.createQualifiedName(d,void 0)):d=e.createQualifiedName(g,void 0)}}var y=void 0,b=v(t.symbol);d?(e.Debug.assert(!d.right),y=d=T(d,b)):y=b;var k=void 0;if(i.length>0){var E=(t.target.typeParameters||e.emptyArray).length;k=r(i.slice(u,E),a)}return k&&((71===y.kind?y:y.right).typeArguments=void 0),e.createTypeReferenceNode(y,k)}(t);if(16384&t.flags||3&f){h=t.symbol?l(t.symbol,a,793064,!1):e.createIdentifier("?");return e.createTypeReferenceNode(h,void 0)}if(!c&&t.aliasSymbol&&_r(t.aliasSymbol,a.enclosingDeclaration)){h=v(t.aliasSymbol);var m=r(t.aliasTypeArguments,a);return e.createTypeReferenceNode(h,m)}if(196608&t.flags){var _=r(65536&t.flags?Ar(t.types):t.types,a);return _&&_.length>0?e.createUnionOrIntersectionTypeNode(65536&t.flags?166:167,_):void(a.encounteredError||a.flags&e.NodeBuilderFlags.AllowEmptyUnionOrIntersection||(a.encounteredError=!0))}if(48&f)return e.Debug.assert(!!(32768&t.flags)),function(t){var n=t.symbol;if(n){if(32&n.flags&&!oi(n)||896&n.flags||o())return function(t,n){var r=l(t,a,n,!1);return e.createTypeQueryNode(r)}(n,107455);if(e.contains(a.symbolStack,n)){var r=Nr(t);if(r){var i=l(r,a,793064,!1);return e.createTypeReferenceNode(i,void 0)}return e.createKeywordTypeNode(119)}a.symbolStack||(a.symbolStack=[]),a.symbolStack.push(n);var s=b(t);return a.symbolStack.pop(),s}return b(t);function o(){var t=!!(8192&n.flags)&&e.some(n.declarations,(function(t){return e.hasModifier(t,32)})),r=!!(16&n.flags)&&(n.parent||e.forEach(n.declarations,(function(e){return 265===e.parent.kind||234===e.parent.kind})));if(t||r)return e.contains(a.symbolStack,n)}}(t);if(262144&t.flags){var g=n(t.type,a);return e.createTypeOperatorNode(g)}if(524288&t.flags){var y=n(t.objectType,a);g=n(t.indexType,a);return e.createIndexedAccessTypeNode(y,g)}e.Debug.fail("Should be unreachable.")}else a.encounteredError=!0;function b(t){if(rs(t))return function(t){e.Debug.assert(!!(32768&t.flags));var r=t.declaration&&t.declaration.readonlyToken?e.createToken(131):void 0,i=t.declaration&&t.declaration.questionToken?e.createToken(55):void 0,s=o(es(t),a),l=n(ns(t),a),c=e.createMappedTypeNode(r,s,i,l);return e.setEmitFlags(c,1)}(t);var r=is(t);if(!r.properties.length&&!r.stringIndexInfo&&!r.numberIndexInfo){if(!r.callSignatures.length&&!r.constructSignatures.length)return e.setEmitFlags(e.createTypeLiteralNode(void 0),1);if(1===r.callSignatures.length&&!r.constructSignatures.length)return s(r.callSignatures[0],160,a);if(1===r.constructSignatures.length&&!r.callSignatures.length)return s(r.constructSignatures[0],161,a)}var c=a.flags;a.flags|=e.NodeBuilderFlags.InObjectTypeLiteral;var u=function(t){for(var r=[],o=0,c=t.callSignatures;o<c.length;o++){var u=c[o];r.push(s(u,155,a))}for(var d=0,p=t.constructSignatures;d<p.length;d++){u=p[d];r.push(s(u,156,a))}t.stringIndexInfo&&r.push(i(t.stringIndexInfo,0,a));t.numberIndexInfo&&r.push(i(t.numberIndexInfo,1,a));var h=t.properties;if(!h)return r;for(var f=0,m=h;f<m.length;f++){var _=m[f],g=li(_),y=a.enclosingDeclaration;a.enclosingDeclaration=void 0;var b=l(_,a,107455,!0);a.enclosingDeclaration=y;var v=16777216&_.flags?e.createToken(55):void 0;if(8208&_.flags&&!ss(g).length)for(var T=0,k=Ts(g,0);T<k.length;T++){var E=s(u=k[T],150,a);E.name=b,E.questionToken=v,r.push(E)}else{var x=g?n(g,a):e.createKeywordTypeNode(119),S=ep(_)?[e.createToken(131)]:void 0,C=e.createPropertySignature(S,b,v,x,void 0);r.push(C)}}return r.length?r:void 0}(r);a.flags=c;var d=e.createTypeLiteralNode(u);return e.setEmitFlags(d,1)}function v(t){return 32&t.flags||!lr(t.escapedName)?l(t,a,793064,!1):e.createIdentifier("")}function T(t,n){if(e.Debug.assert(void 0===t.right),71===n.kind)return t.right=n,t;for(var r=n;71!==r.left.kind;)r=r.left;return t.right=r.left,r.left=t,n}}function r(t,r){if(e.some(t)){for(var i=[],s=0;s<t.length;++s){var o=n(t[s],r);o&&i.push(o)}return i}}function i(t,r,i){var s=e.getNameFromIndexInfo(t)||"x",o=e.createKeywordTypeNode(0===r?136:133),a=e.createParameter(void 0,void 0,void 0,s,void 0,o,void 0),l=n(t.type,i);return e.createIndexSignature(void 0,t.isReadonly?[e.createToken(131)]:void 0,[a],l)}function s(t,r,i){var s,l=t.typeParameters&&t.typeParameters.map((function(e){return o(e,i)})),c=t.parameters.map((function(e){return a(e,i)}));if(t.thisParameter){var u=a(t.thisParameter,i);c.unshift(u)}if(t.typePredicate){var d=t.typePredicate,p=1===d.kind?e.setEmitFlags(e.createIdentifier(d.parameterName),16777216):e.createThisTypeNode(),h=n(d.type,i);s=e.createTypePredicateNode(p,h)}else{var f=Ms(t);s=f&&n(f,i)}return i.flags&e.NodeBuilderFlags.SuppressAnyReturnType?s&&119===s.kind&&(s=void 0):s||(s=e.createKeywordTypeNode(119)),e.createSignatureDeclaration(r,l,c,s)}function o(t,r){var i=l(t.symbol,r,793064,!0),s=zs(t),o=s&&n(s,r),a=fs(t),c=a&&n(a,r);return e.createTypeParameterDeclaration(i,o,c)}function a(t,r){var i=e.getDeclarationOfKind(t,146);if(un(t)&&t.isRestParameter)return e.createParameter(void 0,void 0,t.isRestParameter?e.createToken(24):void 0,"args",void 0,n(De,r),void 0);var s=i.modifiers&&i.modifiers.map(e.getSynthesizedClone),o=e.isRestParameter(i)?e.createToken(24):void 0,a=i.name?71===i.name.kind?e.setEmitFlags(e.getSynthesizedClone(i.name),16777216):function t(n){var r=e.visitEachChild(n,t,e.nullTransformationContext,void 0,t),i=e.nodeIsSynthesized(r)?r:e.getSynthesizedClone(r);return 176===i.kind&&(i.initializer=void 0),e.setEmitFlags(i,16777217)}(i.name):e.symbolName(t),l=Ns(i)?e.createToken(55):void 0,c=li(t);Ff(i)&&(c=vl(c,2048));var u=n(c,r);return e.createParameter(void 0,s,o,a,l,u,void 0)}function l(t,n,i,s){var o;return!(262144&t.flags)&&(n.enclosingDeclaration||n.flags&e.NodeBuilderFlags.UseFullyQualifiedType)?(o=function t(r,i,s){var o,a=fr(r,n.enclosingDeclaration,i,!1);if(!a||mr(a[0],n.enclosingDeclaration,1===a.length?i:hr(i))){var l=tr(a?a[0]:r);if(l){var c=t(l,hr(i),!1);c&&(o=l,a=c.concat(a||[r]))}}if(a)return a;if(s||(o||!e.forEach(r.declarations,yr))&&!(6144&r.flags))return[r]}(t,i,!0),e.Debug.assert(o&&o.length>0)):o=[t],!s||1===o.length||n.encounteredError||n.flags&e.NodeBuilderFlags.AllowQualifedNameInPlaceOfIdentifier||(n.encounteredError=!0),function t(i,s){e.Debug.assert(i&&0<=s&&s<i.length);var o,a=i[s];if(n.flags&e.NodeBuilderFlags.WriteTypeParametersInQualifiedName&&s>0){var l=i[s-1],c=void 0;if(1&e.getCheckFlags(a))c=_i(l);else 524384&Kh(l).flags&&(c=mi(a));o=r(c,n)}var u=Rr(a,n),d=e.setEmitFlags(e.createIdentifier(u,o),16777216);return s>0?e.createQualifiedName(t(i,s-1),d):d}(o,o.length-1)}}(),L=cn(4,"undefined");L.declarations=[];var P,M,F=cn(4,"arguments"),$={getNodeCount:function(){return e.sum(n.getSourceFiles(),"nodeCount")},getIdentifierCount:function(){return e.sum(n.getSourceFiles(),"identifierCount")},getSymbolCount:function(){return e.sum(n.getSourceFiles(),"symbolCount")+y},getTypeCount:function(){return g},isUndefinedSymbol:function(e){return e===L},isArgumentsSymbol:function(e){return e===F},isUnknownSymbol:function(e){return e===K},getMergedSymbol:Zn,getDiagnostics:df,getGlobalDiagnostics:function(){return pf(),wt.getGlobalDiagnostics()},getTypeOfSymbolAtLocation:function(t,n){return(n=e.getParseTreeNode(n))?function(t,n){if(t=t.exportSymbol||t,71===n.kind&&(e.isRightSideOfQualifiedNameOrPropertyAccess(n)&&(n=n.parent),e.isPartOfExpression(n)&&!e.isAssignmentTarget(n))){var r=Cp(n);if(nr(gn(n).resolvedSymbol)===t)return r}return li(t)}(t,n):J},getSymbolsOfParameterPropertyDeclaration:function(t,n){return t=e.getParseTreeNode(t,e.isParameter),e.Debug.assert(void 0!==t,"Cannot get symbols of a synthetic parameter that cannot be resolved to a parse-tree node."),function(t,n){var r=t.parent,i=t.parent.parent,s=vn(r.locals,n,107455),o=vn(i.symbol.members,n,107455);if(s&&o)return[s,o];e.Debug.fail("There should exist two symbols, one as property declaration and one as parameter declaration")}(t,e.escapeLeadingUnderscores(n))},getDeclaredTypeOfSymbol:Oi,getPropertiesOfType:as,getPropertyOfType:function(t,n){return bs(t,e.escapeLeadingUnderscores(n))},getIndexInfoOfType:xs,getSignaturesOfType:Ts,getIndexTypeOfType:Ss,getBaseTypes:Ei,getBaseTypeOfLiteralType:pl,getWidenedType:Il,getTypeFromTypeNode:function(t){return(t=e.getParseTreeNode(t,e.isTypeNode))?pa(t):J},getParameterType:Ud,getReturnTypeOfSignature:Ms,getNullableType:vl,getNonNullableType:Tl,typeToTypeNode:R.typeToTypeNode,indexInfoToIndexSignatureDeclaration:R.indexInfoToIndexSignatureDeclaration,signatureToSignatureDeclaration:R.signatureToSignatureDeclaration,getSymbolsInScope:function(t,n){return(t=e.getParseTreeNode(t))?function(t,n){if(hf(t))return[];var r=e.createSymbolTable(),i=!1;return s(),Is(r);function s(){for(;t;){switch(t.locals&&!bn(t)&&a(t.locals,n),t.kind){case 233:a(er(t).exports,2623475&n);break;case 232:a(er(t).exports,8&n);break;case 199:t.name&&o(t.symbol,n);case 229:case 230:i||a(er(t).members,793064&n);break;case 186:t.name&&o(t.symbol,n)}e.introducesArgumentsExoticObject(t)&&o(F,n),i=e.hasModifier(t,32),t=t.parent}a(ot,n)}function o(t,n){if(e.getCombinedLocalAndExportSymbolFlags(t)&n){var i=t.escapedName;r.has(i)||r.set(i,t)}}function a(e,t){t&&e.forEach((function(e){o(e,t)}))}}(t,n):[]},getSymbolAtLocation:function(t){return(t=e.getParseTreeNode(t))?vf(t):void 0},getShorthandAssignmentValueSymbol:function(t){return(t=e.getParseTreeNode(t))?function(e){if(e&&262===e.kind)return Vn(e.name,2204607);return}(t):void 0},getExportSpecifierLocalTargetSymbol:function(t){return(t=e.getParseTreeNode(t,e.isExportSpecifier))?function(e){return e.parent.parent.moduleSpecifier?Dn(e.parent.parent,e):Vn(e.propertyName||e.name,2998271)}(t):void 0},getExportSymbolOfSymbol:function(e){return Zn(e.exportSymbol||e)},getTypeAtLocation:function(t){return(t=e.getParseTreeNode(t))?Tf(t):J},getPropertySymbolOfDestructuringAssignment:function(t){return(t=e.getParseTreeNode(t,e.isIdentifier))?function(e){var t=kf(e.parent.parent);return t&&bs(t,e.escapedText)}(t):void 0},signatureToString:function(t,n,r,i){return Sr(t,e.getParseTreeNode(n),r,i)},typeToString:function(t,n,r){return Cr(t,e.getParseTreeNode(n),r)},getSymbolDisplayBuilder:Lr,symbolToString:function(t,n,r){return xr(t,e.getParseTreeNode(n),r)},getAugmentedPropertiesOfType:function(t){t=ms(t);var n=e.createSymbolTable(as(t));(Ts(t,0).length||Ts(t,1).length)&&e.forEach(as(Ee),(function(e){n.has(e.escapedName)||n.set(e.escapedName,e)}));return cr(n)},getRootSymbols:function t(n){if(6&e.getCheckFlags(n)){var r=[],i=n.escapedName;return e.forEach(_n(n).containingType.types,(function(e){var t=bs(e,i);t&&r.push(t)})),r}if(33554432&n.flags){var s=n;if(s.leftSpread)return t(s.leftSpread).concat(t(s.rightSpread));if(s.syntheticOrigin)return t(s.syntheticOrigin);for(var o=void 0,a=n;a=_n(a).target;)o=a;if(o)return[o]}return[n]},getContextualType:function(t){return(t=e.getParseTreeNode(t,e.isExpression))?cu(t):void 0},getFullyQualifiedName:Un,getResolvedSignature:function(t,n,r){t=e.getParseTreeNode(t,e.isCallLikeExpression),P=r;var i=t?Dd(t,n):void 0;return P=void 0,i},getConstantValue:function(t){return(t=e.getParseTreeNode(t,Vf))?Hf(t):void 0},isValidPropertyAccess:function(t,n){return!!(t=e.getParseTreeNode(t,e.isPropertyAccessOrQualifiedName))&&function(e,t){var n=179===e.kind?e.expression:e.left;return ed(e,n,t,Il(Ip(n)))}(t,e.escapeLeadingUnderscores(n))},getSignatureFromDeclaration:function(t){return(t=e.getParseTreeNode(t,e.isFunctionLike))?Rs(t):void 0},isImplementationOfOverload:function(t){var n=e.getParseTreeNode(t,e.isFunctionLike);return n?Mf(n):void 0},getImmediateAliasedSymbol:function(t){e.Debug.assert(0!=(2097152&t.flags),"Should only get Alias here.");var n=_n(t);if(!n.immediateTarget){var r=Nn(t);e.Debug.assert(!!r),n.immediateTarget=Rn(r,!0)}return n.immediateTarget},getAliasedSymbol:Mn,getEmitResolver:function(e,t){return df(e,t),O},getExportsOfModule:qn,getExportsAndPropertiesOfModule:function(t){var n=qn(t),r=Kn(t);r!==t&&e.addRange(n,as(li(r)));return n},getSymbolWalker:e.createGetSymbolWalker(Fs,Ms,Ei,is,li,jl,Es,zs,Zh),getAmbientModules:function(){ve||(ve=[],ot.forEach((function(e,n){t.test(n)&&ve.push(e)})));return ve},getAllAttributesTypeFromJsxOpeningLikeElement:function(t){return(t=e.getParseTreeNode(t,e.isJsxOpeningLikeElement))?function(e){return Su(e.tagName)?Lu(e):Pu(e,!0)}(t):void 0},getJsxIntrinsicTagNames:function(){var t=Iu(Wt);return t?as(t):e.emptyArray},isOptionalParameter:function(t){return!!(t=e.getParseTreeNode(t,e.isParameter))&&Ns(t)},tryGetMemberInModuleExports:function(t,n){return Jn(e.escapeLeadingUnderscores(t),n)},tryGetMemberInModuleExportsAndProperties:function(t,n){return function(e,t){var n=Jn(e,t);if(!n){var r=Kn(t);if(r!==t)return bs(li(r),e)}return n}(e.escapeLeadingUnderscores(t),n)},tryFindAmbientModuleWithoutAugmentations:function(e){return ws(e,!1)},getApparentType:ms,getUnionType:Uo,createAnonymousType:dr,createSignature:Hi,createSymbol:cn,createIndexInfo:Ks,getAnyType:function(){return z},getStringType:function(){return ee},getNumberType:function(){return te},createPromiseType:jd,createArrayType:No,getBooleanType:function(){return ie},getVoidType:function(){return oe},getUndefinedType:function(){return Y},getNullType:function(){return Q},getESSymbolType:function(){return se},getNeverType:function(){return ae},isSymbolAccessible:gr,isArrayLikeType:ll,getAllPossiblePropertiesOfTypes:function(t){var n=Uo(t);if(!(65536&n.flags))return as(n);for(var r=e.createSymbolTable(),i=0,s=t;i<s.length;i++)for(var o=s[i],a=0,l=as(o);a<l.length;a++){var c=l[a].escapedName;r.has(c)||r.set(c,_s(n,c))}return e.arrayFrom(r.values())},getSuggestionForNonexistentProperty:function(e,t){return Yu(e,t)},getSuggestionForNonexistentSymbol:function(t,n,r){return Xu(t,e.escapeLeadingUnderscores(n),r)},getBaseConstraintOfType:us,resolveName:function(t,n,r){return kn(n,e.escapeLeadingUnderscores(t),r,void 0,void 0,!1)},getJsxNamespace:function(){return e.unescapeLeadingUnderscores(an())}},B=[],U=e.createMap(),V=e.createMap(),H=e.createMap(),G=e.createMap(),j=[],K=cn(4,"unknown"),W=cn(0,"__resolving__"),z=or(1,"any"),q=or(1,"any"),J=or(1,"unknown"),Y=or(2048,"undefined"),X=A?Y:or(2099200,"undefined"),Q=or(4096,"null"),Z=A?Q:or(2101248,"null"),ee=or(2,"string"),te=or(4,"number"),ne=or(128,"true"),re=or(128,"false"),ie=((M=Uo([ne,re])).flags|=8,M.intrinsicName="boolean",M),se=or(512,"symbol"),oe=or(1024,"void"),ae=or(8192,"never"),le=or(8192,"never"),ce=or(16777216,"object"),ue=dr(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),de=cn(2048,"__type");de.members=e.createSymbolTable();var pe=dr(de,T,e.emptyArray,e.emptyArray,void 0,void 0),he=dr(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0);he.instantiations=e.createMap();var fe=dr(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0);fe.flags|=8388608;var me=dr(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),_e=dr(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),ge=dr(void 0,T,e.emptyArray,e.emptyArray,void 0,void 0),ye=sr(16384),be=sr(16384);be.constraint=ye;var ve,Te,ke,Ee,xe,Se,Ce,Ie,Ae,we,Ne,De,Oe,Re,Le,Pe,Me,Fe,$e,Be,Ue,Ve,He,Ge,je,Ke,We,ze,qe,Je,Ye,Xe,Qe,Ze=sr(16384),et=Hi(void 0,void 0,void 0,e.emptyArray,z,void 0,0,!1,!1),tt=Hi(void 0,void 0,void 0,e.emptyArray,J,void 0,0,!1,!1),nt=Hi(void 0,void 0,void 0,e.emptyArray,z,void 0,0,!1,!1),rt=Hi(void 0,void 0,void 0,e.emptyArray,le,void 0,0,!1,!1),it=Ks(ee,!0),st=Ks(z,!1),ot=e.createSymbolTable(),at=0,lt=0,ct=0,ut=!1,dt=ua(""),pt=ua(0),ht=[],ft=[],mt=[],_t=0,gt=[],yt=[],bt=[],vt=[],Tt=[],kt=[],Et=[],xt=[],St=[],Ct=[],It=[],At=[],wt=e.createDiagnosticCollection();!function(e){e[e.None=0]="None",e[e.TypeofEQString=1]="TypeofEQString",e[e.TypeofEQNumber=2]="TypeofEQNumber",e[e.TypeofEQBoolean=4]="TypeofEQBoolean",e[e.TypeofEQSymbol=8]="TypeofEQSymbol",e[e.TypeofEQObject=16]="TypeofEQObject",e[e.TypeofEQFunction=32]="TypeofEQFunction",e[e.TypeofEQHostObject=64]="TypeofEQHostObject",e[e.TypeofNEString=128]="TypeofNEString",e[e.TypeofNENumber=256]="TypeofNENumber",e[e.TypeofNEBoolean=512]="TypeofNEBoolean",e[e.TypeofNESymbol=1024]="TypeofNESymbol",e[e.TypeofNEObject=2048]="TypeofNEObject",e[e.TypeofNEFunction=4096]="TypeofNEFunction",e[e.TypeofNEHostObject=8192]="TypeofNEHostObject",e[e.EQUndefined=16384]="EQUndefined",e[e.EQNull=32768]="EQNull",e[e.EQUndefinedOrNull=65536]="EQUndefinedOrNull",e[e.NEUndefined=131072]="NEUndefined",e[e.NENull=262144]="NENull",e[e.NEUndefinedOrNull=524288]="NEUndefinedOrNull",e[e.Truthy=1048576]="Truthy",e[e.Falsy=2097152]="Falsy",e[e.Discriminatable=4194304]="Discriminatable",e[e.All=8388607]="All",e[e.BaseStringStrictFacts=933633]="BaseStringStrictFacts",e[e.BaseStringFacts=3145473]="BaseStringFacts",e[e.StringStrictFacts=4079361]="StringStrictFacts",e[e.StringFacts=4194049]="StringFacts",e[e.EmptyStringStrictFacts=3030785]="EmptyStringStrictFacts",e[e.EmptyStringFacts=3145473]="EmptyStringFacts",e[e.NonEmptyStringStrictFacts=1982209]="NonEmptyStringStrictFacts",e[e.NonEmptyStringFacts=4194049]="NonEmptyStringFacts",e[e.BaseNumberStrictFacts=933506]="BaseNumberStrictFacts",e[e.BaseNumberFacts=3145346]="BaseNumberFacts",e[e.NumberStrictFacts=4079234]="NumberStrictFacts",e[e.NumberFacts=4193922]="NumberFacts",e[e.ZeroStrictFacts=3030658]="ZeroStrictFacts",e[e.ZeroFacts=3145346]="ZeroFacts",e[e.NonZeroStrictFacts=1982082]="NonZeroStrictFacts",e[e.NonZeroFacts=4193922]="NonZeroFacts",e[e.BaseBooleanStrictFacts=933252]="BaseBooleanStrictFacts",e[e.BaseBooleanFacts=3145092]="BaseBooleanFacts",e[e.BooleanStrictFacts=4078980]="BooleanStrictFacts",e[e.BooleanFacts=4193668]="BooleanFacts",e[e.FalseStrictFacts=3030404]="FalseStrictFacts",e[e.FalseFacts=3145092]="FalseFacts",e[e.TrueStrictFacts=1981828]="TrueStrictFacts",e[e.TrueFacts=4193668]="TrueFacts",e[e.SymbolStrictFacts=1981320]="SymbolStrictFacts",e[e.SymbolFacts=4193160]="SymbolFacts",e[e.ObjectStrictFacts=6166480]="ObjectStrictFacts",e[e.ObjectFacts=8378320]="ObjectFacts",e[e.FunctionStrictFacts=6164448]="FunctionStrictFacts",e[e.FunctionFacts=8376288]="FunctionFacts",e[e.UndefinedFacts=2457472]="UndefinedFacts",e[e.NullFacts=2340752]="NullFacts"}(Qe||(Qe={}));var Nt,Dt,Ot,Rt,Lt,Pt,Mt,Ft,$t=e.createMapFromTemplate({string:1,number:2,boolean:4,symbol:8,undefined:16384,object:16,function:32}),Bt=e.createMapFromTemplate({string:128,number:256,boolean:512,symbol:1024,undefined:131072,object:2048,function:4096}),Ut=e.createMapFromTemplate({string:ee,number:te,boolean:ie,symbol:se,undefined:Y}),Vt=Uo(e.arrayFrom($t.keys(),ua)),Ht=!1,Gt=!1,jt=e.createUnderscoreEscapedMap(),Kt="JSX",Wt="IntrinsicElements",zt="ElementClass",qt="ElementAttributesProperty",Jt="ElementChildrenAttribute",Yt="Element",Xt="IntrinsicAttributes",Qt="IntrinsicClassAttributes",Zt=e.createMap(),en=e.createMap(),tn=e.createMap(),nn=e.createMap(),rn=e.createMap();!function(e){e[e.Type=0]="Type",e[e.ResolvedBaseConstructorType=1]="ResolvedBaseConstructorType",e[e.DeclaredType=2]="DeclaredType",e[e.ResolvedReturnType=3]="ResolvedReturnType"}(Pt||(Pt={})),function(e){e[e.Normal=0]="Normal",e[e.SkipContextSensitive=1]="SkipContextSensitive",e[e.Inferential=2]="Inferential"}(Mt||(Mt={})),function(e){e[e.None=0]="None",e[e.Bivariant=1]="Bivariant",e[e.Strict=2]="Strict"}(Ft||(Ft={}));var sn=e.createSymbolTable();sn.set(L.escapedName,L);var on=e.and(af,(function(t){return!e.isAccessor(t)}));return function(){for(var t=0,r=n.getSourceFiles();t<r.length;t++){var i=r[t];e.bindSourceFile(i,E)}for(var s,o=0,a=n.getSourceFiles();o<a.length;o++){i=a[o];if(e.isExternalOrCommonJsModule(i)||fn(ot,i.locals),i.patternAmbientModules&&i.patternAmbientModules.length&&(Te=e.concatenate(Te,i.patternAmbientModules)),i.moduleAugmentations.length&&(s||(s=[])).push(i.moduleAugmentations),i.symbol&&i.symbol.globalExports)i.symbol.globalExports.forEach((function(e,t){ot.has(t)||ot.set(t,e)}))}if(s)for(var l=0,c=s;l<c.length;l++)for(var u=c[l],d=0,p=u;d<p.length;d++){mn(p[d])}(function(t,n,r){function i(t,n){return function(r){return wt.add(e.createDiagnosticForNode(r,n,t))}}n.forEach((function(n,s){var o=t.get(s);o?e.forEach(o.declarations,i(e.unescapeLeadingUnderscores(s),r)):t.set(s,n)}))})(ot,sn,e.Diagnostics.Declaration_name_conflicts_with_built_in_global_identifier_0),_n(L).type=X,_n(F).type=ho("IArguments",0,!0),_n(K).type=J,xe=ho("Array",1,!0),ke=ho("Object",0,!0),Ee=ho("Function",0,!0),Ce=ho("String",0,!0),Ie=ho("Number",0,!0),Ae=ho("Boolean",0,!0),we=ho("RegExp",0,!0),De=No(z),Oe=No(q),Se=Eo("ReadonlyArray",1),Re=Se?So(Se,[z]):De,Ne=Eo("ThisType",1)}(),$;function an(){return Nt||(Nt="React",E.jsxFactory?(Dt=e.parseIsolatedEntityName(E.jsxFactory,x))&&(Nt=Zh(Dt).escapedText):E.reactNamespace&&(Nt=e.escapeLeadingUnderscores(E.reactNamespace))),Nt}function ln(t,n,r,i,s){var o=t?e.createDiagnosticForNode(t,n,r,i,s):e.createCompilerDiagnostic(n,r,i,s);wt.add(o)}function cn(e,t){y++;var n=new f(33554432|e,t);return n.checkFlags=0,n}function un(e){return 0!=(33554432&e.flags)}function dn(e,t){t.mergeId||(t.mergeId=i,i++),gt[t.mergeId]=e}function pn(t){var n=cn(t.flags,t.escapedName);return n.declarations=t.declarations?t.declarations.slice():[],n.parent=t.parent,t.valueDeclaration&&(n.valueDeclaration=t.valueDeclaration),t.constEnumOnlyModule&&(n.constEnumOnlyModule=!0),t.members&&(n.members=e.cloneMap(t.members)),t.exports&&(n.exports=e.cloneMap(t.exports)),dn(n,t),n}function hn(t,n){if(t.flags&(i=n.flags,s=0,2&i&&(s|=107455),1&i&&(s|=107454),4&i&&(s|=0),8&i&&(s|=900095),16&i&&(s|=106927),32&i&&(s|=899519),64&i&&(s|=792968),256&i&&(s|=899327),128&i&&(s|=899967),512&i&&(s|=106639),8192&i&&(s|=99263),32768&i&&(s|=41919),65536&i&&(s|=74687),262144&i&&(s|=530920),524288&i&&(s|=793064),2097152&i&&(s|=2097152),s))if(1024&t.flags)ln(e.getNameOfDeclaration(n.declarations[0]),e.Diagnostics.Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity,xr(t));else{var r=2&t.flags||2&n.flags?e.Diagnostics.Cannot_redeclare_block_scoped_variable_0:e.Diagnostics.Duplicate_identifier_0;e.forEach(n.declarations,(function(t){ln(e.getNameOfDeclaration(t)||t,r,xr(n))})),e.forEach(t.declarations,(function(t){ln(e.getNameOfDeclaration(t)||t,r,xr(n))}))}else 512&n.flags&&512&t.flags&&t.constEnumOnlyModule&&!n.constEnumOnlyModule&&(t.constEnumOnlyModule=!1),t.flags|=n.flags,n.valueDeclaration&&(!t.valueDeclaration||233===t.valueDeclaration.kind&&233!==n.valueDeclaration.kind)&&(t.valueDeclaration=n.valueDeclaration),e.addRange(t.declarations,n.declarations),n.members&&(t.members||(t.members=e.createSymbolTable()),fn(t.members,n.members)),n.exports&&(t.exports||(t.exports=e.createSymbolTable()),fn(t.exports,n.exports)),dn(t,n);var i,s}function fn(e,t){t.forEach((function(t,n){var r=e.get(n);r?(33554432&r.flags||(r=pn(r),e.set(n,r)),hn(r,t)):e.set(n,t)}))}function mn(t){var n=t.parent;if(n.symbol.declarations[0]===n)if(e.isGlobalScopeAugmentation(n))fn(ot,n.symbol.exports);else{var r=Gn(t,t,e.isInAmbientContext(t.parent.parent)?void 0:e.Diagnostics.Invalid_module_name_in_augmentation_module_0_cannot_be_found,!0);if(!r)return;1920&(r=Kn(r)).flags?hn(r=33554432&r.flags?r:pn(r),n.symbol):ln(t,e.Diagnostics.Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity,t.text)}else e.Debug.assert(n.symbol.declarations.length>1)}function _n(e){if(33554432&e.flags)return e;var t=a(e);return yt[t]||(yt[t]={})}function gn(e){var t=o(e);return bt[t]||(bt[t]={flags:0})}function yn(e){return 32768&e.flags?e.objectFlags:0}function bn(t){return 265===t.kind&&!e.isExternalOrCommonJsModule(t)}function vn(t,n,r){if(r){var i=t.get(n);if(i){if(e.Debug.assert(0==(1&e.getCheckFlags(i)),"Should never get an instantiated symbol here."),i.flags&r)return i;if(2097152&i.flags){var s=Mn(i);if(s===K||s.flags&r)return i}}}}function Tn(t,r){var i=e.getSourceFileOfNode(t),s=e.getSourceFileOfNode(r);if(i!==s){if(S&&(i.externalModuleIndicator||s.externalModuleIndicator)||!E.outFile&&!E.out||Kl(r)||e.isInAmbientContext(t))return!0;if(c(r,t))return!0;var o=n.getSourceFiles();return e.indexOf(o,i)<=e.indexOf(o,s)}if(t.pos<=r.pos){if(176===t.kind){var a=e.getAncestor(r,176);return a?e.findAncestor(a,e.isBindingElement)!==e.findAncestor(t,e.isBindingElement)||t.pos<a.pos:Tn(e.getAncestor(t,226),r)}return 226!==t.kind||!function(t,n){var r=e.getEnclosingBlockScopeContainer(t);switch(t.parent.parent.kind){case 208:case 214:case 216:if(An(n,t,r))return!0}return e.isForInOrOfStatement(t.parent.parent)&&An(n,t.parent.parent.expression,r)}(t,r)}if(246===r.parent.kind||243===r.parent.kind&&r.parent.isExportEquals)return!0;if(243===r.kind&&r.isExportEquals)return!0;var l=e.getEnclosingBlockScopeContainer(t);return Kl(r)||c(r,t,l);function c(t,n,r){return!!e.findAncestor(t,(function(i){if(i===r)return"quit";if(e.isFunctionLike(i))return!0;if(i.parent&&149===i.parent.kind&&i.parent.initializer===i)if(e.hasModifier(i.parent,32)){if(151===n.kind)return!0}else if(!(149===n.kind&&!e.hasModifier(n,32))||e.getContainingClass(t)!==e.getContainingClass(n))return!0}))}}function kn(e,t,n,r,i,s,o){return En(e,t,n,r,i,s,vn,o)}function En(t,n,r,i,s,o,a,l){var c,u,d,p,h,f=t,m=t,_=!1;e:for(;t;){if(t.locals&&!bn(t)&&(c=a(t.locals,n,r))){var g=!0;if(e.isFunctionLike(t)&&u&&u!==t.body&&(r&c.flags&793064&&275!==u.kind&&(g=!!(262144&c.flags)&&(u===t.type||146===u.kind||145===u.kind)),107455&r&&1&c.flags&&(g=146===u.kind||u===t.type&&146===c.valueDeclaration.kind)),g)break e;c=void 0}switch(t.kind){case 265:if(!e.isExternalOrCommonJsModule(t))break;_=!0;case 233:var y=er(t).exports;if(265===t.kind||e.isAmbientModule(t)){if(c=y.get("default")){var b=e.getLocalSymbolForExportDefault(c);if(b&&c.flags&r&&b.escapedName===n)break e;c=void 0}var v=y.get(n);if(v&&2097152===v.flags&&e.getDeclarationOfKind(v,246))break}if(c=a(y,n,2623475&r))break e;break;case 232:if(c=a(er(t).exports,n,8&r))break e;break;case 149:case 148:if(e.isClassLike(t.parent)&&!e.hasModifier(t,32)){var T=ir(t.parent);T&&T.locals&&a(T.locals,n,107455&r)&&(p=t)}break;case 229:case 199:case 230:if(c=a(er(t).members,n,793064&r)){if(!Sn(c,t)){c=void 0;break}if(u&&e.hasModifier(u,32))return void ln(m,e.Diagnostics.Static_members_cannot_reference_class_type_parameters);break e}if(199===t.kind&&32&r){var k=t.name;if(k&&n===k.escapedText){c=t.symbol;break e}}break;case 201:if(u===t.expression&&85===t.parent.token){var E=t.parent.parent;if(e.isClassLike(E)&&(c=a(er(E).members,n,793064&r)))return void(i&&ln(m,e.Diagnostics.Base_class_expressions_cannot_reference_class_type_parameters))}break;case 144:if(h=t.parent.parent,(e.isClassLike(h)||230===h.kind)&&(c=a(er(h).members,n,793064&r)))return void ln(m,e.Diagnostics.A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type);break;case 151:case 150:case 152:case 153:case 154:case 228:case 187:if(3&r&&"arguments"===n){c=F;break e}break;case 186:if(3&r&&"arguments"===n){c=F;break e}if(16&r){var x=t.name;if(x&&n===x.escapedText){c=t.symbol;break e}}break;case 147:t.parent&&146===t.parent.kind&&(t=t.parent),t.parent&&e.isClassElement(t.parent)&&(t=t.parent)}207!==t.kind&&(d=t),u=t,t=t.parent}if(o&&c&&i&&C&&c!==d.symbol&&(c.isReferenced=!0),!c){if(u&&(e.Debug.assert(265===u.kind),u.commonJsModuleIndicator&&"exports"===n))return u.symbol;c=a(ot,n,r)}if(c){if(i){if(p){var S=p.name;return void ln(m,e.Diagnostics.Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor,e.declarationNameToString(S),xn(s))}if(m&&(2&r||(32&r||384&r)&&107455==(107455&r))){var I=nr(c);(2&I.flags||32&I.flags||384&I.flags)&&function(t,n){e.Debug.assert(!!(2&t.flags||32&t.flags||384&t.flags));var r=e.forEach(t.declarations,(function(t){return e.isBlockOrCatchScoped(t)||e.isClassLike(t)||232===t.kind?t:void 0}));e.Debug.assert(void 0!==r,"Declaration to checkResolvedBlockScopedVariable is undefined"),e.isInAmbientContext(r)||Tn(r,n)||(2&t.flags?ln(n,e.Diagnostics.Block_scoped_variable_0_used_before_its_declaration,e.declarationNameToString(e.getNameOfDeclaration(r))):32&t.flags?ln(n,e.Diagnostics.Class_0_used_before_its_declaration,e.declarationNameToString(e.getNameOfDeclaration(r))):256&t.flags&&ln(n,e.Diagnostics.Enum_0_used_before_its_declaration,e.declarationNameToString(e.getNameOfDeclaration(r))))}(I,m)}if(c&&_&&107455==(107455&r)){var A=c.declarations;A&&1===A.length&&236===A[0].kind&&ln(m,e.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead,e.unescapeLeadingUnderscores(n))}}return c}if(i&&!(m&&(function(t,n,r){if(71===t.kind&&mf(t)||Kl(t))return!1;var i=e.getThisContainer(t,!0),s=i;for(;s;){if(e.isClassLike(s.parent)){var o=er(s.parent);if(!o)break;if(bs(li(o),n))return ln(t,e.Diagnostics.Cannot_find_name_0_Did_you_mean_the_static_member_1_0,xn(r),xr(o)),!0;if(s===i&&!e.hasModifier(s,32))if(bs(Oi(o).thisType,n))return ln(t,e.Diagnostics.Cannot_find_name_0_Did_you_mean_the_instance_member_this_0,xn(r)),!0}s=s.parent}return!1}(m,n,s)||Cn(m)||function(t,n,r){if(1920===r){var i=Pn(kn(t,n,792640,void 0,void 0,!1)),s=t.parent;if(i){if(e.isQualifiedName(s)){e.Debug.assert(s.left===t,"Should only be resolving left side of qualified name as a namespace");var o=s.right.escapedText;if(bs(Oi(i),o))return ln(s,e.Diagnostics.Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1,e.unescapeLeadingUnderscores(n),e.unescapeLeadingUnderscores(o)),!0}return ln(t,e.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here,e.unescapeLeadingUnderscores(n)),!0}}return!1}(m,n,r)||function(t,n,r){if(107455&r){if("any"===n||"string"===n||"number"===n||"boolean"===n||"never"===n)return ln(t,e.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_value_here,e.unescapeLeadingUnderscores(n)),!0;var i=Pn(kn(t,n,792640,void 0,void 0,!1));if(i&&!(1024&i.flags))return ln(t,e.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_value_here,e.unescapeLeadingUnderscores(n)),!0}return!1}(m,n,r)||function(t,n,r){if(107031&r){if(Pn(kn(t,n,1024,void 0,void 0,!1)))return ln(t,e.Diagnostics.Cannot_use_namespace_0_as_a_value,e.unescapeLeadingUnderscores(n)),!0}else if(792640&r){if(Pn(kn(t,n,1024,void 0,void 0,!1)))return ln(t,e.Diagnostics.Cannot_use_namespace_0_as_a_type,e.unescapeLeadingUnderscores(n)),!0}return!1}(m,n,r)))){var w=void 0;l&&_t<10&&(w=Xu(f,n,r))&&ln(m,l,xn(s),w),w||ln(m,i,xn(s)),_t++}}function xn(t){return e.isString(t)?e.unescapeLeadingUnderscores(t):e.declarationNameToString(t)}function Sn(e,t){for(var n=0,r=e.declarations;n<r.length;n++){var i=r[n];if(145===i.kind&&i.parent===t)return!0}return!1}function Cn(t){var n=In(t),r=!(!n||!Vn(n,64,!0));return r&&ln(t,e.Diagnostics.Cannot_extend_an_interface_0_Did_you_mean_implements,e.getTextOfNode(n)),r}function In(t){switch(t.kind){case 71:case 179:return t.parent?In(t.parent):void 0;case 201:if(e.isEntityNameExpression(t.expression))return t.expression;default:return}}function An(t,n,r){return n&&!!e.findAncestor(t,(function(t){return t===r||e.isFunctionLike(t)?"quit":t===n}))}function wn(e){switch(e.kind){case 237:return e;case 239:return e.parent;case 240:return e.parent.parent;case 242:return e.parent.parent.parent;default:return}}function Nn(t){return e.find(t.declarations,e.isAliasSymbolDeclaration)}function Dn(t,n,r){var i=Hn(t,t.moduleSpecifier),s=Wn(i,t.moduleSpecifier,r);if(s){var o=n.propertyName||n.name;if(o.escapedText){if(e.isShorthandAmbientModuleSymbol(i))return i;var a=void 0;a=i&&i.exports&&i.exports.get("export=")?bs(li(s),o.escapedText):function(e,t){if(3&e.flags){var n=e.valueDeclaration.type;if(n)return Pn(bs(pa(n),t))}}(s,o.escapedText),a=Pn(a,r);var l=function(e,t,n){if(1536&e.flags)return Pn(Yn(e).get(t),n)}(s,o.escapedText,r);!l&&I&&"default"===o.escapedText&&(l=Kn(i,r)||Pn(i,r));var c=l&&a?function(t,n){if(t===K&&n===K)return K;if(794600&t.flags)return t;var r=cn(t.flags|n.flags,t.escapedName);return r.declarations=e.concatenate(t.declarations,n.declarations),r.parent=t.parent||n.parent,t.valueDeclaration&&(r.valueDeclaration=t.valueDeclaration),n.members&&(r.members=n.members),t.exports&&(r.exports=t.exports),r}(a,l):l||a;return c||ln(o,e.Diagnostics.Module_0_has_no_exported_member_1,Un(i),e.declarationNameToString(o)),c}}}function On(e,t,n){return e.parent.parent.moduleSpecifier?Dn(e.parent.parent,e,n):Vn(e.propertyName||e.name,t,!1,n)}function Rn(t,n){switch(t.kind){case 237:return function(t,n){return 248===t.moduleReference.kind?Kn(Hn(t,e.getExternalModuleImportEqualsDeclarationExpression(t))):Bn(t.moduleReference,n)}(t,n);case 239:return function(t,n){var r=Hn(t,t.parent.moduleSpecifier);if(r){var i=void 0;if(e.isShorthandAmbientModuleSymbol(r))i=r;else{var s=r.exports.get("export=");i=s?bs(li(s),"default"):Pn(r.exports.get("default"),n)}if(i||I){if(!i&&I)return Kn(r,n)||Pn(r,n)}else ln(t.name,e.Diagnostics.Module_0_has_no_default_export,xr(r));return i}}(t,n);case 240:return function(e,t){var n=e.parent.parent.moduleSpecifier;return Wn(Hn(e,n),n,t)}(t,n);case 242:return function(e,t){return Dn(e.parent.parent.parent,e,t)}(t,n);case 246:return On(t,901119,n);case 243:return function(e,t){return Vn(e.expression,901119,!1,t)}(t,n);case 236:return function(e,t){return Kn(e.parent.symbol,t)}(t,n)}}function Ln(e,t){return void 0===t&&(t=901119),e&&2097152==(e.flags&(2097152|t))}function Pn(e,t){return!t&&Ln(e)?Mn(e):e}function Mn(t){e.Debug.assert(0!=(2097152&t.flags),"Should only get Alias here.");var n=_n(t);if(n.target)n.target===W&&(n.target=K);else{n.target=W;var r=Nn(t);e.Debug.assert(!!r);var i=Rn(r);n.target===W?n.target=i||K:ln(r,e.Diagnostics.Circular_definition_of_import_alias_0,xr(t))}return n.target}function Fn(e){var t=er(e),n=Mn(t);n&&((n===K||107455&n.flags&&!Lf(n))&&$n(t))}function $n(t){var n=_n(t);if(!n.referenced){n.referenced=!0;var r=Nn(t);e.Debug.assert(!!r),243===r.kind?yp(r.expression):246===r.kind?yp(r.propertyName||r.name):e.isInternalModuleImportEqualsDeclaration(r)&&yp(r.moduleReference)}}function Bn(t,n){return 71===t.kind&&e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),71===t.kind||143===t.parent.kind?Vn(t,1920,!1,n):(e.Debug.assert(237===t.parent.kind),Vn(t,901119,!1,n))}function Un(e){return e.parent?Un(e.parent)+"."+xr(e):xr(e)}function Vn(t,n,r,i,s){if(!e.nodeIsMissing(t)){var o;if(71===t.kind){var a=1920===n?e.Diagnostics.Cannot_find_namespace_0:e.Diagnostics.Cannot_find_name_0;if(!(o=kn(s||t,t.escapedText,n,r?void 0:a,t,!0)))return}else if(143===t.kind||179===t.kind){var l=void 0;if(143===t.kind)l=t.left;else{if(179!==t.kind||185!==t.expression.kind&&!e.isEntityNameExpression(t.expression))return;l=t.expression}var c=143===t.kind?t.right:t.name,u=Vn(l,1920,r,!1,s);if(!u||e.nodeIsMissing(c))return;if(u===K)return u;if(!(o=vn(Yn(u),c.escapedText,n)))return void(r||ln(c,e.Diagnostics.Namespace_0_has_no_exported_member_1,Un(u),e.declarationNameToString(c)))}else{if(185===t.kind)return e.isEntityNameExpression(t.expression)?Vn(t.expression,n,r,i,s):void 0;e.Debug.assertNever(t,"Unknown entity name kind.")}return e.Debug.assert(0==(1&e.getCheckFlags(o)),"Should never get an instantiated symbol here."),o.flags&n||i?o:Mn(o)}}function Hn(t,n){return Gn(t,n,e.Diagnostics.Cannot_find_module_0)}function Gn(e,t,n,r){if(void 0===r&&(r=!1),9===t.kind||13===t.kind){var i=t;return jn(e,i.text,n,i,r)}}function jn(t,r,i,s,o){if(void 0===o&&(o=!1),void 0!==r){if(e.startsWith(r,"@types/"))ln(s,e.Diagnostics.Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1,e.removePrefix(r,"@types/"),r);var a=ws(r,!0);if(a)return a;var l=e.getResolvedModule(e.getSourceFileOfNode(t),r),c=l&&e.getResolutionDiagnostic(E,l),u=l&&!c&&n.getSourceFile(l.resolvedFileName);if(u)return u.symbol?Zn(u.symbol):void(i&&ln(s,e.Diagnostics.File_0_is_not_a_module,u.fileName));if(Te){var d=e.findBestPatternMatch(Te,(function(e){return e.pattern}),r);if(d)return Zn(d.symbol)}if(l&&!e.extensionIsTypeScript(l.extension)&&void 0===c||c===e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type){if(o)ln(s,e.Diagnostics.Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augmented,r,l.resolvedFileName);else if(N&&i){var p=l.isExternalLibraryImport?e.chainDiagnosticMessages(void 0,e.Diagnostics.Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_module_0,r):void 0;p=e.chainDiagnosticMessages(p,e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type,r,l.resolvedFileName),wt.add(e.createDiagnosticForNodeFromMessageChain(s,p))}}else if(i)if(c)ln(s,c,r,l.resolvedFileName);else{var h=e.tryExtractTypeScriptExtension(r);if(h)ln(s,e.Diagnostics.An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead,h,e.removeExtension(r,h));else ln(s,i,r)}}}function Kn(e,t){return e&&Zn(Pn(e.exports.get("export="),t))||e}function Wn(t,n,r){var i=Kn(t,r);return r||!i||1539&i.flags||ln(n,e.Diagnostics.Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct,xr(t)),i}function zn(e){return void 0!==e.exports.get("export=")}function qn(e){return Is(Xn(e))}function Jn(e,t){var n=Xn(t);if(n)return n.get(e)}function Yn(e){return 1536&e.flags?Xn(e):e.exports||T}function Xn(t){var n=_n(t);return n.resolvedExports||(n.resolvedExports=function(t){var n=[];return r(t=Kn(t))||T;function r(t){if(t&&1952&t.flags&&e.pushIfUnique(n,t)){var i=e.cloneMap(t.exports),s=t.exports.get("__export");if(s){for(var o=e.createSymbolTable(),a=e.createMap(),l=0,c=s.declarations;l<c.length;l++){var u=c[l];Qn(o,r(Hn(u,u.moduleSpecifier)),a,u)}a.forEach((function(t,n){var r=t.exportsWithDuplicate;if("export="!==n&&r&&r.length&&!i.has(n))for(var s=0,o=r;s<o.length;s++){var l=o[s];wt.add(e.createDiagnosticForNode(l,e.Diagnostics.Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambiguity,a.get(n).specifierText,e.unescapeLeadingUnderscores(n)))}})),Qn(i,o)}return i}}}(t))}function Qn(t,n,r,i){n&&n.forEach((function(n,s){if("default"!==s){var o=t.get(s);if(o){if(r&&i&&o&&Pn(o)!==Pn(n)){var a=r.get(s);a.exportsWithDuplicate?a.exportsWithDuplicate.push(i):a.exportsWithDuplicate=[i]}}else t.set(s,n),r&&i&&r.set(s,{specifierText:e.getTextOfNode(i.moduleSpecifier)})}}))}function Zn(e){var t;return e&&e.mergeId&&(t=gt[e.mergeId])?t:e}function er(e){return Zn(e.symbol)}function tr(e){return Zn(e.parent)}function nr(e){return e&&0!=(1048576&e.flags)?Zn(e.exportSymbol):e}function rr(e){return!!(107455&e.flags||2097152&e.flags&&107455&Mn(e).flags)}function ir(t){for(var n=0,r=t.members;n<r.length;n++){var i=r[n];if(152===i.kind&&e.nodeIsPresent(i.body))return i}}function sr(e){var t=new m($,e);return g++,t.id=g,t}function or(e,t){var n=sr(e);return n.intrinsicName=t,n}function ar(e,t){var n=sr(32768);return n.objectFlags=e,n.symbol=t,n}function lr(e){return 95===e.charCodeAt(0)&&95===e.charCodeAt(1)&&95!==e.charCodeAt(2)&&64!==e.charCodeAt(2)}function cr(t){var n;return t.forEach((function(e,t){lr(t)||(n||(n=[]),rr(e)&&n.push(e))})),n||e.emptyArray}function ur(e,t,n,r,i,s){return e.members=t,e.properties=cr(t),e.callSignatures=n,e.constructSignatures=r,i&&(e.stringIndexInfo=i),s&&(e.numberIndexInfo=s),e}function dr(e,t,n,r,i,s){return ur(ar(16,e),t,n,r,i,s)}function pr(t,n){for(var r,i=t;i;i=i.parent){if(i.locals&&!bn(i)&&(r=n(i.locals)))return r;switch(i.kind){case 265:if(!e.isExternalOrCommonJsModule(i))break;case 233:if(r=n(er(i).exports))return r}}return n(ot)}function hr(e){return 107455===e?107455:1920}function fr(t,n,r,i){if(t&&!function(e){if(e.declarations&&e.declarations.length){for(var t=0,n=e.declarations;t<n.length;t++){switch(n[t].kind){case 149:case 151:case 153:case 154:continue;default:return!1}}return!0}return!1}(t)){var s=[];return pr(n,o)}function o(c){if(e.pushIfUnique(s,c)){var u=function(s){if(l(s.get(t.escapedName)))return[t];return e.forEachEntry(s,(function(t){if(2097152&t.flags&&"export="!==t.escapedName&&!e.getDeclarationOfKind(t,246)&&!(function(t){return t&&t.declarations&&t.declarations[0]&&e.isNamespaceExportDeclaration(t.declarations[0])}(t)&&n&&e.isExternalModule(e.getSourceFileOfNode(n)))&&(!i||e.some(t.declarations,e.isExternalModuleImportEqualsDeclaration))){var s=Mn(t);if(l(t,s))return[t];var c=s.exports?o(s.exports):void 0;if(c&&a(t,hr(r)))return[t].concat(c)}}))}(c);return s.pop(),u}}function a(e,t){return!mr(e,n,t)||!!fr(e.parent,n,hr(t),i)}function l(n,i){return t===(i||n)&&!e.some(n.declarations,yr)&&a(n,r)}}function mr(t,n,r){var i=!1;return pr(n,(function(n){var s=n.get(t.escapedName);return!!s&&(s===t||!!((s=2097152&s.flags&&!e.getDeclarationOfKind(s,246)?Mn(s):s).flags&r)&&(i=!0,!0))})),i}function _r(e,t){return 0===gr(e,t,793064,!1).accessibility}function gr(t,n,r,i){if(t&&n&&!(262144&t.flags)){for(var s=t,o=r;t;){var a=fr(t,n,o,!1);if(a){var l=br(a[0],i);return l||{accessibility:1,errorSymbolName:xr(s,n,r),errorModuleName:t!==s?xr(t,n,1920):void 0}}o=hr(r),t=tr(t)}var c=e.forEach(s.declarations,u);if(c)if(c!==u(n))return{accessibility:2,errorSymbolName:xr(s,n,r),errorModuleName:xr(c)};return{accessibility:1,errorSymbolName:xr(s,n,r)}}return{accessibility:0};function u(t){var n=e.findAncestor(t,yr);return n&&er(n)}}function yr(t){return e.isAmbientModule(t)||265===t.kind&&e.isExternalOrCommonJsModule(t)}function br(t,n){var r;if(!e.forEach(t.declarations,(function(t){return!function(t){if(!Pr(t)){var i=wn(t);return!(!i||e.hasModifier(i,1)||!Pr(i.parent))&&(n&&(gn(t).isVisible=!0,r=e.appendIfUnique(r,i)),!0)}return!0}(t)})))return{accessibility:0,aliasesToMakeVisible:r}}function vr(t,n){var r;r=162===t.parent.kind||e.isExpressionWithTypeArgumentsInClassExtendsClause(t.parent)?1156031:143===t.kind||179===t.kind||237===t.parent.kind?1920:793064;var i=Zh(t),s=kn(n,i.escapedText,r,void 0,void 0,!1);return s&&br(s,!0)||{accessibility:1,errorSymbolName:e.getTextOfNode(i),errorNode:i}}function Tr(t,n){t.writeKeyword(e.tokenToString(n))}function kr(t,n){t.writePunctuation(e.tokenToString(n))}function Er(e){e.writeSpace(" ")}function xr(t,n,r){return e.usingSingleLineStringWriter((function(e){Lr().buildSymbolDisplay(t,e,n,r)}))}function Sr(t,n,r,i){return e.usingSingleLineStringWriter((function(e){Lr().buildSignatureDisplay(t,e,n,r,i)}))}function Cr(t,n,r){var i=R.typeToTypeNode(t,n,function(t){var n=e.NodeBuilderFlags.None;if(!t)return n;8&t&&(n|=e.NodeBuilderFlags.NoTruncation);256&t&&(n|=e.NodeBuilderFlags.UseFullyQualifiedType);4096&t&&(n|=e.NodeBuilderFlags.SuppressAnyReturnType);1&t&&(n|=e.NodeBuilderFlags.WriteArrayAsGenericType);64&t&&(n|=e.NodeBuilderFlags.WriteTypeArgumentsOfSignature);return n}(r)|e.NodeBuilderFlags.IgnoreErrors|e.NodeBuilderFlags.WriteTypeParametersInQualifiedName);e.Debug.assert(void 0!==i,"should always get typenode");var s=e.createTextWriter(""),o=e.createPrinter({removeComments:!0}),a=n&&e.getSourceFileOfNode(n);o.writeNode(4,i,a,s);var l=s.getText(),c=E.noErrorTruncation||8&r?void 0:100;return c&&l.length>=c?l.substr(0,c-"...".length)+"...":l}function Ir(t,n,r){return e.usingSingleLineStringWriter((function(e){Lr().buildTypePredicateDisplay(t,e,n,r)}))}function Ar(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e[r];if(n|=i.flags,!(6144&i.flags)){if(384&i.flags){var s=128&i.flags?ie:Ai(i);if(65536&s.flags){var o=s.types.length;if(r+o<=e.length&&e[r+o-1]===s.types[o-1]){t.push(s),r+=o-1;continue}}}t.push(i)}}return 4096&n&&t.push(Q),2048&n&&t.push(Y),t||e}function wr(e){return 8===e?"private":16===e?"protected":"public"}function Nr(t){if(t.symbol&&2048&t.symbol.flags){var n=e.findAncestor(t.symbol.declarations[0].parent,(function(e){return 168!==e.kind}));if(231===n.kind)return er(n)}}function Dr(t){return t&&t.parent&&234===t.parent.kind&&e.isExternalModuleAugmentation(t.parent.parent)}function Or(t){return 32&t.flags?'"'+e.escapeString(t.value)+'"':""+t.value}function Rr(t,n){if(t.declarations&&t.declarations.length){var r=t.declarations[0],i=e.getNameOfDeclaration(r);if(i)return e.declarationNameToString(i);if(r.parent&&226===r.parent.kind)return e.declarationNameToString(r.parent.name);switch(!n||n.encounteredError||n.flags&e.NodeBuilderFlags.AllowAnonymousIdentifier||(n.encounteredError=!0),r.kind){case 199:return"(Anonymous class)";case 186:case 187:return"(Anonymous function)"}}if(t.syntheticLiteralTypeOrigin){var s=t.syntheticLiteralTypeOrigin.value;if(!e.isIdentifierText(s,E.target))return'"'+e.escapeString(s,34)+'"'}return e.symbolName(t)}function Lr(){function t(e,t){t.writeSymbol(Rr(e),e)}function n(n,r,s,o,a,l){var c;function u(n){if(c){if(1&a)if(1&e.getCheckFlags(n))d(_i(2097152&c.flags?Mn(c):c),n.mapper,r,s);else i(c,r,s);!function(t,n){var r=Rr(t),i=r.charCodeAt(0);e.isIdentifierStart(i,x)?(kr(n,23),n.writeSymbol(r,t)):(kr(n,21),e.isSingleOrDoubleQuote(i)?n.writeStringLiteral(r):n.writeSymbol(r,t),kr(n,22))}(n,r)}else t(n,r);c=n}r.trackSymbol(n,s,o),262144&n.flags||!s&&!(256&l)?u(n):function t(n,r,i){var o=fr(n,s,r,!!(2&a));if(!o||mr(o[0],s,1===o.length?r:hr(r))){var l=tr(o?o[0]:n);l&&t(l,hr(r),!1)}if(o)for(var d=0,p=o;d<p.length;d++)u(p[d]);else!i&&(!c&&e.forEach(n.declarations,yr)||6144&n.flags)||u(n)}(n,o,!0)}function r(r,i,s,o,a){var l=16416&o,c=!1;return u(r,o);function u(r,a){var l=-1025&a;if(16793231&r.flags)i.writeKeyword(32&o||!Gr(r)?r.intrinsicName:"any");else if(16384&r.flags&&r.isThisType)c&&i.reportInaccessibleThisError(),i.writeKeyword("this");else if(4&yn(r))!function(t,n){var r=t.typeArguments||e.emptyArray;if(t.target!==xe||1&n)if(8&t.target.objectFlags)kr(i,21),d(t.typeArguments.slice(0,Zs(t)),26),kr(i,22);else if(16384&n&&t.symbol.valueDeclaration&&199===t.symbol.valueDeclaration.kind)h(t,n);else{var s=t.target.outerTypeParameters,o=0;if(s)for(var a=s.length;o<a;){var l=o,c=qs(s[o]);do{o++}while(o<a&&qs(s[o])===c);e.rangeEquals(s,r,l,o)||(p(c,r,l,o,n),kr(i,23))}var f=(t.target.typeParameters||e.emptyArray).length;p(t.symbol,r,o,f,n)}else u(r[0],32896),kr(i,21),kr(i,22)}(r,l);else if(256&r.flags&&!(65536&r.flags)){var f=tr(r.symbol);n(f,i,s,793064,0,l),Oi(f)!==r&&(kr(i,23),t(r.symbol,i))}else if(3&yn(r)||16656&r.flags)n(r.symbol,i,s,793064,0,l);else if(1024&a||!r.aliasSymbol||!(65536&a||_r(r.aliasSymbol,s)))196608&r.flags?function(e,t){128&t&&kr(i,19);65536&e.flags?d(Ar(e.types),49):d(e.types,48);128&t&&kr(i,20)}(r,l):48&yn(r)?h(r,l):96&r.flags?i.writeStringLiteral(Or(r)):262144&r.flags?(128&a&&kr(i,19),i.writeKeyword("keyof"),Er(i),u(r.type,128),128&a&&kr(i,20)):524288&r.flags?(u(r.objectType,128),kr(i,21),u(r.indexType,0),kr(i,22)):(kr(i,17),Er(i),kr(i,24),Er(i),kr(i,18));else{var m=r.aliasTypeArguments;p(r.aliasSymbol,m,0,e.length(m),l)}}function d(e,t){for(var n=0;n<e.length;n++)n>0&&(26!==t&&Er(i),kr(i,t),Er(i)),u(e[n],26===t?0:128)}function p(e,t,r,o,a){if((32&e.flags||!lr(e.escapedName))&&n(e,i,s,793064,0,a),r<o){for(kr(i,27),u(t[r],512),r++;r<o;)kr(i,26),Er(i),u(t[r],0),r++;kr(i,29)}}function h(t,r){var o=t.symbol;if(o)if(32&o.flags&&!oi(o)&&!(199===o.valueDeclaration.kind&&16384&r)||896&o.flags)f(t,r);else if(function(){var t=!!(8192&o.flags)&&e.some(o.declarations,(function(t){return e.hasModifier(t,32)})),n=!!(16&o.flags)&&(o.parent||e.some(o.declarations,(function(e){return 265===e.parent.kind||234===e.parent.kind})));if(t||n)return!!(4&r)||e.contains(a,o)}())f(t,r);else if(e.contains(a,o)){var l=Nr(t);l?n(l,i,s,793064,0,r):Tr(i,119)}else{a||(a=[]),16&t.objectFlags&&t.symbol&&32&t.symbol.flags?y(t,r):(a.push(o),y(t,r),a.pop())}else y(t,r)}function f(e,t){32768&t&&kr(i,19),Tr(i,103),Er(i),n(e.symbol,i,s,107455,0,t),32768&t&&kr(i,20)}function g(e){ep(e)&&(Tr(i,131),Er(i)),n(e,i),16777216&e.flags&&kr(i,55)}function y(n,r){if(rs(n))!function(e){kr(i,17),i.writeLine(),i.increaseIndent(),e.declaration.readonlyToken&&(Tr(i,131),Er(i));kr(i,21),t(es(e).symbol,i),Er(i),Tr(i,92),Er(i),u(ts(e),0),kr(i,22),e.declaration.questionToken&&kr(i,55);kr(i,56),Er(i),u(ns(e),0),kr(i,25),i.writeLine(),i.decreaseIndent(),kr(i,18)}(n);else{var d=is(n);if(!d.properties.length&&!d.stringIndexInfo&&!d.numberIndexInfo){if(!d.callSignatures.length&&!d.constructSignatures.length)return kr(i,17),void kr(i,18);if(1===d.callSignatures.length&&!d.constructSignatures.length){var p=function(e,t){if(128&t)return!0;if(512&t){var n=e.target&&64&t?e.target.typeParameters:e.typeParameters;return n&&0!==n.length}return!1}(d.callSignatures[0],r);return p&&kr(i,19),m(d.callSignatures[0],i,s,16|l,void 0,a),void(p&&kr(i,20))}if(1===d.constructSignatures.length&&!d.callSignatures.length)return 128&r&&kr(i,19),Tr(i,94),Er(i),m(d.constructSignatures[0],i,s,16|l,void 0,a),void(128&r&&kr(i,20))}var h=c;c=!0,kr(i,17),i.writeLine(),i.increaseIndent(),function(t){for(var n=0,r=t.callSignatures;n<r.length;n++){m(T=r[n],i,s,l,void 0,a),kr(i,25),i.writeLine()}for(var c=0,d=t.constructSignatures;c<d.length;c++){m(T=d[c],i,s,l,1,a),kr(i,25),i.writeLine()}_(t.stringIndexInfo,i,0,s,o,a),_(t.numberIndexInfo,i,1,s,o,a);for(var p=0,h=t.properties;p<h.length;p++){var f=h[p];if(16384&o){if(4194304&f.flags)continue;24&e.getDeclarationModifierFlagsFromSymbol(f)&&i.reportPrivateInBaseOfClassExpression(e.symbolName(f))}var y=li(f);if(8208&f.flags&&!ss(y).length)for(var b=0,v=Ts(y,0);b<v.length;b++){var T=v[b];g(f),m(T,i,s,l,void 0,a),kr(i,25),i.writeLine()}else g(f),kr(i,56),Er(i),u(y,16384&o),kr(i,25),i.writeLine()}}(d),i.decreaseIndent(),kr(i,18),c=h}}}function i(e,t,n,r){var i=Kh(e);(32&i.flags||64&i.flags||524288&i.flags)&&c(mi(e),t,n,r)}function s(e,n,i,s,o){t(e.symbol,n);var a=ls(e);a&&(Er(n),Tr(n,85),Er(n),r(a,n,i,s,o));var l=fs(e);l&&(Er(n),kr(n,58),Er(n),r(l,n,i,s,o))}function o(n,i,s,o,l){var c=n.valueDeclaration;(c?e.isRestParameter(c):un(n)&&n.isRestParameter)&&kr(i,24),c&&e.isBindingPattern(c.name)?a(c.name,i,s,o,l):t(n,i),c&&Ns(c)&&kr(i,55),kr(i,56),Er(i);var u=li(n);c&&Ff(c)&&(u=vl(u,2048)),r(u,i,s,o,l)}function a(e,t,n,r,i){if(174===e.kind)kr(t,17),u(e.elements,t,(function(e){return l(e,t,n,r,i)})),kr(t,18);else if(175===e.kind){kr(t,21);var s=e.elements;u(s,t,(function(e){return l(e,t,n,r,i)})),s&&s.hasTrailingComma&&kr(t,26),kr(t,22)}}function l(n,r,i,s,o){e.isOmittedExpression(n)||(e.Debug.assert(176===n.kind),n.propertyName&&(r.writeProperty(e.getTextOfNode(n.propertyName)),kr(r,56),Er(r)),e.isBindingPattern(n.name)?a(n.name,r,i,s,o):(n.dotDotDotToken&&kr(r,24),t(n.symbol,r)))}function c(e,t,n,r,i){e&&e.length&&(kr(t,27),u(e,t,(function(e){return s(e,t,n,r,i)})),kr(t,29))}function u(e,t,n){for(var r=0;r<e.length;r++)r>0&&(kr(t,26),Er(t)),n(e[r])}function d(e,t,n,i){if(e&&e.length){kr(n,27);for(var s=512,o=0;o<e.length;o++)o>0&&(kr(n,26),Er(n),s=0),r(t(e[o]),n,i,s);kr(n,29)}}function p(e,t,n,r,i,s){kr(n,19),e&&o(e,n,r,i,s);for(var a=0;a<t.length;a++)(a>0||e)&&(kr(n,26),Er(n)),o(t[a],n,r,i,s);kr(n,20)}function h(t,n,i,s,o){e.isIdentifierTypePredicate(t)?n.writeParameter(t.parameterName):Tr(n,99),Er(n),Tr(n,126),Er(n),r(t.type,n,i,s,o)}function f(e,t,n,i,s){var o=Ms(e);4096&i&&Gr(o)||(16&i?(Er(t),kr(t,36)):kr(t,56),Er(t),e.typePredicate?h(e.typePredicate,t,n,i,s):r(o,t,n,i,s))}function m(e,t,n,r,i,s){1===i&&(Tr(t,94),Er(t)),e.target&&64&r?d(e.target.typeParameters,e.mapper,t,n):c(e.typeParameters,t,n,r,s),p(e.thisParameter,e.parameters,t,n,r,s),f(e,t,n,r,s)}function _(t,n,i,s,o,a){if(t){switch(t.isReadonly&&(Tr(n,131),Er(n)),kr(n,21),n.writeParameter(t.declaration?e.declarationNameToString(t.declaration.parameters[0].name):"x"),kr(n,56),Er(n),i){case 1:Tr(n,133);break;case 0:Tr(n,136)}kr(n,22),kr(n,56),Er(n),r(t.type,n,s,o,a),kr(n,25),n.writeLine()}}return Lt||(Lt={buildSymbolDisplay:n,buildTypeDisplay:r,buildTypeParameterDisplay:s,buildTypePredicateDisplay:h,buildParameterDisplay:o,buildDisplayForParametersAndDelimiters:p,buildDisplayForTypeParametersAndDelimiters:c,buildTypeParameterDisplayFromSymbol:i,buildSignatureDisplay:m,buildIndexSignatureDisplay:_,buildReturnTypeDisplay:f})}function Pr(t){if(t){var n=gn(t);return void 0===n.isVisible&&(n.isVisible=!!function(){switch(t.kind){case 176:return Pr(t.parent.parent);case 226:if(e.isBindingPattern(t.name)&&!t.name.elements.length)return!1;case 233:case 229:case 230:case 231:case 228:case 232:case 237:if(e.isExternalModuleAugmentation(t))return!0;var n=Vr(t);return 1&e.getCombinedModifierFlags(t)||237!==t.kind&&265!==n.kind&&e.isInAmbientContext(n)?Pr(n):bn(n);case 149:case 148:case 153:case 154:case 151:case 150:if(e.hasModifier(t,24))return!1;case 152:case 156:case 155:case 157:case 146:case 234:case 160:case 161:case 163:case 159:case 164:case 165:case 166:case 167:case 168:return Pr(t.parent);case 239:case 240:case 242:return!1;case 145:case 265:case 236:return!0;case 243:default:return!1}}()),n.isVisible}return!1}function Mr(t){var n;t.parent&&243===t.parent.kind?n=kn(t.parent,t.escapedText,2998271,e.Diagnostics.Cannot_find_name_0,t,!1):246===t.parent.kind&&(n=On(t.parent,2998271));var r=[];return n&&function t(n){e.forEach(n,(function(n){gn(n).isVisible=!0;var i=wn(n)||n;if(e.pushIfUnique(r,i),e.isInternalModuleImportEqualsDeclaration(n)){var s=kn(n,Zh(n.moduleReference).escapedText,901119,void 0,void 0,!1);s&&t(s.declarations)}}))}(n.declarations),r}function Fr(e,t){var n=$r(e,t);if(n>=0){for(var r=ht.length,i=n;i<r;i++)ft[i]=!1;return!1}return ht.push(e),ft.push(!0),mt.push(t),!0}function $r(e,t){for(var n=ht.length-1;n>=0;n--){if(Br(ht[n],mt[n]))return-1;if(ht[n]===e&&mt[n]===t)return n}return-1}function Br(t,n){return 0===n?_n(t).type:2===n?_n(t).declaredType:1===n?t.resolvedBaseConstructorType:3===n?t.resolvedReturnType:void e.Debug.fail("Unhandled TypeSystemPropertyName "+n)}function Ur(){return ht.pop(),mt.pop(),ft.pop()}function Vr(t){return(t=e.findAncestor(e.getRootDeclaration(t),(function(e){switch(e.kind){case 226:case 227:case 242:case 241:case 240:case 239:return!1;default:return!0}})))&&t.parent}function Hr(e,t){var n=bs(e,t);return n?li(n):void 0}function Gr(e){return e&&0!=(1&e.flags)}function jr(e){var t=er(e);return t&&_n(t).type||Xr(e,!1)}function Kr(t){return 144===t.kind&&!e.isStringOrNumericLiteral(t.expression)}function Wr(t,n,r){if(8192&(t=bc(t,(function(e){return!(6144&e.flags)}))).flags)return ue;if(65536&t.flags)return vc(t,(function(e){return Wr(e,n,r)}));for(var i=e.createSymbolTable(),s=e.createUnderscoreEscapedMap(),o=0,a=n;o<a.length;o++){var l=a[o];s.set(e.getTextOfPropertyName(l),!0)}for(var c=0,u=as(t);c<u.length;c++){var d=u[c],p=s.has(d.escapedName),h=24&e.getDeclarationModifierFlagsFromSymbol(d),f=65536&d.flags&&!(32768&d.flags);p||h||oa(d)||f||i.set(d.escapedName,d)}var m=xs(t,0),_=xs(t,1);return dr(r,i,e.emptyArray,e.emptyArray,m,_)}function zr(t){var n,r=t.parent,i=jr(r.parent);if(i===J)return J;if(!i)return t.initializer?vp(t):i;if(Gr(i))return i;if(174===r.kind)if(t.dotDotDotToken){if(!Eu(i))return ln(t,e.Diagnostics.Rest_types_may_only_be_created_from_object_types),J;for(var s=[],o=0,a=r.elements;o<a.length;o++){var l=a[o];l.dotDotDotToken||s.push(l.propertyName||l.name)}n=Wr(i,s,t.symbol)}else{var c=t.propertyName||t.name;if(Kr(c))return z;var u=e.getTextOfPropertyName(c),d=Hr(i,u);if(!(n=d&&Lc(t,d)||bu(u)&&Ss(i,1)||Ss(i,0)))return ln(c,e.Diagnostics.Type_0_has_no_property_1_and_no_string_index_signature,Cr(i),e.declarationNameToString(c)),J}else{var p=Nh(i,r,!1,!1);if(t.dotDotDotToken)n=No(p);else{var h=""+e.indexOf(r.elements,t);if(!(n=cl(i)?Hr(i,h):p))return fl(i)?ln(t,e.Diagnostics.Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2,Cr(i),Zs(i),r.elements.length):ln(t,e.Diagnostics.Type_0_has_no_property_1,Cr(i),h),J}}return!A||!t.initializer||2048&_l(yp(t.initializer))||(n=nc(n,131072)),t.initializer?Uo([n,yp(t.initializer)],!0):n}function qr(t){var n=e.getJSDocType(t);if(n)return pa(n)}function Jr(t){var n=e.skipParentheses(t);return 177===n.kind&&0===n.elements.length}function Yr(e,t){return A&&t?vl(e,2048):e}function Xr(t,n){if(215===t.parent.parent.kind){var r=Wo(ju(t.parent.parent.expression));return 278528&r.flags?r:ee}if(216===t.parent.parent.kind){var i=t.parent.parent;return wh(i.expression,i.awaitModifier)||z}if(e.isBindingPattern(t.parent))return zr(t);var s,o,a=e.getEffectiveTypeAnnotationNode(t);if(a)return Yr(pa(a),t.questionToken&&n);if((N||e.isInJavaScriptFile(t))&&226===t.kind&&!e.isBindingPattern(t.name)&&!(1&e.getCombinedModifierFlags(t))&&!e.isInAmbientContext(t)){if(!(2&e.getCombinedNodeFlags(t)||t.initializer&&(s=t.initializer,o=e.skipParentheses(s),95!==o.kind&&(71!==o.kind||jl(o)!==L))))return q;if(t.initializer&&Jr(t.initializer))return Oe}if(146===t.kind){var l=t.parent;if(154===l.kind&&!e.hasDynamicName(l)){var c=e.getDeclarationOfKind(t.parent.symbol,153);if(c){var u=Rs(c),d=mm(l);return d&&t===d?(e.Debug.assert(!d.type),li(u.thisParameter)):Ms(u)}}var p=void 0;if(p="this"===t.symbol.escapedName?Zc(l):eu(t))return Yr(p,t.questionToken&&n)}return t.initializer?Yr(p=vp(t),t.questionToken&&n):e.isJsxAttribute(t)?ne:262===t.kind?Hc(t.name):e.isBindingPattern(t.name)?Zr(t.name,!1,!0):void 0}function Qr(t,n,r){return t.initializer?vp(t):e.isBindingPattern(t.name)?Zr(t.name,n,r):(r&&N&&!ti(t)&&wl(t,z),z)}function Zr(t,n,r){return 174===t.kind?function(t,n,r){var i,s=e.createSymbolTable(),o=!1;e.forEach(t.elements,(function(t){var a=t.propertyName||t.name;if(Kr(a))o=!0;else if(t.dotDotDotToken)i=Ks(z,!1);else{var l=e.getTextOfPropertyName(a),c=cn(4|(t.initializer?16777216:0),l);c.type=Qr(t,n,r),c.bindingElement=t,s.set(c.escapedName,c)}}));var a=dr(void 0,s,e.emptyArray,e.emptyArray,i,void 0);return n&&(a.pattern=t),o&&(a.objectFlags|=512),a}(t,n,r):function(t,n,r){var i=t.elements,s=e.lastOrUndefined(i);if(0===i.length||!e.isOmittedExpression(s)&&s.dotDotDotToken)return x>=2?Ao(z):De;var o=Oo(e.map(i,(function(t){return e.isOmittedExpression(t)?z:Qr(t,n,r)})));return n&&((o=Qs(o)).pattern=t),o}(t,n,r)}function ei(e,t){var n=Xr(e,!0);return n?(t&&Nl(e,n),261===e.kind?n:Il(n)):(n=e.dotDotDotToken?De:z,t&&N&&(ti(e)||wl(e,n)),n)}function ti(t){var n=e.getRootDeclaration(t);return Hp(146===n.kind?n.parent:n)}function ni(t){var n,r=_n(t);if(!r.type){if(4194304&t.flags)return r.type=(n=Oi(tr(t))).typeParameters?Xs(n,e.map(n.typeParameters,(function(e){return z}))):n;var i=t.valueDeclaration;if(e.isCatchClauseVariableDeclarationOrBindingElement(i))return r.type=z;if(243===i.kind)return r.type=Ip(i.expression);if(e.isInJavaScriptFile(i)&&e.isJSDocPropertyLikeTag(i)&&i.typeExpression)return r.type=pa(i.typeExpression.type);if(!Fr(t,0))return J;var s=void 0;s=194===i.kind||179===i.kind&&194===i.parent.kind?function(t){for(var n,r=[],i=!1,s=!1,o=0,a=t.declarations;o<a.length;o++){var l=a[o],c=194===l.kind?l:179===l.kind?e.getAncestor(l,194):void 0;if(!c)return J;e.isPropertyAccessExpression(c.left)&&99===c.left.expression.kind&&(152===e.getThisContainer(c,!1).kind?i=!0:s=!0);var u=qr(c.parent);if(u){var d=Il(u);if(n){if(n!==J&&d!==J&&!wa(n,d)){var p=e.getNameOfDeclaration(l);ln(p,e.Diagnostics.Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2,e.declarationNameToString(p),Cr(n),Cr(d))}}else n=d}else n||r.push(hl(yp(c.right)))}return Il(Yr(n||Uo(r,!0),s&&!i))}(t):ei(i,!0),Ur()||(s=ai(t)),r.type=s}return r.type}function ri(t){if(t){if(153===t.kind){var n=e.getEffectiveReturnTypeNode(t);return n&&pa(n)}var r=e.getEffectiveSetAccessorTypeAnnotationNode(t);return r&&pa(r)}}function ii(e){return Ps(Rs(e))}function si(t){var n=_n(t);if(!n.type){var r=e.getDeclarationOfKind(t,153),i=e.getDeclarationOfKind(t,154);if(r&&e.isInJavaScriptFile(r)){var s=qr(r);if(s)return n.type=s}if(!Fr(t,0))return J;var o=void 0,a=ri(r);if(a)o=a;else{var l=ri(i);l?o=l:r&&r.body?o=Wd(r):(N&&(i?ln(i,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation,xr(t)):(e.Debug.assert(!!r,"there must existed getter as we are current checking either setter or getter in this function"),ln(r,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation,xr(t)))),o=z)}if(!Ur())if(o=z,N)ln(e.getDeclarationOfKind(t,153),e.Diagnostics._0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions,xr(t));n.type=o}return n.type}function oi(e){var t=ki(Si(e));return 540672&t.flags?t:void 0}function ai(t){return e.getEffectiveTypeAnnotationNode(t.valueDeclaration)?(ln(t.valueDeclaration,e.Diagnostics._0_is_referenced_directly_or_indirectly_in_its_own_type_annotation,xr(t)),J):(N&&ln(t.valueDeclaration,e.Diagnostics._0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or_indirectly_in_its_own_initializer,xr(t)),z)}function li(t){return 1&e.getCheckFlags(t)?function(t){var n=_n(t);if(!n.type)if(100===v)ln(t.valueDeclaration,e.Diagnostics.Generic_type_instantiation_is_excessively_deep_and_possibly_infinite),n.type=J;else{if(!Fr(t,0))return J;v++;var r=Ea(li(n.target),n.mapper);v--,Ur()||(r=ai(t)),n.type=r}return n.type}(t):7&t.flags?ni(t):9136&t.flags?function(t){var n=_n(t);if(!n.type)if(1536&t.flags&&e.isShorthandAmbientModuleSymbol(t))n.type=z;else{var r=ar(16,t);if(32&t.flags){var i=oi(t);n.type=i?jo([r,i]):r}else n.type=A&&16777216&t.flags?vl(r,2048):r}return n.type}(t):8&t.flags?function(e){var t=_n(e);return t.type||(t.type=Ni(e)),t.type}(t):98304&t.flags?si(t):2097152&t.flags?function(e){var t=_n(e);if(!t.type){var n=Mn(e);t.type=107455&n.flags?li(n):J}return t.type}(t):J}function ci(e,t){return void 0!==e&&void 0!==t&&0!=(4&yn(e))&&e.target===t}function ui(e){return 4&yn(e)?e.target:e}function di(t,n){return function t(r){if(7&yn(r)){var i=ui(r);return i===n||e.forEach(Ei(i),t)}if(131072&r.flags)return e.forEach(r.types,t)}(t)}function pi(t,n){for(var r=0,i=n;r<i.length;r++){var s=Di(er(i[r]));t=e.appendIfUnique(t,s)}return t}function hi(t,n){for(;;){if(!(t=t.parent))return;switch(t.kind){case 229:case 199:case 230:case 155:case 156:case 150:case 160:case 161:case 273:case 228:case 151:case 186:case 187:case 231:case 282:case 172:var r=hi(t,n);if(172===t.kind)return e.append(r,Di(er(t.typeParameter)));var i=pi(r,e.getEffectiveTypeParameterDeclarations(t)||e.emptyArray),s=n&&(229===t.kind||199===t.kind||230===t.kind)&&Si(er(t)).thisType;return s?e.append(i,s):i}}}function fi(t){return hi(32&t.flags?t.valueDeclaration:e.getDeclarationOfKind(t,230))}function mi(e){for(var t,n=0,r=e.declarations;n<r.length;n++){var i=r[n];if(230===i.kind||229===i.kind||199===i.kind||231===i.kind){var s=i;s.typeParameters&&(t=pi(t,s.typeParameters))}}return t}function _i(t){return e.concatenate(fi(t),mi(t))}function gi(e){var t=Ts(e,1);if(1===t.length){var n=t[0];return!n.typeParameters&&1===n.parameters.length&&n.hasRestParameter&&Bd(n.parameters[0])===De}return!1}function yi(e){if(xi(e)&&Ts(e,1).length>0)return!0;if(540672&e.flags){var t=us(e);return t&&xi(t)&&gi(t)}return!1}function bi(t){var n=t.symbol.valueDeclaration;if(e.isInJavaScriptFile(n)){var r=e.getJSDocAugmentsTag(n);if(r)return r.class}return e.getClassExtendsHeritageClauseElement(n)}function vi(t,n,r){var i=e.length(n),s=e.isInJavaScriptFile(r);return e.filter(Ts(t,1),(function(t){return(s||i>=Ds(t.typeParameters))&&i<=e.length(t.typeParameters)}))}function Ti(t,n,r){var i=vi(t,n,r),s=e.map(n,pa);return e.sameMap(i,(function(t){return e.some(t.typeParameters)?$s(t,s,e.isInJavaScriptFile(r)):t}))}function ki(t){if(!t.resolvedBaseConstructorType){var n=t.symbol.valueDeclaration,r=e.getClassExtendsHeritageClauseElement(n),i=bi(t);if(!i)return t.resolvedBaseConstructorType=Y;if(!Fr(t,1))return J;var s=Ip(i.expression);if(r&&i!==r&&(e.Debug.assert(!r.typeArguments),Ip(r.expression)),163840&s.flags&&is(s),!Ur())return ln(t.symbol.valueDeclaration,e.Diagnostics._0_is_referenced_directly_or_indirectly_in_its_own_base_expression,xr(t.symbol)),t.resolvedBaseConstructorType=J;if(!(1&s.flags||s===Z||yi(s)))return ln(i.expression,e.Diagnostics.Type_0_is_not_a_constructor_function_type,Cr(s)),t.resolvedBaseConstructorType=J;t.resolvedBaseConstructorType=s}return t.resolvedBaseConstructorType}function Ei(t){return t.resolvedBaseTypes||(8&t.objectFlags?t.resolvedBaseTypes=[No(Uo(t.typeParameters))]:96&t.symbol.flags?(32&t.symbol.flags&&function(t){t.resolvedBaseTypes=e.emptyArray;var n=ms(ki(t));if(!(163841&n.flags))return;var r,i=bi(t),s=ao(i),o=n&&n.symbol?Oi(n.symbol):void 0;if(n.symbol&&32&n.symbol.flags&&function(e){var t=e.outerTypeParameters;if(t){var n=t.length-1,r=e.typeArguments;return t[n].symbol!==r[n].symbol}return!0}(o))r=eo(i,n.symbol,s);else if(1&n.flags)r=n;else{var a=Ti(n,i.typeArguments,i);if(!a.length)return void ln(i.expression,e.Diagnostics.No_base_constructor_has_the_specified_number_of_type_arguments);r=Ms(a[0])}if(r===J)return;if(!xi(r))return void ln(i.expression,e.Diagnostics.Base_constructor_return_type_0_is_not_a_class_or_interface_type,Cr(r));if(t===r||di(r,t))return void ln(t.symbol.valueDeclaration,e.Diagnostics.Type_0_recursively_references_itself_as_a_base_type,Cr(t,void 0,1));t.resolvedBaseTypes=[r]}(t),64&t.symbol.flags&&function(t){t.resolvedBaseTypes=t.resolvedBaseTypes||e.emptyArray;for(var n=0,r=t.symbol.declarations;n<r.length;n++){var i=r[n];if(230===i.kind&&e.getInterfaceBaseTypeNodes(i))for(var s=0,o=e.getInterfaceBaseTypeNodes(i);s<o.length;s++){var a=o[s],l=pa(a);l!==J&&(xi(l)?t===l||di(l,t)?ln(i,e.Diagnostics.Type_0_recursively_references_itself_as_a_base_type,Cr(t,void 0,1)):t.resolvedBaseTypes===e.emptyArray?t.resolvedBaseTypes=[l]:t.resolvedBaseTypes.push(l):ln(a,e.Diagnostics.An_interface_may_only_extend_a_class_or_another_interface))}}}(t)):e.Debug.fail("type must be class or interface")),t.resolvedBaseTypes}function xi(t){return 16809985&t.flags&&!rs(t)||131072&t.flags&&!e.forEach(t.types,(function(e){return!xi(e)}))}function Si(t){var n=_n(t);if(!n.declaredType){var r=32&t.flags?1:2,i=n.declaredType=ar(r,t),s=fi(t),o=mi(t);(s||o||1===r||!function(t){for(var n=0,r=t.declarations;n<r.length;n++){var i=r[n];if(230===i.kind){if(64&i.flags)return!1;var s=e.getInterfaceBaseTypeNodes(i);if(s)for(var o=0,a=s;o<a.length;o++){var l=a[o];if(e.isEntityNameExpression(l.expression)){var c=Vn(l.expression,793064,!0);if(!c||!(64&c.flags)||Si(c).thisType)return!1}}}}return!0}(t))&&(i.objectFlags|=4,i.typeParameters=e.concatenate(s,o),i.outerTypeParameters=s,i.localTypeParameters=o,i.instantiations=e.createMap(),i.instantiations.set(Js(i.typeParameters),i),i.target=i,i.typeArguments=i.typeParameters,i.thisType=sr(16384),i.thisType.isThisType=!0,i.thisType.symbol=t,i.thisType.constraint=i)}return n.declaredType}function Ci(t){var n=t.initializer;if(!n)return!e.isInAmbientContext(t);switch(n.kind){case 9:case 8:return!0;case 192:return 38===n.operator&&8===n.operand.kind;case 71:return e.nodeIsMissing(n)||!!er(t.parent).exports.get(n.escapedText);default:return!1}}function Ii(e){var t=_n(e);if(void 0!==t.enumKind)return t.enumKind;for(var n=!1,r=0,i=e.declarations;r<i.length;r++){var s=i[r];if(232===s.kind)for(var o=0,a=s.members;o<a.length;o++){var l=a[o];if(l.initializer&&9===l.initializer.kind)return t.enumKind=1;Ci(l)||(n=!0)}}return t.enumKind=n?0:1}function Ai(e){return 256&e.flags&&!(65536&e.flags)?Oi(tr(e.symbol)):e}function wi(e){var t=_n(e);if(t.declaredType)return t.declaredType;if(1===Ii(e)){b++;for(var n=[],r=0,i=e.declarations;r<i.length;r++){var s=i[r];if(232===s.kind)for(var o=0,a=s.members;o<a.length;o++){var l=a[o],c=ua(Uf(l),b,er(l));_n(er(l)).declaredType=c,n.push(c)}}if(n.length){var u=Uo(n,!1,e,void 0);return 65536&u.flags&&(u.flags|=256,u.symbol=e),t.declaredType=u}}var d=sr(16);return d.symbol=e,t.declaredType=d}function Ni(e){var t=_n(e);if(!t.declaredType){var n=wi(tr(e));t.declaredType||(t.declaredType=n)}return t.declaredType}function Di(e){var t=_n(e);if(!t.declaredType){var n=sr(16384);n.symbol=e,t.declaredType=n}return t.declaredType}function Oi(e){return Ri(e)||J}function Ri(t){return 96&t.flags?Si(t):524288&t.flags?function(t){var n=_n(t);if(!n.declaredType){if(!Fr(t,2))return J;var r=e.find(t.declarations,(function(e){return 283===e.kind||231===e.kind})),i=283===r.kind?r.typeExpression:r.type,s=i?pa(i):J;if(Ur()){var o=mi(t);o&&(n.typeParameters=o,n.instantiations=e.createMap(),n.instantiations.set(Js(o),s))}else s=J,ln(r.name,e.Diagnostics.Type_alias_0_circularly_references_itself,xr(t));n.declaredType=s}return n.declaredType}(t):262144&t.flags?Di(t):384&t.flags?wi(t):8&t.flags?Ni(t):2097152&t.flags?function(e){var t=_n(e);return t.declaredType||(t.declaredType=Oi(Mn(e))),t.declaredType}(t):void 0}function Li(e){switch(e.kind){case 119:case 136:case 133:case 122:case 137:case 134:case 105:case 139:case 95:case 130:case 173:return!0;case 164:return Li(e.elementType);case 159:return function(e){if(e.typeArguments)for(var t=0,n=e.typeArguments;t<n.length;t++)if(!Li(n[t]))return!1;return!0}(e)}return!1}function Pi(t){var n=e.getEffectiveTypeAnnotationNode(t);return n?Li(n):!t.initializer}function Mi(t){if(t.declarations&&1===t.declarations.length){var n=t.declarations[0];if(n)switch(n.kind){case 149:case 148:return Pi(n);case 151:case 150:case 152:return function(t){if(152!==t.kind){var n=e.getEffectiveReturnTypeNode(t);if(!n||!Li(n))return!1}for(var r=0,i=t.parameters;r<i.length;r++)if(!Pi(i[r]))return!1;return!0}(n)}}return!1}function Fi(t,n,r){for(var i=e.createSymbolTable(),s=0,o=t;s<o.length;s++){var a=o[s];i.set(a.escapedName,r&&Mi(a)?a:va(a,n))}return i}function $i(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];e.has(i.escapedName)||e.set(i.escapedName,i)}}function Bi(e){if(!e.declaredProperties){var t=e.symbol;e.declaredProperties=cr(t.members),e.declaredCallSignatures=Ls(t.members.get("__call")),e.declaredConstructSignatures=Ls(t.members.get("__new")),e.declaredStringIndexInfo=Ws(t,0),e.declaredNumberIndexInfo=Ws(t,1)}return e}function Ui(t,n){if(4&yn(t)){var r=t.target,i=t.typeArguments;if(e.length(r.typeParameters)===e.length(i))return Xs(r,e.concatenate(i,[n||r.thisType]))}else if(131072&t.flags)return jo(e.map(t.types,(function(e){return Ui(e,n)})));return t}function Vi(t,n,r,i){var s,o,a,l,c,u;e.rangeEquals(r,i,0,r.length)?(s=k,o=n.symbol?n.symbol.members:e.createSymbolTable(n.declaredProperties),a=n.declaredCallSignatures,l=n.declaredConstructSignatures,c=n.declaredStringIndexInfo,u=n.declaredNumberIndexInfo):(s=_a(r,i),o=Fi(n.declaredProperties,s,1===r.length),a=ma(n.declaredCallSignatures,s),l=ma(n.declaredConstructSignatures,s),c=xa(n.declaredStringIndexInfo,s),u=xa(n.declaredNumberIndexInfo,s));var d=Ei(n);if(d.length){n.symbol&&o===n.symbol.members&&(o=e.createSymbolTable(n.declaredProperties));for(var p=e.lastOrUndefined(i),h=0,f=d;h<f.length;h++){var m=f[h],_=p?Ui(Ea(m,s),p):m;$i(o,as(_)),a=e.concatenate(a,Ts(_,0)),l=e.concatenate(l,Ts(_,1)),c||(c=_===z?Ks(z,!1):xs(_,0)),u=u||xs(_,1)}}ur(t,o,a,l,c,u)}function Hi(e,t,n,r,i,s,o,a,l){var c=new _($);return c.declaration=e,c.typeParameters=t,c.parameters=r,c.thisParameter=n,c.resolvedReturnType=i,c.typePredicate=s,c.minArgumentCount=o,c.hasRestParameter=a,c.hasLiteralTypes=l,c}function Gi(e){return Hi(e.declaration,e.typeParameters,e.thisParameter,e.parameters,e.resolvedReturnType,e.typePredicate,e.minArgumentCount,e.hasRestParameter,e.hasLiteralTypes)}function ji(e,t,n,r,i){for(var s=0,o=e;s<o.length;s++){var a=o[s];if(il(a,t,n,r,i,Na))return a}}function Ki(t,n,r){if(n.typeParameters){if(r>0)return;for(var i=1;i<t.length;i++)if(!ji(t[i],n,!1,!1,!1))return;return[n]}var s=void 0;for(i=0;i<t.length;i++){var o=i===r?n:ji(t[i],n,!0,!0,!0);if(!o)return;s=e.appendIfUnique(s,o)}return s}function Wi(t,n){for(var r=e.map(t,(function(e){return Ts(e,n)})),i=void 0,s=0;s<r.length;s++)for(var o=0,a=r[s];o<a.length;o++){var l=a[o];if(!i||!ji(i,l,!1,!0,!0)){var c=Ki(r,l,s);if(c){var u=l;if(c.length>1){if(u=Gi(l),e.forEach(c,(function(e){return e.thisParameter}))){var d=Uo(e.map(c,(function(e){return li(e.thisParameter)||z})),!0);u.thisParameter=El(l.thisParameter,d)}u.resolvedReturnType=void 0,u.unionSignatures=c}(i||(i=[])).push(u)}}}return i||e.emptyArray}function zi(e,t){for(var n=[],r=!1,i=0,s=e;i<s.length;i++){var o=xs(s[i],t);if(!o)return;n.push(o.type),r=r||o.isReadonly}return Ks(Uo(n,!0),r)}function qi(e,t){return e?t?jo([e,t]):e:t}function Ji(e,t){return e?t?Ks(jo([e.type,t.type]),e.isReadonly&&t.isReadonly):e:t}function Yi(e,t){return e&&t&&Ks(Uo([e.type,t.type]),e.isReadonly||t.isReadonly)}function Xi(t){for(var n,r,i=e.emptyArray,s=e.emptyArray,o=t.types,a=e.countWhere(o,gi),l=function(l){var c=t.types[l];if(0===a||a===o.length&&0===l||!gi(c)){var u=Ts(c,1);u.length&&a>0&&(u=e.map(u,(function(e){var t=Gi(e);return t.resolvedReturnType=function(e,t,n){for(var r=[],i=0;i<t.length;i++)i===n?r.push(e):gi(t[i])&&r.push(Ms(Ts(t[i],1)[0]));return jo(r)}(Ms(e),o,l),t}))),s=e.concatenate(s,u)}i=e.concatenate(i,Ts(c,0)),n=Ji(n,xs(c,0)),r=Ji(r,xs(c,1))},c=0;c<o.length;c++)l(c);ur(t,T,i,s,n,r)}function Qi(t){var n=t.symbol;if(t.target)ur(t,s=Fi(ss(t.target),t.mapper,!1),r=ma(Ts(t.target,0),t.mapper),i=ma(Ts(t.target,1),t.mapper),o=xa(xs(t.target,0),t.mapper),l=xa(xs(t.target,1),t.mapper));else if(2048&n.flags){var r=Ls((s=n.members).get("__call")),i=Ls(s.get("__new"));ur(t,s,r,i,o=Ws(n,0),l=Ws(n,1))}else{var s=T,o=void 0;if(n.exports&&(s=Yn(n)),32&n.flags){var a=ki(c=Si(n));704512&a.flags?$i(s=e.createSymbolTable(cr(s)),as(a)):a===z&&(o=Ks(z,!1))}var l=384&n.flags?it:void 0;if(ur(t,s,e.emptyArray,e.emptyArray,o,l),8208&n.flags&&(t.callSignatures=Ls(n)),32&n.flags){var c=Si(n);(i=Ls(n.members.get("__constructor"))).length||(i=function(t){var n=Ts(ki(t),1);if(0===n.length)return[Hi(void 0,t.localTypeParameters,void 0,e.emptyArray,t,void 0,0,!1,!1)];for(var r=bi(t),i=e.isInJavaScriptFile(r),s=ao(r),o=e.length(s),a=[],l=0,c=n;l<c.length;l++){var u=c[l],d=Ds(u.typeParameters),p=e.length(u.typeParameters);if((i||o>=d)&&o<=p){var h=p?Bs(u,Os(s,u.typeParameters,d,i)):Gi(u);h.typeParameters=t.localTypeParameters,h.resolvedReturnType=t,a.push(h)}}return a}(c)),t.constructSignatures=i}}}function Zi(t){var n,r=e.createSymbolTable();ur(t,T,e.emptyArray,e.emptyArray,void 0,void 0);var i=es(t),s=ts(t),o=ns(t),a=ms(function(e){if(!e.modifiersType){var t=e.declaration.typeParameter.constraint;if(170===t.kind)e.modifiersType=Ea(pa(t.type),e.mapper||k);else{var n=ts(ea(e.declaration)),r=n&&16384&n.flags?ls(n):n;e.modifiersType=r&&262144&r.flags?Ea(r.type,e.mapper||k):ue}}return e.modifiersType}(t)),l=!!t.declaration.readonlyToken,c=!!t.declaration.questionToken;if(170===t.declaration.typeParameter.constraint.kind){for(var u=0,d=as(a);u<d.length;u++){var p=d[u];f(Ko(p),p)}(1&a.flags||xs(a,0))&&f(ee)}else{var h=540672&s.flags?ms(s):s;yc(262144&h.flags?Wo(ms(h.type)):h,f)}function f(s,u){var d;"object"==typeof u&&(d=u);var p=_a([i],[s]),h=t.mapper?ga(t.mapper,p):p,f=Ea(o,h);if(32&s.flags){var m=e.escapeLeadingUnderscores(s.value),_=bs(a,m),g=cn(4|(c||!!(_&&16777216&_.flags)?16777216:0),m);g.checkFlags=l||_&&ep(_)?8:0,g.type=f,d&&(g.syntheticOrigin=d,g.declarations=d.declarations),g.syntheticLiteralTypeOrigin=s,r.set(m,g)}else 3&s.flags&&(n=Ks(f,l))}ur(t,r,e.emptyArray,e.emptyArray,n,void 0)}function es(e){return e.typeParameter||(e.typeParameter=Di(er(e.declaration.typeParameter)))}function ts(e){return e.constraintType||(e.constraintType=Ea(ls(es(e)),e.mapper||k)||J)}function ns(e){return e.templateType||(e.templateType=e.declaration.type?Ea(Yr(pa(e.declaration.type),!!e.declaration.questionToken),e.mapper||k):J)}function rs(e){return 32&yn(e)&&Jo(ts(e))}function is(t){return t.members||(32768&t.flags?4&t.objectFlags?function(t){var n=Bi(t.target),r=e.concatenate(n.typeParameters,[n.thisType]);Vi(t,n,r,t.typeArguments&&t.typeArguments.length===r.length?t.typeArguments:e.concatenate(t.typeArguments,[t]))}(t):3&t.objectFlags?function(t){Vi(t,Bi(t),e.emptyArray,e.emptyArray)}(t):16&t.objectFlags?Qi(t):32&t.objectFlags&&Zi(t):65536&t.flags?function(e){var t=Wi(e.types,0),n=Wi(e.types,1),r=zi(e.types,0),i=zi(e.types,1);ur(e,T,t,n,r,i)}(t):131072&t.flags&&Xi(t)),t}function ss(t){return 32768&t.flags?is(t).properties:e.emptyArray}function os(e,t){if(32768&e.flags){var n=is(e).members.get(t);if(n&&rr(n))return n}}function as(t){return 196608&(t=ms(t)).flags?function(t){if(!t.resolvedProperties){for(var n=e.createSymbolTable(),r=0,i=t.types;r<i.length;r++){for(var s=0,o=as(i[r]);s<o.length;s++){var a=o[s];if(!n.has(a.escapedName)){var l=ys(t,a.escapedName);l&&n.set(a.escapedName,l)}}if(65536&t.flags)break}t.resolvedProperties=cr(n)}return t.resolvedProperties}(t):ss(t)}function ls(e){return ds(e)?zs(e):void 0}function cs(e){var t=Xo(e);if(t)return t;var n=us(e.objectType),r=us(e.indexType);return n||r?Qo(n||e.objectType,r||e.indexType):void 0}function us(e){if(737280&e.flags){var t=ps(e);if(t!==me&&t!==_e)return t}else if(262144&e.flags)return ee}function ds(e){return ps(e)!==_e}function ps(t){var n,r;if(!t.resolvedBaseConstraint){n=[];var i=s(t);t.resolvedBaseConstraint=r?_e:Ui(i||me,t)}return t.resolvedBaseConstraint;function s(t){if(!e.contains(n,t)){n.push(t);var i=function(e){if(16384&e.flags){var t=zs(e);return e.isThisType?t:t?s(t):void 0}if(196608&e.flags){for(var n=e.types,r=[],i=0,o=n;i<o.length;i++){var a=s(o[i]);a&&r.push(a)}return 65536&e.flags&&r.length===n.length?Uo(r):131072&e.flags&&r.length?jo(r):void 0}if(262144&e.flags)return ee;if(524288&e.flags){var l=Xo(e);if(l)return s(l);var c=s(e.objectType),u=s(e.indexType),d=c&&u?Qo(c,u):void 0;return d&&d!==J?s(d):void 0}if(rs(e))return ue;return e}(t);return n.pop(),i}r=!0}}function hs(t){if(t.default)t.default===ge&&(t.default=_e);else if(t.target){var n=hs(t.target);t.default=n?Ea(n,t.mapper):me}else{t.default=ge;var r=t.symbol&&e.forEach(t.symbol.declarations,(function(t){return e.isTypeParameterDeclaration(t)&&t.default})),i=r?pa(r):me;t.default===ge&&(t.default=i)}return t.default}function fs(e){var t=hs(e);return t!==me&&t!==_e?t:void 0}function ms(e){var t=540672&e.flags?us(e)||ue:e;return 131072&t.flags?function(e){return e.resolvedApparentType||(e.resolvedApparentType=Ui(e,e))}(t):262178&t.flags?Ce:84&t.flags?Ie:136&t.flags?Ae:512&t.flags?fo(x>=2):16777216&t.flags?ue:t}function _s(t,n){for(var r,i=t.types,s=65536&t.flags,o=s?24:0,a=s?0:16777216,l=4,c=0,u=0,d=i;u<d.length;u++){if((b=ms(d[u]))!==J){var p=(y=bs(b,n))?e.getDeclarationModifierFlagsFromSymbol(y):0;!y||p&o?s&&(c|=16):(a&=y.flags,r=e.appendIfUnique(r,y),c|=(ep(y)?8:0)|(24&p?0:64)|(16&p?128:0)|(8&p?256:0)|(32&p?512:0),Hu(y)||(l=2))}}if(r){if(1===r.length&&!(16&c))return r[0];for(var h=[],f=[],m=void 0,_=0,g=r;_<g.length;_++){var y;(y=g[_]).declarations&&e.addRange(f,y.declarations);var b=li(y);m?b!==m&&(c|=32):m=b,h.push(b)}var v=cn(4|a,n);return v.checkFlags=l|c,v.containingType=t,v.declarations=f,v.type=s?Uo(h):jo(h),v}}function gs(t,n){var r=t.propertyCache||(t.propertyCache=e.createSymbolTable()),i=r.get(n);return i||(i=_s(t,n))&&r.set(n,i),i}function ys(t,n){var r=gs(t,n);return!r||16&e.getCheckFlags(r)?void 0:r}function bs(e,t){if(32768&(e=ms(e)).flags){var n=is(e),r=n.members.get(t);if(r&&rr(r))return r;if(n===fe||n.callSignatures.length||n.constructSignatures.length){var i=os(Ee,t);if(i)return i}return os(ke,t)}if(196608&e.flags)return ys(e,t)}function vs(t,n){if(229376&t.flags){var r=is(t);return 0===n?r.callSignatures:r.constructSignatures}return e.emptyArray}function Ts(e,t){return vs(ms(e),t)}function ks(e,t){if(229376&e.flags){var n=is(e);return 0===t?n.stringIndexInfo:n.numberIndexInfo}}function Es(e,t){var n=ks(e,t);return n&&n.type}function xs(e,t){return ks(ms(e),t)}function Ss(e,t){return Es(ms(e),t)}function Cs(e,t){if(kl(e)){for(var n=[],r=0,i=as(e);r<i.length;r++){var s=i[r];(0===t||bu(s.escapedName))&&n.push(li(s))}if(n.length)return Uo(n,!0)}}function Is(e){var t=[];return e.forEach((function(e,n){lr(n)||t.push(e)})),t}function As(t){if(e.isInJavaScriptFile(t)){if(t.type&&272===t.type.kind)return!0;var n=e.getJSDocParameterTags(t);if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s.isBracketed)return!0;if(s.typeExpression)return 272===s.typeExpression.type.kind}}}function ws(t,n){if(!e.isExternalModuleNameRelative(t)){var r=vn(ot,'"'+t+'"',512);return r&&n?Zn(r):r}}function Ns(t){if(e.hasQuestionToken(t)||As(t))return!0;if(t.initializer){var n=t.parent,r=Rs(n),i=e.indexOf(n.parameters,t);return e.Debug.assert(i>=0),i>=r.minArgumentCount}var s=e.getImmediatelyInvokedFunctionExpression(t.parent);return!!s&&(!t.type&&!t.dotDotDotToken&&e.indexOf(t.parent.parameters,t)>=s.arguments.length)}function Ds(t){var n,r=0;if(t)for(var i=0;i<t.length;i++)(n=t[i]).symbol&&e.forEach(n.symbol.declarations,(function(t){return e.isTypeParameterDeclaration(t)&&t.default}))||(r=i+1);return r}function Os(t,n,r,i){var s=e.length(n);if(s){var o=e.length(t);if((i||o>=r)&&o<=s){t||(t=[]);for(var a=o;a<s;a++)t[a]=Hl(i);for(a=o;a<s;a++){var l=_a(n,t),c=fs(n[a]);t[a]=c?Ea(c,l):Hl(i)}}}return t}function Rs(t){var n,r,i,s=gn(t);if(!s.resolvedSignature){for(var o=[],a=!1,l=0,c=void 0,u=void 0,d=e.getImmediatelyInvokedFunctionExpression(t),p=e.isJSDocConstructSignature(t),h=!d&&!p&&e.isInJavaScriptFile(t)&&!e.hasJSDocParameterTags(t),f=p?1:0;f<t.parameters.length;f++){var m=t.parameters[f],_=m.symbol;if(_&&4&_.flags&&!e.isBindingPattern(m.name))_=kn(m,_.escapedName,107455,void 0,void 0,!1);0===f&&"this"===_.escapedName?(u=!0,c=m.symbol):o.push(_),m.type&&173===m.type.kind&&(a=!0),m.initializer||m.questionToken||m.dotDotDotToken||d&&o.length>d.arguments.length&&!m.type||As(m)||h||(l=o.length)}if(!(153!==t.kind&&154!==t.kind||e.hasDynamicName(t)||u&&c)){var g=153===t.kind?154:153,y=e.getDeclarationOfKind(t.symbol,g);y&&(c=(i=mm(y))&&i.symbol)}var b=152===t.kind?Si(Zn(t.parent.symbol)):void 0,v=b?b.localTypeParameters:function(t){var n;return e.forEach(e.getEffectiveTypeParameterDeclarations(t),(function(t){var r=Di(t.symbol);n=e.appendIfUnique(n,r)})),n}(t),T=function(t,n,r){if(n)return pa(t.parameters[0].type);if(r)return r;var i=e.getEffectiveReturnTypeNode(t);if(i)return pa(i);if(153===t.kind&&!e.hasDynamicName(t)){return ri(e.getDeclarationOfKind(t.symbol,154))}if(e.nodeIsMissing(t.body))return z}(t,p,b),k=t.type&&158===t.type.kind?(n=t.type,71===(r=n.parameterName).kind?{kind:1,parameterName:r?r.escapedText:void 0,parameterIndex:r?Np(n.parent.parameters,r):void 0,type:pa(n.type)}:{kind:0,type:pa(n.type)}):void 0,E=e.hasRestParameter(t);if(!E&&e.isInJavaScriptFile(t)&&function(t){var n=gn(t);void 0===n.containsArgumentsReference&&(8192&n.flags?n.containsArgumentsReference=!0:n.containsArgumentsReference=r(t.body));return n.containsArgumentsReference;function r(t){if(!t)return!1;switch(t.kind){case 71:return"arguments"===t.escapedText&&e.isPartOfExpression(t);case 149:case 151:case 153:case 154:return 144===t.name.kind&&r(t.name);default:return!e.nodeStartsNewLexicalEnvironment(t)&&!e.isPartOfTypeNode(t)&&e.forEachChild(t,r)}}}(t)){E=!0;var x=cn(3,"args");x.type=De,x.isRestParameter=!0,o.push(x)}s.resolvedSignature=Hi(t,v,c,o,T,k,l,E,a)}return s.resolvedSignature}function Ls(t){if(!t)return e.emptyArray;for(var n=[],r=0;r<t.declarations.length;r++){var i=t.declarations[r];switch(i.kind){case 160:case 161:case 228:case 151:case 150:case 152:case 155:case 156:case 157:case 153:case 154:case 186:case 187:case 273:if(r>0&&i.body){var s=t.declarations[r-1];if(i.parent===s.parent&&i.kind===s.kind&&i.pos===s.end)break}n.push(Rs(i))}}return n}function Ps(e){if(e.thisParameter)return li(e.thisParameter)}function Ms(t){if(!t.resolvedReturnType){if(!Fr(t,3))return J;var n=void 0;if(n=t.target?Ea(Ms(t.target),t.mapper):t.unionSignatures?Uo(e.map(t.unionSignatures,Ms),!0):Wd(t.declaration),!Ur()&&(n=z,N)){var r=t.declaration,i=e.getNameOfDeclaration(r);i?ln(i,e.Diagnostics._0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions,e.declarationNameToString(i)):ln(r,e.Diagnostics.Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions)}t.resolvedReturnType=n}return t.resolvedReturnType}function Fs(t){if(t.hasRestParameter){var n=li(e.lastOrUndefined(t.parameters));if(4&yn(n)&&n.target===xe)return n.typeArguments[0]}return z}function $s(t,n,r){n=Os(n,t.typeParameters,Ds(t.typeParameters),r);var i=t.instantiations||(t.instantiations=e.createMap()),s=Js(n),o=i.get(s);return o||i.set(s,o=Bs(t,n)),o}function Bs(e,t){return ba(e,_a(e.typeParameters,t),!0)}function Us(e){return e.typeParameters?e.erasedSignatureCache||(e.erasedSignatureCache=function(e){return ba(e,(t=e.typeParameters,_a(t,void 0)),!0);var t}(e)):e}function Vs(t){return t.typeParameters?t.canonicalSignatureCache||(t.canonicalSignatureCache=function(t){return $s(t,e.map(t.typeParameters,(function(e){return e.target&&!ls(e.target)?e.target:e})),e.isInJavaScriptFile(t.declaration))}(t)):t}function Hs(t){if(!t.isolatedSignatureType){var n=152===t.declaration.kind||156===t.declaration.kind,r=ar(16);r.members=T,r.properties=e.emptyArray,r.callSignatures=n?e.emptyArray:[t],r.constructSignatures=n?[t]:e.emptyArray,t.isolatedSignatureType=r}return t.isolatedSignatureType}function Gs(e){return e.members.get("__index")}function js(e,t){var n=1===t?133:136,r=Gs(e);if(r)for(var i=0,s=r.declarations;i<s.length;i++){var o=s[i];if(1===o.parameters.length){var a=o.parameters[0];if(a&&a.type&&a.type.kind===n)return o}}}function Ks(e,t,n){return{type:e,isReadonly:t,declaration:n}}function Ws(t,n){var r=js(t,n);if(r)return Ks(r.type?pa(r.type):z,e.hasModifier(r,64),r)}function zs(t){if(!t.constraint)if(t.target){var n=ls(t.target);t.constraint=n?Ea(n,t.mapper):me}else{var r=function(t){return t.symbol&&e.getDeclarationOfKind(t.symbol,145).constraint}(t);t.constraint=r?pa(r):me}return t.constraint===me?void 0:t.constraint}function qs(t){return er(e.getDeclarationOfKind(t.symbol,145).parent)}function Js(e){var t="";if(e)for(var n=e.length,r=0;r<n;){for(var i=e[r].id,s=1;r+s<n&&e[r+s].id===i+s;)s++;t.length&&(t+=","),t+=i,s>1&&(t+=":"+s),r+=s}return t}function Ys(e,t){for(var n=0,r=0,i=e;r<i.length;r++){var s=i[r];s.flags&t||(n|=s.flags)}return 14680064&n}function Xs(e,t){var n=Js(t),r=e.instantiations.get(n);return r||(r=ar(4,e.symbol),e.instantiations.set(n,r),r.flags|=t?Ys(t,0):0,r.target=e,r.typeArguments=t),r}function Qs(e){var t=sr(e.flags);return t.symbol=e.symbol,t.objectFlags=e.objectFlags,t.target=e.target,t.typeArguments=e.typeArguments,t}function Zs(t){return e.length(t.target.typeParameters)}function eo(t,n,r){var i=Oi(Zn(n)),s=i.localTypeParameters;if(s){var o=e.length(t.typeArguments),a=Ds(s),l=e.isInJavaScriptFile(t);return!l&&(o<a||o>s.length)?(ln(t,a===s.length?e.Diagnostics.Generic_type_0_requires_1_type_argument_s:e.Diagnostics.Generic_type_0_requires_between_1_and_2_type_arguments,Cr(i,void 0,1),a,s.length),J):Xs(i,e.concatenate(i.outerTypeParameters,Os(r,s,a,l)))}return t.typeArguments?(ln(t,e.Diagnostics.Type_0_is_not_generic,Cr(i)),J):i}function to(t,n,r){var i=Oi(n),s=_n(n).typeParameters;if(s){var o=e.length(t.typeArguments),a=Ds(s);return o<a||o>s.length?(ln(t,a===s.length?e.Diagnostics.Generic_type_0_requires_1_type_argument_s:e.Diagnostics.Generic_type_0_requires_between_1_and_2_type_arguments,xr(n),a,s.length),J):function(t,n){var r=Oi(t),i=_n(t),s=i.typeParameters,o=Js(n),a=i.instantiations.get(o);return a||i.instantiations.set(o,a=Ea(r,_a(s,Os(n,s,Ds(s),e.isInJavaScriptFile(t.valueDeclaration))))),a}(n,r)}return t.typeArguments?(ln(t,e.Diagnostics.Type_0_is_not_generic,xr(n)),J):i}function no(t){switch(t.kind){case 159:return t.typeName;case 201:var n=t.expression;if(e.isEntityNameExpression(n))return n}}function ro(e,t){return e&&Vn(e,t)||K}function io(t,n,r){return 96&n.flags?eo(t,n,r):524288&n.flags?to(t,n,r):16&n.flags&&so(t)&&(n.members||e.getJSDocClassTag(n.valueDeclaration))?Rd(n):void 0}function so(e){return 1048576&e.flags&&159===e.kind}function oo(t){var n=gn(t);if(!n.resolvedType){var r=void 0,i=void 0,s=793064;so(t)&&(i=function(t){if(e.isIdentifier(t.typeName)){if("Object"===t.typeName.escapedText){if(e.isJSDocIndexSignature(t)){var n=pa(t.typeArguments[0]),r=Ks(pa(t.typeArguments[1]),!1);return dr(void 0,T,e.emptyArray,e.emptyArray,n===ee&&r,n===te&&r)}return z}switch(t.typeName.escapedText){case"String":return ee;case"Number":return te;case"Boolean":return ie;case"Void":return oe;case"Undefined":return Y;case"Null":return Q;case"Function":case"function":return Ee;case"Array":case"array":return t.typeArguments&&t.typeArguments.length?void 0:De;case"Promise":case"promise":return t.typeArguments&&t.typeArguments.length?void 0:jd(z)}}}(t),s|=107455),i||(i=function(t,n){var r=ao(t);if(n===K)return J;var i=io(t,n,r);if(i)return i;var s=Ri(n);if(void 0!==s)return r?(ln(t,e.Diagnostics.Type_0_is_not_generic,xr(n)),J):s;if(!(107455&n.flags&&so(t)))return J;var o=li(n);if(o.symbol&&!Ld(o)){var a=io(t,o.symbol,r);if(a)return a}return ro(no(t),793064),o}(t,r=ro(no(t),s))),n.resolvedSymbol=r,n.resolvedType=i}return n.resolvedType}function ao(t){return e.map(t.typeArguments,pa)}function lo(e){var t=gn(e);return t.resolvedType||(t.resolvedType=Il(Ip(e.exprName))),t.resolvedType}function co(t,n){function r(e){for(var t=0,n=e.declarations;t<n.length;t++){var r=n[t];switch(r.kind){case 229:case 230:case 232:return r}}}if(!t)return n?he:ue;var i=Oi(t);return 32768&i.flags?e.length(i.typeParameters)!==n?(ln(r(t),e.Diagnostics.Global_type_0_must_have_1_type_parameter_s,e.symbolName(t),n),n?he:ue):i:(ln(r(t),e.Diagnostics.Global_type_0_must_be_a_class_or_interface_type,e.symbolName(t)),n?he:ue)}function uo(t,n){return po(t,107455,n?e.Diagnostics.Cannot_find_global_value_0:void 0)}function po(e,t,n){return kn(void 0,e,t,n,e,!1)}function ho(t,n,r){var i=function(t,n){return po(t,793064,n?e.Diagnostics.Cannot_find_global_type_0:void 0)}(t,r);return i||r?co(i,n):void 0}function fo(e){return Pe||(Pe=ho("Symbol",0,e))||ue}function mo(e){return Fe||(Fe=ho("Promise",1,e))||he}function _o(e){return $e||($e=uo("Promise",e))}function go(e){return Ge||(Ge=ho("AsyncIterable",1,e))||he}function yo(e){return je||(je=ho("AsyncIterator",1,e))||he}function bo(e){return Ke||(Ke=ho("AsyncIterableIterator",1,e))||he}function vo(e){return Ue||(Ue=ho("Iterable",1,e))||he}function To(e){return Ve||(Ve=ho("Iterator",1,e))||he}function ko(e){return He||(He=ho("IterableIterator",1,e))||he}function Eo(e,t){void 0===t&&(t=0);var n=po(e,793064,void 0);return n&&co(n,t)}function xo(e,t){var n=po(e,1920,void 0),r=n&&vn(n.exports,t,793064);return r&&Oi(r)}function So(e,t){return e!==he?Xs(e,t):ue}function Co(e){return So(Me||(Me=ho("TypedPropertyDescriptor",1,!0))||he,[e])}function Io(e){return So(bo(!0),[e])}function Ao(e){return So(vo(!0),[e])}function wo(e){return So(ko(!0),[e])}function No(e){return So(xe,[e])}function Do(t){return B[t]||(B[t]=function(t){for(var n=[],r=[],i=0;i<t;i++){var s=sr(16384);n.push(s);var o=cn(4,""+i);o.type=s,r.push(o)}var a=ar(12);return a.typeParameters=n,a.outerTypeParameters=void 0,a.localTypeParameters=n,a.instantiations=e.createMap(),a.instantiations.set(Js(a.typeParameters),a),a.target=a,a.typeArguments=a.typeParameters,a.thisType=sr(16384),a.thisType.isThisType=!0,a.thisType.constraint=a,a.declaredProperties=r,a.declaredCallSignatures=e.emptyArray,a.declaredConstructSignatures=e.emptyArray,a.declaredStringIndexInfo=void 0,a.declaredNumberIndexInfo=void 0,a}(t))}function Oo(e){return Xs(Do(e.length),e)}function Ro(e,t){for(var n=0,r=e.length-1,i=t.id;n<=r;){var s=n+(r-n>>1),o=e[s].id;if(o===i)return s;o>i?r=s-1:n=s+1}return~n}function Lo(e,t){return Ro(e,t)>=0}function Po(e,t){var n=t.flags;if(65536&n)Mo(e,t.types);else if(1&n)e.containsAny=!0;else if(!A&&6144&n)2048&n&&(e.containsUndefined=!0),4096&n&&(e.containsNull=!0),2097152&n||(e.containsNonWideningType=!0);else if(!(8192&n||131072&n&&function(e){for(var t=0,n=0,r=e.types;n<r.length;n++){var i=r[n];if(6368&i.flags&&6368&t)return!0;if(6144&(t|=i.flags)&&16809984&t)return!0}return!1}(t))){2&n&&(e.containsString=!0),4&n&&(e.containsNumber=!0),96&n&&(e.containsStringOrNumberLiteral=!0);var r=e.length,i=r&&t.id>e[r-1].id?~r:Ro(e,t);i<0&&(32768&n&&16&t.objectFlags&&t.symbol&&8208&t.symbol.flags&&Fo(e,t)||e.splice(~i,0,t))}}function Mo(e,t){for(var n=0,r=t;n<r.length;n++){Po(e,r[n])}}function Fo(e,t){for(var n=0,r=e;n<r.length;n++){if(wa(r[n],t))return!0}return!1}function $o(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e!==i&&Oa(e,i))return!0}return!1}function Bo(t){if(0!==t.length&&!function(e){var t=e[0];if(256&t.flags){for(var n=tr(t.symbol),r=1;r<e.length;r++){var i=e[r];if(!(256&i.flags)||n!==tr(i.symbol))return!1}return!0}return!1}(t))for(var n=t.length;n>0;)$o(t[--n],t)&&e.orderedRemoveItemAt(t,n)}function Uo(t,n,r,i){if(0===t.length)return ae;if(1===t.length)return t[0];var s=[];return Mo(s,t),s.containsAny?z:(n?Bo(s):s.containsStringOrNumberLiteral&&function(t){for(var n=t.length;n>0;){var r=t[--n];(32&r.flags&&t.containsString||64&r.flags&&t.containsNumber||96&r.flags&&1048576&r.flags&&Lo(t,r.regularType))&&e.orderedRemoveItemAt(t,n)}}(s),0===s.length?s.containsNull?s.containsNonWideningType?Q:Z:s.containsUndefined?s.containsNonWideningType?Y:X:ae:Vo(s,r,i))}function Vo(e,t,n){if(0===e.length)return ae;if(1===e.length)return e[0];var r=Js(e),i=U.get(r);i||(i=sr(65536|Ys(e,6144)),U.set(r,i),i.types=e,i.aliasSymbol=t,i.aliasTypeArguments=n);return i}function Ho(t,n){131072&n.flags?Go(t,n.types):1&n.flags?t.containsAny=!0:8192&n.flags?t.containsNever=!0:16&yn(n)&&Va(n)?t.containsEmptyObject=!0:!A&&6144&n.flags||e.contains(t,n)||(32768&n.flags&&(t.containsObjectType=!0),65536&n.flags&&void 0===t.unionIndex&&(t.unionIndex=t.length),32768&n.flags&&16&n.objectFlags&&n.symbol&&8208&n.symbol.flags&&Fo(t,n)||t.push(n))}function Go(e,t){for(var n=0,r=t;n<r.length;n++){Ho(e,r[n])}}function jo(t,n,r){if(0===t.length)return ue;var i=[];if(Go(i,t),i.containsNever)return ae;if(i.containsAny)return z;if(i.containsEmptyObject&&!i.containsObjectType&&i.push(ue),1===i.length)return i[0];var s=i.unionIndex;if(void 0!==s){var o=i[s];return Uo(e.map(o.types,(function(t){return jo(e.replaceElement(i,s,t))})),!1,n,r)}var a=Js(i),l=V.get(a);l||(l=sr(131072|Ys(i,6144)),V.set(a,l),l.types=i,l.aliasSymbol=n,l.aliasTypeArguments=r);return l}function Ko(t){return 24&e.getDeclarationModifierFlagsFromSymbol(t)||e.startsWith(t.escapedName,"__@")?ae:ua(e.symbolName(t))}function Wo(t){return ip(t,540672)?function(e){return e.resolvedIndexType||(e.resolvedIndexType=sr(262144),e.resolvedIndexType.type=e),e.resolvedIndexType}(t):32&yn(t)?ts(t):1&t.flags||xs(t,0)?ee:function(t){return Uo(e.map(as(t),Ko))}(t)}function zo(t,n,r,i){var s=r&&180===r.kind?r:void 0,o=96&n.flags?e.escapeLeadingUnderscores(""+n.value):s&&id(s.argumentExpression,n,!1)?e.getPropertyNameForKnownSymbolName(e.idText(s.argumentExpression.name)):void 0;if(void 0!==o){var a=bs(t,o);if(a){if(s){if(e.isAssignmentTarget(s)&&(tp(s,a)||np(s)))return ln(s.argumentExpression,e.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,xr(a)),J;i&&(gn(r).resolvedSymbol=a)}return li(a)}}if(!(6144&n.flags)&&sp(n,262774)){if(Gr(t))return z;var l=sp(n,84)&&xs(t,1)||xs(t,0)||void 0;if(l)return s&&l.isReadonly&&(e.isAssignmentTarget(s)||e.isDeleteTarget(s))&&ln(s,e.Diagnostics.Index_signature_in_type_0_only_permits_reading,Cr(t)),l.type;if(s&&!op(t))return N&&!E.suppressImplicitAnyIndexErrors&&(Ss(t,1)?ln(s.argumentExpression,e.Diagnostics.Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number):ln(s,e.Diagnostics.Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature,Cr(t))),z}if(r){var c=180===r.kind?r.argumentExpression:r.indexType;return 96&n.flags?ln(c,e.Diagnostics.Property_0_does_not_exist_on_type_1,""+n.value,Cr(t)):6&n.flags?ln(c,e.Diagnostics.Type_0_has_no_matching_index_signature_for_type_1,Cr(t),Cr(n)):ln(c,e.Diagnostics.Type_0_cannot_be_used_as_an_index_type,Cr(n)),J}return z}function qo(t){return!!(540672&t.flags)||(32&yn(t)?Jo(ts(t)):!!(196608&t.flags)&&e.forEach(t.types,qo))}function Jo(t){return!!(802816&t.flags)||!!(196608&t.flags)&&e.forEach(t.types,Jo)}function Yo(e){if(32768&e.flags&&!rs(e)){var t=is(e);return 0===t.properties.length&&0===t.callSignatures.length&&0===t.constructSignatures.length&&t.stringIndexInfo&&!t.numberIndexInfo}return!1}function Xo(t){var n=t.objectType;if(131072&n.flags&&qo(n)&&e.some(n.types,Yo)){for(var r=[],i=[],s=0,o=n.types;s<o.length;s++){var a=o[s];Yo(a)?i.push(Ss(a,0)):r.push(a)}return Uo([Qo(jo(r),t.indexType),jo(i)])}if(rs(n)){var l=_a([es(n)],[t.indexType]),c=n.mapper,u=c?ga(c,l):l;return Ea(ns(n),u)}}function Qo(e,t,n){if(Jo(t)||(!n||180!==n.kind)&&qo(e)){if(1&e.flags)return e;var r=e.id+","+t.id,i=G.get(r);return i||G.set(r,i=function(e,t){var n=sr(524288);return n.objectType=e,n.indexType=t,n}(e,t)),i}var s=ms(e);if(65536&t.flags&&!(8&t.flags)){for(var o=[],a=0,l=t.types;a<l.length;a++){var c=zo(s,l[a],n,!1);if(c===J)return J;o.push(c)}return Uo(o)}return zo(s,t,n,!0)}function Zo(e){var t=gn(e);return t.resolvedType||(t.resolvedType=Qo(pa(e.objectType),pa(e.indexType),e)),t.resolvedType}function ea(e){var t=gn(e);if(!t.resolvedType){var n=ar(32,e.symbol);n.declaration=e,n.aliasSymbol=na(e),n.aliasTypeArguments=ra(e),t.resolvedType=n,ts(n)}return t.resolvedType}function ta(t){var n=gn(t);if(!n.resolvedType){var r=na(t);if(0!==t.symbol.members.size||r){var i=ar(16,t.symbol);i.aliasSymbol=r,i.aliasTypeArguments=ra(t),e.isJSDocTypeLiteral(t)&&t.isArrayType&&(i=No(i)),n.resolvedType=i}else n.resolvedType=pe}return n.resolvedType}function na(e){return 231===e.parent.kind?er(e.parent):void 0}function ra(e){var t=na(e);return t?mi(t):void 0}function ia(t,n,r,i){if(1&t.flags||1&n.flags)return z;if(8192&t.flags)return n;if(8192&n.flags)return t;if(65536&t.flags)return vc(t,(function(e){return ia(e,n,r,i)}));if(65536&n.flags)return vc(n,(function(e){return ia(t,e,r,i)}));if(16777216&n.flags)return ce;if(262654&n.flags)return t;var s,o,a=e.createSymbolTable(),l=e.createUnderscoreEscapedMap();t===ue?(s=xs(n,0),o=xs(n,1)):(s=Yi(xs(t,0),xs(n,0)),o=Yi(xs(t,1),xs(n,1)));for(var c=0,u=as(n);c<u.length;c++){var d=65536&(m=u[c]).flags&&!(32768&m.flags);24&e.getDeclarationModifierFlagsFromSymbol(m)?l.set(m.escapedName,!0):oa(m)||d||a.set(m.escapedName,sa(m))}for(var p=0,h=as(t);p<h.length;p++){var f=h[p];if(!(65536&f.flags&&!(32768&f.flags)||l.has(f.escapedName)||oa(f)))if(a.has(f.escapedName)){var m,_=li(m=a.get(f.escapedName));if(16777216&m.flags){var g=e.concatenate(f.declarations,m.declarations),y=cn(4|16777216&f.flags,f.escapedName);y.type=Uo([li(f),nc(_,131072)]),y.leftSpread=f,y.rightSpread=m,y.declarations=g,a.set(f.escapedName,y)}}else a.set(f.escapedName,sa(f))}var b=dr(void 0,a,e.emptyArray,e.emptyArray,s,o);return b.flags|=i,b.flags|=5242880,b.objectFlags|=128,b.symbol=r,b}function sa(e){if(!ep(e))return e;var t=cn(4|16777216&e.flags,e.escapedName);return t.type=li(e),t.declarations=e.declarations,t.syntheticOrigin=e,t}function oa(t){return 8192&t.flags&&e.find(t.declarations,(function(t){return e.isClassLike(t.parent)}))}function aa(e,t,n){var r=sr(e);return r.symbol=n,r.value=t,r}function la(e){if(96&e.flags&&!(1048576&e.flags)){if(!e.freshType){var t=aa(1048576|e.flags,e.value,e.symbol);t.regularType=e,e.freshType=t}return e.freshType}return e}function ca(e){return 96&e.flags&&1048576&e.flags?e.regularType:e}function ua(e,t,n){var r="number"==typeof e?"#":"@",i=t?t+r+e:r+e,s=H.get(i);if(!s){var o=("number"==typeof e?64:32)|(t?256:0);H.set(i,s=aa(o,e,n))}return s}function da(t){var n=gn(t);return n.resolvedType||(n.resolvedType=function(t){var n=e.getThisContainer(t,!1),r=n&&n.parent;return!r||!e.isClassLike(r)&&230!==r.kind||e.hasModifier(n,32)||152===n.kind&&!e.isNodeDescendantOf(t,n.body)?(ln(t,e.Diagnostics.A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface),J):Si(er(r)).thisType}(t)),n.resolvedType}function pa(t){switch(t.kind){case 119:case 268:case 269:return z;case 136:return ee;case 133:return te;case 122:return ie;case 137:return se;case 105:return oe;case 139:return Y;case 95:return Q;case 130:return ae;case 134:return 65536&t.flags?z:ce;case 169:case 99:return da(t);case 173:return function(e){var t=gn(e);return t.resolvedType||(t.resolvedType=ca(Ip(e.literal))),t.resolvedType}(t);case 159:return oo(t);case 158:return ie;case 201:return oo(t);case 162:return lo(t);case 164:return function(e){var t=gn(e);return t.resolvedType||(t.resolvedType=No(pa(e.elementType))),t.resolvedType}(t);case 165:return function(t){var n=gn(t);return n.resolvedType||(n.resolvedType=Oo(e.map(t.elementTypes,pa))),n.resolvedType}(t);case 166:return function(t){var n=gn(t);return n.resolvedType||(n.resolvedType=Uo(e.map(t.types,pa),!1,na(t),ra(t))),n.resolvedType}(t);case 167:return function(t){var n=gn(t);return n.resolvedType||(n.resolvedType=jo(e.map(t.types,pa),na(t),ra(t))),n.resolvedType}(t);case 270:return function(e){var t=pa(e.type);return A?Uo([t,Q]):t}(t);case 168:case 271:case 272:case 267:return pa(t.type);case 160:case 161:case 163:case 285:case 273:return ta(t);case 170:return function(e){var t=gn(e);return t.resolvedType||(t.resolvedType=Wo(pa(e.type))),t.resolvedType}(t);case 171:return Zo(t);case 172:return ea(t);case 71:case 143:var n=vf(t);return n&&Oi(n);case 274:return function(e){var t=gn(e);if(!t.resolvedType){var n=pa(e.type);t.resolvedType=n?No(n):J}return t.resolvedType}(t);default:return J}}function ha(e,t,n){if(e&&e.length){for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];r.push(n(o,t))}return r}return e}function fa(e,t){return ha(e,t,Ea)}function ma(e,t){return ha(e,t,ba)}function _a(t,n){return e.Debug.assert(void 0===n||t.length===n.length),1===t.length?(a=t[0],l=n?n[0]:z,function(e){return e===a?l:e}):2===t.length?(r=t[0],i=n?n[0]:z,s=t[1],o=n?n[1]:z,function(e){return e===r?i:e===s?o:e}):function(e,t){return function(n){for(var r=0;r<e.length;r++)if(n===e[r])return t?t[r]:z;return n}}(t,n);var r,i,s,o,a,l}function ga(e,t){return function(n){return Ea(e(n),t)}}function ya(e){var t=sr(16384);return t.symbol=e.symbol,t.target=e,t}function ba(t,n,r){var i,s;if(t.typeParameters&&!r){i=e.map(t.typeParameters,ya),n=ga(_a(t.typeParameters,i),n);for(var o=0,a=i;o<a.length;o++){a[o].mapper=n}}t.typePredicate&&(s=function(t,n){return e.isIdentifierTypePredicate(t)?{kind:1,parameterName:t.parameterName,parameterIndex:t.parameterIndex,type:Ea(t.type,n)}:{kind:0,type:Ea(t.type,n)}}(t.typePredicate,n));var l=Hi(t.declaration,i,t.thisParameter&&va(t.thisParameter,n),ha(t.parameters,n,va),void 0,s,t.minArgumentCount,t.hasRestParameter,t.hasLiteralTypes);return l.target=t,l.mapper=n,l}function va(t,n){if(1&e.getCheckFlags(t)){var r=_n(t);t=r.target,n=ga(r.mapper,n)}var i=cn(t.flags,t.escapedName);return i.checkFlags=1,i.declarations=t.declarations,i.parent=t.parent,i.target=t,i.mapper=n,t.valueDeclaration&&(i.valueDeclaration=t.valueDeclaration),t.isRestParameter&&(i.isRestParameter=t.isRestParameter),i}function Ta(t,n){var r=64&t.objectFlags?t.target:t,i=r.symbol,s=_n(i),o=s.typeParameters;if(!o){var a=i.declarations[0],l=hi(a,!0)||e.emptyArray;o=2048&i.flags&&!r.aliasTypeArguments?e.filter(l,(function(t){return function(t,n){if(t.symbol&&t.symbol.declarations&&1===t.symbol.declarations.length){var r=t.symbol.declarations[0].parent;if(e.findAncestor(n,(function(e){return 207===e.kind?"quit":e===r})))return e.forEachChild(n,i)}return!0;function i(n){switch(n.kind){case 169:return t.isThisType;case 71:return!t.isThisType&&e.isPartOfTypeNode(n)&&pa(n)===t;case 162:return!0}return e.forEachChild(n,i)}}(t,a)})):l,s.typeParameters=o,o.length&&(s.instantiations=e.createMap(),s.instantiations.set(Js(o),r))}if(o.length){var c=64&t.objectFlags?ga(t.mapper,n):n,u=e.map(o,c),d=Js(u),p=s.instantiations.get(d);if(!p){var h=_a(o,u);p=32&r.objectFlags?function(e,t){var n=ts(e);if(262144&n.flags){var r=n.type;if(16384&r.flags){var i=Ea(r,t);if(r!==i)return vc(i,(function(n){return function(e){return 704513&e.flags}(n)?ka(e,function(e,t,n){return function(r){return r===e?t:n(r)}}(r,n,t)):n}))}}return ka(e,t)}(r,h):ka(r,h),s.instantiations.set(d,p)}return p}return t}function ka(e,t){var n=ar(64|e.objectFlags,e.symbol);return 32&e.objectFlags&&(n.declaration=e.declaration),n.target=e,n.mapper=t,n.aliasSymbol=e.aliasSymbol,n.aliasTypeArguments=fa(e.aliasTypeArguments,t),n}function Ea(e,t){if(e&&t!==k){if(16384&e.flags)return t(e);if(32768&e.flags){if(16&e.objectFlags)return e.symbol&&14384&e.symbol.flags&&e.symbol.declarations?Ta(e,t):e;if(32&e.objectFlags)return Ta(e,t);if(4&e.objectFlags)return Xs(e.target,fa(e.typeArguments,t))}if(65536&e.flags&&!(8190&e.flags))return Uo(fa(e.types,t),!1,e.aliasSymbol,fa(e.aliasTypeArguments,t));if(131072&e.flags)return jo(fa(e.types,t),e.aliasSymbol,fa(e.aliasTypeArguments,t));if(262144&e.flags)return Wo(Ea(e.type,t));if(524288&e.flags)return Qo(Ea(e.objectType,t),Ea(e.indexType,t))}return e}function xa(e,t){return e&&Ks(Ea(e.type,t),e.isReadonly,e.declaration)}function Sa(t){switch(e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t)),t.kind){case 186:case 187:case 151:return Ca(t);case 178:return e.forEach(t.properties,Sa);case 177:return e.forEach(t.elements,Sa);case 195:return Sa(t.whenTrue)||Sa(t.whenFalse);case 194:return 54===t.operatorToken.kind&&(Sa(t.left)||Sa(t.right));case 261:return Sa(t.initializer);case 185:return Sa(t.expression);case 254:return e.forEach(t.properties,Sa);case 253:return t.initializer&&Sa(t.initializer);case 256:return t.expression&&Sa(t.expression)}return!1}function Ca(t){if(t.typeParameters)return!1;if(e.forEach(t.parameters,(function(t){return!e.getEffectiveTypeAnnotationNode(t)})))return!0;if(187!==t.kind){var n=e.firstOrUndefined(t.parameters);if(!n||!e.parameterIsThisKeyword(n))return!0}return 207!==t.body.kind&&Sa(t.body)}function Ia(t){return(pu(t)||e.isObjectLiteralMethod(t))&&Ca(t)}function Aa(t){if(32768&t.flags){var n=is(t);if(n.constructSignatures.length){var r=ar(16,t.symbol);return r.members=n.members,r.properties=n.properties,r.callSignatures=e.emptyArray,r.constructSignatures=e.emptyArray,r}}else if(131072&t.flags)return jo(e.map(t.types,Aa));return t}function wa(e,t){return ja(e,t,nn)}function Na(e,t){return ja(e,t,nn)?-1:0}function Da(e,t){return ja(e,t,en)?-1:0}function Oa(e,t){return ja(e,t,Zt)}function Ra(e,t){return ja(e,t,en)}function La(e,t){return ui(e)===ui(t)||Oa(e,t)&&!wa(e,t)}function Pa(e,t){return ja(e,t,tn)}function Ma(e,t,n,r,i){return Ka(e,t,en,n,r,i)}function Fa(e,t,n,r,i){return Ka(e,t,tn,n,r,i)}function $a(t,n,r,i,s,o,a){if(t===n)return-1;if(!n.hasRestParameter&&t.minArgumentCount>n.parameters.length)return 0;t.typeParameters&&t.typeParameters!==n.typeParameters&&(t=dd(t,n=Vs(n),void 0,a));var l=n.declaration?n.declaration.kind:0,c=!r&&w&&151!==l&&150!==l&&152!==l,u=-1,d=Ps(t);if(d&&d!==oe){var p=Ps(n);if(p){if(!(b=!c&&a(d,p,!1)||a(p,d,s)))return s&&o(e.Diagnostics.The_this_types_of_each_signature_are_incompatible),0;u&=b}}for(var h=Ua(t),f=Ua(n),m=function(e,t,n,r){return e.hasRestParameter===n.hasRestParameter?e.hasRestParameter?Math.max(t,r)+1:Math.min(t,r):e.hasRestParameter?r:t}(t,h,n,f),_=t.parameters,g=n.parameters,y=0;y<m;y++){var b,v=y<h?Bd(_[y]):Fs(t),T=y<f?Bd(g[y]):Fs(n),k=r?void 0:ud(Tl(v)),E=r?void 0:ud(Tl(T));if(!(b=k&&E&&!k.typePredicate&&!E.typePredicate&&(6144&_l(v))==(6144&_l(T))?$a(E,k,c?2:1,!1,s,o,a):!r&&!c&&a(v,T,!1)||a(T,v,s)))return s&&o(e.Diagnostics.Types_of_parameters_0_and_1_are_incompatible,e.symbolName(_[y<h?y:h]),e.symbolName(g[y<f?y:f])),0;u&=b}if(!i){var x=Ms(n);if(x===oe)return u;var S=Ms(t);if(n.typePredicate){if(t.typePredicate)u&=function(t,n,r,i,s,o,a){if(t.kind!==n.kind)return s&&(o(e.Diagnostics.A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard),o(e.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Ir(t),Ir(n))),0;if(1===t.kind){var l=t,c=n;if(l.parameterIndex-(e.getThisParameter(r)?1:0)!==c.parameterIndex-(e.getThisParameter(i)?1:0))return s&&(o(e.Diagnostics.Parameter_0_is_not_in_the_same_position_as_parameter_1,l.parameterName,c.parameterName),o(e.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Ir(t),Ir(n))),0}var u=a(t.type,n.type,s);0===u&&s&&o(e.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Ir(t),Ir(n));return u}(t.typePredicate,n.typePredicate,t.declaration,n.declaration,s,o,a);else if(e.isIdentifierTypePredicate(n.typePredicate))return s&&o(e.Diagnostics.Signature_0_must_be_a_type_predicate,Sr(t)),0}else u&=1===r&&a(x,S,!1)||a(S,x,s)}return u}function Ba(e,t){var n=Us(e),r=Us(t),i=Ms(n),s=Ms(r);return!(s!==oe&&!ja(s,i,en)&&!ja(i,s,en))&&0!==$a(n,r,0,!0,!1,void 0,Da)}function Ua(e){var t=e.parameters.length;return e.hasRestParameter?t-1:t}function Va(t){return 32768&t.flags?0===(n=is(t)).properties.length&&0===n.callSignatures.length&&0===n.constructSignatures.length&&!n.stringIndexInfo&&!n.numberIndexInfo:!!(16777216&t.flags)||(65536&t.flags?e.forEach(t.types,Va):!!(131072&t.flags)&&!e.forEach(t.types,(function(e){return!Va(e)})));var n}function Ha(t,n,r){if(t===n)return!0;var i=a(t)+","+a(n),s=rn.get(i);if(void 0!==s)return s;if(!(t.escapedName===n.escapedName&&256&t.flags&&256&n.flags))return rn.set(i,!1),!1;for(var o=li(n),l=0,c=as(li(t));l<c.length;l++){var u=c[l];if(8&u.flags){var d=bs(o,u.escapedName);if(!(d&&8&d.flags))return r&&r(e.Diagnostics.Property_0_is_missing_in_type_1,e.symbolName(u),Cr(Oi(n),void 0,256)),rn.set(i,!1),!1}}return rn.set(i,!0),!0}function Ga(e,t,n,r){var i=e.flags,s=t.flags;if(8192&s)return!1;if(1&s||8192&i)return!0;if(262178&i&&2&s)return!0;if(32&i&&256&i&&32&s&&!(256&s)&&e.value===t.value)return!0;if(84&i&&4&s)return!0;if(64&i&&256&i&&64&s&&!(256&s)&&e.value===t.value)return!0;if(136&i&&8&s)return!0;if(16&i&&16&s&&Ha(e.symbol,t.symbol,r))return!0;if(256&i&&256&s){if(65536&i&&65536&s&&Ha(e.symbol,t.symbol,r))return!0;if(224&i&&224&s&&e.value===t.value&&Ha(tr(e.symbol),tr(t.symbol),r))return!0}if(2048&i&&(!A||3072&s))return!0;if(4096&i&&(!A||4096&s))return!0;if(32768&i&&16777216&s)return!0;if(n===en||n===tn){if(1&i)return!0;if(68&i&&!(256&i)&&(16&s||64&s&&256&s))return!0}return!1}function ja(e,t,n){if(96&e.flags&&1048576&e.flags&&(e=e.regularType),96&t.flags&&1048576&t.flags&&(t=t.regularType),e===t||n!==nn&&Ga(e,t,n))return!0;if(32768&e.flags&&32768&t.flags){var r=n.get(Xa(e,t,n));if(void 0!==r)return 1===r}return!!(1032192&e.flags||1032192&t.flags)&&Ka(e,t,n,void 0)}function Ka(t,n,r,i,s,o){var a,l,c,u,d,p=0,h=0;!function(e){e[e.None=0]="None",e[e.Source=1]="Source",e[e.Target=2]="Target",e[e.Both=3]="Both"}(d||(d={}));var f=0,m=!1,_=!1;e.Debug.assert(r!==nn||!i,"no error reporting in identity checking");var g=v(t,n,!!i,s);return m?ln(i,e.Diagnostics.Excessive_stack_depth_comparing_types_0_and_1,Cr(t),Cr(n)):a&&(o&&(a=e.concatenateDiagnosticMessageChains(o,a)),wt.add(e.createDiagnosticForNodeFromMessageChain(i,a))),0!==g;function y(t,n,r,s){e.Debug.assert(!!i),a=e.chainDiagnosticMessages(a,t,n,r,s)}function b(t,n,i){var s=Cr(n),o=Cr(i);s===o&&(s=Cr(n,void 0,256),o=Cr(i,void 0,256)),t||(t=r===tn?e.Diagnostics.Type_0_is_not_comparable_to_type_1:s===o?e.Diagnostics.Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated:e.Diagnostics.Type_0_is_not_assignable_to_type_1),y(t,s,o)}function v(t,n,i,s){if(96&t.flags&&1048576&t.flags&&(t=t.regularType),96&n.flags&&1048576&n.flags&&(n=n.regularType),t===n)return-1;if(r===nn)return function(e,t){var n;if(32768&e.flags&&32768&t.flags)return I(e,t,!1);if((65536&e.flags&&65536&t.flags||131072&e.flags&&131072&t.flags)&&(n=k(e,t))&&(n&=k(t,e)))return n;return 0}(t,n);if(Ga(t,n,r,i?y:void 0))return-1;if(128&yn(t)&&1048576&t.flags){if(T(t,n,i))return i&&b(s,t,n),0;(function(e){if(!(196608&e.flags))return!1;for(var t=!1,n=0,r=e.types;n<r.length;n++)if(!(6144&r[n].flags)){if(t)return!0;t=!0}return!1})(n)&&(t=xl(t))}if(r!==tn&&!(196608&t.flags)&&!(65536&n.flags)&&!_&&t!==ke&&(as(t).length>0||Ts(t,0).length>0||Ts(t,1).length>0)&&A(n)&&!function(e,t){for(var n=!!(33554432&e.flags),r=0,i=as(e);r<i.length;r++){if(Uu(t,i[r].escapedName,n))return!0}return!1}(t,n)){if(i){var o=Ts(t,0),l=Ts(t,1);o.length>0&&v(Ms(o[0]),n,!1)||l.length>0&&v(Ms(l[0]),n,!1)?y(e.Diagnostics.Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it,Cr(t),Cr(n)):y(e.Diagnostics.Type_0_has_no_properties_in_common_with_type_1,Cr(t),Cr(n))}return 0}var c=0,u=a,d=_;return _=!1,65536&t.flags?c=r===tn?C(t,n,i&&!(8190&t.flags)):function(e,t,n){for(var r=-1,i=e.types,s=0,o=i;s<o.length;s++){var a=v(o[s],t,n);if(!a)return 0;r&=a}return r}(t,n,i&&!(8190&t.flags)):(65536&n.flags?c=x(t,n,i&&!(8190&t.flags)&&!(8190&n.flags)):131072&n.flags?(_=!0,c=function(e,t,n){for(var r=-1,i=t.types,s=0,o=i;s<o.length;s++){var a=v(e,o[s],n);if(!a)return 0;r&=a}return r}(t,n,i)):131072&t.flags&&(c=C(t,n,!1)),!c&&(1032192&t.flags||1032192&n.flags)&&(c=I(t,n,i))&&(a=u)),_=d,!c&&i&&(32768&t.flags&&8190&n.flags?function(t,n){var r=Cr(t),i=Cr(n);(Ce===t&&ee===n||Ie===t&&te===n||Ae===t&&ie===n||fo(!1)===t&&se===n)&&y(e.Diagnostics._0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible,i,r)}(t,n):t.symbol&&32768&t.flags&&ke===t&&y(e.Diagnostics.The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead),b(s,t,n)),c}function T(t,n,s){if(ip(n,32768)&&!(512&yn(n))){var o=!!(33554432&t.flags);if((r===en||r===tn)&&(gc(ke,n)||!o&&Va(n)))return!1;if(65536&n.flags){var a=S(t,n);if(a)return T(t,a,s)}for(var l=function(r){if(!Uu(n,r.escapedName,o)){if(s)if(e.Debug.assert(!!i),e.isJsxAttributes(i)||e.isJsxOpeningLikeElement(i))y(e.Diagnostics.Property_0_does_not_exist_on_type_1,xr(r),Cr(n));else{var a=t.symbol&&e.firstOrUndefined(t.symbol.declarations),l=void 0;if(r.valueDeclaration&&e.findAncestor(r.valueDeclaration,(function(e){return e===a}))){var c=r.valueDeclaration;e.Debug.assertNode(c,e.isObjectLiteralElementLike),i=c,e.isIdentifier(c.name)&&(l=Yu(c.name,n))}void 0!==l?y(e.Diagnostics.Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_write_2,xr(r),Cr(n),l):y(e.Diagnostics.Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1,xr(r),Cr(n))}return{value:!0}}},c=0,u=ss(t);c<u.length;c++){var d=l(u[c]);if("object"==typeof d)return d.value}}return!1}function k(e,t){for(var n=-1,r=0,i=e.types;r<i.length;r++){var s=x(i[r],t,!1);if(!s)return 0;n&=s}return n}function x(e,t,n){var r=t.types;if(65536&t.flags&&Lo(r,e))return-1;for(var i=0,s=r;i<s.length;i++){var o=v(e,s[i],!1);if(o)return o}n&&v(e,S(e,t)||r[r.length-1],!0);return 0}function S(e,t){var n,r=ss(e);if(r){var i=function(e,t){for(var n,r=0,i=e;r<i.length;r++){var s=i[r];if(Ql(t,s.escapedName)){if(n)return;n=s}}return n}(r,t);if(i)for(var s=li(i),o=0,a=t.types;o<a.length;o++){var l=a[o],c=Hr(l,i.escapedName);if(c&&v(s,c)){if(n)return;n=l}}}return n}function C(e,t,n){var r=e.types;if(65536&e.flags&&Lo(r,t))return-1;for(var i=r.length,s=0;s<i;s++){var o=v(r[s],t,n&&s===i-1);if(o)return o}return 0}function I(t,n,i){if(m)return 0;var s=Xa(t,n,r),o=r.get(s);if(void 0!==o){if(!i||2!==o)return 1===o?-1:0;r.set(s,3)}if(l){for(var d=0;d<p;d++)if(s===l[d])return 1;if(100===h)return m=!0,0}else l=[],c=[],u=[];var _=p;l[p]=s,p++,c[h]=t,u[h]=n,h++;var g=f;1&f||!nl(t,c,h)||(f|=1),2&f||!nl(n,u,h)||(f|=2);var b=3!==f?function(t,n,i){var s,o=a;if(16384&n.flags){if(32&yn(t)&&ts(t)===Wo(n))if(!t.declaration.questionToken)if(s=v(ns(t),Qo(n,es(t)),i))return s}else if(262144&n.flags){if(262144&t.flags&&(s=v(n.type,t.type,!1)))return s;if((l=function(e){return 16384&e.flags?ls(e):524288&e.flags?cs(e):us(e)}(n.type))&&(s=v(t,Wo(l),i)))return s}else if(524288&n.flags){if((l=cs(n))&&(s=v(t,l,i)))return a=o,s}if(16384&t.flags){if(32&yn(n)&&ts(n)===Wo(t)){if(s=v(Qo(t,es(n)),ns(n),i))return a=o,s}else if((l=ls(t))||!(16777216&n.flags))if((!l||1&l.flags)&&(l=ue),s=v(l,n,i&&l!==ue))return a=o,s}else if(524288&t.flags){var l;if(l=cs(t)){if(s=v(l,n,i))return a=o,s}else if(524288&n.flags&&t.indexType===n.indexType&&(s=v(t.objectType,n.objectType,i)))return s}else{if(4&yn(t)&&4&yn(n)&&t.target===n.target&&!(67108864&t.flags||67108864&n.flags)){var c=za(t.target);if(s=function(t,n,i,s){var o=t.typeArguments||e.emptyArray,a=n.typeArguments||e.emptyArray;if(o.length!==a.length&&r===nn)return 0;for(var l=o.length<=a.length?o.length:a.length,c=-1,u=0;u<l;u++){var d=u<i.length?i[u]:1;if(4!==d){var p=o[u],h=a[u],f=-1;if(1===d?f=v(p,h,s):2===d?f=v(h,p,s):3===d?(f=v(h,p,!1))||(f=v(p,h,s)):(f=v(p,h,s))&&(f&=v(h,p,s)),!f)return 0;c&=f}}return c}(t,n,c,i))return s;if(c!==e.emptyArray&&!function(e,t){for(var n=0;n<t.length;n++)if(1===t[n]&&1024&e.typeArguments[n].flags)return!0;return!1}(n,c)){if(!i||!e.some(c,(function(e){return 0===e})))return 0;a=o}}var u=!!(8190&t.flags);if(r!==nn&&(t=ms(t)),163840&t.flags&&32768&n.flags){var d=i&&a===o&&!u;if(!function(e){return 32&yn(e)&&!!e.declaration.questionToken}(n)||rs(t)||!Va(t)?rs(n)?s=rs(t)?function(e,t,n){var i,s=!!e.declaration.readonlyToken,o=!!e.declaration.questionToken,a=!!t.declaration.readonlyToken,l=!!t.declaration.questionToken;if((r===nn?s===a&&o===l:r===tn||!o||l)&&(i=v(ts(t),ts(e),n))){var c=_a([es(e)],[es(t)]);return i&v(Ea(ns(e),c),ns(t),n)}return 0}(t,n,d):0:(s=function(t,n,i){if(r===nn)return function(e,t){if(!(32768&e.flags&&32768&t.flags))return 0;var n=ss(e),r=ss(t);if(n.length!==r.length)return 0;for(var i=-1,s=0,o=n;s<o.length;s++){var a=o[s],l=os(t,a.escapedName);if(!l)return 0;var c=rl(a,l,v);if(!c)return 0;i&=c}return i}(t,n);var s=r===Zt&&!(128&yn(t)),o=Fl(t,n,s);if(o)return i&&y(e.Diagnostics.Property_0_is_missing_in_type_1,xr(o),Cr(t)),0;for(var a=-1,l=ss(n),c=0,u=l;c<u.length;c++){var d=u[c];if(!(4194304&d.flags)){var p=bs(t,d.escapedName);if(p&&p!==d){var h=e.getDeclarationModifierFlagsFromSymbol(p),f=e.getDeclarationModifierFlagsFromSymbol(d);if(8&h||8&f){if(256&e.getCheckFlags(p))return i&&y(e.Diagnostics.Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1,xr(p),Cr(t)),0;if(p.valueDeclaration!==d.valueDeclaration)return i&&(8&h&&8&f?y(e.Diagnostics.Types_have_separate_declarations_of_a_private_property_0,xr(d)):y(e.Diagnostics.Property_0_is_private_in_type_1_but_not_in_type_2,xr(d),Cr(8&h?t:n),Cr(8&h?n:t))),0}else if(16&f){if(!el(p,d))return i&&y(e.Diagnostics.Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2,xr(d),Cr(Za(p)||t),Cr(Za(d)||n)),0}else if(16&h)return i&&y(e.Diagnostics.Property_0_is_protected_in_type_1_but_public_in_type_2,xr(d),Cr(t),Cr(n)),0;var m=v(li(p),li(d),i);if(!m)return i&&y(e.Diagnostics.Types_of_property_0_are_incompatible,xr(d)),0;if(a&=m,r!==tn&&16777216&p.flags&&!(16777216&d.flags))return i&&y(e.Diagnostics.Property_0_is_optional_in_type_1_but_required_in_type_2,xr(d),Cr(t),Cr(n)),0}}}return a}(t,n,d))&&(s&=w(t,n,0,d))&&(s&=w(t,n,1,d))&&(s&=O(t,n,0,u,d))&&(s&=O(t,n,1,u,d)):s=-1,s)return a=o,s}}return 0}(t,n,i):1;if(f=g,h--,b){if(-1===b||0===h){for(d=_;d<p;d++)r.set(l[d],1);p=_}}else r.set(s,i?3:2),p=_;return b}function A(t){if(32768&t.flags){var n=is(t);return 0===n.callSignatures.length&&0===n.constructSignatures.length&&!n.stringIndexInfo&&!n.numberIndexInfo&&n.properties.length>0&&e.every(n.properties,(function(e){return!!(16777216&e.flags)}))}return!!(131072&t.flags)&&e.every(t.types,A)}function w(t,n,i,s){if(r===nn)return function(e,t,n){var r=Ts(e,n),i=Ts(t,n);if(r.length!==i.length)return 0;for(var s=-1,o=0;o<r.length;o++){var a=il(r[o],i[o],!1,!1,!1,v);if(!a)return 0;s&=a}return s}(t,n,i);if(n===fe||t===fe)return-1;var o=Ts(t,i),l=Ts(n,i);if(1===i&&o.length&&l.length){if(tl(t)&&!tl(n))return s&&y(e.Diagnostics.Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type),0;if(!function(t,n,r){if(!t.declaration||!n.declaration)return!0;var i=e.getSelectedModifierFlags(t.declaration,24),s=e.getSelectedModifierFlags(n.declaration,24);if(8===s)return!0;if(16===s&&8!==i)return!0;if(16!==s&&!i)return!0;r&&y(e.Diagnostics.Cannot_assign_a_0_constructor_type_to_a_1_constructor_type,wr(i),wr(s));return!1}(o[0],l[0],s))return 0}var c=-1,u=a;if(64&yn(t)&&64&yn(n)&&t.symbol===n.symbol)for(var d=0;d<l.length;d++){if(!(T=N(o[d],l[d],!0,s)))return 0;c&=T}else if(1===o.length&&1===l.length){var p=r===tn||E.noStrictGenericChecks;c=N(o[0],l[0],p,s)}else e:for(var h=0,f=l;h<f.length;h++){for(var m=f[h],_=s,g=0,b=o;g<b.length;g++){var T;if(T=N(b[g],m,!0,_)){c&=T,a=u;continue e}_=!1}return _&&y(e.Diagnostics.Type_0_provides_no_match_for_the_signature_1,Cr(t),Sr(m,void 0,void 0,i)),0}return c}function N(e,t,n,r){return $a(n?Us(e):e,n?Us(t):t,0,!1,r,y,v)}function D(t,n,r){var i=v(t.type,n.type,r);return!i&&r&&y(e.Diagnostics.Index_signatures_are_incompatible),i}function O(t,n,i,s,o){if(r===nn)return function(e,t,n){var r=xs(t,n),i=xs(e,n);if(!i&&!r)return-1;if(i&&r&&i.isReadonly===r.isReadonly)return v(i.type,r.type);return 0}(t,n,i);var a=xs(n,i);if(!a||1&a.type.flags&&!s)return-1;var l=xs(t,i)||1===i&&xs(t,0);if(l)return D(l,a,o);if(rs(t))return 0===i&&v(ns(t),a.type,o);if(kl(t)){var c=-1;if(0===i){var u=xs(t,1);u&&(c=D(u,a,o))}return c&&(c&=function(t,n,r,i){for(var s=-1,o=0,a=ss(t);o<a.length;o++){var l=a[o];if(0===r||bu(l.escapedName)){var c=v(li(l),n,i);if(!c)return i&&y(e.Diagnostics.Property_0_is_incompatible_with_index_signature,xr(l)),0;s&=c}}return s}(t,a.type,i,o)),c}return o&&y(e.Diagnostics.Index_signature_is_missing_in_type_0,Cr(t)),0}}function Wa(t,n,r){var i=Xs(t,e.map(t.typeParameters,(function(e){return e===n?r:e})));return i.flags|=67108864,i}function za(t){if(!w)return e.emptyArray;var n=t.typeParameters||e.emptyArray,r=t.variances;if(!r){if(t===xe||t===Se)r=[1];else{t.variances=e.emptyArray,r=[];for(var i=0,s=n;i<s.length;i++){var o=s[i],a=Wa(t,o,ye),l=Wa(t,o,be),c=(Ra(l,a)?1:0)|(Ra(a,l)?2:0);3===c&&Ra(Wa(t,o,Ze),a)&&(c=4),r.push(c)}}t.variances=r}return r}function qa(e){return 16384&e.flags&&!zs(e)}function Ja(t){return 4&yn(t)&&e.some(t.typeArguments,(function(e){return qa(e)||Ja(e)}))}function Ya(t,n,r){void 0===r&&(r=0);for(var i=""+t.target.id,s=0,o=t.typeArguments;s<o.length;s++){var a=o[s];if(qa(a)){var l=e.indexOf(n,a);l<0&&(l=n.length,n.push(a)),i+="="+l}else r<4&&Ja(a)?i+="<"+Ya(a,n,r+1)+">":i+="-"+a.id}return i}function Xa(e,t,n){if(n===nn&&e.id>t.id){var r=e;e=t,t=r}if(Ja(e)&&Ja(t)){var i=[];return Ya(e,i)+","+Ya(t,i)}return e.id+","+t.id}function Qa(t,n){if(!(6&e.getCheckFlags(t)))return n(t);for(var r=0,i=t.containingType.types;r<i.length;r++){var s=bs(i[r],t.escapedName),o=s&&Qa(s,n);if(o)return o}}function Za(e){return e.parent&&32&e.parent.flags?Oi(tr(e)):void 0}function el(t,n){return!Qa(n,(function(n){return!!(16&e.getDeclarationModifierFlagsFromSymbol(n))&&(r=t,i=Za(n),!Qa(r,(function(e){var t=Za(e);return!!t&&di(t,i)})));var r,i}))}function tl(t){if(16&yn(t)){var n=t.symbol;if(n&&32&n.flags){var r=Wh(n);if(r&&e.hasModifier(r,128))return!0}}return!1}function nl(e,t,n){if(n>=5&&32768&e.flags){var r=e.symbol;if(r)for(var i=0,s=0;s<n;s++){var o=t[s];if(32768&o.flags&&o.symbol===r&&++i>=5)return!0}}return!1}function rl(t,n,r){if(t===n)return-1;var i=24&e.getDeclarationModifierFlagsFromSymbol(t);if(i!==(24&e.getDeclarationModifierFlagsFromSymbol(n)))return 0;if(i){if(Kh(t)!==Kh(n))return 0}else if((16777216&t.flags)!=(16777216&n.flags))return 0;return ep(t)!==ep(n)?0:r(li(t),li(n))}function il(t,n,r,i,s,o){if(t===n)return-1;if(!function(e,t,n){if(e.parameters.length===t.parameters.length&&e.minArgumentCount===t.minArgumentCount&&e.hasRestParameter===t.hasRestParameter)return!0;var r=e.hasRestParameter?1:0,i=t.hasRestParameter?1:0;return!!(n&&e.minArgumentCount<=t.minArgumentCount&&(r>i||r===i&&e.parameters.length>=t.parameters.length))}(t,n,r))return 0;if(e.length(t.typeParameters)!==e.length(n.typeParameters))return 0;t=Us(t),n=Us(n);var a=-1;if(!i){var l=Ps(t);if(l){var c=Ps(n);if(c){if(!(p=o(l,c)))return 0;a&=p}}}for(var u=n.parameters.length,d=0;d<u;d++){var p;if(!(p=o(sl(t,d)?Fs(t):Bd(t.parameters[d]),sl(n,d)?Fs(n):Bd(n.parameters[d]))))return 0;a&=p}return s||(a&=o(Ms(t),Ms(n))),a}function sl(e,t){return e.hasRestParameter&&t>=e.parameters.length-1}function ol(t){return function(e){for(var t,n=0,r=e;n<r.length;n++){var i=r[n],s=pl(i);if(t||(t=s),s===i||s!==t)return!1}return!0}(t)?Uo(t):e.reduceLeft(t,(function(e,t){return Oa(e,t)?t:e}))}function al(e){return 4&yn(e)&&e.target===xe}function ll(e){return 4&yn(e)&&(e.target===xe||e.target===Se)||!(6144&e.flags)&&Ra(e,Re)}function cl(e){return!!bs(e,"0")}function ul(e){return!!(6368&e.flags)}function dl(t){return!!(8&t.flags)||(65536&t.flags?!!(256&t.flags)||!e.forEach(t.types,(function(e){return!ul(e)})):ul(t))}function pl(t){return 256&t.flags?Ai(t):32&t.flags?ee:64&t.flags?te:128&t.flags?ie:65536&t.flags?Uo(e.sameMap(t.types,pl)):t}function hl(t){return 256&t.flags?Ai(t):32&t.flags&&1048576&t.flags?ee:64&t.flags&&1048576&t.flags?te:128&t.flags?ie:65536&t.flags?Uo(e.sameMap(t.types,hl)):t}function fl(e){return!!(4&yn(e)&&8&e.target.objectFlags)}function ml(e){for(var t=0,n=0,r=e;n<r.length;n++){t|=_l(r[n])}return t}function _l(e){return 65536&e.flags?ml(e.types):32&e.flags?""===e.value?32:0:64&e.flags?0===e.value?64:0:128&e.flags?e===re?128:0:7406&e.flags}function gl(e){return 7392&_l(e)?bc(e,(function(e){return!(7392&_l(e))})):e}function yl(e){return vc(e,bl)}function bl(e){return 2&e.flags?dt:4&e.flags?pt:8&e.flags||e===re?re:7168&e.flags||32&e.flags&&""===e.value||64&e.flags&&0===e.value?e:ae}function vl(e,t){var n=t&~e.flags&6144;return 0===n?e:Uo(2048===n?[e,Y]:4096===n?[e,Q]:[e,Y,Q])}function Tl(e){return A?nc(e,524288):e}function kl(e){return e.symbol&&0!=(6656&e.symbol.flags)&&0===Ts(e,0).length&&0===Ts(e,1).length}function El(e,t){var n=cn(e.flags,e.escapedName);return n.declarations=e.declarations,n.parent=e.parent,n.type=t,n.target=e,e.valueDeclaration&&(n.valueDeclaration=e.valueDeclaration),n}function xl(t){if(!(128&yn(t)&&1048576&t.flags))return t;var n=t.regularType;if(n)return n;var r=t,i=function(t,n){for(var r=e.createSymbolTable(),i=0,s=ss(t);i<s.length;i++){var o=s[i],a=li(o),l=n(a);r.set(o.escapedName,l===a?o:El(o,l))}return r}(t,xl),s=dr(r.symbol,i,r.callSignatures,r.constructSignatures,r.stringIndexInfo,r.numberIndexInfo);return s.flags=-1048577&r.flags,s.objectFlags|=128,t.regularType=s,s}function Sl(e){var t=li(e),n=Il(t);return n===t?e:El(e,n)}function Cl(e){return 6144&e.flags?e:Il(e)}function Il(t){if(6291456&t.flags){if(6144&t.flags)return z;if(128&yn(t))return function(t){for(var n=e.createSymbolTable(),r=0,i=ss(t);r<i.length;r++){var s=i[r];n.set(s.escapedName,4&s.flags?Sl(s):s)}var o=xs(t,0),a=xs(t,1);return dr(t.symbol,n,e.emptyArray,e.emptyArray,o&&Ks(Il(o.type),o.isReadonly),a&&Ks(Il(a.type),a.isReadonly))}(t);if(65536&t.flags)return Uo(e.sameMap(t.types,Cl));if(al(t)||fl(t))return Xs(t.target,e.sameMap(t.typeArguments,Il))}return t}function Al(t){var n=!1;if(65536&t.flags)for(var r=0,i=t.types;r<i.length;r++){Al(c=i[r])&&(n=!0)}if(al(t)||fl(t))for(var s=0,o=t.typeArguments;s<o.length;s++){Al(c=o[s])&&(n=!0)}if(128&yn(t))for(var a=0,l=ss(t);a<l.length;a++){var c,u=l[a];2097152&(c=li(u)).flags&&(Al(c)||ln(u.valueDeclaration,e.Diagnostics.Object_literal_s_property_0_implicitly_has_an_1_type,e.symbolName(u),Cr(Il(c))),n=!0)}return n}function wl(t,n){var r,i=Cr(Il(n));switch(t.kind){case 149:case 148:r=e.Diagnostics.Member_0_implicitly_has_an_1_type;break;case 146:r=t.dotDotDotToken?e.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type:e.Diagnostics.Parameter_0_implicitly_has_an_1_type;break;case 176:r=e.Diagnostics.Binding_element_0_implicitly_has_an_1_type;break;case 228:case 151:case 150:case 153:case 154:case 186:case 187:if(!t.name)return void ln(t,e.Diagnostics.Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type,i);r=e.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type;break;default:r=e.Diagnostics.Variable_0_implicitly_has_an_1_type}ln(t,r,e.declarationNameToString(e.getNameOfDeclaration(t)),i)}function Nl(e,t){r&&N&&2097152&t.flags&&(Al(t)||wl(e,t))}function Dl(e,t,n){var r,i=e.parameters.length,s=t.parameters.length;r=e.hasRestParameter&&t.hasRestParameter?Math.max(i,s):e.hasRestParameter?s:t.hasRestParameter?i:Math.min(i,s);for(var o=0;o<r;o++)n(Ud(e,o),Ud(t,o))}function Ol(t,n,r,i){var s=i?e.map(i,Ll):e.map(t.typeParameters,Rl),o=function(e){for(var t=0;t<s.length;t++)if(e===s[t].typeParameter)return s[t].isFixed=!0,Vl(o,t);return e};return o.signature=t,o.inferences=s,o.flags=n,o.compareTypes=r||Da,o}function Rl(e){return{typeParameter:e,candidates:void 0,inferredType:void 0,priority:void 0,topLevel:!0,isFixed:!1}}function Ll(e){return{typeParameter:e.typeParameter,candidates:e.candidates&&e.candidates.slice(),inferredType:e.inferredType,priority:e.priority,topLevel:e.topLevel,isFixed:e.isFixed}}function Pl(t){var n=yn(t);return!!(802816&t.flags||4&n&&e.forEach(t.typeArguments,Pl)||16&n&&t.symbol&&10288&t.symbol.flags||32&n||196608&t.flags&&function(t){void 0===t.couldContainTypeVariables&&(t.couldContainTypeVariables=e.forEach(t.types,Pl));return t.couldContainTypeVariables}(t))}function Ml(t,n){return t===n||196608&t.flags&&e.forEach(t.types,(function(e){return Ml(e,n)}))}function Fl(e,t,n){for(var r=0,i=ss(t);r<i.length;r++){var s=i[r];if(n||!(16777216&s.flags))if(!bs(e,s.escapedName))return s}}function $l(t,n,r,i){var s,o;function a(t,n){if(Pl(n))if(t.aliasSymbol&&t.aliasTypeArguments&&t.aliasSymbol===n.aliasSymbol)for(var d=t.aliasTypeArguments,p=n.aliasTypeArguments,h=0;h<d.length;h++)a(d[h],p[h]);else{if(65536&t.flags&&65536&n.flags&&!(256&t.flags&&256&n.flags)||131072&t.flags&&131072&n.flags){if(t===n){for(var f=0,m=t.types;f<m.length;f++){a(I=m[f],I)}return}for(var _=void 0,g=0,y=t.types;g<y.length;g++){if(Bl(I=y[g],n.types))(_||(_=[])).push(I),a(I,I);else if(96&I.flags){var b=pl(I);Bl(b,n.types)&&(_||(_=[])).push(I,b)}}_&&(t=Ul(t,_),n=Ul(n,_))}if(540672&n.flags){if(8388608&t.flags||t===le)return;var v=c(n);if(v)return void(v.isFixed||(!v.candidates||i<v.priority?(v.candidates=[t],v.priority=i):i===v.priority&&v.candidates.push(t),8&i||!(16384&n.flags)||Ml(r,n)||(v.topLevel=!1)))}else if(4&yn(t)&&4&yn(n)&&t.target===n.target){d=t.typeArguments||e.emptyArray,p=n.typeArguments||e.emptyArray;var T=d.length<p.length?d.length:p.length,k=za(t.target);for(h=0;h<T;h++)h<k.length&&2===k[h]?l(d[h],p[h]):a(d[h],p[h])}else if(262144&t.flags&&262144&n.flags)a(t.type,n.type);else if(524288&t.flags&&524288&n.flags)a(t.objectType,n.objectType),a(t.indexType,n.indexType);else if(196608&n.flags){for(var E=0,x=void 0,S=0,C=p=n.types;S<C.length;S++){var I;c(I=C[S])?(x=I,E++):a(t,I)}if(1===E){var A=i;i|=2,a(t,x),i=A}}else if(65536&t.flags)for(var w=0,N=d=t.types;w<N.length;w++){a(N[w],n)}else if(163840&(t=ms(t)).flags){var D=t.id+","+n.id;if(o&&o.get(D))return;(o||(o=e.createMap())).set(D,!0);var O=32768&n.flags&&!(16&yn(n)&&n.symbol&&32&n.symbol.flags)?n.symbol:void 0;if(O){if(e.contains(s,O))return;(s||(s=[])).push(O),u(t,n),s.pop()}else u(t,n)}}}function l(e,t){w?(i^=1,a(e,t),i^=1):a(e,t)}function c(e){if(540672&e.flags)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e===i.typeParameter)return i}}function u(t,n){if(rs(t)&&rs(n)&&(a(ts(t),ts(n)),a(ns(t),ns(n))),32&yn(n)){var r=ts(n);if(262144&r.flags){var s=c(r.type);if(s&&!s.isFixed){var o=function(t,n){var r=as(t),i=xs(t,0);if(0!==r.length||i){for(var s=Rl(Qo(ts(n).type,es(n))),o=[s],a=ns(n),l=!n.declaration.readonlyToken,c=n.declaration.questionToken?0:16777216,u=e.createSymbolTable(),d=0,p=r;d<p.length;d++){var h=p[d],f=g(li(h));if(!f)return;var m=cn(4|h.flags&c,h.escapedName);m.checkFlags=l&&ep(h)?8:0,m.declarations=h.declarations,m.type=f,u.set(h.escapedName,m)}if(i){var _=g(i.type);if(!_)return;i=Ks(_,l&&i.isReadonly)}return dr(void 0,u,e.emptyArray,e.emptyArray,i,void 0)}function g(e){return s.candidates=void 0,$l(o,e,a),s.candidates&&Uo(s.candidates,!0)}}(t,n);if(o){var l=i;i|=4,a(o,s.typeParameter),i=l}}return}if(16384&r.flags)return a(Wo(t),r),void a(Uo(e.map(as(t),li)),ns(n))}Fl(t,n,!1)&&Fl(n,t,!1)||(function(e,t){for(var n=ss(t),r=0,i=n;r<i.length;r++){var s=i[r],o=bs(e,s.escapedName);o&&a(li(o),li(s))}}(t,n),d(t,n,0),d(t,n,1),function(e,t){var n=Ss(t,0);if(n){(i=Ss(e,0)||Cs(e,0))&&a(i,n)}var r=Ss(t,1);if(r){var i;(i=Ss(e,1)||Ss(e,0)||Cs(e,1))&&a(i,r)}}(t,n))}function d(e,t,n){for(var r=Ts(e,n),i=Ts(t,n),s=r.length,o=i.length,a=s<o?s:o,l=0;l<a;l++)p(Us(r[s-a+l]),Us(i[o-a+l]))}function p(e,t){Dl(e,t,l),e.typePredicate&&t.typePredicate&&e.typePredicate.kind===t.typePredicate.kind?a(e.typePredicate.type,t.typePredicate.type):a(Ms(e),Ms(t))}void 0===i&&(i=0),a(n,r)}function Bl(e,t){for(var n=0,r=t;n<r.length;n++){if(wa(r[n],e))return!0}return!1}function Ul(e,t){for(var n=[],r=0,i=e.types;r<i.length;r++){var s=i[r];Bl(s,t)||n.push(s)}return 65536&e.flags?Uo(n):jo(n)}function Vl(t,n){var r,i=t.inferences[n],s=i.inferredType;if(!s){if(i.candidates){var o=t.signature,a=i.topLevel&&!function(e){var t=ls(e);return t&&ip(t,270334)}(i.typeParameter)&&(i.isFixed||!Ml(Ms(o),i.typeParameter))?e.sameMap(i.candidates,hl):i.candidates;s=Il(1&i.priority?(r=a,e.reduceLeft(r,(function(e,t){return Oa(t,e)?t:e}))):1&t.flags||8&i.priority?Uo(a,!0):function(t){if(!A)return ol(t);var n=e.filter(t,(function(e){return!(6144&e.flags)}));return n.length?vl(ol(n),6144&ml(t)):Uo(t,!0)}(a))}else if(2&t.flags)s=le;else{var l=fs(i.typeParameter);s=l?Ea(l,ga(function(t,n){return function(r){return e.indexOf(t,r)>=n?ue:r}}(t.signature.typeParameters,n),t)):Hl(!!(4&t.flags))}i.inferredType=s;var c=ls(t.signature.typeParameters[n]);if(c){var u=Ea(c,t);t.compareTypes(s,Ui(u,s))||(i.inferredType=s=u)}}return s}function Hl(e){return e?z:ue}function Gl(e){for(var t=[],n=0;n<e.inferences.length;n++)t.push(Vl(e,n));return t}function jl(t){var n=gn(t);return n.resolvedSymbol||(n.resolvedSymbol=!e.nodeIsMissing(t)&&kn(t,t.escapedText,1156031,e.Diagnostics.Cannot_find_name_0,t,!e.isWriteOnlyAccess(t),e.Diagnostics.Cannot_find_name_0_Did_you_mean_1)||K),n.resolvedSymbol}function Kl(t){return!!e.findAncestor(t,(function(e){return 162===e.kind||71!==e.kind&&143!==e.kind&&"quit"}))}function Wl(t){if(71===t.kind){var n=jl(t);return n!==K?(Bc(t)?"@":"")+a(n):void 0}if(99===t.kind)return"0";if(179===t.kind)return(i=Wl(t.expression))&&i+"."+e.idText(t.name);if(176===t.kind){var r=t.parent.parent,i=176===r.kind?Wl(r):r.initializer&&Wl(r.initializer),s=zl(t);return i&&s&&i+"."+s}}function zl(t){if(174!==t.parent.kind)return""+t.parent.elements.indexOf(t);var n=t.propertyName||t.name;switch(n.kind){case 71:return e.idText(n);case 144:return e.isStringOrNumericLiteral(n.expression)?n.expression.text:void 0;case 9:case 8:return n.text;default:e.Debug.fail("Unexpected name kind for binding element name")}}function ql(e,t){switch(e.kind){case 71:return 71===t.kind&&jl(e)===jl(t)||(226===t.kind||176===t.kind)&&nr(jl(e))===er(t);case 99:return 99===t.kind;case 97:return 97===t.kind;case 179:return 179===t.kind&&e.name.escapedText===t.name.escapedText&&ql(e.expression,t.expression);case 176:if(179!==t.kind)return!1;var n=t;if(n.name.escapedText!==zl(e))return!1;if(176===e.parent.parent.kind&&ql(e.parent.parent,n.expression))return!0;if(226===e.parent.parent.kind){var r=e.parent.parent.initializer;return r&&ql(r,n.expression)}}return!1}function Jl(e,t){for(;179===e.kind;)if(ql(e=e.expression,t))return!0;return!1}function Yl(e,t){return 179===t.kind&&Jl(e,t.expression)&&Ql(Xl(t.expression),t.name.escapedText)}function Xl(e){if(71===e.kind)return li(jl(e));if(179===e.kind){var t=Xl(e.expression);return t&&Hr(t,e.name.escapedText)}}function Ql(t,n){if(t&&65536&t.flags){var r=gs(t,n);if(r&&2&e.getCheckFlags(r))return void 0===r.isDiscriminantProperty&&(r.isDiscriminantProperty=32&r.checkFlags&&dl(li(r))),r.isDiscriminantProperty}return!1}function Zl(e,t){return ql(e,t)||Jl(e,t)}function ec(e,t){if(e!==t){if(8192&t.flags)return t;var n=bc(e,(function(e){return function(e,t){if(!(65536&e.flags))return Ra(e,t);for(var n=0,r=e.types;n<r.length;n++)if(Ra(r[n],t))return!0;return!1}(t,e)}));if(!(8192&n.flags))return n}return e}function tc(e){var t=e.flags;if(2&t)return A?4079361:4194049;if(32&t){var n=""===e.value;return A?n?3030785:1982209:n?3145473:4194049}if(20&t)return A?4079234:4193922;if(64&t){var r=0===e.value;return A?r?3030658:1982082:r?3145346:4193922}return 8&t?A?4078980:4193668:136&t?A?e===re?3030404:1981828:e===re?3145092:4193668:32768&t?function(e){var t=is(e);return!!(t.callSignatures.length||t.constructSignatures.length||t.members.get("bind")&&Oa(e,Ee))}(e)?A?6164448:8376288:A?6166480:8378320:3072&t?2457472:4096&t?2340752:512&t?A?1981320:4193160:16777216&t?A?6166480:8378320:540672&t?tc(us(e)||ue):196608&t?function(e){for(var t=0,n=0,r=e;n<r.length;n++)t|=tc(r[n]);return t}(e.types):8388607}function nc(e,t){if(524288&e.flags){var n=us(e)||ue,r=bc(n,(function(e){return 0!=(tc(e)&t)}));return r!==n?r:e}return bc(e,(function(e){return 0!=(tc(e)&t)}))}function rc(e,t){if(t){var n=Cp(t);return Uo([nc(e,131072),n])}return e}function ic(t,n){var r=e.getTextOfPropertyName(n);return Hr(t,r)||bu(r)&&Ss(t,1)||Ss(t,0)||J}function sc(e,t){return cl(e)&&Hr(e,""+t)||Nh(e,void 0,!1,!1)||J}function oc(e){return No(Nh(e,void 0,!1,!1)||J)}function ac(e){return 194===e.parent.kind&&e.parent.left===e||216===e.parent.kind&&e.parent.initializer===e}function lc(e){return ic(cc(e.parent),e.name)}function cc(t){var n=t.parent;switch(n.kind){case 215:return ee;case 216:return wh(n.expression,n.awaitModifier)||J;case 194:return function(e){return 177===e.parent.kind&&ac(e.parent)||261===e.parent.kind&&ac(e.parent.parent)?rc(cc(e),e.right):Cp(e.right)}(n);case 188:return Y;case 177:return function(t,n){return sc(cc(t),e.indexOf(t.elements,n))}(n,t);case 198:return function(e){return oc(cc(e.parent))}(n);case 261:return lc(n);case 262:return function(e){return rc(lc(e),e.objectAssignmentInitializer)}(n)}return J}function uc(e){return e.initializer?function(e){return gn(e).resolvedType||Cp(e)}(e.initializer):215===e.parent.parent.kind?ee:216===e.parent.parent.kind&&wh(e.parent.parent.expression,e.parent.parent.awaitModifier)||J}function dc(t){return 226===t.kind?uc(t):function(t){var n=t.parent,r=dc(n.parent);return rc(174===n.kind?ic(r,t.propertyName||t.name):t.dotDotDotToken?oc(r):sc(r,e.indexOf(n.elements,t)),t.initializer)}(t)}function pc(e){return 226===e.kind||176===e.kind?dc(e):cc(e)}function hc(e){switch(e.kind){case 185:return hc(e.expression);case 194:switch(e.operatorToken.kind){case 58:return hc(e.left);case 26:return hc(e.right)}}return e}function fc(e){var t=e.parent;return 185===t.kind||194===t.kind&&58===t.operatorToken.kind&&t.left===e||194===t.kind&&26===t.operatorToken.kind&&t.right===e?fc(t):e}function mc(e){if(257===e.kind){var t=ca(Cp(e.expression));return ul(t)?t:void 0}return ae}function _c(t){var n=gn(t);if(!n.switchTypes){n.switchTypes=[];for(var r=0,i=t.caseBlock.clauses;r<i.length;r++){var s=mc(i[r]);if(void 0===s)return n.switchTypes=e.emptyArray;n.switchTypes.push(s)}}return n.switchTypes}function gc(e,t){return e===t||65536&t.flags&&function(e,t){if(65536&e.flags){for(var n=0,r=e.types;n<r.length;n++){var i=r[n];if(!Lo(t.types,i))return!1}return!0}if(256&e.flags&&Ai(e)===t)return!0;return Lo(t.types,e)}(e,t)}function yc(t,n){return 65536&t.flags?e.forEach(t.types,n):n(t)}function bc(t,n){if(65536&t.flags){var r=t.types,i=e.filter(r,n);return i===r?t:Vo(i)}return n(t)?t:ae}function vc(e,t){if(!(65536&e.flags))return t(e);for(var n,r,i=0,s=e.types;i<s.length;i++){var o=t(s[i]);o&&(n?r?r.push(o):r=[n,o]:n=o)}return r?Uo(r):n}function Tc(e,t){return bc(e,(function(e){return 0!=(e.flags&t)}))}function kc(e,t){return gc(ee,e)&&ip(t,32)||gc(te,e)&&ip(t,64)?vc(e,(function(e){return 2&e.flags?Tc(t,34):4&e.flags?Tc(t,68):e})):e}function Ec(e){return 0===e.flags}function xc(e){return 0===e.flags?e.type:e}function Sc(e,t){return t?{flags:0,type:e}:e}function Cc(e){return j[e.id]||(j[e.id]=function(e){var t=ar(256);return t.elementType=e,t}(e))}function Ic(e,t){var n=pl(function(e){var t=e.contextualType;e.contextualType=z;var n=Cp(e);return e.contextualType=t,n}(t));return gc(n,e.elementType)?e:Cc(Uo([e.elementType,n]))}function Ac(e){return e.finalArrayType||(e.finalArrayType=8192&(t=e.elementType).flags?Oe:No(65536&t.flags?Uo(t.types,!0):t));var t}function wc(e){return 256&yn(e)?Ac(e):e}function Nc(e){return 256&yn(e)?e.elementType:ae}function Dc(t,n){return function(e){for(var t=!1,n=0,r=e;n<r.length;n++){var i=r[n];if(!(8192&i.flags)){if(!(256&yn(i)))return!1;t=!0}}return t}(t)?Cc(Uo(e.map(t,Nc))):Uo(e.sameMap(t,wc),n)}function Oc(t){var n=fc(t),r=n.parent,i=179===r.kind&&("length"===r.name.escapedText||181===r.parent.kind&&e.isPushOrUnshiftIdentifier(r.name)),s=180===r.kind&&r.expression===n&&194===r.parent.kind&&58===r.parent.operatorToken.kind&&r.parent.left===r&&!e.isAssignmentTarget(r.parent)&&sp(Cp(r.argumentExpression),84);return i||s}function Rc(t){var n=gn(t);return void 0===n.maybeTypePredicate&&(n.maybeTypePredicate=function(t){if(97!==t.expression.kind){var n=ju(t.expression);if(n!==le){var r=ms(n);if(r!==J){var i=Ts(r,0);return!!e.forEach(i,(function(e){return e.typePredicate}))}}}return!1}(t)),n.maybeTypePredicate}function Lc(t,n,r,i,o){var a;void 0===r&&(r=n);var l=0;if(ut)return J;if(!t.flowNode||!o&&!(17810175&n.flags))return n;var c=ct,u=xc(p(t.flowNode));ct=c;var d=256&yn(u)&&Oc(t)?De:wc(u);return 203===t.parent.kind&&8192&nc(d,524288).flags?n:d;function p(s){if(2500===l)return ut=!0,o=t,a=e.findAncestor(o,e.isFunctionOrModuleBlock),u=e.getSourceFileOfNode(o),d=e.getSpanOfTokenAtPosition(u,a.statements.pos),wt.add(e.createFileDiagnostic(u,d.start,d.length,e.Diagnostics.The_containing_function_or_module_body_is_too_large_for_control_flow_analysis)),J;var o,a,u,d;for(l++;;){var b=s.flags;if(1024&b)for(var v=c;v<ct;v++)if(xt[v]===s)return l--,St[v];var T=void 0;if(4096&b)s.locked=!0,T=p(s.antecedent),s.locked=!1;else{if(2048&b){s=s.antecedent;continue}if(16&b){if(!(T=h(s))){s=s.antecedent;continue}}else if(96&b)T=m(s);else if(128&b)T=_(s);else if(12&b){if(1===s.antecedents.length){s=s.antecedents[0];continue}T=4&b?g(s):y(s)}else if(256&b){if(!(T=f(s))){s=s.antecedent;continue}}else if(2&b){var k=s.container;if(k&&k!==i&&179!==t.kind&&99!==t.kind){s=k.flowNode;continue}T=r}else T=kh(n)}return 1024&b&&(xt[ct]=s,St[ct]=T,ct++),l--,T}}function h(r){var i=r.node;if(ql(t,i)){if(2===e.getAssignmentTargetKind(i)){var s=p(r.antecedent);return Sc(pl(xc(s)),Ec(s))}if(n===q||n===Oe){if(function(e){return 226===e.kind&&e.initializer&&Jr(e.initializer)||176!==e.kind&&194===e.parent.kind&&Jr(e.parent.right)}(i))return Cc(ae);var o=pl(pc(i));return Ra(o,n)?o:De}return 65536&n.flags?ec(n,pc(i)):n}if(Jl(t,i))return n}function f(e){if(n===q||n===Oe){var r=e.node,i=181===r.kind?r.expression.expression:r.left.expression;if(ql(t,hc(i))){var s=p(e.antecedent),o=xc(s);if(256&yn(o)){var a=o;if(181===r.kind)for(var l=0,c=r.arguments;l<c.length;l++){a=Ic(a,c[l])}else sp(Cp(r.left.argumentExpression),84)&&(a=Ic(a,r.right));return a===o?s:Sc(a,Ec(s))}return s}}}function m(e){var t=p(e.antecedent),n=xc(t);if(8192&n.flags)return t;var r=0!=(32&e.flags),i=wc(n),s=w(i,e.expression,r);if(s===i)return t;var o=Ec(t);return Sc(o&&8192&s.flags?le:s,o)}function _(e){var n=p(e.antecedent),r=xc(n),i=e.switchStatement.expression;return ql(t,i)?r=S(r,e.switchStatement,e.clauseStart,e.clauseEnd):b(i,r)&&(r=v(r,i,(function(t){return S(t,e.switchStatement,e.clauseStart,e.clauseEnd)}))),Sc(r,Ec(n))}function g(t){for(var i=[],s=!1,o=!1,a=0,l=t.antecedents;a<l.length;a++){var c=l[a];if(!(2048&c.flags&&c.lock.locked)){var u=p(c),d=xc(u);if(d===n&&n===r)return d;e.pushIfUnique(i,d),gc(d,n)||(s=!0),Ec(u)&&(o=!0)}}return Sc(Dc(i,s),o)}function y(r){var i=function(e){return e.id||(e.id=s,s++),e.id}(r),o=vt[i]||(vt[i]=e.createMap());if(!a&&!(a=Wl(t)))return n;var l=o.get(a);if(l)return l;for(var c=at;c<lt;c++)if(Tt[c]===r&&kt[c]===a&&Et[c].length)return Sc(Dc(Et[c],!1),!0);var u,d=[],h=!1;Tt[lt]=r,kt[lt]=a,Et[lt]=d;for(var f=0,m=r.antecedents;f<m.length;f++){var _=m[f];lt++;var g=p(_);lt--,u||(u=g);var y=xc(g),b=o.get(a);if(b)return b;if(e.pushIfUnique(d,y),gc(y,n)||(h=!0),y===n)break}var v=Dc(d,h);return Ec(u)?Sc(v,!0):(o.set(a,v),v)}function b(e,n){return 179===e.kind&&65536&n.flags&&ql(t,e.expression)&&Ql(n,e.name.escapedText)}function v(e,t,n){var r=t.name.escapedText,i=Hr(e,r),s=i&&n(i);return i===s?e:bc(e,(function(e){return Pa(Hr(e,r),s)}))}function T(e,r,i){return ql(t,r)?nc(e,i?1048576:2097152):b(r,n)?v(e,r,(function(e){return nc(e,i?1048576:2097152)})):Yl(t,r)?n:e}function k(r,i,s){switch(i.operatorToken.kind){case 58:return T(r,i.left,s);case 32:case 33:case 34:case 35:var o=i.operatorToken.kind,a=hc(i.left),l=hc(i.right);if(189===a.kind&&9===l.kind)return x(r,a,o,l,s);if(189===l.kind&&9===a.kind)return x(r,l,o,a,s);if(ql(t,a))return E(r,o,l,s);if(ql(t,l))return E(r,o,a,s);if(b(a,n))return v(r,a,(function(e){return E(e,o,l,s)}));if(b(l,n))return v(r,l,(function(e){return E(e,o,a,s)}));if(Yl(t,a)||Yl(t,l))return n;break;case 93:return function(r,i,s){var o=hc(i.left);if(!ql(t,o))return Jl(t,o)?n:r;var a,l=Cp(i.right);if(!Oa(l,Ee))return r;var c=bs(l,"prototype");if(c){var u=li(c);Gr(u)||(a=u)}if(Gr(r)&&(a===ke||a===Ee))return r;if(!a){var d=void 0;2&yn(l)?d=Bi(l).declaredConstructSignatures:16&yn(l)&&(d=Ts(l,1)),d&&d.length&&(a=Uo(e.map(d,(function(e){return Ms(Us(e))}))))}if(a)return C(r,a,s,La);return r}(r,i,s);case 26:return w(r,i.right,s)}return r}function E(e,t,n,r){if(1&e.flags)return e;33!==t&&35!==t||(r=!r);var i=Cp(n);if(6144&i.flags)return A?nc(e,32===t||33===t?r?65536:524288:95===n.kind?r?32768:262144:r?16384:131072):e;if(16810497&e.flags)return e;if(r){var s=bc(e,(function(e){return Pa(t=e,n=i)||Pa(n,t);var t,n}));return 8192&s.flags?e:kc(s,i)}if(ul(i)){var o=ca(i);return bc(e,(function(e){return ca(e)!==o}))}return e}function x(e,r,i,s,o){var a=hc(r.expression);if(!ql(t,a))return Jl(t,a)?n:e;if(33!==i&&35!==i||(o=!o),o&&!(65536&e.flags)){var l=Ut.get(s.text);if(l){if(Oa(l,e))return l;if(540672&e.flags)if(Oa(l,us(e)||z))return jo([e,l])}}return nc(e,o?$t.get(s.text)||64:Bt.get(s.text)||8192)}function S(t,n,r,i){var s=_c(n);if(!s.length)return t;var o=s.slice(r,i),a=r===i||e.contains(o,ae),l=Uo(o),c=8192&l.flags?ae:kc(bc(t,(function(e){return Pa(l,e)})),l);if(!a)return c;var u=bc(t,(function(t){return!(ul(t)&&e.contains(s,ca(t)))}));return 8192&c.flags?u:Uo([c,u])}function C(e,t,n,r){if(!n)return bc(e,(function(e){return!r(e,t)}));if(65536&e.flags){var i=bc(e,(function(e){return r(e,t)}));if(!(8192&i.flags))return i}return Oa(t,e)?t:Ra(e,t)?e:Ra(t,e)?t:jo([e,t])}function I(r,i,s){if(!function(e,t){if(e.arguments)for(var n=0,r=e.arguments;n<r.length;n++)if(Zl(t,r[n]))return!0;return!(179!==e.expression.kind||!Zl(t,e.expression.expression))}(i,t)||!Rc(i))return r;var o=Dd(i),a=o.typePredicate;if(!a)return r;if(Gr(r)&&(a.type===ke||a.type===Ee))return r;if(e.isIdentifierTypePredicate(a)){var l=i.arguments[a.parameterIndex-(o.thisParameter?1:0)];if(l){if(ql(t,l))return C(r,a.type,s,Oa);if(Jl(t,l))return n}}else{var c=e.skipParentheses(i.expression);if(180===c.kind||179===c.kind){var u=c,d=e.skipParentheses(u.expression);if(ql(t,d))return C(r,a.type,s,Oa);if(Jl(t,d))return n}}return r}function w(e,t,n){switch(t.kind){case 71:case 99:case 97:case 179:return T(e,t,n);case 181:return I(e,t,n);case 185:return w(e,t.expression,n);case 194:return k(e,t,n);case 192:if(51===t.operator)return w(e,t.operand,!n)}return e}}function Pc(t){return e.findAncestor(t.parent,(function(t){return e.isFunctionLike(t)&&!e.getImmediatelyInvokedFunctionExpression(t)||234===t.kind||265===t.kind||149===t.kind}))}function Mc(t){var n,r=e.getRootDeclaration(t.valueDeclaration).parent,i=gn(r);return 4194304&i.flags||(i.flags|=4194304,n=r,e.findAncestor(n.parent,(function(t){return e.isFunctionLike(t)&&!!(4194304&gn(t).flags)}))||Fc(r)),t.isAssigned||!1}function Fc(t){if(71===t.kind){if(e.isAssignmentTarget(t)){var n=jl(t);n.valueDeclaration&&146===e.getRootDeclaration(n.valueDeclaration).kind&&(n.isAssigned=!0)}}else e.forEachChild(t,Fc)}function $c(e){return 3&e.flags&&0!=(2&Vu(e))&&li(e)!==Oe}function Bc(e){var t=e.parent;return 179===t.kind||181===t.kind&&t.expression===e||180===t.kind&&t.expression===e}function Uc(e){return 540672&e.flags&&ip(us(e)||ue,6144)}function Vc(e,t){var n=li(e);return Bc(t)&&yc(n,Uc)?vc(Il(n),ms):n}function Hc(t){var n=jl(t);if(n===K)return J;if(n===F){var r=e.getContainingFunction(t);return x<2&&(187===r.kind?ln(t,e.Diagnostics.The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_standard_function_expression):e.hasModifier(r,256)&&ln(t,e.Diagnostics.The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_using_a_standard_function_or_method)),gn(r).flags|=8192,li(n)}!Ln(n,107455)||Kl(t)||Lf(Mn(n))||$n(n);var i=nr(n),s=i.valueDeclaration;if(32&i.flags)if(229===s.kind&&e.nodeIsDecorated(s))for(r=e.getContainingClass(t);void 0!==r;){if(r===s&&r.name!==t){gn(s).flags|=8388608,gn(t).flags|=16777216;break}r=e.getContainingClass(r)}else if(199===s.kind)for(r=e.getThisContainer(t,!1);void 0!==r;){if(r.parent===s){149===r.kind&&e.hasModifier(r,32)&&(gn(s).flags|=8388608,gn(t).flags|=16777216);break}r=e.getThisContainer(r,!1)}yh(t,t),fh(t,t),mh(t,t),function(t,n){if(x>=2||0==(34&n.flags)||260===n.valueDeclaration.parent.kind)return;var r=e.getEnclosingBlockScopeContainer(n.valueDeclaration),i=function(t,n){return!!e.findAncestor(t,(function(t){return t===n?"quit":e.isFunctionLike(t)}))}(t.parent,r),s=r,o=!1;for(;s&&!e.nodeStartsNewLexicalEnvironment(s);){if(e.isIterationStatement(s,!1)){o=!0;break}s=s.parent}o&&(i&&(gn(s).flags|=65536),214===r.kind&&e.getAncestor(n.valueDeclaration,227).parent===r&&function(t,n){var r=t;for(;185===r.parent.kind;)r=r.parent;var i=!1;if(e.isAssignmentTarget(r))i=!0;else if(192===r.parent.kind||193===r.parent.kind){var s=r.parent;i=43===s.operator||44===s.operator}if(!i)return!1;return!!e.findAncestor(r,(function(e){return e===n?"quit":e===n.statement}))}(t,r)&&(gn(n.valueDeclaration).flags|=2097152),gn(n.valueDeclaration).flags|=262144);i&&(gn(n.valueDeclaration).flags|=131072)}(t,n);var o=Vc(i,t),a=e.getAssignmentTargetKind(t);if(a){if(!(3&i.flags))return ln(t,e.Diagnostics.Cannot_assign_to_0_because_it_is_not_a_variable,xr(n)),J;if(ep(i))return ln(t,e.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,xr(n)),J}var l=2097152&i.flags;if(3&i.flags){if(1===a)return o}else{if(!l)return o;s=e.find(n.declarations,u)}if(!s)return o;for(var c=146===e.getRootDeclaration(s).kind,d=Pc(s),p=Pc(t),h=p!==d;p!==d&&(186===p.kind||187===p.kind||e.isObjectLiteralOrClassExpressionMethod(p))&&($c(i)||c&&!Mc(i));)p=Pc(p);var f=c||l||h||o!==q&&o!==Oe&&(!A||0!=(1&o.flags)||Kl(t)||246===t.parent.kind)||203===t.parent.kind||e.isInAmbientContext(s),m=Lc(t,o,f?c?function(e,t){return A&&146===t.kind&&t.initializer&&2048&_l(e)&&!(2048&_l(Ip(t.initializer)))?nc(e,131072):e}(o,e.getRootDeclaration(s)):o:o===q||o===Oe?Y:vl(o,2048),p,!f);if(o===q||o===Oe){if(m===q||m===Oe)return N&&(ln(e.getNameOfDeclaration(s),e.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined,xr(n),Cr(m)),ln(t,e.Diagnostics.Variable_0_implicitly_has_an_1_type,xr(n),Cr(m))),kh(m)}else if(!f&&!(2048&_l(o))&&2048&_l(m))return ln(t,e.Diagnostics.Variable_0_is_used_before_being_assigned,xr(n)),o;return a?pl(m):m}function Gc(e,t){(gn(e).flags|=2,149===t.kind||152===t.kind)?gn(t.parent).flags|=4:gn(t).flags|=4}function jc(t){return e.isSuperCall(t)?t:e.isFunctionLike(t)?void 0:e.forEachChild(t,jc)}function Kc(e){var t=gn(e);return void 0===t.hasSuperCall&&(t.superCall=jc(e.body),t.hasSuperCall=!!t.superCall),t.superCall}function Wc(e){return ki(Oi(er(e)))===Z}function zc(t,n,r){var i=n.parent;if(e.getClassExtendsHeritageClauseElement(i)&&!Wc(i)){var s=Kc(n);(!s||s.end>t.pos)&&ln(t,r)}}function qc(t){var n=e.getThisContainer(t,!0),r=!1;switch(152===n.kind&&zc(t,n,e.Diagnostics.super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class),187===n.kind&&(n=e.getThisContainer(n,!1),r=x<2),n.kind){case 233:ln(t,e.Diagnostics.this_cannot_be_referenced_in_a_module_or_namespace_body);break;case 232:ln(t,e.Diagnostics.this_cannot_be_referenced_in_current_location);break;case 152:Jc(t,n)&&ln(t,e.Diagnostics.this_cannot_be_referenced_in_constructor_arguments);break;case 149:case 148:e.hasModifier(n,32)&&ln(t,e.Diagnostics.this_cannot_be_referenced_in_a_static_property_initializer);break;case 144:ln(t,e.Diagnostics.this_cannot_be_referenced_in_a_computed_property_name)}if(r&&Gc(t,n),e.isFunctionLike(n)&&(!tu(t)||e.getThisParameter(n))){if(186===n.kind&&194===n.parent.kind&&3===e.getSpecialPropertyAssignmentKind(n.parent)){var i=Ip(n.parent.left.expression.expression).symbol;if(i&&i.members&&16&i.flags)return Rd(i)}var s=ii(n)||Zc(n);if(s)return s}if(e.isClassLike(n.parent)){var o,a=er(n.parent);return Lc(t,o=e.hasModifier(n,32)?li(a):Oi(a).thisType)}if(e.isInJavaScriptFile(t)&&((o=function(t){var n=e.getJSDocType(t);if(n&&273===n.kind){var r=n;if(r.parameters.length>0&&r.parameters[0].name&&"this"===r.parameters[0].name.escapedText)return pa(r.parameters[0].type)}}(n))&&o!==J))return o;return D&&ln(t,e.Diagnostics.this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation),z}function Jc(t,n){return!!e.findAncestor(t,(function(e){return e===n?"quit":146===e.kind}))}function Yc(t){var n=181===t.parent.kind&&t.parent.expression===t,r=e.getSuperContainer(t,!0),i=!1;if(!n)for(;r&&187===r.kind;)r=e.getSuperContainer(r,!0),i=x<2;var s=0;if(!function(t){if(!t)return!1;if(n)return 152===t.kind;if(e.isClassLike(t.parent)||178===t.parent.kind)return e.hasModifier(t,32)?151===t.kind||150===t.kind||153===t.kind||154===t.kind:151===t.kind||150===t.kind||153===t.kind||154===t.kind||149===t.kind||148===t.kind||152===t.kind;return!1}(r)){var o=e.findAncestor(t,(function(e){return e===r?"quit":144===e.kind}));return o&&144===o.kind?ln(t,e.Diagnostics.super_cannot_be_referenced_in_a_computed_property_name):n?ln(t,e.Diagnostics.Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors):r&&r.parent&&(e.isClassLike(r.parent)||178===r.parent.kind)?ln(t,e.Diagnostics.super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_derived_class):ln(t,e.Diagnostics.super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions),J}if(n||152!==r.kind||zc(t,r,e.Diagnostics.super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class),s=e.hasModifier(r,32)||n?512:256,gn(t).flags|=s,151===r.kind&&e.hasModifier(r,256)&&(e.isSuperProperty(t.parent)&&e.isAssignmentTarget(t.parent)?gn(r).flags|=4096:gn(r).flags|=2048),i&&Gc(t.parent,r),178===r.parent.kind)return x<2?(ln(t,e.Diagnostics.super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_higher),J):z;var a=r.parent,l=Oi(er(a)),c=l&&Ei(l)[0];return c?152===r.kind&&Jc(t,r)?(ln(t,e.Diagnostics.super_cannot_be_referenced_in_constructor_arguments),J):512===s?ki(l):Ui(c,l.thisType):(e.getClassExtendsHeritageClauseElement(a)||ln(t,e.Diagnostics.super_can_only_be_referenced_in_a_derived_class),J)}function Xc(e){return 4&yn(e)&&e.target===Ne?e.typeArguments[0]:void 0}function Qc(t){return vc(t,(function(t){return 131072&t.flags?e.forEach(t.types,Xc):Xc(t)}))}function Zc(t){if(187!==t.kind){if(Ia(t)){var n=mu(t);if(n){var r=n.thisParameter;if(r)return li(r)}}var i=e.isInJavaScriptFile(t);if(D||i){var s=function(e){return 151!==e.kind&&153!==e.kind&&154!==e.kind||178!==e.parent.kind?186===e.kind&&261===e.parent.kind?e.parent.parent:void 0:e.parent}(t);if(s){for(var o=lu(s),a=s,l=o;l;){var c=Qc(l);if(c)return Ea(c,uu(s));if(261!==a.parent.kind)break;l=lu(a=a.parent.parent)}return o?Tl(o):yp(s)}var u=t.parent;if(194===u.kind&&58===u.operatorToken.kind){var d=u.left;if(179===d.kind||180===d.kind){var p=d.expression;if(i&&e.isIdentifier(p)){var h=e.getSourceFileOfNode(u);if(h.commonJsModuleIndicator&&jl(p)===h.symbol)return}return yp(p)}}}}}function eu(t){var n=t.parent;if(Ia(n)){var r=e.getImmediatelyInvokedFunctionExpression(n);if(r&&r.arguments){var i=e.indexOf(n.parameters,t);if(t.dotDotDotToken){for(var s=[],o=i;o<r.arguments.length;o++)s.push(hl(Ip(r.arguments[o])));return s.length?No(Uo(s)):void 0}var a=gn(r),l=a.resolvedSignature;a.resolvedSignature=et;var c=i<r.arguments.length?hl(Ip(r.arguments[i])):t.initializer?void 0:X;return a.resolvedSignature=l,c}var u=mu(n);if(u){var d=e.hasRestParameter(n),p=n.parameters.length-(d?1:0);i=e.indexOf(n.parameters,t);if(void 0===e.getThisParameter(n)||u.thisParameter||(e.Debug.assert(0!==i),i-=1),i<p)return Ud(u,i);if(d&&i===n.parameters.length-1&&sl(u,n.parameters.length-1))return li(e.lastOrUndefined(u.parameters))}}}function tu(t){for(;t.parent&&!e.isFunctionLike(t.parent);){if(146===t.parent.kind&&t.parent.initializer===t)return!0;t=t.parent}return!1}function nu(t){if(152===t.kind||e.getEffectiveReturnTypeNode(t)||Mh(t))return Ms(Rs(t));var n=hu(t);return n&&!function(e){return!e.resolvedReturnType&&$r(e,3)>=0}(n)?Ms(n):void 0}function ru(t,n){var r=_d(t),i=e.indexOf(r,n);if(i>=0)return Ud(gn(t).resolvedSignature===nt?nt:Dd(t),i)}function iu(e,t){return vc(e,(function(e){var n=229376&e.flags?bs(e,t):void 0;return n?li(n):void 0}))}function su(e,t){return vc(e,(function(e){return Es(e,t)}))}function ou(t){var n=lu(t.parent);if(n){if(!e.hasDynamicName(t)){var r=iu(n,er(t).escapedName);if(r)return r}return yu(t.name)&&su(n,1)||su(n,0)}}function au(e,t){return e&&(iu(e,""+t)||su(e,1)||Dh(e,void 0,!1,!1,!1))}function lu(e){var t=cu(e);return t&&ms(t)}function cu(t){if(!hf(t)){if(t.contextualType)return t.contextualType;var n=t.parent;switch(n.kind){case 226:case 146:case 149:case 148:case 176:return function(t){var n=t.parent;if(t===n.initializer){var r=e.getEffectiveTypeAnnotationNode(n);if(r)return pa(r);if(146===n.kind){var i=eu(n);if(i)return i}if(e.isBindingPattern(n.name))return Zr(n.name,!0,!1);if(e.isBindingPattern(n.parent)){var s=n.parent.parent,o=n.propertyName||n.name;if(176!==s.kind){var a=e.getEffectiveTypeAnnotationNode(s);if(a&&!e.isBindingPattern(o)){var l=e.getTextOfPropertyName(o);if(l)return Hr(pa(a),l)}}}}}(t);case 187:case 219:return function(t){var n=e.getContainingFunction(t);if(n){var r=e.getFunctionFlags(n);if(1&r)return;var i=nu(n);return 2&r?i&&Wp(i):i}}(t);case 197:return function(t){var n=e.getContainingFunction(t);if(n){var r=e.getFunctionFlags(n),i=nu(n);if(i)return t.asteriskToken?i:Lh(i,0!=(2&r))}}(n);case 181:case 182:return ru(n,t);case 184:case 202:return pa(n.type);case 194:return function(t){var n=t.parent,r=n.operatorToken.kind;if(e.isAssignmentOperator(r)){if(t===n.right){switch(e.getSpecialPropertyAssignmentKind(n)){case 0:break;case 5:if(!n.left.symbol)break;case 1:case 2:case 3:case 4:return}return Cp(n.left)}}else{if(54===r){var i=cu(n);return i||t!==n.right||(i=Cp(n.left,!0)),i}if((53===r||26===r)&&t===n.right)return cu(n)}}(t);case 261:case 262:return ou(n);case 263:return lu(n.parent);case 177:var r=n;return au(lu(r),e.indexOfNode(r.elements,t));case 195:return function(e){var t=e.parent;return e===t.whenTrue||e===t.whenFalse?cu(t):void 0}(t);case 205:return e.Debug.assert(196===n.parent.kind),function(e,t){if(183===e.parent.kind)return ru(e.parent,t)}(n.parent,t);case 185:var i=e.isInJavaScriptFile(n)?e.getJSDocTypeTag(n):void 0;return i?pa(i.typeExpression.type):cu(n);case 256:return function(t){var n=cu(e.isJsxAttributeLike(t.parent)?t.parent.parent:t.parent.openingElement.attributes);if(n&&!Gr(n)){if(e.isJsxAttribute(t.parent))return iu(n,t.parent.name.escapedText);if(249===t.parent.kind){var r=Du();return r&&""!==r?iu(n,r):z}return n}}(n);case 253:case 255:return function(t){var n=cu(t.parent);if(e.isJsxAttribute(t)){if(!n||Gr(n))return;return iu(n,t.name.escapedText)}return n}(n);case 251:case 250:return Mu(n)}}}function uu(t){return(t=e.findAncestor(t,(function(e){return!!e.contextualMapper})))?t.contextualMapper:k}function du(t,n){var r=vs(t,0);if(1===r.length){var i=r[0];if(!function(t,n){for(var r=0;r<n.parameters.length;r++){var i=n.parameters[r];if(i.initializer||i.questionToken||i.dotDotDotToken||As(i))break}n.parameters.length&&e.parameterIsThisKeyword(n.parameters[0])&&r--;return(t.hasRestParameter?Number.MAX_VALUE:t.parameters.length)<r}(i,n))return i}}function pu(e){return 186===e.kind||187===e.kind}function hu(t){return pu(t)||e.isObjectLiteralMethod(t)?mu(t):void 0}function fu(t){return e.isObjectLiteralMethod(t)?function(t){if(e.Debug.assert(e.isObjectLiteralMethod(t)),!hf(t))return ou(t)}(t):lu(t)}function mu(t){e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t));var n=fu(t);if(n){if(!(65536&n.flags))return du(n,t);for(var r,i,s=0,o=n.types;s<o.length;s++){var a=du(o[s],t);if(a)if(r){if(!il(r[0],a,!1,!0,!0,Na))return;r.push(a)}else r=[a]}return r&&((i=Gi(r[0])).resolvedReturnType=void 0,i.unionSignatures=r),i}}function _u(e){return 176===e.kind&&!!e.initializer||194===e.kind&&58===e.operatorToken.kind}function gu(t,n){for(var r=t.elements,i=!1,s=[],o=e.isAssignmentTarget(t),a=lu(t),l=0;l<r.length;l++){var c=r[l];if(o&&198===c.kind){var u=Ip(c.expression,n),d=Ss(u,1)||Dh(u,void 0,!1,!1,!1);d&&s.push(d)}else{var p=kp(c,n,au(a,l));s.push(p)}i=i||198===c.kind}if(!i){if(o&&s.length)return(p=Qs(Oo(s))).pattern=t,p;var h=lu(t);if(h&&function(t){return!!(65536&t.flags?e.forEach(t.types,cl):cl(t))}(h)){var f=h.pattern;if(f&&(175===f.kind||177===f.kind))for(var m=f.elements,_=s.length;_<m.length;_++){var g=m[_];_u(g)?s.push(h.typeArguments[_]):(200!==g.kind&&ln(g,e.Diagnostics.Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value),s.push(J))}if(s.length)return Oo(s)}}return No(s.length?Uo(s,!0):A?ae:X)}function yu(e){switch(e.kind){case 144:return function(e){return sp(vu(e),84)}(e);case 71:return bu(e.escapedText);case 8:case 9:return bu(e.text);default:return!1}}function bu(e){return(+e).toString()===e}function vu(t){var n=gn(t.expression);return n.resolvedType||(n.resolvedType=Ip(t.expression),6144&n.resolvedType.flags||!sp(n.resolvedType,262774)&&!Ra(n.resolvedType,Uo([ee,te,se]))?ln(t,e.Diagnostics.A_computed_property_name_must_be_of_type_string_number_symbol_or_any):id(t.expression,n.resolvedType,!0)),n.resolvedType}function Tu(e,t,n,r){for(var i=[],s=0;s<n.length;s++)(0===r||yu(e[s+t].name))&&i.push(li(n[s]));return Ks(i.length?Uo(i,!0):Y,!1)}function ku(t,n){var r=e.isAssignmentTarget(t);!function(t,n){for(var r=e.createUnderscoreEscapedMap(),i=1,s=2,o=4,a=s|o,l=0,c=t.properties;l<c.length;l++){var u=c[l];if(263!==u.kind){var d=u.name;if(144===d.kind&&dm(d),262===u.kind&&!n&&u.objectAssignmentInitializer)return Cm(u.equalsToken,e.Diagnostics.can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment);if(u.modifiers)for(var p=0,h=u.modifiers;p<h.length;p++){var f=h[p];120===f.kind&&151===u.kind||Cm(f,e.Diagnostics._0_modifier_cannot_be_used_here,e.getTextOfNode(f))}var m=void 0;261===u.kind||262===u.kind?(hm(u.questionToken,e.Diagnostics.An_object_member_cannot_be_declared_optional),8===d.kind&&wm(d),m=i):151===u.kind?m=i:153===u.kind?m=s:154===u.kind?m=o:e.Debug.assertNever(u,"Unexpected syntax kind:"+u.kind);var _=e.getPropertyNameForPropertyNameNode(d);if(void 0!==_){var g=r.get(_);if(g)if(m===i&&g===i)Cm(d,e.Diagnostics.Duplicate_identifier_0,e.getTextOfNode(d));else{if(!(m&a&&g&a))return Cm(d,e.Diagnostics.An_object_literal_cannot_have_property_and_accessor_with_the_same_name);if(g===a||m===g)return Cm(d,e.Diagnostics.An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name);r.set(_,m|g)}else r.set(_,m)}}}}(t,r);for(var i=e.createSymbolTable(),s=[],o=ue,a=0,l=lu(t),c=l&&l.pattern&&(174===l.pattern.kind||178===l.pattern.kind),u=!l&&e.isInJavaScriptFile(t),d=0,p=!1,h=!1,f=!1,m=e.isInJavaScriptFile(t),_=0,g=0;g<t.properties.length;g++){var y=t.properties[g],b=y.symbol,v=void 0;if(261===y.kind||262===y.kind||e.isObjectLiteralMethod(y)){var T=void 0;m&&(T=qr(y));var k=void 0;if(261===y.kind){if(144===y.name.kind){var S=vu(y.name);224&S.flags&&(v=e.escapeLeadingUnderscores(""+S.value))}k=Ep(y,n)}else 151===y.kind?k=xp(y,n):(e.Debug.assert(262===y.kind),k=kp(y.name,n));T&&(Ma(k,T,y),k=T),d|=k.flags;var C=cn(4|b.flags,v||b.escapedName);if(r)(261===y.kind&&_u(y.initializer)||262===y.kind&&y.objectAssignmentInitializer)&&(C.flags|=16777216),!v&&e.hasDynamicName(y)&&(p=!0);else if(c&&!(512&yn(l))){var I=bs(l,b.escapedName);I?C.flags|=16777216&I.flags:E.suppressExcessPropertyErrors||xs(l,0)||ln(y.name,e.Diagnostics.Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1,xr(b),Cr(l))}C.declarations=b.declarations,C.parent=b.parent,b.valueDeclaration&&(C.valueDeclaration=b.valueDeclaration),C.type=k,C.target=b,b=C}else{if(263===y.kind){if(x<2&&Zf(y,2),s.length>0&&(o=ia(o,N(),t.symbol,a),s=[],i=e.createSymbolTable(),h=!1,f=!1,d=0),!Eu(k=Ip(y.expression)))return ln(y,e.Diagnostics.Spread_types_may_only_be_created_from_object_types),J;o=ia(o,k,t.symbol,a),_=g+1;continue}e.Debug.assert(153===y.kind||154===y.kind),cf(y)}!v&&e.hasDynamicName(y)?yu(y.name)?f=!0:h=!0:i.set(b.escapedName,b),s.push(b)}if(c)for(var A=0,w=as(l);A<w.length;A++){C=w[A];i.get(C.escapedName)||(16777216&C.flags||ln(C.valueDeclaration||C.bindingElement,e.Diagnostics.Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value),i.set(C.escapedName,C),s.push(C))}return o!==ue?(s.length>0&&(o=ia(o,N(),t.symbol,a)),o):N();function N(){var n=u?st:h?Tu(t.properties,_,s,0):void 0,o=f&&!u?Tu(t.properties,_,s,1):void 0,l=dr(t.symbol,i,e.emptyArray,e.emptyArray,n,o),c=E.suppressExcessPropertyErrors?0:1048576;return l.flags|=4194304|c|14680064&d,l.objectFlags|=128,p&&(l.objectFlags|=512),r&&(l.pattern=t),6144&l.flags||(a|=14680064&l.flags),l}}function Eu(t){return!!(16777217&t.flags||7392&_l(t)&&Eu(gl(t))||32768&t.flags&&!rs(t)||196608&t.flags&&!e.forEach(t.types,(function(e){return!Eu(e)})))}function xu(t){return!e.stringContains(t,"-")}function Su(t){switch(t.kind){case 179:case 99:return!1;case 71:return e.isIntrinsicJsxName(t.escapedText);default:e.Debug.fail()}}function Cu(t,n,r){for(var i,s=t.attributes,o=e.createSymbolTable(),a=ue,l=[],c=!1,u=!1,d=Du(),p=0,h=s.properties;p<h.length;p++){var f=h[p],m=f.symbol;if(e.isJsxAttribute(f)){var _=f.initializer?Ip(f.initializer,r):ne,g=cn(33554436|m.flags,m.escapedName);g.declarations=m.declarations,g.parent=m.parent,m.valueDeclaration&&(g.valueDeclaration=m.valueDeclaration),g.type=_,g.target=m,o.set(g.escapedName,g),l.push(g),f.name.escapedText===d&&(u=!0)}else{e.Debug.assert(255===f.kind),l.length>0&&(a=ia(a,A(s.symbol,o),t.symbol,0),l=[],o=e.createSymbolTable()),Gr(_=Ip(f.expression))&&(c=!0),Eu(_)?a=ia(a,_,t.symbol,0):i=i?jo([i,_]):_}}if(!c){a!==ue&&(l.length>0&&(a=ia(a,A(s.symbol,o),t.symbol,0)),l=as(a)),o=e.createSymbolTable();for(var y=0,b=l;y<b.length;y++){var v=b[y];n&&!n(v)||o.set(v.escapedName,v)}}var T=249===t.parent.kind?t.parent:void 0;if(T&&T.openingElement===t&&T.children.length>0){for(var k=[],E=0,x=T.children;E<x.length;E++){var S=x[E];10===S.kind?S.containsOnlyWhiteSpaces||k.push(ee):k.push(Ip(S,r))}if(!c&&d&&""!==d){u&&ln(s,e.Diagnostics._0_are_specified_twice_The_attribute_named_0_will_be_overwritten,e.unescapeLeadingUnderscores(d));var C=cn(33554436,d);C.type=1===k.length?k[0]:No(Uo(k,!1)),o.set(d,C)}}if(c)return z;var I=A(s.symbol,o);return i&&o.size?jo([i,I]):i||I;function A(t,n){var r=dr(t,n,e.emptyArray,e.emptyArray,void 0,void 0);return r.flags|=37748736,r.objectFlags|=128,r}}function Iu(e){var t=jt.get(e);return void 0===t&&jt.set(e,t=xo(Kt,e)||J),t}function Au(t){var n=gn(t);if(!n.resolvedSymbol){var r=Iu(Wt);if(r!==J){if(!e.isIdentifier(t.tagName))throw e.Debug.fail();var i=bs(r,t.tagName.escapedText);return i?(n.jsxFlags|=1,n.resolvedSymbol=i):Ss(r,0)?(n.jsxFlags|=2,n.resolvedSymbol=r.symbol):(ln(t,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.idText(t.tagName),"JSX."+Wt),n.resolvedSymbol=K)}return N&&ln(t,e.Diagnostics.JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists,e.unescapeLeadingUnderscores(Wt)),n.resolvedSymbol=K}return n.resolvedSymbol}function wu(t){var n=po(Kt,1920,void 0),r=n&&vn(n.exports,t,793064),i=r&&Oi(r),s=i&&as(i);if(s){if(0===s.length)return"";if(1===s.length)return s[0].escapedName;s.length>1&&ln(r.declarations[0],e.Diagnostics.The_global_type_JSX_0_may_not_have_more_than_one_property,e.unescapeLeadingUnderscores(t))}}function Nu(){return Ht||(Ht=!0,Ot=wu(qt)),Ot}function Du(){return Gt||(Gt=!0,Rt=wu(Jt)),Rt}function Ou(e){if(e){if(131072&e.flags){for(var t=[],n=0,r=e.types;n<r.length;n++){var i=r[n];t.push(ms(i))}return jo(t)}return ms(e)}}function Ru(t,n,r,i){if(void 0===r&&(r=Ip(t.tagName)),65536&r.flags)return Uo(r.types.map((function(e){return Ru(t,n,e,i)})),!0);if(2&r.flags)return z;if(32&r.flags){var s=Iu(Wt);if(s!==J){var o=r.value,a=bs(s,e.escapeLeadingUnderscores(o));if(a)return li(a);var l=Ss(s,0);if(l)return l;ln(t,e.Diagnostics.Property_0_does_not_exist_on_type_1,o,"JSX."+Wt)}return z}var c=function(t,n){if(e.Debug.assert(!(65536&n.flags)),Gr(n))return z;var r=Ts(n,1);if(0===r.length&&0===(r=Ts(n,0)).length)return ln(t.tagName,e.Diagnostics.JSX_element_type_0_does_not_have_any_construct_or_call_signatures,e.getTextOfNode(t.tagName)),J;for(var i=[],s=0,o=r;s<o.length;s++){var a=o[s];if(a.typeParameters){var l=e.isInJavaScriptFile(t),c=Os(void 0,a.typeParameters,0,l);i.push($s(a,c,l))}else i.push(a)}return Uo(e.map(i,Ms),!0)}(t,r),u=n?function(t,n,r,i){if(e.Debug.assert(!(65536&n.flags)),!i||!Ra(r,i)){var s=$u();if(s){var o=[];Ad(t,n,o);for(var a=void 0,l=void 0,c=0,u=o;c<u.length;c++){var d=u[c],p=Ms(d),h=p&&(0===d.parameters.length?ue:li(d.parameters[0]));if(h=Ou(h),p&&Ra(p,s)){for(var f=!0,m=0,_=t.attributes.properties;m<_.length;m++){var g=_[m];if(e.isJsxAttribute(g)&&xu(g.name.escapedText)&&!bs(h,g.name.escapedText)){f=!1;break}}f&&(a=qi(a,h)),l=qi(l,h)}}a||(a=l);var y=Iu(Xt);return y!==J&&(a=qi(y,a)),a}}}(t,r,c,i):function(t,n,r,i){if(e.Debug.assert(!(65536&n.flags)),!i||!Ra(r,i)){var s=$u();if(s){var o=Ad(t,n,void 0);if(o!==tt){var a=o&&Ms(o),l=a&&(0===o.parameters.length?ue:li(o.parameters[0]));if(l=Ou(l),a&&Ra(a,s)){var c=Iu(Xt);return c!==J&&(l=qi(c,l)),l}}}}}(t,r,c,i);if(u)return u;if(i&&Ka(c,i,en,t,e.Diagnostics.JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements),Gr(c))return c;var d=Nu();if(void 0===d)return z;if(""===d)return c;var p=Hr(c,d);if(p){if(Gr(p)||p===J)return p;var h=p,f=Iu(Qt);if(f!==J){var m=mi(f.symbol);m?1===m.length&&(h=qi(Xs(f,[c]),h)):h=qi(p,f)}var _=Iu(Xt);return _!==J&&(h=qi(_,h)),h}return ue}function Lu(t){e.Debug.assert(Su(t.tagName));var n=gn(t);if(!n.resolvedJsxElementAttributesType){var r=Au(t);return 1&n.jsxFlags?n.resolvedJsxElementAttributesType=li(r):2&n.jsxFlags?n.resolvedJsxElementAttributesType=Ws(r,0).type:n.resolvedJsxElementAttributesType=J}return n.resolvedJsxElementAttributesType}function Pu(e,t){var n=gn(e),r=t?"resolvedJsxElementAllAttributesType":"resolvedJsxElementAttributesType";if(!n[r]){var i=function(){ze||(ze=xo(Kt,zt));return ze}();return n[r]=Ru(e,t,void 0,i)}return n[r]}function Mu(e){return Su(e.tagName)?Lu(e):Pu(e,!1)}function Fu(){return qe||(qe=xo(Kt,Yt)),qe}function $u(){if(!Je){var e=Fu();e&&(Je=Uo([e,Q]))}return Je}function Bu(t){var n;!function(t){for(var n=e.createUnderscoreEscapedMap(),r=0,i=t.attributes.properties;r<i.length;r++){var s=i[r];if(255!==s.kind){var o=s,a=o.name;if(n.get(a.escapedText))return Cm(a,e.Diagnostics.JSX_elements_cannot_have_multiple_attributes_with_the_same_name);n.set(a.escapedText,!0);var l=o.initializer;if(l&&256===l.kind&&!l.expression)return Cm(o.initializer,e.Diagnostics.JSX_attributes_must_only_be_assigned_a_non_empty_expression)}}}(t),n=t,0===(E.jsx||0)&&ln(n,e.Diagnostics.Cannot_use_JSX_unless_the_jsx_flag_is_provided),void 0===Fu()&&N&&ln(n,e.Diagnostics.JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist);var r=wt&&2===E.jsx?e.Diagnostics.Cannot_find_name_0:void 0,i=an(),s=kn(t.tagName,i,107455,r,i,!0);s&&(s.isReferenced=!0,2097152&s.flags&&!Lf(Mn(s))&&$n(s)),function(t){var n=Su(t.tagName)?Lu(t):Pu(t,!1),r=Cu(t,(function(e){return xu(e.escapedName)||!!bs(n,e.escapedName)}));if(n===ue&&(Gr(r)||r.properties.length>0))ln(t,e.Diagnostics.JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property,e.unescapeLeadingUnderscores(Nu()));else{if(Ma(r,n,t.attributes.properties.length>0?t.attributes:t)&&!Gr(r)&&!Gr(n))for(var i=0,s=t.attributes.properties;i<s.length;i++){var o=s[i];if(e.isJsxAttribute(o)&&!Uu(n,o.name.escapedText,!0)){ln(o,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.idText(o.name),Cr(n));break}}}}(t)}function Uu(e,t,n){if(32768&e.flags){var r=is(e);if(r.stringIndexInfo||r.numberIndexInfo&&bu(t)||os(e,t)||n&&!xu(t))return!0}else if(196608&e.flags)for(var i=0,s=e.types;i<s.length;i++){if(Uu(s[i],t,n))return!0}return!1}function Vu(t){return t.valueDeclaration?e.getCombinedNodeFlags(t.valueDeclaration):0}function Hu(t){return!!(8192&t.flags||4&e.getCheckFlags(t))}function Gu(t,n,r,i){var s=e.getDeclarationModifierFlagsFromSymbol(i),o=179===t.kind||226===t.kind?t.name:t.right;if(256&e.getCheckFlags(i))return ln(o,e.Diagnostics.Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1,xr(i),Cr(r)),!1;if(97===n.kind){if(x<2)if(Qa(i,(function(e){var t,n=(t=e).valueDeclaration?t.valueDeclaration.kind:149;return 151!==n&&150!==n})))return ln(o,e.Diagnostics.Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword),!1;if(128&s)return ln(o,e.Diagnostics.Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression,xr(i),Cr(Za(i))),!1}if(!(24&s))return!0;if(8&s)return!!gf(t,Wh(tr(i)))||(ln(o,e.Diagnostics.Property_0_is_private_and_only_accessible_within_class_1,xr(i),Cr(Za(i))),!1);if(97===n.kind)return!0;var a=_f(t,(function(t){var n=Oi(er(t));return function(t,n){return Qa(n,(function(n){return!!(16&e.getDeclarationModifierFlagsFromSymbol(n))&&!di(t,Za(n))}))?void 0:t}(n,i)?n:void 0}));return a?!!(32&s)||(16384&r.flags&&r.isThisType&&(r=ls(r)),!!(3&yn(ui(r))&&di(r,a))||(ln(o,e.Diagnostics.Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1,xr(i),Cr(a)),!1)):(ln(o,e.Diagnostics.Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses,xr(i),Cr(Za(i)||r)),!1)}function ju(e){return Ku(Ip(e),e)}function Ku(t,n){var r=6144&(A?_l(t):t.flags);if(r){ln(n,2048&r?4096&r?e.Diagnostics.Object_is_possibly_null_or_undefined:e.Diagnostics.Object_is_possibly_undefined:e.Diagnostics.Object_is_possibly_null);var i=Tl(t);return 14336&i.flags?J:i}return t}function Wu(e){return qu(e,e.expression,e.name)}function zu(e){return qu(e,e.left,e.right)}function qu(t,n,r){var i=ju(n);if(Gr(i)||i===le)return i;var s=ms(Il(i));if(s===J||16384&i.flags&&Gr(s))return s;var o=bs(s,r.escapedText);if(!o){var a=xs(s,0);return a&&a.type?(a.isReadonly&&(e.isAssignmentTarget(t)||e.isDeleteTarget(t))&&ln(t,e.Diagnostics.Index_signature_in_type_0_only_permits_reading,Cr(s)),a.type):(r.escapedText&&!Cn(t)&&function(t,n){var r;if(65536&n.flags&&!(8190&n.flags))for(var i=0,s=n.types;i<s.length;i++){var o=s[i];if(!bs(o,t.escapedText)){r=e.chainDiagnosticMessages(r,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.declarationNameToString(t),Cr(o));break}}var a=Yu(t,n);r=void 0!==a?e.chainDiagnosticMessages(r,e.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2,e.declarationNameToString(t),Cr(n),a):e.chainDiagnosticMessages(r,e.Diagnostics.Property_0_does_not_exist_on_type_1,e.declarationNameToString(t),Cr(n));wt.add(e.createDiagnosticForNodeFromMessageChain(t,r))}(r,16384&i.flags&&i.isThisType?s:i),J)}!function(t,n,r){var i=t.valueDeclaration;if(!i)return;!function(t){return!!e.findAncestor(t,(function(t){switch(t.kind){case 149:return!0;case 261:return!1;default:return!e.isPartOfExpression(t)&&"quit"}}))}(n)||Tn(i,r)||function(e){var t=li(e.parent);for(;;){if(!(t=Ju(t)))return!1;var n=os(t,e.escapedName);if(n&&n.valueDeclaration)return!0}}(t)?229!==i.kind||159===n.parent.kind||e.isInAmbientContext(i)||Tn(i,r)||ln(r,e.Diagnostics.Class_0_used_before_its_declaration,e.idText(r)):ln(r,e.Diagnostics.Block_scoped_variable_0_used_before_its_declaration,e.idText(r))}(o,t,r),Zu(o,t,99===n.kind),gn(t).resolvedSymbol=o,Gu(t,n,s,o);var l=Vc(o,t),c=e.getAssignmentTargetKind(t);if(c&&(tp(t,o)||np(t)))return ln(r,e.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,e.idText(r)),J;if(!(179===t.kind&&1!==c&&(98311&o.flags||8192&o.flags&&65536&l.flags)))return l;var u=Lc(t,l);return c?pl(u):u}function Ju(t){var n=Ei(t);if(0!==n.length)return e.Debug.assert(1===n.length),n[0]}function Yu(t,n){var r=Qu(e.idText(t),as(n),107455);return r&&e.symbolName(r)}function Xu(t,n,r){var i=En(t,n,r,void 0,n,!1,(function(t,n,r){return vn(t,n,r)||Qu(e.unescapeLeadingUnderscores(n),e.arrayFrom(t.values()),r)}));return i&&e.symbolName(i)}function Qu(t,n,r){var i=.4*t.length,s=Math.min(3,.34*t.length),o=Number.MAX_VALUE,a=void 0,l=!1;if(!(t.length>30)){t=t.toLowerCase();for(var c=0,u=n;c<u.length;c++){var d=u[c],p=e.symbolName(d);if(d.flags&r&&p&&Math.abs(p.length-t.length)<s){if((p=p.toLowerCase())===t)return d;if(l)continue;if(p.length<3||t.length<3||"eval"===p||"intl"===p||"undefined"===p||"map"===p||"nan"===p||"set"===p)continue;var h=e.levenshtein(t,p);if(h>i)continue;h<3?(l=!0,a=d):h<o&&(o=h,a=d)}}return a}}function Zu(t,n,r){if(t&&C&&106500&t.flags&&t.valueDeclaration&&e.hasModifier(t.valueDeclaration,8)&&(!n||!e.isWriteOnlyAccess(n))){if(r){var i=e.findAncestor(n,e.isFunctionLikeDeclaration);if(i&&i.symbol===t)return}1&e.getCheckFlags(t)?_n(t).target.isReferenced=!0:t.isReferenced=!0}}function ed(t,n,r,i){if(i!==J&&!Gr(i)){var s=bs(i,r);if(s)return Gu(t,n,i,s);if(e.isInJavaScriptFile(n)&&65536&i.flags)for(var o=0,a=i.types;o<a.length;o++){if(ed(t,n,r,a[o]))return!0}return!1}return!0}function td(t){var n=t.initializer;if(227===n.kind){var r=n.declarations[0];if(r&&!e.isBindingPattern(r.name))return er(r)}else if(71===n.kind)return jl(n)}function nd(e){return Ss(e,1)&&!Ss(e,0)}function rd(t){var n=ju(t.expression),r=t.argumentExpression;if(!r){var i,s=e.getSourceFileOfNode(t);if(182===t.parent.kind&&t.parent.expression===t)Sm(s,i=e.skipTrivia(s.text,t.expression.end),t.end-i,e.Diagnostics.new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead);else Sm(s,i=t.end-"]".length,t.end-i,e.Diagnostics.Expression_expected);return J}var o=function(t){var n=e.skipParentheses(t);if(71===n.kind){var r=jl(n);if(3&r.flags)for(var i=t,s=t.parent;s;){if(215===s.kind&&i===s.statement&&td(s)===r&&nd(Cp(s.expression)))return!0;i=s,s=s.parent}}return!1}(r)?te:Ip(r);return n===J||n===le?n:op(n)&&9!==r.kind?(ln(r,e.Diagnostics.A_const_enum_member_can_only_be_accessed_using_a_string_literal),J):Vp(Qo(n,o,t),t)}function id(t,n,r){if(n===J)return!1;if(!e.isWellKnownSymbolSyntactically(t))return!1;if(0==(512&n.flags))return r&&ln(t,e.Diagnostics.A_computed_property_name_of_the_form_0_must_be_of_type_symbol,e.getTextOfNode(t)),!1;var i=t.expression,s=jl(i);if(!s)return!1;var o,a=(o=!0,Le||(Le=uo("Symbol",o)));return!!a&&(s===a||(r&&ln(i,e.Diagnostics.Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object),!1))}function sd(t){return e.isCallOrNewExpression(t)}function od(t){return sd(t)&&e.forEach(t.typeArguments,lf),183===t.kind?Ip(t.template):147!==t.kind&&e.forEach(t.arguments,(function(e){Ip(e)})),et}function ad(e){return od(e),tt}function ld(e){for(var t=0;t<e.length;t++){var n=e[t];if(n&&198===n.kind)return t}return-1}function cd(t,n,r,i){var s,o,a;void 0===i&&(i=!1);var l=-1;if(e.isJsxOpeningLikeElement(t))return!0;if(183===t.kind){var c=t;if(s=n.length,o=void 0,196===c.template.kind){var u=c.template,d=e.lastOrUndefined(u.templateSpans);e.Debug.assert(void 0!==d),a=e.nodeIsMissing(d.literal)||!!d.literal.isUnterminated}else{var p=c.template;e.Debug.assert(13===p.kind),a=!!p.isUnterminated}}else if(147===t.kind)o=void 0,s=gd(t,void 0,r);else{var h=t;if(!h.arguments)return e.Debug.assert(182===h.kind),0===r.minArgumentCount;s=i?n.length+1:n.length,a=h.arguments.end===h.end,o=h.typeArguments,l=ld(n)}var f=e.length(r.typeParameters),m=Ds(r.typeParameters);if(!(!o||o.length>=m&&o.length<=f))return!1;if(l>=0)return sl(r,l)||l>=r.minArgumentCount;if(!r.hasRestParameter&&s>r.parameters.length)return!1;var _=s>=r.minArgumentCount;return a||_}function ud(e){if(32768&e.flags){var t=is(e);if(1===t.callSignatures.length&&0===t.constructSignatures.length&&0===t.properties.length&&!t.stringIndexInfo&&!t.numberIndexInfo)return t.callSignatures[0]}}function dd(t,n,r,i){var s=Ol(t,1,i);return Dl(n,t,(function(e,t){$l(s.inferences,Ea(e,r||k),t)})),r||$l(s.inferences,Ms(n),Ms(t),8),$s(t,Gl(s),e.isInJavaScriptFile(n.declaration))}function pd(t,n,r,i,s){for(var o=0,a=s.inferences;o<a.length;o++){var l=a[o];l.isFixed||(l.inferredType=void 0)}if(147!==t.kind){var c=cu(t);if(c){var u=Ea(c,function(e){return e&&function(e){return!!e.signature}(e)?Ol(e.signature,2|e.flags,e.compareTypes,e.inferences):e}(uu(t))),d=ud(u),p=d&&d.typeParameters?Hs($s(d,d.typeParameters,e.isInJavaScriptFile(t))):u,h=Ms(n);$l(s.inferences,p,h,8)}}var f=Ps(n);if(f){var m=md(t),_=m?Ip(m):oe;$l(s.inferences,_,f)}for(var g=gd(t,r,n),y=0;y<g;y++){if(void 0===(T=Td(t,r,y))||200!==T.kind){var b=Ud(n,y),v=vd(t,y);if(void 0===v)v=gp(T,b,i&&void 0!==i[y]?k:s);$l(s.inferences,v,b)}}if(i)for(y=0;y<g;y++)if(!1===i[y]){var T=r[y];b=Ud(n,y);$l(s.inferences,gp(T,b,s),b)}return Gl(s)}function hd(t,n,r,i){for(var s,o=e.isInJavaScriptFile(t.declaration),a=t.typeParameters,l=Os(e.map(n,pa),a,Ds(a),o),c=0;c<n.length;c++){e.Debug.assert(void 0!==a[c],"Should not call checkTypeArguments with too many type arguments");var u=ls(a[c]);if(u){var d=r&&i&&e.chainDiagnosticMessages(void 0,e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1),p=i||e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1;s||(s=_a(a,l));var h=l[c];if(!Ma(h,Ui(Ea(u,s),h),r?n[c]:void 0,p,d))return!1}}return l}function fd(t,n,r,i,s,o){if(e.isJsxOpeningLikeElement(t))return function(t,n,r){if(t.attributes.end===t.end)return!0;for(var i=e.Diagnostics.Argument_of_type_0_is_not_assignable_to_parameter_of_type_1,s=Ud(n,0),o=gp(t.attributes,s,void 0),a=0,l=as(o);a<l.length;a++){var c=l[a];if(!bs(s,c.escapedName)&&xu(c.escapedName))return!1}return Ka(o,s,r,void 0,i)}(t,r,i);var a=Ps(r);if(a&&a!==oe&&182!==t.kind){var l=md(t),c=l?Ip(l):oe,u=o?l||t:void 0,d=e.Diagnostics.The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1;if(!Ka(c,Ps(r),i,u,d))return!1}for(var p=e.Diagnostics.Argument_of_type_0_is_not_assignable_to_parameter_of_type_1,h=gd(t,n,r),f=0;f<h;f++){var m=Td(t,n,f);if(void 0===m||200!==m.kind){var _=Ud(r,f),g=vd(t,f)||gp(m,_,s&&s[f]?k:void 0);if(!Ka(s?xl(g):g,_,i,u=o?kd(t,f,m):void 0,p))return!1}}return!0}function md(e){if(181===e.kind){var t=e.expression;if(179===t.kind)return t.expression;if(180===t.kind)return t.expression}}function _d(t){if(183===t.kind){var n=t.template,r=[void 0];return 196===n.kind&&e.forEach(n.templateSpans,(function(e){r.push(e.expression)})),r}return 147===t.kind?void 0:e.isJsxOpeningLikeElement(t)?t.attributes.properties.length>0?[t.attributes]:e.emptyArray:t.arguments||e.emptyArray}function gd(e,t,n){if(147!==e.kind)return t.length;switch(e.parent.kind){case 229:case 199:return 1;case 149:return 2;case 151:case 153:case 154:return 0===x?2:n.parameters.length>=3?3:2;case 146:return 3}}function yd(t){if(229===t.kind)return li(er(t));if(146===t.kind&&152===(t=t.parent).kind)return li(er(t));return 149===t.kind||151===t.kind||153===t.kind||154===t.kind?function(t){var n=er(t.parent);return e.hasModifier(t,32)?li(n):Oi(n)}(t):(e.Debug.fail("Unsupported decorator target."),J)}function bd(t,n){return 0===n?yd(t.parent):1===n?function(t){if(229===t.kind)return e.Debug.fail("Class decorators should not have a second synthetic argument."),J;if(146===t.kind&&152===(t=t.parent).kind)return z;if(149===t.kind||151===t.kind||153===t.kind||154===t.kind){var n=t;switch(n.name.kind){case 71:return ua(e.idText(n.name));case 8:case 9:return ua(n.name.text);case 144:var r=vu(n.name);return sp(r,512)?r:ee;default:return e.Debug.fail("Unsupported property name."),J}}return e.Debug.fail("Unsupported decorator target."),J}(t.parent):2===n?function(t){return 229===t.kind?(e.Debug.fail("Class decorators should not have a third synthetic argument."),J):146===t.kind?te:149===t.kind?(e.Debug.fail("Property decorators should not have a third synthetic argument."),J):151===t.kind||153===t.kind||154===t.kind?Co(Tf(t)):(e.Debug.fail("Unsupported decorator target."),J)}(t.parent):(e.Debug.fail("Decorators should not have a fourth synthetic argument."),J)}function vd(e,t){return 147===e.kind?bd(e,t):0===t&&183===e.kind?We||(We=ho("TemplateStringsArray",0,!0))||ue:void 0}function Td(e,t,n){if(147!==e.kind&&(0!==n||183!==e.kind))return t[n]}function kd(e,t,n){return 147===e.kind?e.expression:0===t&&183===e.kind?e.template:n}function Ed(t,n,i,s){var o,a=183===t.kind,l=147===t.kind,c=e.isJsxOpeningLikeElement(t);a||l||c||(o=t.typeArguments,97!==t.expression.kind&&e.forEach(o,lf));var u=i||[];if(function(t,n){var r,i,s,o,a=0,l=-1;e.Debug.assert(!n.length);for(var c=0,u=t;c<u.length;c++){var d=u[c],p=d.declaration&&er(d.declaration),h=d.declaration&&d.declaration.parent;i&&p!==i?(s=a=n.length,r=h):r&&h===r?s++:(r=h,s=a),i=p,d.hasLiteralTypes?(o=++l,a++):o=s,n.splice(o,0,d)}}(n,u),!u.length)return wt.add(e.createDiagnosticForNode(t,e.Diagnostics.Call_target_does_not_contain_any_signatures)),ad(t);var d,p,h,f,m=_d(t),_=1===u.length&&!u[0].typeParameters,g=0;if(!l&&!_)for(var y=a?1:0;y<m.length;y++)Sa(m[y])&&(d||(d=new Array(m.length)),d[y]=!0,g++);var b=i&&181===t.kind&&t.arguments.hasTrailingComma;if(u.length>1&&(f=$(u,Zt,b)),f||(f=$(u,en,b)),f)return f;if(p){if(c)return p;fd(t,m,p,en,void 0,!0)}else if(h)hd(h,t.typeArguments,!0,s);else if(o&&e.every(n,(function(t){return e.length(t.typeParameters)!==o.length}))){for(var v=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,k=0,E=n;k<E.length;k++){var x=E[k];v=Math.min(v,Ds(x.typeParameters)),T=Math.max(T,e.length(x.typeParameters))}var S=v<T?v+"-"+T:v;wt.add(e.createDiagnosticForNode(t,e.Diagnostics.Expected_0_type_arguments_but_got_1,S,o.length))}else if(m){v=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(var C=0,I=n;C<I.length;C++){x=I[C];v=Math.min(v,x.minArgumentCount),T=Math.max(T,x.parameters.length)}var A=e.some(n,(function(e){return e.hasRestParameter})),w=ld(m)>-1,N=(S=A?v:v<T?v+"-"+T:v,m.length-(w?1:0)),D=A&&w?e.Diagnostics.Expected_at_least_0_arguments_but_got_a_minimum_of_1:A?e.Diagnostics.Expected_at_least_0_arguments_but_got_1:w?e.Diagnostics.Expected_0_arguments_but_got_a_minimum_of_1:e.Diagnostics.Expected_0_arguments_but_got_1;wt.add(e.createDiagnosticForNode(t,D,S,N))}else s&&wt.add(e.createDiagnosticForNode(t,s));if(!r){e.Debug.assert(u.length>0);var O=function(e,t){for(var n=-1,r=-1,i=0;i<e.length;i++){var s=e[i];if(s.hasRestParameter||s.parameters.length>=t)return i;s.parameters.length>r&&(r=s.parameters.length,n=i)}return n}(u,void 0===P?m.length:P),R=u[O],L=R.typeParameters;if(L&&sd(t)&&t.typeArguments){for(var M=t.typeArguments.map(Tf);M.length>L.length;)M.pop();for(;M.length<L.length;)M.push(Hl(e.isInJavaScriptFile(t)));var F=Bs(R,M);return u[O]=F,F}return R}return ad(t);function $(n,r,i){if(void 0===i&&(i=!1),p=void 0,h=void 0,_){var s=n[0];if(!cd(t,m,s,i))return;return fd(t,m,s,r,d,!1)?s:void(p=s)}for(var a=0;a<n.length;a++){var l=n[a];if(cd(t,m,l,i)){s=void 0;for(var c=l.typeParameters?Ol(l,e.isInJavaScriptFile(t)?4:0):void 0;;){if((s=l).typeParameters){var u=void 0;if(o){var f=hd(s,o,!1);if(!f){h=l;break}u=f}else u=pd(t,s,m,d,c);s=$s(s,u,e.isInJavaScriptFile(s.declaration))}if(!fd(t,m,s,r,d,!1)){p=s;break}if(0===g)return n[a]=s,s;--g>0?d[e.indexOf(d,!0)]=!1:d=void 0}}}}}function xd(e,t,n,r){return!!Gr(e)||(!!(Gr(t)&&16384&e.flags)||!n&&!r&&(!(65536&e.flags)&&Ra(e,Ee)))}function Sd(t,n){if(t.arguments&&x<1){var r=ld(t.arguments);r>=0&&ln(t.arguments[r],e.Diagnostics.Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher)}var i=ju(t.expression);if(i===le)return rt;if((i=ms(i))===J)return ad(t);if(Gr(i))return t.typeArguments&&ln(t,e.Diagnostics.Untyped_function_calls_may_not_accept_type_arguments),od(t);var s=Ts(i,1);if(s.length){if(!function(t,n){if(!n||!n.declaration)return!0;var r=n.declaration,i=e.getSelectedModifierFlags(r,24);if(!i)return!0;var s=Wh(r.parent.symbol),o=Oi(r.parent.symbol);if(!gf(t,s)){var a=e.getContainingClass(t);if(a)for(var l=Ei(Tf(a));l.length;){var c=l[0];if(16&i&&c.symbol===r.parent.symbol)return!0;l=Ei(c)}return 8&i&&ln(t,e.Diagnostics.Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration,Cr(o)),16&i&&ln(t,e.Diagnostics.Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration,Cr(o)),!1}return!0}(t,s[0]))return ad(t);var o=i.symbol&&Wh(i.symbol);return o&&e.hasModifier(o,128)?(ln(t,e.Diagnostics.Cannot_create_an_instance_of_the_abstract_class_0,e.declarationNameToString(e.getNameOfDeclaration(o))),ad(t)):Ed(t,s,n)}var a=Ts(i,0);if(a.length){var l=Ed(t,a,n);return Od(l.declaration)||Ms(l)===oe||ln(t,e.Diagnostics.Only_a_void_function_can_be_called_with_the_new_keyword),Ps(l)===oe&&ln(t,e.Diagnostics.A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void),l}return ln(t,e.Diagnostics.Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature),ad(t)}function Cd(t){switch(t.parent.kind){case 229:case 199:return e.Diagnostics.Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression;case 146:return e.Diagnostics.Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression;case 149:return e.Diagnostics.Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression;case 151:case 153:case 154:return e.Diagnostics.Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression}}function Id(t,n){var r=Ip(t.expression),i=ms(r);if(i===J)return ad(t);var s,o,a=Ts(i,0),l=Ts(i,1);if(xd(r,i,a.length,l.length))return od(t);if(s=t,(o=a).length&&e.every(o,(function(e){return 0===e.minArgumentCount&&!e.hasRestParameter&&e.parameters.length<gd(s,void 0,e)}))){var c=e.getTextOfNode(t.expression,!1);return ln(t,e.Diagnostics._0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0,c),ad(t)}var u=Cd(t);if(!a.length){var d=void 0;return d=e.chainDiagnosticMessages(d,e.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,Cr(i)),d=e.chainDiagnosticMessages(d,u),wt.add(e.createDiagnosticForNodeFromMessageChain(t,d)),ad(t)}return Ed(t,a,n,u)}function Ad(t,n,r){return e.Debug.assert(!(65536&n.flags)),wd(t,n,r)}function wd(e,t,n){if(65536&t.flags){for(var r=void 0,i=0,s=t.types;i<s.length;i++){var o=s[i];r=r||wd(e,o,n)}return r}var a=t&&Ts(t,0);if(a&&a.length>0)return Ed(e,a,n)}function Nd(t,n){switch(t.kind){case 181:return function(t,n){if(97===t.expression.kind){var r=Yc(t.expression);if(r!==J){var i=e.getClassExtendsHeritageClauseElement(e.getContainingClass(t));if(i)return Ed(t,Ti(r,i.typeArguments,i),n)}return od(t)}var s=ju(t.expression);if(s===le)return rt;var o=ms(s);if(o===J)return ad(t);var a=Ts(o,0),l=Ts(o,1);return xd(s,o,a.length,l.length)?(s!==J&&t.typeArguments&&ln(t,e.Diagnostics.Untyped_function_calls_may_not_accept_type_arguments),od(t)):a.length?Ed(t,a,n):(l.length?ln(t,e.Diagnostics.Value_of_type_0_is_not_callable_Did_you_mean_to_include_new,Cr(s)):ln(t,e.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,Cr(o)),ad(t))}(t,n);case 182:return Sd(t,n);case 183:return function(t,n){var r=Ip(t.tag),i=ms(r);if(i===J)return ad(t);var s=Ts(i,0),o=Ts(i,1);return xd(r,i,s.length,o.length)?od(t):s.length?Ed(t,s,n):(ln(t,e.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,Cr(i)),ad(t))}(t,n);case 147:return Id(t,n);case 251:case 250:return wd(t,Ip(t.tagName),n)||tt}e.Debug.assertNever(t,"Branch in 'resolveSignature' should be unreachable.")}function Dd(e,t){var n=gn(e),r=n.resolvedSignature;if(r&&r!==nt&&!t)return r;n.resolvedSignature=nt;var i=Nd(e,t);return n.resolvedSignature=at===lt?i:r,i}function Od(t){if(t&&e.isInJavaScriptFile(t)){if(e.getJSDocClassTag(t))return!0;var n=e.isFunctionDeclaration(t)||e.isFunctionExpression(t)?er(t):e.isVariableDeclaration(t)&&t.initializer&&e.isFunctionExpression(t.initializer)?er(t.initializer):void 0;return n&&void 0!==n.members}return!1}function Rd(t){var n=_n(t);return n.inferredClassType||(n.inferredClassType=dr(t,t.members||T,e.emptyArray,e.emptyArray,void 0,void 0)),n.inferredClassType}function Ld(e){return e.symbol&&16&yn(e)&&_n(e.symbol).inferredClassType===e}function Pd(t){am(t,t.typeArguments)||lm(t.arguments);var n=Dd(t);if(97===t.expression.kind)return oe;if(182===t.kind){var r=n.declaration;if(r&&152!==r.kind&&156!==r.kind&&161!==r.kind&&!e.isJSDocConstructSignature(r)){var i=Ip(t.expression).symbol;i||71!==t.expression.kind||(i=jl(t.expression));var s=i&&function(t){if(e.isDeclarationOfFunctionOrClassExpression(t)&&(t=er(t.valueDeclaration.initializer)),Od(t.valueDeclaration))return Rd(t);if(3&t.flags){var n=li(t);if(n.symbol&&!Ld(n)&&Od(n.symbol.valueDeclaration))return Rd(n.symbol)}}(i);return s||(N&&ln(t,e.Diagnostics.new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type),z)}}return e.isInJavaScriptFile(t)&&function(t){if(!e.isRequireCall(t,!0))return!1;if(!e.isIdentifier(t.expression))throw e.Debug.fail();var n=kn(t.expression,t.expression.escapedText,107455,void 0,void 0,!0);if(!n)return!0;if(2097152&n.flags)return!1;var r=16&n.flags?228:3&n.flags?226:0;if(0!==r){var i=e.getDeclarationOfKind(n,r);return e.isInAmbientContext(i)}return!1}(t)?function(e){var t=Hn(e,e);if(t){var n=Kn(t);if(n)return li(n)}return z}(t.arguments[0]):Ms(n)}function Md(t){if(lm(t.arguments)||function(t){if(S===e.ModuleKind.ES2015)return Cm(t,e.Diagnostics.Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules);if(t.typeArguments)return Cm(t,e.Diagnostics.Dynamic_import_cannot_have_type_arguments);var n=t.arguments;if(1!==n.length)return Cm(t,e.Diagnostics.Dynamic_import_must_have_one_specifier_as_an_argument);if(e.isSpreadElement(n[0]))Cm(n[0],e.Diagnostics.Specifier_of_dynamic_import_cannot_be_spread_element)}(t),0===t.arguments.length)return Kd(t,z);for(var n=t.arguments[0],r=yp(n),i=1;i<t.arguments.length;++i)yp(t.arguments[i]);(2048&r.flags||4096&r.flags||!Ra(r,ee))&&ln(n,e.Diagnostics.Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0,Cr(r));var s=Hn(t,n);if(s){var o=Wn(s,n,!0);if(o)return Kd(t,function(t,n){if(I&&t&&t!==J){var r=t;if(!r.syntheticType)if(bs(t,"default"))r.syntheticType=t;else{var i=e.createSymbolTable(),s=cn(2097152,"default");s.target=Pn(n),i.set("default",s);var o=cn(2048,"__type"),a=dr(o,i,e.emptyArray,e.emptyArray,void 0,void 0);o.type=a,r.syntheticType=jo([t,a])}return r.syntheticType}return t}(li(o),o))}return Kd(t,z)}function Fd(t,n,i,s){var o=xl(pl(Ip(i,s)));lf(n);var a=pa(n);r&&a!==J&&(Pa(a,Il(o))||Fa(o,a,t,e.Diagnostics.Type_0_cannot_be_converted_to_type_1));return a}function $d(t){!function(t){if(94===t.keywordToken&&"target"!==t.name.escapedText)Cm(t.name,e.Diagnostics._0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2,t.name.escapedText,e.tokenToString(t.keywordToken),"target")}(t);var n=e.getNewTargetContainer(t);return n?152===n.kind?li(er(n.parent)):li(er(n)):(ln(t,e.Diagnostics.Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constructor,"new.target"),J)}function Bd(e){var t=li(e);if(A){var n=e.valueDeclaration;if(n&&n.initializer)return vl(t,2048)}return t}function Ud(e,t){return e.hasRestParameter?t<e.parameters.length-1?Bd(e.parameters[t]):Fs(e):t<e.parameters.length?Bd(e.parameters[t]):z}function Vd(e){return e.parameters.length>0?Ud(e,0):ae}function Hd(t){for(var n=0,r=t.elements;n<r.length;n++){var i=r[n];e.isOmittedExpression(i)||(71===i.name.kind?_n(er(i)).type=zr(i):Hd(i.name))}}function Gd(e,t){var n=_n(e);if(!n.type){n.type=t;var r=e.valueDeclaration;71!==r.name.kind&&(n.type===ue&&(n.type=Zr(r.name)),Hd(r.name))}}function jd(e){var t=mo(!0);return t!==he?Xs(t,[e=Jp(e)||ue]):ue}function Kd(t,n){var r=jd(n);return r===ue?(ln(t,e.isImportCall(t)?e.Diagnostics.A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:e.Diagnostics.An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option),J):(_o(!0)||ln(t,e.isImportCall(t)?e.Diagnostics.A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:e.Diagnostics.An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option),r)}function Wd(t,n){var r=hu(t);if(!t.body)return J;var i,s=e.getFunctionFlags(t);if(207!==t.body.kind)i=yp(t.body,n),2&s&&(i=qp(i,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member));else{var o=void 0;if(1&s){if(!(o=e.concatenate(function(t,n){var r=[],i=e.getFunctionFlags(t);return e.forEachYieldExpression(t.body,(function(t){var s=t.expression;if(s){var o=yp(s,n);t.asteriskToken&&(o=Nh(o,t.expression,!1,0!=(2&i))),2&i&&(o=qp(o,s,t.asteriskToken?e.Diagnostics.Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:e.Diagnostics.Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)),e.pushIfUnique(r,o)}})),r}(t,n),Jd(t,n)))||0===o.length){var a=2&s?Io(z):wo(z);return N&&ln(t.asteriskToken,e.Diagnostics.Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_type,Cr(a)),a}}else{if(!(o=Jd(t,n)))return 2&s?Kd(t,ae):ae;if(0===o.length)return 2&s?Kd(t,oe):oe}i=Uo(o,!0),1&s&&(i=2&s?Io(i):wo(i))}r||Nl(t,i),!ul(i)||r&&Tp(r===Rs(t)?i:Ms(r))||(i=hl(i));var l=Il(i);return 2==(3&s)?Kd(t,l):l}function zd(t){if(!t.possiblyExhaustive)return!1;var n=Cp(t.expression);if(!dl(n))return!1;var r,i,s=_c(t);return!!s.length&&(r=vc(n,ca),i=s,65536&r.flags?!e.forEach(r.types,(function(t){return!e.contains(i,t)})):e.contains(i,r))}function qd(t){if(!(128&t.flags))return!1;var n=e.lastOrUndefined(t.body.statements);return!n||221!==n.kind||!zd(n)}function Jd(t,n){var r=e.getFunctionFlags(t),i=[],s=qd(t),o=!1;if(e.forEachReturnStatement(t.body,(function(a){var l=a.expression;if(l){var c=yp(l,n);2&r&&(c=qp(c,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)),8192&c.flags&&(o=!0),e.pushIfUnique(i,c)}else s=!0})),0!==i.length||s||!o&&186!==t.kind&&187!==t.kind)return A&&i.length&&s&&e.pushIfUnique(i,Y),i}function Yd(t,n){if(r&&(!n||!ip(n,1025))&&!e.nodeIsMissing(t.body)&&207===t.body.kind&&qd(t)){var i=256&t.flags;if(n&&8192&n.flags)ln(e.getEffectiveReturnTypeNode(t),e.Diagnostics.A_function_returning_never_cannot_have_a_reachable_end_point);else if(n&&!i)ln(e.getEffectiveReturnTypeNode(t),e.Diagnostics.A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value);else if(n&&A&&!Ra(Y,n))ln(e.getEffectiveReturnTypeNode(t),e.Diagnostics.Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined);else if(E.noImplicitReturns){if(!n){if(!i)return;if(Fh(t,Ms(Rs(t))))return}ln(e.getEffectiveReturnTypeNode(t)||t,e.Diagnostics.Not_all_code_paths_return_a_value)}}}function Xd(t,n){if(e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t)),1===n&&Sa(t))return cf(t),fe;om(t)||186!==t.kind||pm(t);var i=gn(t),s=li(t.symbol);if(!(1024&i.flags)){var o=mu(t);if(!(1024&i.flags)){if(i.flags|=1024,o){var a=Ts(s,0)[0];if(Sa(t)){var l=uu(t);2===n&&function(t,n,r){for(var i=t.parameters.length-(t.hasRestParameter?1:0),s=0;s<i;s++){var o=t.parameters[s].valueDeclaration;if(o.type){var a=e.getEffectiveTypeAnnotationNode(o);a&&$l(r.inferences,pa(a),Ud(n,s))}}}(a,o,l),function(t,n){t.typeParameters=n.typeParameters,n.thisParameter&&(!(s=t.thisParameter)||s.valueDeclaration&&!s.valueDeclaration.type)&&(s||(t.thisParameter=El(n.thisParameter,void 0)),Gd(t.thisParameter,li(n.thisParameter)));for(var r=t.parameters.length-(t.hasRestParameter?1:0),i=0;i<r;i++){var s=t.parameters[i];e.getEffectiveTypeAnnotationNode(s.valueDeclaration)||Gd(s,Ud(n,i))}t.hasRestParameter&&sl(n,t.parameters.length-1)&&(!un(s=e.lastOrUndefined(t.parameters))&&e.getEffectiveTypeAnnotationNode(s.valueDeclaration)||Gd(s,li(e.lastOrUndefined(n.parameters))))}(a,l===k?o:ba(o,l))}if(!e.getEffectiveReturnTypeNode(t)&&!a.resolvedReturnType){var c=Wd(t,n);a.resolvedReturnType||(a.resolvedReturnType=c)}}Op(t),cf(t)}}return r&&151!==t.kind&&(yh(t,t.name),fh(t,t.name),mh(t,t.name)),s}function Qd(t){e.Debug.assert(151!==t.kind||e.isObjectLiteralMethod(t));var n=e.getFunctionFlags(t),r=e.getEffectiveReturnTypeNode(t),i=r&&(2==(3&n)?Yp(t):pa(r));if(0==(1&n)&&Yd(t,i),t.body){if(r||Ms(Rs(t)),207===t.body.kind)lf(t.body);else{var s=Ip(t.body);if(i)if(2==(3&n))Ma(qp(s,t.body,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member),i,t.body);else Ma(s,i,t.body)}sh(t)}}function Zd(e,t,n){return!!sp(t,84)||(ln(e,n),!1)}function ep(t){return!!(8&e.getCheckFlags(t)||4&t.flags&&64&e.getDeclarationModifierFlagsFromSymbol(t)||3&t.flags&&2&Vu(t)||98304&t.flags&&!(65536&t.flags)||8&t.flags)}function tp(t,n){if(ep(n)){if(4&n.flags&&(179===t.kind||180===t.kind)&&99===t.expression.kind){var r=e.getContainingFunction(t);return!r||152!==r.kind||!(r.parent===n.valueDeclaration.parent||r===n.valueDeclaration.parent)}return!0}return!1}function np(t){if(179===t.kind||180===t.kind){var n=e.skipParentheses(t.expression);if(71===n.kind){var r=gn(n).resolvedSymbol;if(2097152&r.flags){var i=Nn(r);return i&&240===i.kind}}}return!1}function rp(t,n){var r=e.skipOuterExpressions(t,3);return 71===r.kind||179===r.kind||180===r.kind||(ln(t,n),!1)}function ip(e,t){if(e.flags&t)return!0;if(196608&e.flags)for(var n=0,r=e.types;n<r.length;n++){if(ip(r[n],t))return!0}return!1}function sp(e,t,n){return!!(e.flags&t)||!(n&&7169&e.flags)&&(84&t&&Ra(e,te)||262178&t&&Ra(e,ee)||136&t&&Ra(e,ie)||1024&t&&Ra(e,oe)||8192&t&&Ra(e,ae)||4096&t&&Ra(e,Q)||2048&t&&Ra(e,Y)||512&t&&Ra(e,se)||16777216&t&&Ra(e,ce))}function op(e){return 16&yn(e)&&e.symbol&&ap(e.symbol)}function ap(e){return 0!=(128&e.flags)}function lp(t,n,r){if(261===n.kind||262===n.kind){var i=n.name;if(144===i.kind&&vu(i),Kr(i))return;var s=e.getTextOfPropertyName(i);if(l=Gr(t)?t:Hr(t,s)||bu(s)&&Ss(t,1)||Ss(t,0))return 262===n.kind?up(n,l):up(n.initializer,l);ln(i,e.Diagnostics.Type_0_has_no_property_1_and_no_string_index_signature,Cr(t),e.declarationNameToString(i))}else{if(263===n.kind){x<5&&Zf(n,4);var o=[];if(r)for(var a=0;a<r.length-1;a++)o.push(r[a].name);var l=Wr(t,o,t.symbol);return up(n.expression,l)}ln(n,e.Diagnostics.Property_assignment_expected)}}function cp(t,n,r,i,s){var o=t.elements,a=o[r];if(200!==a.kind)if(198!==a.kind){var l=""+r,c=Gr(n)?n:cl(n)?Hr(n,l):i;if(c)return up(a,c,s);Ip(a),fl(n)?ln(a,e.Diagnostics.Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2,Cr(n),Zs(n),o.length):ln(a,e.Diagnostics.Type_0_has_no_property_1,Cr(n),l)}else if(r<o.length-1)ln(a,e.Diagnostics.A_rest_element_must_be_last_in_a_destructuring_pattern);else{var u=a.expression;if(194!==u.kind||58!==u.operatorToken.kind)return up(u,No(i),s);ln(u.operatorToken,e.Diagnostics.A_rest_element_cannot_have_an_initializer)}}function up(t,n,r){var i;if(262===t.kind){var s=t;s.objectAssignmentInitializer&&(!A||2048&_l(Ip(s.objectAssignmentInitializer))||(n=nc(n,131072)),mp(s.name,s.equalsToken,s.objectAssignmentInitializer,r)),i=t.name}else i=t;return 194===i.kind&&58===i.operatorToken.kind&&(fp(i,r),i=i.left),178===i.kind?function(e,t){for(var n=e.properties,r=0,i=n;r<i.length;r++)lp(t,i[r],n);return t}(i,n):177===i.kind?function(e,t,n){x<2&&E.downlevelIteration&&Zf(e,512);for(var r=Nh(t,e,!1,!1)||J,i=e.elements,s=0;s<i.length;s++)cp(e,t,s,r,n);return t}(i,n,r):function(t,n,r){var i=Ip(t,r),s=263===t.parent.kind?e.Diagnostics.The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access:e.Diagnostics.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access;rp(t,s)&&Ma(n,i,t,void 0);return n}(i,n,r)}function dp(t){switch((t=e.skipParentheses(t)).kind){case 71:case 9:case 12:case 183:case 196:case 13:case 8:case 101:case 86:case 95:case 139:case 186:case 199:case 187:case 177:case 178:case 189:case 203:case 250:case 249:return!0;case 195:return dp(t.whenTrue)&&dp(t.whenFalse);case 194:return!e.isAssignmentOperator(t.operatorToken.kind)&&(dp(t.left)&&dp(t.right));case 192:case 193:switch(t.operator){case 51:case 37:case 38:case 52:return!0}return!1;case 190:case 184:case 202:default:return!1}}function pp(e,t){return 0!=(6144&t.flags)||Pa(e,t)}function hp(e,t){var n=Ra(e,t),r=Ra(t,e);return r&&!n?e:n&&!r?t:Uo([e,t],!0)}function fp(e,t){return mp(e.left,e.operatorToken,e.right,t,e)}function mp(t,n,i,s,o){var a=n.kind;if(58===a&&(178===t.kind||177===t.kind))return up(t,Ip(i,s),s);var l,c=Ip(t,s),u=Ip(i,s);switch(a){case 39:case 40:case 61:case 62:case 41:case 63:case 42:case 64:case 38:case 60:case 45:case 65:case 46:case 66:case 47:case 67:case 49:case 69:case 50:case 70:case 48:case 68:if(c===le||u===le)return le;c=Ku(c,t),u=Ku(u,i);var d=void 0;if(136&c.flags&&136&u.flags&&void 0!==(d=function(e){switch(e){case 49:case 69:return 54;case 50:case 70:return 35;case 48:case 68:return 53;default:return}}(n.kind)))ln(o||n,e.Diagnostics.The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead,e.tokenToString(n.kind),e.tokenToString(d));else{var p=Zd(t,c,e.Diagnostics.The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type),h=Zd(i,u,e.Diagnostics.The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type);p&&h&&y(te)}return te;case 37:case 59:if(c===le||u===le)return le;sp(c,262178)||sp(u,262178)||(c=Ku(c,t),u=Ku(u,i));var f=void 0;return sp(c,84,!0)&&sp(u,84,!0)?f=te:sp(c,262178,!0)||sp(u,262178,!0)?f=ee:(Gr(c)||Gr(u))&&(f=c===J||u===J?J:z),f&&!g(a)?f:f?(59===a&&y(f),f):(b(),z);case 27:case 29:case 30:case 31:return g(a)&&(c=pl(Ku(c,t)),u=pl(Ku(u,i)),Pa(c,u)||Pa(u,c)||b()),ie;case 32:case 33:case 34:case 35:var m=dl(c),_=dl(u);return m&&_||(c=m?pl(c):c,u=_?pl(u):u),pp(c,u)||pp(u,c)||b(),ie;case 93:return function(t,n,r,i){return r===le||i===le?le:(!Gr(r)&&sp(r,8190)&&ln(t,e.Diagnostics.The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_parameter),Gr(i)||Ts(i,0).length||Ts(i,1).length||Oa(i,Ee)||ln(n,e.Diagnostics.The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_Function_interface_type),ie)}(t,i,c,u);case 92:return function(t,n,r,i){return r===le||i===le?le:(r=Ku(r,t),i=Ku(i,n),Pa(r,ee)||sp(r,596)||ln(t,e.Diagnostics.The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol),sp(i,17317888)||ln(n,e.Diagnostics.The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter),ie)}(t,i,c,u);case 53:return 1048576&tc(c)?Uo([yl(A?c:pl(u)),u]):c;case 54:return 2097152&tc(c)?hp(gl(c),u):c;case 58:return y(u),xl(u);case 26:return!E.allowUnreachableCode&&dp(t)&&(71!==(l=i).kind||"eval"!==l.escapedText)&&ln(t,e.Diagnostics.Left_side_of_comma_operator_is_unused_and_has_no_side_effects),u}function g(n){var r=ip(c,512)?t:ip(u,512)?i:void 0;return!r||(ln(r,e.Diagnostics.The_0_operator_cannot_be_applied_to_type_symbol,e.tokenToString(n)),!1)}function y(n){r&&e.isAssignmentOperator(a)&&rp(t,e.Diagnostics.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access)&&Ma(n,c,t,void 0)}function b(){ln(o||n,e.Diagnostics.Operator_0_cannot_be_applied_to_types_1_and_2,e.tokenToString(n.kind),Cr(c),Cr(u))}}function _p(t){if(r&&(4096&t.flags&&!function(t){for(var n=t,r=t.parent;r;){if(e.isFunctionLike(r)&&n===r.body)return!1;if(e.isClassLike(n))return!0;n=r,r=r.parent}return!1}(t)||xm(t,e.Diagnostics.A_yield_expression_is_only_allowed_in_a_generator_body),tu(t)&&ln(t,e.Diagnostics.yield_expressions_cannot_be_used_in_a_parameter_initializer)),t.expression){var n=e.getContainingFunction(t),i=n&&e.getFunctionFlags(n);if(t.asteriskToken&&(3==(3&i)&&x<5&&Zf(t,26624),1==(3&i)&&x<2&&E.downlevelIteration&&Zf(t,256)),1&i){var s=yp(t.expression),o=void 0,a=!!t.asteriskToken;a&&(o=Nh(s,t.expression,!1,0!=(2&i)));var l=e.getEffectiveReturnTypeNode(n);if(l){var c=Lh(pa(l),0!=(2&i))||z;Ma(a?2&i?Jp(o,t.expression,e.Diagnostics.Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):o:2&i?Jp(s,t.expression,e.Diagnostics.Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):s,c,t.expression,void 0)}}}return z}function gp(e,t,n){var r=e.contextualType,i=e.contextualMapper;e.contextualType=t,e.contextualMapper=n;var s=Ip(e,n===k?1:n?2:0);return e.contextualType=r,e.contextualMapper=i,s}function yp(e,t){var n=gn(e);if(!n.resolvedType){var r=at;at=lt,n.resolvedType=Ip(e,t),at=r}return n.resolvedType}function bp(t){return 184===(t=e.skipParentheses(t)).kind||202===t.kind}function vp(t){var n=Cp(t.initializer,!0);return 2&e.getCombinedNodeFlags(t)||64&e.getCombinedModifierFlags(t)&&!e.isParameterPropertyDeclaration(t)||bp(t.initializer)?n:hl(n)}function Tp(e){if(e){if(540672&e.flags){var t=us(e)||ue;if(30&t.flags)return!0;e=t}return ip(e,262368)}return!1}function kp(e,t,n){2===arguments.length&&(n=cu(e));var r=Ip(e,t),i=bp(e)||Tp(n);return i?r:hl(r)}function Ep(e,t){return 144===e.name.kind&&vu(e.name),kp(e.initializer,t)}function xp(e,t){return gm(e),144===e.name.kind&&vu(e.name),Sp(e,Xd(e,t),t)}function Sp(e,t,n){if(2===n){var r=ud(t);if(r&&r.typeParameters){var i=lu(e);if(i){var s=ud(Tl(i));if(s&&!s.typeParameters)return Hs(dd(r,s,uu(e)))}}}return t}function Cp(t,n){if(181===t.kind&&97!==t.expression.kind&&!e.isRequireCall(t,!0)){var r=ud(ju(t.expression));if(r&&!r.typeParameters)return Ms(r)}return n?yp(t):Ip(t)}function Ip(t,n){var i;143===t.kind?i=zu(t):i=Sp(t,function(t,n){switch(t.kind){case 71:return Hc(t);case 99:return qc(t);case 97:return Yc(t);case 95:return Z;case 13:case 9:return la(ua(t.text));case 8:return wm(t),la(ua(+t.text));case 101:return ne;case 86:return re;case 196:return function(t){return e.forEach(t.templateSpans,(function(e){Ip(e.expression)})),ee}(t);case 12:return we;case 177:return gu(t,n);case 178:return ku(t,n);case 179:return Wu(t);case 180:return rd(t);case 181:if(91===t.expression.kind)return Md(t);case 182:return Pd(t);case 183:return function(e){return x<2&&Zf(e,65536),Ms(Dd(e))}(t);case 185:return function(t,n){var r=e.isInJavaScriptFile(t)?e.getJSDocTypeTag(t):void 0;if(r)return Fd(r,r.typeExpression.type,t.expression,n);return Ip(t.expression,n)}(t,n);case 199:return function(e){return jh(e),cf(e),li(er(e))}(t);case 186:case 187:return Xd(t,n);case 189:return function(e){return Ip(e.expression),Vt}(t);case 184:case 202:return function(e){return Fd(e,e.type,e.expression)}(t);case 203:return function(e){return Tl(Ip(e.expression))}(t);case 204:return $d(t);case 188:return function(t){Ip(t.expression);var n=e.skipParentheses(t.expression);if(179!==n.kind&&180!==n.kind)return ln(n,e.Diagnostics.The_operand_of_a_delete_operator_must_be_a_property_reference),ie;var r=nr(gn(n).resolvedSymbol);return r&&ep(r)&&ln(n,e.Diagnostics.The_operand_of_a_delete_operator_cannot_be_a_read_only_property),ie}(t);case 190:return function(e){return Ip(e.expression),X}(t);case 191:return function(t){return r&&(16384&t.flags||xm(t,e.Diagnostics.await_expression_is_only_allowed_within_an_async_function),tu(t)&&ln(t,e.Diagnostics.await_expressions_cannot_be_used_in_a_parameter_initializer)),qp(Ip(t.expression),t,e.Diagnostics.Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)}(t);case 192:return function(t){var n=Ip(t.operand);if(n===le)return le;if(8===t.operand.kind){if(38===t.operator)return la(ua(-t.operand.text));if(37===t.operator)return la(ua(+t.operand.text))}switch(t.operator){case 37:case 38:case 52:return Ku(n,t.operand),ip(n,512)&&ln(t.operand,e.Diagnostics.The_0_operator_cannot_be_applied_to_type_symbol,e.tokenToString(t.operator)),te;case 51:var r=3145728&tc(n);return 1048576===r?re:2097152===r?ne:ie;case 43:case 44:return Zd(t.operand,Ku(n,t.operand),e.Diagnostics.An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type)&&rp(t.operand,e.Diagnostics.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access),te}return J}(t);case 193:return function(t){var n=Ip(t.operand);return n===le?le:(Zd(t.operand,Ku(n,t.operand),e.Diagnostics.An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type)&&rp(t.operand,e.Diagnostics.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access),te)}(t);case 194:return fp(t,n);case 195:return function(e,t){return Ip(e.condition),hp(Ip(e.whenTrue,t),Ip(e.whenFalse,t))}(t,n);case 198:return function(e,t){return x<2&&E.downlevelIteration&&Zf(e,1536),Nh(Ip(e.expression,t),e.expression,!1,!1)}(t,n);case 200:return X;case 197:return _p(t);case 256:return function(t,n){if(t.expression){var r=Ip(t.expression,n);return t.dotDotDotToken&&r!==z&&!al(r)&&ln(t,e.Diagnostics.JSX_spread_child_must_be_an_array_type),r}return J}(t,n);case 249:return function(e){return Bu(e.openingElement),Su(e.closingElement.tagName)?Au(e.closingElement):Ip(e.closingElement.tagName),Fu()||z}(t);case 250:return function(e){return Bu(e),Fu()||z}(t);case 254:return function(e,t){return Cu(e.parent,void 0,t)}(t,n);case 251:e.Debug.fail("Shouldn't ever directly check a JsxOpeningElement")}return J}(t,n),n);op(i)&&(179===t.parent.kind&&t.parent.expression===t||180===t.parent.kind&&t.parent.expression===t||(71===t.kind||143===t.kind)&&yf(t)||ln(t,e.Diagnostics.const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_import_declaration_or_export_assignment));return i}function Ap(t){t.expression&&xm(t.expression,e.Diagnostics.Type_expected),lf(t.constraint),lf(t.default);var n=Di(er(t));ds(n)||ln(t.constraint,e.Diagnostics.Type_parameter_0_has_a_circular_constraint,Cr(n)),function(e){return hs(e)!==_e}(n)||ln(t.default,e.Diagnostics.Type_parameter_0_has_a_circular_default,Cr(n));var i=ls(n),s=fs(n);i&&s&&Ma(s,Ui(i,s),t.default,e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1),r&&Uh(t.name,e.Diagnostics.Type_parameter_name_cannot_be_0)}function wp(t){tm(t)||nm(t),Eh(t);var n=e.getContainingFunction(t);e.hasModifier(t,92)&&(152===n.kind&&e.nodeIsPresent(n.body)||ln(t,e.Diagnostics.A_parameter_property_is_only_allowed_in_a_constructor_implementation)),t.questionToken&&e.isBindingPattern(t.name)&&n.body&&ln(t,e.Diagnostics.A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature),t.name&&e.isIdentifier(t.name)&&("this"===t.name.escapedText||"new"===t.name.escapedText)&&(0!==e.indexOf(n.parameters,t)&&ln(t,e.Diagnostics.A_0_parameter_must_be_the_first_parameter,t.name.escapedText),152!==n.kind&&156!==n.kind&&161!==n.kind||ln(t,e.Diagnostics.A_constructor_cannot_have_a_this_parameter)),!t.dotDotDotToken||e.isBindingPattern(t.name)||al(li(t.symbol))||ln(t,e.Diagnostics.A_rest_parameter_must_be_of_an_array_type)}function Np(e,t){if(e)for(var n=0;n<e.length;n++){var r=e[n];if(71===r.name.kind&&r.name.escapedText===t.escapedText)return n}return-1}function Dp(t,n,r){for(var i=0,s=t.elements;i<s.length;i++){var o=s[i];if(!e.isOmittedExpression(o)){var a=o.name;if(71===a.kind&&a.escapedText===r)return ln(n,e.Diagnostics.A_type_predicate_cannot_reference_element_0_in_a_binding_pattern,r),!0;if((175===a.kind||174===a.kind)&&Dp(a,n,r))return!0}}}function Op(t){157===t.kind?function(t){tm(t)||nm(t)||function(t){var n=t.parameters[0];if(1!==t.parameters.length)return Cm(n?n.name:t,e.Diagnostics.An_index_signature_must_have_exactly_one_parameter);if(n.dotDotDotToken)return Cm(n.dotDotDotToken,e.Diagnostics.An_index_signature_cannot_have_a_rest_parameter);if(e.hasModifiers(n))return Cm(n.name,e.Diagnostics.An_index_signature_parameter_cannot_have_an_accessibility_modifier);if(n.questionToken)return Cm(n.questionToken,e.Diagnostics.An_index_signature_parameter_cannot_have_a_question_mark);if(n.initializer)return Cm(n.name,e.Diagnostics.An_index_signature_parameter_cannot_have_an_initializer);if(!n.type)return Cm(n.name,e.Diagnostics.An_index_signature_parameter_must_have_a_type_annotation);if(136!==n.type.kind&&133!==n.type.kind)return Cm(n.name,e.Diagnostics.An_index_signature_parameter_type_must_be_string_or_number);if(!t.type)Cm(t,e.Diagnostics.An_index_signature_must_have_a_type_annotation)}(t)}(t):160!==t.kind&&228!==t.kind&&161!==t.kind&&155!==t.kind&&152!==t.kind&&156!==t.kind||om(t);var n=e.getFunctionFlags(t);if(4&n||(3==(3&n)&&x<5&&Zf(t,6144),2==(3&n)&&x<4&&Zf(t,64),0!=(3&n)&&x<2&&Zf(t,128)),Vh(t.typeParameters),e.forEach(t.parameters,wp),t.type&&lf(t.type),r){!function(t){if(!e.hasRestParameter(t)||e.isInAmbientContext(t)||e.nodeIsMissing(t.body))return;e.forEach(t.parameters,(function(t){t.name&&!e.isBindingPattern(t.name)&&t.name.escapedText===F.escapedName&&ln(t,e.Diagnostics.Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters)}))}(t);var i=e.getEffectiveReturnTypeNode(t);if(N&&!i)switch(t.kind){case 156:ln(t,e.Diagnostics.Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type);break;case 155:ln(t,e.Diagnostics.Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type)}if(i){var s=e.getFunctionFlags(t);if(1==(5&s)){var o=pa(i);if(o===oe)ln(i,e.Diagnostics.A_generator_cannot_have_a_void_type_annotation);else{var a=Lh(o,0!=(2&s))||z;Ma(2&s?Io(a):wo(a),o,i)}}else 2==(3&s)&&Yp(t)}C&&!t.body&&uh(t)}}function Rp(t){for(var n=e.createMap(),r=0,i=t.members;r<i.length;r++){var s=i[r];if(148===s.kind){var o=void 0;switch(s.name.kind){case 9:case 8:o=s.name.text;break;case 71:o=e.idText(s.name);break;default:continue}n.get(o)?(ln(e.getNameOfDeclaration(s.symbol.valueDeclaration),e.Diagnostics.Duplicate_identifier_0,o),ln(s.name,e.Diagnostics.Duplicate_identifier_0,o)):n.set(o,!0)}}}function Lp(t){if(230===t.kind){var n=er(t);if(n.declarations.length>0&&n.declarations[0]!==t)return}var r=Gs(er(t));if(r)for(var i=!1,s=!1,o=0,a=r.declarations;o<a.length;o++){var l=a[o];if(1===l.parameters.length&&l.parameters[0].type)switch(l.parameters[0].type.kind){case 136:s?ln(l,e.Diagnostics.Duplicate_string_index_signature):s=!0;break;case 133:i?ln(l,e.Diagnostics.Duplicate_number_index_signature):i=!0}}}function Pp(t){tm(t)||nm(t)||function(t){if(e.isClassLike(t.parent)){if(_m(t.name,e.Diagnostics.A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol))return!0}else if(230===t.parent.kind){if(_m(t.name,e.Diagnostics.A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol))return!0;if(t.initializer)return Cm(t.initializer,e.Diagnostics.An_interface_property_cannot_have_an_initializer)}else if(163===t.parent.kind){if(_m(t.name,e.Diagnostics.A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol))return!0;if(t.initializer)return Cm(t.initializer,e.Diagnostics.A_type_literal_property_cannot_have_an_initializer)}if(e.isInAmbientContext(t)&&t.initializer)return xm(t.initializer,e.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}(t)||dm(t.name),Eh(t)}function Mp(t){Op(t),function(t){if(t.typeParameters)return Sm(t,t.typeParameters.pos,t.typeParameters.end-t.typeParameters.pos,e.Diagnostics.Type_parameters_cannot_appear_on_a_constructor_declaration)}(t)||function(t){if(t.type)Cm(t.type,e.Diagnostics.Type_annotation_cannot_appear_on_a_constructor_declaration)}(t),lf(t.body),sh(t);var n=er(t);if(t===e.getDeclarationOfKind(n,t.kind)&&jp(n),!e.nodeIsMissing(t.body)&&r){var i=t.parent;if(e.getClassExtendsHeritageClauseElement(i)){Gc(t.parent,i);var s=Wc(i),o=Kc(t);if(o){if(s&&ln(o,e.Diagnostics.A_constructor_cannot_contain_a_super_call_when_its_class_extends_null),e.some(t.parent.members,(function(t){return 149===t.kind&&!e.hasModifier(t,32)&&!!t.initializer}))||e.some(t.parameters,(function(t){return e.hasModifier(t,92)}))){for(var a=void 0,l=0,c=t.body.statements;l<c.length;l++){var u=c[l];if(210===u.kind&&e.isSuperCall(u.expression)){a=u;break}if(!e.isPrologueDirective(u))break}a||ln(t,e.Diagnostics.A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_properties_or_has_parameter_properties)}}else s||ln(t,e.Diagnostics.Constructors_for_derived_classes_must_contain_a_super_call)}}}function Fp(t){if(r){if(om(t)||function(t){var n=t.kind;if(x<1)return Cm(t.name,e.Diagnostics.Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher);if(e.isInAmbientContext(t))return Cm(t.name,e.Diagnostics.An_accessor_cannot_be_declared_in_an_ambient_context);if(void 0===t.body&&!e.hasModifier(t,128))return Sm(t,t.end-1,";".length,e.Diagnostics._0_expected,"{");if(t.body&&e.hasModifier(t,128))return Cm(t,e.Diagnostics.An_abstract_accessor_cannot_have_an_implementation);if(t.typeParameters)return Cm(t.name,e.Diagnostics.An_accessor_cannot_have_type_parameters);if(!function(e){return mm(e)||e.parameters.length===(153===e.kind?0:1)}(t))return Cm(t.name,153===n?e.Diagnostics.A_get_accessor_cannot_have_parameters:e.Diagnostics.A_set_accessor_must_have_exactly_one_parameter);if(154===n){if(t.type)return Cm(t.name,e.Diagnostics.A_set_accessor_cannot_have_a_return_type_annotation);var r=t.parameters[0];if(r.dotDotDotToken)return Cm(r.dotDotDotToken,e.Diagnostics.A_set_accessor_cannot_have_rest_parameter);if(r.questionToken)return Cm(r.questionToken,e.Diagnostics.A_set_accessor_cannot_have_an_optional_parameter);if(r.initializer)return Cm(t.name,e.Diagnostics.A_set_accessor_parameter_cannot_have_an_initializer)}}(t)||dm(t.name),nh(t),Op(t),153===t.kind&&!e.isInAmbientContext(t)&&e.nodeIsPresent(t.body)&&128&t.flags&&(256&t.flags||ln(t.name,e.Diagnostics.A_get_accessor_must_return_a_value)),144===t.name.kind&&vu(t.name),!e.hasDynamicName(t)){var n=153===t.kind?154:153,i=e.getDeclarationOfKind(t.symbol,n);if(i){var s=e.getModifierFlags(t),o=e.getModifierFlags(i);(28&s)!=(28&o)&&ln(t.name,e.Diagnostics.Getter_and_setter_accessors_do_not_agree_in_visibility),(128&s)!=(128&o)&&ln(t.name,e.Diagnostics.Accessors_must_both_be_abstract_or_non_abstract),$p(t,i,ri,e.Diagnostics.get_and_set_accessor_must_have_the_same_type),$p(t,i,ii,e.Diagnostics.get_and_set_accessor_must_have_the_same_this_type)}}var a=si(er(t));153===t.kind&&Yd(t,a)}lf(t.body),sh(t)}function $p(e,t,n,r){var i=n(e),s=n(t);i&&s&&!wa(i,s)&&ln(e,r)}function Bp(t,n){for(var r,i,s=Ds(t),o=!0,a=0;a<t.length;a++){var l=ls(t[a]);if(l){r||(i=_a(t,r=Os(e.map(n,pa),t,s,e.isInJavaScriptFile(n[a]))));var c=r[a];o=o&&Ma(c,Ea(l,i),n[a],e.Diagnostics.Type_0_does_not_satisfy_the_constraint_1)}}return o}function Up(t){am(t,t.typeArguments),159!==t.kind||void 0===t.typeName.jsdocDotPos||e.isInJavaScriptFile(t)||e.isInJSDoc(t)||Sm(t,t.typeName.jsdocDotPos,1,e.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments);var n=oo(t);if(n!==J){if(t.typeArguments&&(e.forEach(t.typeArguments,lf),r)){var i=gn(t).resolvedSymbol;if(!i)return void(e.isJSDocIndexSignature(t)||ln(t,e.Diagnostics.Type_0_is_not_generic,Cr(n)));var s=524288&i.flags&&_n(i).typeParameters;!s&&4&yn(n)&&(s=n.target.localTypeParameters),Bp(s,t.typeArguments)}16&n.flags&&8&gn(t).resolvedSymbol.flags&&ln(t,e.Diagnostics.Enum_type_0_has_members_with_initializers_that_are_not_literals,Cr(n))}}function Vp(t,n){if(!(524288&t.flags))return t;var r=t.objectType,i=t.indexType;return Ra(i,Wo(r))?(180===n.kind&&e.isAssignmentTarget(n)&&32&yn(r)&&r.declaration.readonlyToken&&ln(n,e.Diagnostics.Index_signature_in_type_0_only_permits_reading,Cr(r)),t):(xs(ms(r),1)&&sp(i,84)||ln(n,e.Diagnostics.Type_0_cannot_be_used_to_index_type_1,Cr(i),Cr(r)),t)}function Hp(t){return e.hasModifier(t,8)&&e.isInAmbientContext(t)}function Gp(t,n){var r=e.getCombinedModifierFlags(t);return 230!==t.parent.kind&&229!==t.parent.kind&&199!==t.parent.kind&&e.isInAmbientContext(t)&&(2&r||(r|=1),r|=2),r&n}function jp(t){if(r){for(var n,i,s,o=0,a=155,l=!1,c=!0,u=!1,d=t.declarations,p=0!=(16384&t.flags),h=!1,f=!1,m=0,_=d;m<_.length;m++){var g=_[m],y=e.isInAmbientContext(g),b=230===g.parent.kind||163===g.parent.kind||y;if(b&&(s=void 0),228===g.kind||151===g.kind||150===g.kind||152===g.kind){var v=Gp(g,155);o|=v,a&=v,l=l||e.hasQuestionToken(g),c=c&&e.hasQuestionToken(g),e.nodeIsPresent(g.body)&&n?p?f=!0:h=!0:s&&s.parent===g.parent&&s.end!==g.pos&&I(s),e.nodeIsPresent(g.body)?n||(n=g):u=!0,s=g,b||(i=g)}}if(f&&e.forEach(d,(function(t){ln(t,e.Diagnostics.Multiple_constructor_implementations_are_not_allowed)})),h&&e.forEach(d,(function(t){ln(e.getNameOfDeclaration(t),e.Diagnostics.Duplicate_function_implementation)})),!i||i.body||e.hasModifier(i,128)||i.questionToken||I(i),u&&(function(t,n,r,i,s){if(0!=(i^s)){var o=Gp(C(t,n),r);e.forEach(t,(function(t){var n=Gp(t,r)^o;1&n?ln(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_exported_or_non_exported):2&n?ln(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_ambient_or_non_ambient):24&n?ln(e.getNameOfDeclaration(t)||t,e.Diagnostics.Overload_signatures_must_all_be_public_private_or_protected):128&n&&ln(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_abstract_or_non_abstract)}))}}(d,n,155,o,a),function(t,n,r,i){if(r!==i){var s=e.hasQuestionToken(C(t,n));e.forEach(t,(function(t){e.hasQuestionToken(t)!==s&&ln(e.getNameOfDeclaration(t),e.Diagnostics.Overload_signatures_must_all_be_optional_or_required)}))}}(d,n,l,c),n))for(var T=Ls(t),k=Rs(n),E=0,x=T;E<x.length;E++){var S=x[E];if(!Ba(k,S)){ln(S.declaration,e.Diagnostics.Overload_signature_is_not_compatible_with_function_implementation);break}}}function C(e,t){return void 0!==t&&t.parent===e[0].parent?t:e[0]}function I(t){if(!t.name||!e.nodeIsMissing(t.name)){var n=!1,r=e.forEachChild(t.parent,(function(e){if(n)return e;n=e===t}));if(r&&r.pos===t.end&&r.kind===t.kind){var i=r.name||r,s=r.name;if(t.name&&s&&(e.isComputedPropertyName(t.name)&&e.isComputedPropertyName(s)||!e.isComputedPropertyName(t.name)&&!e.isComputedPropertyName(s)&&e.getEscapedTextOfIdentifierOrLiteral(t.name)===e.getEscapedTextOfIdentifierOrLiteral(s))){if((151===t.kind||150===t.kind)&&e.hasModifier(t,32)!==e.hasModifier(r,32))ln(i,e.hasModifier(t,32)?e.Diagnostics.Function_overload_must_be_static:e.Diagnostics.Function_overload_must_not_be_static);return}if(e.nodeIsPresent(r.body))return void ln(i,e.Diagnostics.Function_implementation_name_must_be_0,e.declarationNameToString(t.name))}var o=t.name||t;p?ln(o,e.Diagnostics.Constructor_implementation_is_missing):e.hasModifier(t,128)?ln(o,e.Diagnostics.All_declarations_of_an_abstract_method_must_be_consecutive):ln(o,e.Diagnostics.Function_implementation_is_missing_or_not_immediately_following_the_declaration)}}}function Kp(t){if(r){var n=t.localSymbol;if((n||(n=er(t)).exportSymbol)&&e.getDeclarationOfKind(n,t.kind)===t){for(var i=0,s=0,o=0,a=0,l=n.declarations;a<l.length;a++){var c=y(_=l[a]),u=Gp(_,513);1&u?512&u?o|=c:i|=c:s|=c}var d,p=i&s,h=o&(i|s);if(p||h)for(var f=0,m=n.declarations;f<m.length;f++){c=y(_=m[f]);var _,g=e.getNameOfDeclaration(_);c&h?ln(g,e.Diagnostics.Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_default_0_declaration_instead,e.declarationNameToString(g)):c&p&&ln(g,e.Diagnostics.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local,e.declarationNameToString(g))}!function(e){e[e.None=0]="None",e[e.ExportValue=1]="ExportValue",e[e.ExportType=2]="ExportType",e[e.ExportNamespace=4]="ExportNamespace"}(d||(d={}))}}function y(t){switch(t.kind){case 230:case 231:case 283:return 2;case 233:return e.isAmbientModule(t)||0!==e.getModuleInstanceState(t)?5:4;case 229:case 232:return 3;case 237:case 240:case 239:var n=0,r=Mn(er(t));return e.forEach(r.declarations,(function(e){n|=y(e)})),n;case 226:case 176:case 228:case 242:return 1;default:e.Debug.fail(e.SyntaxKind[t.kind])}}}function Wp(e,t,n){var r=zp(e,t);return r&&Jp(r,t,n)}function zp(t,n){if(!Gr(t)){var r=t;if(r.promisedTypeOfPromise)return r.promisedTypeOfPromise;if(ci(t,mo(!1)))return r.promisedTypeOfPromise=t.typeArguments[0];var i=Hr(t,"then");if(!Gr(i)){var s=i?Ts(i,0):e.emptyArray;if(0!==s.length){var o=nc(Uo(e.map(s,Vd)),524288);if(!Gr(o)){var a=Ts(o,0);if(0!==a.length)return r.promisedTypeOfPromise=Uo(e.map(a,Vd),!0);n&&ln(n,e.Diagnostics.The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback)}}else n&&ln(n,e.Diagnostics.A_promise_must_have_a_then_method)}}}function qp(e,t,n){return Jp(e,t,n)||J}function Jp(t,n,r){var i=t;if(i.awaitedTypeOfType)return i.awaitedTypeOfType;if(Gr(t))return i.awaitedTypeOfType=t;if(65536&t.flags){for(var s=void 0,o=0,a=t.types;o<a.length;o++){var l=a[o];s=e.append(s,Jp(l,n,r))}if(!s)return;return i.awaitedTypeOfType=Uo(s)}var c=zp(t);if(c){if(t.id===c.id||e.indexOf(At,c.id)>=0)return void(n&&ln(n,e.Diagnostics.Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method));At.push(t.id);var u=Jp(c,n,r);if(At.pop(),!u)return;return i.awaitedTypeOfType=u}var d=Hr(t,"then");if(!(d&&Ts(d,0).length>0))return i.awaitedTypeOfType=t;n&&(e.Debug.assert(!!r),ln(n,r))}function Yp(t){var n,r=e.getEffectiveReturnTypeNode(t),i=pa(r);if(x>=2){if(i===J)return J;var s=mo(!0);if(s!==he&&!ci(i,s))return ln(r,e.Diagnostics.The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type),J}else{if(function(t){Qp(t&&e.getEntityNameFromTypeNode(t))}(r),i===J)return J;var o=e.getEntityNameFromTypeNode(r);if(void 0===o)return ln(r,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,Cr(i)),J;var a=Vn(o,107455,!0),l=a?li(a):J;if(l===J)return 71===o.kind&&"Promise"===o.escapedText&&ui(i)===mo(!1)?ln(r,e.Diagnostics.An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option):ln(r,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,e.entityNameToString(o)),J;var c=(n=!0,Be||(Be=ho("PromiseConstructorLike",0,n))||ue);if(c===ue)return ln(r,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,e.entityNameToString(o)),J;if(!Ma(l,c,r,e.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value))return J;var u=o&&Zh(o),d=vn(t.locals,u.escapedText,107455);if(d)return ln(d.valueDeclaration,e.Diagnostics.Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions,e.idText(u),e.entityNameToString(o)),J}return qp(i,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)}function Xp(t){var n=Ms(Dd(t));if(!(1&n.flags)){var r,i,s=Cd(t);switch(t.parent.kind){case 229:r=Uo([li(er(t.parent)),oe]);break;case 146:r=oe,i=e.chainDiagnosticMessages(i,e.Diagnostics.The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any);break;case 149:r=oe,i=e.chainDiagnosticMessages(i,e.Diagnostics.The_return_type_of_a_property_decorator_function_must_be_either_void_or_any);break;case 151:case 153:case 154:r=Uo([Co(Tf(t.parent)),oe])}Ma(n,r,t,s,i)}}function Qp(e){if(e){var t=Zh(e),n=2097152|(71===e.kind?793064:1920),r=kn(t,t.escapedText,n,void 0,void 0,!0);r&&2097152&r.flags&&rr(r)&&!Lf(Mn(r))&&$n(r)}}function Zp(t){var n=eh(t);n&&e.isEntityName(n)&&Qp(n)}function eh(t){if(t)switch(t.kind){case 167:case 166:for(var n=void 0,r=0,i=t.types;r<i.length;r++){var s=eh(i[r]);if(!s)return;if(n){if(!e.isIdentifier(n)||!e.isIdentifier(s)||n.escapedText!==s.escapedText)return}else n=s}return n;case 168:return eh(t.type);case 159:return t.typeName}}function th(t){var n=e.getEffectiveTypeAnnotationNode(t);return e.isRestParameter(t)?e.getRestParameterElementType(n):n}function nh(t){if(t.decorators&&e.nodeCanBeDecorated(t)){E.experimentalDecorators||ln(t,e.Diagnostics.Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning);var n=t.decorators[0];if(Zf(n,8),146===t.kind&&Zf(n,32),E.emitDecoratorMetadata)switch(Zf(n,16),t.kind){case 229:var r=e.getFirstConstructorWithBody(t);if(r)for(var i=0,s=r.parameters;i<s.length;i++){Zp(th(s[i]))}break;case 151:case 153:case 154:for(var o=0,a=t.parameters;o<a.length;o++){Zp(th(a[o]))}Zp(e.getEffectiveReturnTypeNode(t));break;case 149:Zp(e.getEffectiveTypeAnnotationNode(t));break;case 146:Zp(th(t))}e.forEach(t.decorators,Xp)}}function rh(e){switch(e.kind){case 71:return e;case 179:return e.name;default:return}}function ih(t){nh(t),Op(t);var n=e.getFunctionFlags(t);if(t.name&&144===t.name.kind&&vu(t.name),!e.hasDynamicName(t)){var i=er(t),s=t.localSymbol||i,o=e.find(s.declarations,(function(e){return e.kind===t.kind&&!(65536&e.flags)}));t===o&&jp(s),i.parent&&e.getDeclarationOfKind(i,t.kind)===t&&jp(i)}lf(t.body);var a=e.getEffectiveReturnTypeNode(t);if(0==(1&n)){var l=a&&(2&n?Yp(t):pa(a));Yd(t,l)}r&&!a&&(N&&e.nodeIsMissing(t.body)&&!Hp(t)&&wl(t,z),1&n&&e.nodeIsPresent(t.body)&&Ms(Rs(t))),sh(t)}function sh(e){Xe&&Xe.push(e)}function oh(t){230!==t.parent.kind&&C&&!e.isInAmbientContext(t)&&t.locals.forEach((function(t){if(!t.isReferenced)if(t.valueDeclaration&&146===e.getRootDeclaration(t.valueDeclaration).kind){var n=e.getRootDeclaration(t.valueDeclaration),r=e.getNameOfDeclaration(t.valueDeclaration);!E.noUnusedParameters||e.isParameterPropertyDeclaration(n)||e.parameterIsThisKeyword(n)||(i=r)&&lh(i)||ln(r,e.Diagnostics._0_is_declared_but_its_value_is_never_read,e.symbolName(t))}else E.noUnusedLocals&&e.forEach(t.declarations,(function(n){return ah(n,e.symbolName(t))}));var i}))}function ah(t,n){var r=e.getNameOfDeclaration(t)||t;if(lh(r)){var i=e.getRootDeclaration(r.parent);if(226===i.kind&&e.isForInOrOfStatement(i.parent.parent)||145===i.kind)return}(function(t){if(e.isBindingElement(t)&&e.isObjectBindingPattern(t.parent)){var n=e.lastOrUndefined(t.parent.elements);return n!==t&&!!n.dotDotDotToken}return!1})(71===r.kind?r.parent:r)||ln(r,e.Diagnostics._0_is_declared_but_its_value_is_never_read,n)}function lh(t){return 71===t.kind&&95===e.idText(t).charCodeAt(0)}function ch(t){if(E.noUnusedLocals&&!e.isInAmbientContext(t)&&t.members)for(var n=0,r=t.members;n<r.length;n++){var i=r[n];if(151===i.kind||149===i.kind)!i.symbol.isReferenced&&e.hasModifier(i,8)&&ln(i.name,e.Diagnostics._0_is_declared_but_its_value_is_never_read,e.symbolName(i.symbol));else if(152===i.kind)for(var s=0,o=i.parameters;s<o.length;s++){var a=o[s];!a.symbol.isReferenced&&e.hasModifier(a,8)&&ln(a.name,e.Diagnostics.Property_0_is_declared_but_its_value_is_never_read,e.symbolName(a.symbol))}}}function uh(t){if(E.noUnusedLocals&&!e.isInAmbientContext(t)&&t.typeParameters){var n=er(t);if((n&&n.declarations&&e.lastOrUndefined(n.declarations))!==t)return;for(var r=0,i=t.typeParameters;r<i.length;r++){var s=i[r];Zn(s.symbol).isReferenced||lh(s.name)||ln(s.name,e.Diagnostics._0_is_declared_but_its_value_is_never_read,e.symbolName(s.symbol))}}}function dh(t){E.noUnusedLocals&&!e.isInAmbientContext(t)&&t.locals.forEach((function(t){if(!t.isReferenced&&!t.exportSymbol)for(var n=0,r=t.declarations;n<r.length;n++){var i=r[n];e.isAmbientModule(i)||ah(i,e.symbolName(t))}}))}function ph(t){if(207===t.kind&&Am(t),e.isFunctionOrModuleBlock(t)){var n=ut;e.forEach(t.statements,lf),ut=n}else e.forEach(t.statements,lf);t.locals&&sh(t)}function hh(t,n,r){if(!n||n.escapedText!==r)return!1;if(149===t.kind||148===t.kind||151===t.kind||150===t.kind||153===t.kind||154===t.kind)return!1;if(e.isInAmbientContext(t))return!1;var i=e.getRootDeclaration(t);return 146!==i.kind||!e.nodeIsMissing(i.parent.body)}function fh(e,t){hh(e,t,"_this")&&Ct.push(e)}function mh(e,t){hh(e,t,"_newTarget")&&It.push(e)}function _h(t){e.findAncestor(t,(function(n){if(4&Bf(n))return 71!==t.kind?ln(e.getNameOfDeclaration(t),e.Diagnostics.Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference):ln(t,e.Diagnostics.Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference),!0}))}function gh(t){e.findAncestor(t,(function(n){if(8&Bf(n))return 71!==t.kind?ln(e.getNameOfDeclaration(t),e.Diagnostics.Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_meta_property_reference):ln(t,e.Diagnostics.Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta_property_reference),!0}))}function yh(t,n){if(hh(t,n,"_super")){var r=e.getContainingClass(t);if(r&&!e.isInAmbientContext(r))if(e.getClassExtendsHeritageClauseElement(r))ln(t,71!==t.kind?e.Diagnostics.Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference:e.Diagnostics.Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference)}}function bh(t,n){if(!(S>=e.ModuleKind.ES2015)&&(hh(t,n,"require")||hh(t,n,"exports"))&&(233!==t.kind||1===e.getModuleInstanceState(t))){var r=Vr(t);265===r.kind&&e.isExternalOrCommonJsModule(r)&&ln(n,e.Diagnostics.Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module,e.declarationNameToString(n),e.declarationNameToString(n))}}function vh(t,n){if(!(x>=4)&&hh(t,n,"Promise")&&(233!==t.kind||1===e.getModuleInstanceState(t))){var r=Vr(t);265===r.kind&&e.isExternalOrCommonJsModule(r)&&1024&r.flags&&ln(n,e.Diagnostics.Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_functions,e.declarationNameToString(n),e.declarationNameToString(n))}}function Th(t){if(146===e.getRootDeclaration(t).kind){var n=e.getContainingFunction(t);!function r(i){if(e.isTypeNode(i)||e.isDeclarationName(i))return;if(179===i.kind)return r(i.expression);if(71!==i.kind)return e.forEachChild(i,r);var s=kn(i,i.escapedText,2204607,void 0,void 0,!1);if(!s||s===K||!s.valueDeclaration)return;if(s.valueDeclaration===t)return void ln(i,e.Diagnostics.Parameter_0_cannot_be_referenced_in_its_initializer,e.declarationNameToString(t.name));if(e.getEnclosingBlockScopeContainer(s.valueDeclaration)===n){if(146===s.valueDeclaration.kind||176===s.valueDeclaration.kind){if(s.valueDeclaration.pos<t.pos)return;if(e.findAncestor(i,(function(n){return n===t.initializer?"quit":e.isFunctionLike(n.parent)||149===n.parent.kind&&!e.hasModifier(n.parent,32)&&e.isClassLike(n.parent.parent)})))return}ln(i,e.Diagnostics.Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it,e.declarationNameToString(t.name),e.declarationNameToString(i))}}(t.initializer)}}function kh(e){return e===q?z:e===Oe?De:e}function Eh(t){if(nh(t),lf(t.type),t.name){if(144===t.name.kind&&(vu(t.name),t.initializer&&yp(t.initializer)),176===t.kind){174===t.parent.kind&&x<5&&Zf(t,4),t.propertyName&&144===t.propertyName.kind&&vu(t.propertyName);var n=t.parent.parent,r=jr(n),i=t.propertyName||t.name,s=bs(r,e.getTextOfPropertyName(i));Zu(s,void 0,!1),n.initializer&&s&&Gu(n,n.initializer,r,s)}if(e.isBindingPattern(t.name)&&(175===t.name.kind&&x<2&&E.downlevelIteration&&Zf(t,512),e.forEach(t.name.elements,lf)),t.initializer&&146===e.getRootDeclaration(t).kind&&e.nodeIsMissing(e.getContainingFunction(t).body))ln(t,e.Diagnostics.A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation);else if(e.isBindingPattern(t.name))t.initializer&&215!==t.parent.parent.kind&&(Ma(yp(t.initializer),ei(t),t,void 0),Th(t));else{var o=er(t),a=kh(ni(o));if(t===o.valueDeclaration)t.initializer&&215!==t.parent.parent.kind&&(Ma(yp(t.initializer),a,t,void 0),Th(t));else{var l=kh(ei(t));a===J||l===J||wa(a,l)||ln(t.name,e.Diagnostics.Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2,e.declarationNameToString(t.name),Cr(a),Cr(l)),t.initializer&&Ma(yp(t.initializer),l,t,void 0),function(t,n){if(146===t.kind&&226===n.kind||226===t.kind&&146===n.kind)return!0;if(e.hasQuestionToken(t)!==e.hasQuestionToken(n))return!1;var r=504;return e.getSelectedModifierFlags(t,r)===e.getSelectedModifierFlags(n,r)}(t,o.valueDeclaration)||(ln(e.getNameOfDeclaration(o.valueDeclaration),e.Diagnostics.All_declarations_of_0_must_have_identical_modifiers,e.declarationNameToString(t.name)),ln(t.name,e.Diagnostics.All_declarations_of_0_must_have_identical_modifiers,e.declarationNameToString(t.name)))}149!==t.kind&&148!==t.kind&&(Kp(t),226!==t.kind&&176!==t.kind||function(t){if(0==(3&e.getCombinedNodeFlags(t))&&!e.isParameterDeclaration(t)&&(226!==t.kind||t.initializer)){var n=er(t);if(1&n.flags){if(!e.isIdentifier(t.name))throw e.Debug.fail();var r=kn(t,t.name.escapedText,3,void 0,void 0,!1);if(r&&r!==n&&2&r.flags&&3&Vu(r)){var i=e.getAncestor(r.valueDeclaration,227),s=208===i.parent.kind&&i.parent.parent?i.parent.parent:void 0;if(!s||!(207===s.kind&&e.isFunctionLike(s.parent)||234===s.kind||233===s.kind||265===s.kind)){var o=xr(r);ln(t,e.Diagnostics.Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1,o,o)}}}}}(t),yh(t,t.name),fh(t,t.name),mh(t,t.name),bh(t,t.name),vh(t,t.name))}}}function xh(t){return function(t){if(215!==t.parent.parent.kind&&216!==t.parent.parent.kind)if(e.isInAmbientContext(t)){if(t.initializer){if(!e.isConst(t)||t.type){var n="=".length;return Sm(t,t.initializer.pos-n,n,e.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}if(!ym(t.initializer))return Cm(t.initializer,e.Diagnostics.A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal)}if(t.initializer&&(!e.isConst(t)||!ym(t.initializer))){n="=".length;return Sm(t,t.initializer.pos-n,n,e.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}}else if(!t.initializer){if(e.isBindingPattern(t.name)&&!e.isBindingPattern(t.parent))return Cm(t,e.Diagnostics.A_destructuring_declaration_must_have_an_initializer);if(e.isConst(t))return Cm(t,e.Diagnostics.const_declarations_must_be_initialized)}E.module===e.ModuleKind.ES2015||E.module===e.ModuleKind.ESNext||E.module===e.ModuleKind.System||E.noEmit||e.isInAmbientContext(t.parent.parent)||!e.hasModifier(t.parent.parent,1)||bm(t.name);(e.isLet(t)||e.isConst(t))&&vm(t.name)}(t),Eh(t)}function Sh(t){return function(t){if(t.dotDotDotToken){var n=t.parent.elements;if(t!==e.lastOrUndefined(n))return Cm(t,e.Diagnostics.A_rest_element_must_be_last_in_a_destructuring_pattern);if(175===t.name.kind||174===t.name.kind)return Cm(t.name,e.Diagnostics.A_rest_element_cannot_contain_a_binding_pattern);if(t.initializer)Sm(t,t.initializer.pos-1,1,e.Diagnostics.A_rest_element_cannot_have_an_initializer)}}(t),Eh(t)}function Ch(t){tm(t)||nm(t)||Tm(t.declarationList)||function(t){if(!km(t.parent)){if(e.isLet(t.declarationList))return Cm(t,e.Diagnostics.let_declarations_can_only_be_declared_inside_a_block);if(e.isConst(t.declarationList))Cm(t,e.Diagnostics.const_declarations_can_only_be_declared_inside_a_block)}}(t),e.forEach(t.declarationList.declarations,lf)}function Ih(t){fm(t);var n=ju(t.expression);if(227===t.initializer.kind){var r=t.initializer.declarations[0];r&&e.isBindingPattern(r.name)&&ln(r.name,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern),Ah(t)}else{var i=t.initializer,s=Ip(i);177===i.kind||178===i.kind?ln(i,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern):Ra(function(e){var t=Wo(e);return t!==ae?t:ee}(n),s)?rp(i,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access):ln(i,e.Diagnostics.The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any)}sp(n,17317888)||ln(t.expression,e.Diagnostics.The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter),lf(t.statement),t.locals&&sh(t)}function Ah(e){var t=e.initializer;t.declarations.length>=1&&xh(t.declarations[0])}function wh(e,t){return Nh(ju(e),e,!0,void 0!==t)}function Nh(e,t,n,r){return Gr(e)?e:Dh(e,t,n,r,!0)||z}function Dh(t,n,r,i,s){var o=x>=2,a=!o&&E.downlevelIteration;if(o||a||i){var l=Oh(t,o?n:void 0,i,!0,s);if(l||o)return l}var c=t,u=!1,d=!1;if(r){if(65536&c.flags){var p=t.types,h=e.filter(p,(function(e){return!(262178&e.flags)}));h!==p&&(c=Uo(h,!0))}else 262178&c.flags&&(c=ae);if((d=c!==t)&&(x<1&&n&&(ln(n,e.Diagnostics.Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher),u=!0),8192&c.flags))return ee}if(!ll(c)){if(n&&!u)ln(n,!r||d?a?e.Diagnostics.Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:e.Diagnostics.Type_0_is_not_an_array_type:a?e.Diagnostics.Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:e.Diagnostics.Type_0_is_not_an_array_type_or_a_string_type,Cr(c));return d?ee:void 0}var f=Ss(c,1);return d&&f?262178&f.flags?ee:Uo([f,ee],!0):f}function Oh(t,n,r,i,s){if(!Gr(t))return vc(t,(function(t){var o=t;if(r){if(o.iteratedTypeOfAsyncIterable)return o.iteratedTypeOfAsyncIterable;if(ci(t,go(!1))||ci(t,bo(!1)))return o.iteratedTypeOfAsyncIterable=t.typeArguments[0]}if(i){if(o.iteratedTypeOfIterable)return o.iteratedTypeOfIterable;if(ci(t,vo(!1))||ci(t,ko(!1)))return o.iteratedTypeOfIterable=t.typeArguments[0]}var a=r&&Hr(t,e.getPropertyNameForKnownSymbolName("asyncIterator")),l=a||i&&Hr(t,e.getPropertyNameForKnownSymbolName("iterator"));if(Gr(l))return;var c=l&&Ts(l,0);if(!e.some(c))return void(n&&(ln(n,r?e.Diagnostics.Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator:e.Diagnostics.Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator),n=void 0));var u=Rh(Uo(e.map(c,Ms),!0),n,!!a);s&&n&&u&&Ma(t,a?function(e){return So(go(!0),[e])}(u):Ao(u),n);return a?o.iteratedTypeOfAsyncIterable=u:o.iteratedTypeOfIterable=u}))}function Rh(t,n,r){if(!Gr(t)){var i=t;if(r?i.iteratedTypeOfAsyncIterator:i.iteratedTypeOfIterator)return r?i.iteratedTypeOfAsyncIterator:i.iteratedTypeOfIterator;if(ci(t,(r?yo:To)(!1)))return r?i.iteratedTypeOfAsyncIterator=t.typeArguments[0]:i.iteratedTypeOfIterator=t.typeArguments[0];var s=Hr(t,"next");if(!Gr(s)){var o=s?Ts(s,0):e.emptyArray;if(0!==o.length){var a=Uo(e.map(o,Ms),!0);if(!(Gr(a)||r&&Gr(a=Wp(a,n,e.Diagnostics.The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property)))){var l=a&&Hr(a,"value");if(l)return r?i.iteratedTypeOfAsyncIterator=l:i.iteratedTypeOfIterator=l;n&&ln(n,r?e.Diagnostics.The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property:e.Diagnostics.The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property)}}else n&&ln(n,r?e.Diagnostics.An_async_iterator_must_have_a_next_method:e.Diagnostics.An_iterator_must_have_a_next_method)}}}function Lh(e,t){if(!Gr(e))return Oh(e,void 0,t,!t,!1)||Rh(e,void 0,t)}function Ph(t){Am(t)||function(t){var n=t;for(;n;){if(e.isFunctionLike(n))return Cm(t,e.Diagnostics.Jump_target_cannot_cross_function_boundary);switch(n.kind){case 222:if(t.label&&n.label.escapedText===t.label.escapedText)return!!(217===t.kind&&!e.isIterationStatement(n.statement,!0))&&Cm(t,e.Diagnostics.A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement);break;case 221:if(218===t.kind&&!t.label)return!1;break;default:if(e.isIterationStatement(n,!1)&&!t.label)return!1}n=n.parent}t.label?Cm(t,218===t.kind?e.Diagnostics.A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement:e.Diagnostics.A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement):Cm(t,218===t.kind?e.Diagnostics.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement:e.Diagnostics.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement)}(t)}function Mh(t){return 153===t.kind&&void 0!==e.getEffectiveSetAccessorTypeAnnotationNode(e.getDeclarationOfKind(t.symbol,154))}function Fh(t,n){var r=2==(3&e.getFunctionFlags(t))?zp(n):n;return r&&ip(r,1025)}function $h(t){Am(t)||void 0===t.expression&&function(t,n,r,i,s){var o=e.getSourceFileOfNode(t);if(!Em(o)){var a=e.getSpanOfTokenAtPosition(o,t.pos);wt.add(e.createFileDiagnostic(o,e.textSpanEnd(a),0,n,r,i,s))}}(t,e.Diagnostics.Line_break_not_permitted_here),t.expression&&Ip(t.expression)}function Bh(t){var n,r=js(t.symbol,1),i=js(t.symbol,0),s=Ss(t,0),o=Ss(t,1);if((s||o)&&(e.forEach(ss(t),(function(e){var n=li(e);d(e,n,t,i,s,0),d(e,n,t,r,o,1)})),1&yn(t)&&e.isClassLike(t.symbol.valueDeclaration)))for(var a=0,l=t.symbol.valueDeclaration.members;a<l.length;a++){var c=l[a];if(!e.hasModifier(c,32)&&e.hasDynamicName(c)){var u=li(c.symbol);d(c.symbol,u,t,i,s,0),d(c.symbol,u,t,r,o,1)}}s&&o&&(!(n=r||i)&&2&yn(t)&&(n=e.forEach(Ei(t),(function(e){return Ss(e,0)&&Ss(e,1)}))?void 0:t.symbol.declarations[0]));function d(t,n,r,i,s,o){if(s){var a=t.valueDeclaration;if(1!==o||(a?yu(e.getNameOfDeclaration(a)):bu(t.escapedName))){var l;if(!a||194!==a.kind&&144!==e.getNameOfDeclaration(a).kind&&t.parent!==r.symbol){if(i)l=i;else if(2&yn(r)){l=e.forEach(Ei(r),(function(e){return os(e,t.escapedName)&&Ss(e,o)}))?void 0:r.symbol.declarations[0]}}else l=a;if(l&&!Ra(n,s))ln(l,0===o?e.Diagnostics.Property_0_of_type_1_is_not_assignable_to_string_index_type_2:e.Diagnostics.Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2,xr(t),Cr(n),Cr(s))}}}n&&!Ra(o,s)&&ln(n,e.Diagnostics.Numeric_index_type_0_is_not_assignable_to_string_index_type_1,Cr(o),Cr(s))}function Uh(e,t){switch(e.escapedText){case"any":case"number":case"boolean":case"string":case"symbol":case"void":case"object":ln(e,t,e.escapedText)}}function Vh(t){if(t)for(var n=!1,i=0;i<t.length;i++){var s=t[i];if(Ap(s),r){s.default?n=!0:n&&ln(s,e.Diagnostics.Required_type_parameters_may_not_follow_optional_type_parameters);for(var o=0;o<i;o++)t[o].symbol===s.symbol&&ln(s.name,e.Diagnostics.Duplicate_identifier_0,e.declarationNameToString(s.name))}}}function Hh(t){if(1!==t.declarations.length){var n=_n(t);if(!n.typeParametersChecked){n.typeParametersChecked=!0;var r=function(t){return e.filter(t.declarations,(function(e){return 229===e.kind||230===e.kind}))}(t);if(r.length<=1)return;if(!function(t,n){for(var r=e.length(n),i=Ds(n),s=0,o=t;s<o.length;s++){var a=o[s],l=e.length(a.typeParameters);if(l<i||l>r)return!1;for(var c=0;c<l;c++){var u=a.typeParameters[c],d=n[c];if(u.name.escapedText!==d.symbol.escapedName)return!1;var p=u.constraint&&pa(u.constraint),h=zs(d);if((p||h)&&(!p||!h||!wa(p,h)))return!1;var f=u.default&&pa(u.default),m=fs(d);if(f&&m&&!wa(f,m))return!1}}return!0}(r,Oi(t).localTypeParameters))for(var i=xr(t),s=0,o=r;s<o.length;s++){ln(o[s].name,e.Diagnostics.All_declarations_of_0_must_have_identical_type_parameters,i)}}}}function Gh(t){e.forEach(t.members,lf),sh(t)}function jh(t){!function(t){var n=e.getSourceFileOfNode(t);(function(t){var n=!1,r=!1;if(!tm(t)&&!nm(t)&&t.heritageClauses)for(var i=0,s=t.heritageClauses;i<s.length;i++){var o=s[i];if(85===o.token){if(n)return xm(o,e.Diagnostics.extends_clause_already_seen);if(r)return xm(o,e.Diagnostics.extends_clause_must_precede_implements_clause);if(o.types.length>1)return xm(o.types[1],e.Diagnostics.Classes_can_only_extend_a_single_class);n=!0}else{if(e.Debug.assert(108===o.token),r)return xm(o,e.Diagnostics.implements_clause_already_seen);r=!0}cm(o)}})(t)||sm(t.typeParameters,n)}(t),nh(t),t.name&&(Uh(t.name,e.Diagnostics.Class_name_cannot_be_0),fh(t,t.name),mh(t,t.name),bh(t,t.name),vh(t,t.name)),Vh(t.typeParameters),Kp(t);var n=er(t),i=Oi(n),s=Ui(i),o=li(n);Hh(n),function(t){var n;!function(e){e[e.Getter=1]="Getter",e[e.Setter=2]="Setter",e[e.Method=4]="Method",e[e.Property=3]="Property"}(n||(n={}));for(var r=e.createUnderscoreEscapedMap(),i=e.createUnderscoreEscapedMap(),s=0,o=t.members;s<o.length;s++){var a=o[s];if(152===a.kind)for(var l=0,c=a.parameters;l<c.length;l++){var u=c[l];e.isParameterPropertyDeclaration(u)&&!e.isBindingPattern(u.name)&&h(r,u.name,u.name.escapedText,3)}else{var d=e.hasModifier(a,32)?i:r,p=a.name&&e.getPropertyNameForPropertyNameNode(a.name);if(p)switch(a.kind){case 153:h(d,a.name,p,1);break;case 154:h(d,a.name,p,2);break;case 149:h(d,a.name,p,3);break;case 151:h(d,a.name,p,4)}}}function h(t,n,r,i){var s=t.get(r);s?4&s?4!==i&&ln(n,e.Diagnostics.Duplicate_identifier_0,e.getTextOfNode(n)):s&i?ln(n,e.Diagnostics.Duplicate_identifier_0,e.getTextOfNode(n)):t.set(r,s|i):t.set(r,i)}}(t),e.isInAmbientContext(t)||function(t){for(var n=0,r=t.members;n<r.length;n++){var i=r[n],s=i.name;if(e.hasModifier(i,32)&&s){var o=e.getPropertyNameForPropertyNameNode(s);switch(o){case"name":case"length":case"caller":case"arguments":case"prototype":ln(s,e.Diagnostics.Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1,o,Rr(er(t)))}}}}(t);var a=e.getClassExtendsHeritageClauseElement(t);if(a){x<2&&Zf(a.parent,1);var l=Ei(i);if(l.length&&r){var c=l[0],u=ki(i),d=ms(u);if(function(t,n){var r=Ts(t,1);if(r.length){var i=r[0].declaration;if(i&&e.hasModifier(i,8))gf(n,Wh(t.symbol))||ln(n,e.Diagnostics.Cannot_extend_a_class_0_Class_constructor_is_marked_as_private,Un(t.symbol))}}(d,a),lf(a.expression),e.some(a.typeArguments)){e.forEach(a.typeArguments,lf);for(var p=0,h=vi(d,a.typeArguments,a);p<h.length;p++){if(!Bp(h[p].typeParameters,a.typeArguments))break}}if(Ma(s,Ui(c,i.thisType),t.name||t,e.Diagnostics.Class_0_incorrectly_extends_base_class_1),Ma(o,Aa(d),t.name||t,e.Diagnostics.Class_static_side_0_incorrectly_extends_base_class_static_side_1),540672&u.flags&&!gi(o)&&ln(t.name||t,e.Diagnostics.A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any),!(d.symbol&&32&d.symbol.flags||540672&u.flags)){var f=Ti(d,a.typeArguments,a);e.forEach(f,(function(e){return Ms(e)!==c}))&&ln(a.expression,e.Diagnostics.Base_constructors_must_all_have_the_same_return_type)}!function(t,n){for(var r=as(n),i=0,s=r;i<s.length;i++){var o=s[i],a=Kh(o);if(!(4194304&a.flags)){var l=Kh(os(t,a.escapedName)),c=e.getDeclarationModifierFlagsFromSymbol(a);if(e.Debug.assert(!!l,"derived should point to something, even if it is the base class' declaration."),l)if(l===a){var u=Wh(t.symbol);!(128&c)||u&&e.hasModifier(u,128)||(199===u.kind?ln(u,e.Diagnostics.Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1,xr(o),Cr(n)):ln(u,e.Diagnostics.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2,Cr(t),xr(o),Cr(n)))}else{var d=e.getDeclarationModifierFlagsFromSymbol(l);if(8&c||8&d)continue;if(Hu(a)&&Hu(l)||98308&a.flags&&98308&l.flags)continue;var p=void 0;p=Hu(a)?98304&l.flags?e.Diagnostics.Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_accessor:e.Diagnostics.Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_property:4&a.flags?e.Diagnostics.Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_function:e.Diagnostics.Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_function,ln(e.getNameOfDeclaration(l.valueDeclaration)||l.valueDeclaration,p,Cr(n),xr(a),Cr(t))}}}}(i,c)}}var m=e.getClassImplementsHeritageClauseElements(t);if(m)for(var _=0,g=m;_<g.length;_++){var y=g[_];if(e.isEntityNameExpression(y.expression)||ln(y.expression,e.Diagnostics.A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments),Up(y),r){var b=pa(y);b!==J&&(xi(b)?Ma(s,Ui(b,i.thisType),t.name||t,e.Diagnostics.Class_0_incorrectly_implements_interface_1):ln(y,e.Diagnostics.A_class_may_only_implement_another_class_or_interface))}}r&&(Bh(i),Lp(t))}function Kh(t){return 1&e.getCheckFlags(t)?t.target:t}function Wh(t){return e.forEach(t.declarations,(function(t){return e.isClassLike(t)?t:void 0}))}function zh(t){if(tm(t)||nm(t)||function(t){var n=!1;if(t.heritageClauses)for(var r=0,i=t.heritageClauses;r<i.length;r++){var s=i[r];if(85!==s.token)return e.Debug.assert(108===s.token),xm(s,e.Diagnostics.Interface_declaration_cannot_have_implements_clause);if(n)return xm(s,e.Diagnostics.extends_clause_already_seen);n=!0,cm(s)}}(t),Vh(t.typeParameters),r){Uh(t.name,e.Diagnostics.Interface_name_cannot_be_0),Kp(t);var n=er(t);if(Hh(n),t===e.getDeclarationOfKind(n,230)){var i=Oi(n),s=Ui(i);if(function(t,n){var r=Ei(t);if(r.length<2)return!0;var i=e.createUnderscoreEscapedMap();e.forEach(Bi(t).declaredProperties,(function(e){i.set(e.escapedName,{prop:e,containingType:t})}));for(var s=!0,o=0,a=r;o<a.length;o++)for(var l=a[o],c=0,u=as(Ui(l,t.thisType));c<u.length;c++){var d=u[c],p=i.get(d.escapedName);if(p){if(p.containingType!==t&&0===rl(p.prop,d,Na)){s=!1;var h=Cr(p.containingType),f=Cr(l),m=e.chainDiagnosticMessages(void 0,e.Diagnostics.Named_property_0_of_types_1_and_2_are_not_identical,xr(d),h,f);m=e.chainDiagnosticMessages(m,e.Diagnostics.Interface_0_cannot_simultaneously_extend_types_1_and_2,Cr(t),h,f),wt.add(e.createDiagnosticForNodeFromMessageChain(n,m))}}else i.set(d.escapedName,{prop:d,containingType:l})}return s}(i,t.name)){for(var o=0,a=Ei(i);o<a.length;o++){Ma(s,Ui(a[o],i.thisType),t.name,e.Diagnostics.Interface_0_incorrectly_extends_interface_1)}Bh(i)}}Rp(t)}e.forEach(e.getInterfaceBaseTypeNodes(t),(function(t){e.isEntityNameExpression(t.expression)||ln(t.expression,e.Diagnostics.An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments),Up(t)})),e.forEach(t.members,lf),r&&(Lp(t),sh(t))}function qh(e){var t=gn(e);if(!(16384&t.flags)){t.flags|=16384;for(var n=0,r=0,i=e.members;r<i.length;r++){var s=i[r],o=Jh(s,n);gn(s).enumMemberValue=o,n="number"==typeof o?o+1:void 0}}}function Jh(t,n){if(Kr(t.name))ln(t.name,e.Diagnostics.Computed_property_names_are_not_allowed_in_enums);else{var r=e.getTextOfPropertyName(t.name);bu(r)&&!function(e){return"Infinity"===e||"-Infinity"===e||"NaN"===e}(r)&&ln(t.name,e.Diagnostics.An_enum_member_cannot_have_a_numeric_name)}return t.initializer?function(t){var n=Ii(er(t.parent)),r=e.isConst(t.parent),i=t.initializer,s=1!==n||Ci(t)?o(i):void 0;if(void 0!==s)r&&"number"==typeof s&&!isFinite(s)&&ln(i,isNaN(s)?e.Diagnostics.const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN:e.Diagnostics.const_enum_member_initializer_was_evaluated_to_a_non_finite_value);else{if(1===n)return ln(i,e.Diagnostics.Computed_values_are_not_permitted_in_an_enum_with_string_valued_members),0;r?ln(i,e.Diagnostics.In_const_enum_declarations_member_initializer_must_be_constant_expression):e.isInAmbientContext(t.parent)?ln(i,e.Diagnostics.In_ambient_enum_declarations_member_initializer_must_be_constant_expression):Ma(Ip(i),Oi(er(t.parent)),i,void 0)}return s;function o(n){switch(n.kind){case 192:var r=o(n.operand);if("number"==typeof r)switch(n.operator){case 37:return r;case 38:return-r;case 52:return~r}break;case 194:var i=o(n.left),s=o(n.right);if("number"==typeof i&&"number"==typeof s)switch(n.operatorToken.kind){case 49:return i|s;case 48:return i&s;case 46:return i>>s;case 47:return i>>>s;case 45:return i<<s;case 50:return i^s;case 39:return i*s;case 41:return i/s;case 37:return i+s;case 38:return i-s;case 42:return i%s}break;case 9:return n.text;case 8:return wm(n),+n.text;case 185:return o(n.expression);case 71:return e.nodeIsMissing(n)?0:a(n,er(t.parent),n.escapedText);case 180:case 179:var l=n;if(Yh(l)){var c=Cp(l.expression);if(c.symbol&&384&c.symbol.flags){var u=void 0;if(179===l.kind)u=l.name.escapedText;else{var d=l.argumentExpression;e.Debug.assert(e.isLiteralExpression(d)),u=e.escapeLeadingUnderscores(d.text)}return a(n,c.symbol,u)}}}}function a(n,r,i){var s=r.exports.get(i);if(s){var o=s.valueDeclaration;if(o!==t)return Tn(o,t)?gn(o).enumMemberValue:(ln(n,e.Diagnostics.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums),0)}}}(t):!e.isInAmbientContext(t.parent)||e.isConst(t.parent)?void 0!==n?n:void ln(t.name,e.Diagnostics.Enum_member_must_have_initializer):void 0}function Yh(e){return 71===e.kind||179===e.kind&&Yh(e.expression)||180===e.kind&&Yh(e.expression)&&9===e.argumentExpression.kind}function Xh(t){if(r){var n=e.isGlobalScopeAugmentation(t),i=e.isInAmbientContext(t);n&&!i&&ln(t.name,e.Diagnostics.Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambient_context);var s=e.isAmbientModule(t);if(rf(t,s?e.Diagnostics.An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file:e.Diagnostics.A_namespace_declaration_is_only_allowed_in_a_namespace_or_module))return;tm(t)||nm(t)||i||9!==t.name.kind||Cm(t.name,e.Diagnostics.Only_ambient_modules_can_use_quoted_names),e.isIdentifier(t.name)&&(fh(t,t.name),bh(t,t.name),vh(t,t.name)),Kp(t);var o=er(t);if(512&o.flags&&o.declarations.length>1&&!i&&l(t,E.preserveConstEnums||E.isolatedModules)){var a=function(t){for(var n=0,r=t.declarations;n<r.length;n++){var i=r[n];if((229===i.kind||228===i.kind&&e.nodeIsPresent(i.body))&&!e.isInAmbientContext(i))return i}}(o);a&&(e.getSourceFileOfNode(t)!==e.getSourceFileOfNode(a)?ln(t.name,e.Diagnostics.A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merged):t.pos<a.pos&&ln(t.name,e.Diagnostics.A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged));var c=e.getDeclarationOfKind(o,229);c&&(p=t,h=c,f=e.getEnclosingBlockScopeContainer(p),m=e.getEnclosingBlockScopeContainer(h),bn(f)?bn(m):!bn(m)&&f===m)&&(gn(t).flags|=32768)}if(s)if(e.isExternalModuleAugmentation(t)){if((n||33554432&er(t).flags)&&t.body)for(var u=0,d=t.body.statements;u<d.length;u++){Qh(d[u],n)}}else bn(t.parent)?n?ln(t.name,e.Diagnostics.Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations):e.isExternalModuleNameRelative(e.getTextOfIdentifierOrLiteral(t.name))&&ln(t.name,e.Diagnostics.Ambient_module_declaration_cannot_specify_relative_module_name):ln(t.name,n?e.Diagnostics.Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations:e.Diagnostics.Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces)}var p,h,f,m;t.body&&(lf(t.body),e.isGlobalScopeAugmentation(t)||sh(t))}function Qh(t,n){switch(t.kind){case 208:for(var r=0,i=t.declarationList.declarations;r<i.length;r++){Qh(i[r],n)}break;case 243:case 244:xm(t,e.Diagnostics.Exports_and_export_assignments_are_not_permitted_in_module_augmentations);break;case 237:case 238:xm(t,e.Diagnostics.Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_module);break;case 176:case 226:var s=t.name;if(e.isBindingPattern(s)){for(var o=0,a=s.elements;o<a.length;o++){Qh(a[o],n)}break}case 229:case 232:case 228:case 230:case 233:case 231:if(n)return;var l=er(t);if(l){var c=!(33554432&l.flags);c||(c=e.isExternalModuleAugmentation(l.parent.declarations[0]))}}}function Zh(e){switch(e.kind){case 71:return e;case 143:do{e=e.left}while(71!==e.kind);return e;case 179:do{e=e.expression}while(71!==e.kind);return e}}function ef(t){var n=e.getExternalModuleName(t);if(!e.nodeIsMissing(n)&&9!==n.kind)return ln(n,e.Diagnostics.String_literal_expected),!1;var r=234===t.parent.kind&&e.isAmbientModule(t.parent.parent);return 265===t.parent.kind||r?!(r&&e.isExternalModuleNameRelative(e.getTextOfIdentifierOrLiteral(n))&&!Dr(t))||(ln(t,e.Diagnostics.Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relative_module_name),!1):(ln(n,244===t.kind?e.Diagnostics.Export_declarations_are_not_permitted_in_a_namespace:e.Diagnostics.Import_declarations_in_a_namespace_cannot_reference_a_module),!1)}function tf(t){var n=er(t),r=Mn(n);if(r!==K){var i=(1156031&n.flags?107455:0)|(793064&n.flags?793064:0)|(1920&n.flags?1920:0);if(r.flags&i)ln(t,246===t.kind?e.Diagnostics.Export_declaration_conflicts_with_exported_declaration_of_0:e.Diagnostics.Import_declaration_conflicts_with_local_declaration_of_0,xr(n));!E.isolatedModules||246!==t.kind||107455&r.flags||e.isInAmbientContext(t)||ln(t,e.Diagnostics.Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided)}}function nf(e){fh(e,e.name),bh(e,e.name),vh(e,e.name),tf(e)}function rf(e,t){var n=265===e.parent.kind||234===e.parent.kind||233===e.parent.kind;return n||xm(e,t),!n}function sf(t){if(tf(t),!t.parent.parent.moduleSpecifier){var n=t.propertyName||t.name,r=kn(n,n.escapedText,2998271,void 0,void 0,!0);r&&(r===L||bn(Vr(r.declarations[0])))?ln(n,e.Diagnostics.Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module,e.idText(n)):Fn(t)}}function of(t){var n=er(t),r=_n(n);if(!r.exportsChecked){var i=n.exports.get("export=");if(i&&function(t){return e.forEachEntry(t.exports,(function(e,t){return"export="!==t}))}(n)){var s=Nn(i)||i.valueDeclaration;Dr(s)||ln(s,e.Diagnostics.An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements)}var o=Xn(n);o&&o.forEach((function(t,n){var r=t.declarations,i=t.flags;if("__export"!==n&&!(1984&i)){var s=e.countWhere(r,on);if(!(524288&i&&s<=2)&&s>1)for(var o=0,a=r;o<a.length;o++){var l=a[o];af(l)&&wt.add(e.createDiagnosticForNode(l,e.Diagnostics.Cannot_redeclare_exported_variable_0,e.unescapeLeadingUnderscores(n)))}}})),r.exportsChecked=!0}}function af(e){return 228!==e.kind&&151!==e.kind||!!e.body}function lf(t){if(t){if(e.isInJavaScriptFile(t)&&t.jsDoc)for(var n=0,i=t.jsDoc;n<i.length;n++){var s=i[n].tags;e.forEach(s,lf)}var o=t.kind;if(d)switch(o){case 233:case 229:case 230:case 228:d.throwIfCancellationRequested()}switch(o){case 145:return Ap(t);case 146:return wp(t);case 149:case 148:return Pp(t);case 160:case 161:case 155:case 156:case 157:return Op(t);case 151:case 150:return function(t){gm(t)||dm(t.name),ih(t),e.hasModifier(t,128)&&t.body&&ln(t,e.Diagnostics.Method_0_cannot_have_an_implementation_because_it_is_marked_abstract,e.declarationNameToString(t.name))}(t);case 152:return Mp(t);case 153:case 154:return Fp(t);case 159:return Up(t);case 158:return function(t){var n=function(e){switch(e.parent.kind){case 187:case 155:case 228:case 186:case 160:case 151:case 150:var t=e.parent;if(e===t.type)return t}}(t);if(n){var r=Rs(n).typePredicate;if(r){lf(t.type);var i=t.parameterName;if(e.isThisTypePredicate(r))da(i);else if(r.parameterIndex>=0)if(n.parameters[r.parameterIndex].dotDotDotToken)ln(i,e.Diagnostics.A_type_predicate_cannot_reference_a_rest_parameter);else{var s=e.chainDiagnosticMessages(void 0,e.Diagnostics.A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type);Ma(r.type,Tf(n.parameters[r.parameterIndex]),t.type,void 0,s)}else if(i){for(var o=!1,a=0,l=n.parameters;a<l.length;a++){var c=l[a].name;if(e.isBindingPattern(c)&&Dp(c,i,r.parameterName)){o=!0;break}}o||ln(t.parameterName,e.Diagnostics.Cannot_find_parameter_0,r.parameterName)}}}else ln(t,e.Diagnostics.A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods)}(t);case 162:return function(e){lo(e)}(t);case 163:return function(t){e.forEach(t.members,lf),r&&(Bh(ta(t)),Lp(t),Rp(t))}(t);case 164:return function(e){lf(e.elementType)}(t);case 165:return function(t){im(t.elementTypes)||0!==t.elementTypes.length||Cm(t,e.Diagnostics.A_tuple_type_element_list_cannot_be_empty),e.forEach(t.elementTypes,lf)}(t);case 166:case 167:return function(t){e.forEach(t.types,lf)}(t);case 168:case 170:return lf(t.type);case 277:return function(t){var n=e.getJSDocHost(t);if(e.isClassDeclaration(n)||e.isClassExpression(n)){var r=e.getAllJSDocTagsOfKind(n,277);e.Debug.assert(r.length>0),r.length>1&&ln(r[1],e.Diagnostics.Class_declarations_cannot_have_more_than_one_augments_or_extends_tag);var i=rh(t.class.expression),s=e.getClassExtendsHeritageClauseElement(n);if(s){var o=rh(s.expression);o&&i.escapedText!==o.escapedText&&ln(i,e.Diagnostics.JSDoc_0_1_does_not_match_the_extends_2_clause,e.idText(t.tagName),e.idText(i),e.idText(o))}}else ln(n,e.Diagnostics.JSDoc_0_is_not_attached_to_a_class,e.idText(t.tagName))}(t);case 283:return function(t){t.typeExpression||ln(t.name,e.Diagnostics.JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags)}(t);case 279:return function(t){lf(t.typeExpression),e.getParameterSymbolFromJSDoc(t)||ln(t.name,e.Diagnostics.JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name,e.idText(143===t.name.kind?t.name.right:t.name))}(t);case 273:Op(t);case 274:case 271:case 270:case 268:case 269:return void(e.isInJavaScriptFile(t)||e.isInJSDoc(t)||Cm(t,e.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments));case 267:return lf(t.type);case 171:return function(e){lf(e.objectType),lf(e.indexType),Vp(Zo(e),e)}(t);case 172:return function(e){lf(e.typeParameter),lf(e.type),Ma(ts(ea(e)),ee,e.typeParameter.constraint)}(t);case 228:return function(e){r&&(ih(e),pm(e),yh(e,e.name),fh(e,e.name),mh(e,e.name),bh(e,e.name),vh(e,e.name))}(t);case 207:case 234:return ph(t);case 208:return Ch(t);case 210:return function(e){Am(e),Ip(e.expression)}(t);case 211:return function(t){Am(t),Ip(t.expression),lf(t.thenStatement),209===t.thenStatement.kind&&ln(t.thenStatement,e.Diagnostics.The_body_of_an_if_statement_cannot_be_the_empty_statement),lf(t.elseStatement)}(t);case 212:return function(e){Am(e),lf(e.statement),Ip(e.expression)}(t);case 213:return function(e){Am(e),Ip(e.expression),lf(e.statement)}(t);case 214:return function(t){Am(t)||t.initializer&&227===t.initializer.kind&&Tm(t.initializer),t.initializer&&(227===t.initializer.kind?e.forEach(t.initializer.declarations,xh):Ip(t.initializer)),t.condition&&Ip(t.condition),t.incrementor&&Ip(t.incrementor),lf(t.statement),t.locals&&sh(t)}(t);case 215:return Ih(t);case 216:return function(t){if(fm(t),216===t.kind&&(t.awaitModifier?2==(6&e.getFunctionFlags(e.getContainingFunction(t)))&&x<5&&Zf(t,16384):E.downlevelIteration&&x<2&&Zf(t,256)),227===t.initializer.kind)Ah(t);else{var n=t.initializer,r=wh(t.expression,t.awaitModifier);if(177===n.kind||178===n.kind)up(n,r||J);else{var i=Ip(n);rp(n,e.Diagnostics.The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access),r&&Ma(r,i,n,void 0)}}lf(t.statement),t.locals&&sh(t)}(t);case 217:case 218:return Ph(t);case 219:return function(t){Am(t)||e.getContainingFunction(t)||xm(t,e.Diagnostics.A_return_statement_can_only_be_used_within_a_function_body);var n=e.getContainingFunction(t);if(n){var r=Ms(Rs(n));if(A||t.expression||8192&r.flags){var i=t.expression?yp(t.expression):Y,s=e.getFunctionFlags(n);if(1&s)return;if(154===n.kind)t.expression&&ln(t,e.Diagnostics.Setters_cannot_return_a_value);else if(152===n.kind)t.expression&&!Ma(i,r,t)&&ln(t,e.Diagnostics.Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class);else if(e.getEffectiveReturnTypeNode(n)||Mh(n))if(2&s){var o=zp(r),a=qp(i,t,e.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member);o&&Ma(a,o,t)}else Ma(i,r,t)}else 152!==n.kind&&E.noImplicitReturns&&!Fh(n,r)&&ln(t,e.Diagnostics.Not_all_code_paths_return_a_value)}}(t);case 220:return function(t){Am(t)||16384&t.flags&&xm(t,e.Diagnostics.with_statements_are_not_allowed_in_an_async_function_block),Ip(t.expression);var n=e.getSourceFileOfNode(t);if(!Em(n)){var r=e.getSpanOfTokenAtPosition(n,t.pos).start;Sm(n,r,t.statement.pos-r,e.Diagnostics.The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any)}}(t);case 221:return function(t){var n;Am(t);var i=!1,s=Ip(t.expression),o=dl(s);e.forEach(t.caseBlock.clauses,(function(a){if(258===a.kind&&!i)if(void 0===n)n=a;else{var l=e.getSourceFileOfNode(t),c=e.skipTrivia(l.text,a.pos);Sm(l,c,(a.statements.length>0?a.statements[0].pos:a.end)-c,e.Diagnostics.A_default_clause_cannot_appear_more_than_once_in_a_switch_statement),i=!0}if(r&&257===a.kind){var u=a,d=Ip(u.expression),p=dl(d),h=s;p&&o||(d=p?pl(d):d,h=pl(s)),pp(h,d)||Fa(d,h,u.expression,void 0)}e.forEach(a.statements,lf)})),t.caseBlock.locals&&sh(t.caseBlock)}(t);case 222:return function(t){Am(t)||e.findAncestor(t.parent,(function(n){if(e.isFunctionLike(n))return"quit";if(222===n.kind&&n.label.escapedText===t.label.escapedText){var r=e.getSourceFileOfNode(t);return Cm(t.label,e.Diagnostics.Duplicate_label_0,e.getTextOfNodeFromSourceText(r.text,t.label)),!0}})),lf(t.statement)}(t);case 223:return $h(t);case 224:return function(t){Am(t),ph(t.tryBlock);var n=t.catchClause;if(n){if(n.variableDeclaration)if(n.variableDeclaration.type)xm(n.variableDeclaration.type,e.Diagnostics.Catch_clause_variable_cannot_have_a_type_annotation);else if(n.variableDeclaration.initializer)xm(n.variableDeclaration.initializer,e.Diagnostics.Catch_clause_variable_cannot_have_an_initializer);else{var r=n.block.locals;r&&e.forEachKey(n.locals,(function(t){var n=r.get(t);n&&0!=(2&n.flags)&&Cm(n.valueDeclaration,e.Diagnostics.Cannot_redeclare_identifier_0_in_catch_clause,t)}))}ph(n.block)}t.finallyBlock&&ph(t.finallyBlock)}(t);case 226:return xh(t);case 176:return Sh(t);case 229:return function(t){t.name||e.hasModifier(t,512)||xm(t,e.Diagnostics.A_class_declaration_without_the_default_modifier_must_have_a_name),jh(t),e.forEach(t.members,lf),sh(t)}(t);case 230:return zh(t);case 231:return function(t){tm(t)||nm(t),Uh(t.name,e.Diagnostics.Type_alias_name_cannot_be_0),Vh(t.typeParameters),lf(t.type),sh(t)}(t);case 232:return function(t){if(r){tm(t)||nm(t),Uh(t.name,e.Diagnostics.Enum_name_cannot_be_0),fh(t,t.name),mh(t,t.name),bh(t,t.name),vh(t,t.name),Kp(t),qh(t);var n=e.isConst(t);E.isolatedModules&&n&&e.isInAmbientContext(t)&&ln(t.name,e.Diagnostics.Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided);var i=er(t);if(t===e.getDeclarationOfKind(i,t.kind)){i.declarations.length>1&&e.forEach(i.declarations,(function(t){e.isConstEnumDeclaration(t)!==n&&ln(e.getNameOfDeclaration(t),e.Diagnostics.Enum_declarations_must_all_be_const_or_non_const)}));var s=!1;e.forEach(i.declarations,(function(t){if(232!==t.kind)return!1;var n=t;if(!n.members.length)return!1;var r=n.members[0];r.initializer||(s?ln(r.name,e.Diagnostics.In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enum_element):s=!0)}))}}}(t);case 233:return Xh(t);case 238:return function(t){if(!rf(t,e.Diagnostics.An_import_declaration_can_only_be_used_in_a_namespace_or_module)&&(tm(t)||nm(t)||!e.hasModifiers(t)||xm(t,e.Diagnostics.An_import_declaration_cannot_have_modifiers),ef(t))){var n=t.importClause;n&&(n.name&&nf(n),n.namedBindings&&(240===n.namedBindings.kind?nf(n.namedBindings):e.forEach(n.namedBindings.elements,nf)))}}(t);case 237:return function(t){if(!rf(t,e.Diagnostics.An_import_declaration_can_only_be_used_in_a_namespace_or_module)&&(tm(t)||nm(t),e.isInternalModuleImportEqualsDeclaration(t)||ef(t)))if(nf(t),e.hasModifier(t,1)&&Fn(t),e.isInternalModuleImportEqualsDeclaration(t)){var n=Mn(er(t));if(n!==K){if(107455&n.flags){var r=Zh(t.moduleReference);1920&Vn(r,108479).flags||ln(r,e.Diagnostics.Module_0_is_hidden_by_a_local_declaration_with_the_same_name,e.declarationNameToString(r))}793064&n.flags&&Uh(t.name,e.Diagnostics.Import_name_cannot_be_0)}}else S>=e.ModuleKind.ES2015&&!e.isInAmbientContext(t)&&Cm(t,e.Diagnostics.Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_ns_from_mod_import_a_from_mod_import_d_from_mod_or_another_module_format_instead)}(t);case 244:return function(t){if(!rf(t,e.Diagnostics.An_export_declaration_can_only_be_used_in_a_module)&&(tm(t)||nm(t)||!e.hasModifiers(t)||xm(t,e.Diagnostics.An_export_declaration_cannot_have_modifiers),!t.moduleSpecifier||ef(t)))if(t.exportClause){e.forEach(t.exportClause.elements,sf);var n=234===t.parent.kind&&e.isAmbientModule(t.parent.parent),r=!n&&234===t.parent.kind&&!t.moduleSpecifier&&e.isInAmbientContext(t);265===t.parent.kind||n||r||ln(t,e.Diagnostics.Export_declarations_are_not_permitted_in_a_namespace)}else{var i=Hn(t,t.moduleSpecifier);i&&zn(i)&&ln(t.moduleSpecifier,e.Diagnostics.Module_0_uses_export_and_cannot_be_used_with_export_Asterisk,xr(i)),S!==e.ModuleKind.System&&S!==e.ModuleKind.ES2015&&S!==e.ModuleKind.ESNext&&Zf(t,32768)}}(t);case 243:return function(t){if(!rf(t,e.Diagnostics.An_export_assignment_can_only_be_used_in_a_module)){var n=265===t.parent.kind?t.parent:t.parent.parent;233!==n.kind||e.isAmbientModule(n)?(tm(t)||nm(t)||!e.hasModifiers(t)||xm(t,e.Diagnostics.An_export_assignment_cannot_have_modifiers),71===t.expression.kind?Fn(t):yp(t.expression),of(n),e.isInAmbientContext(t)&&!e.isEntityNameExpression(t.expression)&&Cm(t.expression,e.Diagnostics.The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context),t.isExportEquals&&!e.isInAmbientContext(t)&&(S>=e.ModuleKind.ES2015?Cm(t,e.Diagnostics.Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or_another_module_format_instead):S===e.ModuleKind.System&&Cm(t,e.Diagnostics.Export_assignment_is_not_supported_when_module_flag_is_system))):t.isExportEquals?ln(t,e.Diagnostics.An_export_assignment_cannot_be_used_in_a_namespace):ln(t,e.Diagnostics.A_default_export_can_only_be_used_in_an_ECMAScript_style_module)}}(t);case 209:case 225:return void Am(t);case 247:return function(e){nh(e)}(t)}}}function cf(e){Ye&&Ye.push(e)}function uf(t){e.performance.mark("beforeCheck"),function(t){var n=gn(t);if(!(1&n.flags)){if(E.skipLibCheck&&t.isDeclarationFile||E.skipDefaultLibCheck&&t.hasNoDefaultLib)return;!function(t){e.isInAmbientContext(t)&&function(t){for(var n=0,r=t.statements;n<r.length;n++){var i=r[n];if((e.isDeclaration(i)||208===i.kind)&&Im(i))return!0}}(t)}(t),e.clear(Ct),e.clear(It),Ye=[],Xe=r&&C?[]:void 0,ut=!1,e.forEach(t.statements,lf),function(){for(var e=0,t=Ye;e<t.length;e++){var n=t[e];switch(n.kind){case 186:case 187:case 151:case 150:Qd(n);break;case 153:case 154:Fp(n);break;case 199:Gh(n)}}}(),e.isExternalModule(t)&&sh(t),t.isDeclarationFile||function(){if(Xe)for(var e=0,t=Xe;e<t.length;e++){var n=t[e];switch(n.kind){case 265:case 233:dh(n);break;case 229:case 199:ch(n),uh(n);break;case 230:uh(n);break;case 207:case 235:case 214:case 215:case 216:oh(n);break;case 152:case 186:case 228:case 187:case 151:case 153:case 154:n.body&&oh(n),uh(n);break;case 150:case 155:case 156:case 157:case 160:case 161:case 231:uh(n)}}}(),Ye=void 0,Xe=void 0,e.isExternalOrCommonJsModule(t)&&of(t),Ct.length&&(e.forEach(Ct,_h),e.clear(Ct)),It.length&&(e.forEach(It,gh),e.clear(It)),n.flags|=1}}(t),e.performance.mark("afterCheck"),e.performance.measure("Check","beforeCheck","afterCheck")}function df(t,r){try{return d=r,function(t){if(pf(),t){var r=wt.getGlobalDiagnostics(),i=r.length;uf(t);var s=wt.getDiagnostics(t.fileName),o=wt.getGlobalDiagnostics();if(o!==r){var a=e.relativeComplement(r,o,e.compareDiagnostics);return e.concatenate(a,s)}return 0===i&&o.length>0?e.concatenate(o,s):s}return e.forEach(n.getSourceFiles(),uf),wt.getDiagnostics()}(t)}finally{d=void 0}}function pf(){if(!r)throw new Error("Trying to get diagnostics from a type checker that does not produce them.")}function hf(e){if(e)for(;e.parent;){if(220===e.parent.kind&&e.parent.statement===e)return!0;e=e.parent}return!1}function ff(e){switch(e.kind){case 145:case 229:case 230:case 231:case 232:return!0}}function mf(e){for(var t=e;t.parent&&143===t.parent.kind;)t=t.parent;return t.parent&&159===t.parent.kind}function _f(t,n){for(var r;(t=e.getContainingClass(t))&&!(r=n(t)););return r}function gf(e,t){return!!_f(e,(function(e){return e===t}))}function yf(e){return void 0!==function(e){for(;143===e.parent.kind;)e=e.parent;return 237===e.parent.kind?e.parent.moduleReference===e&&e.parent:243===e.parent.kind?e.parent.expression===e&&e.parent:void 0}(e)}function bf(t){if(e.isDeclarationName(t))return er(t.parent);if(e.isInJavaScriptFile(t)&&179===t.parent.kind&&t.parent===t.parent.parent.left){var n=function(t){switch(e.getSpecialPropertyAssignmentKind(t.parent.parent)){case 1:case 3:return er(t.parent);case 4:case 2:case 5:return er(t.parent.parent)}}(t);if(n)return n}if(243===t.parent.kind&&e.isEntityNameExpression(t))return Vn(t,2998271);if(179!==t.kind&&yf(t)){var r=e.getAncestor(t,237);return e.Debug.assert(void 0!==r),Bn(t,!0)}if(e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),function(e){for(var t=e;t.parent&&179===t.parent.kind;)t=t.parent;return t.parent&&201===t.parent.kind}(t)){var i=0;201===t.parent.kind?(i=793064,e.isExpressionWithTypeArgumentsInClassExtendsClause(t.parent)&&(i|=107455)):i=1920;var s=Vn(t,i|=2097152);if(s)return s}if(279===t.parent.kind)return e.getParameterSymbolFromJSDoc(t.parent);if(145===t.parent.kind&&282===t.parent.parent.kind){e.Debug.assert(!e.isInJavaScriptFile(t));var o=e.getTypeParameterFromJsDoc(t.parent);return o&&o.symbol}if(e.isPartOfExpression(t)){if(e.nodeIsMissing(t))return;if(71===t.kind)return e.isJSXTagName(t)&&Su(t)?Au(t.parent):Vn(t,107455,!1,!0);if(179===t.kind||143===t.kind){var a=gn(t);return a.resolvedSymbol||(179===t.kind?Wu(t):zu(t)),a.resolvedSymbol}}else{if(mf(t))return Vn(t,i=159===t.parent.kind?793064:1920,!1,!0);if(253===t.parent.kind)return bs(Mu((l=t.parent).parent.parent),l.name.escapedText)||K}var l;return 158===t.parent.kind?Vn(t,1):void 0}function vf(t){if(265===t.kind)return e.isExternalModule(t)?Zn(t.symbol):void 0;if(!hf(t)){if(c(t))return er(t.parent);if(e.isLiteralComputedPropertyDeclarationName(t))return er(t.parent.parent);if(71===t.kind){if(yf(t))return bf(t);if(176===t.parent.kind&&174===t.parent.parent.kind&&t===t.parent.propertyName){var n=Tf(t.parent.parent),r=n&&bs(n,t.escapedText);if(r)return r}}switch(t.kind){case 71:case 179:case 143:return bf(t);case 99:var i=e.getThisContainer(t,!1);if(e.isFunctionLike(i)){var s=Rs(i);if(s.thisParameter)return s.thisParameter}if(e.isInExpressionContext(t))return Ip(t).symbol;case 169:return da(t).symbol;case 97:return Ip(t).symbol;case 123:var o=t.parent;return o&&152===o.kind?o.parent.symbol:void 0;case 9:if(e.isExternalModuleImportEqualsDeclaration(t.parent.parent)&&e.getExternalModuleImportEqualsDeclarationExpression(t.parent.parent)===t||(238===t.parent.kind||244===t.parent.kind)&&t.parent.moduleSpecifier===t||e.isInJavaScriptFile(t)&&e.isRequireCall(t.parent,!1)||e.isImportCall(t.parent))return Hn(t,t);case 8:var a=e.isElementAccessExpression(t.parent)?t.parent.argumentExpression===t?Cp(t.parent.expression):void 0:e.isLiteralTypeNode(t.parent)&&e.isIndexedAccessTypeNode(t.parent.parent)?pa(t.parent.parent.objectType):void 0;return a&&bs(a,e.escapeLeadingUnderscores(t.text));case 79:return er(t.parent);default:return}}}function Tf(t){if(hf(t))return J;if(e.isPartOfTypeNode(t)){var n=pa(t);if(n&&e.isExpressionWithTypeArgumentsInClassImplementsClause(t))n=Ui(n,(r=Tf(e.getContainingClass(t))).thisType);return n}if(e.isPartOfExpression(t))return Ef(t);if(e.isExpressionWithTypeArgumentsInClassExtendsClause(t)){var r,i=Ei(r=Oi(er(e.getContainingClass(t))))[0];return i&&Ui(i,r.thisType)}if(ff(t))return Oi(s=er(t));if(function(e){return 71===e.kind&&ff(e.parent)&&e.parent.name===e}(t))return(s=vf(t))&&Oi(s);if(e.isDeclaration(t))return li(s=er(t));if(c(t))return(s=vf(t))&&li(s);if(e.isBindingPattern(t))return Xr(t.parent,!0);if(yf(t)){var s,o=(s=vf(t))&&Oi(s);return o!==J?o:li(s)}return J}function kf(t){if(e.Debug.assert(178===t.kind||177===t.kind),216===t.parent.kind)return up(t,wh(t.parent.expression,t.parent.awaitModifier)||J);if(194===t.parent.kind)return up(t,Cp(t.parent.right)||J);if(261===t.parent.kind)return lp(kf(t.parent.parent)||J,t.parent);e.Debug.assert(177===t.parent.kind);var n=kf(t.parent),r=Nh(n||J,t.parent,!1,!1)||J;return cp(t.parent,n,e.indexOf(t.parent.elements,t),r||J)}function Ef(t){return e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),ca(Cp(t))}function xf(t){if(!e.isGeneratedIdentifier(t)&&(t=e.getParseTreeNode(t,e.isIdentifier)))return!(179===t.parent.kind&&t.parent.name===t)&&qf(t)===F;return!1}function Sf(t){var n=Hn(t.parent,t);if(!n||e.isShorthandAmbientModuleSymbol(n))return!0;var r=zn(n),i=_n(n=Kn(n));return void 0===i.exportsSomeValue&&(i.exportsSomeValue=r?!!(107455&n.flags):e.forEachEntry(Xn(n),(function(e){return(e=Pn(e))&&!!(107455&e.flags)}))),i.exportsSomeValue}function Cf(t,n){if(t=e.getParseTreeNode(t,e.isIdentifier)){var r=qf(t,function(t){var n=t.parent;return n&&e.isModuleOrEnumDeclaration(n)&&t===n.name}(t));if(r){if(1048576&r.flags){var i=Zn(r.exportSymbol);if(!n&&944&i.flags)return;r=i}var s=tr(r);if(s){if(512&s.flags&&265===s.valueDeclaration.kind){var o=s.valueDeclaration;return o!==e.getSourceFileOfNode(t)?void 0:o}return e.findAncestor(t.parent,(function(t){return e.isModuleOrEnumDeclaration(t)&&er(t)===s}))}}}}function If(t){if(t=e.getParseTreeNode(t,e.isIdentifier)){var n=qf(t);if(Ln(n,107455))return Nn(n)}}function Af(t){if(418&t.flags){var n=_n(t);if(void 0===n.isDeclarationWithCollidingName){var r=e.getEnclosingBlockScopeContainer(t.valueDeclaration);if(e.isStatementWithLocals(r)){var i=gn(t.valueDeclaration);if(kn(r.parent,t.escapedName,107455,void 0,void 0,!1))n.isDeclarationWithCollidingName=!0;else if(131072&i.flags){var s=262144&i.flags,o=e.isIterationStatement(r,!1),a=207===r.kind&&e.isIterationStatement(r.parent,!1);n.isDeclarationWithCollidingName=!(e.isBlockScopedContainerTopLevel(r)||s&&(o||a))}else n.isDeclarationWithCollidingName=!1}}return n.isDeclarationWithCollidingName}return!1}function wf(t){if(!e.isGeneratedIdentifier(t)&&(t=e.getParseTreeNode(t,e.isIdentifier))){var n=qf(t);if(n&&Af(n))return n.valueDeclaration}}function Nf(t){if(t=e.getParseTreeNode(t,e.isDeclaration)){var n=er(t);if(n)return Af(n)}return!1}function Df(t){switch(t.kind){case 237:case 239:case 240:case 242:case 246:return Rf(er(t)||K);case 244:var n=t.exportClause;return n&&e.forEach(n.elements,Df);case 243:return!t.expression||71!==t.expression.kind||Rf(er(t)||K)}return!1}function Of(t){return!(void 0===(t=e.getParseTreeNode(t,e.isImportEqualsDeclaration))||265!==t.parent.kind||!e.isInternalModuleImportEqualsDeclaration(t))&&(Rf(er(t))&&t.moduleReference&&!e.nodeIsMissing(t.moduleReference))}function Rf(e){var t=Mn(e);return t===K||107455&t.flags&&(E.preserveConstEnums||!Lf(t))}function Lf(e){return ap(e)||e.constEnumOnlyModule}function Pf(t,n){if(e.isAliasSymbolDeclaration(t)){var r=er(t);if(r&&_n(r).referenced)return!0}return!!n&&e.forEachChild(t,(function(e){return Pf(e,n)}))}function Mf(t){if(e.nodeIsPresent(t.body)){var n=Ls(er(t));return n.length>1||1===n.length&&n[0].declaration!==t}return!1}function Ff(t){return A&&!Ns(t)&&t.initializer&&!e.hasModifier(t,92)}function $f(t){return A&&Ns(t)&&!t.initializer&&e.hasModifier(t,92)}function Bf(e){return gn(e).flags}function Uf(e){return qh(e.parent),gn(e).enumMemberValue}function Vf(e){switch(e.kind){case 264:case 179:case 180:return!0}return!1}function Hf(t){if(264===t.kind)return Uf(t);var n=gn(t).resolvedSymbol;return n&&8&n.flags&&e.isConstEnumDeclaration(n.valueDeclaration.parent)?Uf(n.valueDeclaration):void 0}function Gf(t,n){if(!(t=e.getParseTreeNode(t,e.isEntityName)))return e.TypeReferenceSerializationKind.Unknown;if(n&&!(n=e.getParseTreeNode(n)))return e.TypeReferenceSerializationKind.Unknown;var r=Vn(t,107455,!0,!1,n),i=Vn(t,793064,!0,!1,n);if(r&&r===i){var s=_o(!1);if(s&&r===s)return e.TypeReferenceSerializationKind.Promise;var o=li(r);if(o&&yi(o))return e.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue}if(!i)return e.TypeReferenceSerializationKind.ObjectType;var a=Oi(i);return a===J?e.TypeReferenceSerializationKind.Unknown:1&a.flags?e.TypeReferenceSerializationKind.ObjectType:sp(a,15360)?e.TypeReferenceSerializationKind.VoidNullableOrNeverType:sp(a,136)?e.TypeReferenceSerializationKind.BooleanType:sp(a,84)?e.TypeReferenceSerializationKind.NumberLikeType:sp(a,262178)?e.TypeReferenceSerializationKind.StringLikeType:fl(a)?e.TypeReferenceSerializationKind.ArrayLikeType:sp(a,512)?e.TypeReferenceSerializationKind.ESSymbolType:function(e){return 32768&e.flags&&Ts(e,0).length>0}(a)?e.TypeReferenceSerializationKind.TypeWithCallSignature:al(a)?e.TypeReferenceSerializationKind.ArrayLikeType:e.TypeReferenceSerializationKind.ObjectType}function jf(e,t,n,r){var i=er(e),s=!i||133120&i.flags?J:hl(li(i));8192&n&&(s=vl(s,2048)),Lr().buildTypeDisplay(s,r,t,n)}function Kf(e,t,n,r){var i=Rs(e);Lr().buildTypeDisplay(Ms(i),r,t,n)}function Wf(e,t,n,r){var i=Il(Ef(e));Lr().buildTypeDisplay(i,r,t,n)}function zf(t){return ot.has(e.escapeLeadingUnderscores(t))}function qf(t,n){var r=gn(t).resolvedSymbol;if(r)return r;var i=t;if(n){var s=t.parent;e.isDeclaration(s)&&t===s.name&&(i=Vr(s))}return kn(i,t.escapedText,3253183,void 0,void 0,!0)}function Jf(t){if(!e.isGeneratedIdentifier(t)&&(t=e.getParseTreeNode(t,e.isIdentifier))){var n=qf(t);if(n)return nr(n).valueDeclaration}}function Yf(t){if(e.isConst(t)){var n=li(er(t));return!!(96&n.flags&&1048576&n.flags)}return!1}function Xf(e,t){var n=li(er(e));t.writeStringLiteral(Or(n))}function Qf(t){var n=e.getExternalModuleName(t),r=Gn(n,n,void 0);if(r)return e.getDeclarationOfKind(r,265)}function Zf(t,n){if((p&n)!==n&&E.importHelpers){var r=e.getSourceFileOfNode(t);if(e.isEffectiveExternalModule(r,E)&&!e.isInAmbientContext(t)){var i=function(t,n){h||(h=jn(t,e.externalHelpersModuleNameText,e.Diagnostics.This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found,n)||K);return h}(r,t);if(i!==K)for(var s=n&~p,o=1;o<=65536;o<<=1)if(s&o){var a=em(o);vn(i.exports,e.escapeLeadingUnderscores(a),107455)||ln(t,e.Diagnostics.This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1,e.externalHelpersModuleNameText,a)}p|=n}}}function em(t){switch(t){case 1:return"__extends";case 2:return"__assign";case 4:return"__rest";case 8:return"__decorate";case 16:return"__metadata";case 32:return"__param";case 64:return"__awaiter";case 128:return"__generator";case 256:return"__values";case 512:return"__read";case 1024:return"__spread";case 2048:return"__await";case 4096:return"__asyncGenerator";case 8192:return"__asyncDelegator";case 16384:return"__asyncValues";case 32768:return"__exportStar";case 65536:return"__makeTemplateObject";default:e.Debug.fail("Unrecognized helper")}}function tm(t){if(!t.decorators)return!1;if(!e.nodeCanBeDecorated(t))return 151!==t.kind||e.nodeIsPresent(t.body)?xm(t,e.Diagnostics.Decorators_are_not_valid_here):xm(t,e.Diagnostics.A_decorator_can_only_decorate_a_method_implementation_not_an_overload);if(153===t.kind||154===t.kind){var n=e.getAllAccessorDeclarations(t.parent.members,t);if(n.firstAccessor.decorators&&t===n.secondAccessor)return xm(t,e.Diagnostics.Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name)}return!1}function nm(t){var n,r,i,s,o=function(t){return!!t.modifiers&&(function(t){switch(t.kind){case 153:case 154:case 152:case 149:case 148:case 151:case 150:case 157:case 233:case 238:case 237:case 244:case 243:case 186:case 187:case 146:return!1;default:if(234===t.parent.kind||265===t.parent.kind)return!1;switch(t.kind){case 228:return rm(t,120);case 229:return rm(t,117);case 230:case 208:case 231:return!0;case 232:return rm(t,76);default:return e.Debug.fail(),!1}}}(t)?xm(t,e.Diagnostics.Modifiers_cannot_appear_here):void 0)}(t);if(void 0!==o)return o;for(var a=0,l=0,c=t.modifiers;l<c.length;l++){var u=c[l];if(131!==u.kind){if(148===t.kind||150===t.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_type_member,e.tokenToString(u.kind));if(157===t.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_an_index_signature,e.tokenToString(u.kind))}switch(u.kind){case 76:if(232!==t.kind&&229===t.parent.kind)return Cm(t,e.Diagnostics.A_class_member_cannot_have_the_0_keyword,e.tokenToString(76));break;case 114:case 113:case 112:var d=wr(e.modifierToFlag(u.kind));if(28&a)return Cm(u,e.Diagnostics.Accessibility_modifier_already_seen);if(32&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"static");if(64&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"readonly");if(256&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"async");if(234===t.parent.kind||265===t.parent.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_module_or_namespace_element,d);if(128&a)return 112===u.kind?Cm(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,d,"abstract"):Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,d,"abstract");a|=e.modifierToFlag(u.kind);break;case 115:if(32&a)return Cm(u,e.Diagnostics._0_modifier_already_seen,"static");if(64&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"static","readonly");if(256&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"static","async");if(234===t.parent.kind||265===t.parent.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_module_or_namespace_element,"static");if(146===t.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"static");if(128&a)return Cm(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"static","abstract");a|=32,n=u;break;case 131:if(64&a)return Cm(u,e.Diagnostics._0_modifier_already_seen,"readonly");if(149!==t.kind&&148!==t.kind&&157!==t.kind&&146!==t.kind)return Cm(u,e.Diagnostics.readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature);a|=64,s=u;break;case 84:if(1&a)return Cm(u,e.Diagnostics._0_modifier_already_seen,"export");if(2&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"export","declare");if(128&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"export","abstract");if(256&a)return Cm(u,e.Diagnostics._0_modifier_must_precede_1_modifier,"export","async");if(229===t.parent.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_class_element,"export");if(146===t.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"export");a|=1;break;case 79:var p=265===t.parent.kind?t.parent:t.parent.parent;if(233===p.kind&&!e.isAmbientModule(p))return Cm(u,e.Diagnostics.A_default_export_can_only_be_used_in_an_ECMAScript_style_module);a|=512;break;case 124:if(2&a)return Cm(u,e.Diagnostics._0_modifier_already_seen,"declare");if(256&a)return Cm(u,e.Diagnostics._0_modifier_cannot_be_used_in_an_ambient_context,"async");if(229===t.parent.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_class_element,"declare");if(146===t.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"declare");if(e.isInAmbientContext(t.parent)&&234===t.parent.kind)return Cm(u,e.Diagnostics.A_declare_modifier_cannot_be_used_in_an_already_ambient_context);a|=2,r=u;break;case 117:if(128&a)return Cm(u,e.Diagnostics._0_modifier_already_seen,"abstract");if(229!==t.kind){if(151!==t.kind&&149!==t.kind&&153!==t.kind&&154!==t.kind)return Cm(u,e.Diagnostics.abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration);if(229!==t.parent.kind||!e.hasModifier(t.parent,128))return Cm(u,e.Diagnostics.Abstract_methods_can_only_appear_within_an_abstract_class);if(32&a)return Cm(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"static","abstract");if(8&a)return Cm(u,e.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"private","abstract")}a|=128;break;case 120:if(256&a)return Cm(u,e.Diagnostics._0_modifier_already_seen,"async");if(2&a||e.isInAmbientContext(t.parent))return Cm(u,e.Diagnostics._0_modifier_cannot_be_used_in_an_ambient_context,"async");if(146===t.kind)return Cm(u,e.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"async");a|=256,i=u}}return 152===t.kind?32&a?Cm(n,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"static"):128&a?Cm(n,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"abstract"):256&a?Cm(i,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"async"):64&a?Cm(s,e.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"readonly"):void 0:(238===t.kind||237===t.kind)&&2&a?Cm(r,e.Diagnostics.A_0_modifier_cannot_be_used_with_an_import_declaration,"declare"):146===t.kind&&92&a&&e.isBindingPattern(t.name)?Cm(t,e.Diagnostics.A_parameter_property_may_not_be_declared_using_a_binding_pattern):146===t.kind&&92&a&&t.dotDotDotToken?Cm(t,e.Diagnostics.A_parameter_property_cannot_be_declared_using_a_rest_parameter):256&a?function(t,n){switch(t.kind){case 151:case 228:case 186:case 187:return!1}return Cm(n,e.Diagnostics._0_modifier_cannot_be_used_here,"async")}(t,i):void 0}function rm(e,t){return e.modifiers.length>1||e.modifiers[0].kind!==t}function im(t){if(t&&t.hasTrailingComma){var n=t.end-",".length,r=t.end;return Sm(t[0],n,r-n,e.Diagnostics.Trailing_comma_not_allowed)}}function sm(t,n){if(im(t))return!0;if(t&&0===t.length){var r=t.pos-"<".length;return Sm(n,r,e.skipTrivia(n.text,t.end)+">".length-r,e.Diagnostics.Type_parameter_list_cannot_be_empty)}}function om(t){var n=e.getSourceFileOfNode(t);return tm(t)||nm(t)||sm(t.typeParameters,n)||function(t){for(var n=!1,r=t.length,i=0;i<r;i++){var s=t[i];if(s.dotDotDotToken){if(i!==r-1)return Cm(s.dotDotDotToken,e.Diagnostics.A_rest_parameter_must_be_last_in_a_parameter_list);if(e.isBindingPattern(s.name))return Cm(s.name,e.Diagnostics.A_rest_element_cannot_contain_a_binding_pattern);if(s.questionToken)return Cm(s.questionToken,e.Diagnostics.A_rest_parameter_cannot_be_optional);if(s.initializer)return Cm(s.name,e.Diagnostics.A_rest_parameter_cannot_have_an_initializer)}else if(s.questionToken){if(n=!0,s.initializer)return Cm(s.name,e.Diagnostics.Parameter_cannot_have_question_mark_and_initializer)}else if(n&&!s.initializer)return Cm(s.name,e.Diagnostics.A_required_parameter_cannot_follow_an_optional_parameter)}}(t.parameters)||function(t,n){if(187===t.kind){var r=t;if(e.getLineAndCharacterOfPosition(n,r.equalsGreaterThanToken.pos).line!==e.getLineAndCharacterOfPosition(n,r.equalsGreaterThanToken.end).line)return Cm(r.equalsGreaterThanToken,e.Diagnostics.Line_terminator_not_permitted_before_arrow)}return!1}(t,n)}function am(t,n){return im(n)||function(t,n){if(n&&0===n.length){var r=e.getSourceFileOfNode(t),i=n.pos-"<".length;return Sm(r,i,e.skipTrivia(r.text,n.end)+">".length-i,e.Diagnostics.Type_argument_list_cannot_be_empty)}}(t,n)}function lm(t){return function(t){if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(200===i.kind)return Sm(i,i.pos,0,e.Diagnostics.Argument_expression_expected)}}(t)}function cm(t){var n=t.types;if(im(n))return!0;if(n&&0===n.length){var r=e.tokenToString(t.token);return Sm(t,n.pos,0,e.Diagnostics._0_list_cannot_be_empty,r)}return e.forEach(n,um)}function um(e){return am(e,e.typeArguments)}function dm(t){if(144!==t.kind)return!1;var n=t;return 194===n.expression.kind&&26===n.expression.operatorToken.kind?Cm(n.expression,e.Diagnostics.A_comma_expression_is_not_allowed_in_a_computed_property_name):void 0}function pm(t){if(t.asteriskToken){if(e.Debug.assert(228===t.kind||186===t.kind||151===t.kind),e.isInAmbientContext(t))return Cm(t.asteriskToken,e.Diagnostics.Generators_are_not_allowed_in_an_ambient_context);if(!t.body)return Cm(t.asteriskToken,e.Diagnostics.An_overload_signature_cannot_be_declared_as_a_generator)}}function hm(e,t){if(e)return Cm(e,t)}function fm(t){if(Am(t))return!0;if(216===t.kind&&t.awaitModifier&&0==(16384&t.flags))return Cm(t.awaitModifier,e.Diagnostics.A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator);if(227===t.initializer.kind){var n=t.initializer;if(!Tm(n)){var r=n.declarations;if(!r.length)return!1;if(r.length>1){var i=215===t.kind?e.Diagnostics.Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement:e.Diagnostics.Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement;return xm(n.declarations[1],i)}var s=r[0];if(s.initializer){var i=215===t.kind?e.Diagnostics.The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer:e.Diagnostics.The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer;return Cm(s.name,i)}if(s.type)return Cm(s,i=215===t.kind?e.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation:e.Diagnostics.The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation)}}return!1}function mm(t){if(t.parameters.length===(153===t.kind?1:2))return e.getThisParameter(t)}function _m(t,n){if(e.isDynamicName(t))return Cm(t,n)}function gm(t){if(function(t){if(t.modifiers&&178===t.parent.kind){if(!(2&e.getFunctionFlags(t)))return xm(t,e.Diagnostics.Modifiers_cannot_appear_here);if(t.modifiers.length>1)return xm(t,e.Diagnostics.Modifiers_cannot_appear_here)}}(t)||om(t)||pm(t))return!0;if(178===t.parent.kind){if(hm(t.questionToken,e.Diagnostics.An_object_member_cannot_be_declared_optional))return!0;if(void 0===t.body)return Sm(t,t.end-1,";".length,e.Diagnostics._0_expected,"{")}if(e.isClassLike(t.parent)){if(e.isInAmbientContext(t))return _m(t.name,e.Diagnostics.A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol);if(!t.body)return _m(t.name,e.Diagnostics.A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol)}else{if(230===t.parent.kind)return _m(t.name,e.Diagnostics.A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol);if(163===t.parent.kind)return _m(t.name,e.Diagnostics.A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol)}}function ym(e){return 9===e.kind||8===e.kind||192===e.kind&&38===e.operator&&8===e.operand.kind}function bm(t){if(71===t.kind){if("__esModule"===e.idText(t))return Cm(t,e.Diagnostics.Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules)}else for(var n=0,r=t.elements;n<r.length;n++){var i=r[n];if(!e.isOmittedExpression(i))return bm(i.name)}}function vm(t){if(71===t.kind){if(110===t.originalKeywordKind)return Cm(t,e.Diagnostics.let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations)}else for(var n=0,r=t.elements;n<r.length;n++){var i=r[n];e.isOmittedExpression(i)||vm(i.name)}}function Tm(t){var n=t.declarations;return!!im(t.declarations)||(t.declarations.length?void 0:Sm(t,n.pos,n.end-n.pos,e.Diagnostics.Variable_declaration_list_cannot_be_empty))}function km(e){switch(e.kind){case 211:case 212:case 213:case 220:case 214:case 215:case 216:return!1;case 222:return km(e.parent)}return!0}function Em(e){return e.parseDiagnostics.length>0}function xm(t,n,r,i,s){var o=e.getSourceFileOfNode(t);if(!Em(o)){var a=e.getSpanOfTokenAtPosition(o,t.pos);return wt.add(e.createFileDiagnostic(o,a.start,a.length,n,r,i,s)),!0}}function Sm(t,n,r,i,s,o,a){var l=e.getSourceFileOfNode(t);if(!Em(l))return wt.add(e.createFileDiagnostic(l,n,r,i,s,o,a)),!0}function Cm(t,n,r,i,s){if(!Em(e.getSourceFileOfNode(t)))return wt.add(e.createDiagnosticForNode(t,n,r,i,s)),!0}function Im(t){return 230!==t.kind&&231!==t.kind&&238!==t.kind&&237!==t.kind&&244!==t.kind&&243!==t.kind&&236!==t.kind&&!e.hasModifier(t,515)&&xm(t,e.Diagnostics.A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file)}function Am(t){if(e.isInAmbientContext(t)){if(e.isAccessor(t.parent))return gn(t).hasReportedStatementInAmbientContext=!0;if(!gn(t).hasReportedStatementInAmbientContext&&e.isFunctionLike(t.parent))return gn(t).hasReportedStatementInAmbientContext=xm(t,e.Diagnostics.An_implementation_cannot_be_declared_in_ambient_contexts);if(207===t.parent.kind||234===t.parent.kind||265===t.parent.kind){var n=gn(t.parent);if(!n.hasReportedStatementInAmbientContext)return n.hasReportedStatementInAmbientContext=xm(t,e.Diagnostics.Statements_are_not_allowed_in_ambient_contexts)}}}function wm(t){if(4&t.numericLiteralFlags){var n=void 0;if(x>=1?n=e.Diagnostics.Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0:e.isChildOfNodeWithKind(t,173)?n=e.Diagnostics.Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0:e.isChildOfNodeWithKind(t,264)&&(n=e.Diagnostics.Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0),n){var r=e.isPrefixUnaryExpression(t.parent)&&38===t.parent.operator,i=(r?"-":"")+"0o"+t.text;return Cm(r?t.parent:t,n,i)}}}}}(ts||(ts={})),function(e){function t(t){var n=e.createNode(t,-1,-1);return n.flags|=8,n}function n(t,n){return t!==n&&(Rt(t,n),It(t,n),n.startsOnNewLine&&(t.startsOnNewLine=!0),e.aggregateTransformFlags(t)),t}function r(t,n){if(t){if(e.isNodeArray(t))return t}else t=[];var r=t;return r.pos=-1,r.end=-1,r.hasTrailingComma=n,r}function i(e){if(void 0!==e){var n=t(e.kind);for(var r in n.flags|=e.flags,Rt(n,e),e)!n.hasOwnProperty(r)&&e.hasOwnProperty(r)&&(n[r]=e[r]);return n}}function s(t){return"number"==typeof t?o(t+""):"boolean"==typeof t?t?p():h():e.isString(t)?a(t):(n=t,(r=a(e.getTextOfIdentifierOrLiteral(n))).textSourceNode=n,r);var n,r}function o(e){var n=t(8);return n.text=e,n.numericLiteralFlags=0,n}function a(e){var n=t(9);return n.text=e,n}function l(n,i){var s=t(71);return s.escapedText=e.escapeLeadingUnderscores(n),s.originalKeywordKind=n?e.stringToToken(n):0,s.autoGenerateKind=0,s.autoGenerateId=0,i&&(s.typeArguments=r(i)),s}e.updateNode=n,e.createNodeArray=r,e.getSynthesizedClone=i,e.createLiteral=s,e.createNumericLiteral=o,e.createIdentifier=l,e.updateIdentifier=function(t,r){return t.typeArguments!==r?n(l(e.idText(t),r),t):t};var c,u=0;function d(e){return t(e)}function p(){return t(101)}function h(){return t(86)}function f(e,n){var r=t(143);return r.left=e,r.right=xt(n),r}function m(e){var n=t(144);return n.expression=e,n}function _(e,n,r){var i=t(145);return i.name=xt(e),i.constraint=n,i.default=r,i}function g(n,r,i,s,o,a,l){var c=t(146);return c.decorators=St(n),c.modifiers=St(r),c.dotDotDotToken=i,c.name=xt(s),c.questionToken=o,c.type=a,c.initializer=l?e.parenthesizeExpressionForList(l):void 0,c}function y(n){var r=t(147);return r.expression=e.parenthesizeForAccess(n),r}function b(e,n,r,i,s){var o=t(148);return o.modifiers=St(e),o.name=xt(n),o.questionToken=r,o.type=i,o.initializer=s,o}function v(e,n,r,i,s,o){var a=t(149);return a.decorators=St(e),a.modifiers=St(n),a.name=xt(r),a.questionToken=i,a.type=s,a.initializer=o,a}function T(e,t,n,r,i){var s=I(150,e,t,n);return s.name=xt(r),s.questionToken=i,s}function k(e,n,i,s,o,a,l,c,u){var d=t(151);return d.decorators=St(e),d.modifiers=St(n),d.asteriskToken=i,d.name=xt(s),d.questionToken=o,d.typeParameters=St(a),d.parameters=r(l),d.type=c,d.body=u,d}function E(e,n,i,s){var o=t(152);return o.decorators=St(e),o.modifiers=St(n),o.typeParameters=void 0,o.parameters=r(i),o.type=void 0,o.body=s,o}function x(e,n,i,s,o,a){var l=t(153);return l.decorators=St(e),l.modifiers=St(n),l.name=xt(i),l.typeParameters=void 0,l.parameters=r(s),l.type=o,l.body=a,l}function S(e,n,i,s,o){var a=t(154);return a.decorators=St(e),a.modifiers=St(n),a.name=xt(i),a.typeParameters=void 0,a.parameters=r(s),a.body=o,a}function C(e,n,i,s){var o=t(157);return o.decorators=St(e),o.modifiers=St(n),o.parameters=r(i),o.type=s,o}function I(e,n,r,i){var s=t(e);return s.typeParameters=St(n),s.parameters=St(r),s.type=i,s}function A(e,t,r,i){return e.typeParameters!==t||e.parameters!==r||e.type!==i?n(I(e.kind,t,r,i),e):e}function w(e,n){var r=t(158);return r.parameterName=xt(e),r.type=n,r}function N(n,r){var i=t(159);return i.typeName=xt(n),i.typeArguments=r&&e.parenthesizeTypeParameters(r),i}function D(e){var n=t(162);return n.exprName=e,n}function O(e){var n=t(163);return n.members=r(e),n}function R(n){var r=t(164);return r.elementType=e.parenthesizeArrayTypeMember(n),r}function L(e){var n=t(165);return n.elementTypes=r(e),n}function P(n,r){var i=t(n);return i.types=e.parenthesizeElementTypeMembers(r),i}function M(e,t){return e.types!==t?n(P(e.kind,t),e):e}function F(e){var n=t(168);return n.type=e,n}function $(n){var r=t(170);return r.operator=127,r.type=e.parenthesizeElementTypeMember(n),r}function B(n,r){var i=t(171);return i.objectType=e.parenthesizeElementTypeMember(n),i.indexType=r,i}function U(e,n,r,i){var s=t(172);return s.readonlyToken=e,s.typeParameter=n,s.questionToken=r,s.type=i,s}function V(e){var n=t(173);return n.literal=e,n}function H(e){var n=t(174);return n.elements=r(e),n}function G(e){var n=t(175);return n.elements=r(e),n}function j(e,n,r,i){var s=t(176);return s.dotDotDotToken=e,s.propertyName=xt(n),s.name=xt(r),s.initializer=i,s}function K(n,i){var s=t(177);return s.elements=e.parenthesizeListElements(r(n)),i&&(s.multiLine=!0),s}function W(e,n){var i=t(178);return i.properties=r(e),n&&(i.multiLine=!0),i}function z(n,r){var i=t(179);return i.expression=e.parenthesizeForAccess(n),i.name=xt(r),At(i,131072),i}function q(n,r){var i,o=t(180);return o.expression=e.parenthesizeForAccess(n),o.argumentExpression=(i=r,e.isString(i)||"number"==typeof i?s(i):i),o}function J(n,i,s){var o=t(181);return o.expression=e.parenthesizeForAccess(n),o.typeArguments=St(i),o.arguments=e.parenthesizeListElements(r(s)),o}function Y(n,i,s){var o=t(182);return o.expression=e.parenthesizeForNew(n),o.typeArguments=St(i),o.arguments=s?e.parenthesizeListElements(r(s)):void 0,o}function X(n,r){var i=t(183);return i.tag=e.parenthesizeForAccess(n),i.template=r,i}function Q(n,r){var i=t(184);return i.type=n,i.expression=e.parenthesizePrefixOperand(r),i}function Z(e){var n=t(185);return n.expression=e,n}function ee(e,n,i,s,o,a,l){var c=t(186);return c.modifiers=St(e),c.asteriskToken=n,c.name=xt(i),c.typeParameters=St(s),c.parameters=r(o),c.type=a,c.body=l,c}function te(n,i,s,o,a,l){var c=t(187);return c.modifiers=St(n),c.typeParameters=St(i),c.parameters=r(s),c.type=o,c.equalsGreaterThanToken=a||d(36),c.body=e.parenthesizeConciseBody(l),c}function ne(n){var r=t(188);return r.expression=e.parenthesizePrefixOperand(n),r}function re(n){var r=t(189);return r.expression=e.parenthesizePrefixOperand(n),r}function ie(n){var r=t(190);return r.expression=e.parenthesizePrefixOperand(n),r}function se(n){var r=t(191);return r.expression=e.parenthesizePrefixOperand(n),r}function oe(n,r){var i=t(192);return i.operator=n,i.operand=e.parenthesizePrefixOperand(r),i}function ae(n,r){var i=t(193);return i.operand=e.parenthesizePostfixOperand(n),i.operator=r,i}function le(n,r,i){var s,o=t(194),a="number"==typeof(s=r)?d(s):s,l=a.kind;return o.left=e.parenthesizeBinaryOperand(l,n,!0,void 0),o.operatorToken=a,o.right=e.parenthesizeBinaryOperand(l,i,!1,o.left),o}function ce(n,r,i,s,o){var a=t(195);return a.condition=e.parenthesizeForConditionalHead(n),a.questionToken=o?r:d(55),a.whenTrue=e.parenthesizeSubexpressionOfConditionalExpression(o?i:r),a.colonToken=o?s:d(56),a.whenFalse=e.parenthesizeSubexpressionOfConditionalExpression(o||i),a}function ue(e,n){var i=t(196);return i.head=e,i.templateSpans=r(n),i}function de(e,n){var r=t(197);return r.asteriskToken=e&&39===e.kind?e:void 0,r.expression=e&&39!==e.kind?e:n,r}function pe(n){var r=t(198);return r.expression=e.parenthesizeExpressionForList(n),r}function he(e,n,i,s,o){var a=t(199);return a.decorators=void 0,a.modifiers=St(e),a.name=xt(n),a.typeParameters=St(i),a.heritageClauses=St(s),a.members=r(o),a}function fe(n,r){var i=t(201);return i.expression=e.parenthesizeForAccess(r),i.typeArguments=St(n),i}function me(e,n){var r=t(202);return r.expression=e,r.type=n,r}function _e(n){var r=t(203);return r.expression=e.parenthesizeForAccess(n),r}function ge(e,n){var r=t(204);return r.keywordToken=e,r.name=n,r}function ye(e,n){var r=t(205);return r.expression=e,r.literal=n,r}function be(e,n){var i=t(207);return i.statements=r(e),n&&(i.multiLine=n),i}function ve(n,r){var i=t(208);return i.decorators=void 0,i.modifiers=St(n),i.declarationList=e.isArray(r)?Fe(r):r,i}function Te(n){var r=t(210);return r.expression=e.parenthesizeExpressionForExpressionStatement(n),r}function ke(e,n,r){var i=t(211);return i.expression=e,i.thenStatement=n,i.elseStatement=r,i}function Ee(e,n){var r=t(212);return r.statement=e,r.expression=n,r}function xe(e,n){var r=t(213);return r.expression=e,r.statement=n,r}function Se(e,n,r,i){var s=t(214);return s.initializer=e,s.condition=n,s.incrementor=r,s.statement=i,s}function Ce(e,n,r){var i=t(215);return i.initializer=e,i.expression=n,i.statement=r,i}function Ie(e,n,r,i){var s=t(216);return s.awaitModifier=e,s.initializer=n,s.expression=r,s.statement=i,s}function Ae(e){var n=t(217);return n.label=xt(e),n}function we(e){var n=t(218);return n.label=xt(e),n}function Ne(e){var n=t(219);return n.expression=e,n}function De(e,n){var r=t(220);return r.expression=e,r.statement=n,r}function Oe(n,r){var i=t(221);return i.expression=e.parenthesizeExpressionForList(n),i.caseBlock=r,i}function Re(e,n){var r=t(222);return r.label=xt(e),r.statement=n,r}function Le(e){var n=t(223);return n.expression=e,n}function Pe(e,n,r){var i=t(224);return i.tryBlock=e,i.catchClause=n,i.finallyBlock=r,i}function Me(n,r,i){var s=t(226);return s.name=xt(n),s.type=r,s.initializer=void 0!==i?e.parenthesizeExpressionForList(i):void 0,s}function Fe(e,n){var i=t(227);return i.flags|=3&n,i.declarations=r(e),i}function $e(e,n,i,s,o,a,l,c){var u=t(228);return u.decorators=St(e),u.modifiers=St(n),u.asteriskToken=i,u.name=xt(s),u.typeParameters=St(o),u.parameters=r(a),u.type=l,u.body=c,u}function Be(e,n,i,s,o,a){var l=t(229);return l.decorators=St(e),l.modifiers=St(n),l.name=xt(i),l.typeParameters=St(s),l.heritageClauses=St(o),l.members=r(a),l}function Ue(e,n,i,s,o,a){var l=t(230);return l.decorators=St(e),l.modifiers=St(n),l.name=xt(i),l.typeParameters=St(s),l.heritageClauses=St(o),l.members=r(a),l}function Ve(e,n,r,i,s){var o=t(231);return o.decorators=St(e),o.modifiers=St(n),o.name=xt(r),o.typeParameters=St(i),o.type=s,o}function He(e,n,i,s){var o=t(232);return o.decorators=St(e),o.modifiers=St(n),o.name=xt(i),o.members=r(s),o}function Ge(e,n,r,i,s){var o=t(233);return o.flags|=532&s,o.decorators=St(e),o.modifiers=St(n),o.name=r,o.body=i,o}function je(e){var n=t(234);return n.statements=r(e),n}function Ke(e){var n=t(235);return n.clauses=r(e),n}function We(e){var n=t(236);return n.name=xt(e),n}function ze(e,n,r,i){var s=t(237);return s.decorators=St(e),s.modifiers=St(n),s.name=xt(r),s.moduleReference=i,s}function qe(e,n,r,i){var s=t(238);return s.decorators=St(e),s.modifiers=St(n),s.importClause=r,s.moduleSpecifier=i,s}function Je(e,n){var r=t(239);return r.name=e,r.namedBindings=n,r}function Ye(e){var n=t(240);return n.name=e,n}function Xe(e){var n=t(241);return n.elements=r(e),n}function Qe(e,n){var r=t(242);return r.propertyName=e,r.name=n,r}function Ze(e,n,r,i){var s=t(243);return s.decorators=St(e),s.modifiers=St(n),s.isExportEquals=r,s.expression=i,s}function et(e,n,r,i){var s=t(244);return s.decorators=St(e),s.modifiers=St(n),s.exportClause=r,s.moduleSpecifier=i,s}function tt(e){var n=t(245);return n.elements=r(e),n}function nt(e,n){var r=t(246);return r.propertyName=xt(e),r.name=xt(n),r}function rt(e){var n=t(248);return n.expression=e,n}function it(e,n,i){var s=t(249);return s.openingElement=e,s.children=r(n),s.closingElement=i,s}function st(e,n){var r=t(250);return r.tagName=e,r.attributes=n,r}function ot(e,n){var r=t(251);return r.tagName=e,r.attributes=n,r}function at(e){var n=t(252);return n.tagName=e,n}function lt(e,n){var r=t(253);return r.name=e,r.initializer=n,r}function ct(e){var n=t(254);return n.properties=r(e),n}function ut(e){var n=t(255);return n.expression=e,n}function dt(e,n){var r=t(256);return r.dotDotDotToken=e,r.expression=n,r}function pt(n,i){var s=t(257);return s.expression=e.parenthesizeExpressionForList(n),s.statements=r(i),s}function ht(e){var n=t(258);return n.statements=r(e),n}function ft(e,n){var i=t(259);return i.token=e,i.types=r(n),i}function mt(n,r){var i=t(260);return i.variableDeclaration=e.isString(n)?Me(n):n,i.block=r,i}function _t(n,r){var i=t(261);return i.name=xt(n),i.questionToken=void 0,i.initializer=void 0!==r?e.parenthesizeExpressionForList(r):void 0,i}function gt(n,r){var i=t(262);return i.name=xt(n),i.objectAssignmentInitializer=void 0!==r?e.parenthesizeExpressionForList(r):void 0,i}function yt(n){var r=t(263);return r.expression=void 0!==n?e.parenthesizeExpressionForList(n):void 0,r}function bt(n,r){var i=t(264);return i.name=xt(n),i.initializer=r&&e.parenthesizeExpressionForList(r),i}function vt(e,n){var r=t(288);return r.expression=e,r.original=n,It(r,n),r}function Tt(t){if(e.nodeIsSynthesized(t)&&!e.isParseTreeNode(t)&&!t.original&&!t.emitNode&&!t.id){if(289===t.kind)return t.elements;if(e.isBinaryExpression(t)&&26===t.operatorToken.kind)return[t.left,t.right]}return t}function kt(n){var i=t(289);return i.elements=r(e.sameFlatMap(n,Tt)),i}function Et(t){var n=e.createNode(266);return n.sourceFiles=t,n}function xt(t){return e.isString(t)?l(t):t}function St(e){return e?r(e):void 0}function Ct(t){if(!t.emitNode){if(e.isParseTreeNode(t)){if(265===t.kind)return t.emitNode={annotatedNodes:[t]};Ct(e.getSourceFileOfNode(t)).annotatedNodes.push(t)}t.emitNode={}}return t.emitNode}function It(e,t){return t&&(e.pos=t.pos,e.end=t.end),e}function At(e,t){return Ct(e).flags=t,e}function wt(e){var t=e.emitNode;return t&&t.leadingComments}function Nt(e,t){return Ct(e).leadingComments=t,e}function Dt(e){var t=e.emitNode;return t&&t.trailingComments}function Ot(e,t){return Ct(e).trailingComments=t,e}function Rt(t,n){if(t.original=n,n){var r=n.emitNode;r&&(t.emitNode=function(t,n){var r=t.flags,i=t.leadingComments,s=t.trailingComments,o=t.commentRange,a=t.sourceMapRange,l=t.tokenSourceMapRanges,c=t.constantValue,u=t.helpers;n||(n={});i&&(n.leadingComments=e.addRange(i.slice(),n.leadingComments));s&&(n.trailingComments=e.addRange(s.slice(),n.trailingComments));r&&(n.flags=r);o&&(n.commentRange=o);a&&(n.sourceMapRange=a);l&&(n.tokenSourceMapRanges=function(e,t){t||(t=[]);for(var n in e)t[n]=e[n];return t}(l,n.tokenSourceMapRanges));void 0!==c&&(n.constantValue=c);u&&(n.helpers=e.addRange(n.helpers,u));return n}(r,t.emitNode))}return t}e.createTempVariable=function(e){var t=l("");return t.autoGenerateKind=1,t.autoGenerateId=u,u++,e&&e(t),t},e.createLoopVariable=function(){var e=l("");return e.autoGenerateKind=2,e.autoGenerateId=u,u++,e},e.createUniqueName=function(e){var t=l(e);return t.autoGenerateKind=3,t.autoGenerateId=u,u++,t},e.getGeneratedNameForNode=function(e){var t=l("");return t.autoGenerateKind=4,t.autoGenerateId=u,t.original=e,u++,t},e.createToken=d,e.createSuper=function(){return t(97)},e.createThis=function(){return t(99)},e.createNull=function(){return t(95)},e.createTrue=p,e.createFalse=h,e.createQualifiedName=f,e.updateQualifiedName=function(e,t,r){return e.left!==t||e.right!==r?n(f(t,r),e):e},e.createComputedPropertyName=m,e.updateComputedPropertyName=function(e,t){return e.expression!==t?n(m(t),e):e},e.createTypeParameterDeclaration=_,e.updateTypeParameterDeclaration=function(e,t,r,i){return e.name!==t||e.constraint!==r||e.default!==i?n(_(t,r,i),e):e},e.createParameter=g,e.updateParameter=function(e,t,r,i,s,o,a,l){return e.decorators!==t||e.modifiers!==r||e.dotDotDotToken!==i||e.name!==s||e.questionToken!==o||e.type!==a||e.initializer!==l?n(g(t,r,i,s,o,a,l),e):e},e.createDecorator=y,e.updateDecorator=function(e,t){return e.expression!==t?n(y(t),e):e},e.createPropertySignature=b,e.updatePropertySignature=function(e,t,r,i,s,o){return e.modifiers!==t||e.name!==r||e.questionToken!==i||e.type!==s||e.initializer!==o?n(b(t,r,i,s,o),e):e},e.createProperty=v,e.updateProperty=function(e,t,r,i,s,o,a){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.questionToken!==s||e.type!==o||e.initializer!==a?n(v(t,r,i,s,o,a),e):e},e.createMethodSignature=T,e.updateMethodSignature=function(e,t,r,i,s,o){return e.typeParameters!==t||e.parameters!==r||e.type!==i||e.name!==s||e.questionToken!==o?n(T(t,r,i,s,o),e):e},e.createMethod=k,e.updateMethod=function(e,t,r,i,s,o,a,l,c,u){return e.decorators!==t||e.modifiers!==r||e.asteriskToken!==i||e.name!==s||e.questionToken!==o||e.typeParameters!==a||e.parameters!==l||e.type!==c||e.body!==u?n(k(t,r,i,s,o,a,l,c,u),e):e},e.createConstructor=E,e.updateConstructor=function(e,t,r,i,s){return e.decorators!==t||e.modifiers!==r||e.parameters!==i||e.body!==s?n(E(t,r,i,s),e):e},e.createGetAccessor=x,e.updateGetAccessor=function(e,t,r,i,s,o,a){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.parameters!==s||e.type!==o||e.body!==a?n(x(t,r,i,s,o,a),e):e},e.createSetAccessor=S,e.updateSetAccessor=function(e,t,r,i,s,o){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.parameters!==s||e.body!==o?n(S(t,r,i,s,o),e):e},e.createCallSignature=function(e,t,n){return I(155,e,t,n)},e.updateCallSignature=function(e,t,n,r){return A(e,t,n,r)},e.createConstructSignature=function(e,t,n){return I(156,e,t,n)},e.updateConstructSignature=function(e,t,n,r){return A(e,t,n,r)},e.createIndexSignature=C,e.updateIndexSignature=function(e,t,r,i,s){return e.parameters!==i||e.type!==s||e.decorators!==t||e.modifiers!==r?n(C(t,r,i,s),e):e},e.createSignatureDeclaration=I,e.createKeywordTypeNode=function(e){return t(e)},e.createTypePredicateNode=w,e.updateTypePredicateNode=function(e,t,r){return e.parameterName!==t||e.type!==r?n(w(t,r),e):e},e.createTypeReferenceNode=N,e.updateTypeReferenceNode=function(e,t,r){return e.typeName!==t||e.typeArguments!==r?n(N(t,r),e):e},e.createFunctionTypeNode=function(e,t,n){return I(160,e,t,n)},e.updateFunctionTypeNode=function(e,t,n,r){return A(e,t,n,r)},e.createConstructorTypeNode=function(e,t,n){return I(161,e,t,n)},e.updateConstructorTypeNode=function(e,t,n,r){return A(e,t,n,r)},e.createTypeQueryNode=D,e.updateTypeQueryNode=function(e,t){return e.exprName!==t?n(D(t),e):e},e.createTypeLiteralNode=O,e.updateTypeLiteralNode=function(e,t){return e.members!==t?n(O(t),e):e},e.createArrayTypeNode=R,e.updateArrayTypeNode=function(e,t){return e.elementType!==t?n(R(t),e):e},e.createTupleTypeNode=L,e.updateTypleTypeNode=function(e,t){return e.elementTypes!==t?n(L(t),e):e},e.createUnionTypeNode=function(e){return P(166,e)},e.updateUnionTypeNode=function(e,t){return M(e,t)},e.createIntersectionTypeNode=function(e){return P(167,e)},e.updateIntersectionTypeNode=function(e,t){return M(e,t)},e.createUnionOrIntersectionTypeNode=P,e.createParenthesizedType=F,e.updateParenthesizedType=function(e,t){return e.type!==t?n(F(t),e):e},e.createThisTypeNode=function(){return t(169)},e.createTypeOperatorNode=$,e.updateTypeOperatorNode=function(e,t){return e.type!==t?n($(t),e):e},e.createIndexedAccessTypeNode=B,e.updateIndexedAccessTypeNode=function(e,t,r){return e.objectType!==t||e.indexType!==r?n(B(t,r),e):e},e.createMappedTypeNode=U,e.updateMappedTypeNode=function(e,t,r,i,s){return e.readonlyToken!==t||e.typeParameter!==r||e.questionToken!==i||e.type!==s?n(U(t,r,i,s),e):e},e.createLiteralTypeNode=V,e.updateLiteralTypeNode=function(e,t){return e.literal!==t?n(V(t),e):e},e.createObjectBindingPattern=H,e.updateObjectBindingPattern=function(e,t){return e.elements!==t?n(H(t),e):e},e.createArrayBindingPattern=G,e.updateArrayBindingPattern=function(e,t){return e.elements!==t?n(G(t),e):e},e.createBindingElement=j,e.updateBindingElement=function(e,t,r,i,s){return e.propertyName!==r||e.dotDotDotToken!==t||e.name!==i||e.initializer!==s?n(j(t,r,i,s),e):e},e.createArrayLiteral=K,e.updateArrayLiteral=function(e,t){return e.elements!==t?n(K(t,e.multiLine),e):e},e.createObjectLiteral=W,e.updateObjectLiteral=function(e,t){return e.properties!==t?n(W(t,e.multiLine),e):e},e.createPropertyAccess=z,e.updatePropertyAccess=function(t,r,i){return t.expression!==r||t.name!==i?n(At(z(r,i),e.getEmitFlags(t)),t):t},e.createElementAccess=q,e.updateElementAccess=function(e,t,r){return e.expression!==t||e.argumentExpression!==r?n(q(t,r),e):e},e.createCall=J,e.updateCall=function(e,t,r,i){return e.expression!==t||e.typeArguments!==r||e.arguments!==i?n(J(t,r,i),e):e},e.createNew=Y,e.updateNew=function(e,t,r,i){return e.expression!==t||e.typeArguments!==r||e.arguments!==i?n(Y(t,r,i),e):e},e.createTaggedTemplate=X,e.updateTaggedTemplate=function(e,t,r){return e.tag!==t||e.template!==r?n(X(t,r),e):e},e.createTypeAssertion=Q,e.updateTypeAssertion=function(e,t,r){return e.type!==t||e.expression!==r?n(Q(t,r),e):e},e.createParen=Z,e.updateParen=function(e,t){return e.expression!==t?n(Z(t),e):e},e.createFunctionExpression=ee,e.updateFunctionExpression=function(e,t,r,i,s,o,a,l){return e.name!==i||e.modifiers!==t||e.asteriskToken!==r||e.typeParameters!==s||e.parameters!==o||e.type!==a||e.body!==l?n(ee(t,r,i,s,o,a,l),e):e},e.createArrowFunction=te,e.updateArrowFunction=function(t,r,i,s,o,a,l){var c,u;return void 0===l?(c=t.equalsGreaterThanToken,u=e.cast(a,e.isConciseBody)):(c=e.cast(a,(function(e){return 36===e.kind})),u=l),t.modifiers!==r||t.typeParameters!==i||t.parameters!==s||t.type!==o||t.equalsGreaterThanToken!==c||t.body!==u?n(te(r,i,s,o,c,u),t):t},e.createDelete=ne,e.updateDelete=function(e,t){return e.expression!==t?n(ne(t),e):e},e.createTypeOf=re,e.updateTypeOf=function(e,t){return e.expression!==t?n(re(t),e):e},e.createVoid=ie,e.updateVoid=function(e,t){return e.expression!==t?n(ie(t),e):e},e.createAwait=se,e.updateAwait=function(e,t){return e.expression!==t?n(se(t),e):e},e.createPrefix=oe,e.updatePrefix=function(e,t){return e.operand!==t?n(oe(e.operator,t),e):e},e.createPostfix=ae,e.updatePostfix=function(e,t){return e.operand!==t?n(ae(t,e.operator),e):e},e.createBinary=le,e.updateBinary=function(e,t,r,i){return e.left!==t||e.right!==r?n(le(t,i||e.operatorToken,r),e):e},e.createConditional=ce,e.updateConditional=function t(r,i){for(var s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];if(2===s.length){var a=s[0],l=s[1];return t(r,i,r.questionToken,a,r.colonToken,l)}e.Debug.assert(4===s.length);var c=s[0],u=s[1],d=s[2],p=s[3];return r.condition!==i||r.questionToken!==c||r.whenTrue!==u||r.colonToken!==d||r.whenFalse!==p?n(ce(i,c,u,d,p),r):r},e.createTemplateExpression=ue,e.updateTemplateExpression=function(e,t,r){return e.head!==t||e.templateSpans!==r?n(ue(t,r),e):e},e.createTemplateHead=function(e){var n=t(14);return n.text=e,n},e.createTemplateMiddle=function(e){var n=t(15);return n.text=e,n},e.createTemplateTail=function(e){var n=t(16);return n.text=e,n},e.createNoSubstitutionTemplateLiteral=function(e){var n=t(13);return n.text=e,n},e.createYield=de,e.updateYield=function(e,t,r){return e.expression!==r||e.asteriskToken!==t?n(de(t,r),e):e},e.createSpread=pe,e.updateSpread=function(e,t){return e.expression!==t?n(pe(t),e):e},e.createClassExpression=he,e.updateClassExpression=function(e,t,r,i,s,o){return e.modifiers!==t||e.name!==r||e.typeParameters!==i||e.heritageClauses!==s||e.members!==o?n(he(t,r,i,s,o),e):e},e.createOmittedExpression=function(){return t(200)},e.createExpressionWithTypeArguments=fe,e.updateExpressionWithTypeArguments=function(e,t,r){return e.typeArguments!==t||e.expression!==r?n(fe(t,r),e):e},e.createAsExpression=me,e.updateAsExpression=function(e,t,r){return e.expression!==t||e.type!==r?n(me(t,r),e):e},e.createNonNullExpression=_e,e.updateNonNullExpression=function(e,t){return e.expression!==t?n(_e(t),e):e},e.createMetaProperty=ge,e.updateMetaProperty=function(e,t){return e.name!==t?n(ge(e.keywordToken,t),e):e},e.createTemplateSpan=ye,e.updateTemplateSpan=function(e,t,r){return e.expression!==t||e.literal!==r?n(ye(t,r),e):e},e.createSemicolonClassElement=function(){return t(206)},e.createBlock=be,e.updateBlock=function(e,t){return e.statements!==t?n(be(t,e.multiLine),e):e},e.createVariableStatement=ve,e.updateVariableStatement=function(e,t,r){return e.modifiers!==t||e.declarationList!==r?n(ve(t,r),e):e},e.createEmptyStatement=function(){return t(209)},e.createStatement=Te,e.updateStatement=function(e,t){return e.expression!==t?n(Te(t),e):e},e.createIf=ke,e.updateIf=function(e,t,r,i){return e.expression!==t||e.thenStatement!==r||e.elseStatement!==i?n(ke(t,r,i),e):e},e.createDo=Ee,e.updateDo=function(e,t,r){return e.statement!==t||e.expression!==r?n(Ee(t,r),e):e},e.createWhile=xe,e.updateWhile=function(e,t,r){return e.expression!==t||e.statement!==r?n(xe(t,r),e):e},e.createFor=Se,e.updateFor=function(e,t,r,i,s){return e.initializer!==t||e.condition!==r||e.incrementor!==i||e.statement!==s?n(Se(t,r,i,s),e):e},e.createForIn=Ce,e.updateForIn=function(e,t,r,i){return e.initializer!==t||e.expression!==r||e.statement!==i?n(Ce(t,r,i),e):e},e.createForOf=Ie,e.updateForOf=function(e,t,r,i,s){return e.awaitModifier!==t||e.initializer!==r||e.expression!==i||e.statement!==s?n(Ie(t,r,i,s),e):e},e.createContinue=Ae,e.updateContinue=function(e,t){return e.label!==t?n(Ae(t),e):e},e.createBreak=we,e.updateBreak=function(e,t){return e.label!==t?n(we(t),e):e},e.createReturn=Ne,e.updateReturn=function(e,t){return e.expression!==t?n(Ne(t),e):e},e.createWith=De,e.updateWith=function(e,t,r){return e.expression!==t||e.statement!==r?n(De(t,r),e):e},e.createSwitch=Oe,e.updateSwitch=function(e,t,r){return e.expression!==t||e.caseBlock!==r?n(Oe(t,r),e):e},e.createLabel=Re,e.updateLabel=function(e,t,r){return e.label!==t||e.statement!==r?n(Re(t,r),e):e},e.createThrow=Le,e.updateThrow=function(e,t){return e.expression!==t?n(Le(t),e):e},e.createTry=Pe,e.updateTry=function(e,t,r,i){return e.tryBlock!==t||e.catchClause!==r||e.finallyBlock!==i?n(Pe(t,r,i),e):e},e.createDebuggerStatement=function(){return t(225)},e.createVariableDeclaration=Me,e.updateVariableDeclaration=function(e,t,r,i){return e.name!==t||e.type!==r||e.initializer!==i?n(Me(t,r,i),e):e},e.createVariableDeclarationList=Fe,e.updateVariableDeclarationList=function(e,t){return e.declarations!==t?n(Fe(t,e.flags),e):e},e.createFunctionDeclaration=$e,e.updateFunctionDeclaration=function(e,t,r,i,s,o,a,l,c){return e.decorators!==t||e.modifiers!==r||e.asteriskToken!==i||e.name!==s||e.typeParameters!==o||e.parameters!==a||e.type!==l||e.body!==c?n($e(t,r,i,s,o,a,l,c),e):e},e.createClassDeclaration=Be,e.updateClassDeclaration=function(e,t,r,i,s,o,a){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.typeParameters!==s||e.heritageClauses!==o||e.members!==a?n(Be(t,r,i,s,o,a),e):e},e.createInterfaceDeclaration=Ue,e.updateInterfaceDeclaration=function(e,t,r,i,s,o,a){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.typeParameters!==s||e.heritageClauses!==o||e.members!==a?n(Ue(t,r,i,s,o,a),e):e},e.createTypeAliasDeclaration=Ve,e.updateTypeAliasDeclaration=function(e,t,r,i,s,o){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.typeParameters!==s||e.type!==o?n(Ve(t,r,i,s,o),e):e},e.createEnumDeclaration=He,e.updateEnumDeclaration=function(e,t,r,i,s){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.members!==s?n(He(t,r,i,s),e):e},e.createModuleDeclaration=Ge,e.updateModuleDeclaration=function(e,t,r,i,s){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.body!==s?n(Ge(t,r,i,s,e.flags),e):e},e.createModuleBlock=je,e.updateModuleBlock=function(e,t){return e.statements!==t?n(je(t),e):e},e.createCaseBlock=Ke,e.updateCaseBlock=function(e,t){return e.clauses!==t?n(Ke(t),e):e},e.createNamespaceExportDeclaration=We,e.updateNamespaceExportDeclaration=function(e,t){return e.name!==t?n(We(t),e):e},e.createImportEqualsDeclaration=ze,e.updateImportEqualsDeclaration=function(e,t,r,i,s){return e.decorators!==t||e.modifiers!==r||e.name!==i||e.moduleReference!==s?n(ze(t,r,i,s),e):e},e.createImportDeclaration=qe,e.updateImportDeclaration=function(e,t,r,i,s){return e.decorators!==t||e.modifiers!==r||e.importClause!==i||e.moduleSpecifier!==s?n(qe(t,r,i,s),e):e},e.createImportClause=Je,e.updateImportClause=function(e,t,r){return e.name!==t||e.namedBindings!==r?n(Je(t,r),e):e},e.createNamespaceImport=Ye,e.updateNamespaceImport=function(e,t){return e.name!==t?n(Ye(t),e):e},e.createNamedImports=Xe,e.updateNamedImports=function(e,t){return e.elements!==t?n(Xe(t),e):e},e.createImportSpecifier=Qe,e.updateImportSpecifier=function(e,t,r){return e.propertyName!==t||e.name!==r?n(Qe(t,r),e):e},e.createExportAssignment=Ze,e.updateExportAssignment=function(e,t,r,i){return e.decorators!==t||e.modifiers!==r||e.expression!==i?n(Ze(t,r,e.isExportEquals,i),e):e},e.createExportDeclaration=et,e.updateExportDeclaration=function(e,t,r,i,s){return e.decorators!==t||e.modifiers!==r||e.exportClause!==i||e.moduleSpecifier!==s?n(et(t,r,i,s),e):e},e.createNamedExports=tt,e.updateNamedExports=function(e,t){return e.elements!==t?n(tt(t),e):e},e.createExportSpecifier=nt,e.updateExportSpecifier=function(e,t,r){return e.propertyName!==t||e.name!==r?n(nt(t,r),e):e},e.createExternalModuleReference=rt,e.updateExternalModuleReference=function(e,t){return e.expression!==t?n(rt(t),e):e},e.createJsxElement=it,e.updateJsxElement=function(e,t,r,i){return e.openingElement!==t||e.children!==r||e.closingElement!==i?n(it(t,r,i),e):e},e.createJsxSelfClosingElement=st,e.updateJsxSelfClosingElement=function(e,t,r){return e.tagName!==t||e.attributes!==r?n(st(t,r),e):e},e.createJsxOpeningElement=ot,e.updateJsxOpeningElement=function(e,t,r){return e.tagName!==t||e.attributes!==r?n(ot(t,r),e):e},e.createJsxClosingElement=at,e.updateJsxClosingElement=function(e,t){return e.tagName!==t?n(at(t),e):e},e.createJsxAttribute=lt,e.updateJsxAttribute=function(e,t,r){return e.name!==t||e.initializer!==r?n(lt(t,r),e):e},e.createJsxAttributes=ct,e.updateJsxAttributes=function(e,t){return e.properties!==t?n(ct(t),e):e},e.createJsxSpreadAttribute=ut,e.updateJsxSpreadAttribute=function(e,t){return e.expression!==t?n(ut(t),e):e},e.createJsxExpression=dt,e.updateJsxExpression=function(e,t){return e.expression!==t?n(dt(e.dotDotDotToken,t),e):e},e.createCaseClause=pt,e.updateCaseClause=function(e,t,r){return e.expression!==t||e.statements!==r?n(pt(t,r),e):e},e.createDefaultClause=ht,e.updateDefaultClause=function(e,t){return e.statements!==t?n(ht(t),e):e},e.createHeritageClause=ft,e.updateHeritageClause=function(e,t){return e.types!==t?n(ft(e.token,t),e):e},e.createCatchClause=mt,e.updateCatchClause=function(e,t,r){return e.variableDeclaration!==t||e.block!==r?n(mt(t,r),e):e},e.createPropertyAssignment=_t,e.updatePropertyAssignment=function(e,t,r){return e.name!==t||e.initializer!==r?n(_t(t,r),e):e},e.createShorthandPropertyAssignment=gt,e.updateShorthandPropertyAssignment=function(e,t,r){return e.name!==t||e.objectAssignmentInitializer!==r?n(gt(t,r),e):e},e.createSpreadAssignment=yt,e.updateSpreadAssignment=function(e,t){return e.expression!==t?n(yt(t),e):e},e.createEnumMember=bt,e.updateEnumMember=function(e,t,r){return e.name!==t||e.initializer!==r?n(bt(t,r),e):e},e.updateSourceFileNode=function(e,i){if(e.statements!==i){var s=t(265);return s.flags|=e.flags,s.statements=r(i),s.endOfFileToken=e.endOfFileToken,s.fileName=e.fileName,s.path=e.path,s.text=e.text,void 0!==e.amdDependencies&&(s.amdDependencies=e.amdDependencies),void 0!==e.moduleName&&(s.moduleName=e.moduleName),void 0!==e.referencedFiles&&(s.referencedFiles=e.referencedFiles),void 0!==e.typeReferenceDirectives&&(s.typeReferenceDirectives=e.typeReferenceDirectives),void 0!==e.languageVariant&&(s.languageVariant=e.languageVariant),void 0!==e.isDeclarationFile&&(s.isDeclarationFile=e.isDeclarationFile),void 0!==e.renamedDependencies&&(s.renamedDependencies=e.renamedDependencies),void 0!==e.hasNoDefaultLib&&(s.hasNoDefaultLib=e.hasNoDefaultLib),void 0!==e.languageVersion&&(s.languageVersion=e.languageVersion),void 0!==e.scriptKind&&(s.scriptKind=e.scriptKind),void 0!==e.externalModuleIndicator&&(s.externalModuleIndicator=e.externalModuleIndicator),void 0!==e.commonJsModuleIndicator&&(s.commonJsModuleIndicator=e.commonJsModuleIndicator),void 0!==e.identifiers&&(s.identifiers=e.identifiers),void 0!==e.nodeCount&&(s.nodeCount=e.nodeCount),void 0!==e.identifierCount&&(s.identifierCount=e.identifierCount),void 0!==e.symbolCount&&(s.symbolCount=e.symbolCount),void 0!==e.parseDiagnostics&&(s.parseDiagnostics=e.parseDiagnostics),void 0!==e.bindDiagnostics&&(s.bindDiagnostics=e.bindDiagnostics),void 0!==e.lineMap&&(s.lineMap=e.lineMap),void 0!==e.classifiableNames&&(s.classifiableNames=e.classifiableNames),void 0!==e.resolvedModules&&(s.resolvedModules=e.resolvedModules),void 0!==e.resolvedTypeReferenceDirectiveNames&&(s.resolvedTypeReferenceDirectiveNames=e.resolvedTypeReferenceDirectiveNames),void 0!==e.imports&&(s.imports=e.imports),void 0!==e.moduleAugmentations&&(s.moduleAugmentations=e.moduleAugmentations),n(s,e)}return e},e.getMutableClone=function(e){var t=i(e);return t.pos=e.pos,t.end=e.end,t.parent=e.parent,t},e.createNotEmittedStatement=function(e){var n=t(287);return n.original=e,It(n,e),n},e.createEndOfDeclarationMarker=function(e){var n=t(291);return n.emitNode={},n.original=e,n},e.createMergeDeclarationMarker=function(e){var n=t(290);return n.emitNode={},n.original=e,n},e.createPartiallyEmittedExpression=vt,e.updatePartiallyEmittedExpression=function(e,t){return e.expression!==t?n(vt(t,e.original),e):e},e.createCommaList=kt,e.updateCommaList=function(e,t){return e.elements!==t?n(kt(t),e):e},e.createBundle=Et,e.updateBundle=function(e,t){return e.sourceFiles!==t?Et(t):e},e.createImmediatelyInvokedFunctionExpression=function(e,t,n){return J(ee(void 0,void 0,void 0,void 0,t?[t]:[],void 0,be(e,!0)),void 0,n?[n]:[])},e.createImmediatelyInvokedArrowFunction=function(e,t,n){return J(te(void 0,void 0,t?[t]:[],void 0,void 0,be(e,!0)),void 0,n?[n]:[])},e.createComma=function(e,t){return le(e,26,t)},e.createLessThan=function(e,t){return le(e,27,t)},e.createAssignment=function(e,t){return le(e,58,t)},e.createStrictEquality=function(e,t){return le(e,34,t)},e.createStrictInequality=function(e,t){return le(e,35,t)},e.createAdd=function(e,t){return le(e,37,t)},e.createSubtract=function(e,t){return le(e,38,t)},e.createPostfixIncrement=function(e){return ae(e,43)},e.createLogicalAnd=function(e,t){return le(e,53,t)},e.createLogicalOr=function(e,t){return le(e,54,t)},e.createLogicalNot=function(e){return oe(51,e)},e.createVoidZero=function(){return ie(s(0))},e.createExportDefault=function(e){return Ze(void 0,void 0,!1,e)},e.createExternalModuleExport=function(e){return et(void 0,void 0,tt([nt(void 0,e)]))},e.disposeEmitNodes=function(t){var n=(t=e.getSourceFileOfNode(e.getParseTreeNode(t)))&&t.emitNode,r=n&&n.annotatedNodes;if(r)for(var i=0,s=r;i<s.length;i++){s[i].emitNode=void 0}},e.getOrCreateEmitNode=Ct,e.setTextRange=It,e.setEmitFlags=At,e.addEmitFlags=function(e,t){var n=Ct(e);return n.flags=n.flags|t,e},e.getSourceMapRange=function(e){var t=e.emitNode;return t&&t.sourceMapRange||e},e.setSourceMapRange=function(e,t){return Ct(e).sourceMapRange=t,e},e.createSourceMapSource=function(t,n,r){return new(c||(c=e.objectAllocator.getSourceMapSourceConstructor()))(t,n,r)},e.getTokenSourceMapRange=function(e,t){var n=e.emitNode,r=n&&n.tokenSourceMapRanges;return r&&r[t]},e.setTokenSourceMapRange=function(e,t,n){var r=Ct(e);return(r.tokenSourceMapRanges||(r.tokenSourceMapRanges=[]))[t]=n,e},e.getCommentRange=function(e){var t=e.emitNode;return t&&t.commentRange||e},e.setCommentRange=function(e,t){return Ct(e).commentRange=t,e},e.getSyntheticLeadingComments=wt,e.setSyntheticLeadingComments=Nt,e.addSyntheticLeadingComment=function(t,n,r,i){return Nt(t,e.append(wt(t),{kind:n,pos:-1,end:-1,hasTrailingNewLine:i,text:r}))},e.getSyntheticTrailingComments=Dt,e.setSyntheticTrailingComments=Ot,e.addSyntheticTrailingComment=function(t,n,r,i){return Ot(t,e.append(Dt(t),{kind:n,pos:-1,end:-1,hasTrailingNewLine:i,text:r}))},e.getConstantValue=function(e){var t=e.emitNode;return t&&t.constantValue},e.setConstantValue=function(e,t){return Ct(e).constantValue=t,e},e.addEmitHelper=function(t,n){var r=Ct(t);return r.helpers=e.append(r.helpers,n),t},e.addEmitHelpers=function(t,n){if(e.some(n))for(var r=Ct(t),i=0,s=n;i<s.length;i++){var o=s[i];r.helpers=e.appendIfUnique(r.helpers,o)}return t},e.removeEmitHelper=function(t,n){var r=t.emitNode;if(r){var i=r.helpers;if(i)return e.orderedRemoveItem(i,n)}return!1},e.getEmitHelpers=function(e){var t=e.emitNode;return t&&t.helpers},e.moveEmitHelpers=function(t,n,r){var i=t.emitNode,s=i&&i.helpers;if(e.some(s)){for(var o=Ct(n),a=0,l=0;l<s.length;l++){var c=s[l];r(c)?(a++,o.helpers=e.appendIfUnique(o.helpers,c)):a>0&&(s[l-a]=c)}a>0&&(s.length-=a)}},e.compareEmitHelpers=function(t,n){return t===n||t.priority===n.priority?0:void 0===t.priority?1:void 0===n.priority?-1:e.compareValues(t.priority,n.priority)},e.setOriginalNode=Rt}(ts||(ts={})),function(e){function t(t,n,r){if(e.isComputedPropertyName(n))return e.setTextRange(e.createElementAccess(t,n.expression),r);var i=e.setTextRange(e.isIdentifier(n)?e.createPropertyAccess(t,n):e.createElementAccess(t,n),n);return e.getOrCreateEmitNode(i).flags|=64,i}function n(t,n){var r=e.createIdentifier(t||"React");return r.flags&=-9,r.parent=e.getParseTreeNode(n),r}function r(t,i){if(e.isQualifiedName(t)){var s=r(t.left,i),o=e.createIdentifier(e.idText(t.right));return o.escapedText=t.right.escapedText,e.createPropertyAccess(s,o)}return n(e.idText(t),i)}function i(t,i,s){return t?r(t,s):e.createPropertyAccess(n(i,s),"createElement")}function s(t){return e.setEmitFlags(e.createIdentifier(t),4098)}e.nullTransformationContext={enableEmitNotification:e.noop,enableSubstitution:e.noop,endLexicalEnvironment:function(){},getCompilerOptions:e.notImplemented,getEmitHost:e.notImplemented,getEmitResolver:e.notImplemented,hoistFunctionDeclaration:e.noop,hoistVariableDeclaration:e.noop,isEmitNotificationEnabled:e.notImplemented,isSubstitutionEnabled:e.notImplemented,onEmitNode:e.noop,onSubstituteNode:e.notImplemented,readEmitHelpers:e.notImplemented,requestEmitHelper:e.noop,resumeLexicalEnvironment:e.noop,startLexicalEnvironment:e.noop,suspendLexicalEnvironment:e.noop},e.createTypeCheck=function(t,n){return"undefined"===n?e.createStrictEquality(t,e.createVoidZero()):e.createStrictEquality(e.createTypeOf(t),e.createLiteral(n))},e.createMemberAccessForPropertyName=t,e.createFunctionCall=function(t,n,r,i){return e.setTextRange(e.createCall(e.createPropertyAccess(t,"call"),void 0,[n].concat(r)),i)},e.createFunctionApply=function(t,n,r,i){return e.setTextRange(e.createCall(e.createPropertyAccess(t,"apply"),void 0,[n,r]),i)},e.createArraySlice=function(t,n){var r=[];return void 0!==n&&r.push("number"==typeof n?e.createLiteral(n):n),e.createCall(e.createPropertyAccess(t,"slice"),void 0,r)},e.createArrayConcat=function(t,n){return e.createCall(e.createPropertyAccess(t,"concat"),void 0,n)},e.createMathPow=function(t,n,r){return e.setTextRange(e.createCall(e.createPropertyAccess(e.createIdentifier("Math"),"pow"),void 0,[t,n]),r)},e.createExpressionForJsxElement=function(t,n,r,s,o,a,l){var c=[r];if(s&&c.push(s),o&&o.length>0)if(s||c.push(e.createNull()),o.length>1)for(var u=0,d=o;u<d.length;u++){var p=d[u];p.startsOnNewLine=!0,c.push(p)}else c.push(o[0]);return e.setTextRange(e.createCall(i(t,n,a),void 0,c),l)},e.getHelperName=s;var o={name:"typescript:values",scoped:!1,text:'\n            var __values = (this && this.__values) || function (o) {\n                var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;\n                if (m) return m.call(o);\n                return {\n                    next: function () {\n                        if (o && i >= o.length) o = void 0;\n                        return { value: o && o[i++], done: !o };\n                    }\n                };\n            };\n        '};e.createValuesHelper=function(t,n,r){return t.requestEmitHelper(o),e.setTextRange(e.createCall(s("__values"),void 0,[n]),r)};var a={name:"typescript:read",scoped:!1,text:'\n            var __read = (this && this.__read) || function (o, n) {\n                var m = typeof Symbol === "function" && o[Symbol.iterator];\n                if (!m) return o;\n                var i = m.call(o), r, ar = [], e;\n                try {\n                    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n                }\n                catch (error) { e = { error: error }; }\n                finally {\n                    try {\n                        if (r && !r.done && (m = i["return"])) m.call(i);\n                    }\n                    finally { if (e) throw e.error; }\n                }\n                return ar;\n            };\n        '};e.createReadHelper=function(t,n,r,i){return t.requestEmitHelper(a),e.setTextRange(e.createCall(s("__read"),void 0,void 0!==r?[n,e.createLiteral(r)]:[n]),i)};var l={name:"typescript:spread",scoped:!1,text:"\n            var __spread = (this && this.__spread) || function () {\n                for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n                return ar;\n            };"};function c(e,t){var n=x(e);switch(n.kind){case 71:return t;case 99:case 8:case 9:return!1;case 177:return 0!==n.elements.length;case 178:return n.properties.length>0;default:return!0}}function u(t){return e.isIdentifier(t)?e.createLiteral(t):e.isComputedPropertyName(t)?e.getMutableClone(t.expression):e.getMutableClone(t)}function d(e,t,n){return p(e,t,n,8192)}function p(t,n,r,i){var s=e.getNameOfDeclaration(t);if(s&&e.isIdentifier(s)&&!e.isGeneratedIdentifier(s)){var o=e.getMutableClone(s);return i|=e.getEmitFlags(s),r||(i|=48),n||(i|=1536),i&&e.setEmitFlags(o,i),o}return e.getGeneratedNameForNode(t)}function h(t,n,r,i){var s,o=e.createPropertyAccess(t,e.nodeIsSynthesized(n)?n:e.getSynthesizedClone(n));return e.setTextRange(o,n),i||(s|=48),r||(s|=1536),s&&e.setEmitFlags(o,s),o}function f(t){return e.isStringLiteral(t.expression)&&"use strict"===t.expression.text}function m(t,n,r){e.Debug.assert(0===t.length,"Prologue directives should be at the first statement in the target statements array");for(var i=!1,s=0,o=n.length;s<o;){var a=n[s];if(!e.isPrologueDirective(a))break;f(a)&&(i=!0),t.push(a),s++}return r&&!i&&t.push(I(e.createStatement(e.createLiteral("use strict")))),s}function _(t,n,r,i){for(var s=n.length;r<s;){var o=n[r];if(!(1048576&e.getEmitFlags(o)))break;t.push(i?e.visitNode(o,i,e.isStatement):o),r++}return r}function g(t){if(t=e.skipPartiallyEmittedExpressions(t),e.isLiteralKind(t.kind))return t.kind;if(194===t.kind&&37===t.operatorToken.kind){if(void 0!==t.cachedLiteralKind)return t.cachedLiteralKind;var n=g(t.left),r=e.isLiteralKind(n)&&n===g(t.right)?n:0;return t.cachedLiteralKind=r,r}return 0}function y(t){var n=e.skipPartiallyEmittedExpressions(t);return e.isLeftHandSideExpression(n)&&(182!==n.kind||n.arguments)?t:e.setTextRange(e.createParen(t),t)}function b(t){var n=e.skipPartiallyEmittedExpressions(t);return e.getExpressionPrecedence(n)>e.getOperatorPrecedence(194,26)?t:e.setTextRange(e.createParen(t),t)}function v(t){switch(t.kind){case 166:case 167:case 160:case 161:return e.createParenthesizedType(t)}return t}function T(e,t){for(;;){switch(e.kind){case 193:e=e.operand;continue;case 194:e=e.left;continue;case 195:e=e.condition;continue;case 181:if(t)return e;case 180:case 179:case 288:e=e.expression;continue}return e}}function k(e,t){switch(void 0===t&&(t=7),e.kind){case 185:return 0!=(1&t);case 184:case 202:case 203:return 0!=(2&t);case 288:return 0!=(4&t)}return!1}function E(t,n){var r;void 0===n&&(n=7);do{r=t,1&n&&(t=x(t)),2&n&&(t=S(t)),4&n&&(t=e.skipPartiallyEmittedExpressions(t))}while(r!==t);return t}function x(e){for(;185===e.kind;)e=e.expression;return e}function S(t){for(;e.isAssertionExpression(t)||203===t.kind;)t=t.expression;return t}function C(t,n,r){return void 0===r&&(r=7),t&&k(t,r)&&(!(185===(i=t).kind&&e.nodeIsSynthesized(i)&&e.nodeIsSynthesized(e.getSourceMapRange(i))&&e.nodeIsSynthesized(e.getCommentRange(i)))||e.some(e.getSyntheticLeadingComments(i))||e.some(e.getSyntheticTrailingComments(i)))?function(t,n){switch(t.kind){case 185:return e.updateParen(t,n);case 184:return e.updateTypeAssertion(t,t.type,n);case 202:return e.updateAsExpression(t,n,t.type);case 203:return e.updateNonNullExpression(t,n);case 288:return e.updatePartiallyEmittedExpression(t,n)}}(t,C(t.expression,n)):n;var i}function I(e){return e.startsOnNewLine=!0,e}function A(t){var n=e.getOriginalNode(t,e.isSourceFile),r=n&&n.emitNode;return r&&r.externalHelpersModuleName}function w(t,n,r){if(t)return t.moduleName?e.createLiteral(t.moduleName):t.isDeclarationFile||!r.out&&!r.outFile?void 0:e.createLiteral(e.getExternalModuleNameFromPath(n,t.fileName))}function N(t){if(e.isDeclarationBindingElement(t))return t.name;if(!e.isObjectLiteralElementLike(t))return e.isAssignmentExpression(t,!0)?N(t.left):e.isSpreadElement(t)?N(t.expression):t;switch(t.kind){case 261:return N(t.initializer);case 262:return t.name;case 263:return N(t.expression)}}function D(t){if(e.isBindingElement(t)){if(t.dotDotDotToken)return e.Debug.assertNode(t.name,e.isIdentifier),e.setOriginalNode(e.setTextRange(e.createSpread(t.name),t),t);var n=M(t.name);return t.initializer?e.setOriginalNode(e.setTextRange(e.createAssignment(n,t.initializer),t),t):n}return e.Debug.assertNode(t,e.isExpression),t}function O(t){if(e.isBindingElement(t)){if(t.dotDotDotToken)return e.Debug.assertNode(t.name,e.isIdentifier),e.setOriginalNode(e.setTextRange(e.createSpreadAssignment(t.name),t),t);if(t.propertyName){var n=M(t.name);return e.setOriginalNode(e.setTextRange(e.createPropertyAssignment(t.propertyName,t.initializer?e.createAssignment(n,t.initializer):n),t),t)}return e.Debug.assertNode(t.name,e.isIdentifier),e.setOriginalNode(e.setTextRange(e.createShorthandPropertyAssignment(t.name,t.initializer),t),t)}return e.Debug.assertNode(t,e.isObjectLiteralElementLike),t}function R(e){switch(e.kind){case 175:case 177:return P(e);case 174:case 178:return L(e)}}function L(t){return e.isObjectBindingPattern(t)?e.setOriginalNode(e.setTextRange(e.createObjectLiteral(e.map(t.elements,O)),t),t):(e.Debug.assertNode(t,e.isObjectLiteralExpression),t)}function P(t){return e.isArrayBindingPattern(t)?e.setOriginalNode(e.setTextRange(e.createArrayLiteral(e.map(t.elements,D)),t),t):(e.Debug.assertNode(t,e.isArrayLiteralExpression),t)}function M(t){return e.isBindingPattern(t)?R(t):(e.Debug.assertNode(t,e.isExpression),t)}e.createSpreadHelper=function(t,n,r){return t.requestEmitHelper(a),t.requestEmitHelper(l),e.setTextRange(e.createCall(s("__spread"),void 0,n),r)},e.createForOfBindingStatement=function(t,n){if(e.isVariableDeclarationList(t)){var r=e.firstOrUndefined(t.declarations),i=e.updateVariableDeclaration(r,r.name,void 0,n);return e.setTextRange(e.createVariableStatement(void 0,e.updateVariableDeclarationList(t,[i])),t)}var s=e.setTextRange(e.createAssignment(t,n),t);return e.setTextRange(e.createStatement(s),t)},e.insertLeadingStatement=function(t,n){return e.isBlock(t)?e.updateBlock(t,e.setTextRange(e.createNodeArray([n].concat(t.statements)),t.statements)):e.createBlock(e.createNodeArray([t,n]),!0)},e.restoreEnclosingLabel=function t(n,r,i){if(!r)return n;var s=e.updateLabel(r,r.label,222===r.statement.kind?t(n,r.statement):n);return i&&i(r),s},e.createCallBinding=function(t,n,r,i){var s,o,a=E(t,7);if(e.isSuperProperty(a))s=e.createThis(),o=a;else if(97===a.kind)s=e.createThis(),o=r<2?e.setTextRange(e.createIdentifier("_super"),a):a;else if(4096&e.getEmitFlags(a))s=e.createVoidZero(),o=y(a);else switch(a.kind){case 179:c(a.expression,i)?(s=e.createTempVariable(n),o=e.createPropertyAccess(e.setTextRange(e.createAssignment(s,a.expression),a.expression),a.name),e.setTextRange(o,a)):(s=a.expression,o=a);break;case 180:c(a.expression,i)?(s=e.createTempVariable(n),o=e.createElementAccess(e.setTextRange(e.createAssignment(s,a.expression),a.expression),a.argumentExpression),e.setTextRange(o,a)):(s=a.expression,o=a);break;default:s=e.createVoidZero(),o=y(t)}return{target:o,thisArg:s}},e.inlineExpressions=function(t){return t.length>10?e.createCommaList(t):e.reduceLeft(t,e.createComma)},e.createExpressionFromEntityName=function t(n){if(e.isQualifiedName(n)){var r=t(n.left),i=e.getMutableClone(n.right);return e.setTextRange(e.createPropertyAccess(r,i),n)}return e.getMutableClone(n)},e.createExpressionForPropertyName=u,e.createExpressionForObjectLiteralElementLike=function(n,r,i){switch(r.kind){case 153:case 154:return function(t,n,r,i){var s=e.getAllAccessorDeclarations(t,n),o=s.firstAccessor,a=s.getAccessor,l=s.setAccessor;if(n===o){var c=[];if(a){var d=e.createFunctionExpression(a.modifiers,void 0,void 0,void 0,a.parameters,void 0,a.body);e.setTextRange(d,a),e.setOriginalNode(d,a);var p=e.createPropertyAssignment("get",d);c.push(p)}if(l){var h=e.createFunctionExpression(l.modifiers,void 0,void 0,void 0,l.parameters,void 0,l.body);e.setTextRange(h,l),e.setOriginalNode(h,l);var f=e.createPropertyAssignment("set",h);c.push(f)}c.push(e.createPropertyAssignment("enumerable",e.createTrue())),c.push(e.createPropertyAssignment("configurable",e.createTrue()));var m=e.setTextRange(e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"defineProperty"),void 0,[r,u(n.name),e.createObjectLiteral(c,i)]),o);return e.aggregateTransformFlags(m)}return}(n.properties,r,i,n.multiLine);case 261:return function(n,r){return e.aggregateTransformFlags(e.setOriginalNode(e.setTextRange(e.createAssignment(t(r,n.name,n.name),n.initializer),n),n))}(r,i);case 262:return function(n,r){return e.aggregateTransformFlags(e.setOriginalNode(e.setTextRange(e.createAssignment(t(r,n.name,n.name),e.getSynthesizedClone(n.name)),n),n))}(r,i);case 151:return function(n,r){return e.aggregateTransformFlags(e.setOriginalNode(e.setTextRange(e.createAssignment(t(r,n.name,n.name),e.setOriginalNode(e.setTextRange(e.createFunctionExpression(n.modifiers,n.asteriskToken,void 0,void 0,n.parameters,void 0,n.body),n),n)),n),n))}(r,i)}},e.getInternalName=function(e,t,n){return p(e,t,n,49152)},e.isInternalName=function(t){return 0!=(32768&e.getEmitFlags(t))},e.getLocalName=function(e,t,n){return p(e,t,n,16384)},e.isLocalName=function(t){return 0!=(16384&e.getEmitFlags(t))},e.getExportName=d,e.isExportName=function(t){return 0!=(8192&e.getEmitFlags(t))},e.getDeclarationName=function(e,t,n){return p(e,t,n)},e.getExternalModuleOrNamespaceExportName=function(t,n,r,i){return t&&e.hasModifier(n,1)?h(t,p(n),r,i):d(n,r,i)},e.getNamespaceMemberName=h,e.convertToFunctionBody=function(t,n){return e.isBlock(t)?t:e.setTextRange(e.createBlock([e.setTextRange(e.createReturn(t),t)],n),t)},e.convertFunctionDeclarationToExpression=function(t){e.Debug.assert(!!t.body);var n=e.createFunctionExpression(t.modifiers,t.asteriskToken,t.name,t.typeParameters,t.parameters,t.type,t.body);return e.setOriginalNode(n,t),e.setTextRange(n,t),t.startsOnNewLine&&(n.startsOnNewLine=!0),e.aggregateTransformFlags(n),n},e.addPrologue=function(e,t,n,r){return _(e,t,m(e,t,n),r)},e.addStandardPrologue=m,e.addCustomPrologue=_,e.startsWithUseStrict=function(t){var n=e.firstOrUndefined(t);return void 0!==n&&e.isPrologueDirective(n)&&f(n)},e.ensureUseStrict=function(t){for(var n=!1,r=0,i=t;r<i.length;r++){var s=i[r];if(!e.isPrologueDirective(s))break;if(f(s)){n=!0;break}}return n?t:e.setTextRange(e.createNodeArray([I(e.createStatement(e.createLiteral("use strict")))].concat(t)),t)},e.parenthesizeBinaryOperand=function(t,n,r,i){return 185===e.skipPartiallyEmittedExpressions(n).kind?n:function(t,n,r,i){var s=e.getOperatorPrecedence(194,t),o=e.getOperatorAssociativity(194,t),a=e.skipPartiallyEmittedExpressions(n),l=e.getExpressionPrecedence(a);switch(e.compareValues(l,s)){case-1:return!(!r&&1===o&&197===n.kind);case 1:return!1;case 0:if(r)return 1===o;if(e.isBinaryExpression(a)&&a.operatorToken.kind===t){if(function(e){return 39===e||49===e||48===e||50===e}(t))return!1;if(37===t){var c=i?g(i):0;if(e.isLiteralKind(c)&&c===g(a))return!1}}return 0===e.getExpressionAssociativity(a)}}(t,n,r,i)?e.createParen(n):n},e.parenthesizeForConditionalHead=function(t){var n=e.getOperatorPrecedence(195,55),r=e.skipPartiallyEmittedExpressions(t),i=e.getExpressionPrecedence(r);return-1===e.compareValues(i,n)?e.createParen(t):t},e.parenthesizeSubexpressionOfConditionalExpression=function(t){return 194===t.kind&&26===t.operatorToken.kind?e.createParen(t):t},e.parenthesizeForNew=function(t){var n=T(t,!0);switch(n.kind){case 181:return e.createParen(t);case 182:return n.arguments?t:e.createParen(t)}return y(t)},e.parenthesizeForAccess=y,e.parenthesizePostfixOperand=function(t){return e.isLeftHandSideExpression(t)?t:e.setTextRange(e.createParen(t),t)},e.parenthesizePrefixOperand=function(t){return e.isUnaryExpression(t)?t:e.setTextRange(e.createParen(t),t)},e.parenthesizeListElements=function(t){for(var n,r=0;r<t.length;r++){var i=b(t[r]);void 0===n&&i===t[r]||(void 0===n&&(n=t.slice(0,r)),n.push(i))}return void 0!==n?e.setTextRange(e.createNodeArray(n,t.hasTrailingComma),t):t},e.parenthesizeExpressionForList=b,e.parenthesizeExpressionForExpressionStatement=function(t){var n=e.skipPartiallyEmittedExpressions(t);if(e.isCallExpression(n)){var r=n.expression,i=e.skipPartiallyEmittedExpressions(r).kind;if(186===i||187===i){var s=e.getMutableClone(n);return s.expression=e.setTextRange(e.createParen(r),r),C(t,s,4)}}var o=T(n,!1).kind;return 178===o||186===o?e.setTextRange(e.createParen(t),t):t},e.parenthesizeElementTypeMember=v,e.parenthesizeArrayTypeMember=function(t){switch(t.kind){case 162:case 170:return e.createParenthesizedType(t)}return v(t)},e.parenthesizeElementTypeMembers=function(t){return e.createNodeArray(e.sameMap(t,v))},e.parenthesizeTypeParameters=function(t){if(e.some(t)){for(var n=[],r=0;r<t.length;++r){var i=t[r];n.push(0===r&&e.isFunctionOrConstructorTypeNode(i)&&i.typeParameters?e.createParenthesizedType(i):i)}return e.createNodeArray(n)}},e.parenthesizeConciseBody=function(t){return e.isBlock(t)||178!==T(t,!1).kind?t:e.setTextRange(e.createParen(t),t)},function(e){e[e.Parentheses=1]="Parentheses",e[e.Assertions=2]="Assertions",e[e.PartiallyEmittedExpressions=4]="PartiallyEmittedExpressions",e[e.All=7]="All"}(e.OuterExpressionKinds||(e.OuterExpressionKinds={})),e.isOuterExpression=k,e.skipOuterExpressions=E,e.skipParentheses=x,e.skipAssertions=S,e.recreateOuterExpressions=C,e.startOnNewLine=I,e.getExternalHelpersModuleName=A,e.getOrCreateExternalHelpersModuleNameIfNeeded=function(t,n,r){if(n.importHelpers&&e.isEffectiveExternalModule(t,n)){var i=A(t);if(i)return i;var s=e.getEmitModuleKind(n),o=r&&s!==e.ModuleKind.System&&s!==e.ModuleKind.ES2015&&s!==e.ModuleKind.ESNext;if(!o){var a=e.getEmitHelpers(t);if(a)for(var l=0,c=a;l<c.length;l++){if(!c[l].scoped){o=!0;break}}}if(o){var u=e.getOriginalNode(t,e.isSourceFile),d=e.getOrCreateEmitNode(u);return d.externalHelpersModuleName||(d.externalHelpersModuleName=e.createUniqueName(e.externalHelpersModuleNameText))}}},e.getLocalNameForExternalImport=function(t,n){var r=e.getNamespaceDeclarationNode(t);if(r&&!e.isDefaultImport(t)){var i=r.name;return e.isGeneratedIdentifier(i)?i:e.createIdentifier(e.getSourceTextOfNodeFromSourceFile(n,r.name))}return 238===t.kind&&t.importClause||244===t.kind&&t.moduleSpecifier?e.getGeneratedNameForNode(t):void 0},e.getExternalModuleNameLiteral=function(t,n,r,i,s){var o=e.getExternalModuleName(t);if(9===o.kind)return function(e,t,n,r){return w(n.getExternalModuleFileFromDeclaration(e),t,r)}(t,r,i,s)||function(t,n){var r=n.renamedDependencies&&n.renamedDependencies.get(t.text);return r&&e.createLiteral(r)}(o,n)||e.getSynthesizedClone(o)},e.tryGetModuleNameFromFile=w,e.getInitializerOfBindingOrAssignmentElement=function t(n){return e.isDeclarationBindingElement(n)?n.initializer:e.isPropertyAssignment(n)?e.isAssignmentExpression(n.initializer,!0)?n.initializer.right:void 0:e.isShorthandPropertyAssignment(n)?n.objectAssignmentInitializer:e.isAssignmentExpression(n,!0)?n.right:e.isSpreadElement(n)?t(n.expression):void 0},e.getTargetOfBindingOrAssignmentElement=N,e.getRestIndicatorOfBindingOrAssignmentElement=function(e){switch(e.kind){case 146:case 176:return e.dotDotDotToken;case 198:case 263:return e}},e.getPropertyNameOfBindingOrAssignmentElement=function(t){switch(t.kind){case 176:if(t.propertyName){var n=t.propertyName;return e.isComputedPropertyName(n)&&e.isStringOrNumericLiteral(n.expression)?n.expression:n}break;case 261:if(t.name){n=t.name;return e.isComputedPropertyName(n)&&e.isStringOrNumericLiteral(n.expression)?n.expression:n}break;case 263:return t.name}var r=N(t);if(r&&e.isPropertyName(r))return e.isComputedPropertyName(r)&&e.isStringOrNumericLiteral(r.expression)?r.expression:r;e.Debug.fail("Invalid property name for binding element.")},e.getElementsOfBindingOrAssignmentPattern=function(e){switch(e.kind){case 174:case 175:case 177:return e.elements;case 178:return e.properties}},e.convertToArrayAssignmentElement=D,e.convertToObjectAssignmentElement=O,e.convertToAssignmentPattern=R,e.convertToObjectAssignmentPattern=L,e.convertToArrayAssignmentPattern=P,e.convertToAssignmentElementTarget=M}(ts||(ts={})),function(e){function t(t,n,r,i){if(void 0===t||void 0===n)return t;e.aggregateTransformFlags(t);var s,a=n(t);return a===t?t:void 0!==a?(s=e.isArray(a)?(i||o)(a):a,e.Debug.assertNode(s,r),e.aggregateTransformFlags(s),s):void 0}function n(t,n,r,i,s){if(void 0===t||void 0===n)return t;var o,a=t.length;(void 0===i||i<0)&&(i=0),(void 0===s||s>a-i)&&(s=a-i),(i>0||s<a)&&(o=e.createNodeArray([],t.hasTrailingComma&&i+s===a));for(var l=0;l<s;l++){var c=t[l+i];e.aggregateTransformFlags(c);var u=void 0!==c?n(c):void 0;if((void 0!==o||void 0===u||u!==c)&&(void 0===o&&(o=e.createNodeArray(t.slice(0,l),t.hasTrailingComma),e.setTextRange(o,t)),u))if(e.isArray(u))for(var d=0,p=u;d<p.length;d++){var h=p[d];e.Debug.assertNode(h,r),e.aggregateTransformFlags(h),o.push(h)}else e.Debug.assertNode(u,r),e.aggregateTransformFlags(u),o.push(u)}return o||t}function r(t,r,i,s,o){i.startLexicalEnvironment(),t=n(t,r,e.isStatement,s),o&&!e.startsWithUseStrict(t)&&(t=e.setTextRange(e.createNodeArray([e.createStatement(e.createLiteral("use strict"))].concat(t)),t));var a=i.endLexicalEnvironment();return e.setTextRange(e.createNodeArray(e.concatenate(t,a)),t)}function i(t,r,i,s){void 0===s&&(s=n),i.startLexicalEnvironment();var o=s(t,r,e.isParameterDeclaration);return i.suspendLexicalEnvironment(),o}function s(n,r,i){i.resumeLexicalEnvironment();var s=t(n,r,e.isConciseBody),o=i.endLexicalEnvironment();if(e.some(o)){var a=e.convertToFunctionBody(s),l=e.mergeLexicalEnvironment(a.statements,o);return e.updateBlock(a,l)}return s}function o(t){return e.Debug.assert(t.length<=1,"Too many nodes written to output."),e.singleOrUndefined(t)}e.visitNode=t,e.visitNodes=n,e.visitLexicalEnvironment=r,e.visitParameterList=i,e.visitFunctionBody=s,e.visitEachChild=function(o,a,l,c,u){if(void 0===c&&(c=n),void 0!==o){var d=o.kind;if(d>0&&d<=142||169===d)return o;switch(d){case 71:return e.updateIdentifier(o,c(o.typeArguments,a,e.isTypeNode));case 143:return e.updateQualifiedName(o,t(o.left,a,e.isEntityName),t(o.right,a,e.isIdentifier));case 144:return e.updateComputedPropertyName(o,t(o.expression,a,e.isExpression));case 145:return e.updateTypeParameterDeclaration(o,t(o.name,a,e.isIdentifier),t(o.constraint,a,e.isTypeNode),t(o.default,a,e.isTypeNode));case 146:return e.updateParameter(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.dotDotDotToken,u,e.isToken),t(o.name,a,e.isBindingName),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 147:return e.updateDecorator(o,t(o.expression,a,e.isExpression));case 148:return e.updatePropertySignature(o,c(o.modifiers,a,e.isToken),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 149:return e.updateProperty(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 150:return e.updateMethodSignature(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken));case 151:return e.updateMethod(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.asteriskToken,u,e.isToken),t(o.name,a,e.isPropertyName),t(o.questionToken,u,e.isToken),c(o.typeParameters,a,e.isTypeParameterDeclaration),i(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 152:return e.updateConstructor(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),i(o.parameters,a,l,c),s(o.body,a,l));case 153:return e.updateGetAccessor(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isPropertyName),i(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 154:return e.updateSetAccessor(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isPropertyName),i(o.parameters,a,l,c),s(o.body,a,l));case 155:return e.updateCallSignature(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 156:return e.updateConstructSignature(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 157:return e.updateIndexSignature(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 158:return e.updateTypePredicateNode(o,t(o.parameterName,a),t(o.type,a,e.isTypeNode));case 159:return e.updateTypeReferenceNode(o,t(o.typeName,a,e.isEntityName),c(o.typeArguments,a,e.isTypeNode));case 160:return e.updateFunctionTypeNode(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 161:return e.updateConstructorTypeNode(o,c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.parameters,a,e.isParameterDeclaration),t(o.type,a,e.isTypeNode));case 162:return e.updateTypeQueryNode(o,t(o.exprName,a,e.isEntityName));case 163:return e.updateTypeLiteralNode(o,c(o.members,a,e.isTypeElement));case 164:return e.updateArrayTypeNode(o,t(o.elementType,a,e.isTypeNode));case 165:return e.updateTypleTypeNode(o,c(o.elementTypes,a,e.isTypeNode));case 166:return e.updateUnionTypeNode(o,c(o.types,a,e.isTypeNode));case 167:return e.updateIntersectionTypeNode(o,c(o.types,a,e.isTypeNode));case 168:return e.updateParenthesizedType(o,t(o.type,a,e.isTypeNode));case 170:return e.updateTypeOperatorNode(o,t(o.type,a,e.isTypeNode));case 171:return e.updateIndexedAccessTypeNode(o,t(o.objectType,a,e.isTypeNode),t(o.indexType,a,e.isTypeNode));case 172:return e.updateMappedTypeNode(o,t(o.readonlyToken,u,e.isToken),t(o.typeParameter,a,e.isTypeParameterDeclaration),t(o.questionToken,u,e.isToken),t(o.type,a,e.isTypeNode));case 173:return e.updateLiteralTypeNode(o,t(o.literal,a,e.isExpression));case 174:return e.updateObjectBindingPattern(o,c(o.elements,a,e.isBindingElement));case 175:return e.updateArrayBindingPattern(o,c(o.elements,a,e.isArrayBindingElement));case 176:return e.updateBindingElement(o,t(o.dotDotDotToken,u,e.isToken),t(o.propertyName,a,e.isPropertyName),t(o.name,a,e.isBindingName),t(o.initializer,a,e.isExpression));case 177:return e.updateArrayLiteral(o,c(o.elements,a,e.isExpression));case 178:return e.updateObjectLiteral(o,c(o.properties,a,e.isObjectLiteralElementLike));case 179:return e.updatePropertyAccess(o,t(o.expression,a,e.isExpression),t(o.name,a,e.isIdentifier));case 180:return e.updateElementAccess(o,t(o.expression,a,e.isExpression),t(o.argumentExpression,a,e.isExpression));case 181:return e.updateCall(o,t(o.expression,a,e.isExpression),c(o.typeArguments,a,e.isTypeNode),c(o.arguments,a,e.isExpression));case 182:return e.updateNew(o,t(o.expression,a,e.isExpression),c(o.typeArguments,a,e.isTypeNode),c(o.arguments,a,e.isExpression));case 183:return e.updateTaggedTemplate(o,t(o.tag,a,e.isExpression),t(o.template,a,e.isTemplateLiteral));case 184:return e.updateTypeAssertion(o,t(o.type,a,e.isTypeNode),t(o.expression,a,e.isExpression));case 185:return e.updateParen(o,t(o.expression,a,e.isExpression));case 186:return e.updateFunctionExpression(o,c(o.modifiers,a,e.isModifier),t(o.asteriskToken,u,e.isToken),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),i(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 187:return e.updateArrowFunction(o,c(o.modifiers,a,e.isModifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),i(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),t(o.equalsGreaterThanToken,a,e.isToken),s(o.body,a,l));case 188:return e.updateDelete(o,t(o.expression,a,e.isExpression));case 189:return e.updateTypeOf(o,t(o.expression,a,e.isExpression));case 190:return e.updateVoid(o,t(o.expression,a,e.isExpression));case 191:return e.updateAwait(o,t(o.expression,a,e.isExpression));case 192:return e.updatePrefix(o,t(o.operand,a,e.isExpression));case 193:return e.updatePostfix(o,t(o.operand,a,e.isExpression));case 194:return e.updateBinary(o,t(o.left,a,e.isExpression),t(o.right,a,e.isExpression),t(o.operatorToken,a,e.isToken));case 195:return e.updateConditional(o,t(o.condition,a,e.isExpression),t(o.questionToken,a,e.isToken),t(o.whenTrue,a,e.isExpression),t(o.colonToken,a,e.isToken),t(o.whenFalse,a,e.isExpression));case 196:return e.updateTemplateExpression(o,t(o.head,a,e.isTemplateHead),c(o.templateSpans,a,e.isTemplateSpan));case 197:return e.updateYield(o,t(o.asteriskToken,u,e.isToken),t(o.expression,a,e.isExpression));case 198:return e.updateSpread(o,t(o.expression,a,e.isExpression));case 199:return e.updateClassExpression(o,c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.heritageClauses,a,e.isHeritageClause),c(o.members,a,e.isClassElement));case 201:return e.updateExpressionWithTypeArguments(o,c(o.typeArguments,a,e.isTypeNode),t(o.expression,a,e.isExpression));case 202:return e.updateAsExpression(o,t(o.expression,a,e.isExpression),t(o.type,a,e.isTypeNode));case 203:return e.updateNonNullExpression(o,t(o.expression,a,e.isExpression));case 204:return e.updateMetaProperty(o,t(o.name,a,e.isIdentifier));case 205:return e.updateTemplateSpan(o,t(o.expression,a,e.isExpression),t(o.literal,a,e.isTemplateMiddleOrTemplateTail));case 207:return e.updateBlock(o,c(o.statements,a,e.isStatement));case 208:return e.updateVariableStatement(o,c(o.modifiers,a,e.isModifier),t(o.declarationList,a,e.isVariableDeclarationList));case 210:return e.updateStatement(o,t(o.expression,a,e.isExpression));case 211:return e.updateIf(o,t(o.expression,a,e.isExpression),t(o.thenStatement,a,e.isStatement,e.liftToBlock),t(o.elseStatement,a,e.isStatement,e.liftToBlock));case 212:return e.updateDo(o,t(o.statement,a,e.isStatement,e.liftToBlock),t(o.expression,a,e.isExpression));case 213:return e.updateWhile(o,t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 214:return e.updateFor(o,t(o.initializer,a,e.isForInitializer),t(o.condition,a,e.isExpression),t(o.incrementor,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 215:return e.updateForIn(o,t(o.initializer,a,e.isForInitializer),t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 216:return e.updateForOf(o,o.awaitModifier,t(o.initializer,a,e.isForInitializer),t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 217:return e.updateContinue(o,t(o.label,a,e.isIdentifier));case 218:return e.updateBreak(o,t(o.label,a,e.isIdentifier));case 219:return e.updateReturn(o,t(o.expression,a,e.isExpression));case 220:return e.updateWith(o,t(o.expression,a,e.isExpression),t(o.statement,a,e.isStatement,e.liftToBlock));case 221:return e.updateSwitch(o,t(o.expression,a,e.isExpression),t(o.caseBlock,a,e.isCaseBlock));case 222:return e.updateLabel(o,t(o.label,a,e.isIdentifier),t(o.statement,a,e.isStatement,e.liftToBlock));case 223:return e.updateThrow(o,t(o.expression,a,e.isExpression));case 224:return e.updateTry(o,t(o.tryBlock,a,e.isBlock),t(o.catchClause,a,e.isCatchClause),t(o.finallyBlock,a,e.isBlock));case 226:return e.updateVariableDeclaration(o,t(o.name,a,e.isBindingName),t(o.type,a,e.isTypeNode),t(o.initializer,a,e.isExpression));case 227:return e.updateVariableDeclarationList(o,c(o.declarations,a,e.isVariableDeclaration));case 228:return e.updateFunctionDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.asteriskToken,u,e.isToken),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),i(o.parameters,a,l,c),t(o.type,a,e.isTypeNode),s(o.body,a,l));case 229:return e.updateClassDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.heritageClauses,a,e.isHeritageClause),c(o.members,a,e.isClassElement));case 230:return e.updateInterfaceDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),c(o.heritageClauses,a,e.isHeritageClause),c(o.members,a,e.isTypeElement));case 231:return e.updateTypeAliasDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.typeParameters,a,e.isTypeParameterDeclaration),t(o.type,a,e.isTypeNode));case 232:return e.updateEnumDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),c(o.members,a,e.isEnumMember));case 233:return e.updateModuleDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),t(o.body,a,e.isModuleBody));case 234:return e.updateModuleBlock(o,c(o.statements,a,e.isStatement));case 235:return e.updateCaseBlock(o,c(o.clauses,a,e.isCaseOrDefaultClause));case 236:return e.updateNamespaceExportDeclaration(o,t(o.name,a,e.isIdentifier));case 237:return e.updateImportEqualsDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.name,a,e.isIdentifier),t(o.moduleReference,a,e.isModuleReference));case 238:return e.updateImportDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.importClause,a,e.isImportClause),t(o.moduleSpecifier,a,e.isExpression));case 239:return e.updateImportClause(o,t(o.name,a,e.isIdentifier),t(o.namedBindings,a,e.isNamedImportBindings));case 240:return e.updateNamespaceImport(o,t(o.name,a,e.isIdentifier));case 241:return e.updateNamedImports(o,c(o.elements,a,e.isImportSpecifier));case 242:return e.updateImportSpecifier(o,t(o.propertyName,a,e.isIdentifier),t(o.name,a,e.isIdentifier));case 243:return e.updateExportAssignment(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.expression,a,e.isExpression));case 244:return e.updateExportDeclaration(o,c(o.decorators,a,e.isDecorator),c(o.modifiers,a,e.isModifier),t(o.exportClause,a,e.isNamedExports),t(o.moduleSpecifier,a,e.isExpression));case 245:return e.updateNamedExports(o,c(o.elements,a,e.isExportSpecifier));case 246:return e.updateExportSpecifier(o,t(o.propertyName,a,e.isIdentifier),t(o.name,a,e.isIdentifier));case 248:return e.updateExternalModuleReference(o,t(o.expression,a,e.isExpression));case 249:return e.updateJsxElement(o,t(o.openingElement,a,e.isJsxOpeningElement),c(o.children,a,e.isJsxChild),t(o.closingElement,a,e.isJsxClosingElement));case 250:return e.updateJsxSelfClosingElement(o,t(o.tagName,a,e.isJsxTagNameExpression),t(o.attributes,a,e.isJsxAttributes));case 251:return e.updateJsxOpeningElement(o,t(o.tagName,a,e.isJsxTagNameExpression),t(o.attributes,a,e.isJsxAttributes));case 252:return e.updateJsxClosingElement(o,t(o.tagName,a,e.isJsxTagNameExpression));case 253:return e.updateJsxAttribute(o,t(o.name,a,e.isIdentifier),t(o.initializer,a,e.isStringLiteralOrJsxExpression));case 254:return e.updateJsxAttributes(o,c(o.properties,a,e.isJsxAttributeLike));case 255:return e.updateJsxSpreadAttribute(o,t(o.expression,a,e.isExpression));case 256:return e.updateJsxExpression(o,t(o.expression,a,e.isExpression));case 257:return e.updateCaseClause(o,t(o.expression,a,e.isExpression),c(o.statements,a,e.isStatement));case 258:return e.updateDefaultClause(o,c(o.statements,a,e.isStatement));case 259:return e.updateHeritageClause(o,c(o.types,a,e.isExpressionWithTypeArguments));case 260:return e.updateCatchClause(o,t(o.variableDeclaration,a,e.isVariableDeclaration),t(o.block,a,e.isBlock));case 261:return e.updatePropertyAssignment(o,t(o.name,a,e.isPropertyName),t(o.initializer,a,e.isExpression));case 262:return e.updateShorthandPropertyAssignment(o,t(o.name,a,e.isIdentifier),t(o.objectAssignmentInitializer,a,e.isExpression));case 263:return e.updateSpreadAssignment(o,t(o.expression,a,e.isExpression));case 264:return e.updateEnumMember(o,t(o.name,a,e.isPropertyName),t(o.initializer,a,e.isExpression));case 265:return e.updateSourceFileNode(o,r(o.statements,a,l));case 288:return e.updatePartiallyEmittedExpression(o,t(o.expression,a,e.isExpression));case 289:return e.updateCommaList(o,c(o.elements,a,e.isExpression));default:return o}}}}(ts||(ts={})),function(e){function t(e,t,n){return e?t(n,e):n}function n(e,t,n){return e?t(n,e):n}function r(r,i,s,o){if(void 0===r)return i;var a=o?n:e.reduceLeft,l=o||s,c=r.kind;if(c>0&&c<=142)return i;if(c>=158&&c<=173)return i;var u=i;switch(r.kind){case 206:case 209:case 200:case 225:case 287:break;case 143:u=t(r.left,s,u),u=t(r.right,s,u);break;case 144:u=t(r.expression,s,u);break;case 146:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=t(r.type,s,u),u=t(r.initializer,s,u);break;case 147:u=t(r.expression,s,u);break;case 148:u=a(r.modifiers,l,u),u=t(r.name,s,u),u=t(r.questionToken,s,u),u=t(r.type,s,u),u=t(r.initializer,s,u);break;case 149:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=t(r.type,s,u),u=t(r.initializer,s,u);break;case 151:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.typeParameters,l,u),u=a(r.parameters,l,u),u=t(r.type,s,u),u=t(r.body,s,u);break;case 152:u=a(r.modifiers,l,u),u=a(r.parameters,l,u),u=t(r.body,s,u);break;case 153:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.parameters,l,u),u=t(r.type,s,u),u=t(r.body,s,u);break;case 154:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.parameters,l,u),u=t(r.body,s,u);break;case 174:case 175:u=a(r.elements,l,u);break;case 176:u=t(r.propertyName,s,u),u=t(r.name,s,u),u=t(r.initializer,s,u);break;case 177:u=a(r.elements,l,u);break;case 178:u=a(r.properties,l,u);break;case 179:u=t(r.expression,s,u),u=t(r.name,s,u);break;case 180:u=t(r.expression,s,u),u=t(r.argumentExpression,s,u);break;case 181:case 182:u=t(r.expression,s,u),u=a(r.typeArguments,l,u),u=a(r.arguments,l,u);break;case 183:u=t(r.tag,s,u),u=t(r.template,s,u);break;case 184:u=t(r.type,s,u),u=t(r.expression,s,u);break;case 186:u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.typeParameters,l,u),u=a(r.parameters,l,u),u=t(r.type,s,u),u=t(r.body,s,u);break;case 187:u=a(r.modifiers,l,u),u=a(r.typeParameters,l,u),u=a(r.parameters,l,u),u=t(r.type,s,u),u=t(r.body,s,u);break;case 185:case 188:case 189:case 190:case 191:case 197:case 198:case 203:u=t(r.expression,s,u);break;case 192:case 193:u=t(r.operand,s,u);break;case 194:u=t(r.left,s,u),u=t(r.right,s,u);break;case 195:u=t(r.condition,s,u),u=t(r.whenTrue,s,u),u=t(r.whenFalse,s,u);break;case 196:u=t(r.head,s,u),u=a(r.templateSpans,l,u);break;case 199:u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.typeParameters,l,u),u=a(r.heritageClauses,l,u),u=a(r.members,l,u);break;case 201:u=t(r.expression,s,u),u=a(r.typeArguments,l,u);break;case 202:u=t(r.expression,s,u),u=t(r.type,s,u);break;case 205:u=t(r.expression,s,u),u=t(r.literal,s,u);break;case 207:u=a(r.statements,l,u);break;case 208:u=a(r.modifiers,l,u),u=t(r.declarationList,s,u);break;case 210:u=t(r.expression,s,u);break;case 211:u=t(r.expression,s,u),u=t(r.thenStatement,s,u),u=t(r.elseStatement,s,u);break;case 212:u=t(r.statement,s,u),u=t(r.expression,s,u);break;case 213:case 220:u=t(r.expression,s,u),u=t(r.statement,s,u);break;case 214:u=t(r.initializer,s,u),u=t(r.condition,s,u),u=t(r.incrementor,s,u),u=t(r.statement,s,u);break;case 215:case 216:u=t(r.initializer,s,u),u=t(r.expression,s,u),u=t(r.statement,s,u);break;case 219:case 223:u=t(r.expression,s,u);break;case 221:u=t(r.expression,s,u),u=t(r.caseBlock,s,u);break;case 222:u=t(r.label,s,u),u=t(r.statement,s,u);break;case 224:u=t(r.tryBlock,s,u),u=t(r.catchClause,s,u),u=t(r.finallyBlock,s,u);break;case 226:u=t(r.name,s,u),u=t(r.type,s,u),u=t(r.initializer,s,u);break;case 227:u=a(r.declarations,l,u);break;case 228:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.typeParameters,l,u),u=a(r.parameters,l,u),u=t(r.type,s,u),u=t(r.body,s,u);break;case 229:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.typeParameters,l,u),u=a(r.heritageClauses,l,u),u=a(r.members,l,u);break;case 232:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=a(r.members,l,u);break;case 233:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=t(r.body,s,u);break;case 234:u=a(r.statements,l,u);break;case 235:u=a(r.clauses,l,u);break;case 237:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.name,s,u),u=t(r.moduleReference,s,u);break;case 238:u=a(r.decorators,l,u),u=a(r.modifiers,l,u),u=t(r.importClause,s,u),u=t(r.moduleSpecifier,s,u);break;case 239:u=t(r.name,s,u),u=t(r.namedBindings,s,u);break;case 240:u=t(r.name,s,u);break;case 241:case 245:u=a(r.elements,l,u);break;case 242:case 246:u=t(r.propertyName,s,u),u=t(r.name,s,u);break;case 243:u=e.reduceLeft(r.decorators,s,u),u=e.reduceLeft(r.modifiers,s,u),u=t(r.expression,s,u);break;case 244:u=e.reduceLeft(r.decorators,s,u),u=e.reduceLeft(r.modifiers,s,u),u=t(r.exportClause,s,u),u=t(r.moduleSpecifier,s,u);break;case 248:u=t(r.expression,s,u);break;case 249:u=t(r.openingElement,s,u),u=e.reduceLeft(r.children,s,u),u=t(r.closingElement,s,u);break;case 250:case 251:u=t(r.tagName,s,u),u=t(r.attributes,s,u);break;case 254:u=a(r.properties,l,u);break;case 252:u=t(r.tagName,s,u);break;case 253:u=t(r.name,s,u),u=t(r.initializer,s,u);break;case 255:case 256:u=t(r.expression,s,u);break;case 257:u=t(r.expression,s,u);case 258:u=a(r.statements,l,u);break;case 259:u=a(r.types,l,u);break;case 260:u=t(r.variableDeclaration,s,u),u=t(r.block,s,u);break;case 261:u=t(r.name,s,u),u=t(r.initializer,s,u);break;case 262:u=t(r.name,s,u),u=t(r.objectAssignmentInitializer,s,u);break;case 263:u=t(r.expression,s,u);break;case 264:u=t(r.name,s,u),u=t(r.initializer,s,u);break;case 265:u=a(r.statements,l,u);break;case 288:u=t(r.expression,s,u);break;case 289:u=a(r.elements,l,u)}return u}function i(t){if(void 0===t)return 0;if(536870912&t.transformFlags)return t.transformFlags&~e.getTransformFlagsSubtreeExclusions(t.kind);var n=function(t){if(e.hasModifier(t,2)||e.isTypeNode(t)&&201!==t.kind)return 0;return r(t,0,s,o)}(t);return e.computeTransformFlagsForNode(t,n)}function s(e,t){return e|i(t)}function o(e,t){return e|function(e){if(void 0===e)return 0;for(var t=0,n=0,r=0,s=e;r<s.length;r++){var o=s[r];t|=i(o),n|=-536870913&o.transformFlags}return e.transformFlags=536870912|n,t}(t)}var a;e.reduceEachChild=r,e.mergeLexicalEnvironment=function(t,n){return e.some(n)?e.isNodeArray(t)?e.setTextRange(e.createNodeArray(e.concatenate(t,n)),t):e.addRange(t,n):t},e.liftToBlock=function(t){return a.assert(e.every(t,e.isStatement),"Cannot lift nodes to a Block."),e.singleOrUndefined(t)||e.createBlock(t)},e.aggregateTransformFlags=function(e){return i(e),e},function(t){var n=!1;t.failBadSyntaxKind=t.shouldAssert(1)?function(n,r){return t.fail((r||"Unexpected node.")+"\r\nNode "+e.formatSyntaxKind(n.kind)+" was unexpected.",t.failBadSyntaxKind)}:e.noop,t.assertEachNode=t.shouldAssert(1)?function(n,r,i){return t.assert(void 0===r||e.every(n,r),i||"Unexpected node.",(function(){return"Node array did not pass test '"+t.getFunctionName(r)+"'."}),t.assertEachNode)}:e.noop,t.assertNode=t.shouldAssert(1)?function(n,r,i){return t.assert(void 0===r||r(n),i||"Unexpected node.",(function(){return"Node "+e.formatSyntaxKind(n.kind)+" did not pass test '"+t.getFunctionName(r)+"'."}),t.assertNode)}:e.noop,t.assertOptionalNode=t.shouldAssert(1)?function(n,r,i){return t.assert(void 0===r||void 0===n||r(n),i||"Unexpected node.",(function(){return"Node "+e.formatSyntaxKind(n.kind)+" did not pass test '"+t.getFunctionName(r)+"'."}),t.assertOptionalNode)}:e.noop,t.assertOptionalToken=t.shouldAssert(1)?function(n,r,i){return t.assert(void 0===r||void 0===n||n.kind===r,i||"Unexpected node.",(function(){return"Node "+e.formatSyntaxKind(n.kind)+" was not a '"+e.formatSyntaxKind(r)+"' token."}),t.assertOptionalToken)}:e.noop,t.assertMissingNode=t.shouldAssert(1)?function(n,r){return t.assert(void 0===n,r||"Unexpected node.",(function(){return"Node "+e.formatSyntaxKind(n.kind)+" was unexpected'."}),t.assertMissingNode)}:e.noop,t.enableDebugInfo=function(){if(!n){Object.defineProperties(e.objectAllocator.getSymbolConstructor().prototype,{__debugFlags:{get:function(){return e.formatSymbolFlags(this.flags)}}}),Object.defineProperties(e.objectAllocator.getTypeConstructor().prototype,{__debugFlags:{get:function(){return e.formatTypeFlags(this.flags)}},__debugObjectFlags:{get:function(){return 32768&this.flags?e.formatObjectFlags(this.objectFlags):""}},__debugTypeToString:{value:function(){return this.checker.typeToString(this)}}});for(var t=0,r=[e.objectAllocator.getNodeConstructor(),e.objectAllocator.getIdentifierConstructor(),e.objectAllocator.getTokenConstructor(),e.objectAllocator.getSourceFileConstructor()];t<r.length;t++){var i=r[t];i.prototype.hasOwnProperty("__debugKind")||Object.defineProperties(i.prototype,{__debugKind:{get:function(){return e.formatSyntaxKind(this.kind)}},__debugModifierFlags:{get:function(){return e.formatModifierFlags(e.getModifierFlagsNoCache(this))}},__debugTransformFlags:{get:function(){return e.formatTransformFlags(this.transformFlags)}},__debugEmitFlags:{get:function(){return e.formatEmitFlags(e.getEmitFlags(this))}},__debugGetText:{value:function(t){if(e.nodeIsSynthesized(this))return"";var n=e.getParseTreeNode(this),r=n&&e.getSourceFileOfNode(n);return r?e.getSourceTextOfNodeFromSourceFile(r,n,t):""}}})}n=!0}}}(a=e.Debug||(e.Debug={}))}(ts||(ts={})),function(e){function t(t){return(t=e.getOriginalNode(t))?e.getNodeId(t):0}function n(t,r,i){if(e.isBindingPattern(t.name))for(var s=0,o=t.name.elements;s<o.length;s++){var a=o[s];e.isOmittedExpression(a)||(i=n(a,r,i))}else if(!e.isGeneratedIdentifier(t.name)){var l=e.idText(t.name);r.get(l)||(r.set(l,!0),i=e.append(i,t.name))}return i}function r(e,t,n){var r=e[t];return r?r.push(n):e[t]=r=[n],r}e.getOriginalNodeId=t,e.collectExternalModuleInfo=function(i,s,o){for(var a,l=[],c=e.createMultiMap(),u=[],d=e.createMap(),p=!1,h=void 0,f=!1,m=0,_=i.statements;m<_.length;m++){var g=_[m];switch(g.kind){case 238:l.push(g);break;case 237:248===g.moduleReference.kind&&l.push(g);break;case 244:if(g.moduleSpecifier)g.exportClause?l.push(g):(l.push(g),f=!0);else for(var y=0,b=g.exportClause.elements;y<b.length;y++){var v=b[y];if(!d.get(e.idText(v.name))){var T=v.propertyName||v.name;c.add(e.idText(T),v),(x=s.getReferencedImportDeclaration(T)||s.getReferencedValueDeclaration(T))&&r(u,t(x),v.name),d.set(e.idText(v.name),!0),a=e.append(a,v.name)}}break;case 243:g.isExportEquals&&!h&&(h=g);break;case 208:if(e.hasModifier(g,1))for(var k=0,E=g.declarationList.declarations;k<E.length;k++){var x;a=n(x=E[k],d,a)}break;case 228:if(e.hasModifier(g,1))if(e.hasModifier(g,512))p||(r(u,t(g),e.getDeclarationName(g)),p=!0);else{T=g.name;d.get(e.idText(T))||(r(u,t(g),T),d.set(e.idText(T),!0),a=e.append(a,T))}break;case 229:if(e.hasModifier(g,1))if(e.hasModifier(g,512))p||(r(u,t(g),e.getDeclarationName(g)),p=!0);else(T=g.name)&&!d.get(e.idText(T))&&(r(u,t(g),T),d.set(e.idText(T),!0),a=e.append(a,T))}}var S=e.getOrCreateExternalHelpersModuleNameIfNeeded(i,o,f),C=S&&e.createImportDeclaration(void 0,void 0,e.createImportClause(void 0,e.createNamespaceImport(S)),e.createLiteral(e.externalHelpersModuleNameText));return C&&l.unshift(C),{externalImports:l,exportSpecifiers:c,exportEquals:h,hasExportStarsToExportValues:f,exportedBindings:u,exportedNames:a,externalHelpersImportDeclaration:C}},e.isSimpleCopiableExpression=function(t){return 9===t.kind||8===t.kind||13===t.kind||e.isKeyword(t.kind)||e.isIdentifier(t)}}(ts||(ts={})),function(e){function t(i,s,o,a,l){if(!l){var c=e.visitNode(e.getInitializerOfBindingOrAssignmentElement(s),i.visitor,e.isExpression);c?o=o?function(t,n,i,s){return n=r(t,n,!0,s),e.createConditional(e.createTypeCheck(n,"undefined"),i,n)}(i,o,c,a):c:o||(o=e.createVoidZero())}var u=e.getTargetOfBindingOrAssignmentElement(s);e.isObjectBindingOrAssignmentPattern(u)?function(i,s,o,a,l){var c,u,p=e.getElementsOfBindingOrAssignmentPattern(o),h=p.length;if(1!==h){a=r(i,a,!e.isDeclarationBindingElement(s)||0!==h,l)}for(var f=0;f<h;f++){var m=p[f];if(e.getRestIndicatorOfBindingOrAssignmentElement(m)){if(f===h-1){c&&(i.emitBindingOrAssignment(i.createObjectBindingOrAssignmentPattern(c),a,l,o),c=void 0),t(i,m,g=d(i.context,a,p,u,o),m)}}else{var _=e.getPropertyNameOfBindingOrAssignmentElement(m);if(!(i.level>=1)||1572864&m.transformFlags||1572864&e.getTargetOfBindingOrAssignmentElement(m).transformFlags||e.isComputedPropertyName(_)){c&&(i.emitBindingOrAssignment(i.createObjectBindingOrAssignmentPattern(c),a,l,o),c=void 0);var g=n(i,a,_);e.isComputedPropertyName(_)&&(u=e.append(u,g.argumentExpression)),t(i,m,g,m)}else c=e.append(c,m)}}c&&i.emitBindingOrAssignment(i.createObjectBindingOrAssignmentPattern(c),a,l,o)}(i,s,u,o,a):e.isArrayBindingOrAssignmentPattern(u)?function(n,i,s,o,a){var l,c,u=e.getElementsOfBindingOrAssignmentPattern(s),d=u.length;if(n.level<1&&n.downlevelIteration)o=r(n,e.createReadHelper(n.context,o,d>0&&e.getRestIndicatorOfBindingOrAssignmentElement(u[d-1])?void 0:d,a),!1,a);else if(1!==d&&(n.level<1||0===d)||e.every(u,e.isOmittedExpression)){o=r(n,o,!e.isDeclarationBindingElement(i)||0!==d,a)}for(var p=0;p<d;p++){var h=u[p];if(n.level>=1)if(1048576&h.transformFlags){var f=e.createTempVariable(void 0);n.hoistTempVariables&&n.context.hoistVariableDeclaration(f),c=e.append(c,[f,h]),l=e.append(l,n.createArrayBindingOrAssignmentElement(f))}else l=e.append(l,h);else{if(e.isOmittedExpression(h))continue;if(e.getRestIndicatorOfBindingOrAssignmentElement(h)){if(p===d-1){t(n,h,e.createArraySlice(o,p),h)}}else t(n,h,e.createElementAccess(o,p),h)}}l&&n.emitBindingOrAssignment(n.createArrayBindingOrAssignmentPattern(l),o,a,s);if(c)for(var m=0,_=c;m<_.length;m++){var g=_[m],y=g[0];t(n,h=g[1],y,h)}}(i,s,u,o,a):i.emitBindingOrAssignment(u,o,a,s)}function n(t,n,i){if(e.isComputedPropertyName(i)){var s=r(t,e.visitNode(i.expression,t.visitor),!1,i);return e.createElementAccess(n,s)}if(e.isStringOrNumericLiteral(i))return(s=e.getSynthesizedClone(i)).text=s.text,e.createElementAccess(n,s);var o=e.createIdentifier(e.idText(i));return e.createPropertyAccess(n,o)}function r(t,n,r,i){if(e.isIdentifier(n)&&r)return n;var s=e.createTempVariable(void 0);return t.hoistTempVariables?(t.context.hoistVariableDeclaration(s),t.emitExpression(e.setTextRange(e.createAssignment(s,n),i))):t.emitBindingOrAssignment(s,n,i,void 0),s}function i(t){return e.Debug.assertEachNode(t,e.isArrayBindingElement),e.createArrayBindingPattern(t)}function s(t){return e.createArrayLiteral(e.map(t,e.convertToArrayAssignmentElement))}function o(t){return e.Debug.assertEachNode(t,e.isBindingElement),e.createObjectBindingPattern(t)}function a(t){return e.createObjectLiteral(e.map(t,e.convertToObjectAssignmentElement))}function l(t){return e.createBindingElement(void 0,void 0,t)}function c(e){return e}!function(e){e[e.All=0]="All",e[e.ObjectRest=1]="ObjectRest"}(e.FlattenLevel||(e.FlattenLevel={})),e.flattenDestructuringAssignment=function(n,i,o,l,u,d){var p,h,f=n;if(e.isDestructuringAssignment(n))for(p=n.right;e.isEmptyArrayLiteral(n.left)||e.isEmptyObjectLiteral(n.left);){if(!e.isDestructuringAssignment(p))return p;f=n=p,p=n.right}var m={context:o,level:l,downlevelIteration:o.getCompilerOptions().downlevelIteration,hoistTempVariables:!0,emitExpression:_,emitBindingOrAssignment:function(t,n,r,s){e.Debug.assertNode(t,d?e.isIdentifier:e.isExpression);var o=d?d(t,n,r):e.setTextRange(e.createAssignment(e.visitNode(t,i,e.isExpression),n),r);o.original=s,_(o)},createArrayBindingOrAssignmentPattern:s,createObjectBindingOrAssignmentPattern:a,createArrayBindingOrAssignmentElement:c,visitor:i};if(p&&(p=e.visitNode(p,i,e.isExpression),u?p=r(m,p,!0,f):e.nodeIsSynthesized(n)&&(f=p)),t(m,n,p,f,e.isDestructuringAssignment(n)),p&&u){if(!e.some(h))return p;h.push(p)}return e.aggregateTransformFlags(e.inlineExpressions(h))||e.createOmittedExpression();function _(t){e.setEmitFlags(t,64),e.aggregateTransformFlags(t),h=e.append(h,t)}},e.flattenDestructuringBinding=function(n,r,s,a,c,u,d){var p,h=[],f=[];if(t({context:s,level:a,downlevelIteration:s.getCompilerOptions().downlevelIteration,hoistTempVariables:u,emitExpression:function(t){p=e.append(p,t)},emitBindingOrAssignment:C,createArrayBindingOrAssignmentPattern:i,createObjectBindingOrAssignmentPattern:o,createArrayBindingOrAssignmentElement:l,visitor:r},n,c,n,d),p){var m=e.createTempVariable(void 0);if(u){var _=e.inlineExpressions(p);p=void 0,C(m,_,void 0,void 0)}else{s.hoistVariableDeclaration(m);var g=e.lastOrUndefined(h);g.pendingExpressions=e.append(g.pendingExpressions,e.createAssignment(m,g.value)),e.addRange(g.pendingExpressions,p),g.value=m}}for(var y=0,b=h;y<b.length;y++){var v=b[y],T=v.pendingExpressions,k=v.name,E=(_=v.value,v.location),x=v.original,S=e.createVariableDeclaration(k,void 0,T?e.inlineExpressions(e.append(T,_)):_);S.original=x,e.setTextRange(S,E),e.isIdentifier(k)&&e.setEmitFlags(S,64),e.aggregateTransformFlags(S),f.push(S)}return f;function C(t,n,r,i){e.Debug.assertNode(t,e.isBindingName),p&&(n=e.inlineExpressions(e.append(p,n)),p=void 0),h.push({pendingExpressions:p,name:t,value:n,location:r,original:i})}};var u={name:"typescript:rest",scoped:!1,text:'\n            var __rest = (this && this.__rest) || function (s, e) {\n                var t = {};\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n                    t[p] = s[p];\n                if (s != null && typeof Object.getOwnPropertySymbols === "function")\n                    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n                        t[p[i]] = s[p[i]];\n                return t;\n            };'};function d(t,n,r,i,s){t.requestEmitHelper(u);for(var o=[],a=0,l=0;l<r.length-1;l++){var c=e.getPropertyNameOfBindingOrAssignmentElement(r[l]);if(c)if(e.isComputedPropertyName(c)){var d=i[a];a++,o.push(e.createConditional(e.createTypeCheck(d,"symbol"),d,e.createAdd(d,e.createLiteral(""))))}else o.push(e.createLiteral(c))}return e.createCall(e.getHelperName("__rest"),void 0,[n,e.setTextRange(e.createArrayLiteral(o),s)])}}(ts||(ts={})),function(e){var t,n;function r(t,n,r,s,o,a){var l=[];return l.push(e.createArrayLiteral(n,!0)),l.push(r),s&&(l.push(s),o&&l.push(o)),t.requestEmitHelper(i),e.setTextRange(e.createCall(e.getHelperName("__decorate"),void 0,l),a)}!function(e){e[e.ClassAliases=1]="ClassAliases",e[e.NamespaceExports=2]="NamespaceExports",e[e.NonQualifiedEnumMembers=8]="NonQualifiedEnumMembers"}(t||(t={})),function(e){e[e.None=0]="None",e[e.HasStaticInitializedProperties=1]="HasStaticInitializedProperties",e[e.HasConstructorDecorators=2]="HasConstructorDecorators",e[e.HasMemberDecorators=4]="HasMemberDecorators",e[e.IsExportOfNamespace=8]="IsExportOfNamespace",e[e.IsNamedExternalExport=16]="IsNamedExternalExport",e[e.IsDefaultExternalExport=32]="IsDefaultExternalExport",e[e.IsDerivedClass=64]="IsDerivedClass",e[e.UseImmediatelyInvokedFunctionExpression=128]="UseImmediatelyInvokedFunctionExpression",e[e.HasAnyDecorators=6]="HasAnyDecorators",e[e.NeedsName=5]="NeedsName",e[e.MayNeedImmediatelyInvokedFunctionExpression=7]="MayNeedImmediatelyInvokedFunctionExpression",e[e.IsExported=56]="IsExported"}(n||(n={})),e.transformTypeScript=function(t){var n,i,o,l,c,u,d,p,h=t.startLexicalEnvironment,f=t.resumeLexicalEnvironment,m=t.endLexicalEnvironment,_=t.hoistVariableDeclaration,g=t.getEmitResolver(),y=t.getCompilerOptions(),b=void 0===y.strictNullChecks?y.strict:y.strictNullChecks,v=e.getEmitScriptTarget(y),T=e.getEmitModuleKind(y),k=t.onEmitNode,E=t.onSubstituteNode;return t.onEmitNode=function(t,r,i){var s=p,o=n;e.isSourceFile(r)&&(n=r);2&u&&function(t){return 233===e.getOriginalNode(t).kind}(r)&&(p|=2);8&u&&function(t){return 232===e.getOriginalNode(t).kind}(r)&&(p|=8);k(t,r,i),p=s,n=o},t.onSubstituteNode=function(t,n){if(n=E(t,n),1===t)return function(t){switch(t.kind){case 71:return function(t){return function(t){if(1&u&&16777216&g.getNodeCheckFlags(t)){var n=g.getReferencedValueDeclaration(t);if(n){var r=d[n.id];if(r){var i=e.getSynthesizedClone(r);return e.setSourceMapRange(i,t),e.setCommentRange(i,t),i}}}return}(t)||Be(t)||t}(t);case 179:case 180:return function(e){return Ue(e)}(t)}return t}(n);if(e.isShorthandPropertyAssignment(n))return function(t){if(2&u){var n=t.name,r=Be(n);if(r){if(t.objectAssignmentInitializer){var i=e.createAssignment(r,t.objectAssignmentInitializer);return e.setTextRange(e.createPropertyAssignment(n,i),t)}return e.setTextRange(e.createPropertyAssignment(n,r),t)}}return t}(n);return n},t.enableSubstitution(179),t.enableSubstitution(180),function(r){if(r.isDeclarationFile)return r;n=r;var i=x(r,P);return e.addEmitHelpers(i,t.readEmitHelpers()),n=void 0,i};function x(t,n){var r=l,i=c;!function(t){switch(t.kind){case 265:case 235:case 234:case 207:l=t,c=void 0;break;case 229:case 228:if(e.hasModifier(t,2))break;t.name?ye(t):e.Debug.assert(229===t.kind||e.hasModifier(t,512))}}(t);var s=n(t);return l!==r&&(c=i),l=r,s}function S(e){return x(e,C)}function C(n){return 1&n.transformFlags?L(n):2&n.transformFlags?e.visitEachChild(n,S,t):n}function I(e){return x(e,A)}function A(n){switch(n.kind){case 238:case 237:case 243:case 244:return function(n){if(e.getParseTreeNode(n)!==n)return n;switch(n.kind){case 238:return function(t){if(!t.importClause)return t;var n=e.visitNode(t.importClause,Ee,e.isImportClause);return n?e.updateImportDeclaration(t,void 0,void 0,n,t.moduleSpecifier):void 0}(n);case 237:return Ae(n);case 243:return function(n){return g.isValueAliasDeclaration(n)?e.visitEachChild(n,S,t):void 0}(n);case 244:return function(t){if(!t.exportClause)return y.isolatedModules||g.moduleExportsSomeValue(t.moduleSpecifier)?t:void 0;if(!g.isValueAliasDeclaration(t))return;var n=e.visitNode(t.exportClause,Ce,e.isNamedExports);return n?e.updateExportDeclaration(t,void 0,void 0,n,t.moduleSpecifier):void 0}(n);default:e.Debug.fail("Unhandled ellided statement")}}(n);default:return C(n)}}function w(e){return x(e,N)}function N(n){if(244!==n.kind&&238!==n.kind&&239!==n.kind&&(237!==n.kind||248!==n.moduleReference.kind))return 1&n.transformFlags||e.hasModifier(n,1)?L(n):2&n.transformFlags?e.visitEachChild(n,S,t):n}function D(e){return x(e,O)}function O(t){switch(t.kind){case 152:return;case 149:case 157:case 153:case 154:case 151:return C(t);case 206:return t;default:return void e.Debug.failBadSyntaxKind(t)}}function R(t){if(!(2270&e.modifierToFlag(t.kind)||i&&84===t.kind))return t}function L(s){if(e.hasModifier(s,2)&&e.isStatement(s))return e.createNotEmittedStatement(s);switch(s.kind){case 84:case 79:return i?void 0:s;case 114:case 112:case 113:case 117:case 76:case 124:case 131:case 164:case 165:case 163:case 158:case 145:case 119:case 122:case 136:case 133:case 130:case 105:case 137:case 161:case 160:case 162:case 159:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 157:case 147:case 231:case 149:case 236:return;case 152:return function(n){if(!he(n))return;return e.updateConstructor(n,e.visitNodes(n.decorators,S,e.isDecorator),e.visitNodes(n.modifiers,S,e.isModifier),e.visitParameterList(n.parameters,S,t),e.visitFunctionBody(n.body,S,t))}(s);case 230:return e.createNotEmittedStatement(s);case 229:return function(i){var s=U(i,!0),o=function(t,n){var r=0;e.some(n)&&(r|=1);var i=e.getClassExtendsHeritageClauseElement(t);i&&95!==e.skipOuterExpressions(i.expression).kind&&(r|=64);(function(t){if(t.decorators&&t.decorators.length>0)return!0;var n=e.getFirstConstructorWithBody(t);if(n)return e.forEach(n.parameters,M);return!1})(t)&&(r|=2);e.childIsDecorated(t)&&(r|=4);we(t)?r|=8:!function(t){return Ne(t)&&e.hasModifier(t,512)}(t)?De(t)&&(r|=16):r|=32;v<=1&&7&r&&(r|=128);return r}(i,s);128&o&&t.startLexicalEnvironment();var a=i.name||(5&o?e.getGeneratedNameForNode(i):void 0),l=2&o?function(t,n,r){var i=e.moveRangePastDecorators(t),s=function(t){if(8388608&g.getNodeCheckFlags(t)){$e();var n=e.createUniqueName(t.name&&!e.isGeneratedIdentifier(t.name)?e.idText(t.name):"default");return d[e.getOriginalNodeId(t)]=n,_(n),n}}(t),o=e.getLocalName(t,!1,!0),a=e.visitNodes(t.heritageClauses,S,e.isHeritageClause),l=F(t,0!=(64&r)),c=e.createClassExpression(void 0,n,void 0,a,l);e.setOriginalNode(c,t),e.setTextRange(c,i);var u=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(o,void 0,s?e.createAssignment(s,c):c)],1));return e.setOriginalNode(u,t),e.setTextRange(u,i),e.setCommentRange(u,t),u}(i,a,o):function(t,n,r){var i=128&r?void 0:e.visitNodes(t.modifiers,R,e.isModifier),s=e.createClassDeclaration(void 0,i,n,void 0,e.visitNodes(t.heritageClauses,S,e.isHeritageClause),F(t,0!=(64&r))),o=e.getEmitFlags(t);1&r&&(o|=32);return e.setTextRange(s,t),e.setOriginalNode(s,t),e.setEmitFlags(s,o),s}(i,a,o),c=[l];1&o&&j(c,s,128&o?e.getInternalName(i):e.getLocalName(i));if(Q(c,i,!1),Q(c,i,!0),function(n,i){var s=function(n){var i=function(t){var n=t.decorators,r=J(e.getFirstConstructorWithBody(t));if(!n&&!r)return;return{decorators:n,parameters:r}}(n),s=X(n,n,i);if(!s)return;var o=d&&d[e.getOriginalNodeId(n)],a=e.getLocalName(n,!1,!0),l=r(t,s,a),c=e.createAssignment(a,o?e.createAssignment(o,l):l);return e.setEmitFlags(c,1536),e.setSourceMapRange(c,e.moveRangePastDecorators(n)),c}(i);s&&n.push(e.setOriginalNode(e.createStatement(s),i))}(c,i),128&o){var u=e.createTokenRange(e.skipTrivia(n.text,i.members.end),18),p=e.getInternalName(i),h=e.createPartiallyEmittedExpression(p);h.end=u.end,e.setEmitFlags(h,1536);var f=e.createReturn(h);f.pos=u.pos,e.setEmitFlags(f,1920),c.push(f),e.addRange(c,t.endLexicalEnvironment());var m=e.createImmediatelyInvokedArrowFunction(c);e.setEmitFlags(m,33554432);var y=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.getLocalName(i,!1,!1),void 0,m)]));e.setOriginalNode(y,i),e.setCommentRange(y,i),e.setSourceMapRange(y,e.moveRangePastDecorators(i)),e.startOnNewLine(y),c=[y]}8&o?Re(c,i):(128&o||2&o)&&(32&o?c.push(e.createExportDefault(e.getLocalName(i,!1,!0))):16&o&&c.push(e.createExternalModuleExport(e.getLocalName(i,!1,!0))));c.length>1&&(c.push(e.createEndOfDeclarationMarker(i)),e.setEmitFlags(l,4194304|e.getEmitFlags(l)));return e.singleOrMany(c)}(s);case 199:return function(t){var n=U(t,!0),r=e.visitNodes(t.heritageClauses,S,e.isHeritageClause),i=F(t,e.some(r,(function(e){return 85===e.token}))),s=e.createClassExpression(void 0,t.name,void 0,r,i);if(e.setOriginalNode(s,t),e.setTextRange(s,t),n.length>0){var o=[],a=e.createTempVariable(_);return 8388608&g.getNodeCheckFlags(t)&&($e(),d[e.getOriginalNodeId(t)]=e.getSynthesizedClone(a)),e.setEmitFlags(s,65536|e.getEmitFlags(s)),o.push(e.startOnNewLine(e.createAssignment(a,s))),e.addRange(o,function(t,n){for(var r=[],i=0,s=t;i<s.length;i++){var o=s[i],a=K(o,n);a.startsOnNewLine=!0,e.setSourceMapRange(a,e.moveRangePastModifiers(o)),e.setCommentRange(a,o),r.push(a)}return r}(n,a)),o.push(e.startOnNewLine(a)),e.inlineExpressions(o)}return s}(s);case 259:return function(t){if(85===t.token){var n=e.visitNodes(t.types,S,e.isExpressionWithTypeArguments,0,1);return e.setTextRange(e.createHeritageClause(85,n),t)}return}(s);case 201:return function(t){return e.updateExpressionWithTypeArguments(t,void 0,e.visitNode(t.expression,S,e.isLeftHandSideExpression))}(s);case 151:return function(n){if(!he(n))return;var r=e.updateMethod(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),n.asteriskToken,pe(n),void 0,void 0,e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t));r!==n&&(e.setCommentRange(r,n),e.setSourceMapRange(r,e.moveRangePastDecorators(n)));return r}(s);case 153:return function(n){if(!fe(n))return;var r=e.updateGetAccessor(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),pe(n),e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t)||e.createBlock([]));r!==n&&(e.setCommentRange(r,n),e.setSourceMapRange(r,e.moveRangePastDecorators(n)));return r}(s);case 154:return function(n){if(!fe(n))return;var r=e.updateSetAccessor(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),pe(n),e.visitParameterList(n.parameters,S,t),e.visitFunctionBody(n.body,S,t)||e.createBlock([]));r!==n&&(e.setCommentRange(r,n),e.setSourceMapRange(r,e.moveRangePastDecorators(n)));return r}(s);case 228:return function(n){if(!he(n))return e.createNotEmittedStatement(n);var r=e.updateFunctionDeclaration(n,void 0,e.visitNodes(n.modifiers,R,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t)||e.createBlock([]));if(we(n)){var i=[r];return Re(i,n),i}return r}(s);case 186:return function(n){if(!he(n))return e.createOmittedExpression();return e.updateFunctionExpression(n,e.visitNodes(n.modifiers,R,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,S,t),void 0,e.visitFunctionBody(n.body,S,t)||e.createBlock([]))}(s);case 187:return function(n){return e.updateArrowFunction(n,e.visitNodes(n.modifiers,R,e.isModifier),void 0,e.visitParameterList(n.parameters,S,t),void 0,n.equalsGreaterThanToken,e.visitFunctionBody(n.body,S,t))}(s);case 146:return function(t){if(e.parameterIsThisKeyword(t))return;var n=e.createParameter(void 0,void 0,t.dotDotDotToken,e.visitNode(t.name,S,e.isBindingName),void 0,void 0,e.visitNode(t.initializer,S,e.isExpression));return e.setOriginalNode(n,t),e.setTextRange(n,e.moveRangePastModifiers(t)),e.setCommentRange(n,t),e.setSourceMapRange(n,e.moveRangePastModifiers(t)),e.setEmitFlags(n.name,32),n}(s);case 185:return function(n){var r=e.skipOuterExpressions(n.expression,-3);if(e.isAssertionExpression(r)){var i=e.visitNode(n.expression,S,e.isExpression);return e.createPartiallyEmittedExpression(i,n)}return e.visitEachChild(n,S,t)}(s);case 184:case 202:return function(t){var n=e.visitNode(t.expression,S,e.isExpression);return e.createPartiallyEmittedExpression(n,t)}(s);case 181:return function(t){return e.updateCall(t,e.visitNode(t.expression,S,e.isExpression),void 0,e.visitNodes(t.arguments,S,e.isExpression))}(s);case 182:return function(t){return e.updateNew(t,e.visitNode(t.expression,S,e.isExpression),void 0,e.visitNodes(t.arguments,S,e.isExpression))}(s);case 203:return function(t){var n=e.visitNode(t.expression,S,e.isLeftHandSideExpression);return e.createPartiallyEmittedExpression(n,t)}(s);case 232:return function(t){if(!function(t){return!e.isConst(t)||y.preserveConstEnums||y.isolatedModules}(t))return;var r=[],i=2;ve(r,t)&&(T===e.ModuleKind.System&&l===n||(i|=512));var s=Me(t),a=Fe(t),c=e.hasModifier(t,1)?e.getExternalModuleOrNamespaceExportName(o,t,!1,!0):e.getLocalName(t,!1,!0),u=e.createLogicalOr(c,e.createAssignment(c,e.createObjectLiteral()));if(ge(t)){var d=e.getLocalName(t,!1,!0);u=e.createAssignment(d,u)}var p=e.createStatement(e.createCall(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,s)],void 0,function(t,n){var r=o;o=n;var i=[];return h(),e.addRange(i,e.map(t.members,_e)),e.addRange(i,m()),o=r,e.createBlock(e.setTextRange(e.createNodeArray(i),t.members),!0)}(t,a)),void 0,[u]));return e.setOriginalNode(p,t),e.setTextRange(p,t),e.setEmitFlags(p,i),r.push(p),r.push(e.createEndOfDeclarationMarker(t)),r}(s);case 208:return function(n){if(we(n)){var r=e.getInitializedVariables(n.declarationList);if(0===r.length)return;return e.setTextRange(e.createStatement(e.inlineExpressions(e.map(r,me))),n)}return e.visitEachChild(n,S,t)}(s);case 226:return function(t){return e.updateVariableDeclaration(t,e.visitNode(t.name,S,e.isBindingName),void 0,e.visitNode(t.initializer,S,e.isExpression))}(s);case 233:return Te(s);case 237:return Ae(s);default:return e.Debug.failBadSyntaxKind(s),e.visitEachChild(s,S,t)}}function P(n){var r=(void 0===y.alwaysStrict?y.strict:y.alwaysStrict)&&!(e.isExternalModule(n)&&T>=e.ModuleKind.ES2015);return e.updateSourceFileNode(n,e.visitLexicalEnvironment(n.statements,I,t,0,r))}function M(e){return void 0!==e.decorators&&e.decorators.length>0}function F(n,r){var i=[],s=function(n,r){var i=e.forEach(n.members,H),s=262144&n.transformFlags,o=e.getFirstConstructorWithBody(n);if(!i&&!s)return e.visitEachChild(o,S,t);var a=function(n){return e.visitParameterList(n&&n.parameters,S,t)||[]}(o),l=function(t,n,r){var i=[],s=0;if(f(),n){s=function(t,n){if(t.body){var r=t.body.statements,i=e.addPrologue(n,r,!1,S);if(i===r.length)return i;var s=r[i];return 210===s.kind&&e.isSuperCall(s.expression)?(n.push(e.visitNode(s,S,e.isStatement)),i+1):i}return 0}(n,i);var o=function(t){return e.filter(t.parameters,$)}(n);e.addRange(i,e.map(o,B))}else r&&i.push(e.createStatement(e.createCall(e.createSuper(),void 0,[e.createSpread(e.createIdentifier("arguments"))])));var a=U(t,!1);j(i,a,e.createThis()),n&&e.addRange(i,e.visitNodes(n.body.statements,S,e.isStatement,s));return i=e.mergeLexicalEnvironment(i,m()),e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(i),n?n.body.statements:t.members),!0),n?n.body:void 0)}(n,o,r);return e.startOnNewLine(e.setOriginalNode(e.setTextRange(e.createConstructor(void 0,void 0,a,l),o||n),o))}(n,r);return s&&i.push(s),e.addRange(i,e.visitNodes(n.members,D,e.isClassElement)),e.setTextRange(e.createNodeArray(i),n.members)}function $(t){return e.hasModifier(t,92)&&e.isIdentifier(t.name)}function B(t){e.Debug.assert(e.isIdentifier(t.name));var n=t.name,r=e.getMutableClone(n);e.setEmitFlags(r,1584);var i=e.getMutableClone(n);return e.setEmitFlags(i,1536),e.startOnNewLine(e.setTextRange(e.createStatement(e.createAssignment(e.setTextRange(e.createPropertyAccess(e.createThis(),r),t.name),i)),e.moveRangePos(t,-1)))}function U(t,n){return e.filter(t.members,n?V:H)}function V(e){return G(e,!0)}function H(e){return G(e,!1)}function G(t,n){return 149===t.kind&&n===e.hasModifier(t,32)&&void 0!==t.initializer}function j(t,n,r){for(var i=0,s=n;i<s.length;i++){var o=s[i],a=e.createStatement(K(o,r));e.setSourceMapRange(a,e.moveRangePastModifiers(o)),e.setCommentRange(a,o),t.push(a)}}function K(t,n){var r=pe(t),i=e.visitNode(t.initializer,S,e.isExpression),s=e.createMemberAccessForPropertyName(n,r,r);return e.createAssignment(s,i)}function W(e){return q(e,!0)}function z(e){return q(e,!1)}function q(t,n){return e.nodeOrChildIsDecorated(t)&&n===e.hasModifier(t,32)}function J(e){var t;if(e)for(var n=e.parameters,r=0;r<n.length;r++){var i=n[r];(t||i.decorators)&&(t||(t=new Array(n.length)),t[r]=i.decorators)}return t}function Y(t,n){switch(n.kind){case 153:case 154:return function(t,n){if(!n.body)return;var r=e.getAllAccessorDeclarations(t.members,n),i=r.firstAccessor,s=r.secondAccessor,o=r.setAccessor,a=i.decorators?i:s&&s.decorators?s:void 0;if(!a||n!==a)return;var l=a.decorators,c=J(o);if(!l&&!c)return;return{decorators:l,parameters:c}}(t,n);case 151:return function(e){if(!e.body)return;var t=e.decorators,n=J(e);if(!t&&!n)return;return{decorators:t,parameters:n}}(n);case 149:return function(e){var t=e.decorators;if(!t)return;return{decorators:t}}(n);default:return}}function X(n,r,i){if(i){var o=[];return e.addRange(o,e.map(i.decorators,ee)),e.addRange(o,e.flatMap(i.parameters,te)),function(e,n,r){(function(e,n,r){y.emitDecoratorMetadata&&(ne(e)&&r.push(s(t,"design:type",se(e))),ie(e)&&r.push(s(t,"design:paramtypes",oe(e,n))),re(e)&&r.push(s(t,"design:returntype",ae(e))))})(e,n,r)}(n,r,o),o}}function Q(t,n,r){e.addRange(t,e.map(function(t,n){for(var r,i=function(t,n){return e.filter(t.members,n?W:z)}(t,n),s=0,o=i;s<o.length;s++){var a=Z(t,o[s]);a&&(r?r.push(a):r=[a])}return r}(n,r),Oe))}function Z(n,i){var s=X(i,n,Y(n,i));if(s){var o=function(t,n){return e.hasModifier(n,32)?e.getDeclarationName(t):function(t){return e.createPropertyAccess(e.getDeclarationName(t),"prototype")}(t)}(n,i),a=de(i,!0),l=v>0?149===i.kind?e.createVoidZero():e.createNull():void 0,c=r(t,s,o,a,l,e.moveRangePastDecorators(i));return e.setEmitFlags(c,1536),c}}function ee(t){return e.visitNode(t.expression,S,e.isExpression)}function te(n,r){var i;if(n){i=[];for(var s=0,o=n;s<o.length;s++){var l=o[s],c=a(t,ee(l),r,l.expression);e.setEmitFlags(c,1536),i.push(c)}}return i}function ne(e){var t=e.kind;return 151===t||153===t||154===t||149===t}function re(e){return 151===e.kind}function ie(t){switch(t.kind){case 229:case 199:return void 0!==e.getFirstConstructorWithBody(t);case 151:case 153:case 154:return!0}return!1}function se(t){switch(t.kind){case 149:case 146:case 153:return le(t.type);case 154:return le(e.getSetAccessorTypeAnnotationNode(t));case 229:case 199:case 151:return e.createIdentifier("Function");default:return e.createVoidZero()}}function oe(t,n){var r=e.isClassLike(t)?e.getFirstConstructorWithBody(t):e.isFunctionLike(t)&&e.nodeIsPresent(t.body)?t:void 0,i=[];if(r)for(var s=function(t,n){if(n&&153===t.kind){var r=e.getAllAccessorDeclarations(n.members,t).setAccessor;if(r)return r.parameters}return t.parameters}(r,n),o=s.length,a=0;a<o;a++){var l=s[a];0===a&&e.isIdentifier(l.name)&&"this"===l.name.escapedText||(l.dotDotDotToken?i.push(le(e.getRestParameterElementType(l.type))):i.push(se(l)))}return e.createArrayLiteral(i)}function ae(t){return e.isFunctionLike(t)&&t.type?le(t.type):e.isAsyncFunction(t)?e.createIdentifier("Promise"):e.createVoidZero()}function le(t){if(void 0===t)return e.createIdentifier("Object");switch(t.kind){case 105:case 139:case 95:case 130:return e.createVoidZero();case 168:return le(t.type);case 160:case 161:return e.createIdentifier("Function");case 164:case 165:return e.createIdentifier("Array");case 158:case 122:return e.createIdentifier("Boolean");case 136:return e.createIdentifier("String");case 134:return e.createIdentifier("Object");case 173:switch(t.literal.kind){case 9:return e.createIdentifier("String");case 8:return e.createIdentifier("Number");case 101:case 86:return e.createIdentifier("Boolean");default:e.Debug.failBadSyntaxKind(t.literal)}break;case 133:return e.createIdentifier("Number");case 137:return v<2?ue():e.createIdentifier("Symbol");case 159:return function(t){switch(g.getTypeReferenceSerializationKind(t.typeName,l)){case e.TypeReferenceSerializationKind.Unknown:var n=ce(t.typeName,!0),r=e.createTempVariable(_);return e.createLogicalOr(e.createLogicalAnd(e.createTypeCheck(e.createAssignment(r,n),"function"),r),e.createIdentifier("Object"));case e.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue:return ce(t.typeName,!1);case e.TypeReferenceSerializationKind.VoidNullableOrNeverType:return e.createVoidZero();case e.TypeReferenceSerializationKind.BooleanType:return e.createIdentifier("Boolean");case e.TypeReferenceSerializationKind.NumberLikeType:return e.createIdentifier("Number");case e.TypeReferenceSerializationKind.StringLikeType:return e.createIdentifier("String");case e.TypeReferenceSerializationKind.ArrayLikeType:return e.createIdentifier("Array");case e.TypeReferenceSerializationKind.ESSymbolType:return v<2?ue():e.createIdentifier("Symbol");case e.TypeReferenceSerializationKind.TypeWithCallSignature:return e.createIdentifier("Function");case e.TypeReferenceSerializationKind.Promise:return e.createIdentifier("Promise");case e.TypeReferenceSerializationKind.ObjectType:default:return e.createIdentifier("Object")}}(t);case 167:case 166:return function(t){for(var n,r=0,i=t.types;r<i.length;r++){for(var s=i[r];168===s.kind;)s=s.type;if(130!==s.kind&&(b||95!==s.kind&&139!==s.kind)){var o=le(s);if(e.isIdentifier(o)&&"Object"===o.escapedText)return o;if(n){if(!e.isIdentifier(n)||!e.isIdentifier(o)||n.escapedText!==o.escapedText)return e.createIdentifier("Object")}else n=o}}return n||e.createVoidZero()}(t);case 162:case 170:case 171:case 172:case 163:case 119:case 169:break;default:e.Debug.failBadSyntaxKind(t)}return e.createIdentifier("Object")}function ce(t,n){switch(t.kind){case 71:var r=e.getMutableClone(t);return r.flags&=-9,r.original=void 0,r.parent=e.getParseTreeNode(l),n?e.createLogicalAnd(e.createStrictInequality(e.createTypeOf(r),e.createLiteral("undefined")),r):r;case 143:return function(t,n){var r;if(71===t.left.kind)r=ce(t.left,n);else if(n){var i=e.createTempVariable(_);r=e.createLogicalAnd(e.createAssignment(i,ce(t.left,!0)),i)}else r=ce(t.left,!1);return e.createPropertyAccess(r,t.right)}(t,n)}}function ue(){return e.createConditional(e.createTypeCheck(e.createIdentifier("Symbol"),"function"),e.createIdentifier("Symbol"),e.createIdentifier("Object"))}function de(t,n){var r=t.name;return e.isComputedPropertyName(r)?n?e.getGeneratedNameForNode(r):r.expression:e.isIdentifier(r)?e.createLiteral(e.idText(r)):e.getSynthesizedClone(r)}function pe(t){var n=t.name;if(e.isComputedPropertyName(n)){var r=e.visitNode(n.expression,S,e.isExpression);if(t.decorators){var i=e.getGeneratedNameForNode(n);_(i),r=e.createAssignment(i,r)}return e.updateComputedPropertyName(n,r)}return n}function he(t){return!e.nodeIsMissing(t.body)}function fe(t){return!(e.nodeIsMissing(t.body)&&e.hasModifier(t,128))}function me(n){var r=n.name;return e.isBindingPattern(r)?e.flattenDestructuringAssignment(n,S,t,0,!1,Le):e.setTextRange(e.createAssignment(Pe(r),e.visitNode(n.initializer,S,e.isExpression)),n)}function _e(n){var r=de(n,!1),i=function(n){var r=g.getConstantValue(n);return void 0!==r?e.createLiteral(r):(0==(8&u)&&(u|=8,t.enableSubstitution(71)),n.initializer?e.visitNode(n.initializer,S,e.isExpression):e.createVoidZero())}(n),s=e.createAssignment(e.createElementAccess(o,r),i),a=9===i.kind?s:e.createAssignment(e.createElementAccess(o,s),r);return e.setTextRange(e.createStatement(e.setTextRange(a,n)),n)}function ge(t){return we(t)||Ne(t)&&T!==e.ModuleKind.ES2015&&T!==e.ModuleKind.ESNext&&T!==e.ModuleKind.System}function ye(t){c||(c=e.createUnderscoreEscapedMap());var n=be(t);c.has(n)||c.set(n,t)}function be(t){return e.Debug.assertNode(t.name,e.isIdentifier),t.name.escapedText}function ve(t,n){var r=e.createVariableStatement(e.visitNodes(n.modifiers,R,e.isModifier),e.createVariableDeclarationList([e.createVariableDeclaration(e.getLocalName(n,!1,!0))],265===l.kind?0:1));if(e.setOriginalNode(r,n),ye(n),function(e){if(c){var t=be(e);return c.get(t)===e}return!0}(n))return 232===n.kind?e.setSourceMapRange(r.declarationList,n):e.setSourceMapRange(r,n),e.setCommentRange(r,n),e.setEmitFlags(r,4195328),t.push(r),!0;var i=e.createMergeDeclarationMarker(r);return e.setEmitFlags(i,4195840),t.push(i),!1}function Te(r){if(!function(t){return e.isInstantiatedModule(t,y.preserveConstEnums||y.isolatedModules)}(r))return e.createNotEmittedStatement(r);e.Debug.assertNode(r.name,e.isIdentifier,"A TypeScript namespace should have an Identifier name."),0==(2&u)&&(u|=2,t.enableSubstitution(71),t.enableSubstitution(262),t.enableEmitNotification(233));var s=[],a=2;ve(s,r)&&(T===e.ModuleKind.System&&l===n||(a|=512));var d=Me(r),p=Fe(r),f=e.hasModifier(r,1)?e.getExternalModuleOrNamespaceExportName(o,r,!1,!0):e.getLocalName(r,!1,!0),_=e.createLogicalOr(f,e.createAssignment(f,e.createObjectLiteral()));if(ge(r)){var g=e.getLocalName(r,!1,!0);_=e.createAssignment(g,_)}var b=e.createStatement(e.createCall(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,d)],void 0,function(t,n){var r=o,s=i,a=c;o=n,i=t,c=void 0;var l,u,d=[];h();var p=t.body;if(234===p.kind)x(p,(function(t){return e.addRange(d,e.visitNodes(t.statements,w,e.isStatement))})),l=p.statements,u=p;else{var f=Te(p);f&&(e.isArray(f)?e.addRange(d,f):d.push(f));var _=ke(t).body;l=e.moveRangePos(_.statements,-1)}e.addRange(d,m()),o=r,i=s,c=a;var g=e.createBlock(e.setTextRange(e.createNodeArray(d),l),!0);e.setTextRange(g,u),234!==p.kind&&e.setEmitFlags(g,1536|e.getEmitFlags(g));return g}(r,p)),void 0,[_]));return e.setOriginalNode(b,r),e.setTextRange(b,r),e.setEmitFlags(b,a),s.push(b),s.push(e.createEndOfDeclarationMarker(r)),s}function ke(e){if(233===e.body.kind)return ke(e.body)||e.body}function Ee(t){var n=g.isReferencedAliasDeclaration(t)?t.name:void 0,r=e.visitNode(t.namedBindings,xe,e.isNamedImportBindings);return n||r?e.updateImportClause(t,n,r):void 0}function xe(t){if(240===t.kind)return g.isReferencedAliasDeclaration(t)?t:void 0;var n=e.visitNodes(t.elements,Se,e.isImportSpecifier);return e.some(n)?e.updateNamedImports(t,n):void 0}function Se(e){return g.isReferencedAliasDeclaration(e)?e:void 0}function Ce(t){var n=e.visitNodes(t.elements,Ie,e.isExportSpecifier);return e.some(n)?e.updateNamedExports(t,n):void 0}function Ie(e){return g.isValueAliasDeclaration(e)?e:void 0}function Ae(r){if(e.isExternalModuleImportEqualsDeclaration(r))return g.isReferencedAliasDeclaration(r)?e.visitEachChild(r,S,t):void 0;if(function(t){return g.isReferencedAliasDeclaration(t)||!e.isExternalModule(n)&&g.isTopLevelValueImportEqualsWithEntityName(t)}(r)){var i=e.createExpressionFromEntityName(r.moduleReference);return e.setEmitFlags(i,3584),De(r)||!we(r)?e.setOriginalNode(e.setTextRange(e.createVariableStatement(e.visitNodes(r.modifiers,R,e.isModifier),e.createVariableDeclarationList([e.setOriginalNode(e.createVariableDeclaration(r.name,void 0,i),r)])),r),r):e.setOriginalNode(function(t,n,r){return e.setTextRange(e.createStatement(e.createAssignment(e.getNamespaceMemberName(o,t,!1,!0),n)),r)}(r.name,i,r),r)}}function we(t){return void 0!==i&&e.hasModifier(t,1)}function Ne(t){return void 0===i&&e.hasModifier(t,1)}function De(t){return Ne(t)&&!e.hasModifier(t,512)}function Oe(t){return e.createStatement(t)}function Re(t,n){var r=e.createAssignment(e.getExternalModuleOrNamespaceExportName(o,n,!1,!0),e.getLocalName(n));e.setSourceMapRange(r,e.createRange(n.name?n.name.pos:n.pos,n.end));var i=e.createStatement(r);e.setSourceMapRange(i,e.createRange(-1,n.end)),t.push(i)}function Le(t,n,r){return e.setTextRange(e.createAssignment(Pe(t),n),r)}function Pe(t){return e.getNamespaceMemberName(o,t,!1,!0)}function Me(t){var n=e.getGeneratedNameForNode(t);return e.setSourceMapRange(n,t.name),n}function Fe(t){return e.getGeneratedNameForNode(t)}function $e(){0==(1&u)&&(u|=1,t.enableSubstitution(71),d=[])}function Be(t){if(u&p&&!e.isGeneratedIdentifier(t)&&!e.isLocalName(t)){var n=g.getReferencedExportContainer(t,!1);if(n&&265!==n.kind)if(2&p&&233===n.kind||8&p&&232===n.kind)return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(n),t),t)}}function Ue(t){var n=function(t){if(y.isolatedModules)return;return e.isPropertyAccessExpression(t)||e.isElementAccessExpression(t)?g.getConstantValue(t):void 0}(t);if(void 0!==n){e.setConstantValue(t,n);var r=e.createLiteral(n);if(!y.removeComments){var i=e.isPropertyAccessExpression(t)?e.declarationNameToString(t.name):e.getTextOfNode(t.argumentExpression);e.addSyntheticTrailingComment(r,3," "+i+" ")}return r}return t}};var i={name:"typescript:decorate",scoped:!1,priority:2,text:'\n            var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n                var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n                if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);\n                else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n                return c > 3 && r && Object.defineProperty(target, key, r), r;\n            };'};function s(t,n,r){return t.requestEmitHelper(o),e.createCall(e.getHelperName("__metadata"),void 0,[e.createLiteral(n),r])}var o={name:"typescript:metadata",scoped:!1,priority:3,text:'\n            var __metadata = (this && this.__metadata) || function (k, v) {\n                if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);\n            };'};function a(t,n,r,i){return t.requestEmitHelper(l),e.setTextRange(e.createCall(e.getHelperName("__param"),void 0,[e.createLiteral(r),n]),i)}var l={name:"typescript:param",scoped:!1,priority:4,text:"\n            var __param = (this && this.__param) || function (paramIndex, decorator) {\n                return function (target, key) { decorator(target, key, paramIndex); }\n            };"}}(ts||(ts={})),function(e){var t;!function(e){e[e.AsyncMethodsWithSuper=1]="AsyncMethodsWithSuper"}(t||(t={})),e.transformES2017=function(t){var n,i=t.startLexicalEnvironment,s=t.resumeLexicalEnvironment,o=t.endLexicalEnvironment,a=t.getEmitResolver(),l=t.getCompilerOptions(),c=e.getEmitScriptTarget(l),u=0,d=t.onEmitNode,p=t.onSubstituteNode;return t.onEmitNode=function(e,t,r){if(1&n&&function(e){var t=e.kind;return 229===t||152===t||151===t||153===t||154===t}(t)){var i=6144&a.getNodeCheckFlags(t);if(i!==u){var s=u;return u=i,d(e,t,r),void(u=s)}}d(e,t,r)},t.onSubstituteNode=function(t,n){if(n=p(t,n),1===t&&u)return function(t){switch(t.kind){case 179:return g(t);case 180:return y(t);case 181:return function(t){var n=t.expression;if(e.isSuperProperty(n)){var r=e.isPropertyAccessExpression(n)?g(n):y(n);return e.createCall(e.createPropertyAccess(r,"call"),void 0,[e.createThis()].concat(t.arguments))}return t}(t)}return t}(n);return n},function(n){if(n.isDeclarationFile)return n;var r=e.visitEachChild(n,h,t);return e.addEmitHelpers(r,t.readEmitHelpers()),r};function h(n){if(0==(16&n.transformFlags))return n;switch(n.kind){case 120:return;case 191:return function(t){return e.setOriginalNode(e.setTextRange(e.createYield(void 0,e.visitNode(t.expression,h,e.isExpression)),t),t)}(n);case 151:return function(n){return e.updateMethod(n,void 0,e.visitNodes(n.modifiers,h,e.isModifier),n.asteriskToken,n.name,void 0,void 0,e.visitParameterList(n.parameters,h,t),void 0,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);case 228:return function(n){return e.updateFunctionDeclaration(n,void 0,e.visitNodes(n.modifiers,h,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,h,t),void 0,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);case 186:return function(n){return e.updateFunctionExpression(n,e.visitNodes(n.modifiers,h,e.isModifier),n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,h,t),void 0,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);case 187:return function(n){return e.updateArrowFunction(n,e.visitNodes(n.modifiers,h,e.isModifier),void 0,e.visitParameterList(n.parameters,h,t),void 0,n.equalsGreaterThanToken,2&e.getFunctionFlags(n)?f(n):e.visitFunctionBody(n.body,h,t))}(n);default:return e.visitEachChild(n,h,t)}}function f(n){s();var i=e.getOriginalNode(n,e.isFunctionLike).type,l=c<2?function(t){var n=t&&e.getEntityNameFromTypeNode(t);if(n&&e.isEntityName(n)){var r=a.getTypeReferenceSerializationKind(n);if(r===e.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue||r===e.TypeReferenceSerializationKind.Unknown)return n}return}(i):void 0,u=187===n.kind,d=0!=(8192&a.getNodeCheckFlags(n));if(u){var p=r(t,d,l,m(n.body)),f=o();if(e.some(f)){b=e.convertToFunctionBody(p);return e.updateBlock(b,e.setTextRange(e.createNodeArray(e.concatenate(b.statements,f)),b.statements))}return p}var g=[],y=e.addPrologue(g,n.body.statements,!1,h);g.push(e.createReturn(r(t,d,l,m(n.body,y)))),e.addRange(g,o());var b=e.createBlock(g,!0);return e.setTextRange(b,n.body),c>=2&&(4096&a.getNodeCheckFlags(n)?(_(),e.addEmitHelper(b,e.advancedAsyncSuperHelper)):2048&a.getNodeCheckFlags(n)&&(_(),e.addEmitHelper(b,e.asyncSuperHelper))),b}function m(n,r){if(e.isBlock(n))return e.updateBlock(n,e.visitLexicalEnvironment(n.statements,h,t,r));i();var s=e.convertToFunctionBody(e.visitNode(n,h,e.isConciseBody)),a=o();return e.updateBlock(s,e.setTextRange(e.createNodeArray(e.concatenate(s.statements,a)),s.statements))}function _(){0==(1&n)&&(n|=1,t.enableSubstitution(181),t.enableSubstitution(179),t.enableSubstitution(180),t.enableEmitNotification(229),t.enableEmitNotification(151),t.enableEmitNotification(153),t.enableEmitNotification(154),t.enableEmitNotification(152))}function g(t){return 97===t.expression.kind?b(e.createLiteral(e.idText(t.name)),t):t}function y(e){return 97===e.expression.kind?b(e.argumentExpression,e):e}function b(t,n){return 4096&u?e.setTextRange(e.createPropertyAccess(e.createCall(e.createIdentifier("_super"),void 0,[t]),"value"),n):e.setTextRange(e.createCall(e.createIdentifier("_super"),void 0,[t]),n)}};var n={name:"typescript:awaiter",scoped:!1,priority:5,text:'\n            var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n                return new (P || (P = Promise))(function (resolve, reject) {\n                    function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n                    function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\n                    function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n                    step((generator = generator.apply(thisArg, _arguments || [])).next());\n                });\n            };'};function r(t,r,i,s){t.requestEmitHelper(n);var o=e.createFunctionExpression(void 0,e.createToken(39),void 0,void 0,[],void 0,s);return(o.emitNode||(o.emitNode={})).flags|=786432,e.createCall(e.getHelperName("__awaiter"),void 0,[e.createThis(),r?e.createIdentifier("arguments"):e.createVoidZero(),i?e.createExpressionFromEntityName(i):e.createVoidZero(),o])}e.asyncSuperHelper={name:"typescript:async-super",scoped:!0,text:"\n            const _super = name => super[name];\n        "},e.advancedAsyncSuperHelper={name:"typescript:advanced-async-super",scoped:!0,text:"\n            const _super = (function (geti, seti) {\n                const cache = Object.create(null);\n                return name => cache[name] || (cache[name] = { get value() { return geti(name); }, set value(v) { seti(name, v); } });\n            })(name => super[name], (name, value) => super[name] = value);\n        "}}(ts||(ts={})),function(e){var t;!function(e){e[e.AsyncMethodsWithSuper=1]="AsyncMethodsWithSuper"}(t||(t={})),e.transformESNext=function(t){var n=t.resumeLexicalEnvironment,l=t.endLexicalEnvironment,u=t.hoistVariableDeclaration,d=t.getEmitResolver(),p=t.getCompilerOptions(),h=e.getEmitScriptTarget(p),f=t.onEmitNode;t.onEmitNode=function(e,t,n){if(1&m&&function(e){var t=e.kind;return 229===t||152===t||151===t||153===t||154===t}(t)){var r=6144&d.getNodeCheckFlags(t);if(r!==y){var i=y;return y=r,f(e,t,n),void(y=i)}}f(e,t,n)};var m,_,g=t.onSubstituteNode;t.onSubstituteNode=function(t,n){if(n=g(t,n),1===t&&y)return function(t){switch(t.kind){case 179:return w(t);case 180:return N(t);case 181:return function(t){var n=t.expression;if(e.isSuperProperty(n)){var r=e.isPropertyAccessExpression(n)?w(n):N(n);return e.createCall(e.createPropertyAccess(r,"call"),void 0,[e.createThis()].concat(t.arguments))}return t}(t)}return t}(n);return n};var y=0;return function(n){if(n.isDeclarationFile)return n;var r=e.visitEachChild(n,b,t);return e.addEmitHelpers(r,t.readEmitHelpers()),r};function b(e){return k(e,!1)}function v(e){return k(e,!0)}function T(e){if(120!==e.kind)return e}function k(n,o){if(0==(8&n.transformFlags))return n;switch(n.kind){case 191:return function(n){if(2&_&&1&_)return e.setOriginalNode(e.setTextRange(e.createYield(s(t,e.visitNode(n.expression,b,e.isExpression))),n),n);return e.visitEachChild(n,b,t)}(n);case 197:return function(n){if(2&_&&1&_&&n.asteriskToken){var r=e.visitNode(n.expression,b,e.isExpression);return e.setOriginalNode(e.setTextRange(e.createYield(s(t,e.updateYield(n,n.asteriskToken,function(t,n,r){return t.requestEmitHelper(i),t.requestEmitHelper(a),e.setTextRange(e.createCall(e.getHelperName("__asyncDelegator"),void 0,[n]),r)}(t,c(t,r,r),r)))),n),n)}return e.visitEachChild(n,b,t)}(n);case 222:return function(n){if(2&_&&1&_){var r=e.unwrapInnermostStatementOfLabel(n);return 216===r.kind&&r.awaitModifier?E(r,n):e.restoreEnclosingLabel(e.visitEachChild(n,b,t),n)}return e.visitEachChild(n,b,t)}(n);case 178:return function(n){if(1048576&n.transformFlags){var i=function(t){for(var n,r=[],i=0,s=t;i<s.length;i++){var o=s[i];if(263===o.kind){n&&(r.push(e.createObjectLiteral(n)),n=void 0);var a=o.expression;r.push(e.visitNode(a,b,e.isExpression))}else if(n||(n=[]),261===o.kind){var l=o;n.push(e.createPropertyAssignment(l.name,e.visitNode(l.initializer,b,e.isExpression)))}else n.push(e.visitNode(o,b,e.isObjectLiteralElementLike))}n&&r.push(e.createObjectLiteral(n));return r}(n.properties);return i.length&&178!==i[0].kind&&i.unshift(e.createObjectLiteral()),r(t,i)}return e.visitEachChild(n,b,t)}(n);case 194:return function(n,r){if(e.isDestructuringAssignment(n)&&1048576&n.left.transformFlags)return e.flattenDestructuringAssignment(n,b,t,1,!r);if(26===n.operatorToken.kind)return e.updateBinary(n,e.visitNode(n.left,v,e.isExpression),e.visitNode(n.right,r?v:b,e.isExpression));return e.visitEachChild(n,b,t)}(n,o);case 226:return function(n){if(e.isBindingPattern(n.name)&&1048576&n.name.transformFlags)return e.flattenDestructuringBinding(n,b,t,1);return e.visitEachChild(n,b,t)}(n);case 216:return E(n,void 0);case 214:return function(t){return e.updateFor(t,e.visitNode(t.initializer,v,e.isForInitializer),e.visitNode(t.condition,b,e.isExpression),e.visitNode(t.incrementor,b,e.isExpression),e.visitNode(t.statement,b,e.isStatement))}(n);case 190:return function(n){return e.visitEachChild(n,v,t)}(n);case 152:return function(n){var r=_;_=0;var i=e.updateConstructor(n,void 0,n.modifiers,e.visitParameterList(n.parameters,b,t),C(n));return _=r,i}(n);case 151:return function(n){var r=_;_=e.getFunctionFlags(n);var i=e.updateMethod(n,void 0,1&_?e.visitNodes(n.modifiers,T,e.isModifier):n.modifiers,2&_?void 0:n.asteriskToken,e.visitNode(n.name,b,e.isPropertyName),e.visitNode(void 0,b,e.isToken),void 0,e.visitParameterList(n.parameters,b,t),void 0,2&_&&1&_?S(n):C(n));return _=r,i}(n);case 153:return function(n){var r=_;_=0;var i=e.updateGetAccessor(n,void 0,n.modifiers,e.visitNode(n.name,b,e.isPropertyName),e.visitParameterList(n.parameters,b,t),void 0,C(n));return _=r,i}(n);case 154:return function(n){var r=_;_=0;var i=e.updateSetAccessor(n,void 0,n.modifiers,e.visitNode(n.name,b,e.isPropertyName),e.visitParameterList(n.parameters,b,t),C(n));return _=r,i}(n);case 228:return function(n){var r=_;_=e.getFunctionFlags(n);var i=e.updateFunctionDeclaration(n,void 0,1&_?e.visitNodes(n.modifiers,T,e.isModifier):n.modifiers,2&_?void 0:n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,b,t),void 0,2&_&&1&_?S(n):C(n));return _=r,i}(n);case 186:return function(n){var r=_;_=e.getFunctionFlags(n);var i=e.updateFunctionExpression(n,1&_?e.visitNodes(n.modifiers,T,e.isModifier):n.modifiers,2&_?void 0:n.asteriskToken,n.name,void 0,e.visitParameterList(n.parameters,b,t),void 0,2&_&&1&_?S(n):C(n));return _=r,i}(n);case 187:return function(n){var r=_;_=e.getFunctionFlags(n);var i=e.updateArrowFunction(n,n.modifiers,void 0,e.visitParameterList(n.parameters,b,t),void 0,n.equalsGreaterThanToken,C(n));return _=r,i}(n);case 146:return function(n){if(1048576&n.transformFlags)return e.updateParameter(n,void 0,void 0,n.dotDotDotToken,e.getGeneratedNameForNode(n),void 0,void 0,e.visitNode(n.initializer,b,e.isExpression));return e.visitEachChild(n,b,t)}(n);case 210:return function(n){return e.visitEachChild(n,v,t)}(n);case 185:return function(n,r){return e.visitEachChild(n,r?v:b,t)}(n,o);case 260:return function(n){if(!n.variableDeclaration)return e.updateCatchClause(n,e.createVariableDeclaration(e.createTempVariable(void 0)),e.visitNode(n.block,b,e.isBlock));return e.visitEachChild(n,b,t)}(n);default:return e.visitEachChild(n,b,t)}}function E(n,r){return 1048576&n.initializer.transformFlags&&(n=function(t){var n=e.skipParentheses(t.initializer);if(e.isVariableDeclarationList(n)||e.isAssignmentPattern(n)){var r=void 0,i=void 0,s=e.createTempVariable(void 0),o=[e.createForOfBindingStatement(n,s)];return e.isBlock(t.statement)&&(e.addRange(o,t.statement.statements),r=t.statement,i=t.statement.statements),e.updateForOf(t,t.awaitModifier,e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(s),t.initializer)],1),t.initializer),t.expression,e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(o),i),!0),r))}return t}(n)),n.awaitModifier?function(n,r){var i=e.visitNode(n.expression,b,e.isExpression),s=e.isIdentifier(i)?e.getGeneratedNameForNode(i):e.createTempVariable(void 0),o=e.isIdentifier(i)?e.getGeneratedNameForNode(s):e.createTempVariable(void 0),a=e.createUniqueName("e"),l=e.getGeneratedNameForNode(a),d=e.createTempVariable(void 0),p=c(t,i,n.expression),h=e.createCall(e.createPropertyAccess(s,"next"),void 0,[]),f=e.createPropertyAccess(o,"done"),m=e.createPropertyAccess(o,"value"),_=e.createFunctionCall(d,s,[]);u(a),u(d);var g=e.setEmitFlags(e.setTextRange(e.createFor(e.setEmitFlags(e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(s,void 0,p),n.expression),e.createVariableDeclaration(o)]),n.expression),2097152),e.createComma(e.createAssignment(o,x(h)),e.createLogicalNot(f)),void 0,function(t,n){var r,i,s=e.createForOfBindingStatement(t.initializer,n),o=[e.visitNode(s,b,e.isStatement)],a=e.visitNode(t.statement,b,e.isStatement);e.isBlock(a)?(e.addRange(o,a.statements),r=a,i=a.statements):o.push(a);return e.setEmitFlags(e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(o),i),!0),r),432)}(n,x(m))),n),256);return e.createTry(e.createBlock([e.restoreEnclosingLabel(g,r)]),e.createCatchClause(e.createVariableDeclaration(l),e.setEmitFlags(e.createBlock([e.createStatement(e.createAssignment(a,e.createObjectLiteral([e.createPropertyAssignment("error",l)])))]),1)),e.createBlock([e.createTry(e.createBlock([e.setEmitFlags(e.createIf(e.createLogicalAnd(e.createLogicalAnd(o,e.createLogicalNot(f)),e.createAssignment(d,e.createPropertyAccess(s,"return"))),e.createStatement(x(_))),1)]),void 0,e.setEmitFlags(e.createBlock([e.setEmitFlags(e.createIf(a,e.createThrow(e.createPropertyAccess(a,"error"))),1)]),1))]))}(n,r):e.restoreEnclosingLabel(e.visitEachChild(n,b,t),r)}function x(n){return 1&_?e.createYield(void 0,s(t,n)):e.createAwait(n)}function S(r){n();var s=[],a=e.addPrologue(s,r.body.statements,!1,b);I(s,r),s.push(e.createReturn(function(t,n){return t.requestEmitHelper(i),t.requestEmitHelper(o),(n.emitNode||(n.emitNode={})).flags|=262144,e.createCall(e.getHelperName("__asyncGenerator"),void 0,[e.createThis(),e.createIdentifier("arguments"),n])}(t,e.createFunctionExpression(void 0,e.createToken(39),r.name&&e.getGeneratedNameForNode(r.name),void 0,[],void 0,e.updateBlock(r.body,e.visitLexicalEnvironment(r.body.statements,b,t,a)))))),e.addRange(s,l());var c=e.updateBlock(r.body,s);return h>=2&&(4096&d.getNodeCheckFlags(r)?(A(),e.addEmitHelper(c,e.advancedAsyncSuperHelper)):2048&d.getNodeCheckFlags(r)&&(A(),e.addEmitHelper(c,e.asyncSuperHelper))),c}function C(t){n();var r=0,i=[],s=e.visitNode(t.body,b,e.isConciseBody);e.isBlock(s)&&(r=e.addPrologue(i,s.statements,!1,b)),e.addRange(i,I(void 0,t));var o=l();if(r>0||e.some(i)||e.some(o)){var a=e.convertToFunctionBody(s,!0);return e.addRange(i,a.statements.slice(r)),e.addRange(i,o),e.updateBlock(a,e.setTextRange(e.createNodeArray(i),a.statements))}return s}function I(n,r){for(var i=0,s=r.parameters;i<s.length;i++){var o=s[i];if(1048576&o.transformFlags){var a=e.getGeneratedNameForNode(o),l=e.flattenDestructuringBinding(o,b,t,1,a,!1,!0);if(e.some(l)){var c=e.createVariableStatement(void 0,e.createVariableDeclarationList(l));e.setEmitFlags(c,1048576),n=e.append(n,c)}}}return n}function A(){0==(1&m)&&(m|=1,t.enableSubstitution(181),t.enableSubstitution(179),t.enableSubstitution(180),t.enableEmitNotification(229),t.enableEmitNotification(151),t.enableEmitNotification(153),t.enableEmitNotification(154),t.enableEmitNotification(152))}function w(t){return 97===t.expression.kind?D(e.createLiteral(e.idText(t.name)),t):t}function N(e){return 97===e.expression.kind?D(e.argumentExpression,e):e}function D(t,n){return 4096&y?e.setTextRange(e.createPropertyAccess(e.createCall(e.createIdentifier("_super"),void 0,[t]),"value"),n):e.setTextRange(e.createCall(e.createIdentifier("_super"),void 0,[t]),n)}};var n={name:"typescript:assign",scoped:!1,priority:1,text:"\n            var __assign = (this && this.__assign) || Object.assign || function(t) {\n                for (var s, i = 1, n = arguments.length; i < n; i++) {\n                    s = arguments[i];\n                    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                        t[p] = s[p];\n                }\n                return t;\n            };"};function r(t,r){return t.getCompilerOptions().target>=2?e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"assign"),void 0,r):(t.requestEmitHelper(n),e.createCall(e.getHelperName("__assign"),void 0,r))}e.createAssignHelper=r;var i={name:"typescript:await",scoped:!1,text:"\n            var __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\n        "};function s(t,n){return t.requestEmitHelper(i),e.createCall(e.getHelperName("__await"),void 0,[n])}var o={name:"typescript:asyncGenerator",scoped:!1,text:'\n            var __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n                if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");\n                var g = generator.apply(thisArg, _arguments || []), i, q = [];\n                return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;\n                function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n                function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n                function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\n                function fulfill(value) { resume("next", value); }\n                function reject(value) { resume("throw", value); }\n                function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n            };\n        '};var a={name:"typescript:asyncDelegator",scoped:!1,text:'\n            var __asyncDelegator = (this && this.__asyncDelegator) || function (o) {\n                var i, p;\n                return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;\n                function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; }; }\n            };\n        '};var l={name:"typescript:asyncValues",scoped:!1,text:'\n            var __asyncValues = (this && this.__asyncIterator) || function (o) {\n                if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");\n                var m = o[Symbol.asyncIterator];\n                return m ? m.call(o) : typeof __values === "function" ? __values(o) : o[Symbol.iterator]();\n            };\n        '};function c(t,n,r){return t.requestEmitHelper(l),e.setTextRange(e.createCall(e.getHelperName("__asyncValues"),void 0,[n]),r)}}(ts||(ts={})),function(e){e.transformJsx=function(n){var r=n.getCompilerOptions();return function(t){if(t.isDeclarationFile)return t;var r=e.visitEachChild(t,i,n);return e.addEmitHelpers(r,n.readEmitHelpers()),r};function i(t){return 4&t.transformFlags?function(t){switch(t.kind){case 249:return o(t,!1);case 250:return a(t,!1);case 256:return f(t);default:return e.visitEachChild(t,i,n)}}(t):t}function s(t){switch(t.kind){case 10:return function(t){var n=function(t){for(var n,r=0,i=-1,s=0;s<t.length;s++){var o=t.charCodeAt(s);e.isLineBreak(o)?(-1!==r&&-1!==i&&(n=d(n,t.substr(r,i-r+1))),r=-1):e.isWhiteSpaceSingleLine(o)||(i=s,-1===r&&(r=s))}return-1!==r?d(n,t.substr(r)):n}(e.getTextOfNode(t,!0));return void 0===n?void 0:e.createLiteral(n)}(t);case 256:return f(t);case 249:return o(t,!0);case 250:return a(t,!0);default:return void e.Debug.failBadSyntaxKind(t)}}function o(e,t){return l(e.openingElement,e.children,t,e)}function a(e,t){return l(e,void 0,t,e)}function l(t,i,o,a){var l,d=h(t),p=t.attributes.properties;if(0===p.length)l=e.createNull();else{var f=e.flatten(e.spanMap(p,e.isJsxSpreadAttribute,(function(t,n){return n?e.map(t,c):e.createObjectLiteral(e.map(t,u))})));e.isJsxSpreadAttribute(p[0])&&f.unshift(e.createObjectLiteral()),(l=e.singleOrUndefined(f))||(l=e.createAssignHelper(n,f))}var m=e.createExpressionForJsxElement(n.getEmitResolver().getJsxFactoryEntity(),r.reactNamespace,d,l,e.mapDefined(i,s),t,a);return o&&e.startOnNewLine(m),m}function c(t){return e.visitNode(t.expression,i,e.isExpression)}function u(t){var n=function(t){var n=t.name,r=e.idText(n);return/^[A-Za-z_]\w*$/.test(r)?n:e.createLiteral(r)}(t),r=function(t){if(void 0===t)return e.createTrue();if(9===t.kind){var n=function(e){var t=p(e);return t===e?void 0:t}(t.text);return n?e.setTextRange(e.createLiteral(n),t):t}if(256===t.kind)return void 0===t.expression?e.createTrue():f(t);e.Debug.failBadSyntaxKind(t)}(t.initializer);return e.createPropertyAssignment(n,r)}function d(e,t){var n=p(t);return void 0===e?n:e+" "+n}function p(e){return e.replace(/&((#((\d+)|x([\da-fA-F]+)))|(\w+));/g,(function(e,n,r,i,s,o,a){if(s)return String.fromCharCode(parseInt(s,10));if(o)return String.fromCharCode(parseInt(o,16));var l=t.get(a);return l?String.fromCharCode(l):e}))}function h(t){if(249===t.kind)return h(t.openingElement);var n=t.tagName;return e.isIdentifier(n)&&e.isIntrinsicJsxName(n.escapedText)?e.createLiteral(e.idText(n)):e.createExpressionFromEntityName(n)}function f(t){return e.visitNode(t.expression,i,e.isExpression)}};var t=e.createMapFromTemplate({quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830})}(ts||(ts={})),function(e){e.transformES2016=function(t){var n=t.hoistVariableDeclaration;return function(n){if(n.isDeclarationFile)return n;return e.visitEachChild(n,r,t)};function r(i){if(0==(32&i.transformFlags))return i;switch(i.kind){case 194:return function(i){switch(i.operatorToken.kind){case 62:return function(t){var i,s,o=e.visitNode(t.left,r,e.isExpression),a=e.visitNode(t.right,r,e.isExpression);if(e.isElementAccessExpression(o)){var l=e.createTempVariable(n),c=e.createTempVariable(n);i=e.setTextRange(e.createElementAccess(e.setTextRange(e.createAssignment(l,o.expression),o.expression),e.setTextRange(e.createAssignment(c,o.argumentExpression),o.argumentExpression)),o),s=e.setTextRange(e.createElementAccess(l,c),o)}else if(e.isPropertyAccessExpression(o)){l=e.createTempVariable(n);i=e.setTextRange(e.createPropertyAccess(e.setTextRange(e.createAssignment(l,o.expression),o.expression),o.name),o),s=e.setTextRange(e.createPropertyAccess(l,o.name),o)}else i=o,s=o;return e.setTextRange(e.createAssignment(i,e.createMathPow(s,a,t)),t)}(i);case 40:return function(t){var n=e.visitNode(t.left,r,e.isExpression),i=e.visitNode(t.right,r,e.isExpression);return e.createMathPow(n,i,t)}(i);default:return e.visitEachChild(i,r,t)}}(i);default:return e.visitEachChild(i,r,t)}}}}(ts||(ts={})),function(e){var t,n,r,i,s;!function(e){e[e.CapturedThis=1]="CapturedThis",e[e.BlockScopedBindings=2]="BlockScopedBindings"}(t||(t={})),function(e){e[e.ToOriginal=0]="ToOriginal",e[e.ToOutParameter=1]="ToOutParameter"}(n||(n={})),function(e){e[e.Break=2]="Break",e[e.Continue=4]="Continue",e[e.Return=8]="Return"}(r||(r={})),function(e){e[e.NoReplacement=0]="NoReplacement",e[e.ReplaceSuperCapture=1]="ReplaceSuperCapture",e[e.ReplaceWithReturn=2]="ReplaceWithReturn"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Function=1]="Function",e[e.ArrowFunction=2]="ArrowFunction",e[e.AsyncFunctionBody=4]="AsyncFunctionBody",e[e.NonStaticClassElement=8]="NonStaticClassElement",e[e.CapturesThis=16]="CapturesThis",e[e.ExportedVariableStatement=32]="ExportedVariableStatement",e[e.TopLevel=64]="TopLevel",e[e.Block=128]="Block",e[e.IterationStatement=256]="IterationStatement",e[e.IterationStatementBlock=512]="IterationStatementBlock",e[e.ForStatement=1024]="ForStatement",e[e.ForInOrForOfStatement=2048]="ForInOrForOfStatement",e[e.ConstructorWithCapturedSuper=4096]="ConstructorWithCapturedSuper",e[e.ComputedPropertyName=8192]="ComputedPropertyName",e[e.AncestorFactsMask=16383]="AncestorFactsMask",e[e.BlockScopeIncludes=0]="BlockScopeIncludes",e[e.BlockScopeExcludes=4032]="BlockScopeExcludes",e[e.SourceFileIncludes=64]="SourceFileIncludes",e[e.SourceFileExcludes=3968]="SourceFileExcludes",e[e.FunctionIncludes=65]="FunctionIncludes",e[e.FunctionExcludes=16286]="FunctionExcludes",e[e.AsyncFunctionBodyIncludes=69]="AsyncFunctionBodyIncludes",e[e.AsyncFunctionBodyExcludes=16278]="AsyncFunctionBodyExcludes",e[e.ArrowFunctionIncludes=66]="ArrowFunctionIncludes",e[e.ArrowFunctionExcludes=16256]="ArrowFunctionExcludes",e[e.ConstructorIncludes=73]="ConstructorIncludes",e[e.ConstructorExcludes=16278]="ConstructorExcludes",e[e.DoOrWhileStatementIncludes=256]="DoOrWhileStatementIncludes",e[e.DoOrWhileStatementExcludes=0]="DoOrWhileStatementExcludes",e[e.ForStatementIncludes=1280]="ForStatementIncludes",e[e.ForStatementExcludes=3008]="ForStatementExcludes",e[e.ForInOrForOfStatementIncludes=2304]="ForInOrForOfStatementIncludes",e[e.ForInOrForOfStatementExcludes=1984]="ForInOrForOfStatementExcludes",e[e.BlockIncludes=128]="BlockIncludes",e[e.BlockExcludes=3904]="BlockExcludes",e[e.IterationStatementBlockIncludes=512]="IterationStatementBlockIncludes",e[e.IterationStatementBlockExcludes=4032]="IterationStatementBlockExcludes",e[e.ComputedPropertyNameIncludes=8192]="ComputedPropertyNameIncludes",e[e.ComputedPropertyNameExcludes=0]="ComputedPropertyNameExcludes",e[e.NewTarget=16384]="NewTarget",e[e.NewTargetInComputedPropertyName=32768]="NewTargetInComputedPropertyName",e[e.SubtreeFactsMask=-16384]="SubtreeFactsMask",e[e.PropagateNewTargetMask=49152]="PropagateNewTargetMask"}(s||(s={})),e.transformES2015=function(t){var n,r,i,s,l,c,u=t.startLexicalEnvironment,d=t.resumeLexicalEnvironment,p=t.endLexicalEnvironment,h=t.hoistVariableDeclaration,f=t.getCompilerOptions(),m=t.getEmitResolver(),_=t.onSubstituteNode,g=t.onEmitNode;return t.onEmitNode=function(t,n,r){if(1&c&&e.isFunctionLike(n)){var i=y(16286,8&e.getEmitFlags(n)?81:65);return g(t,n,r),void b(i,0,0)}g(t,n,r)},t.onSubstituteNode=function(t,n){if(n=_(t,n),1===t)return function(t){switch(t.kind){case 71:return function(t){if(2&c&&!e.isInternalName(t)){var n=m.getReferencedDeclarationWithCollidingName(t);if(n&&(!e.isClassLike(n)||!function(t,n){var r=e.getParseTreeNode(n);if(!r||r===t||r.end<=t.pos||r.pos>=t.end)return!1;var i=e.getEnclosingBlockScopeContainer(t);for(;r;){if(r===i||r===t)return!1;if(e.isClassElement(r)&&r.parent===t)return!0;r=r.parent}return!1}(n,t)))return e.setTextRange(e.getGeneratedNameForNode(e.getNameOfDeclaration(n)),t)}return t}(t);case 99:return function(t){if(1&c&&16&i)return e.setTextRange(e.createIdentifier("_this"),t);return t}(t)}return t}(n);if(e.isIdentifier(n))return function(t){if(2&c&&!e.isInternalName(t)){var n=e.getParseTreeNode(t,e.isIdentifier);if(n&&function(e){var t=e.parent;switch(t.kind){case 176:case 229:case 232:case 226:return t.name===e&&m.isDeclarationWithCollidingName(t)}return!1}(n))return e.setTextRange(e.getGeneratedNameForNode(n),t)}return t}(n);return n},function(o){if(o.isDeclarationFile)return o;n=o,r=o.text;var a=function(t){var n=y(3968,64),r=[];u();var i=e.addStandardPrologue(r,t.statements,!1);L(r,t),i=e.addCustomPrologue(r,t.statements,i,k),e.addRange(r,e.visitNodes(t.statements,k,e.isStatement,i)),s&&r.push(e.createVariableStatement(void 0,e.createVariableDeclarationList(s)));return e.addRange(r,p()),b(n,0,0),e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray(r),t.statements))}(o);return e.addEmitHelpers(a,t.readEmitHelpers()),n=void 0,r=void 0,s=void 0,i=0,a};function y(e,t){var n=i;return i=16383&(i&~e|t),n}function b(e,t,n){i=-16384&(i&~t|n)|e}function v(e){return 4096&i&&219===e.kind&&!e.expression}function T(t){return 0!=(128&t.transformFlags)||void 0!==l||4096&i&&(e.isStatement(t)||207===t.kind)||e.isIterationStatement(t,!1)&&se(t)||0!=(33554432&e.getEmitFlags(t))}function k(r){return T(r)?function(r){switch(r.kind){case 115:return;case 229:return function(t){var n=e.createVariableDeclaration(e.getLocalName(t,!0),void 0,C(t));e.setOriginalNode(n,t);var r=[],i=e.createVariableStatement(void 0,e.createVariableDeclarationList([n]));if(e.setOriginalNode(i,t),e.setTextRange(i,t),e.startOnNewLine(i),r.push(i),e.hasModifier(t,1)){var s=e.hasModifier(t,512)?e.createExportDefault(e.getLocalName(t)):e.createExternalModuleExport(e.getLocalName(t));e.setOriginalNode(s,i),r.push(s)}var o=e.getEmitFlags(t);0==(4194304&o)&&(r.push(e.createEndOfDeclarationMarker(t)),e.setEmitFlags(i,4194304|o));return e.singleOrMany(r)}(r);case 199:return function(e){return C(e)}(r);case 146:return function(t){return t.dotDotDotToken?void 0:e.isBindingPattern(t.name)?e.setOriginalNode(e.setTextRange(e.createParameter(void 0,void 0,void 0,e.getGeneratedNameForNode(t),void 0,void 0,void 0),t),t):t.initializer?e.setOriginalNode(e.setTextRange(e.createParameter(void 0,void 0,void 0,t.name,void 0,void 0,void 0),t),t):t}(r);case 228:return function(n){var r=l;l=void 0;var s=y(16286,65),o=e.visitParameterList(n.parameters,k,t),a=64&n.transformFlags?H(n):G(n),c=16384&i?e.getLocalName(n):n.name;return b(s,49152,0),l=r,e.updateFunctionDeclaration(n,void 0,e.visitNodes(n.modifiers,k,e.isModifier),n.asteriskToken,c,void 0,o,void 0,a)}(r);case 187:return function(n){16384&n.transformFlags&&xe();var r=l;l=void 0;var i=y(16256,66),s=e.createFunctionExpression(void 0,void 0,void 0,void 0,e.visitParameterList(n.parameters,k,t),void 0,H(n));return e.setTextRange(s,n),e.setOriginalNode(s,n),e.setEmitFlags(s,8),b(i,0,0),l=r,s}(r);case 186:return function(n){var r=262144&e.getEmitFlags(n)?y(16278,69):y(16286,65),s=l;l=void 0;var o=e.visitParameterList(n.parameters,k,t),a=64&n.transformFlags?H(n):G(n),c=16384&i?e.getLocalName(n):n.name;return b(r,49152,0),l=s,e.updateFunctionExpression(n,void 0,n.asteriskToken,c,void 0,o,void 0,a)}(r);case 226:return q(r);case 71:return function(t){if(!l)return t;if(e.isGeneratedIdentifier(t))return t;if("arguments"!==t.escapedText||!m.isArgumentsLocalBinding(t))return t;return l.argumentsName||(l.argumentsName=e.createUniqueName("arguments"))}(r);case 227:return function(n){if(64&n.transformFlags){3&n.flags&&Ee();var r=e.flatMap(n.declarations,1&n.flags?z:q),i=e.createVariableDeclarationList(r);if(e.setOriginalNode(i,n),e.setTextRange(i,n),e.setCommentRange(i,n),8388608&n.transformFlags&&(e.isBindingPattern(n.declarations[0].name)||e.isBindingPattern(e.lastOrUndefined(n.declarations).name))){var s=e.firstOrUndefined(r);if(s){var o=e.lastOrUndefined(r);e.setSourceMapRange(i,e.createRange(s.pos,o.end))}}return i}return e.visitEachChild(n,k,t)}(r);case 221:return function(n){if(void 0!==l){var r=l.allowedNonLabeledJumps;l.allowedNonLabeledJumps|=2;var i=e.visitEachChild(n,k,t);return l.allowedNonLabeledJumps=r,i}return e.visitEachChild(n,k,t)}(r);case 235:return function(n){var r=y(4032,0),i=e.visitEachChild(n,k,t);return b(r,0,0),i}(r);case 207:return j(r,!1);case 218:case 217:return function(n){if(l){var r=218===n.kind?2:4;if(!(n.label&&l.labels&&l.labels.get(e.idText(n.label))||!n.label&&l.allowedNonLabeledJumps&r)){var i=void 0;n.label?218===n.kind?(i="break-"+n.label.escapedText,ce(l,!0,e.idText(n.label),i)):(i="continue-"+n.label.escapedText,ce(l,!1,e.idText(n.label),i)):218===n.kind?(l.nonLocalJumps|=2,i="break"):(l.nonLocalJumps|=4,i="continue");var s=e.createLiteral(i);if(l.loopOutParameters.length){for(var o=l.loopOutParameters,a=void 0,c=0;c<o.length;c++){var u=ae(o[c],1);a=0===c?u:e.createBinary(a,26,u)}s=e.createBinary(a,26,s)}return e.createReturn(s)}}return e.visitEachChild(n,k,t)}(r);case 222:return function(t){l&&!l.labels&&(l.labels=e.createMap());var n=e.unwrapInnermostStatementOfLabel(t,l&&J);return e.isIterationStatement(n,!1)?function(e,t){switch(e.kind){case 212:case 213:return Q(e,t);case 214:return Z(e,t);case 215:return ee(e,t);case 216:return te(e,t)}}(n,t):e.restoreEnclosingLabel(e.visitNode(n,k,e.isStatement),t,l&&Y)}(r);case 212:case 213:return Q(r,void 0);case 214:return Z(r,void 0);case 215:return ee(r,void 0);case 216:return te(r,void 0);case 210:return function(n){switch(n.expression.kind){case 185:return e.updateStatement(n,K(n.expression,!1));case 194:return e.updateStatement(n,W(n.expression,!1))}return e.visitEachChild(n,k,t)}(r);case 178:return function(n){for(var r=n.properties,s=r.length,o=s,a=s,l=0;l<s;l++){var c=r[l];if(16777216&c.transformFlags&&4&i&&l<a&&(a=l),144===c.name.kind){o=l;break}}if(o!==s){a<o&&(o=a);var u=e.createTempVariable(h),d=[],p=e.createAssignment(u,e.setEmitFlags(e.createObjectLiteral(e.visitNodes(r,k,e.isObjectLiteralElementLike,0,o),n.multiLine),65536));return n.multiLine&&(p.startsOnNewLine=!0),d.push(p),function(t,n,r,i){for(var s=n.properties,o=s.length,a=i;a<o;a++){var l=s[a];switch(l.kind){case 153:case 154:var c=e.getAllAccessorDeclarations(n.properties,l);l===c.firstAccessor&&t.push(U(r,c,n,n.multiLine));break;case 151:t.push(fe(l,r,n,n.multiLine));break;case 261:t.push(pe(l,r,n.multiLine));break;case 262:t.push(he(l,r,n.multiLine));break;default:e.Debug.failBadSyntaxKind(n)}}}(d,n,u,o),d.push(n.multiLine?e.startOnNewLine(e.getMutableClone(u)):u),e.inlineExpressions(d)}return e.visitEachChild(n,k,t)}(r);case 260:return function(n){var r,i=y(4032,0);if(e.Debug.assert(!!n.variableDeclaration,"Catch clause variable should always be present when downleveling ES2015."),e.isBindingPattern(n.variableDeclaration.name)){var s=e.createTempVariable(void 0),o=e.createVariableDeclaration(s);e.setTextRange(o,n.variableDeclaration);var a=e.flattenDestructuringBinding(n.variableDeclaration,k,t,0,s),l=e.createVariableDeclarationList(a);e.setTextRange(l,n.variableDeclaration);var c=e.createVariableStatement(void 0,l);r=e.updateCatchClause(n,o,(u=n.block,d=c,p=e.visitNodes(u.statements,k,e.isStatement),e.updateBlock(u,[d].concat(p))))}else r=e.visitEachChild(n,k,t);var u,d,p;return b(i,0,0),r}(r);case 262:return function(t){return e.setTextRange(e.createPropertyAssignment(t.name,e.getSynthesizedClone(t.name)),t)}(r);case 144:return function(n){var r=y(0,8192),s=e.visitEachChild(n,k,t);return b(r,49152,49152&i?32768:0),s}(r);case 177:return function(n){if(64&n.transformFlags)return _e(n.elements,!0,n.multiLine,n.elements.hasTrailingComma);return e.visitEachChild(n,k,t)}(r);case 181:return function(t){if(33554432&e.getEmitFlags(t))return function(t){var n=e.cast(e.cast(e.skipOuterExpressions(t.expression),e.isArrowFunction).body,e.isBlock),r=e.visitNodes(n.statements,k,e.isStatement,0,1),i=e.visitNodes(n.statements,k,e.isStatement,1,n.statements.length-1),s=e.cast(e.firstOrUndefined(r),e.isVariableStatement).declarationList.declarations[0],o=e.skipOuterExpressions(s.initializer),a=e.tryCast(o,e.isAssignmentExpression),l=e.cast(a?e.skipOuterExpressions(a.right):o,e.isCallExpression),c=e.cast(e.skipOuterExpressions(l.expression),e.isFunctionExpression),u=c.body.statements,d=0,p=-1,h=[];if(a){var f=e.tryCast(u[d],e.isExpressionStatement);f&&(h.push(f),d++),h.push(u[d]),d++,h.push(e.createStatement(e.createAssignment(a.left,e.cast(s.name,e.isIdentifier))))}for(;!e.isReturnStatement(e.elementAt(u,p));)p--;e.addRange(h,u,d,p),p<-1&&e.addRange(h,u,p+1);return e.addRange(h,i),e.addRange(h,r,1),e.recreateOuterExpressions(t.expression,e.recreateOuterExpressions(s.initializer,e.recreateOuterExpressions(a&&a.right,e.updateCall(l,e.recreateOuterExpressions(l.expression,e.updateFunctionExpression(c,void 0,void 0,void 0,void 0,c.parameters,void 0,e.updateBlock(c.body,h))),void 0,l.arguments))))}(t);if(64&t.transformFlags)return me(t,!0);return e.updateCall(t,e.visitNode(t.expression,x,e.isExpression),void 0,e.visitNodes(t.arguments,k,e.isExpression))}(r);case 182:return function(n){if(524288&n.transformFlags){var r=e.createCallBinding(e.createPropertyAccess(n.expression,"bind"),h),i=r.target,s=r.thisArg;return e.createNew(e.createFunctionApply(e.visitNode(i,k,e.isExpression),s,_e(e.createNodeArray([e.createVoidZero()].concat(n.arguments)),!1,!1,!1)),void 0,[])}return e.visitEachChild(n,k,t)}(r);case 185:return K(r,!0);case 194:return W(r,!0);case 13:case 14:case 15:case 16:return function(t){return e.setTextRange(e.createLiteral(t.text),t)}(r);case 9:return function(t){if(t.hasExtendedUnicodeEscape)return e.setTextRange(e.createLiteral(t.text),t);return t}(r);case 8:return function(t){if(48&t.numericLiteralFlags)return e.setTextRange(e.createNumericLiteral(t.text),t);return t}(r);case 183:return function(r){var i=e.visitNode(r.tag,k,e.isExpression),o=[void 0],l=[],c=[],u=r.template;if(e.isNoSubstitutionTemplateLiteral(u))l.push(e.createLiteral(u.text)),c.push(Te(u));else{l.push(e.createLiteral(u.head.text)),c.push(Te(u.head));for(var d=0,p=u.templateSpans;d<p.length;d++){var h=p[d];l.push(e.createLiteral(h.literal.text)),c.push(Te(h.literal)),o.push(e.visitNode(h.expression,k,e.isExpression))}}var f=function(t,n,r){return t.requestEmitHelper(a),e.createCall(e.getHelperName("__makeTemplateObject"),void 0,[n,r])}(t,e.createArrayLiteral(l),e.createArrayLiteral(c));if(e.isExternalModule(n)){var m=e.createUniqueName("templateObject");_=m,s=e.append(s,e.createVariableDeclaration(_)),o[0]=e.createLogicalOr(m,e.createAssignment(m,f))}else o[0]=f;var _;return e.createCall(i,void 0,o)}(r);case 196:return function(t){var n=[];(function(t,n){if(!function(t){return e.Debug.assert(0!==t.templateSpans.length),0!==t.head.text.length||0===t.templateSpans[0].literal.text.length}(n))return;t.push(e.createLiteral(n.head.text))})(n,t),function(t,n){for(var r=0,i=n.templateSpans;r<i.length;r++){var s=i[r];t.push(e.visitNode(s.expression,k,e.isExpression)),0!==s.literal.text.length&&t.push(e.createLiteral(s.literal.text))}}(n,t);var r=e.reduceLeft(n,e.createAdd);e.nodeIsSynthesized(r)&&(r.pos=t.pos,r.end=t.end);return r}(r);case 197:return function(n){return e.visitEachChild(n,k,t)}(r);case 198:return function(t){return e.visitNode(t.expression,k,e.isExpression)}(r);case 97:return ke(!1);case 99:return function(t){if(l)return 2&i?(l.containsLexicalThis=!0,t):l.thisName||(l.thisName=e.createUniqueName("this"));return t}(r);case 204:return function(t){if(94===t.keywordToken&&"target"===t.name.escapedText)return i|=8192&i?32768:16384,e.createIdentifier("_newTarget");return t}(r);case 151:return function(t){e.Debug.assert(!e.isComputedPropertyName(t.name));var n=V(t,e.moveRangePos(t,-1),void 0,void 0);return e.setEmitFlags(n,512|e.getEmitFlags(n)),e.setTextRange(e.createPropertyAssignment(t.name,n),t)}(r);case 153:case 154:return function(n){e.Debug.assert(!e.isComputedPropertyName(n.name));var r=l;l=void 0;var i,s=y(16286,65);if(32768&n.transformFlags){var o=e.visitParameterList(n.parameters,k,t),a=H(n);i=153===n.kind?e.updateGetAccessor(n,n.decorators,n.modifiers,n.name,o,n.type,a):e.updateSetAccessor(n,n.decorators,n.modifiers,n.name,o,a)}else i=e.visitEachChild(n,k,t);return b(s,49152,0),l=r,i}(r);case 208:return function(n){var r,i=y(0,e.hasModifier(n,1)?32:0);if(l&&0==(3&n.declarationList.flags)){for(var s=void 0,o=0,a=n.declarationList.declarations;o<a.length;o++){var c=a[o];if(oe(l,c),c.initializer){var u=void 0;e.isBindingPattern(c.name)?u=e.flattenDestructuringAssignment(c,k,t,0):(u=e.createBinary(c.name,58,e.visitNode(c.initializer,k,e.isExpression)),e.setTextRange(u,c)),s=e.append(s,u)}}r=s?e.setTextRange(e.createStatement(e.inlineExpressions(s)),n):void 0}else r=e.visitEachChild(n,k,t);return b(i,0,0),r}(r);case 219:return function(n){if(l)return l.nonLocalJumps|=8,v(n)&&(n=S(n)),e.createReturn(e.createObjectLiteral([e.createPropertyAssignment(e.createIdentifier("value"),n.expression?e.visitNode(n.expression,k,e.isExpression):e.createVoidZero())]));if(v(n))return S(n);return e.visitEachChild(n,k,t)}(r);default:return e.visitEachChild(r,k,t)}}(r):r}function E(e){return T(e)?j(e,!0):e}function x(e){return 97===e.kind?ke(!0):k(e)}function S(t){return e.setOriginalNode(e.createReturn(e.createIdentifier("_this")),t)}function C(n){n.name&&Ee();var s=e.getClassExtendsHeritageClauseElement(n),a=e.createFunctionExpression(void 0,void 0,void 0,void 0,s?[e.createParameter(void 0,void 0,void 0,"_super")]:[],void 0,function(n,s){var a=[];u(),function(n,r,i){i&&n.push(e.setTextRange(e.createStatement(function(t,n){return t.requestEmitHelper(o),e.createCall(e.getHelperName("__extends"),void 0,[n,e.createIdentifier("_super")])}(t,e.getLocalName(r))),i))}(a,n,s),function(n,r,s){var o=l;l=void 0;var a=y(16278,73),c=e.getFirstConstructorWithBody(r),u=function(t,n){if(!t||!n)return!1;if(e.some(t.parameters))return!1;var r=e.firstOrUndefined(t.body.statements);if(!r||!e.nodeIsSynthesized(r)||210!==r.kind)return!1;var i=r.expression;if(!e.nodeIsSynthesized(i)||181!==i.kind)return!1;var s=i.expression;if(!e.nodeIsSynthesized(s)||97!==s.kind)return!1;var o=e.singleOrUndefined(i.arguments);if(!o||!e.nodeIsSynthesized(o)||198!==o.kind)return!1;var a=o.expression;return e.isIdentifier(a)&&"arguments"===a.escapedText}(c,void 0!==s),h=e.createFunctionDeclaration(void 0,void 0,void 0,e.getInternalName(r),void 0,function(n,r){return e.visitParameterList(n&&!r&&n.parameters,k,t)||[]}(c,u),void 0,function(t,n,r,s){var o=[];d();var a=-1;s?a=0:t&&(a=e.addStandardPrologue(o,t.body.statements,!1));t&&(N(o,t),R(o,t,s),s||(a=e.addCustomPrologue(o,t.body.statements,a,k)),e.Debug.assert(a>=0,"statementOffset not initialized correctly!"));var l=r&&95!==e.skipOuterExpressions(r.expression).kind,c=function(t,n,r,i,s){if(!r)return n&&L(t,n),0;if(!n)return t.push(e.createReturn(w())),2;if(i)return P(t,n,w()),xe(),1;var o,a,l=n.body.statements;s<l.length&&210===(o=l[s]).kind&&e.isSuperCall(o.expression)&&(a=function(e){return me(e,!1)}(o.expression));if(a&&s===l.length-1&&!(49152&n.transformFlags)){var c=e.createReturn(a);return 194===a.kind&&181===a.left.kind||e.Debug.fail("Assumed generated super call would have form 'super.call(...) || this'."),e.setCommentRange(c,e.getCommentRange(e.setEmitFlags(a.left,1536))),t.push(c),2}if(P(t,n,a||A(),o),a)return 1;return 0}(o,t,l,s,a);1!==c&&2!==c||a++;t&&(1===c&&(i|=4096),e.addRange(o,e.visitNodes(t.body.statements,k,e.isStatement,a)));!l||2===c||t&&I(t.body)||o.push(e.createReturn(e.createIdentifier("_this")));e.addRange(o,p()),t&&M(o,t,!1);var u=e.createBlock(e.setTextRange(e.createNodeArray(o),t?t.body.statements:n.members),!0);e.setTextRange(u,t?t.body:n),t||e.setEmitFlags(u,1536);return u}(c,r,s,u));e.setTextRange(h,c||r),s&&e.setEmitFlags(h,8);n.push(h),b(a,49152,0),l=o}(a,n,s),function(t,n){for(var r=0,i=n.members;r<i.length;r++){var s=i[r];switch(s.kind){case 206:t.push(F(s));break;case 151:t.push($(Se(n,s),s,n));break;case 153:case 154:var o=e.getAllAccessorDeclarations(n.members,s);s===o.firstAccessor&&t.push(B(Se(n,s),o,n));break;case 152:break;default:e.Debug.failBadSyntaxKind(n)}}}(a,n);var c=e.createTokenRange(e.skipTrivia(r,n.members.end),18),h=e.getInternalName(n),f=e.createPartiallyEmittedExpression(h);f.end=c.end,e.setEmitFlags(f,1536);var m=e.createReturn(f);m.pos=c.pos,e.setEmitFlags(m,1920),a.push(m),e.addRange(a,p());var _=e.createBlock(e.setTextRange(e.createNodeArray(a),n.members),!0);return e.setEmitFlags(_,1536),_}(n,s));65536&e.getEmitFlags(n)&&e.setEmitFlags(a,65536);var c=e.createPartiallyEmittedExpression(a);c.end=n.end,e.setEmitFlags(c,1536);var h=e.createPartiallyEmittedExpression(c);h.end=e.skipTrivia(r,n.pos),e.setEmitFlags(h,1536);var f=e.createParen(e.createCall(h,void 0,s?[e.visitNode(s.expression,k,e.isExpression)]:[]));return e.addSyntheticLeadingComment(f,3,"* @class "),f}function I(t){if(219===t.kind)return!0;if(211===t.kind){var n=t;if(n.elseStatement)return I(n.thenStatement)&&I(n.elseStatement)}else if(207===t.kind){var r=e.lastOrUndefined(t.statements);if(r&&I(r))return!0}return!1}function A(){return e.setEmitFlags(e.createThis(),4)}function w(){return e.createLogicalOr(e.createLogicalAnd(e.createStrictInequality(e.createIdentifier("_super"),e.createNull()),e.createFunctionApply(e.createIdentifier("_super"),A(),e.createIdentifier("arguments"))),A())}function N(t,n){if(function(e){return 0!=(131072&e.transformFlags)}(n))for(var r=0,i=n.parameters;r<i.length;r++){var s=i[r],o=s.name,a=s.initializer;s.dotDotDotToken||(e.isBindingPattern(o)?D(t,s,o,a):a&&O(t,s,o,a))}}function D(n,r,i,s){var o=e.getGeneratedNameForNode(r);i.elements.length>0?n.push(e.setEmitFlags(e.createVariableStatement(void 0,e.createVariableDeclarationList(e.flattenDestructuringBinding(r,k,t,0,o))),1048576)):s&&n.push(e.setEmitFlags(e.createStatement(e.createAssignment(o,e.visitNode(s,k,e.isExpression))),1048576))}function O(t,n,r,i){i=e.visitNode(i,k,e.isExpression);var s=e.createIf(e.createTypeCheck(e.getSynthesizedClone(r),"undefined"),e.setEmitFlags(e.setTextRange(e.createBlock([e.createStatement(e.setTextRange(e.createAssignment(e.setEmitFlags(e.getMutableClone(r),48),e.setEmitFlags(i,48|e.getEmitFlags(i))),n))]),n),417));s.startsOnNewLine=!0,e.setTextRange(s,n),e.setEmitFlags(s,1048992),t.push(s)}function R(t,n,r){var i=e.lastOrUndefined(n.parameters);if(function(e,t){return e&&e.dotDotDotToken&&71===e.name.kind&&!t}(i,r)){var s=e.getMutableClone(i.name);e.setEmitFlags(s,48);var o=e.getSynthesizedClone(i.name),a=n.parameters.length-1,l=e.createLoopVariable();t.push(e.setEmitFlags(e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(s,void 0,e.createArrayLiteral([]))])),i),1048576));var c=e.createFor(e.setTextRange(e.createVariableDeclarationList([e.createVariableDeclaration(l,void 0,e.createLiteral(a))]),i),e.setTextRange(e.createLessThan(l,e.createPropertyAccess(e.createIdentifier("arguments"),"length")),i),e.setTextRange(e.createPostfixIncrement(l),i),e.createBlock([e.startOnNewLine(e.setTextRange(e.createStatement(e.createAssignment(e.createElementAccess(o,0===a?l:e.createSubtract(l,e.createLiteral(a))),e.createElementAccess(e.createIdentifier("arguments"),l))),i))]));e.setEmitFlags(c,1048576),e.startOnNewLine(c),t.push(c)}}function L(t,n){32768&n.transformFlags&&187!==n.kind&&P(t,n,e.createThis())}function P(t,n,r,i){xe();var s=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration("_this",void 0,r)]));e.setEmitFlags(s,1050112),e.setTextRange(s,i),e.setSourceMapRange(s,n),t.push(s)}function M(t,n,r){if(16384&i){var s=void 0;switch(n.kind){case 187:return t;case 151:case 153:case 154:s=e.createVoidZero();break;case 152:s=e.createPropertyAccess(e.setEmitFlags(e.createThis(),4),"constructor");break;case 228:case 186:s=e.createConditional(e.createLogicalAnd(e.setEmitFlags(e.createThis(),4),e.createBinary(e.setEmitFlags(e.createThis(),4),93,e.getLocalName(n))),e.createPropertyAccess(e.setEmitFlags(e.createThis(),4),"constructor"),e.createVoidZero());break;default:e.Debug.failBadSyntaxKind(n)}var o=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration("_newTarget",void 0,s)]));if(r)return[o].concat(t);t.unshift(o)}return t}function F(t){return e.setTextRange(e.createEmptyStatement(),t)}function $(t,n,r){var s=y(0,0),o=e.getCommentRange(n),a=e.getSourceMapRange(n),l=e.createMemberAccessForPropertyName(t,e.visitNode(n.name,k,e.isPropertyName),n.name),c=V(n,n,void 0,r);e.setEmitFlags(c,1536),e.setSourceMapRange(c,a);var u=e.setTextRange(e.createStatement(e.createAssignment(l,c)),n);return e.setOriginalNode(u,n),e.setCommentRange(u,o),e.setEmitFlags(u,48),b(s,49152,49152&i?16384:0),u}function B(t,n,r){var i=e.createStatement(U(t,n,r,!1));return e.setEmitFlags(i,1536),e.setSourceMapRange(i,e.getSourceMapRange(n.firstAccessor)),i}function U(t,n,r,s){var o=n.firstAccessor,a=n.getAccessor,l=n.setAccessor,c=y(0,0),u=e.getMutableClone(t);e.setEmitFlags(u,1568),e.setSourceMapRange(u,o.name);var d=e.createExpressionForPropertyName(e.visitNode(o.name,k,e.isPropertyName));e.setEmitFlags(d,1552),e.setSourceMapRange(d,o.name);var p=[];if(a){var h=V(a,void 0,void 0,r);e.setSourceMapRange(h,e.getSourceMapRange(a)),e.setEmitFlags(h,512);var f=e.createPropertyAssignment("get",h);e.setCommentRange(f,e.getCommentRange(a)),p.push(f)}if(l){var m=V(l,void 0,void 0,r);e.setSourceMapRange(m,e.getSourceMapRange(l)),e.setEmitFlags(m,512);var _=e.createPropertyAssignment("set",m);e.setCommentRange(_,e.getCommentRange(l)),p.push(_)}p.push(e.createPropertyAssignment("enumerable",e.createTrue()),e.createPropertyAssignment("configurable",e.createTrue()));var g=e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"defineProperty"),void 0,[u,d,e.createObjectLiteral(p,!0)]);return s&&(g.startsOnNewLine=!0),b(c,49152,49152&i?16384:0),g}function V(n,r,s,o){var a=l;l=void 0;var c=o&&e.isClassLike(o)&&!e.hasModifier(n,32)?y(16286,73):y(16286,65),u=e.visitParameterList(n.parameters,k,t),d=H(n);return 16384&i&&!s&&(228===n.kind||186===n.kind)&&(s=e.getGeneratedNameForNode(n)),b(c,49152,0),l=a,e.setOriginalNode(e.setTextRange(e.createFunctionExpression(void 0,n.asteriskToken,s,void 0,u,void 0,d),r),n)}function H(r){var i,s,o,a=!1,l=!1,c=[],u=r.body;if(d(),e.isBlock(u)&&(o=e.addStandardPrologue(c,u.statements,!1)),L(c,r),N(c,r),R(c,r,!1),!a&&c.length>0&&(a=!0),e.isBlock(u))o=e.addCustomPrologue(c,u.statements,o,k),i=u.statements,e.addRange(c,e.visitNodes(u.statements,k,e.isStatement,o)),!a&&u.multiLine&&(a=!0);else{e.Debug.assert(187===r.kind),i=e.moveRangeEnd(u,-1);var p=r.equalsGreaterThanToken;e.nodeIsSynthesized(p)||e.nodeIsSynthesized(u)||(e.rangeEndIsOnSameLineAsRangeStart(p,u,n)?l=!0:a=!0);var h=e.visitNode(u,k,e.isExpression),f=e.createReturn(h);e.setTextRange(f,u),e.setEmitFlags(f,1440),c.push(f),s=u}var m=t.endLexicalEnvironment();e.addRange(c,m),M(c,r,!1),!a&&m&&m.length&&(a=!0);var _=e.createBlock(e.setTextRange(e.createNodeArray(c),i),a);return e.setTextRange(_,r.body),!a&&l&&e.setEmitFlags(_,1),s&&e.setTokenSourceMapRange(_,18,s),e.setOriginalNode(_,r.body),_}function G(n){var r=e.visitFunctionBody(n.body,E,t);return e.updateBlock(r,e.setTextRange(e.createNodeArray(M(r.statements,n,!0)),r.statements))}function j(n,r){if(r)return e.visitEachChild(n,k,t);var s=256&i?y(4032,512):y(3904,128),o=e.visitEachChild(n,k,t);return b(s,0,0),o}function K(n,r){if(!r)switch(n.expression.kind){case 185:return e.updateParen(n,K(n.expression,!1));case 194:return e.updateParen(n,W(n.expression,!1))}return e.visitEachChild(n,k,t)}function W(n,r){return e.isDestructuringAssignment(n)?e.flattenDestructuringAssignment(n,k,t,0,r):e.visitEachChild(n,k,t)}function z(n){var r=n.name;if(e.isBindingPattern(r))return q(n);if(!n.initializer&&function(e){var t=m.getNodeCheckFlags(e),n=131072&t,r=262144&t;return!(0!=(64&i)||n&&r&&0!=(512&i))&&0==(2048&i)&&(!m.isDeclarationWithCollidingName(e)||r&&!n&&0==(3072&i))}(n)){var s=e.getMutableClone(n);return s.initializer=e.createVoidZero(),s}return e.visitEachChild(n,k,t)}function q(n){var r,i=y(32,0);return r=e.isBindingPattern(n.name)?e.flattenDestructuringBinding(n,k,t,0,void 0,0!=(32&i)):e.visitEachChild(n,k,t),b(i,0,0),r}function J(t){l.labels.set(e.idText(t.label),!0)}function Y(t){l.labels.set(e.idText(t.label),!1)}function X(n,r,s,o,a){var c=y(n,r),d=function(n,r,s){if(!se(n)){var o=void 0;l&&(o=l.allowedNonLabeledJumps,l.allowedNonLabeledJumps=6);var a=s?s(n,r,void 0):e.restoreEnclosingLabel(e.visitEachChild(n,k,t),r,l&&Y);return l&&(l.allowedNonLabeledJumps=o),a}var c,d=e.createUniqueName("_loop");switch(n.kind){case 214:case 215:case 216:var h=n.initializer;h&&227===h.kind&&(c=h)}var f=[],m=[];if(c&&3&e.getCombinedNodeFlags(c))for(var _=0,g=c.declarations;_<g.length;_++){de(g[_],f,m)}var y=l;l={loopOutParameters:m},y&&(y.argumentsName&&(l.argumentsName=y.argumentsName),y.thisName&&(l.thisName=y.thisName),y.hoistedLocalVariables&&(l.hoistedLocalVariables=y.hoistedLocalVariables));u();var b=e.visitNode(n.statement,k,e.isStatement,e.liftToBlock),v=p(),T=l;if(l=y,m.length||v){var E=e.isBlock(b)?b.statements.slice():[b];m.length&&le(m,1,E),e.addRange(E,v),b=e.createBlock(E,!0)}e.isBlock(b)?b.multiLine=!0:b=e.createBlock([b],!0);var x=0!=(16777216&n.statement.transformFlags),S=x&&0!=(4&i),C=0;T.containsLexicalThis&&(C|=8);S&&(C|=262144);var I,A=[e.createVariableStatement(void 0,e.setEmitFlags(e.createVariableDeclarationList([e.createVariableDeclaration(d,void 0,e.setEmitFlags(e.createFunctionExpression(void 0,x?e.createToken(39):void 0,void 0,void 0,f,void 0,b),C))]),2097152))];T.argumentsName&&(y?y.argumentsName=T.argumentsName:(I||(I=[])).push(e.createVariableDeclaration(T.argumentsName,void 0,e.createIdentifier("arguments"))));T.thisName&&(y?y.thisName=T.thisName:(I||(I=[])).push(e.createVariableDeclaration(T.thisName,void 0,e.createIdentifier("this"))));if(T.hoistedLocalVariables)if(y)y.hoistedLocalVariables=T.hoistedLocalVariables;else{I||(I=[]);for(var w=0,N=T.hoistedLocalVariables;w<N.length;w++){var D=N[w];I.push(e.createVariableDeclaration(D))}}if(m.length){I||(I=[]);for(var O=0,R=m;O<R.length;O++){var L=R[O];I.push(e.createVariableDeclaration(L.outParamName))}}I&&A.push(e.createVariableStatement(void 0,e.createVariableDeclarationList(I)));var P,M=function(t,n,r,i){var s=l,o=[],a=!(-5&r.nonLocalJumps||r.labeledNonLocalBreaks||r.labeledNonLocalContinues),c=e.createCall(t,void 0,e.map(n,(function(e){return e.name}))),u=i?e.createYield(e.createToken(39),e.setEmitFlags(c,8388608)):c;if(a)o.push(e.createStatement(u)),le(r.loopOutParameters,0,o);else{var d=e.createUniqueName("state"),p=e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(d,void 0,u)]));if(o.push(p),le(r.loopOutParameters,0,o),8&r.nonLocalJumps){var h=void 0;s?(s.nonLocalJumps|=8,h=e.createReturn(d)):h=e.createReturn(e.createPropertyAccess(d,"value")),o.push(e.createIf(e.createBinary(e.createTypeOf(d),34,e.createLiteral("object")),h))}if(2&r.nonLocalJumps&&o.push(e.createIf(e.createBinary(d,34,e.createLiteral("break")),e.createBreak())),r.labeledNonLocalBreaks||r.labeledNonLocalContinues){var f=[];ue(r.labeledNonLocalBreaks,!0,d,s,f),ue(r.labeledNonLocalContinues,!1,d,s,f),o.push(e.createSwitch(d,e.createCaseBlock(f)))}}return o}(d,f,T,x);if(s)P=s(n,r,M);else{var F=e.getMutableClone(n);F.statement=void 0,(F=e.visitEachChild(F,k,t)).statement=e.createBlock(M,!0),F.transformFlags=0,e.aggregateTransformFlags(F),P=e.restoreEnclosingLabel(F,r,l&&Y)}return A.push(P),A}(s,o,a);return b(c,0,0),d}function Q(e,t){return X(0,256,e,t)}function Z(e,t){return X(3008,1280,e,t)}function ee(e,t){return X(1984,2304,e,t)}function te(e,t){return X(1984,2304,e,t,f.downlevelIteration?ie:re)}function ne(n,r,i){var s,o,a=[];if(e.isVariableDeclarationList(n.initializer)){3&n.initializer.flags&&Ee();var l=e.firstOrUndefined(n.initializer.declarations);if(l&&e.isBindingPattern(l.name)){var c=e.flattenDestructuringBinding(l,k,t,0,r),u=e.setTextRange(e.createVariableDeclarationList(c),n.initializer);e.setOriginalNode(u,n.initializer);var d=c[0],p=e.lastOrUndefined(c);e.setSourceMapRange(u,e.createRange(d.pos,p.end)),a.push(e.createVariableStatement(void 0,u))}else a.push(e.setTextRange(e.createVariableStatement(void 0,e.setOriginalNode(e.setTextRange(e.createVariableDeclarationList([e.createVariableDeclaration(l?l.name:e.createTempVariable(void 0),void 0,r)]),e.moveRangePos(n.initializer,-1)),n.initializer)),e.moveRangeEnd(n.initializer,-1)))}else{var h=e.createAssignment(n.initializer,r);e.isDestructuringAssignment(h)?(e.aggregateTransformFlags(h),a.push(e.createStatement(W(h,!1)))):(h.end=n.initializer.end,a.push(e.setTextRange(e.createStatement(e.visitNode(h,k,e.isExpression)),e.moveRangeEnd(n.initializer,-1))))}if(i)e.addRange(a,i);else{var f=e.visitNode(n.statement,k,e.isStatement,e.liftToBlock);e.isBlock(f)?(e.addRange(a,f.statements),s=f,o=f.statements):a.push(f)}return e.setEmitFlags(e.setTextRange(e.createBlock(e.setTextRange(e.createNodeArray(a),o),!0),s),432)}function re(t,n,r){var i=e.visitNode(t.expression,k,e.isExpression),s=e.createLoopVariable(),o=e.isIdentifier(i)?e.getGeneratedNameForNode(i):e.createTempVariable(void 0);e.setEmitFlags(i,48|e.getEmitFlags(i));var a=e.setTextRange(e.createFor(e.setEmitFlags(e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(s,void 0,e.createLiteral(0)),e.moveRangePos(t.expression,-1)),e.setTextRange(e.createVariableDeclaration(o,void 0,i),t.expression)]),t.expression),2097152),e.setTextRange(e.createLessThan(s,e.createPropertyAccess(o,"length")),t.expression),e.setTextRange(e.createPostfixIncrement(s),t.expression),ne(t,e.createElementAccess(o,s),r)),t);return e.setEmitFlags(a,256),e.setTextRange(a,t),e.restoreEnclosingLabel(a,n,l&&Y)}function ie(n,r,i){var s=e.visitNode(n.expression,k,e.isExpression),o=e.isIdentifier(s)?e.getGeneratedNameForNode(s):e.createTempVariable(void 0),a=e.isIdentifier(s)?e.getGeneratedNameForNode(o):e.createTempVariable(void 0),c=e.createUniqueName("e"),u=e.getGeneratedNameForNode(c),d=e.createTempVariable(void 0),p=e.createValuesHelper(t,s,n.expression),f=e.createCall(e.createPropertyAccess(o,"next"),void 0,[]);h(c),h(d);var m=e.setEmitFlags(e.setTextRange(e.createFor(e.setEmitFlags(e.setTextRange(e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(o,void 0,p),n.expression),e.createVariableDeclaration(a,void 0,f)]),n.expression),2097152),e.createLogicalNot(e.createPropertyAccess(a,"done")),e.createAssignment(a,f),ne(n,e.createPropertyAccess(a,"value"),i)),n),256);return e.createTry(e.createBlock([e.restoreEnclosingLabel(m,r,l&&Y)]),e.createCatchClause(e.createVariableDeclaration(u),e.setEmitFlags(e.createBlock([e.createStatement(e.createAssignment(c,e.createObjectLiteral([e.createPropertyAssignment("error",u)])))]),1)),e.createBlock([e.createTry(e.createBlock([e.setEmitFlags(e.createIf(e.createLogicalAnd(e.createLogicalAnd(a,e.createLogicalNot(e.createPropertyAccess(a,"done"))),e.createAssignment(d,e.createPropertyAccess(o,"return"))),e.createStatement(e.createFunctionCall(d,o,[]))),1)]),void 0,e.setEmitFlags(e.createBlock([e.setEmitFlags(e.createIf(c,e.createThrow(e.createPropertyAccess(c,"error"))),1)]),1))]))}function se(e){return 0!=(65536&m.getNodeCheckFlags(e))}function oe(t,n){t.hoistedLocalVariables||(t.hoistedLocalVariables=[]),function n(r){if(71===r.kind)t.hoistedLocalVariables.push(r);else for(var i=0,s=r.elements;i<s.length;i++){var o=s[i];e.isOmittedExpression(o)||n(o.name)}}(n.name)}function ae(t,n){var r=0===n?t.outParamName:t.originalName,i=0===n?t.originalName:t.outParamName;return e.createBinary(i,58,r)}function le(t,n,r){for(var i=0,s=t;i<s.length;i++){var o=s[i];r.push(e.createStatement(ae(o,n)))}}function ce(t,n,r,i){n?(t.labeledNonLocalBreaks||(t.labeledNonLocalBreaks=e.createMap()),t.labeledNonLocalBreaks.set(r,i)):(t.labeledNonLocalContinues||(t.labeledNonLocalContinues=e.createMap()),t.labeledNonLocalContinues.set(r,i))}function ue(t,n,r,i,s){t&&t.forEach((function(t,o){var a=[];if(!i||i.labels&&i.labels.get(o)){var l=e.createIdentifier(o);a.push(n?e.createBreak(l):e.createContinue(l))}else ce(i,n,o,t),a.push(e.createReturn(r));s.push(e.createCaseClause(e.createLiteral(t),a))}))}function de(t,n,r){var i=t.name;if(e.isBindingPattern(i))for(var s=0,o=i.elements;s<o.length;s++){var a=o[s];e.isOmittedExpression(a)||de(a,n,r)}else if(n.push(e.createParameter(void 0,void 0,void 0,i)),2097152&m.getNodeCheckFlags(t)){var l=e.createUniqueName("out_"+e.idText(i));r.push({originalName:i,outParamName:l})}}function pe(t,n,r){var i=e.createAssignment(e.createMemberAccessForPropertyName(n,e.visitNode(t.name,k,e.isPropertyName)),e.visitNode(t.initializer,k,e.isExpression));return e.setTextRange(i,t),r&&(i.startsOnNewLine=!0),i}function he(t,n,r){var i=e.createAssignment(e.createMemberAccessForPropertyName(n,e.visitNode(t.name,k,e.isPropertyName)),e.getSynthesizedClone(t.name));return e.setTextRange(i,t),r&&(i.startsOnNewLine=!0),i}function fe(t,n,r,s){var o=y(0,0),a=e.createAssignment(e.createMemberAccessForPropertyName(n,e.visitNode(t.name,k,e.isPropertyName)),V(t,t,void 0,r));return e.setTextRange(a,t),s&&(a.startsOnNewLine=!0),b(o,49152,49152&i?16384:0),a}function me(t,n){var r,i=e.createCallBinding(t.expression,h),s=i.target,o=i.thisArg;if(97===t.expression.kind&&e.setEmitFlags(o,4),r=524288&t.transformFlags?e.createFunctionApply(e.visitNode(s,x,e.isExpression),e.visitNode(o,k,e.isExpression),_e(t.arguments,!1,!1,!1)):e.createFunctionCall(e.visitNode(s,x,e.isExpression),e.visitNode(o,k,e.isExpression),e.visitNodes(t.arguments,k,e.isExpression),t),97===t.expression.kind){var a=e.createThis();e.setEmitFlags(a,4);var l=e.createLogicalOr(r,a);r=n?e.createAssignment(e.createIdentifier("_this"),l):l}return e.setOriginalNode(r,t)}function _e(n,r,i,s){var o=n.length,a=e.flatten(e.spanMap(n,ge,(function(e,t,n,r){return t(e,i,s&&r===o)})));if(f.downlevelIteration){if(1===a.length){var l=a[0];if(e.isCallExpression(l)&&e.isIdentifier(l.expression)&&4096&e.getEmitFlags(l.expression)&&"___spread"===l.expression.escapedText)return a[0]}return e.createSpreadHelper(t,a)}if(1===a.length){var c=n[0];return r&&e.isSpreadElement(c)&&177!==c.expression.kind?e.createArraySlice(a[0]):a[0]}return e.createArrayConcat(a.shift(),a)}function ge(t){return e.isSpreadElement(t)?ye:be}function ye(t){return e.map(t,ve)}function be(t,n,r){return e.createArrayLiteral(e.visitNodes(e.createNodeArray(t,r),k,e.isExpression),n)}function ve(t){return e.visitNode(t.expression,k,e.isExpression)}function Te(t){var r=e.getSourceTextOfNodeFromSourceFile(n,t),i=13===t.kind||16===t.kind;return r=(r=r.substring(1,r.length-(i?1:2))).replace(/\r\n?/g,"\n"),e.setTextRange(e.createLiteral(r),t)}function ke(t){return 8&i&&!t?e.createPropertyAccess(e.createIdentifier("_super"),"prototype"):e.createIdentifier("_super")}function Ee(){0==(2&c)&&(c|=2,t.enableSubstitution(71))}function xe(){0==(1&c)&&(c|=1,t.enableSubstitution(99),t.enableEmitNotification(152),t.enableEmitNotification(151),t.enableEmitNotification(153),t.enableEmitNotification(154),t.enableEmitNotification(187),t.enableEmitNotification(186),t.enableEmitNotification(228))}function Se(t,n){return e.hasModifier(n,32)?e.getInternalName(t):e.createPropertyAccess(e.getInternalName(t),"prototype")}};var o={name:"typescript:extends",scoped:!1,priority:0,text:"\n            var __extends = (this && this.__extends) || (function () {\n                var extendStatics = Object.setPrototypeOf ||\n                    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n                    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n                return function (d, b) {\n                    extendStatics(d, b);\n                    function __() { this.constructor = d; }\n                    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n                };\n            })();"},a={name:"typescript:makeTemplateObject",scoped:!1,priority:0,text:'\n            var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n                if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }\n                return cooked;\n            };'}}(ts||(ts={})),function(e){e.transformES5=function(t){var n,r,i=t.getCompilerOptions();1!==i.jsx&&3!==i.jsx||(n=t.onEmitNode,t.onEmitNode=function(t,i,s){switch(i.kind){case 251:case 252:case 250:var o=i.tagName;r[e.getOriginalNodeId(o)]=!0}n(t,i,s)},t.enableEmitNotification(251),t.enableEmitNotification(252),t.enableEmitNotification(250),r=[]);var s=t.onSubstituteNode;return t.onSubstituteNode=function(t,n){if(n.id&&r&&r[n.id])return s(t,n);if(n=s(t,n),e.isPropertyAccessExpression(n))return function(t){var n=o(t.name);if(n)return e.setTextRange(e.createElementAccess(t.expression,n),t);return t}(n);if(e.isPropertyAssignment(n))return function(t){var n=e.isIdentifier(t.name)&&o(t.name);if(n)return e.updatePropertyAssignment(t,n,t.initializer);return t}(n);return n},t.enableSubstitution(179),t.enableSubstitution(261),function(e){return e};function o(t){var n=t.originalKeywordKind||(e.nodeIsSynthesized(t)?e.stringToToken(e.idText(t)):void 0);if(n>=72&&n<=107)return e.setTextRange(e.createLiteral(t),t)}}}(ts||(ts={})),function(e){var t,n,r,i,s;!function(e){e[e.Nop=0]="Nop",e[e.Statement=1]="Statement",e[e.Assign=2]="Assign",e[e.Break=3]="Break",e[e.BreakWhenTrue=4]="BreakWhenTrue",e[e.BreakWhenFalse=5]="BreakWhenFalse",e[e.Yield=6]="Yield",e[e.YieldStar=7]="YieldStar",e[e.Return=8]="Return",e[e.Throw=9]="Throw",e[e.Endfinally=10]="Endfinally"}(t||(t={})),function(e){e[e.Open=0]="Open",e[e.Close=1]="Close"}(n||(n={})),function(e){e[e.Exception=0]="Exception",e[e.With=1]="With",e[e.Switch=2]="Switch",e[e.Loop=3]="Loop",e[e.Labeled=4]="Labeled"}(r||(r={})),function(e){e[e.Try=0]="Try",e[e.Catch=1]="Catch",e[e.Finally=2]="Finally",e[e.Done=3]="Done"}(i||(i={})),function(e){e[e.Next=0]="Next",e[e.Throw=1]="Throw",e[e.Return=2]="Return",e[e.Break=3]="Break",e[e.Yield=4]="Yield",e[e.YieldStar=5]="YieldStar",e[e.Catch=6]="Catch",e[e.Endfinally=7]="Endfinally"}(s||(s={})),e.transformGenerators=function(t){var n,r,i,s,a,l,c,u,d,p,h=t.resumeLexicalEnvironment,f=t.endLexicalEnvironment,m=t.hoistFunctionDeclaration,_=t.hoistVariableDeclaration,g=t.getCompilerOptions(),y=e.getEmitScriptTarget(g),b=t.getEmitResolver(),v=t.onSubstituteNode;t.onSubstituteNode=function(t,i){if(i=v(t,i),1===t)return function(t){if(e.isIdentifier(t))return function(t){if(!e.isGeneratedIdentifier(t)&&n&&n.has(e.idText(t))){var i=e.getOriginalNode(t);if(e.isIdentifier(i)&&i.parent){var s=b.getReferencedValueDeclaration(i);if(s){var o=r[e.getOriginalNodeId(s)];if(o){var a=e.getMutableClone(o);return e.setSourceMapRange(a,t),e.setCommentRange(a,t),a}}}}return t}(t);return t}(i);return i};var T,k,E,x,S,C,I,A,w,N,D,O,R=1,L=0,P=0;return function(n){if(n.isDeclarationFile||0==(512&n.transformFlags))return n;var r=e.visitEachChild(n,M,t);return e.addEmitHelpers(r,t.readEmitHelpers()),r};function M(n){var r=n.transformFlags;return s?function(n){switch(n.kind){case 212:case 213:return function(n){return s?(re(),n=e.visitEachChild(n,M,t),se(),n):e.visitEachChild(n,M,t)}(n);case 221:return function(n){s&&Z({kind:2,isScript:!0,breakLabel:-1});n=e.visitEachChild(n,M,t),s&&oe();return n}(n);case 222:return function(n){s&&Z({kind:4,isScript:!0,labelText:e.idText(n.label),breakLabel:-1});n=e.visitEachChild(n,M,t),s&&ae();return n}(n);default:return F(n)}}(n):i?F(n):256&r?function(n){switch(n.kind){case 228:return $(n);case 186:return B(n);default:return e.Debug.failBadSyntaxKind(n),e.visitEachChild(n,M,t)}}(n):512&r?e.visitEachChild(n,M,t):n}function F(n){switch(n.kind){case 228:return $(n);case 186:return B(n);case 153:case 154:return function(n){var r=i,o=s;return i=!1,s=!1,n=e.visitEachChild(n,M,t),i=r,s=o,n}(n);case 208:return function(t){if(16777216&t.transformFlags)return void K(t.declarationList);if(1048576&e.getEmitFlags(t))return t;for(var n=0,r=t.declarationList.declarations;n<r.length;n++){var i=r[n];_(i.name)}var s=e.getInitializedVariables(t.declarationList);if(0===s.length)return;return e.setSourceMapRange(e.createStatement(e.inlineExpressions(e.map(s,W))),t)}(n);case 214:return function(n){s&&re();var r=n.initializer;if(r&&e.isVariableDeclarationList(r)){for(var i=0,o=r.declarations;i<o.length;i++){var a=o[i];_(a.name)}var l=e.getInitializedVariables(r);n=e.updateFor(n,l.length>0?e.inlineExpressions(e.map(l,W)):void 0,e.visitNode(n.condition,M,e.isExpression),e.visitNode(n.incrementor,M,e.isExpression),e.visitNode(n.statement,M,e.isStatement,e.liftToBlock))}else n=e.visitEachChild(n,M,t);s&&se();return n}(n);case 215:return function(n){s&&re();var r=n.initializer;if(e.isVariableDeclarationList(r)){for(var i=0,o=r.declarations;i<o.length;i++){var a=o[i];_(a.name)}n=e.updateForIn(n,r.declarations[0].name,e.visitNode(n.expression,M,e.isExpression),e.visitNode(n.statement,M,e.isStatement,e.liftToBlock))}else n=e.visitEachChild(n,M,t);s&&se();return n}(n);case 218:return function(n){if(s){var r=pe(n.label&&e.idText(n.label));if(r>0)return _e(r,n)}return e.visitEachChild(n,M,t)}(n);case 217:return function(n){if(s){var r=he(n.label&&e.idText(n.label));if(r>0)return _e(r,n)}return e.visitEachChild(n,M,t)}(n);case 219:return function(t){return function(t,n){return e.setTextRange(e.createReturn(e.createArrayLiteral(t?[me(2),t]:[me(2)])),n)}(e.visitNode(t.expression,M,e.isExpression),t)}(n);default:return 16777216&n.transformFlags?function(n){switch(n.kind){case 194:return function(n){switch(e.getExpressionAssociativity(n)){case 0:return function(n){if(z(n.right)){if(e.isLogicalOperator(n.operatorToken.kind))return function(t){var n=X(),r=Y();be(r,e.visitNode(t.left,M,e.isExpression),t.left),53===t.operatorToken.kind?ke(n,r,t.left):Te(n,r,t.left);return be(r,e.visitNode(t.right,M,e.isExpression),t.right),Q(n),r}(n);if(26===n.operatorToken.kind)return function(t){var n=[];return r(t.left),r(t.right),e.inlineExpressions(n);function r(t){e.isBinaryExpression(t)&&26===t.operatorToken.kind?(r(t.left),r(t.right)):(z(t)&&n.length>0&&(Ee(1,[e.createStatement(e.inlineExpressions(n))]),n=[]),n.push(e.visitNode(t,M,e.isExpression)))}}(n);var r=e.getMutableClone(n);return r.left=J(e.visitNode(n.left,M,e.isExpression)),r.right=e.visitNode(n.right,M,e.isExpression),r}return e.visitEachChild(n,M,t)}(n);case 1:return function(n){var r=n.left,i=n.right;if(z(i)){var s=void 0;switch(r.kind){case 179:s=e.updatePropertyAccess(r,J(e.visitNode(r.expression,M,e.isLeftHandSideExpression)),r.name);break;case 180:s=e.updateElementAccess(r,J(e.visitNode(r.expression,M,e.isLeftHandSideExpression)),J(e.visitNode(r.argumentExpression,M,e.isExpression)));break;default:s=e.visitNode(r,M,e.isExpression)}var o=n.operatorToken.kind;return(a=o)>=59&&a<=70?e.setTextRange(e.createAssignment(s,e.setTextRange(e.createBinary(J(s),function(e){switch(e){case 59:return 37;case 60:return 38;case 61:return 39;case 62:return 40;case 63:return 41;case 64:return 42;case 65:return 45;case 66:return 46;case 67:return 47;case 68:return 48;case 69:return 49;case 70:return 50}}(o),e.visitNode(i,M,e.isExpression)),n)),n):e.updateBinary(n,s,e.visitNode(i,M,e.isExpression))}var a;return e.visitEachChild(n,M,t)}(n);default:e.Debug.fail("Unknown associativity.")}}(n);case 195:return function(n){if(z(n.whenTrue)||z(n.whenFalse)){var r=X(),i=X(),s=Y();return ke(r,e.visitNode(n.condition,M,e.isExpression),n.condition),be(s,e.visitNode(n.whenTrue,M,e.isExpression),n.whenTrue),ve(i),Q(r),be(s,e.visitNode(n.whenFalse,M,e.isExpression),n.whenFalse),Q(i),s}return e.visitEachChild(n,M,t)}(n);case 197:return function(n){var r=X(),i=e.visitNode(n.expression,M,e.isExpression);if(n.asteriskToken){!function(e,t){Ee(7,[e],t)}(0==(8388608&e.getEmitFlags(n.expression))?e.createValuesHelper(t,i,n):i,n)}else!function(e,t){Ee(6,[e],t)}(i,n);return Q(r),function(t){return e.setTextRange(e.createCall(e.createPropertyAccess(x,"sent"),void 0,[]),t)}(n)}(n);case 177:return function(e){return V(e.elements,void 0,void 0,e.multiLine)}(n);case 178:return function(t){var n=t.properties,r=t.multiLine,i=q(n),s=Y();be(s,e.createObjectLiteral(e.visitNodes(n,M,e.isObjectLiteralElementLike,0,i),r));var o=e.reduceLeft(n,a,[],i);return o.push(r?e.startOnNewLine(e.getMutableClone(s)):s),e.inlineExpressions(o);function a(n,i){z(i)&&n.length>0&&(ye(e.createStatement(e.inlineExpressions(n))),n=[]);var o=e.createExpressionForObjectLiteralElementLike(t,i,s),a=e.visitNode(o,M,e.isExpression);return a&&(r&&(a.startsOnNewLine=!0),n.push(a)),n}}(n);case 180:return function(n){if(z(n.argumentExpression)){var r=e.getMutableClone(n);return r.expression=J(e.visitNode(n.expression,M,e.isLeftHandSideExpression)),r.argumentExpression=e.visitNode(n.argumentExpression,M,e.isExpression),r}return e.visitEachChild(n,M,t)}(n);case 181:return function(n){if(!e.isImportCall(n)&&e.forEach(n.arguments,z)){var r=e.createCallBinding(n.expression,_,y,!0),i=r.target,s=r.thisArg;return e.setOriginalNode(e.createFunctionApply(J(e.visitNode(i,M,e.isLeftHandSideExpression)),s,V(n.arguments),n),n)}return e.visitEachChild(n,M,t)}(n);case 182:return function(n){if(e.forEach(n.arguments,z)){var r=e.createCallBinding(e.createPropertyAccess(n.expression,"bind"),_),i=r.target,s=r.thisArg;return e.setOriginalNode(e.setTextRange(e.createNew(e.createFunctionApply(J(e.visitNode(i,M,e.isExpression)),s,V(n.arguments,e.createVoidZero())),void 0,[]),n),n)}return e.visitEachChild(n,M,t)}(n);default:return e.visitEachChild(n,M,t)}}(n):33554944&n.transformFlags?e.visitEachChild(n,M,t):n}}function $(n){if(n.asteriskToken)n=e.setOriginalNode(e.setTextRange(e.createFunctionDeclaration(void 0,n.modifiers,void 0,n.name,void 0,e.visitParameterList(n.parameters,M,t),void 0,U(n.body)),n),n);else{var r=i,o=s;i=!1,s=!1,n=e.visitEachChild(n,M,t),i=r,s=o}return i?void m(n):n}function B(n){if(n.asteriskToken)n=e.setOriginalNode(e.setTextRange(e.createFunctionExpression(void 0,void 0,n.name,void 0,e.visitParameterList(n.parameters,M,t),void 0,U(n.body)),n),n);else{var r=i,o=s;i=!1,s=!1,n=e.visitEachChild(n,M,t),i=r,s=o}return n}function U(t){var n=[],r=i,o=s,m=a,_=l,g=c,y=u,b=d,v=p,S=R,C=T,I=k,A=E,w=x;i=!0,s=!1,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,p=void 0,R=1,T=void 0,k=void 0,E=void 0,x=e.createTempVariable(void 0),h();var N=e.addPrologue(n,t.statements,!1,M);H(t.statements,N);var D=xe();return e.addRange(n,f()),n.push(e.createReturn(D)),i=r,s=o,a=m,l=_,c=g,u=y,d=b,p=v,R=S,T=C,k=I,E=A,x=w,e.setTextRange(e.createBlock(n,t.multiLine),t)}function V(t,n,r,i){var s,o=q(t);if(o>0){s=Y();var a=e.visitNodes(t,M,e.isExpression,0,o);be(s,e.createArrayLiteral(n?[n].concat(a):a)),n=void 0}var l=e.reduceLeft(t,(function(t,r){if(z(r)&&t.length>0){var o=void 0!==s;s||(s=Y()),be(s,o?e.createArrayConcat(s,[e.createArrayLiteral(t,i)]):e.createArrayLiteral(n?[n].concat(t):t,i)),n=void 0,t=[]}return t.push(e.visitNode(r,M,e.isExpression)),t}),[],o);return s?e.createArrayConcat(s,[e.createArrayLiteral(l,i)]):e.setTextRange(e.createArrayLiteral(n?[n].concat(l):l,i),r)}function H(e,t){void 0===t&&(t=0);for(var n=e.length,r=t;r<n;r++)j(e[r])}function G(t){e.isBlock(t)?H(t.statements):j(t)}function j(i){var o=s;s||(s=z(i)),function(i){switch(i.kind){case 207:return function(t){z(t)?H(t.statements):ye(e.visitNode(t,M,e.isStatement))}(i);case 210:return function(t){ye(e.visitNode(t,M,e.isStatement))}(i);case 211:return function(t){if(z(t))if(z(t.thenStatement)||z(t.elseStatement)){var n=X(),r=t.elseStatement?X():void 0;ke(t.elseStatement?r:n,e.visitNode(t.expression,M,e.isExpression),t.expression),G(t.thenStatement),t.elseStatement&&(ve(n),Q(r),G(t.elseStatement)),Q(n)}else ye(e.visitNode(t,M,e.isStatement));else ye(e.visitNode(t,M,e.isStatement))}(i);case 212:return function(t){if(z(t)){var n=X(),r=X();ie(n),Q(r),G(t.statement),Q(n),Te(r,e.visitNode(t.expression,M,e.isExpression)),se()}else ye(e.visitNode(t,M,e.isStatement))}(i);case 213:return function(t){if(z(t)){var n=X(),r=ie(n);Q(n),ke(r,e.visitNode(t.expression,M,e.isExpression)),G(t.statement),ve(n),se()}else ye(e.visitNode(t,M,e.isStatement))}(i);case 214:return function(t){if(z(t)){var n=X(),r=X(),i=ie(r);if(t.initializer){var s=t.initializer;e.isVariableDeclarationList(s)?K(s):ye(e.setTextRange(e.createStatement(e.visitNode(s,M,e.isExpression)),s))}Q(n),t.condition&&ke(i,e.visitNode(t.condition,M,e.isExpression)),G(t.statement),Q(r),t.incrementor&&ye(e.setTextRange(e.createStatement(e.visitNode(t.incrementor,M,e.isExpression)),t.incrementor)),ve(n),se()}else ye(e.visitNode(t,M,e.isStatement))}(i);case 215:return function(t){if(z(t)){var n=Y(),r=Y(),i=e.createLoopVariable(),s=t.initializer;_(i),be(n,e.createArrayLiteral()),ye(e.createForIn(r,e.visitNode(t.expression,M,e.isExpression),e.createStatement(e.createCall(e.createPropertyAccess(n,"push"),void 0,[r])))),be(i,e.createLiteral(0));var o=X(),a=X(),l=ie(a);Q(o),ke(l,e.createLessThan(i,e.createPropertyAccess(n,"length")));var c=void 0;if(e.isVariableDeclarationList(s)){for(var u=0,d=s.declarations;u<d.length;u++){var p=d[u];_(p.name)}c=e.getSynthesizedClone(s.declarations[0].name)}else c=e.visitNode(s,M,e.isExpression),e.Debug.assert(e.isLeftHandSideExpression(c));be(c,e.createElementAccess(n,i)),G(t.statement),Q(a),ye(e.createStatement(e.createPostfixIncrement(i))),ve(o),se()}else ye(e.visitNode(t,M,e.isStatement))}(i);case 217:return function(t){var n=he(t.label?e.idText(t.label):void 0);n>0?ve(n,t):ye(t)}(i);case 218:return function(t){var n=pe(t.label?e.idText(t.label):void 0);n>0?ve(n,t):ye(t)}(i);case 219:return function(t){!function(e,t){Ee(8,[e],t)}(e.visitNode(t.expression,M,e.isExpression),t)}(i);case 220:return function(t){z(t)?(n=J(e.visitNode(t.expression,M,e.isExpression)),r=X(),i=X(),Q(r),Z({kind:1,expression:n,startLabel:r,endLabel:i}),G(t.statement),e.Debug.assert(1===ne()),Q(ee().endLabel)):ye(e.visitNode(t,M,e.isStatement));var n,r,i}(i);case 221:return function(t){if(z(t.caseBlock)){for(var n=t.caseBlock,r=n.clauses.length,i=(Z({kind:2,isScript:!1,breakLabel:f=X()}),f),s=J(e.visitNode(t.expression,M,e.isExpression)),o=[],a=-1,l=0;l<r;l++){var c=n.clauses[l];o.push(X()),258===c.kind&&-1===a&&(a=l)}for(var u=0,d=[];u<r;){var p=0;for(l=u;l<r;l++){if(257===(c=n.clauses[l]).kind){var h=c;if(z(h.expression)&&d.length>0)break;d.push(e.createCaseClause(e.visitNode(h.expression,M,e.isExpression),[_e(o[l],h.expression)]))}else p++}d.length&&(ye(e.createSwitch(s,e.createCaseBlock(d))),u+=d.length,d=[]),p>0&&(u+=p,p=0)}ve(a>=0?o[a]:i);for(l=0;l<r;l++)Q(o[l]),H(n.clauses[l].statements);oe()}else ye(e.visitNode(t,M,e.isStatement));var f}(i);case 222:return function(t){z(t)?(n=e.idText(t.label),r=X(),Z({kind:4,isScript:!1,labelText:n,breakLabel:r}),G(t.statement),ae()):ye(e.visitNode(t,M,e.isStatement));var n,r}(i);case 223:return function(t){!function(e,t){Ee(9,[e],t)}(e.visitNode(t.expression,M,e.isExpression),t)}(i);case 224:return function(i){z(i)?(s=X(),o=X(),Q(s),Z({kind:0,state:0,startLabel:s,endLabel:o}),ge(),G(i.tryBlock),i.catchClause&&(!function(i){var s;if(e.Debug.assert(0===ne()),e.isGeneratedIdentifier(i.name))s=i.name,_(i.name);else{var o=e.idText(i.name);s=Y(o),n||(n=e.createMap(),r=[],t.enableSubstitution(71)),n.set(o,!0),r[e.getOriginalNodeId(i)]=s}var a=te();e.Debug.assert(a.state<1),ve(a.endLabel);var l=X();Q(l),a.state=1,a.catchVariable=s,a.catchLabel=l,be(s,e.createCall(e.createPropertyAccess(x,"sent"),void 0,[])),ge()}(i.catchClause.variableDeclaration),G(i.catchClause.block)),i.finallyBlock&&(!function(){e.Debug.assert(0===ne());var t=te();e.Debug.assert(t.state<2),ve(t.endLabel);var n=X();Q(n),t.state=2,t.finallyLabel=n}(),G(i.finallyBlock)),function(){e.Debug.assert(0===ne());var t=ee();t.state<2?ve(t.endLabel):Ee(10);Q(t.endLabel),ge(),t.state=3}()):ye(e.visitEachChild(i,M,t));var s,o}(i);default:ye(e.visitNode(i,M,e.isStatement))}}(i),s=o}function K(t){for(var n=0,r=t.declarations;n<r.length;n++){var i=r[n],s=e.getSynthesizedClone(i.name);e.setCommentRange(s,i.name),_(s)}for(var o=e.getInitializedVariables(t),a=o.length,l=0,c=[];l<a;){for(var u=l;u<a;u++){if(z((i=o[u]).initializer)&&c.length>0)break;c.push(W(i))}c.length&&(ye(e.createStatement(e.inlineExpressions(c))),l+=c.length,c=[])}}function W(t){return e.setSourceMapRange(e.createAssignment(e.setSourceMapRange(e.getSynthesizedClone(t.name),t.name),e.visitNode(t.initializer,M,e.isExpression)),t)}function z(e){return e&&0!=(16777216&e.transformFlags)}function q(e){for(var t=e.length,n=0;n<t;n++)if(z(e[n]))return n;return-1}function J(t){var n;return e.isGeneratedIdentifier(t)||4096&e.getEmitFlags(t)?t:(be(n=e.createTempVariable(_),t,t),n)}function Y(t){var n=t?e.createUniqueName(t):e.createTempVariable(void 0);return _(n),n}function X(){d||(d=[]);var e=R;return R++,d[e]=-1,e}function Q(t){e.Debug.assert(void 0!==d,"No labels were defined."),d[t]=T?T.length:0}function Z(e){a||(a=[],c=[],l=[],u=[]);var t=c.length;return c[t]=0,l[t]=T?T.length:0,a[t]=e,u.push(e),t}function ee(){var t=te();e.Debug.assert(void 0!==t,"beginBlock was never called.");var n=c.length;return c[n]=1,l[n]=T?T.length:0,a[n]=t,u.pop(),t}function te(){return e.lastOrUndefined(u)}function ne(){var e=te();return e&&e.kind}function re(){Z({kind:3,isScript:!0,breakLabel:-1,continueLabel:-1})}function ie(e){var t=X();return Z({kind:3,isScript:!1,breakLabel:t,continueLabel:e}),t}function se(){e.Debug.assert(3===ne());var t=ee(),n=t.breakLabel;t.isScript||Q(n)}function oe(){e.Debug.assert(2===ne());var t=ee(),n=t.breakLabel;t.isScript||Q(n)}function ae(){e.Debug.assert(4===ne());var t=ee();t.isScript||Q(t.breakLabel)}function le(e){return 2===e.kind||3===e.kind}function ce(e){return 4===e.kind}function ue(e){return 3===e.kind}function de(e,t){for(var n=t;n>=0;n--){var r=u[n];if(!ce(r))break;if(r.labelText===e)return!0}return!1}function pe(e){if(u)if(e)for(var t=u.length-1;t>=0;t--){if(ce(n=u[t])&&n.labelText===e)return n.breakLabel;if(le(n)&&de(e,t-1))return n.breakLabel}else for(t=u.length-1;t>=0;t--){var n;if(le(n=u[t]))return n.breakLabel}return 0}function he(e){if(u)if(e)for(var t=u.length-1;t>=0;t--){if(ue(n=u[t])&&de(e,t-1))return n.continueLabel}else for(t=u.length-1;t>=0;t--){var n;if(ue(n=u[t]))return n.continueLabel}return 0}function fe(t){if(t>0){void 0===p&&(p=[]);var n=e.createLiteral(-1);return void 0===p[t]?p[t]=[n]:p[t].push(n),n}return e.createOmittedExpression()}function me(t){var n=e.createLiteral(t);return e.addSyntheticTrailingComment(n,3,function(e){switch(e){case 2:return"return";case 3:return"break";case 4:return"yield";case 5:return"yield*";case 7:return"endfinally"}}(t)),n}function _e(t,n){return e.Debug.assertLessThan(0,t,"Invalid label"),e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),n)}function ge(){Ee(0)}function ye(e){e?Ee(1,[e]):ge()}function be(e,t,n){Ee(2,[e,t],n)}function ve(e,t){Ee(3,[e],t)}function Te(e,t,n){Ee(4,[e,t],n)}function ke(e,t,n){Ee(5,[e,t],n)}function Ee(e,t,n){void 0===T&&(T=[],k=[],E=[]),void 0===d&&Q(X());var r=T.length;T[r]=e,k[r]=t,E[r]=n}function xe(){L=0,P=0,S=void 0,C=!1,I=!1,A=void 0,w=void 0,N=void 0,D=void 0,O=void 0;var n=function(){if(T){for(var t=0;t<T.length;t++)Ae(t);Se(T.length)}else Se(0);if(A){var n=e.createPropertyAccess(x,"label"),r=e.createSwitch(n,e.createCaseBlock(A));return r.startsOnNewLine=!0,[r]}if(w)return w;return[]}();return function(t,n){return t.requestEmitHelper(o),e.createCall(e.getHelperName("__generator"),void 0,[e.createThis(),n])}(t,e.setEmitFlags(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,x)],void 0,e.createBlock(n,n.length>0)),524288))}function Se(e){(function(e){if(!I)return!0;if(!d||!p)return!1;for(var t=0;t<d.length;t++)if(d[t]===e&&p[t])return!0;return!1})(e)&&(Ie(e),O=void 0,Ne(void 0,void 0)),w&&A&&Ce(!1),function(){if(void 0!==p&&void 0!==S)for(var e=0;e<S.length;e++){var t=S[e];if(void 0!==t)for(var n=0,r=t;n<r.length;n++){var i=r[n],s=p[i];if(void 0!==s)for(var o=0,a=s;o<a.length;o++){a[o].text=String(e)}}}}()}function Ce(t){if(A||(A=[]),w){if(O)for(var n=O.length-1;n>=0;n--){var r=O[n];w=[e.createWith(r.expression,e.createBlock(w))]}if(D){var i=D.startLabel,s=D.catchLabel,o=D.finallyLabel,a=D.endLabel;w.unshift(e.createStatement(e.createCall(e.createPropertyAccess(e.createPropertyAccess(x,"trys"),"push"),void 0,[e.createArrayLiteral([fe(i),fe(s),fe(o),fe(a)])]))),D=void 0}t&&w.push(e.createStatement(e.createAssignment(e.createPropertyAccess(x,"label"),e.createLiteral(P+1))))}A.push(e.createCaseClause(e.createLiteral(P),w||[])),w=void 0}function Ie(e){if(d)for(var t=0;t<d.length;t++)d[t]===e&&(w&&(Ce(!C),C=!1,I=!1,P++),void 0===S&&(S=[]),void 0===S[P]?S[P]=[t]:S[P].push(t))}function Ae(t){if(Ie(t),function(e){if(a)for(;L<c.length&&l[L]<=e;L++){var t=a[L],n=c[L];switch(t.kind){case 0:0===n?(N||(N=[]),w||(w=[]),N.push(D),D=t):1===n&&(D=N.pop());break;case 1:0===n?(O||(O=[]),O.push(t)):1===n&&O.pop()}}}(t),!C){C=!1,I=!1;var n=T[t];if(0!==n){if(10===n)return C=!0,void we(e.createReturn(e.createArrayLiteral([me(7)])));var r=k[t];if(1===n)return we(r[0]);var i,s,o,u=E[t];switch(n){case 2:return i=r[0],s=r[1],o=u,void we(e.setTextRange(e.createStatement(e.createAssignment(i,s)),o));case 3:return function(t,n){C=!0,we(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),n),384))}(r[0],u);case 4:return function(t,n,r){we(e.setEmitFlags(e.createIf(n,e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),r),384)),1))}(r[0],r[1],u);case 5:return function(t,n,r){we(e.setEmitFlags(e.createIf(e.createLogicalNot(n),e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(3),fe(t)])),r),384)),1))}(r[0],r[1],u);case 6:return function(t,n){C=!0,we(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral(t?[me(4),t]:[me(4)])),n),384))}(r[0],u);case 7:return function(t,n){C=!0,we(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral([me(5),t])),n),384))}(r[0],u);case 8:return Ne(r[0],u);case 9:return function(t,n){C=!0,I=!0,we(e.setTextRange(e.createThrow(t),n))}(r[0],u)}}}}function we(e){e&&(w?w.push(e):w=[e])}function Ne(t,n){C=!0,I=!0,we(e.setEmitFlags(e.setTextRange(e.createReturn(e.createArrayLiteral(t?[me(2),t]:[me(2)])),n),384))}};var o={name:"typescript:generator",scoped:!1,priority:6,text:'\n            var __generator = (this && this.__generator) || function (thisArg, body) {\n                var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n                return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\n                function verb(n) { return function (v) { return step([n, v]); }; }\n                function step(op) {\n                    if (f) throw new TypeError("Generator is already executing.");\n                    while (_) try {\n                        if (f = 1, y && (t = y[op[0] & 2 ? "return" : op[0] ? "throw" : "next"]) && !(t = t.call(y, op[1])).done) return t;\n                        if (y = 0, t) op = [0, t.value];\n                        switch (op[0]) {\n                            case 0: case 1: t = op; break;\n                            case 4: _.label++; return { value: op[1], done: false };\n                            case 5: _.label++; y = op[1]; op = [0]; continue;\n                            case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                            default:\n                                if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                                if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                                if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                                if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                                if (t[2]) _.ops.pop();\n                                _.trys.pop(); continue;\n                        }\n                        op = body.call(thisArg, _);\n                    } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n                    if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n                }\n            };'}}(ts||(ts={})),function(e){e.transformModule=function(r){var i=r.startLexicalEnvironment,s=r.endLexicalEnvironment,o=r.hoistVariableDeclaration,a=r.getCompilerOptions(),l=r.getEmitResolver(),c=r.getEmitHost(),u=e.getEmitScriptTarget(a),d=e.getEmitModuleKind(a),p=r.onSubstituteNode,h=r.onEmitNode;r.onSubstituteNode=function(t,n){if((n=p(t,n)).id&&_[n.id])return n;if(1===t)return function(t){switch(t.kind){case 71:return j(t);case 194:return function(t){if(e.isAssignmentOperator(t.operatorToken.kind)&&e.isIdentifier(t.left)&&!e.isGeneratedIdentifier(t.left)&&!e.isLocalName(t.left)&&!e.isDeclarationNameOfEnumOrNamespace(t.left)){var n=K(t.left);if(n){for(var r=t,i=0,s=n;i<s.length;i++){var o=s[i];_[e.getNodeId(r)]=!0,r=H(o,r,t)}return r}}return t}(t);case 193:case 192:return function(t){if((43===t.operator||44===t.operator)&&e.isIdentifier(t.operand)&&!e.isGeneratedIdentifier(t.operand)&&!e.isLocalName(t.operand)&&!e.isDeclarationNameOfEnumOrNamespace(t.operand)){var n=K(t.operand);if(n){for(var r=193===t.kind?e.setTextRange(e.createBinary(t.operand,e.createToken(43===t.operator?59:60),e.createLiteral(1)),t):t,i=0,s=n;i<s.length;i++){var o=s[i];_[e.getNodeId(r)]=!0,r=H(o,r)}return r}}return t}(t)}return t}(n);if(e.isShorthandPropertyAssignment(n))return function(t){var n=t.name,r=j(n);if(r!==n){if(t.objectAssignmentInitializer){var i=e.createAssignment(r,t.objectAssignmentInitializer);return e.setTextRange(e.createPropertyAssignment(n,i),t)}return e.setTextRange(e.createPropertyAssignment(n,r),t)}return t}(n);return n},r.onEmitNode=function(t,n,r){265===n.kind?(f=n,m=y[e.getOriginalNodeId(f)],_=[],h(t,n,r),f=void 0,m=void 0,_=void 0):h(t,n,r)},r.enableSubstitution(71),r.enableSubstitution(194),r.enableSubstitution(192),r.enableSubstitution(193),r.enableSubstitution(262),r.enableEmitNotification(265);var f,m,_,g,y=[],b=[];return function(t){if(t.isDeclarationFile||!(e.isExternalModule(t)||a.isolatedModules||67108864&t.transformFlags))return t;f=t,m=e.collectExternalModuleInfo(t,l,a),y[e.getOriginalNodeId(t)]=m;var n=function(t){switch(t){case e.ModuleKind.AMD:return k;case e.ModuleKind.UMD:return E;default:return T}}(d)(t);return f=void 0,m=void 0,g=!1,e.aggregateTransformFlags(n)};function v(){return!(m.exportEquals||!e.isExternalModule(f))}function T(n){i();var o=[],l=a.alwaysStrict||!a.noImplicitUseStrict&&e.isExternalModule(f),c=e.addPrologue(o,n.statements,l,I);v()&&e.append(o,V()),e.append(o,e.visitNode(m.externalHelpersImportDeclaration,I,e.isStatement)),e.addRange(o,e.visitNodes(n.statements,I,e.isStatement,c)),C(o,!1),e.addRange(o,s());var u=e.updateSourceFileNode(n,e.setTextRange(e.createNodeArray(o),n.statements));return m.hasExportStarsToExportValues&&!a.importHelpers&&e.addEmitHelper(u,t),e.addEmitHelpers(u,r.readEmitHelpers()),u}function k(t){var n=e.createIdentifier("define"),r=e.tryGetModuleNameFromFile(t,c,a),i=x(t,!0),s=i.aliasedModuleNames,o=i.unaliasedModuleNames,l=i.importAliasNames;return e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray([e.createStatement(e.createCall(n,void 0,(r?[r]:[]).concat([e.createArrayLiteral([e.createLiteral("require"),e.createLiteral("exports")].concat(s,o)),e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,"require"),e.createParameter(void 0,void 0,void 0,"exports")].concat(l),void 0,S(t))])))]),t.statements))}function E(t){var n=x(t,!1),r=n.aliasedModuleNames,i=n.unaliasedModuleNames,s=n.importAliasNames,o=e.tryGetModuleNameFromFile(t,c,a),l=e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,"factory")],void 0,e.setTextRange(e.createBlock([e.createIf(e.createLogicalAnd(e.createTypeCheck(e.createIdentifier("module"),"object"),e.createTypeCheck(e.createPropertyAccess(e.createIdentifier("module"),"exports"),"object")),e.createBlock([e.createVariableStatement(void 0,[e.createVariableDeclaration("v",void 0,e.createCall(e.createIdentifier("factory"),void 0,[e.createIdentifier("require"),e.createIdentifier("exports")]))]),e.setEmitFlags(e.createIf(e.createStrictInequality(e.createIdentifier("v"),e.createIdentifier("undefined")),e.createStatement(e.createAssignment(e.createPropertyAccess(e.createIdentifier("module"),"exports"),e.createIdentifier("v")))),1)]),e.createIf(e.createLogicalAnd(e.createTypeCheck(e.createIdentifier("define"),"function"),e.createPropertyAccess(e.createIdentifier("define"),"amd")),e.createBlock([e.createStatement(e.createCall(e.createIdentifier("define"),void 0,(o?[o]:[]).concat([e.createArrayLiteral([e.createLiteral("require"),e.createLiteral("exports")].concat(r,i)),e.createIdentifier("factory")])))])))],!0),void 0));return e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray([e.createStatement(e.createCall(l,void 0,[e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,"require"),e.createParameter(void 0,void 0,void 0,"exports")].concat(s),void 0,S(t))]))]),t.statements))}function x(t,n){for(var r=[],i=[],s=[],o=0,u=t.amdDependencies;o<u.length;o++){var d=u[o];d.name?(r.push(e.createLiteral(d.path)),s.push(e.createParameter(void 0,void 0,void 0,d.name))):i.push(e.createLiteral(d.path))}for(var p=0,h=m.externalImports;p<h.length;p++){var _=h[p],g=e.getExternalModuleNameLiteral(_,f,c,l,a),y=e.getLocalNameForExternalImport(_,f);g&&(n&&y?(e.setEmitFlags(y,4),r.push(g),s.push(e.createParameter(void 0,void 0,void 0,y))):i.push(g))}return{aliasedModuleNames:r,unaliasedModuleNames:i,importAliasNames:s}}function S(r){i();var o=[],l=e.addPrologue(o,r.statements,!a.noImplicitUseStrict,I);v()&&e.append(o,V()),e.append(o,e.visitNode(m.externalHelpersImportDeclaration,I,e.isStatement)),e.addRange(o,e.visitNodes(r.statements,I,e.isStatement,l)),C(o,!0),e.addRange(o,s());var c=e.createBlock(o,!0);return m.hasExportStarsToExportValues&&!a.importHelpers&&e.addEmitHelper(c,t),g&&e.addEmitHelper(c,n),c}function C(t,n){if(m.exportEquals){var r=e.visitNode(m.exportEquals.expression,A);if(r)if(n){var i=e.createReturn(r);e.setTextRange(i,m.exportEquals),e.setEmitFlags(i,1920),t.push(i)}else{i=e.createStatement(e.createAssignment(e.createPropertyAccess(e.createIdentifier("module"),"exports"),r));e.setTextRange(i,m.exportEquals),e.setEmitFlags(i,1536),t.push(i)}}}function I(t){switch(t.kind){case 238:return function(t){var n,r=e.getNamespaceDeclarationNode(t);if(d!==e.ModuleKind.AMD){if(!t.importClause)return e.setTextRange(e.createStatement(D(t)),t);var i=[];r&&!e.isDefaultImport(t)?i.push(e.createVariableDeclaration(e.getSynthesizedClone(r.name),void 0,D(t))):(i.push(e.createVariableDeclaration(e.getGeneratedNameForNode(t),void 0,D(t))),r&&e.isDefaultImport(t)&&i.push(e.createVariableDeclaration(e.getSynthesizedClone(r.name),void 0,e.getGeneratedNameForNode(t)))),n=e.append(n,e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList(i,u>=2?2:0)),t))}else r&&e.isDefaultImport(t)&&(n=e.append(n,e.createVariableStatement(void 0,e.createVariableDeclarationList([e.setTextRange(e.createVariableDeclaration(e.getSynthesizedClone(r.name),void 0,e.getGeneratedNameForNode(t)),t)],u>=2?2:0))));if(R(t)){var s=e.getOriginalNodeId(t);b[s]=L(b[s],t)}else n=L(n,t);return e.singleOrMany(n)}(t);case 237:return function(t){var n;e.Debug.assert(e.isExternalModuleImportEqualsDeclaration(t),"import= for internal module references should be handled in an earlier transformer."),d!==e.ModuleKind.AMD?n=e.hasModifier(t,1)?e.append(n,e.setTextRange(e.createStatement(H(t.name,D(t))),t)):e.append(n,e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.getSynthesizedClone(t.name),void 0,D(t))],u>=2?2:0)),t)):e.hasModifier(t,1)&&(n=e.append(n,e.setTextRange(e.createStatement(H(e.getExportName(t),e.getLocalName(t))),t)));if(R(t)){var r=e.getOriginalNodeId(t);b[r]=P(b[r],t)}else n=P(n,t);return e.singleOrMany(n)}(t);case 244:return function(t){if(!t.moduleSpecifier)return;var n=e.getGeneratedNameForNode(t);if(t.exportClause){var i=[];d!==e.ModuleKind.AMD&&i.push(e.setTextRange(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(n,void 0,D(t))])),t));for(var s=0,o=t.exportClause.elements;s<o.length;s++){var a=o[s],l=e.createPropertyAccess(n,a.propertyName||a.name);i.push(e.setTextRange(e.createStatement(H(e.getExportName(a),l)),a))}return e.singleOrMany(i)}return e.setTextRange(e.createStatement(function(t,n){return t.getCompilerOptions().importHelpers?e.createCall(e.getHelperName("__exportStar"),void 0,[n,e.createIdentifier("exports")]):e.createCall(e.createIdentifier("__export"),void 0,[n])}(r,d!==e.ModuleKind.AMD?D(t):n)),t)}(t);case 243:return function(t){if(t.isExportEquals)return;var n,r=t.original;if(r&&R(r)){var i=e.getOriginalNodeId(t);b[i]=U(b[i],e.createIdentifier("default"),e.visitNode(t.expression,A),t,!0)}else n=U(n,e.createIdentifier("default"),e.visitNode(t.expression,A),t,!0);return e.singleOrMany(n)}(t);case 208:return function(t){var n,i,s;if(e.hasModifier(t,1)){for(var o=void 0,a=0,l=t.declarationList.declarations;a<l.length;a++){var c=l[a];e.isIdentifier(c.name)&&e.isLocalName(c.name)?(o||(o=e.visitNodes(t.modifiers,G,e.isModifier)),i=e.append(i,c)):c.initializer&&(s=e.append(s,O(c)))}i&&(n=e.append(n,e.updateVariableStatement(t,o,e.updateVariableDeclarationList(t.declarationList,i)))),s&&(n=e.append(n,e.setTextRange(e.createStatement(e.inlineExpressions(s)),t)))}else n=e.append(n,e.visitEachChild(t,A,r));if(R(t)){var u=e.getOriginalNodeId(t);b[u]=M(b[u],t)}else n=M(n,t);return e.singleOrMany(n)}(t);case 228:return function(t){var n;n=e.hasModifier(t,1)?e.append(n,e.setOriginalNode(e.setTextRange(e.createFunctionDeclaration(void 0,e.visitNodes(t.modifiers,G,e.isModifier),t.asteriskToken,e.getDeclarationName(t,!0,!0),void 0,e.visitNodes(t.parameters,A),void 0,e.visitEachChild(t.body,A,r)),t),t)):e.append(n,e.visitEachChild(t,A,r));if(R(t)){var i=e.getOriginalNodeId(t);b[i]=$(b[i],t)}else n=$(n,t);return e.singleOrMany(n)}(t);case 229:return function(t){var n;n=e.hasModifier(t,1)?e.append(n,e.setOriginalNode(e.setTextRange(e.createClassDeclaration(void 0,e.visitNodes(t.modifiers,G,e.isModifier),e.getDeclarationName(t,!0,!0),void 0,e.visitNodes(t.heritageClauses,A),e.visitNodes(t.members,A)),t),t)):e.append(n,e.visitEachChild(t,A,r));if(R(t)){var i=e.getOriginalNodeId(t);b[i]=$(b[i],t)}else n=$(n,t);return e.singleOrMany(n)}(t);case 290:return function(t){if(R(t)&&208===t.original.kind){var n=e.getOriginalNodeId(t);b[n]=M(b[n],t.original)}return t}(t);case 291:return function(t){var n=e.getOriginalNodeId(t),r=b[n];if(r)return delete b[n],e.append(r,t);return t}(t);default:return e.visitEachChild(t,A,r)}}function A(t){return 67108864&t.transformFlags?e.isImportCall(t)?function(t){var n=e.visitNode(e.firstOrUndefined(t.arguments),A),r=!!(16384&t.transformFlags);switch(a.module){case e.ModuleKind.AMD:return w(n,r);case e.ModuleKind.UMD:return function(t,n){if(g=!0,e.isSimpleCopiableExpression(t)){var r=e.isGeneratedIdentifier(t)?t:e.isStringLiteral(t)?e.createLiteral(t):e.setEmitFlags(e.setTextRange(e.getSynthesizedClone(t),t),1536);return e.createConditional(e.createIdentifier("__syncRequire"),N(t,n),w(r,n))}var i=e.createTempVariable(o);return e.createComma(e.createAssignment(i,t),e.createConditional(e.createIdentifier("__syncRequire"),N(i,n),w(i,n)))}(n,r);case e.ModuleKind.CommonJS:default:return N(n,r)}}(t):e.visitEachChild(t,A,r):t}function w(t,n){var r,i=e.createUniqueName("resolve"),s=e.createUniqueName("reject"),o=[e.createParameter(void 0,void 0,void 0,i),e.createParameter(void 0,void 0,void 0,s)],a=e.createBlock([e.createStatement(e.createCall(e.createIdentifier("require"),void 0,[e.createArrayLiteral([t||e.createOmittedExpression()]),i,s]))]);return u>=2?r=e.createArrowFunction(void 0,void 0,o,void 0,void 0,a):(r=e.createFunctionExpression(void 0,void 0,void 0,void 0,o,void 0,a),n&&e.setEmitFlags(r,8)),e.createNew(e.createIdentifier("Promise"),void 0,[r])}function N(t,n){var r,i=e.createCall(e.createPropertyAccess(e.createIdentifier("Promise"),"resolve"),void 0,[]),s=e.createCall(e.createIdentifier("require"),void 0,t?[t]:[]);return u>=2?r=e.createArrowFunction(void 0,void 0,[],void 0,void 0,s):(r=e.createFunctionExpression(void 0,void 0,void 0,void 0,[],void 0,e.createBlock([e.createReturn(s)])),n&&e.setEmitFlags(r,8)),e.createCall(e.createPropertyAccess(i,"then"),void 0,[r])}function D(t){var n=e.getExternalModuleNameLiteral(t,f,c,l,a),r=[];return n&&r.push(n),e.createCall(e.createIdentifier("require"),void 0,r)}function O(t){return e.isBindingPattern(t.name)?e.flattenDestructuringAssignment(e.visitNode(t,A),void 0,r,0,!1,H):e.createAssignment(e.setTextRange(e.createPropertyAccess(e.createIdentifier("exports"),t.name),t.name),e.visitNode(t.initializer,A))}function R(t){return 0!=(4194304&e.getEmitFlags(t))}function L(e,t){if(m.exportEquals)return e;var n=t.importClause;if(!n)return e;n.name&&(e=B(e,n));var r=n.namedBindings;if(r)switch(r.kind){case 240:e=B(e,r);break;case 241:for(var i=0,s=r.elements;i<s.length;i++){e=B(e,s[i])}}return e}function P(e,t){return m.exportEquals?e:B(e,t)}function M(e,t){if(m.exportEquals)return e;for(var n=0,r=t.declarationList.declarations;n<r.length;n++){e=F(e,r[n])}return e}function F(t,n){if(m.exportEquals)return t;if(e.isBindingPattern(n.name))for(var r=0,i=n.name.elements;r<i.length;r++){var s=i[r];e.isOmittedExpression(s)||(t=F(t,s))}else e.isGeneratedIdentifier(n.name)||(t=B(t,n));return t}function $(t,n){if(m.exportEquals)return t;e.hasModifier(n,1)&&(t=U(t,e.hasModifier(n,512)?e.createIdentifier("default"):e.getDeclarationName(n),e.getLocalName(n),n));return n.name&&(t=B(t,n)),t}function B(t,n){var r=e.getDeclarationName(n),i=m.exportSpecifiers.get(e.idText(r));if(i)for(var s=0,o=i;s<o.length;s++){var a=o[s];t=U(t,a.name,r,a.name)}return t}function U(t,n,r,i,s){return t=e.append(t,function(t,n,r,i){var s=e.setTextRange(e.createStatement(H(t,n)),r);e.startOnNewLine(s),i||e.setEmitFlags(s,1536);return s}(n,r,i,s))}function V(){var t;return t=0===u?e.createStatement(H(e.createIdentifier("__esModule"),e.createLiteral(!0))):e.createStatement(e.createCall(e.createPropertyAccess(e.createIdentifier("Object"),"defineProperty"),void 0,[e.createIdentifier("exports"),e.createLiteral("__esModule"),e.createObjectLiteral([e.createPropertyAssignment("value",e.createLiteral(!0))])])),e.setEmitFlags(t,1048576),t}function H(t,n,r){return e.setTextRange(e.createAssignment(e.createPropertyAccess(e.createIdentifier("exports"),e.getSynthesizedClone(t)),n),r)}function G(e){switch(e.kind){case 84:case 79:return}return e}function j(t){if(4096&e.getEmitFlags(t)){var n=e.getExternalHelpersModuleName(f);return n?e.createPropertyAccess(n,t):t}if(!e.isGeneratedIdentifier(t)&&!e.isLocalName(t)){var r=l.getReferencedExportContainer(t,e.isExportName(t));if(r&&265===r.kind)return e.setTextRange(e.createPropertyAccess(e.createIdentifier("exports"),e.getSynthesizedClone(t)),t);var i=l.getReferencedImportDeclaration(t);if(i){if(e.isImportClause(i))return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(i.parent),e.createIdentifier("default")),t);if(e.isImportSpecifier(i)){var s=i.propertyName||i.name;return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(i.parent.parent.parent),e.getSynthesizedClone(s)),t)}}}return t}function K(t){if(!e.isGeneratedIdentifier(t)){var n=l.getReferencedImportDeclaration(t)||l.getReferencedValueDeclaration(t);if(n)return m&&m.exportedBindings[e.getOriginalNodeId(n)]}}};var t={name:"typescript:export-star",scoped:!0,text:"\n            function __export(m) {\n                for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n            }\n        "};var n={name:"typescript:dynamicimport-sync-require",scoped:!0,text:'\n            var __syncRequire = typeof module === "object" && typeof module.exports === "object";'}}(ts||(ts={})),function(e){e.transformSystemModule=function(t){var n=t.startLexicalEnvironment,r=t.endLexicalEnvironment,i=t.hoistVariableDeclaration,s=t.getCompilerOptions(),o=t.getEmitResolver(),a=t.getEmitHost(),l=t.onSubstituteNode,c=t.onEmitNode;t.onSubstituteNode=function(t,n){if(function(e){return _&&e.id&&_[e.id]}(n=l(t,n)))return n;if(1===t)return function(t){switch(t.kind){case 71:return function(t){if(4096&e.getEmitFlags(t)){var n=e.getExternalHelpersModuleName(u);return n?e.createPropertyAccess(n,t):t}if(!e.isGeneratedIdentifier(t)&&!e.isLocalName(t)){var r=o.getReferencedImportDeclaration(t);if(r){if(e.isImportClause(r))return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(r.parent),e.createIdentifier("default")),t);if(e.isImportSpecifier(r))return e.setTextRange(e.createPropertyAccess(e.getGeneratedNameForNode(r.parent.parent.parent),e.getSynthesizedClone(r.propertyName||r.name)),t)}}return t}(t);case 194:return function(t){if(e.isAssignmentOperator(t.operatorToken.kind)&&e.isIdentifier(t.left)&&!e.isGeneratedIdentifier(t.left)&&!e.isLocalName(t.left)&&!e.isDeclarationNameOfEnumOrNamespace(t.left)){var n=K(t.left);if(n){for(var r=t,i=0,s=n;i<s.length;i++){r=B(s[i],W(r))}return r}}return t}(t);case 192:case 193:return function(t){if((43===t.operator||44===t.operator)&&e.isIdentifier(t.operand)&&!e.isGeneratedIdentifier(t.operand)&&!e.isLocalName(t.operand)&&!e.isDeclarationNameOfEnumOrNamespace(t.operand)){var n=K(t.operand);if(n){for(var r=193===t.kind?e.setTextRange(e.createPrefix(t.operator,t.operand),t):t,i=0,s=n;i<s.length;i++){r=B(s[i],W(r))}return 193===t.kind&&(r=43===t.operator?e.createSubtract(W(r),e.createLiteral(1)):e.createAdd(W(r),e.createLiteral(1))),r}}return t}(t)}return t}(n);return n},t.onEmitNode=function(t,n,r){if(265===n.kind){var i=e.getOriginalNodeId(n);u=n,d=g[i],p=b[i],(_=v[i])&&delete v[i],c(t,n,r),u=void 0,d=void 0,p=void 0,_=void 0}else c(t,n,r)},t.enableSubstitution(71),t.enableSubstitution(194),t.enableSubstitution(192),t.enableSubstitution(193),t.enableEmitNotification(265);var u,d,p,h,f,m,_,g=[],y=[],b=[],v=[];return function(t){if(t.isDeclarationFile||!(e.isEffectiveExternalModule(t,s)||67108864&t.transformFlags))return t;var i=e.getOriginalNodeId(t);u=t,m=t,d=g[i]=e.collectExternalModuleInfo(t,o,s),p=e.createUniqueName("exports"),b[i]=p,h=e.createUniqueName("context");var l=function(t){for(var n=e.createMap(),r=[],i=0;i<t.length;i++){var l=t[i],c=e.getExternalModuleNameLiteral(l,u,a,o,s);if(c){var d=c.text,p=n.get(d);void 0!==p?r[p].externalImports.push(l):(n.set(d,r.length),r.push({name:c,externalImports:[l]}))}}return r}(d.externalImports),c=function(t,i){var o=[];n();var a=s.alwaysStrict||!s.noImplicitUseStrict&&e.isExternalModule(u),l=e.addPrologue(o,t.statements,a,E);o.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration("__moduleName",void 0,e.createLogicalAnd(h,e.createPropertyAccess(h,"id")))]))),e.visitNode(d.externalHelpersImportDeclaration,E,e.isStatement);var c=e.visitNodes(t.statements,E,e.isStatement,l);e.addRange(o,f),e.addRange(o,r());var p=function(t){if(!d.hasExportStarsToExportValues)return;if(!d.exportedNames&&0===d.exportSpecifiers.size){for(var n=!1,r=0,i=d.externalImports;r<i.length;r++){if(244===(h=i[r]).kind&&h.exportClause){n=!0;break}}if(!n){var s=T(void 0);return t.push(s),s.name}}var o=[];if(d.exportedNames)for(var a=0,l=d.exportedNames;a<l.length;a++){var c=l[a];"default"!==c.escapedText&&o.push(e.createPropertyAssignment(e.createLiteral(c),e.createTrue()))}for(var u=0,p=d.externalImports;u<p.length;u++){var h;if(244===(h=p[u]).kind){var f=h;if(f.exportClause)for(var m=0,_=f.exportClause.elements;m<_.length;m++){var g=_[m];o.push(e.createPropertyAssignment(e.createLiteral(e.idText(g.name||g.propertyName)),e.createTrue()))}}}var y=e.createUniqueName("exportedNames");t.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(y,void 0,e.createObjectLiteral(o,!0))])));var b=T(y);return t.push(b),b.name}(o),m=e.createObjectLiteral([e.createPropertyAssignment("setters",k(p,i)),e.createPropertyAssignment("execute",e.createFunctionExpression(void 0,void 0,void 0,void 0,[],void 0,e.createBlock(c,!0)))]);return m.multiLine=!0,o.push(e.createReturn(m)),e.createBlock(o,!0)}(t,l),y=e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,p),e.createParameter(void 0,void 0,void 0,h)],void 0,c),x=e.tryGetModuleNameFromFile(t,a,s),S=e.createArrayLiteral(e.map(l,(function(e){return e.name}))),C=e.setEmitFlags(e.updateSourceFileNode(t,e.setTextRange(e.createNodeArray([e.createStatement(e.createCall(e.createPropertyAccess(e.createIdentifier("System"),"register"),void 0,x?[x,S,y]:[S,y]))]),t.statements)),1024);s.outFile||s.out||e.moveEmitHelpers(C,c,(function(e){return!e.scoped}));_&&(v[i]=_,_=void 0);return u=void 0,d=void 0,p=void 0,h=void 0,f=void 0,m=void 0,e.aggregateTransformFlags(C)};function T(t){var n=e.createUniqueName("exportStar"),r=e.createIdentifier("m"),i=e.createIdentifier("n"),s=e.createIdentifier("exports"),o=e.createStrictInequality(i,e.createLiteral("default"));return t&&(o=e.createLogicalAnd(o,e.createLogicalNot(e.createCall(e.createPropertyAccess(t,"hasOwnProperty"),void 0,[i])))),e.createFunctionDeclaration(void 0,void 0,void 0,n,void 0,[e.createParameter(void 0,void 0,void 0,r)],void 0,e.createBlock([e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(s,void 0,e.createObjectLiteral([]))])),e.createForIn(e.createVariableDeclarationList([e.createVariableDeclaration(i,void 0)]),r,e.createBlock([e.setEmitFlags(e.createIf(o,e.createStatement(e.createAssignment(e.createElementAccess(s,i),e.createElementAccess(r,i)))),1)])),e.createStatement(e.createCall(p,void 0,[s]))],!0))}function k(t,n){for(var r=[],i=0,s=n;i<s.length;i++){for(var o=s[i],a=e.forEach(o.externalImports,(function(t){return e.getLocalNameForExternalImport(t,u)})),l=a?e.getGeneratedNameForNode(a):e.createUniqueName(""),c=[],d=0,h=o.externalImports;d<h.length;d++){var f=h[d],m=e.getLocalNameForExternalImport(f,u);switch(f.kind){case 238:if(!f.importClause)break;case 237:e.Debug.assert(void 0!==m),c.push(e.createStatement(e.createAssignment(m,l)));break;case 244:if(e.Debug.assert(void 0!==m),f.exportClause){for(var _=[],g=0,y=f.exportClause.elements;g<y.length;g++){var b=y[g];_.push(e.createPropertyAssignment(e.createLiteral(e.idText(b.name)),e.createElementAccess(l,e.createLiteral(e.idText(b.propertyName||b.name)))))}c.push(e.createStatement(e.createCall(p,void 0,[e.createObjectLiteral(_,!0)])))}else c.push(e.createStatement(e.createCall(t,void 0,[l])))}}r.push(e.createFunctionExpression(void 0,void 0,void 0,void 0,[e.createParameter(void 0,void 0,void 0,l)],void 0,e.createBlock(c,!0)))}return e.createArrayLiteral(r,!0)}function E(t){switch(t.kind){case 238:return function(t){var n;t.importClause&&i(e.getLocalNameForExternalImport(t,u));if(N(t)){var r=e.getOriginalNodeId(t);y[r]=D(y[r],t)}else n=D(n,t);return e.singleOrMany(n)}(t);case 237:return function(t){var n;if(e.Debug.assert(e.isExternalModuleImportEqualsDeclaration(t),"import= for internal module references should be handled in an earlier transformer."),i(e.getLocalNameForExternalImport(t,u)),N(t)){var r=e.getOriginalNodeId(t);y[r]=O(y[r],t)}else n=O(n,t);return e.singleOrMany(n)}(t);case 244:return;case 243:return function(t){if(t.isExportEquals)return;var n=e.visitNode(t.expression,H,e.isExpression),r=t.original;if(!r||!N(r))return $(e.createIdentifier("default"),n,!0);var i=e.getOriginalNodeId(t);y[i]=F(y[i],e.createIdentifier("default"),n,!0)}(t);default:return U(t)}}function x(t){if(e.isBindingPattern(t.name))for(var n=0,r=t.name.elements;n<r.length;n++){var s=r[n];e.isOmittedExpression(s)||x(s)}else i(e.getSynthesizedClone(t.name))}function S(t){return 0==(2097152&e.getEmitFlags(t))&&(265===m.kind||0==(3&e.getOriginalNode(t).flags))}function C(n,r){var i=r?I:A;return e.isBindingPattern(n.name)?e.flattenDestructuringAssignment(n,H,t,0,!1,i):n.initializer?i(n.name,e.visitNode(n.initializer,H,e.isExpression)):n.name}function I(e,t,n){return w(e,t,n,!0)}function A(e,t,n){return w(e,t,n,!1)}function w(t,n,r,s){return i(e.getSynthesizedClone(t)),s?B(t,W(e.setTextRange(e.createAssignment(t,n),r))):W(e.setTextRange(e.createAssignment(t,n),r))}function N(t){return 0!=(4194304&e.getEmitFlags(t))}function D(e,t){if(d.exportEquals)return e;var n=t.importClause;if(!n)return e;n.name&&(e=M(e,n));var r=n.namedBindings;if(r)switch(r.kind){case 240:e=M(e,r);break;case 241:for(var i=0,s=r.elements;i<s.length;i++){e=M(e,s[i])}}return e}function O(e,t){return d.exportEquals?e:M(e,t)}function R(e,t,n){if(d.exportEquals)return e;for(var r=0,i=t.declarationList.declarations;r<i.length;r++){var s=i[r];(s.initializer||n)&&(e=L(e,s,n))}return e}function L(t,n,r){if(d.exportEquals)return t;if(e.isBindingPattern(n.name))for(var i=0,s=n.name.elements;i<s.length;i++){var o=s[i];e.isOmittedExpression(o)||(t=L(t,o,r))}else if(!e.isGeneratedIdentifier(n.name)){var a=void 0;r&&(t=F(t,n.name,e.getLocalName(n)),a=e.idText(n.name)),t=M(t,n,a)}return t}function P(t,n){if(d.exportEquals)return t;var r;if(e.hasModifier(n,1)){var i=e.hasModifier(n,512)?e.createLiteral("default"):n.name;t=F(t,i,e.getLocalName(n)),r=e.getTextOfIdentifierOrLiteral(i)}return n.name&&(t=M(t,n,r)),t}function M(t,n,r){if(d.exportEquals)return t;var i=e.getDeclarationName(n),s=d.exportSpecifiers.get(e.idText(i));if(s)for(var o=0,a=s;o<a.length;o++){var l=a[o];l.name.escapedText!==r&&(t=F(t,l.name,i))}return t}function F(t,n,r,i){return t=e.append(t,$(n,r,i))}function $(t,n,r){var i=e.createStatement(B(t,n));return e.startOnNewLine(i),r||e.setEmitFlags(i,1536),i}function B(t,n){var r=e.isIdentifier(t)?e.createLiteral(t):t;return e.setEmitFlags(n,1536|e.getEmitFlags(n)),e.setCommentRange(e.createCall(p,void 0,[r,n]),n)}function U(n){switch(n.kind){case 208:return function(t){if(!S(t.declarationList))return e.visitNode(t,H,e.isStatement);for(var n,r,i=e.hasModifier(t,1),s=N(t),o=0,a=t.declarationList.declarations;o<a.length;o++){var l=a[o];l.initializer?n=e.append(n,C(l,i&&!s)):x(l)}if(n&&(r=e.append(r,e.setTextRange(e.createStatement(e.inlineExpressions(n)),t))),s){var c=e.getOriginalNodeId(t);y[c]=R(y[c],t,i)}else r=R(r,t,!1);return e.singleOrMany(r)}(n);case 228:return function(n){if(f=e.hasModifier(n,1)?e.append(f,e.updateFunctionDeclaration(n,n.decorators,e.visitNodes(n.modifiers,j,e.isModifier),n.asteriskToken,e.getDeclarationName(n,!0,!0),void 0,e.visitNodes(n.parameters,H,e.isParameterDeclaration),void 0,e.visitNode(n.body,H,e.isBlock))):e.append(f,e.visitEachChild(n,H,t)),N(n)){var r=e.getOriginalNodeId(n);y[r]=P(y[r],n)}else f=P(f,n)}(n);case 229:return function(t){var n,r=e.getLocalName(t);if(i(r),n=e.append(n,e.setTextRange(e.createStatement(e.createAssignment(r,e.setTextRange(e.createClassExpression(void 0,t.name,void 0,e.visitNodes(t.heritageClauses,H,e.isHeritageClause),e.visitNodes(t.members,H,e.isClassElement)),t))),t)),N(t)){var s=e.getOriginalNodeId(t);y[s]=P(y[s],t)}else n=P(n,t);return e.singleOrMany(n)}(n);case 214:return function(t){var n=m;return m=t,t=e.updateFor(t,V(t.initializer),e.visitNode(t.condition,H,e.isExpression),e.visitNode(t.incrementor,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement)),m=n,t}(n);case 215:return function(t){var n=m;return m=t,t=e.updateForIn(t,V(t.initializer),e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock)),m=n,t}(n);case 216:return function(t){var n=m;return m=t,t=e.updateForOf(t,t.awaitModifier,V(t.initializer),e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock)),m=n,t}(n);case 212:return function(t){return e.updateDo(t,e.visitNode(t.statement,U,e.isStatement,e.liftToBlock),e.visitNode(t.expression,H,e.isExpression))}(n);case 213:return function(t){return e.updateWhile(t,e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock))}(n);case 222:return function(t){return e.updateLabel(t,t.label,e.visitNode(t.statement,U,e.isStatement,e.liftToBlock))}(n);case 220:return function(t){return e.updateWith(t,e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.statement,U,e.isStatement,e.liftToBlock))}(n);case 221:return function(t){return e.updateSwitch(t,e.visitNode(t.expression,H,e.isExpression),e.visitNode(t.caseBlock,U,e.isCaseBlock))}(n);case 235:return function(t){var n=m;return m=t,t=e.updateCaseBlock(t,e.visitNodes(t.clauses,U,e.isCaseOrDefaultClause)),m=n,t}(n);case 257:return function(t){return e.updateCaseClause(t,e.visitNode(t.expression,H,e.isExpression),e.visitNodes(t.statements,U,e.isStatement))}(n);case 258:case 224:return function(n){return e.visitEachChild(n,U,t)}(n);case 260:return function(t){var n=m;return m=t,t=e.updateCatchClause(t,t.variableDeclaration,e.visitNode(t.block,U,e.isBlock)),m=n,t}(n);case 207:return function(n){var r=m;return m=n,n=e.visitEachChild(n,U,t),m=r,n}(n);case 290:return function(t){if(N(t)&&208===t.original.kind){var n=e.getOriginalNodeId(t),r=e.hasModifier(t.original,1);y[n]=R(y[n],t.original,r)}return t}(n);case 291:return function(t){var n=e.getOriginalNodeId(t),r=y[n];return r?(delete y[n],e.append(r,t)):t}(n);default:return H(n)}}function V(n){if(!n)return n;if(function(t){return e.isVariableDeclarationList(t)&&S(t)}(n)){for(var r=void 0,i=0,s=n.declarations;i<s.length;i++){var o=s[i];r=e.append(r,C(o,!1)),o.initializer||x(o)}return r?e.inlineExpressions(r):e.createOmittedExpression()}return e.visitEachChild(n,U,t)}function H(n){return 1024&n.transformFlags&&194===n.kind?function(n){if(G(n.left))return e.flattenDestructuringAssignment(n,H,t,0,!0);return e.visitEachChild(n,H,t)}(n):e.isImportCall(n)?function(t){return e.createCall(e.createPropertyAccess(h,e.createIdentifier("import")),void 0,e.some(t.arguments)?[e.visitNode(t.arguments[0],H)]:[])}(n):2048&n.transformFlags||67108864&n.transformFlags?e.visitEachChild(n,H,t):n}function G(t){if(e.isAssignmentExpression(t,!0))return G(t.left);if(e.isSpreadElement(t))return G(t.expression);if(e.isObjectLiteralExpression(t))return e.some(t.properties,G);if(e.isArrayLiteralExpression(t))return e.some(t.elements,G);if(e.isShorthandPropertyAssignment(t))return G(t.name);if(e.isPropertyAssignment(t))return G(t.initializer);if(e.isIdentifier(t)){var n=o.getReferencedExportContainer(t);return void 0!==n&&265===n.kind}return!1}function j(e){switch(e.kind){case 84:case 79:return}return e}function K(t){var n;if(!e.isGeneratedIdentifier(t)){var r=o.getReferencedImportDeclaration(t)||o.getReferencedValueDeclaration(t);if(r){var i=o.getReferencedExportContainer(t,!1);i&&265===i.kind&&(n=e.append(n,e.getDeclarationName(r))),n=e.addRange(n,d&&d.exportedBindings[e.getOriginalNodeId(r)])}}return n}function W(t){return void 0===_&&(_=[]),_[e.getNodeId(t)]=!0,t}}}(ts||(ts={})),function(e){e.transformES2015Module=function(t){var n,r=t.getCompilerOptions(),i=t.onEmitNode,s=t.onSubstituteNode;return t.onEmitNode=function(t,r,s){e.isSourceFile(r)?(n=r,i(t,r,s),n=void 0):i(t,r,s)},t.onSubstituteNode=function(t,r){if(r=s(t,r),e.isIdentifier(r)&&1===t)return function(t){if(4096&e.getEmitFlags(t)){var r=e.getExternalHelpersModuleName(n);if(r)return e.createPropertyAccess(r,t)}return t}(r);return r},t.enableEmitNotification(265),t.enableSubstitution(71),function(n){if(n.isDeclarationFile)return n;if(e.isExternalModule(n)||r.isolatedModules){var i=e.getOrCreateExternalHelpersModuleNameIfNeeded(n,r);if(i){var s=[],a=e.addPrologue(s,n.statements);return e.append(s,e.createImportDeclaration(void 0,void 0,e.createImportClause(void 0,e.createNamespaceImport(i)),e.createLiteral(e.externalHelpersModuleNameText))),e.addRange(s,e.visitNodes(n.statements,o,e.isStatement,a)),e.updateSourceFileNode(n,e.setTextRange(e.createNodeArray(s),n.statements))}return e.visitEachChild(n,o,t)}return n};function o(e){switch(e.kind){case 237:return;case 243:return function(e){return e.isExportEquals?void 0:e}(e)}return e}}}(ts||(ts={})),function(e){var t,n;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",e[e.Completed=2]="Completed",e[e.Disposed=3]="Disposed"}(t||(t={})),function(e){e[e.Substitution=1]="Substitution",e[e.EmitNotifications=2]="EmitNotifications"}(n||(n={})),e.getTransformers=function(t,n){var r=t.jsx,i=e.getEmitScriptTarget(t),s=e.getEmitModuleKind(t),o=[];return e.addRange(o,n&&n.before),o.push(e.transformTypeScript),2===r&&o.push(e.transformJsx),i<5&&o.push(e.transformESNext),i<4&&o.push(e.transformES2017),i<3&&o.push(e.transformES2016),i<2&&(o.push(e.transformES2015),o.push(e.transformGenerators)),o.push(function(t){switch(t){case e.ModuleKind.ESNext:case e.ModuleKind.ES2015:return e.transformES2015Module;case e.ModuleKind.System:return e.transformSystemModule;default:return e.transformModule}}(s)),i<1&&o.push(e.transformES5),e.addRange(o,n&&n.after),o},e.transformNodes=function(t,n,r,i,s,o){for(var a,l,c,u=new Array(292),d=[],p=[],h=0,f=!1,m=function(e,t){return t},_=function(e,t,n){return n(e,t)},g=0,y={getCompilerOptions:function(){return r},getEmitResolver:function(){return t},getEmitHost:function(){return n},startLexicalEnvironment:function(){e.Debug.assert(g>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(g<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(!f,"Lexical environment is suspended."),d[h]=a,p[h]=l,h++,a=void 0,l=void 0},suspendLexicalEnvironment:function(){e.Debug.assert(g>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(g<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(!f,"Lexical environment is already suspended."),f=!0},resumeLexicalEnvironment:function(){e.Debug.assert(g>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(g<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(f,"Lexical environment is not suspended."),f=!1},endLexicalEnvironment:function(){var t;if(e.Debug.assert(g>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(g<2,"Cannot modify the lexical environment after transformation has completed."),e.Debug.assert(!f,"Lexical environment is suspended."),(a||l)&&(l&&(t=l.slice()),a)){var n=e.createVariableStatement(void 0,e.createVariableDeclarationList(a));t?t.push(n):t=[n]}h--,a=d[h],l=p[h],0===h&&(d=[],p=[]);return t},hoistVariableDeclaration:function(t){e.Debug.assert(g>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(g<2,"Cannot modify the lexical environment after transformation has completed.");var n=e.setEmitFlags(e.createVariableDeclaration(t),64);a?a.push(n):a=[n]},hoistFunctionDeclaration:function(t){e.Debug.assert(g>0,"Cannot modify the lexical environment during initialization."),e.Debug.assert(g<2,"Cannot modify the lexical environment after transformation has completed."),l?l.push(t):l=[t]},requestEmitHelper:function(t){e.Debug.assert(g>0,"Cannot modify the transformation context during initialization."),e.Debug.assert(g<2,"Cannot modify the transformation context after transformation has completed."),e.Debug.assert(!t.scoped,"Cannot request a scoped emit helper."),c=e.append(c,t)},readEmitHelpers:function(){e.Debug.assert(g>0,"Cannot modify the transformation context during initialization."),e.Debug.assert(g<2,"Cannot modify the transformation context after transformation has completed.");var t=c;return c=void 0,t},enableSubstitution:function(t){e.Debug.assert(g<2,"Cannot modify the transformation context after transformation has completed."),u[t]|=1},enableEmitNotification:function(t){e.Debug.assert(g<2,"Cannot modify the transformation context after transformation has completed."),u[t]|=2},isSubstitutionEnabled:x,isEmitNotificationEnabled:S,get onSubstituteNode(){return m},set onSubstituteNode(t){e.Debug.assert(g<1,"Cannot modify transformation hooks after initialization has completed."),e.Debug.assert(void 0!==t,"Value must not be 'undefined'"),m=t},get onEmitNode(){return _},set onEmitNode(t){e.Debug.assert(g<1,"Cannot modify transformation hooks after initialization has completed."),e.Debug.assert(void 0!==t,"Value must not be 'undefined'"),_=t}},b=0,v=i;b<v.length;b++){var T=v[b];e.disposeEmitNodes(e.getSourceFileOfNode(e.getParseTreeNode(T)))}e.performance.mark("beforeTransform");var k=e.chain.apply(void 0,s)(y);g=1;var E=e.map(i,o?k:function(t){return!t||e.isSourceFile(t)&&t.isDeclarationFile?t:k(t)});return g=2,e.performance.mark("afterTransform"),e.performance.measure("transformTime","beforeTransform","afterTransform"),{transformed:E,substituteNode:function(t,n){return e.Debug.assert(g<3,"Cannot substitute a node after the result is disposed."),n&&x(n)&&m(t,n)||n},emitNodeWithNotification:function(t,n,r){e.Debug.assert(g<3,"Cannot invoke TransformationResult callbacks after the result is disposed."),n&&(S(n)?_(t,n,r):r(t,n))},dispose:function(){if(g<3){for(var t=0,n=i;t<n.length;t++){var r=n[t];e.disposeEmitNodes(e.getSourceFileOfNode(e.getParseTreeNode(r)))}a=void 0,d=void 0,l=void 0,p=void 0,m=void 0,_=void 0,c=void 0,g=3}}};function x(t){return 0!=(1&u[t.kind])&&0==(4&e.getEmitFlags(t))}function S(t){return 0!=(2&u[t.kind])||0!=(2&e.getEmitFlags(t))}}}(ts||(ts={})),function(e){var t={emittedLine:1,emittedColumn:1,sourceLine:1,sourceColumn:1,sourceIndex:0};e.createSourceMapWriter=function(n,i){var s,o,a,l,c,u,d,p,h=n.getCompilerOptions(),f=h.extendedDiagnostics,m=!(h.sourceMap||h.inlineSourceMap);return{initialize:function(r,i,f){if(m)return;p&&g();s=void 0,o=void 0,l=-1,c=void 0,u=t,d=0,(p={sourceMapFilePath:i,jsSourceMappingURL:h.inlineSourceMap?void 0:e.getBaseFileName(e.normalizeSlashes(i)),sourceMapFile:e.getBaseFileName(e.normalizeSlashes(r)),sourceMapSourceRoot:h.sourceRoot||"",sourceMapSources:[],inputSourceFileNames:[],sourceMapNames:[],sourceMapMappings:"",sourceMapSourcesContent:h.inlineSources?[]:void 0,sourceMapDecodedMappings:[]}).sourceMapSourceRoot=e.normalizeSlashes(p.sourceMapSourceRoot),p.sourceMapSourceRoot.length&&47!==p.sourceMapSourceRoot.charCodeAt(p.sourceMapSourceRoot.length-1)&&(p.sourceMapSourceRoot+=e.directorySeparator);h.mapRoot?(a=e.normalizeSlashes(h.mapRoot),265===f.kind&&(a=e.getDirectoryPath(e.getSourceFilePathInNewDir(f,n,a))),e.isRootedDiskPath(a)||e.isUrl(a)?p.jsSourceMappingURL=e.combinePaths(a,p.jsSourceMappingURL):(a=e.combinePaths(n.getCommonSourceDirectory(),a),p.jsSourceMappingURL=e.getRelativePathToDirectoryOrUrl(e.getDirectoryPath(e.normalizePath(r)),e.combinePaths(a,p.jsSourceMappingURL),n.getCurrentDirectory(),n.getCanonicalFileName,!0))):a=e.getDirectoryPath(e.normalizePath(r))},reset:g,getSourceMapData:function(){return p},setSourceFile:v,emitPos:b,emitNodeWithSourceMap:function(e,t,n){if(m)return n(e,t);if(t){var r=t.emitNode,i=r&&r.flags,o=r&&r.sourceMapRange,a=o||t,l=a.pos,c=a.end,u=o&&o.source,d=s;u===d&&(u=void 0),u&&v(u),287!==t.kind&&0==(16&i)&&l>=0&&b(_(l)),u&&v(d),64&i?(m=!0,n(e,t),m=!1):n(e,t),u&&v(u),287!==t.kind&&0==(32&i)&&c>=0&&b(c),u&&v(d)}},emitTokenWithSourceMap:function(e,t,n,r){if(m)return r(t,n);var i=e&&e.emitNode,s=i&&i.flags,o=i&&i.tokenSourceMapRanges&&i.tokenSourceMapRanges[t];n=_(o?o.pos:n),0==(128&s)&&n>=0&&b(n);n=r(t,n),o&&(n=o.end);0==(256&s)&&n>=0&&b(n);return n},getText:T,getSourceMappingURL:function(){if(m)return;if(h.inlineSourceMap){var t=e.convertToBase64(T());return p.jsSourceMappingURL="data:application/json;base64,"+t}return p.jsSourceMappingURL}};function _(t){return s.skipTrivia?s.skipTrivia(t):e.skipTrivia(o,t)}function g(){m||(s=void 0,a=void 0,l=void 0,c=void 0,u=void 0,d=void 0,p=void 0)}function y(){if(c&&c!==u){var t=u.emittedColumn;if(u.emittedLine===c.emittedLine)p.sourceMapMappings&&(p.sourceMapMappings+=",");else{for(var n=u.emittedLine;n<c.emittedLine;n++)p.sourceMapMappings+=";";t=1}p.sourceMapMappings+=r(c.emittedColumn-t),p.sourceMapMappings+=r(c.sourceIndex-u.sourceIndex),p.sourceMapMappings+=r(c.sourceLine-u.sourceLine),p.sourceMapMappings+=r(c.sourceColumn-u.sourceColumn),c.nameIndex>=0&&(e.Debug.assert(!1,"We do not support name index right now, Make sure to update updateLastEncodedAndRecordedSpans when we start using this"),p.sourceMapMappings+=r(c.nameIndex-d),d=c.nameIndex),u=c,p.sourceMapDecodedMappings.push(u)}}function b(t){if(!m&&!e.positionIsSynthesized(t)){f&&e.performance.mark("beforeSourcemap");var n=e.getLineAndCharacterOfPosition(s,t);n.line++,n.character++;var r=i.getLine(),o=i.getColumn();!c||c.emittedLine!==r||c.emittedColumn!==o||c.sourceIndex===l&&(c.sourceLine>n.line||c.sourceLine===n.line&&c.sourceColumn>n.character)?(y(),c={emittedLine:r,emittedColumn:o,sourceLine:n.line,sourceColumn:n.character,sourceIndex:l}):(c.sourceLine=n.line,c.sourceColumn=n.character,c.sourceIndex=l),f&&(e.performance.mark("afterSourcemap"),e.performance.measure("Source Map","beforeSourcemap","afterSourcemap"))}}function v(t){if(!m){o=(s=t).text;var r=h.sourceRoot?n.getCommonSourceDirectory():a,i=e.getRelativePathToDirectoryOrUrl(r,s.fileName,n.getCurrentDirectory(),n.getCanonicalFileName,!0);-1===(l=e.indexOf(p.sourceMapSources,i))&&(l=p.sourceMapSources.length,p.sourceMapSources.push(i),p.inputSourceFileNames.push(s.fileName),h.inlineSources&&p.sourceMapSourcesContent.push(s.text))}}function T(){if(!m)return y(),JSON.stringify({version:3,file:p.sourceMapFile,sourceRoot:p.sourceMapSourceRoot,sources:p.sourceMapSources,names:p.sourceMapNames,mappings:p.sourceMapMappings,sourcesContent:p.sourceMapSourcesContent})}};function n(e){if(e<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e);throw TypeError(e+": not a 64 based value")}function r(e){e<0?e=1+(-e<<1):e<<=1;var t="";do{var r=31&e;(e>>=5)>0&&(r|=32),t+=n(r)}while(e>0);return t}}(ts||(ts={})),function(e){e.createCommentWriter=function(t,n){var r,i,s,o,a,l=t.extendedDiagnostics,c=e.getNewLineCharacter(t),u=-1,d=-1,p=-1,h=!1,f=t.removeComments;return{reset:function(){i=void 0,s=void 0,o=void 0,a=void 0},setWriter:function(e){r=e},setSourceFile:function(t){s=(i=t).text,o=e.getLineStarts(i),a=void 0},emitNodeWithComments:function(t,n,r){if(f)return void r(t,n);if(n){h=!1;var i=n.emitNode,s=i&&i.flags,o=i&&i.commentRange||n,a=o.pos,c=o.end;if(a<0&&c<0||a===c)m(t,n,i,s,r);else{l&&e.performance.mark("preEmitNodeWithComment");var _=287!==n.kind,g=a<0||0!=(512&s)||10===n.kind,y=c<0||0!=(1024&s)||10===n.kind;g||b(a,_);var v=u,T=d,E=p;g||(u=a),y||(d=c,227===n.kind&&(p=c)),l&&e.performance.measure("commentTime","preEmitNodeWithComment"),m(t,n,i,s,r),l&&e.performance.mark("postEmitNodeWithComment"),u=v,d=T,p=E,!y&&_&&function(e){S(e,k)}(c),l&&e.performance.measure("commentTime","postEmitNodeWithComment")}}},emitBodyWithDetachedComments:function(t,n,i){l&&e.performance.mark("preEmitBodyWithDetachedComments");var u=n.pos,d=n.end,p=e.getEmitFlags(t),m=f||d<0||0!=(1024&p);u<0||0!=(512&p)||(_=n,(g=e.emitDetachedComments(s,o,r,C,_,c,f))&&(a?a.push(g):a=[g]));var _,g;l&&e.performance.measure("commentTime","preEmitBodyWithDetachedComments");2048&p&&!f?(f=!0,i(t),f=!1):i(t);l&&e.performance.mark("beginEmitBodyWithDetachedCommetns");m||(b(n.end,!0),h&&!r.isAtStartOfLine()&&r.writeLine());l&&e.performance.measure("commentTime","beginEmitBodyWithDetachedCommetns")},emitTrailingCommentsOfPosition:function(t,n){if(f)return;l&&e.performance.mark("beforeEmitTrailingCommentsOfPosition");S(t,n?k:E),l&&e.performance.measure("commentTime","beforeEmitTrailingCommentsOfPosition")},emitLeadingCommentsOfPosition:function(e){if(f||-1===e)return;b(e,!0)}};function m(t,n,r,i,s){var o=r&&r.leadingComments;e.some(o)&&(l&&e.performance.mark("preEmitNodeWithSynthesizedComments"),e.forEach(o,_),l&&e.performance.measure("commentTime","preEmitNodeWithSynthesizedComments")),function(e,t,n,r){2048&n?(f=!0,r(e,t),f=!1):r(e,t)}(t,n,i,s);var a=r&&r.trailingComments;e.some(a)&&(l&&e.performance.mark("postEmitNodeWithSynthesizedComments"),e.forEach(a,g),l&&e.performance.measure("commentTime","postEmitNodeWithSynthesizedComments"))}function _(e){2===e.kind&&r.writeLine(),y(e),e.hasTrailingNewLine||2===e.kind?r.writeLine():r.write(" ")}function g(e){r.isAtStartOfLine()||r.write(" "),y(e),e.hasTrailingNewLine&&r.writeLine()}function y(t){var n=function(e){return 3===e.kind?"/*"+e.text+"*/":"//"+e.text}(t),i=3===t.kind?e.computeLineStarts(n):void 0;e.writeCommentRange(n,i,r,0,n.length,c)}function b(e,t){h=!1,t?x(e,T):0===e&&x(e,v)}function v(t,n,r,i,o){(function(t,n){return e.isRecognizedTripleSlashComment(s,t,n)})(t,n)&&T(t,n,r,i,o)}function T(t,i,a,l,u){h||(e.emitNewLineBeforeLeadingCommentOfPosition(o,r,u,t),h=!0),n&&n(t),e.writeCommentRange(s,o,r,t,i,c),n&&n(i),l?r.writeLine():r.write(" ")}function k(t,i,a,l){r.isAtStartOfLine()||r.write(" "),n&&n(t),e.writeCommentRange(s,o,r,t,i,c),n&&n(i),l&&r.writeLine()}function E(t,i,a,l){n&&n(t),e.writeCommentRange(s,o,r,t,i,c),n&&n(i),l?r.writeLine():r.write(" ")}function x(t,n){-1!==u&&t===u||(function(t){return void 0!==a&&e.lastOrUndefined(a).nodePos===t}(t)?function(t){var n=e.lastOrUndefined(a).detachedCommentEndPos;a.length-1?a.pop():a=void 0;e.forEachLeadingCommentRange(s,n,t,n)}(n):e.forEachLeadingCommentRange(s,t,n,t))}function S(t,n){(-1===d||t!==d&&t!==p)&&e.forEachTrailingCommentRange(s,t,n)}function C(t,r,i,s,o,a){n&&n(s),e.writeCommentRange(t,r,i,s,o,a),n&&n(o)}}}(ts||(ts={})),function(e){function t(t,n,r,i,s,o){var a,l,c,u,d,p,h,f,m,_,g,y,b=266===s.kind?s.sourceFiles:[s],v=266===s.kind,T=t.getNewLine(),k=t.getCompilerOptions();M();var E,x,S,C=!1,I=k.removeComments?e.noop:function(t){if(t){var n=e.getJSDocCommentRanges(t,m);e.emitNewLineBeforeLeadingComments(_,p,t,n),e.emitComments(m,_,p,n,!1,!0,T,e.writeCommentRange)}},A=k.stripInternal?function(t){if(t){var n=e.getLeadingCommentRanges(m,t.pos);if(e.forEach(n,P))return;ge(t)}}:ge,w=!0,N=[],D="",O=[],R=!1,L=[];return e.forEach(b,(function(n){if(!e.isSourceFileJavaScript(n)){if(k.noResolve||e.forEach(n.referencedFiles,(function(r){var s=e.tryResolveScriptReference(t,n,r);s&&!e.contains(O,s)&&(function(n,r,s){var o,a=!1;n.isDeclarationFile?o=n.fileName:e.forEachEmittedFile(t,l,n,s);o&&(o=e.getRelativePathToDirectoryOrUrl(e.getDirectoryPath(e.normalizeSlashes(i)),o,t.getCurrentDirectory(),t.getCanonicalFileName,!1),D+='/// <reference path="'+o+'" />'+T);return a;function l(t,i){var s=266===i.kind;s&&!r||(e.Debug.assert(!!t.declarationFilePath||e.isSourceFileJavaScript(n),"Declaration file is not present only for javascript files"),o=t.declarationFilePath||t.jsFilePath,a=s)}}(s,!v&&!R,o)&&(R=!0),O.push(s))})),f=!1,v&&e.isExternalModule(n)?e.isExternalModule(n)&&(w=!1,a('declare module "'+e.getResolvedExternalModuleName(t,n)+'" {'),l(),c(),Y(n),u(),a("}"),l()):(w=!0,Y(n)),N.length){var r=p;e.forEach(N,(function(t){if(t.isVisible&&!t.asynchronousOutput){e.Debug.assert(238===t.node.kind),M(),e.Debug.assert(0===t.indent||1===t.indent&&v);for(var n=0;n<t.indent;n++)c();re(t.node),t.asynchronousOutput=p.getText();for(n=0;n<t.indent;n++)u()}})),F(r),L=L.concat(N),N=[]}!v&&e.isExternalModule(n)&&n.moduleAugmentations.length&&!f&&(a("export {};"),l())}})),S&&e.forEachKey(S,(function(e){D+='/// <reference types="'+e+'" />'+T})),{reportedDeclarationError:C,moduleElementDeclarationEmitInfo:L,synchronousDeclarationOutput:p.getText(),referencesOutput:D};function P(t){var n=m.substring(t.pos,t.end);return e.stringContains(n,"@internal")}function M(){var t=e.createTextWriter(T);t.trackSymbol=V,t.reportInaccessibleThisError=G,t.reportPrivateInBaseOfClassExpression=H,t.writeKeyword=t.write,t.writeOperator=t.write,t.writePunctuation=t.write,t.writeSpace=t.write,t.writeStringLiteral=t.writeLiteral,t.writeParameter=t.write,t.writeProperty=t.write,t.writeSymbol=t.write,F(t)}function F(e){p=e,a=e.write,d=e.writeTextOfNode,l=e.writeLine,c=e.increaseIndent,u=e.decreaseIndent}function $(t){var n=p;e.forEach(t,(function(t){var n;226===t.kind?n=t.parent.parent:241===t.kind||242===t.kind||239===t.kind?e.Debug.fail("We should be getting ImportDeclaration instead to write"):n=t;var r=e.forEach(N,(function(e){return e.node===n?e:void 0}));if(!r&&x&&(r=e.forEach(x,(function(e){return e.node===n?e:void 0}))),r)if(238===r.node.kind)r.isVisible=!0;else{M();for(var i=r.indent;i;i--)c();233===n.kind&&(e.Debug.assert(void 0===x),x=[]),Z(n),233===n.kind&&(r.subModuleElementDeclarationEmitInfo=x,x=void 0),r.asynchronousOutput=p.getText()}})),F(n)}function B(t){if(t){S||(S=e.createMap());for(var n=0,r=t;n<r.length;n++){var i=r[n];S.has(i)||S.set(i,i)}}}function U(t){if(0===t.accessibility)t&&t.aliasesToMakeVisible&&$(t.aliasesToMakeVisible);else{C=!0;var n=p.getSymbolAccessibilityDiagnostic(t);n&&(n.typeName?r.add(e.createDiagnosticForNode(t.errorNode||n.errorNode,n.diagnosticMessage,e.getTextOfNodeFromSourceText(m,n.typeName),t.errorSymbolName,t.errorModuleName)):r.add(e.createDiagnosticForNode(t.errorNode||n.errorNode,n.diagnosticMessage,t.errorSymbolName,t.errorModuleName)))}}function V(e,t,r){U(n.isSymbolAccessible(e,t,r,!0)),B(n.getTypeReferenceDirectivesForSymbol(e,r))}function H(t){E&&(C=!0,r.add(e.createDiagnosticForNode(E,e.Diagnostics.Property_0_of_exported_class_expression_may_not_be_private_or_protected,t)))}function G(){E&&(C=!0,r.add(e.createDiagnosticForNode(E,e.Diagnostics.The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary,e.declarationNameToString(E))))}function j(e,t,r){p.getSymbolAccessibilityDiagnostic=r,a(": ");var i=146===e.kind&&(n.isRequiredInitializedParameter(e)||n.isOptionalUninitializedParameterProperty(e));if(t&&!i)J(t);else{E=e.name;var s=16388|(i?8192:0);n.writeTypeOfDeclaration(e,h,s,p),E=void 0}}function K(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];A(r)}}function W(e,t,n,r){for(var i=p.getTextPos(),s=0,o=e;s<o.length;s++){var l=o[s];r&&!r(l)||(i!==p.getTextPos()&&a(t),i=p.getTextPos(),n(l))}}function z(e,t,n){W(e,", ",t,n)}function q(e,t){p.getSymbolAccessibilityDiagnostic=t,J(e)}function J(t){switch(t.kind){case 119:case 136:case 133:case 122:case 134:case 137:case 105:case 139:case 95:case 130:case 169:case 173:return d(m,t);case 201:return r=t,void(e.isEntityNameExpression(r.expression)&&(e.Debug.assert(71===r.expression.kind||179===r.expression.kind),s(r.expression),r.typeArguments&&(a("<"),z(r.typeArguments,J),a(">"))));case 159:return function(e){s(e.typeName),e.typeArguments&&(a("<"),z(e.typeArguments,J),a(">"))}(t);case 162:return function(e){a("typeof "),s(e.exprName)}(t);case 164:return function(e){J(e.elementType),a("[]")}(t);case 165:return function(e){a("["),z(e.elementTypes,J),a("]")}(t);case 166:return function(e){W(e.types," | ",J)}(t);case 167:return function(e){W(e.types," & ",J)}(t);case 168:return function(e){a("("),J(e.type),a(")")}(t);case 170:return function(t){a(e.tokenToString(t.operator)),a(" "),J(t.type)}(t);case 171:return function(e){J(e.objectType),a("["),J(e.indexType),a("]")}(t);case 172:return function(e){var t=h;h=e,a("{"),l(),c(),e.readonlyToken&&a("readonly ");a("["),i(e.typeParameter.name),a(" in "),J(e.typeParameter.constraint),a("]"),e.questionToken&&a("?");a(": "),J(e.type),a(";"),l(),u(),a("}"),h=t}(t);case 160:case 161:return fe(t);case 163:return function(e){a("{"),e.members.length&&(l(),c(),K(e.members),u());a("}")}(t);case 71:case 143:return s(t);case 158:return function(e){d(m,e.parameterName),a(" is "),J(e.type)}(t)}var r;function i(e){if(71===e.kind)d(m,e);else{var t=143===e.kind?e.left:e.expression,n=143===e.kind?e.right:e.name;i(t),a("."),d(m,n)}}function s(e){U(n.isEntityNameVisible(e,237===e.parent.kind?e.parent:h)),B(n.getTypeReferenceDirectivesForEntityName(e)),i(e)}}function Y(t){m=t.text,_=e.getLineStarts(t),g=t.identifiers,y=e.isExternalModule(t),h=t,e.emitDetachedComments(m,_,p,e.writeCommentRange,t,T,!0),K(t.statements)}function X(e,t,r,i){var s=function(e){if(!g.has(e))return e;for(var t=0;;){var n=e+"_"+ ++t;if(!g.has(n))return n}}(t);return i&&a("declare "),a("const "),a(s),a(": "),p.getSymbolAccessibilityDiagnostic=function(){return r},n.writeTypeOfExpression(e,h,16388,p),a(";"),l(),s}function Q(e,t){if(t)Z(e);else if(237===e.kind||265===e.parent.kind&&y){var r=void 0;if(x&&265!==e.parent.kind)x.push({node:e,outputPos:p.getTextPos(),indent:p.getIndent(),isVisible:r});else{if(238===e.kind){var i=e;i.importClause&&(r=i.importClause.name&&n.isDeclarationVisible(i.importClause)||ne(i.importClause.namedBindings))}N.push({node:e,outputPos:p.getTextPos(),indent:p.getIndent(),isVisible:r})}}}function Z(t){switch(t.kind){case 228:return he(t);case 208:return function(t){if(e.every(t.declarationList&&t.declarationList.declarations,(function(t){return t.name&&e.isEmptyBindingPattern(t.name)})))return;I(t),ee(t),e.isLet(t.declarationList)?a("let "):e.isConst(t.declarationList)?a("const "):a("var ");z(t.declarationList.declarations,de,n.isDeclarationVisible),a(";"),l()}(t);case 230:return function(t){I(t),ee(t),a("interface "),d(m,t.name);var n=h;h=t,le(t.typeParameters);var r=e.filter(e.getInterfaceBaseTypeNodes(t),(function(t){return e.isEntityNameExpression(t.expression)}));r&&r.length&&ce(r,!1);a(" {"),l(),c(),K(t.members),u(),a("}"),l(),h=n}(t);case 229:return function(t){function n(t){t&&e.forEach(t.parameters,(function(t){e.hasModifier(t,92)&&ue(t)}))}var r=h;h=t;var i,s=e.getClassExtendsHeritageClauseElement(t);s&&!e.isEntityNameExpression(s.expression)&&(i=95===s.expression.kind?"null":X(s.expression,t.name.escapedText+"_base",{diagnosticMessage:e.Diagnostics.extends_clause_of_exported_class_0_has_or_is_using_private_name_1,errorNode:s,typeName:t.name},!e.findAncestor(t,(function(e){return 233===e.kind}))));I(t),ee(t),e.hasModifier(t,128)&&a("abstract ");a("class "),d(m,t.name),le(t.typeParameters),s&&(e.isEntityNameExpression(s.expression)?ce([s],!1):(a(" extends "),a(i),s.typeArguments&&(a("<"),z(s.typeArguments,J),a(">"))));ce(e.getClassImplementsHeritageClauseElements(t),!0),a(" {"),l(),c(),n(e.getFirstConstructorWithBody(t)),K(t.members),u(),a("}"),l(),h=r}(t);case 231:return function(t){var n=h;function r(){return{diagnosticMessage:e.Diagnostics.Exported_type_alias_0_has_or_is_using_private_name_1,errorNode:t.type,typeName:t.name}}h=t,I(t),ee(t),a("type "),d(m,t.name),le(t.typeParameters),a(" = "),q(t.type,r),a(";"),l(),h=n}(t);case 232:return function(t){I(t),ee(t),e.isConst(t)&&a("const ");a("enum "),d(m,t.name),a(" {"),l(),c(),K(t.members),u(),a("}"),l()}(t);case 233:return function(t){I(t),ee(t),e.isGlobalScopeAugmentation(t)?a("global "):(16&t.flags?a("namespace "):a("module "),e.isExternalModuleAugmentation(t)?ie(t):d(m,t.name));for(;t.body&&234!==t.body.kind;)t=t.body,a("."),d(m,t.name);var n=h;t.body?(h=t,a(" {"),l(),c(),K(t.body.statements),u(),a("}"),l(),h=n):a(";")}(t);case 237:return function(t){I(t),e.hasModifier(t,1)&&a("export ");a("import "),d(m,t.name),a(" = "),e.isInternalModuleImportEqualsDeclaration(t)?(q(t.moduleReference,n),a(";")):(a("require("),ie(t),a(");"));function n(){return{diagnosticMessage:e.Diagnostics.Import_declaration_0_is_using_private_name_1,errorNode:t,typeName:t.name}}p.writeLine()}(t);case 238:return re(t);default:e.Debug.fail("Unknown symbol kind")}}function ee(t){if(265===t.parent.kind){var n=e.getModifierFlags(t);1&n&&a("export "),512&n?a("default "):230!==t.kind&&w&&a("declare ")}}function te(e){8&e?a("private "):16&e&&a("protected "),32&e&&a("static "),64&e&&a("readonly "),128&e&&a("abstract ")}function ne(t){if(t)return 240===t.kind?n.isDeclarationVisible(t):e.forEach(t.elements,(function(e){return n.isDeclarationVisible(e)}))}function re(t){if(I(t),e.hasModifier(t,1)&&a("export "),a("import "),t.importClause){var r=p.getTextPos();t.importClause.name&&n.isDeclarationVisible(t.importClause)&&d(m,t.importClause.name),t.importClause.namedBindings&&ne(t.importClause.namedBindings)&&(r!==p.getTextPos()&&a(", "),240===t.importClause.namedBindings.kind?(a("* as "),d(m,t.importClause.namedBindings.name)):(a("{ "),z(t.importClause.namedBindings.elements,se,n.isDeclarationVisible),a(" }"))),a(" from ")}ie(t),a(";"),p.writeLine()}function ie(r){var i;if(f=f||233!==r.kind,237===r.kind){var s=r;i=e.getExternalModuleImportEqualsDeclarationExpression(s)}else if(233===r.kind)i=r.name;else{i=(s=r).moduleSpecifier}if(9===i.kind&&v&&(k.out||k.outFile)){var o=e.getExternalModuleNameFromDeclaration(t,n,r);if(o)return a('"'),a(o),void a('"')}d(m,i)}function se(e){e.propertyName&&(d(m,e.propertyName),a(" as ")),d(m,e.name)}function oe(e){se(e),$(n.collectLinkedAliases(e.propertyName||e.name))}function ae(t){return 151===t.parent.kind&&e.hasModifier(t.parent,8)}function le(t){t&&(a("<"),z(t,(function(t){function n(){var n;switch(t.parent.kind){case 229:n=e.Diagnostics.Type_parameter_0_of_exported_class_has_or_is_using_private_name_1;break;case 230:n=e.Diagnostics.Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1;break;case 156:n=e.Diagnostics.Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1;break;case 155:n=e.Diagnostics.Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1;break;case 151:case 150:n=e.hasModifier(t.parent,32)?e.Diagnostics.Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:229===t.parent.parent.kind?e.Diagnostics.Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:e.Diagnostics.Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1;break;case 228:n=e.Diagnostics.Type_parameter_0_of_exported_function_has_or_is_using_private_name_1;break;case 231:n=e.Diagnostics.Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1;break;default:e.Debug.fail("This is unknown parent for type parameter: "+t.parent.kind)}return{diagnosticMessage:n,errorNode:t,typeName:t.name}}c(),I(t),u(),d(m,t.name),t.constraint&&!ae(t)&&(a(" extends "),160===t.parent.kind||161===t.parent.kind||t.parent.parent&&163===t.parent.parent.kind?(e.Debug.assert(151===t.parent.kind||150===t.parent.kind||160===t.parent.kind||161===t.parent.kind||155===t.parent.kind||156===t.parent.kind),J(t.constraint)):q(t.constraint,n)),t.default&&!ae(t)&&(a(" = "),160===t.parent.kind||161===t.parent.kind||t.parent.parent&&163===t.parent.parent.kind?(e.Debug.assert(151===t.parent.kind||150===t.parent.kind||160===t.parent.kind||161===t.parent.kind||155===t.parent.kind||156===t.parent.kind),J(t.default)):q(t.default,n))})),a(">"))}function ce(t,n){t&&(a(n?" implements ":" extends "),z(t,(function(t){e.isEntityNameExpression(t.expression)?q(t,r):n||95!==t.expression.kind||a("null");function r(){return{diagnosticMessage:229===t.parent.parent.kind?n?e.Diagnostics.Implements_clause_of_exported_class_0_has_or_is_using_private_name_1:e.Diagnostics.extends_clause_of_exported_class_0_has_or_is_using_private_name_1:e.Diagnostics.extends_clause_of_exported_interface_0_has_or_is_using_private_name_1,errorNode:t,typeName:e.getNameOfDeclaration(t.parent.parent)}}})))}function ue(t){e.hasDynamicName(t)||(I(t),te(e.getModifierFlags(t)),de(t),a(";"),l())}function de(t){function r(n){return 226===t.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Exported_variable_0_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Exported_variable_0_has_or_is_using_private_name_1:149===t.kind||148===t.kind||146===t.kind&&e.hasModifier(t.parent,8)?e.hasModifier(t,32)?n.errorModuleName?2===n.accessibility?e.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_private_name_1:229===t.parent.kind||146===t.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_private_name_1:n.errorModuleName?e.Diagnostics.Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Property_0_of_exported_interface_has_or_is_using_private_name_1:void 0}function i(e){for(var t=[],n=0,r=e.elements;n<r.length;n++){var i=r[n];200!==i.kind&&t.push(i)}z(t,s)}function s(t){t.name&&(e.isBindingPattern(t.name)?i(t.name):(d(m,t.name),j(t,void 0,(function(e){var n=r(e);return void 0!==n?{diagnosticMessage:n,errorNode:t,typeName:t.name}:void 0}))))}(226!==t.kind||n.isDeclarationVisible(t))&&(e.isBindingPattern(t.name)?i(t.name):(d(m,t.name),(149===t.kind||148===t.kind||146===t.kind&&!e.isParameterPropertyDeclaration(t))&&e.hasQuestionToken(t)&&a("?"),149!==t.kind&&148!==t.kind||163!==t.parent.kind?n.isLiteralConstDeclaration(t)?(a(" = "),n.writeLiteralConstValue(t,p)):e.hasModifier(t,8)||j(t,t.type,(function(e){var n=r(e);return void 0!==n?{diagnosticMessage:n,errorNode:t,typeName:t.name}:void 0})):pe(t)))}function pe(e){e.type&&(a(": "),J(e.type))}function he(t){e.hasDynamicName(t)||n.isImplementationOfOverload(t)||(I(t),228===t.kind?ee(t):151!==t.kind&&152!==t.kind||te(e.getModifierFlags(t)),228===t.kind?(a("function "),d(m,t.name)):152===t.kind?a("constructor"):(d(m,t.name),e.hasQuestionToken(t)&&a("?")),me(t))}function fe(e){I(e),me(e)}function me(t){var r=h;h=t;var i=!1;if(157===t.kind)te(e.getModifierFlags(t)),a("[");else{if(152===t.kind&&e.hasModifier(t,8))return a("();"),void l();if(156===t.kind||161===t.kind)a("new ");else if(160===t.kind){var s=p.getText();t.typeParameters&&"<"===s.charAt(s.length-1)&&(i=!0,a("("))}le(t.typeParameters),a("(")}z(t.parameters,_e),157===t.kind?a("]"):a(")");var o,c,u=160===t.kind||161===t.kind;u||163===t.parent.kind?t.type&&(a(u?" => ":": "),J(t.type)):152===t.kind||e.hasModifier(t,8)||(o=t,c=function(n){var r;switch(t.kind){case 156:r=n.errorModuleName?e.Diagnostics.Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 155:r=n.errorModuleName?e.Diagnostics.Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 157:r=n.errorModuleName?e.Diagnostics.Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 151:case 150:r=e.hasModifier(t,32)?n.errorModuleName?2===n.accessibility?e.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0:229===t.parent.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0:n.errorModuleName?e.Diagnostics.Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0;break;case 228:r=n.errorModuleName?2===n.accessibility?e.Diagnostics.Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_exported_function_has_or_is_using_private_name_0;break;default:e.Debug.fail("This is unknown kind for signature: "+t.kind)}return{diagnosticMessage:r,errorNode:t.name||t}},p.getSymbolAccessibilityDiagnostic=c,a(": "),o.type?J(o.type):(E=o.name,n.writeReturnTypeOfSignatureDeclaration(o,h,16388,p),E=void 0)),h=r,u?i&&a(")"):(a(";"),l())}function _e(t){function r(e){if(174===e.kind)a("{"),z(e.elements,i),a("}");else if(175===e.kind){a("[");var t=e.elements;z(t,i),t&&t.hasTrailingComma&&a(", "),a("]")}}function i(t){200===t.kind?a(" "):176===t.kind&&(t.propertyName&&(d(m,t.propertyName),a(": ")),t.name&&(e.isBindingPattern(t.name)?r(t.name):(e.Debug.assert(71===t.name.kind),t.dotDotDotToken&&a("..."),d(m,t.name))))}c(),I(t),t.dotDotDotToken&&a("..."),e.isBindingPattern(t.name)?r(t.name):d(m,t.name),n.isOptionalParameter(t)&&a("?"),u(),160===t.parent.kind||161===t.parent.kind||163===t.parent.parent.kind?pe(t):e.hasModifier(t.parent,8)||j(t,t.type,(function(n){var r=function(n){switch(t.parent.kind){case 152:return n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1;case 156:return n.errorModuleName?e.Diagnostics.Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1;case 155:return n.errorModuleName?e.Diagnostics.Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1;case 157:return n.errorModuleName?e.Diagnostics.Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1;case 151:case 150:return e.hasModifier(t.parent,32)?n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:229===t.parent.parent.kind?n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:n.errorModuleName?e.Diagnostics.Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1;case 228:return n.errorModuleName?2===n.accessibility?e.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:e.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_private_name_1;default:e.Debug.fail("This is unknown parent for parameter: "+t.parent.kind)}}(n);return void 0!==r?{diagnosticMessage:r,errorNode:t,typeName:t.name}:void 0}))}function ge(t){switch(t.kind){case 228:case 233:case 237:case 230:case 229:case 231:case 232:return Q(t,function(e){return n.isDeclarationVisible(e)}(t));case 208:return Q(t,function(t){return e.forEach(t.declarationList.declarations,(function(e){return n.isDeclarationVisible(e)}))}(t));case 238:return Q(t,!t.importClause);case 244:return function(e){I(e),a("export "),e.exportClause?(a("{ "),z(e.exportClause.elements,oe),a(" }")):a("*"),e.moduleSpecifier&&(a(" from "),ie(e)),a(";"),p.writeLine()}(t);case 152:case 151:case 150:return he(t);case 156:case 155:case 157:return fe(t);case 153:case 154:return function(t){if(!e.hasDynamicName(t)){var n,r=e.getAllAccessorDeclarations(t.parent.members,t);if(t===r.firstAccessor){if(I(r.getAccessor),I(r.setAccessor),te(e.getModifierFlags(t)|(r.setAccessor?0:64)),d(m,t.name),!e.hasModifier(t,8)){n=t;var i=o(t);if(!i){var s=153===t.kind?r.setAccessor:r.getAccessor;(i=o(s))&&(n=s)}j(t,i,(function(t){return 154===n.kind?{diagnosticMessage:e.hasModifier(n.parent,32)?t.errorModuleName?e.Diagnostics.Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1:t.errorModuleName?e.Diagnostics.Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:e.Diagnostics.Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1,errorNode:n.parameters[0],typeName:n.name}:{diagnosticMessage:e.hasModifier(n,32)?t.errorModuleName?2===t.accessibility?e.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0:t.errorModuleName?2===t.accessibility?e.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:e.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:e.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0,errorNode:n.name,typeName:void 0}}))}a(";"),l()}}function o(e){if(e)return 153===e.kind?e.type:e.parameters.length>0?e.parameters[0].type:void 0}}(t);case 149:case 148:return ue(t);case 264:return function(t){I(t),d(m,t.name);var r=n.getConstantValue(t);void 0!==r&&(a(" = "),a(e.getTextOfConstantValue(r))),a(","),l()}(t);case 243:return function(t){if(71===t.expression.kind)a(t.isExportEquals?"export = ":"export default "),d(m,t.expression);else{var r=X(t.expression,"_default",{diagnosticMessage:e.Diagnostics.Default_export_of_the_module_has_or_is_using_private_name_0,errorNode:t},w);a(t.isExportEquals?"export = ":"export default "),a(r)}a(";"),l(),71===t.expression.kind&&$(n.collectLinkedAliases(t.expression))}(t);case 265:return Y(t)}}}e.getDeclarationDiagnostics=function(n,r,i){var s=e.createDiagnosticCollection();return e.forEachEmittedFile(n,(function(e,i){var o=e.declarationFilePath;t(n,r,s,o,i,!1)}),i),s.getDiagnostics(i?i.fileName:void 0)},e.writeDeclarationFile=function(n,r,i,s,o,a){var l=t(i,s,o,n,r,a),c=l.reportedDeclarationError||i.isEmitBlocked(n)||i.getCompilerOptions().noEmit;if(!c){var u=266===r.kind?r.sourceFiles:[r],d=l.referencesOutput+function t(n,r){var i=0,s="";return e.forEach(r,(function(e){e.asynchronousOutput&&(s+=n.substring(i,e.outputPos),s+=t(e.asynchronousOutput,e.subModuleElementDeclarationEmitInfo),i=e.outputPos)})),s+=n.substring(i)}(l.synchronousDeclarationOutput,l.moduleElementDeclarationEmitInfo);e.writeFile(i,o,n,d,i.getCompilerOptions().emitBOM,u)}return c}}(ts||(ts={})),function(e){var t,n,r=function(){var e=[];return e[0]="",e[16]=",",e[4]=" |",e[8]=" &",e}(),i=function(){var e=[];return e[512]=["{","}"],e[1024]=["(",")"],e[2048]=["<",">"],e[4096]=["[","]"],e}();function s(t,n,r,i){var s=e.isArray(r)?r:e.getSourceFilesToEmit(t,r),l=t.getCompilerOptions();if(l.outFile||l.out)s.length&&n({jsFilePath:d=l.outFile||l.out,sourceMapFilePath:o(d,l),declarationFilePath:l.declaration?e.removeFileExtension(d)+".d.ts":""},e.createBundle(s),i);else for(var c=0,u=s;c<u.length;c++){var d,p=u[c];n({jsFilePath:d=e.getOwnEmitOutputFilePath(p,t,a(p,l)),sourceMapFilePath:o(d,l),declarationFilePath:e.isSourceFileJavaScript(p)||!i&&!l.declaration?void 0:e.getDeclarationEmitOutputFilePath(p,t)},p,i)}}function o(e,t){return t.sourceMap?e+".map":void 0}function a(t,n){if(1===n.jsx)if(e.isSourceFileJavaScript(t)){if(e.fileExtensionIs(t.fileName,".jsx"))return".jsx"}else if(1===t.languageVariant)return".jsx";return".js"}function l(t,n){void 0===t&&(t={}),void 0===n&&(n={});var s,o,a,l,c,u,d,p,h=n.hasGlobalName,f=n.onEmitSourceMapOfNode,m=n.onEmitSourceMapOfToken,_=n.onEmitSourceMapOfPosition,g=n.onEmitNode,y=n.onEmitHelpers,b=n.onSetSourceFile,v=n.substituteNode,T=n.onBeforeEmitNodeArray,k=n.onAfterEmitNodeArray,E=n.onBeforeEmitToken,x=n.onAfterEmitToken,S=e.getNewLineCharacter(t),C=e.createCommentWriter(t,_),I=C.emitNodeWithComments,A=C.emitBodyWithDetachedComments,w=C.emitTrailingCommentsOfPosition,N=C.emitLeadingCommentsOfPosition;return V(),{printNode:function(t,n,r){switch(t){case 0:e.Debug.assert(e.isSourceFile(n),"Expected a SourceFile node.");break;case 2:e.Debug.assert(e.isIdentifier(n),"Expected an Identifier node.");break;case 1:e.Debug.assert(e.isExpression(n),"Expected an Expression node.")}switch(n.kind){case 265:return O(n);case 266:return D(n)}return R(t,n,r,M()),F()},printFile:O,printBundle:D,writeNode:R,writeFile:P,writeBundle:L};function D(e){return L(e,M()),F()}function O(e){return P(e,M()),F()}function R(e,t,n,r){var i=d;U(r),$(e,t,n),V(),d=i}function L(e,t){var n=d;U(t),be(e),ye(e),Q(e);for(var r=0,i=e.sourceFiles;r<i.length;r++){var s=i[r];$(0,s,s)}V(),d=n}function P(e,t){var n=d;U(t),be(e),ye(e),$(0,e,e),V(),d=n}function M(){return p||(p=e.createTextWriter(S))}function F(){var e=p.getText();return p.reset(),e}function $(e,t,n){n&&B(n),W(e,t)}function B(e){s=e,C.setSourceFile(e),b&&b(e)}function U(e){d=e,C.setWriter(e)}function V(){o=[],a=[],l=e.createMap(),c=[],u=0,C.reset(),U(void 0)}function H(e){e&&G(e)}function G(e){W(4,e)}function j(e){W(2,e)}function K(e){W(1,e)}function W(e,t){g?g(e,t,z):z(e,t)}function z(e,t){t=X(e,t),I&&0!==e?I(e,t,q):q(e,t)}function q(e,t){f&&0!==e&&2!==e?f(e,t,J):J(e,t)}function J(t,n){switch(t){case 0:return function(t){e.Debug.assertNode(t,e.isSourceFile),function(t){Pe();var n=t.statements;if(A){if(0===n.length||!e.isPrologueDirective(n[0])||e.nodeIsSynthesized(n[0]))return void A(t,n,_e)}_e(t)}(t)}(n);case 2:return function(t){e.Debug.assertNode(t,e.isIdentifier),ee(t)}(n);case 1:return Y(n);case 3:return function(e){G(e.name),Le(" in "),G(e.constraint)}(e.cast(n,e.isTypeParameterDeclaration));case 4:return function(t){var n=t.kind;if(e.isKeyword(n))return void Be(t);switch(n){case 14:case 15:case 16:return Z(t);case 71:return ee(t);case 143:return function(e){(function(e){71===e.kind?K(e):G(e)})(e.left),Le("."),G(e.right)}(t);case 144:return function(e){Le("["),K(e.expression),Le("]")}(t);case 145:return function(e){G(e.name),Te(" extends ",e.constraint),Te(" = ",e.default)}(t);case 146:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),H(e.dotDotDotToken),e.name&&G(e.name);H(e.questionToken),e.parent&&273===e.parent.kind&&!e.name?G(e.type):Te(": ",e.type);ke(" = ",e.initializer)}(t);case 147:return r=t,Le("@"),void K(r.expression);case 148:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),G(e.name),H(e.questionToken),Te(": ",e.type),Le(";")}(t);case 149:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),G(e.name),H(e.questionToken),Te(": ",e.type),ke(" = ",e.initializer),Le(";")}(t);case 150:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),G(e.name),H(e.questionToken),Ae(e,e.typeParameters),we(e,e.parameters),Te(": ",e.type),Le(";")}(t);case 151:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),H(e.asteriskToken),G(e.name),H(e.questionToken),oe(e,ae)}(t);case 152:return function(e){ve(e,e.modifiers),Le("constructor"),oe(e,ae)}(t);case 153:case 154:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le(153===e.kind?"get ":"set "),G(e.name),oe(e,ae)}(t);case 155:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Ae(e,e.typeParameters),we(e,e.parameters),Te(": ",e.type),Le(";")}(t);case 156:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("new "),Ae(e,e.typeParameters),we(e,e.parameters),Te(": ",e.type),Le(";")}(t);case 157:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),t=e,n=e.parameters,De(t,n,4432),Te(": ",e.type),Le(";");var t,n}(t);case 158:return function(e){G(e.parameterName),Le(" is "),G(e.type)}(t);case 159:return function(e){G(e.typeName),Ie(e,e.typeArguments)}(t);case 160:return function(e){Ae(e,e.typeParameters),Ne(e,e.parameters),Le(" => "),G(e.type)}(t);case 273:return function(e){Le("function"),we(e,e.parameters),Le(":"),G(e.type)}(t);case 161:return function(e){Le("new "),Ae(e,e.typeParameters),we(e,e.parameters),Le(" => "),G(e.type)}(t);case 162:return function(e){Le("typeof "),G(e.exprName)}(t);case 163:return function(t){Le("{");var n=1&e.getEmitFlags(t)?448:65;De(t,t.members,262144|n),Le("}")}(t);case 164:return function(e){G(e.elementType),Le("[]")}(t);case 165:return function(e){Le("["),De(e,e.elementTypes,336),Le("]")}(t);case 166:return function(e){De(e,e.types,260)}(t);case 167:return function(e){De(e,e.types,264)}(t);case 168:return function(e){Le("("),G(e.type),Le(")")}(t);case 201:return function(e){K(e.expression),Ie(e,e.typeArguments)}(t);case 169:return void Le("this");case 170:return function(e){Ue(e.operator),Le(" "),G(e.type)}(t);case 171:return function(e){G(e.objectType),Le("["),G(e.indexType),Le("]")}(t);case 172:return function(t){var n=e.getEmitFlags(t);Le("{"),1&n?Le(" "):(Pe(),Me());t.readonlyToken&&(G(t.readonlyToken),Le(" "));Le("["),W(3,t.typeParameter),Le("]"),H(t.questionToken),Le(": "),G(t.type),Le(";"),1&n?Le(" "):(Pe(),Fe());Le("}")}(t);case 173:return function(e){K(e.literal)}(t);case 268:return void Le("*");case 269:return void Le("?");case 270:return function(e){Le("?"),G(e.type)}(t);case 271:return function(e){Le("!"),G(e.type)}(t);case 272:return function(e){G(e.type),Le("=")}(t);case 274:return function(e){Le("..."),G(e.type)}(t);case 174:return function(e){var t=e.elements;0===t.length?Le("{}"):(Le("{"),De(e,t,432),Le("}"))}(t);case 175:return function(e){0===e.elements.length?Le("[]"):(Le("["),De(e,e.elements,304),Le("]"))}(t);case 176:return function(e){xe(e.propertyName,": "),H(e.dotDotDotToken),G(e.name),ke(" = ",e.initializer)}(t);case 205:return function(e){K(e.expression),G(e.literal)}(t);case 206:return void Le(";");case 207:return function(e){$e(17,e.pos,e),ne(e,!e.multiLine&&Ye(e)),Me(),N(e.statements.end),Fe(),$e(18,e.statements.end,e)}(t);case 208:return function(e){ve(e,e.modifiers),G(e.declarationList),Le(";")}(t);case 209:return void Le(";");case 210:return function(e){K(e.expression),Le(";")}(t);case 211:return function(e){var t=$e(90,e.pos,e);Le(" "),$e(19,t,e),K(e.expression),$e(20,e.expression.end,e),Se(e,e.thenStatement),e.elseStatement&&(Ve(e),$e(82,e.thenStatement.end,e),211===e.elseStatement.kind?(Le(" "),G(e.elseStatement)):Se(e,e.elseStatement))}(t);case 212:return function(t){Le("do"),Se(t,t.statement),e.isBlock(t.statement)?Le(" "):Ve(t);Le("while ("),K(t.expression),Le(");")}(t);case 213:return function(e){Le("while ("),K(e.expression),Le(")"),Se(e,e.statement)}(t);case 214:return function(e){var t=$e(88,e.pos);Le(" "),$e(19,t,e),re(e.initializer),Le(";"),ke(" ",e.condition),Le(";"),ke(" ",e.incrementor),Le(")"),Se(e,e.statement)}(t);case 215:return function(e){var t=$e(88,e.pos);Le(" "),$e(19,t),re(e.initializer),Le(" in "),K(e.expression),$e(20,e.expression.end),Se(e,e.statement)}(t);case 216:return function(e){var t=$e(88,e.pos);Le(" "),xe(e.awaitModifier," "),$e(19,t),re(e.initializer),Le(" of "),K(e.expression),$e(20,e.expression.end),Se(e,e.statement)}(t);case 217:return function(e){$e(77,e.pos),Te(" ",e.label),Le(";")}(t);case 218:return function(e){$e(72,e.pos),Te(" ",e.label),Le(";")}(t);case 219:return function(t){(function(t,n,r){var i=r&&e.getParseTreeNode(r);i&&i.kind===r.kind&&(n=e.skipTrivia(s.text,n));n=$e(t,n,r),i&&i.kind===r.kind&&w(n,!0)})(96,t.pos,t),ke(" ",t.expression),Le(";")}(t);case 220:return function(e){Le("with ("),K(e.expression),Le(")"),Se(e,e.statement)}(t);case 221:return function(e){var t=$e(98,e.pos);Le(" "),$e(19,t),K(e.expression),$e(20,e.expression.end),Le(" "),G(e.caseBlock)}(t);case 222:return function(e){G(e.label),Le(": "),G(e.statement)}(t);case 223:return function(e){Le("throw"),ke(" ",e.expression),Le(";")}(t);case 224:return function(e){Le("try "),G(e.tryBlock),e.catchClause&&(Ve(e),G(e.catchClause));e.finallyBlock&&(Ve(e),Le("finally "),G(e.finallyBlock))}(t);case 225:return function(e){$e(78,e.pos),Le(";")}(t);case 226:return function(e){G(e.name),Te(": ",e.type),ke(" = ",e.initializer)}(t);case 227:return function(t){Le(e.isLet(t)?"let ":e.isConst(t)?"const ":"var "),De(t,t.declarations,272)}(t);case 228:return function(e){ie(e)}(t);case 229:return function(e){de(e)}(t);case 230:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("interface "),G(e.name),Ae(e,e.typeParameters),De(e,e.heritageClauses,256),Le(" {"),De(e,e.members,65),Le("}")}(t);case 231:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("type "),G(e.name),Ae(e,e.typeParameters),Le(" = "),G(e.type),Le(";")}(t);case 232:return function(e){ve(e,e.modifiers),Le("enum "),G(e.name),et(),Le(" {"),De(e,e.members,81),Le("}"),tt()}(t);case 233:return function(e){ve(e,e.modifiers),512&~e.flags&&Le(16&e.flags?"namespace ":"module ");G(e.name);var t=e.body;for(;233===t.kind;)Le("."),G(t.name),t=t.body;Le(" "),G(t)}(t);case 234:return function(e){et(),Le("{"),ne(e,Ye(e)),Le("}"),tt()}(t);case 235:return function(e){$e(17,e.pos),De(e,e.clauses,65),$e(18,e.clauses.end)}(t);case 236:return function(e){Le("export as namespace "),G(e.name),Le(";")}(t);case 237:return function(e){ve(e,e.modifiers),Le("import "),G(e.name),Le(" = "),function(e){71===e.kind?K(e):G(e)}(e.moduleReference),Le(";")}(t);case 238:return function(e){ve(e,e.modifiers),Le("import "),e.importClause&&(G(e.importClause),Le(" from "));K(e.moduleSpecifier),Le(";")}(t);case 239:return function(e){G(e.name),e.name&&e.namedBindings&&Le(", ");G(e.namedBindings)}(t);case 240:return function(e){Le("* as "),G(e.name)}(t);case 241:return function(e){pe(e)}(t);case 242:return function(e){he(e)}(t);case 243:return function(e){Le(e.isExportEquals?"export = ":"export default "),K(e.expression),Le(";")}(t);case 244:return function(e){Le("export "),e.exportClause?G(e.exportClause):Le("*");e.moduleSpecifier&&(Le(" from "),K(e.moduleSpecifier));Le(";")}(t);case 245:return function(e){pe(e)}(t);case 246:return function(e){he(e)}(t);case 247:return;case 248:return function(e){Le("require("),K(e.expression),Le(")")}(t);case 10:return function(e){d.writeLiteral(Qe(e,!0))}(t);case 251:return function(t){Le("<"),fe(t.tagName),n=t.attributes.properties,r=" ",void(e.some(n)&&Le(r)),t.attributes.properties&&t.attributes.properties.length>0&&G(t.attributes);var n,r;Le(">")}(t);case 252:return function(e){Le("</"),fe(e.tagName),Le(">")}(t);case 253:return function(e){G(e.name),Te("=",e.initializer)}(t);case 254:return function(e){De(e,e.properties,131328)}(t);case 255:return function(e){Le("{..."),K(e.expression),Le("}")}(t);case 256:return function(e){e.expression&&(Le("{"),H(e.dotDotDotToken),K(e.expression),Le("}"))}(t);case 257:return function(e){Le("case "),K(e.expression),Le(":"),me(e,e.statements)}(t);case 258:return function(e){Le("default:"),me(e,e.statements)}(t);case 259:return function(e){Le(" "),Ue(e.token),Le(" "),De(e,e.types,272)}(t);case 260:return function(e){var t=$e(74,e.pos);Le(" "),e.variableDeclaration&&($e(19,t),G(e.variableDeclaration),$e(20,e.variableDeclaration.end),Le(" "));G(e.block)}(t);case 261:return function(t){G(t.name),Le(": ");var n=t.initializer;if(w&&0==(512&e.getEmitFlags(n))){var r=e.getCommentRange(n);w(r.pos)}K(n)}(t);case 262:return function(e){G(e.name),e.objectAssignmentInitializer&&(Le(" = "),K(e.objectAssignmentInitializer))}(t);case 263:return function(e){e.expression&&(Le("..."),K(e.expression))}(t);case 264:return function(e){G(e.name),ke(" = ",e.initializer)}(t)}var r;if(e.isExpression(t))return Y(X(1,t));if(e.isToken(t))return void Be(t)}(n)}}function Y(n){switch(n.kind){case 8:return function(e){Z(e)}(n);case 9:case 12:case 13:return Z(n);case 71:return ee(n);case 86:case 95:case 97:case 101:case 99:case 91:return void Be(n);case 177:return function(e){var t=e.elements,n=e.multiLine?32768:0;Oe(e,t,4466|n)}(n);case 178:return function(t){var n=65536&e.getEmitFlags(t);n&&Me();var r=t.multiLine?32768:0,i=s.languageVersion>=1?32:0;De(t,t.properties,263122|i|r),n&&Fe()}(n);case 179:return function(n){var r=!1,i=!1;if(!(131072&e.getEmitFlags(n))){var o=n.expression.end,a=e.skipTrivia(s.text,n.expression.end)+1,l=e.createToken(23);l.pos=o,l.end=a,r=Je(n,n.expression,l),i=Je(n,l,n.name)}K(n.expression),Ge(r),Le(!r&&function(n){if(n=e.skipPartiallyEmittedExpressions(n),e.isNumericLiteral(n)){var r=Ze(n);return!n.numericLiteralFlags&&!e.stringContains(r,e.tokenToString(23))}if(e.isPropertyAccessExpression(n)||e.isElementAccessExpression(n)){var i=e.getConstantValue(n);return"number"==typeof i&&isFinite(i)&&Math.floor(i)===i&&t.removeComments}}(n.expression)?"..":"."),Ge(i),G(n.name),je(r,i)}(n);case 180:return function(e){K(e.expression),Le("["),K(e.argumentExpression),Le("]")}(n);case 181:return function(e){K(e.expression),Ie(e,e.typeArguments),Oe(e,e.arguments,1296)}(n);case 182:return function(e){Le("new "),K(e.expression),Ie(e,e.typeArguments),Oe(e,e.arguments,9488)}(n);case 183:return function(e){K(e.tag),Le(" "),K(e.template)}(n);case 184:return function(e){Le("<"),G(e.type),Le(">"),K(e.expression)}(n);case 185:return function(e){Le("("),K(e.expression),Le(")")}(n);case 186:return function(e){ie(e)}(n);case 187:return function(e){Ce(e,e.decorators),ve(e,e.modifiers),oe(e,te)}(n);case 188:return function(e){Le("delete "),K(e.expression)}(n);case 189:return function(e){Le("typeof "),K(e.expression)}(n);case 190:return function(e){Le("void "),K(e.expression)}(n);case 191:return function(e){Le("await "),K(e.expression)}(n);case 192:return function(e){Ue(e.operator),function(e){var t=e.operand;return 192===t.kind&&(37===e.operator&&(37===t.operator||43===t.operator)||38===e.operator&&(38===t.operator||44===t.operator))}(e)&&Le(" ");K(e.operand)}(n);case 193:return function(e){K(e.operand),Ue(e.operator)}(n);case 194:return function(e){var t=26!==e.operatorToken.kind,n=Je(e,e.left,e.operatorToken),r=Je(e,e.operatorToken,e.right);K(e.left),Ge(n,t?" ":void 0),N(e.operatorToken.pos),Be(e.operatorToken),w(e.operatorToken.end,!0),Ge(r," "),K(e.right),je(n,r)}(n);case 195:return function(e){var t=Je(e,e.condition,e.questionToken),n=Je(e,e.questionToken,e.whenTrue),r=Je(e,e.whenTrue,e.colonToken),i=Je(e,e.colonToken,e.whenFalse);K(e.condition),Ge(t," "),G(e.questionToken),Ge(n," "),K(e.whenTrue),je(t,n),Ge(r," "),G(e.colonToken),Ge(i," "),K(e.whenFalse),je(r,i)}(n);case 196:return function(e){G(e.head),De(e,e.templateSpans,131072)}(n);case 197:return function(e){Le("yield"),G(e.asteriskToken),ke(" ",e.expression)}(n);case 198:return function(e){Le("..."),K(e.expression)}(n);case 199:return function(e){de(e)}(n);case 200:return;case 202:return function(e){K(e.expression),e.type&&(Le(" as "),G(e.type))}(n);case 203:return function(e){K(e.expression),Le("!")}(n);case 204:return function(e){$e(e.keywordToken,e.pos),Le("."),G(e.name)}(n);case 249:return function(e){G(e.openingElement),De(e,e.children,131072),G(e.closingElement)}(n);case 250:return function(e){Le("<"),fe(e.tagName),Le(" "),e.attributes.properties&&e.attributes.properties.length>0&&G(e.attributes);Le("/>")}(n);case 288:return function(e){K(e.expression)}(n);case 289:return function(e){Oe(e,e.elements,272)}(n)}}function X(e,t){return t&&v&&v(e,t)||t}function Q(e){y&&y(e,He)}function Z(n){var r=Ze(n);!t.sourceMap&&!t.inlineSourceMap||9!==n.kind&&!e.isTemplateLiteralKind(n.kind)?Le(r):d.writeLiteral(r)}function ee(e){Le(Qe(e,!1)),Ie(e,e.typeArguments)}function te(e){Ae(e,e.typeParameters),Ne(e,e.parameters),Te(": ",e.type),Le(" "),G(e.equalsGreaterThanToken)}function ne(t,n){var r=n||1&e.getEmitFlags(t)?384:65;De(t,t.statements,r)}function re(e){void 0!==e&&(227===e.kind?G(e):K(e))}function ie(e){Ce(e,e.decorators),ve(e,e.modifiers),Le("function"),H(e.asteriskToken),Le(" "),j(e.name),oe(e,ae)}function se(e,t){le(t)}function oe(t,n){var r=t.body;if(r)if(e.isBlock(r)){var i=65536&e.getEmitFlags(t);i&&Me(),524288&e.getEmitFlags(t)?(n(t),g?g(4,r,se):le(r)):(et(),n(t),g?g(4,r,se):le(r),tt()),i&&Fe()}else n(t),Le(" "),K(r);else n(t),Le(";")}function ae(e){Ae(e,e.typeParameters),we(e,e.parameters),Te(": ",e.type)}function le(t){Le(" {"),Me();var n=function(t){if(1&e.getEmitFlags(t))return!0;if(t.multiLine)return!1;if(!e.nodeIsSynthesized(t)&&!e.rangeIsOnSingleLine(t,s))return!1;if(Ke(t,t.statements,2)||ze(t,t.statements,2))return!1;for(var n,r=0,i=t.statements;r<i.length;r++){var o=i[r];if(We(n,o,2))return!1;n=o}return!0}(t)?ce:ue;A?A(t,t.statements,n):n(t),Fe(),$e(18,t.statements.end,t)}function ce(e){ue(e,!0)}function ue(e,t){var n=ge(e.statements,!0),r=d.getTextPos();Q(e),0===n&&r===d.getTextPos()&&t?(Fe(),De(e,e.statements,384),Me()):De(e,e.statements,1,n)}function de(t){Ce(t,t.decorators),ve(t,t.modifiers),Le("class"),Ee(" ",t.name,j);var n=65536&e.getEmitFlags(t);n&&Me(),Ae(t,t.typeParameters),De(t,t.heritageClauses,256),et(),Le(" {"),De(t,t.members,65),Le("}"),tt(),n&&Fe()}function pe(e){Le("{"),De(e,e.elements,432),Le("}")}function he(e){e.propertyName&&(G(e.propertyName),Le(" as ")),G(e.name)}function fe(e){71===e.kind?K(e):G(e)}function me(t,n){var r=1===n.length&&(e.nodeIsSynthesized(t)||e.nodeIsSynthesized(n[0])||e.rangeStartPositionsAreOnSameLine(t,n[0],s));n.length>0&&w(n.pos);var i=81985;r&&(Le(" "),i&=-66),De(t,n,i)}function _e(t){var n=t.statements;et(),Q(t);var r=e.findIndex(n,(function(t){return!e.isPrologueDirective(t)}));De(t,n,1,-1===r?n.length:r),tt()}function ge(t,n,r){for(var i=0;i<t.length;i++){var s=t[i];if(!e.isPrologueDirective(s))return i;(!r||!r.has(s.expression.text))&&((n||i>0)&&Pe(),G(s),r&&r.set(s.expression.text,!0))}return t.length}function ye(t){if(e.isSourceFile(t))B(t),ge(t.statements);else for(var n=e.createMap(),r=0,i=t.sourceFiles;r<i.length;r++){var s=i[r];B(s),ge(s.statements,!0,n)}}function be(t){if(e.isSourceFile(t)){var n=e.getShebang(t.text);if(n)return Le(n),Pe(),!0}else for(var r=0,i=t.sourceFiles;r<i.length;r++){if(be(i[r]))break}}function ve(e,t){t&&t.length&&(De(e,t,131328),Le(" "))}function Te(e,t){Ee(e,t,G)}function ke(e,t){Ee(e,t,K)}function Ee(e,t,n){t&&(Le(e),n(t))}function xe(e,t){e&&(G(e),Le(t))}function Se(t,n){e.isBlock(n)||1&e.getEmitFlags(t)?(Le(" "),G(n)):(Pe(),Me(),G(n),Fe())}function Ce(e,t){De(e,t,24577)}function Ie(e,t){De(e,t,26960)}function Ae(e,t){De(e,t,26960)}function we(e,t){De(e,t,1360)}function Ne(t,n){!function(t,n){var r=e.singleOrUndefined(n);return r&&r.pos===t.pos&&!(e.isArrowFunction(t)&&t.type)&&!e.some(t.decorators)&&!e.some(t.modifiers)&&!e.some(t.typeParameters)&&!e.some(r.decorators)&&!e.some(r.modifiers)&&!r.dotDotDotToken&&!r.questionToken&&!r.type&&!r.initializer&&e.isIdentifier(r.name)}(t,n)?we(t,n):De(t,n,336)}function De(e,t,n,r,i){Re(G,e,t,n,r,i)}function Oe(e,t,n,r,i){Re(K,e,t,n,r,i)}function Re(t,n,s,o,a,l){void 0===a&&(a=0),void 0===l&&(l=s?s.length-a:0);var c=void 0===s;if(!(c&&8192&o)){var u=c||a>=s.length||0===l;if(u&&16384&o)return T&&T(s),void(k&&k(s));if(7680&o&&Le(function(e){return i[7680&e][0]}(o)),T&&T(s),u)1&o?Pe():128&o&&!(262144&o)&&Le(" ");else{var d=0==(131072&o),p=d;Ke(n,s,o)?(Pe(),p=!1):128&o&&Le(" "),64&o&&Me();for(var h=void 0,f=void 0,m=function(e){return r[28&e]}(o),_=0;_<l;_++){var g=s[a+_];if(h&&(m&&h.end!==n.end&&N(h.end),Le(m),We(h,g,o)?(0==(67&o)&&(Me(),f=!0),Pe(),p=!1):h&&256&o&&Le(" ")),p){if(w){var y=e.getCommentRange(g);w(y.pos)}}else p=d;t(g),f&&(Fe(),f=!1),h=g}var b=32&o&&s.hasTrailingComma;16&o&&b&&Le(","),!h||!m||h.end===n.end||1024&e.getEmitFlags(h)||N(h.end),64&o&&Fe(),ze(n,s,o)?Pe():128&o&&Le(" ")}k&&k(s),7680&o&&Le(function(e){return i[7680&e][1]}(o))}}function Le(e){d.write(e)}function Pe(){d.writeLine()}function Me(){d.increaseIndent()}function Fe(){d.decreaseIndent()}function $e(e,t,n){return m?m(n,e,t,Ue):Ue(e,t)}function Be(t){E&&E(t),Le(e.tokenToString(t.kind)),x&&x(t)}function Ue(t,n){var r=e.tokenToString(t);return Le(r),n<0?n:n+r.length}function Ve(t){1&e.getEmitFlags(t)?Le(" "):Pe()}function He(t){for(var n=t.split(/\r\n?|\n/g),r=function(t){for(var n,r=0,i=t;r<i.length;r++)for(var s=i[r],o=0;o<s.length&&(void 0===n||o<n);o++)if(!e.isWhiteSpaceLike(s.charCodeAt(o))&&(void 0===n||o<n)){n=o;break}return n}(n),i=0;i<n.length;i++){var s=r?n[i].slice(r):n[i];s.length&&(Pe(),Le(s),Pe())}}function Ge(e,t){e?(Me(),Pe()):t&&Le(t)}function je(e,t){e&&Fe(),t&&Fe()}function Ke(t,n,r){if(1&r)return!0;if(2&r){if(32768&r)return!0;var i=n[0];return void 0===i?!e.rangeIsOnSingleLine(t,s):e.positionIsSynthesized(t.pos)||e.nodeIsSynthesized(i)?qe(i,r):!e.rangeStartPositionsAreOnSameLine(t,i,s)}return!1}function We(t,n,r){return!!(1&r)||(2&r?void 0!==t&&void 0!==n&&(e.nodeIsSynthesized(t)||e.nodeIsSynthesized(n)?qe(t,r)||qe(n,r):!e.rangeEndIsOnSameLineAsRangeStart(t,n,s)):n.startsOnNewLine)}function ze(t,n,r){if(1&r)return 0==(65536&r);if(2&r){if(32768&r)return!0;var i=e.lastOrUndefined(n);return void 0===i?!e.rangeIsOnSingleLine(t,s):e.positionIsSynthesized(t.pos)||e.nodeIsSynthesized(i)?qe(i,r):!e.rangeEndPositionsAreOnSameLine(t,i,s)}return!1}function qe(t,n){if(e.nodeIsSynthesized(t)){var r=t.startsOnNewLine;return void 0===r?0!=(32768&n):r}return 0!=(32768&n)}function Je(t,n,r){return t=Xe(t),n=Xe(n),!!(r=Xe(r)).startsOnNewLine||!(e.nodeIsSynthesized(t)||e.nodeIsSynthesized(n)||e.nodeIsSynthesized(r)||e.rangeEndIsOnSameLineAsRangeStart(n,r,s))}function Ye(t){return 0===t.statements.length&&e.rangeEndIsOnSameLineAsRangeStart(t,t,s)}function Xe(t){for(;185===t.kind&&e.nodeIsSynthesized(t);)t=t.expression;return t}function Qe(t,n){return e.isGeneratedIdentifier(t)?function(t){if(4===t.autoGenerateKind)return nt(function(t){var n=t.autoGenerateId,r=t,i=r.original;for(;i&&(r=i,!e.isIdentifier(r)||4!==r.autoGenerateKind||r.autoGenerateId===n);)i=r.original;return r}(t));var n=t.autoGenerateId;return a[n]||(a[n]=function(t){switch(t.autoGenerateKind){case 1:return it(0);case 2:return it(268435456);case 3:return st(e.idText(t))}e.Debug.fail("Unsupported GeneratedIdentifierKind.")}(t))}(t):!e.isIdentifier(t)||!e.nodeIsSynthesized(t)&&t.parent?9===t.kind&&t.textSourceNode?Qe(t.textSourceNode,n):!e.isLiteralExpression(t)||!e.nodeIsSynthesized(t)&&t.parent?e.getSourceTextOfNodeFromSourceFile(s,t,n):t.text:e.idText(t)}function Ze(t){if(9===t.kind&&t.textSourceNode){var n=t.textSourceNode;return e.isIdentifier(n)?16777216&e.getEmitFlags(t)?'"'+e.escapeString(Qe(n))+'"':'"'+e.escapeNonAsciiString(Qe(n))+'"':Ze(n)}return e.getLiteralText(t,s)}function et(){c.push(u),u=0}function tt(){u=c.pop()}function nt(t){var n=e.getNodeId(t);return o[n]||(o[n]=function(t){switch(t.kind){case 71:return st(Qe(t));case 233:case 232:return function(t){var n=Qe(t.name);return function(t,n){for(var r=n;e.isNodeDescendantOf(r,n);r=r.nextContainer)if(r.locals){var i=r.locals.get(e.escapeLeadingUnderscores(t));if(i&&3253183&i.flags)return!1}return!0}(n,t)?n:st(n)}(t);case 238:case 244:return function(t){var n=e.getExternalModuleName(t);return st(e.isStringLiteral(n)?e.makeIdentifierFromModuleName(n.text):"module")}(t);case 228:case 229:case 243:return st("default");case 199:return st("class");case 151:case 153:case 154:return function(t){if(e.isIdentifier(t.name))return nt(t.name);return it(0)}(t);default:return it(0)}}(t))}function rt(e){return!(h&&h(e)||s.identifiers.has(e)||l.has(e))}function it(e){if(e&&!(u&e)&&rt(t=268435456===e?"_i":"_n"))return u|=e,t;for(;;){var t,n=268435455&u;if(u++,8!==n&&13!==n)if(rt(t=n<26?"_"+String.fromCharCode(97+n):"_"+(n-26)))return t}}function st(e){95!==e.charCodeAt(e.length-1)&&(e+="_");for(var t=1;;){var n=e+t;if(rt(n))return l.set(n,!0),n;t++}}}e.forEachEmittedFile=s,e.emitFiles=function(t,n,r,i,o){var a,c,u,d=n.getCompilerOptions(),p=e.getEmitModuleKind(d),h=d.sourceMap||d.inlineSourceMap?[]:void 0,f=d.listEmittedFiles?[]:void 0,m=e.createDiagnosticCollection(),_=n.getNewLine(),g=e.createTextWriter(_),y=e.createSourceMapWriter(n,g),b=!1,v=e.getSourceFilesToEmit(n,r),T=e.transformNodes(t,n,d,v,o,!1),k=l(d,{hasGlobalName:t.hasGlobalName,onEmitNode:T.emitNodeWithNotification,substituteNode:T.substituteNode,onEmitSourceMapOfNode:y.emitNodeWithSourceMap,onEmitSourceMapOfToken:y.emitTokenWithSourceMap,onEmitSourceMapOfPosition:y.emitPos,onEmitHelpers:function(t,n){var r=!1,i=266===t.kind?t:void 0;if(i&&p===e.ModuleKind.None)return;for(var s=i?i.sourceFiles.length:1,o=0;o<s;o++){var l=i?i.sourceFiles[o]:t,h=e.isSourceFile(l)?l:a,f=d.noEmitHelpers||void 0!==e.getExternalHelpersModuleName(h),m=e.isSourceFile(l)&&!u,_=e.getEmitHelpers(l);if(_)for(var g=0,y=e.stableSort(_,e.compareEmitHelpers);g<y.length;g++){var b=y[g];if(b.scoped){if(i)continue}else{if(f)continue;if(m){if(c.get(b.name))continue;c.set(b.name,!0)}}n(b.text),r=!0}}return r},onSetSourceFile:function(e){a=e,y.setSourceFile(e)}});return e.performance.mark("beforePrint"),s(n,(function(r,s){var o=r.jsFilePath,l=r.sourceMapFilePath,p=r.declarationFilePath;n.isEmitBlocked(o)||d.noEmit?b=!0:i||function(t,r,i){var s=266===i.kind?i:void 0,o=265===i.kind?i:void 0,l=s?s.sourceFiles:[o];y.initialize(t,r,i),s?(c=e.createMap(),u=!1,k.writeBundle(s,g)):(u=!0,k.writeFile(o,g));g.writeLine();var p=y.getSourceMappingURL();p&&g.write("//# sourceMappingURL="+p);d.sourceMap&&!d.inlineSourceMap&&e.writeFile(n,m,r,y.getText(),!1,l);h&&h.push(y.getSourceMapData());e.writeFile(n,m,t,g.getText(),d.emitBOM,l),y.reset(),g.reset(),a=void 0,c=void 0,u=!1}(o,l,s);p&&(b=e.writeDeclarationFile(p,function(t){return 266===t.kind?e.updateBundle(t,e.sameMap(t.sourceFiles,e.getOriginalSourceFile)):e.getOriginalSourceFile(t)}(s),n,t,m,i)||b);!b&&f&&(i||f.push(o),l&&f.push(l),p&&f.push(p))}),T.transformed,i),e.performance.measure("printTime","beforePrint"),T.dispose(),{emitSkipped:b,diagnostics:m.getDiagnostics(),emittedFiles:f,sourceMaps:h}},e.createPrinter=l,function(e){e[e.Auto=0]="Auto",e[e.CountMask=268435455]="CountMask",e[e._i=268435456]="_i"}(t||(t={})),function(e){e[e.None=0]="None",e[e.SingleLine=0]="SingleLine",e[e.MultiLine=1]="MultiLine",e[e.PreserveLines=2]="PreserveLines",e[e.LinesMask=3]="LinesMask",e[e.NotDelimited=0]="NotDelimited",e[e.BarDelimited=4]="BarDelimited",e[e.AmpersandDelimited=8]="AmpersandDelimited",e[e.CommaDelimited=16]="CommaDelimited",e[e.DelimitersMask=28]="DelimitersMask",e[e.AllowTrailingComma=32]="AllowTrailingComma",e[e.Indented=64]="Indented",e[e.SpaceBetweenBraces=128]="SpaceBetweenBraces",e[e.SpaceBetweenSiblings=256]="SpaceBetweenSiblings",e[e.Braces=512]="Braces",e[e.Parenthesis=1024]="Parenthesis",e[e.AngleBrackets=2048]="AngleBrackets",e[e.SquareBrackets=4096]="SquareBrackets",e[e.BracketsMask=7680]="BracketsMask",e[e.OptionalIfUndefined=8192]="OptionalIfUndefined",e[e.OptionalIfEmpty=16384]="OptionalIfEmpty",e[e.Optional=24576]="Optional",e[e.PreferNewLine=32768]="PreferNewLine",e[e.NoTrailingNewLine=65536]="NoTrailingNewLine",e[e.NoInterveningComments=131072]="NoInterveningComments",e[e.NoSpaceIfEmpty=262144]="NoSpaceIfEmpty",e[e.SingleElement=524288]="SingleElement",e[e.Modifiers=131328]="Modifiers",e[e.HeritageClauses=256]="HeritageClauses",e[e.SingleLineTypeLiteralMembers=448]="SingleLineTypeLiteralMembers",e[e.MultiLineTypeLiteralMembers=65]="MultiLineTypeLiteralMembers",e[e.TupleTypeElements=336]="TupleTypeElements",e[e.UnionTypeConstituents=260]="UnionTypeConstituents",e[e.IntersectionTypeConstituents=264]="IntersectionTypeConstituents",e[e.ObjectBindingPatternElements=432]="ObjectBindingPatternElements",e[e.ArrayBindingPatternElements=304]="ArrayBindingPatternElements",e[e.ObjectLiteralExpressionProperties=263122]="ObjectLiteralExpressionProperties",e[e.ArrayLiteralExpressionElements=4466]="ArrayLiteralExpressionElements",e[e.CommaListElements=272]="CommaListElements",e[e.CallExpressionArguments=1296]="CallExpressionArguments",e[e.NewExpressionArguments=9488]="NewExpressionArguments",e[e.TemplateExpressionSpans=131072]="TemplateExpressionSpans",e[e.SingleLineBlockStatements=384]="SingleLineBlockStatements",e[e.MultiLineBlockStatements=65]="MultiLineBlockStatements",e[e.VariableDeclarationList=272]="VariableDeclarationList",e[e.SingleLineFunctionBodyStatements=384]="SingleLineFunctionBodyStatements",e[e.MultiLineFunctionBodyStatements=1]="MultiLineFunctionBodyStatements",e[e.ClassHeritageClauses=256]="ClassHeritageClauses",e[e.ClassMembers=65]="ClassMembers",e[e.InterfaceMembers=65]="InterfaceMembers",e[e.EnumMembers=81]="EnumMembers",e[e.CaseBlockClauses=65]="CaseBlockClauses",e[e.NamedImportsOrExportsElements=432]="NamedImportsOrExportsElements",e[e.JsxElementChildren=131072]="JsxElementChildren",e[e.JsxElementAttributes=131328]="JsxElementAttributes",e[e.CaseOrDefaultClauseStatements=81985]="CaseOrDefaultClauseStatements",e[e.HeritageClauseTypes=272]="HeritageClauseTypes",e[e.SourceFileStatements=65537]="SourceFileStatements",e[e.Decorators=24577]="Decorators",e[e.TypeArguments=26960]="TypeArguments",e[e.TypeParameters=26960]="TypeParameters",e[e.Parameters=1360]="Parameters",e[e.IndexSignatureParameters=4432]="IndexSignatureParameters"}(n||(n={}))}(ts||(ts={})),function(e){function t(e,t,n,r,i){var s=[],o=e.emit(t,(function(e,t,n){s.push({name:e,writeByteOrderMark:n,text:t})}),r,n,i);return{outputFiles:s,emitSkipped:o.emitSkipped}}e.getFileEmitOutput=t,e.createBuilder=function(n){var r,i,s,o=e.createMap(),a=e.createMap(),l=e.createMap(),c=e.createMap();return{updateProgram:function(e){s&&u(e)},getFilesAffectedBy:f,emitChangedFiles:function(t,n){h(t);var r=t.getCompilerOptions();if(!l.size)return e.emptyArray;if(r.outFile||r.out)return e.Debug.assert(0===a.size),l.clear(),[t.emit(void 0,n)];var i,s=e.createMap();return l.forEach((function(e,r){f(t,r).forEach((function(e){a.delete(e.path),s.has(e.path)||(s.set(e.path,!0),(i||(i=[])).push(t.emit(e,n)))}))})),l.clear(),i||e.emptyArray},getSemanticDiagnostics:function(t,n){h(t),e.Debug.assert(0===l.size);var r,i=t.getCompilerOptions();if(i.outFile||i.out)return e.Debug.assert(0===a.size),t.getSemanticDiagnostics(void 0,n);for(var s=0,o=t.getSourceFiles();s<o.length;s++){var c=o[s];r=e.addRange(r,m(t,c,n))}return r||e.emptyArray},clear:function(){r=void 0,s=void 0,o.clear(),a.clear(),l.clear(),c.clear()}};function u(t){var n=t.getCompilerOptions().module!==e.ModuleKind.None;r!==n&&(s=(r=n)?function(){var t=e.createMap();return{onAddSourceFile:n,onRemoveSourceFile:s,onUpdateSourceFile:r,onUpdateSourceFileWithSameVersion:i,getFilesAffectedByUpdatedShape:l};function n(e,n){var r=g(e,n);r&&t.set(n.path,r)}function r(e,n){var r=g(e,n);r?t.set(n.path,r):t.delete(n.path)}function i(n,r){var i=g(n,r);if(!i)return t.delete(r.path);var s=t.get(r.path);return t.set(r.path,i),!s||s.size!==i.size||(e.forEachEntry(i,(function(e,t){return!s.delete(t)}))||!!s.size)}function s(e){t.forEach((function(t,n){t.has(e)&&(o.get(n)&&d(n))})),t.delete(e)}function a(n){return e.mapDefinedIter(t.entries(),(function(e){var t=e[0];return e[1].has(n)?t:void 0}))}function l(t,n){if(!e.isExternalModule(n)&&!function(t){for(var n=0,r=t.statements;n<r.length;n++){var i=r[n];if(!e.isModuleWithStringLiteralName(i))return!1}return!0}(n))return y(t,n);var r=t.getCompilerOptions();if(r&&(r.isolatedModules||r.out||r.outFile))return[n];var i=e.createMap(),s=n.path;i.set(s,n);for(var o=a(s);o.length>0;){var l=o.pop();if(!i.has(l)){var c=t.getSourceFileByPath(l);i.set(l,c),c&&_(t,c)&&o.push.apply(o,a(l))}}return e.flatMapIter(i.values(),(function(e){return e}))}}():function(){return{onAddSourceFile:e.noop,onRemoveSourceFile:e.noop,onUpdateSourceFile:e.noop,onUpdateSourceFileWithSameVersion:e.returnFalse,getFilesAffectedByUpdatedShape:t};function t(e,t){var n=e.getCompilerOptions();return n&&(n.out||n.outFile)?[t]:y(e,t)}}(),o.clear(),a.clear()),c.clear(),i=void 0,e.mutateMap(o,e.arrayToMap(t.getSourceFiles(),(function(e){return e.path})),{createNewValue:function(e,n){return function(e,t){return d(t.path),s.onAddSourceFile(e,t),{version:t.version,signature:void 0}}(t,n)},onDeleteValue:p,onExistingValue:function(e,n){return function(e,t,n){t.version!==n.version?(d(n.path),t.version=n.version,s.onUpdateSourceFile(e,n)):s.onUpdateSourceFileWithSameVersion(e,n)&&d(n.path)}(t,e,n)}})}function d(e){l.set(e,!0),a.delete(e)}function p(e,t){l.delete(t),a.delete(t),s.onRemoveSourceFile(t)}function h(e){s||u(e)}function f(t,n){h(t);var r=t.getSourceFileByPath(n);return r?_(t,r)?s.getFilesAffectedByUpdatedShape(t,r):[r]:e.emptyArray}function m(e,t,n){var r=t.path,i=a.get(r);if(i)return i;var s=e.getSemanticDiagnostics(t,n);return a.set(r,s),s}function _(r,i){if(e.Debug.assert(!!i),c.has(i.path))return!1;c.set(i.path,!0);var s=o.get(i.path);e.Debug.assert(!!s);var a,l=s.signature;if(i.isDeclarationFile)a=i.version,s.signature=a;else{var u=t(r,i,!0);u.outputFiles&&u.outputFiles.length>0?(a=n.computeHash(u.outputFiles[0].text),s.signature=a):a=l}return!l||a!==l}function g(t,r){var i;if(r.imports&&r.imports.length>0)for(var s=t.getTypeChecker(),o=0,a=r.imports;o<a.length;o++){var l=a[o],c=s.getSymbolAtLocation(l);if(c&&c.declarations&&c.declarations[0]){var u=e.getSourceFileOfNode(c.declarations[0]);u&&m(u.path)}}var d=e.getDirectoryPath(r.path);if(r.referencedFiles&&r.referencedFiles.length>0)for(var p=0,h=r.referencedFiles;p<h.length;p++){var f=h[p];m(e.toPath(f.fileName,d,n.getCanonicalFileName))}return r.resolvedTypeReferenceDirectiveNames&&r.resolvedTypeReferenceDirectiveNames.forEach((function(t){if(t){var r=t.resolvedFileName;m(e.toPath(r,d,n.getCanonicalFileName))}})),i;function m(t){i||(i=e.createMap()),i.set(t,!0)}}function y(t,n){if(i)return i;var r;l(n);for(var s=0,o=t.getSourceFiles();s<o.length;s++){var a=o[s];a!==n&&l(a)}return i=r||e.emptyArray;function l(e){t.isSourceFileDefaultLibrary(e)||(r||(r=[])).push(e)}}}}(ts||(ts={})),function(e){var t=/(^\s*$)|(^\s*\/\/\/?\s*(@ts-ignore)?)/;function n(t,n){var r=e.getDirectoryPath(n),i=e.isRootedDiskPath(t)?t:e.combinePaths(r,t);return e.normalizePath(i)}function r(t,n,r){var i;return e.forEach(t,(function(t){var s=e.getNormalizedPathComponents(t,n);if(s.pop(),i){for(var o=Math.min(i.length,s.length),a=0;a<o;a++)if(r(i[a])!==r(s[a])){if(0===a)return!0;i.length=a;break}s.length<i.length&&(i.length=s.length)}else i=s}))?"":i?e.getNormalizedPathFromPathComponents(i):n}function i(t,n){var r,i=e.createMap();function s(t){t.length>e.getRootLength(t)&&!function(t){return!!i.has(t)||!!e.sys.directoryExists(t)&&(i.set(t,!0),!0)}(t)&&(s(e.getDirectoryPath(t)),e.sys.createDirectory(t))}function o(){return e.getDirectoryPath(e.normalizePath(e.sys.getExecutingFilePath()))}var a=e.getNewLineCharacter(t),l=e.sys.realpath&&function(t){return e.sys.realpath(t)};return{getSourceFile:function(r,i,s){var o;try{e.performance.mark("beforeIORead"),o=e.sys.readFile(r,t.charset),e.performance.mark("afterIORead"),e.performance.measure("I/O Read","beforeIORead","afterIORead")}catch(e){s&&s(e.message),o=""}return void 0!==o?e.createSourceFile(r,o,i,n):void 0},getDefaultLibLocation:o,getDefaultLibFileName:function(t){return e.combinePaths(o(),e.getDefaultLibFileName(t))},writeFile:function(n,i,o,a){try{e.performance.mark("beforeIOWrite"),s(e.getDirectoryPath(e.normalizePath(n))),e.isWatchSet(t)&&e.sys.createHash&&e.sys.getModifiedTime?function(t,n,i){r||(r=e.createMap());var s=e.sys.createHash(n),o=e.sys.getModifiedTime(t);if(o){var a=r.get(t);if(a&&a.byteOrderMark===i&&a.hash===s&&a.mtime.getTime()===o.getTime())return}e.sys.writeFile(t,n,i);var l=e.sys.getModifiedTime(t);r.set(t,{hash:s,byteOrderMark:i,mtime:l})}(n,i,o):e.sys.writeFile(n,i,o),e.performance.mark("afterIOWrite"),e.performance.measure("I/O Write","beforeIOWrite","afterIOWrite")}catch(e){a&&a(e.message)}},getCurrentDirectory:e.memoize((function(){return e.sys.getCurrentDirectory()})),useCaseSensitiveFileNames:function(){return e.sys.useCaseSensitiveFileNames},getCanonicalFileName:function(t){return e.sys.useCaseSensitiveFileNames?t:t.toLowerCase()},getNewLine:function(){return a},fileExists:function(t){return e.sys.fileExists(t)},readFile:function(t){return e.sys.readFile(t)},trace:function(t){return e.sys.write(t+a)},directoryExists:function(t){return e.sys.directoryExists(t)},getEnvironmentVariable:function(t){return e.sys.getEnvironmentVariable?e.sys.getEnvironmentVariable(t):""},getDirectories:function(t){return e.sys.getDirectories(t)},realpath:l}}function s(t,n){var r=e.DiagnosticCategory[t.category].toLowerCase()+" TS"+t.code+": "+p(t.messageText,n.getNewLine())+n.getNewLine();if(t.file){var i=e.getLineAndCharacterOfPosition(t.file,t.start),s=i.line,o=i.character,a=t.file.fileName;return e.convertToRelativePath(a,n.getCurrentDirectory(),(function(e){return n.getCanonicalFileName(e)}))+"("+(s+1)+","+(o+1)+"): "+r}return r}e.findConfigFile=function(t,n,r){for(void 0===r&&(r="tsconfig.json");;){var i=e.combinePaths(t,r);if(n(i))return i;var s=e.getDirectoryPath(t);if(s===t)break;t=s}},e.resolveTripleslashReference=n,e.computeCommonSourceDirectoryOfFilenames=r,e.createCompilerHost=i,e.getPreEmitDiagnostics=function(t,n,r){var i=t.getOptionsDiagnostics(r).concat(t.getSyntacticDiagnostics(n,r),t.getGlobalDiagnostics(r),t.getSemanticDiagnostics(n,r));return t.getCompilerOptions().declaration&&e.addRange(i,t.getDeclarationDiagnostics(n,r)),e.sortAndDeduplicateDiagnostics(i)},e.formatDiagnostics=function(e,t){for(var n="",r=0,i=e;r<i.length;r++){n+=s(i[r],t)}return n},e.formatDiagnostic=s;var o="[91m",a="[30;47m",l="[0m";function c(t){switch(t){case e.DiagnosticCategory.Warning:return"[93m";case e.DiagnosticCategory.Error:return o;case e.DiagnosticCategory.Message:return"[93m"}}function u(e,t){return t+e+l}function d(e,t){for(;e.length<t;)e=" "+e;return e}function p(t,n){if(e.isString(t))return t;for(var r=t,i="",s=0;r;){if(s){i+=n;for(var o=0;o<s;o++)i+="  "}i+=r.messageText,s++,r=r.next}return i}function h(t,n,r){if(0===t.length)return[];for(var i=[],s=e.createMap(),o=0,a=t;o<a.length;o++){var l=a[o],c=void 0;s.has(l)?c=s.get(l):s.set(l,c=r(l,n)),i.push(c)}return i}function f(t,n){switch(n.extension){case".ts":case".d.ts":return;case".tsx":return r();case".jsx":return r()||i();case".js":return i()}function r(){return t.jsx?void 0:e.Diagnostics.Module_0_was_resolved_to_1_but_jsx_is_not_set}function i(){return t.allowJs||!t.noImplicitAny?void 0:e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type}}function m(t){return e.Debug.assert(t.every((function(e){return void 0!==e})),"A name is undefined.",(function(){return JSON.stringify(t)})),t}function _(e){for(var t=e.imports,n=e.moduleAugmentations,r=t.map((function(e){return e.text})),i=0,s=n;i<s.length;i++){var o=s[i];9===o.kind&&r.push(o.text)}return r}e.formatDiagnosticsWithColorAndContext=function(t,n){for(var r="",i=0,s=t;i<s.length;i++){var h=s[i],f="";if(h.file){var m=h.start,_=h.length,g=h.file,y=e.getLineAndCharacterOfPosition(g,m),b=y.line,v=y.character,T=e.getLineAndCharacterOfPosition(g,m+_),k=T.line,E=T.character,x=e.getLineAndCharacterOfPosition(g,g.text.length).line,S=n?e.convertToRelativePath(g.fileName,n.getCurrentDirectory(),(function(e){return n.getCanonicalFileName(e)})):g.fileName,C=k-b>=4,I=(k+1+"").length;C&&(I=Math.max("...".length,I)),f+=n.getNewLine();for(var A=b;A<=k;A++){C&&b+1<A&&A<k-1&&(f+=u(d("...",I),a)+" "+n.getNewLine(),A=k-1);var w=e.getPositionOfLineAndCharacter(g,A,0),N=A<x?e.getPositionOfLineAndCharacter(g,A+1,0):g.text.length,D=g.text.slice(w,N);if(D=(D=D.replace(/\s+$/g,"")).replace("\t"," "),f+=u(d(A+1+"",I),a)+" ",f+=D+n.getNewLine(),f+=u(d("",I),a)+" ",f+=o,A===b){var O=A===k?E:void 0;f+=D.slice(0,v).replace(/\S/g," "),f+=D.slice(v,O).replace(/./g,"~")}else f+=A===k?D.slice(0,E).replace(/./g,"~"):D.replace(/./g,"~");f+=l}r+=n.getNewLine(),r+=S+"("+(b+1)+","+(v+1)+"): "}var R=c(h.category);r+=u(e.DiagnosticCategory[h.category].toLowerCase(),R)+" TS"+h.code+": "+p(h.messageText,n.getNewLine()),h.file&&(r+=n.getNewLine(),r+=f),r+=n.getNewLine()}return r},e.flattenDiagnosticMessageText=p,e.isProgramUptoDate=function(t,n,r,i,s,o,a){if(!t||a)return!1;if(t.getRootFileNames().length!==n.length)return!1;if(t.getSourceFiles().some((function(e){return e.version!==i(e.path)||o(e.path)})))return!1;if(t.getMissingFilePaths().some(s))return!1;var l=t.getCompilerOptions();return!!e.compareDataObjects(l,r)&&(!l.configFile||!r.configFile||l.configFile.text===r.configFile.text)},e.createProgram=function(s,o,a,l){var c,u,d,p,g,y,b=[],v={},T={},k=e.createMap(),E=e.createDiagnosticCollection(),x="number"==typeof o.maxNodeModuleJsDepth?o.maxNodeModuleJsDepth:0,S=0,C=e.createMap(),I=e.createMap();e.performance.mark("beforeProgram"),a=a||i(o);var A,w,N,D,O=o.noLib,R=e.memoize((function(){return a.getDefaultLibFileName(o)})),L=a.getDefaultLibLocation?a.getDefaultLibLocation():e.getDirectoryPath(R()),P=e.createDiagnosticCollection(),M=a.getCurrentDirectory(),F=e.getSupportedExtensions(o),$=e.createMap(),B=a.hasInvalidatedResolution||e.returnFalse;if(a.resolveModuleNames)N=function(t,n,r){return a.resolveModuleNames(m(t),n,r).map((function(t){if(!t||void 0!==t.extension)return t;var n=e.clone(t);return n.extension=e.extensionFromPath(t.resolvedFileName),n}))};else{w=e.createModuleResolutionCache(M,(function(e){return a.getCanonicalFileName(e)}));var U=function(t,n){return e.resolveModuleName(t,n,o,a,w).resolvedModule};N=function(e,t){return h(m(e),t,U)}}if(a.resolveTypeReferenceDirectives)D=function(e,t){return a.resolveTypeReferenceDirectives(m(e),t)};else{var V=function(t,n){return e.resolveTypeReferenceDirective(t,n,o,a).resolvedTypeReferenceDirective};D=function(e,t){return h(m(e),t,V)}}var H,G=e.createMap(),j=e.createMap(),K=e.createMap(),W=e.createMap(),z=a.useCaseSensitiveFileNames()?e.createMap():void 0,q=function(t,n){var r=t&&t.getCompilerOptions();return r&&(r.target!==n.target||r.module!==n.module||r.moduleResolution!==n.moduleResolution||r.noResolve!==n.noResolve||r.jsx!==n.jsx||r.allowJs!==n.allowJs||r.disableSizeLimit!==n.disableSizeLimit||r.baseUrl!==n.baseUrl||!e.equalOwnProperties(r.paths,n.paths))}(l,o),J=function(){if(!l)return 0;var t=l.getCompilerOptions();if(e.changesAffectModuleResolution(t,o))return l.structureIsReused=0;e.Debug.assert(!(3&l.structureIsReused));var n=l.getRootFileNames();if(!e.arrayIsEqualTo(n,s))return l.structureIsReused=0;if(!e.arrayIsEqualTo(o.types,t.types))return l.structureIsReused=0;var r=[],i=[],c=[];if(l.structureIsReused=2,l.getMissingFilePaths().some((function(e){return a.fileExists(e)})))return l.structureIsReused=0;var u,d=l.getSourceFiles();!function(e){e[e.Exists=0]="Exists",e[e.Modified=1]="Modified"}(u||(u={}));for(var p=e.createMap(),h=0,f=d;h<f.length;h++){var m=f[h];if(!(w=a.getSourceFileByPath?a.getSourceFileByPath(m.fileName,m.path,o.target,void 0,q):a.getSourceFile(m.fileName,o.target,void 0,q)))return l.structureIsReused=0;e.Debug.assert(!w.redirectInfo,"Host should not return a redirect source file from `getSourceFile`");var g=void 0;if(m.redirectInfo){if(w!==m.redirectInfo.unredirected)return l.structureIsReused=0;g=!1,w=m}else if(l.redirectTargetsSet.has(m.path)){if(w!==m)return l.structureIsReused=0;g=!1}else g=w!==m;w.path=m.path,i.push(w.path);var v=l.sourceFileToPackageName.get(m.path);if(void 0!==v){var T=p.get(v),x=g?1:0;if(void 0!==T&&1===x||1===T)return l.structureIsReused=0;p.set(v,x)}g?(m.hasNoDefaultLib!==w.hasNoDefaultLib&&(l.structureIsReused=1),e.arrayIsEqualTo(m.referencedFiles,w.referencedFiles,Se)||(l.structureIsReused=1),Ie(w),e.arrayIsEqualTo(m.imports,w.imports,Ce)||(l.structureIsReused=1),e.arrayIsEqualTo(m.moduleAugmentations,w.moduleAugmentations,Ce)||(l.structureIsReused=1),(524288&m.flags)!=(524288&w.flags)&&(l.structureIsReused=1),e.arrayIsEqualTo(m.typeReferenceDirectives,w.typeReferenceDirectives,Se)||(l.structureIsReused=1),c.push({oldFile:m,newFile:w})):B(m.path)&&(l.structureIsReused=1,c.push({oldFile:m,newFile:w})),r.push(w)}if(2!==l.structureIsReused)return l.structureIsReused;y=c.map((function(e){return e.newFile.path}));for(var S=0,C=c;S<C.length;S++){var A=C[S],w=(m=A.oldFile,A.newFile),O=e.getNormalizedAbsolutePath(w.fileName,M);if(N){var R=_(w),L=oe(R,O,w,{program:l,file:m,modifiedFilePaths:y});e.hasChangesInResolutions(R,L,m.resolvedModules,e.moduleResolutionIsEqualTo)?(l.structureIsReused=1,w.resolvedModules=e.zipToMap(R,L)):w.resolvedModules=m.resolvedModules}if(D){var P=e.map(w.typeReferenceDirectives,(function(e){return e.fileName}));L=D(P,O);e.hasChangesInResolutions(P,L,m.resolvedTypeReferenceDirectiveNames,e.typeDirectiveIsEqualTo)?(l.structureIsReused=1,w.resolvedTypeReferenceDirectiveNames=e.zipToMap(P,L)):w.resolvedTypeReferenceDirectiveNames=m.resolvedTypeReferenceDirectiveNames}}if(2!==l.structureIsReused)return l.structureIsReused;if(a.hasChangedAutomaticTypeDirectiveNames)return l.structureIsReused=1;H=l.getMissingFilePaths();for(var F=0;F<r.length;F++)W.set(i[F],r[F]),l.isSourceFileFromExternalLibrary(l.getSourceFileByPath(i[F]))&&I.set(i[F],!0);b=r,E=l.getFileProcessingDiagnostics();for(var $=0,U=c;$<U.length;$++){var V=U[$];E.reattachFileDiagnostics(V.newFile)}return k=l.getResolvedTypeReferenceDirectives(),j=l.sourceFileToPackageName,K=l.redirectTargetsSet,l.structureIsReused=2}();if(2!==J){e.forEach(s,(function(e){return xe(e,!1)}));var Y=e.getAutomaticTypeDirectiveNames(o,a);if(Y.length)for(var X=o.configFilePath?e.getDirectoryPath(o.configFilePath):a.getCurrentDirectory(),Q=e.combinePaths(X,"__inferred type names__.ts"),Z=D(Y,Q),ee=0;ee<Y.length;ee++)Le(Y[ee],Z[ee]);O||(o.lib?e.forEach(o.lib,(function(t){xe(e.combinePaths(L,t),!0)})):xe(R(),!0)),H=e.arrayFrom(W.keys(),(function(e){return e})).filter((function(e){return!W.get(e)}))}if(e.Debug.assert(!!H),w=void 0,l&&a.onReleaseOldSourceFile)for(var te=0,ne=l.getSourceFiles();te<ne.length;te++){var re=ne[te];pe(re.path)&&!q||a.onReleaseOldSourceFile(re,l.getCompilerOptions())}return l=void 0,c={getRootFileNames:function(){return s},getSourceFile:pe,getSourceFileByPath:he,getSourceFiles:function(){return b},getMissingFilePaths:function(){return H},getCompilerOptions:function(){return o},getSyntacticDiagnostics:function(e,t){return fe(e,me,t)},getOptionsDiagnostics:function(){return e.sortAndDeduplicateDiagnostics(e.concatenate(E.getGlobalDiagnostics(),e.concatenate(P.getGlobalDiagnostics(),o.configFile?P.getDiagnostics(o.configFile.fileName):[])))},getGlobalDiagnostics:function(){return e.sortAndDeduplicateDiagnostics(ce().getGlobalDiagnostics().slice())},getSemanticDiagnostics:function(e,t){return fe(e,ge,t)},getDeclarationDiagnostics:function(e,t){var n=c.getCompilerOptions();return!e||n.out||n.outFile?ve(e,t):fe(e,Ee,t)},getTypeChecker:ue,getClassifiableNames:function(){if(!g){ue(),g=e.createUnderscoreEscapedMap();for(var t=0,n=b;t<n.length;t++){var r=n[t];e.copyEntries(r.classifiableNames,g)}}return g},getDiagnosticsProducingTypeChecker:ce,getCommonSourceDirectory:se,emit:function(t,n,r,i,s){return _e((function(){return function(t,n,r,i,s,a){var l=[];if(o.noEmit)return{diagnostics:l,sourceMaps:void 0,emittedFiles:void 0,emitSkipped:!0};if(o.noEmitOnError){var c=t.getOptionsDiagnostics(i).concat(t.getSyntacticDiagnostics(n,i),t.getGlobalDiagnostics(i),t.getSemanticDiagnostics(n,i));if(0===c.length&&t.getCompilerOptions().declaration&&(l=t.getDeclarationDiagnostics(void 0,i)),c.length>0||l.length>0)return{diagnostics:e.concatenate(c,l),sourceMaps:void 0,emittedFiles:void 0,emitSkipped:!0}}var u=ce().getEmitResolver(o.outFile||o.out?void 0:n);e.performance.mark("beforeEmit");var d=s?[]:e.getTransformers(o,a),p=e.emitFiles(u,ae(r),n,s,d);return e.performance.mark("afterEmit"),e.performance.measure("Emit","beforeEmit","afterEmit"),p}(c,t,n,r,i,s)}))},getCurrentDirectory:function(){return M},getNodeCount:function(){return ce().getNodeCount()},getIdentifierCount:function(){return ce().getIdentifierCount()},getSymbolCount:function(){return ce().getSymbolCount()},getTypeCount:function(){return ce().getTypeCount()},getFileProcessingDiagnostics:function(){return E},getResolvedTypeReferenceDirectives:function(){return k},isSourceFileFromExternalLibrary:le,isSourceFileDefaultLibrary:function(t){if(t.hasNoDefaultLib)return!0;if(!o.noLib)return!1;return o.lib?e.forEach(o.lib,(function(n){return 0===e.compareStrings(t.fileName,e.combinePaths(L,n),!a.useCaseSensitiveFileNames())})):0===e.compareStrings(t.fileName,R(),!a.useCaseSensitiveFileNames())},dropDiagnosticsProducingTypeChecker:function(){d=void 0},getSourceFileFromReference:function(e,t){return Ae(n(t.fileName,e.fileName),(function(e){return W.get(ie(e))}))},sourceFileToPackageName:j,redirectTargetsSet:K},function(){o.isolatedModules&&(o.declaration&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"declaration","isolatedModules"),o.noEmitOnError&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"noEmitOnError","isolatedModules"),o.out&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"out","isolatedModules"),o.outFile&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"outFile","isolatedModules"));o.inlineSourceMap&&(o.sourceMap&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"sourceMap","inlineSourceMap"),o.mapRoot&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"mapRoot","inlineSourceMap"));o.paths&&void 0===o.baseUrl&&Ve(e.Diagnostics.Option_paths_cannot_be_used_without_specifying_baseUrl_option,"paths");if(o.paths)for(var t in o.paths)if(e.hasProperty(o.paths,t))if(e.hasZeroOrOneAsteriskCharacter(t)||Be(!0,t,e.Diagnostics.Pattern_0_can_have_at_most_one_Asterisk_character,t),e.isArray(o.paths[t])){var n=o.paths[t].length;0===n&&Be(!1,t,e.Diagnostics.Substitutions_for_pattern_0_shouldn_t_be_an_empty_array,t);for(var r=0;r<n;r++){var i=o.paths[t][r],s=typeof i;"string"===s?e.hasZeroOrOneAsteriskCharacter(i)||$e(t,r,e.Diagnostics.Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character,i,t):$e(t,r,e.Diagnostics.Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2,i,t,s)}}else Be(!1,t,e.Diagnostics.Substitutions_for_pattern_0_should_be_an_array,t);o.sourceMap||o.inlineSourceMap||(o.inlineSources&&Ve(e.Diagnostics.Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided,"inlineSources"),o.sourceRoot&&Ve(e.Diagnostics.Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided,"sourceRoot"));o.out&&o.outFile&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"out","outFile");o.mapRoot&&!o.sourceMap&&Ve(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"mapRoot","sourceMap");o.declarationDir&&(o.declaration||Ve(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"declarationDir","declaration"),(o.out||o.outFile)&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"declarationDir",o.out?"out":"outFile"));o.lib&&o.noLib&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"lib","noLib");o.noImplicitUseStrict&&(void 0===o.alwaysStrict?o.strict:o.alwaysStrict)&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"noImplicitUseStrict","alwaysStrict");var l=o.target||0,c=o.outFile||o.out,u=e.forEach(b,(function(t){return e.isExternalModule(t)&&!t.isDeclarationFile?t:void 0}));if(o.isolatedModules){o.module===e.ModuleKind.None&&l<2&&Ve(e.Diagnostics.Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES2015_or_higher,"isolatedModules","target");var d=e.forEach(b,(function(t){return e.isExternalModule(t)||t.isDeclarationFile?void 0:t}));if(d){var p=e.getErrorSpanForNode(d,d);P.add(e.createFileDiagnostic(d,p.start,p.length,e.Diagnostics.Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided))}}else if(u&&l<2&&o.module===e.ModuleKind.None){var h=e.getErrorSpanForNode(u,u.externalModuleIndicator);P.add(e.createFileDiagnostic(u,h.start,h.length,e.Diagnostics.Cannot_use_imports_exports_or_module_augmentations_when_module_is_none))}if(c)if(o.module&&o.module!==e.ModuleKind.AMD&&o.module!==e.ModuleKind.System)Ve(e.Diagnostics.Only_amd_and_system_modules_are_supported_alongside_0,o.out?"out":"outFile","module");else if(void 0===o.module&&u){var f=e.getErrorSpanForNode(u,u.externalModuleIndicator);P.add(e.createFileDiagnostic(u,f.start,f.length,e.Diagnostics.Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system,o.out?"out":"outFile"))}if(o.outDir||o.sourceRoot||o.mapRoot){var m=se();o.outDir&&""===m&&e.forEach(b,(function(t){return e.getRootLength(t.fileName)>1}))&&Ve(e.Diagnostics.Cannot_find_the_common_subdirectory_path_for_the_input_files,"outDir")}!o.noEmit&&o.allowJs&&o.declaration&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"allowJs","declaration");o.checkJs&&!o.allowJs&&P.add(e.createCompilerDiagnostic(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"checkJs","allowJs"));o.emitDecoratorMetadata&&!o.experimentalDecorators&&Ve(e.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"emitDecoratorMetadata","experimentalDecorators");o.jsxFactory?(o.reactNamespace&&Ve(e.Diagnostics.Option_0_cannot_be_specified_with_option_1,"reactNamespace","jsxFactory"),e.parseIsolatedEntityName(o.jsxFactory,l)||He("jsxFactory",e.Diagnostics.Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name,o.jsxFactory)):o.reactNamespace&&!e.isIdentifierText(o.reactNamespace,l)&&He("reactNamespace",e.Diagnostics.Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier,o.reactNamespace);if(!o.noEmit&&!o.suppressOutputPathCheck){var _=ae(),g=e.createMap();e.forEachEmittedFile(_,(function(e){y(e.jsFilePath,g),y(e.declarationFilePath,g)}))}function y(t,n){if(t){var r,i=ie(t);if(W.has(i))o.configFilePath||(r=e.chainDiagnosticMessages(void 0,e.Diagnostics.Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript_files_Learn_more_at_https_Colon_Slash_Slashaka_ms_Slashtsconfig)),r=e.chainDiagnosticMessages(r,e.Diagnostics.Cannot_write_file_0_because_it_would_overwrite_input_file,t),We(t,e.createCompilerDiagnosticFromMessageChain(r));var s=a.useCaseSensitiveFileNames()?i:i.toLocaleLowerCase();n.has(s)?We(t,e.createCompilerDiagnostic(e.Diagnostics.Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files,t)):n.set(s,!0)}}}(),e.performance.mark("afterProgram"),e.performance.measure("Program","beforeProgram","afterProgram"),c;function ie(t){return e.toPath(t,M,Me)}function se(){if(void 0===u){var t=e.filter(b,(function(t){return e.sourceFileMayBeEmitted(t,o,le)}));(u=o.rootDir&&function(t,n){var r=!0;if(t)for(var i=a.getCanonicalFileName(e.getNormalizedAbsolutePath(n,M)),s=0,l=t;s<l.length;s++){var c=l[s];if(!c.isDeclarationFile)0!==a.getCanonicalFileName(e.getNormalizedAbsolutePath(c.fileName,M)).indexOf(i)&&(P.add(e.createCompilerDiagnostic(e.Diagnostics.File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files,c.fileName,o.rootDir)),r=!1)}return r}(t,o.rootDir)?e.getNormalizedAbsolutePath(o.rootDir,M):function(e){for(var t=[],n=0,i=e;n<i.length;n++){var s=i[n];s.isDeclarationFile||t.push(s.fileName)}return r(t,M,Me)}(t))&&u[u.length-1]!==e.directorySeparator&&(u+=e.directorySeparator)}return u}function oe(t,n,r,i){if(0===J&&!r.ambientModuleNames.length)return N(t,n);var s,l,c,u=i.program&&i.program.getSourceFile(n);if(u!==r&&r.resolvedModules){for(var d=[],p=0,h=t;p<h.length;p++){var f=h[p],m=r.resolvedModules.get(f);d.push(m)}return d}for(var _={},g=0;g<t.length;g++){f=t[g];if(r===u&&!B(u.path)){var y=u&&u.resolvedModules.get(f);if(y){e.isTraceEnabled(o,a)&&e.trace(a,e.Diagnostics.Reusing_resolution_of_module_0_to_file_1_from_old_program,f,n),(l||(l=new Array(t.length)))[g]=y,(c||(c=[])).push(f);continue}}var b=!1;e.contains(r.ambientModuleNames,f)?(b=!0,e.isTraceEnabled(o,a)&&e.trace(a,e.Diagnostics.Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1,f,n)):b=k(f,i),b?(l||(l=new Array(t.length)))[g]=_:(s||(s=[])).push(f)}var v=s&&s.length?N(s,n,c):e.emptyArray;if(!l)return e.Debug.assert(v.length===t.length),v;var T=0;for(g=0;g<l.length;g++)l[g]?l[g]===_&&(l[g]=void 0):(l[g]=v[T],T++);return e.Debug.assert(T===v.length),l;function k(t,n){if(e.getResolvedModule(n.file,t))return!1;var r=n.program&&n.program.getTypeChecker().tryFindAmbientModuleWithoutAugmentations(t);if(!r||!r.declarations)return!1;var i=e.forEach(r.declarations,(function(t){var r=e.getSourceFileOfNode(t);return!e.contains(n.modifiedFilePaths,r.path)&&r}));return!!i&&(e.isTraceEnabled(o,a)&&e.trace(a,e.Diagnostics.Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified,t,i.fileName),!0)}}function ae(e){return{getCanonicalFileName:Me,getCommonSourceDirectory:c.getCommonSourceDirectory,getCompilerOptions:c.getCompilerOptions,getCurrentDirectory:function(){return M},getNewLine:function(){return a.getNewLine()},getSourceFile:c.getSourceFile,getSourceFileByPath:c.getSourceFileByPath,getSourceFiles:c.getSourceFiles,isSourceFileFromExternalLibrary:le,writeFile:e||function(e,t,n,r,i){return a.writeFile(e,t,n,r,i)},isEmitBlocked:de}}function le(e){return I.get(e.path)}function ce(){return d||(d=e.createTypeChecker(c,!0))}function ue(){return p||(p=e.createTypeChecker(c,!1))}function de(e){return $.has(ie(e))}function pe(e){return he(ie(e))}function he(e){return W.get(e)}function fe(t,n,r){return t?n(t,r):e.sortAndDeduplicateDiagnostics(e.flatMap(c.getSourceFiles(),(function(e){return r&&r.throwIfCancellationRequested(),n(e,r)})))}function me(t){return e.isSourceFileJavaScript(t)?(t.additionalSyntacticDiagnostics||(t.additionalSyntacticDiagnostics=function(t){return _e((function(){var n=[],r=t;return i(t),n;function i(t){switch(r.kind){case 146:case 149:if(r.questionToken===t)return void n.push(c(t,e.Diagnostics._0_can_only_be_used_in_a_ts_file,"?"));case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:case 226:if(r.type===t)return void n.push(c(t,e.Diagnostics.types_can_only_be_used_in_a_ts_file))}switch(t.kind){case 237:return void n.push(c(t,e.Diagnostics.import_can_only_be_used_in_a_ts_file));case 243:if(t.isExportEquals)return void n.push(c(t,e.Diagnostics.export_can_only_be_used_in_a_ts_file));break;case 259:if(108===t.token)return void n.push(c(t,e.Diagnostics.implements_clauses_can_only_be_used_in_a_ts_file));break;case 230:return void n.push(c(t,e.Diagnostics.interface_declarations_can_only_be_used_in_a_ts_file));case 233:return void n.push(c(t,e.Diagnostics.module_declarations_can_only_be_used_in_a_ts_file));case 231:return void n.push(c(t,e.Diagnostics.type_aliases_can_only_be_used_in_a_ts_file));case 232:return void n.push(c(t,e.Diagnostics.enum_declarations_can_only_be_used_in_a_ts_file));case 203:return void n.push(c(t,e.Diagnostics.non_null_assertions_can_only_be_used_in_a_ts_file));case 202:return void n.push(c(t.type,e.Diagnostics.type_assertion_expressions_can_only_be_used_in_a_ts_file));case 184:e.Debug.fail()}var o=r;r=t,e.forEachChild(t,i,s),r=o}function s(t){switch(r.decorators!==t||o.experimentalDecorators||n.push(c(r,e.Diagnostics.Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning)),r.kind){case 229:case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:if(t===r.typeParameters)return void n.push(l(t,e.Diagnostics.type_parameter_declarations_can_only_be_used_in_a_ts_file));case 208:if(t===r.modifiers)return a(t,208===r.kind);break;case 149:if(t===r.modifiers){for(var s=0,u=t;s<u.length;s++){var d=u[s];115!==d.kind&&n.push(c(d,e.Diagnostics._0_can_only_be_used_in_a_ts_file,e.tokenToString(d.kind)))}return}break;case 146:if(t===r.modifiers)return void n.push(l(t,e.Diagnostics.parameter_modifiers_can_only_be_used_in_a_ts_file));break;case 181:case 182:case 201:if(t===r.typeArguments)return void n.push(l(t,e.Diagnostics.type_arguments_can_only_be_used_in_a_ts_file))}for(var p=0,h=t;p<h.length;p++){i(h[p])}}function a(t,r){for(var i=0,s=t;i<s.length;i++){var o=s[i];switch(o.kind){case 76:if(r)continue;case 114:case 112:case 113:case 131:case 124:case 117:n.push(c(o,e.Diagnostics._0_can_only_be_used_in_a_ts_file,e.tokenToString(o.kind)))}}}function l(n,r,i,s,o){var a=n.pos;return e.createFileDiagnostic(t,a,n.end-a,r,i,s,o)}function c(n,r,i,s,o){return e.createDiagnosticForNodeInSourceFile(t,n,r,i,s,o)}}))}(t),e.isCheckJsEnabledForFile(t,o)&&(t.additionalSyntacticDiagnostics=e.concatenate(t.additionalSyntacticDiagnostics,t.jsDocDiagnostics))),e.concatenate(t.additionalSyntacticDiagnostics,t.parseDiagnostics)):t.parseDiagnostics}function _e(t){try{return t()}catch(t){throw t instanceof e.OperationCanceledException&&(p=void 0,d=void 0),t}}function ge(e,t){return ke(e,t,v,ye)}function ye(t,n){return _e((function(){if(o.skipLibCheck&&t.isDeclarationFile||o.skipDefaultLibCheck&&t.hasNoDefaultLib)return e.emptyArray;var r=ce();e.Debug.assert(!!t.bindDiagnostics);var i=3===t.scriptKind||4===t.scriptKind||5===t.scriptKind||e.isCheckJsEnabledForFile(t,o),s=i?t.bindDiagnostics:e.emptyArray,a=i?r.getDiagnostics(t,n):e.emptyArray,l=E.getDiagnostics(t.fileName),c=P.getDiagnostics(t.fileName),u=s.concat(a,l,c);return e.filter(u,be)}))}function be(n){var r=n.file,i=n.start;if(r)for(var s=e.getLineStarts(r),o=e.computeLineAndCharacterOfPosition(s,i).line;o>0;){var a=r.text.slice(s[o-1],s[o]),l=t.exec(a);if(!l)return!0;if(l[3])return!1;o--}return!0}function ve(e,t){return ke(e,t,T,Te)}function Te(t,n){return _e((function(){var r=ce().getEmitResolver(t,n);return e.getDeclarationDiagnostics(ae(e.noop),r,t)}))}function ke(t,n,r,i){var s=t?r.perFile&&r.perFile.get(t.path):r.allDiagnostics;if(s)return s;var o=i(t,n)||e.emptyArray;return t?(r.perFile||(r.perFile=e.createMap()),r.perFile.set(t.path,o)):r.allDiagnostics=o,o}function Ee(e,t){return e.isDeclarationFile?[]:ve(e,t)}function xe(t,n){we(e.normalizePath(t),n,void 0)}function Se(e,t){return e.fileName===t.fileName}function Ce(e,t){return 9===e.kind?9===t.kind&&e.text===t.text:71===t.kind&&e.escapedText===t.escapedText}function Ie(t){if(!t.imports){var n,r,i,s=e.isSourceFileJavaScript(t),a=e.isExternalModule(t);if(o.importHelpers&&(o.isolatedModules||a)&&!t.isDeclarationFile){var l=e.createLiteral(e.externalHelpersModuleNameText),c=e.createImportDeclaration(void 0,void 0,void 0);l.parent=c,c.parent=t,n=[l]}for(var u=0,d=t.statements;u<d.length;u++){var p=d[u];h(p,!1),(524288&t.flags||s)&&f(p)}return t.imports=n||e.emptyArray,t.moduleAugmentations=r||e.emptyArray,void(t.ambientModuleNames=i||e.emptyArray)}function h(s,o){switch(s.kind){case 238:case 237:case 244:var l=e.getExternalModuleName(s);if(!l||!e.isStringLiteral(l))break;if(!l.text)break;o&&e.isExternalModuleNameRelative(l.text)||(n||(n=[])).push(l);break;case 233:if(e.isAmbientModule(s)&&(o||e.hasModifier(s,2)||t.isDeclarationFile)){var c=s.name,u=e.getTextOfIdentifierOrLiteral(c);if(a||o&&!e.isExternalModuleNameRelative(u))(r||(r=[])).push(c);else if(!o){t.isDeclarationFile&&(i||(i=[])).push(u);var d=s.body;if(d)for(var p=0,f=d.statements;p<f.length;p++){h(f[p],!0)}}}}}function f(t){e.isRequireCall(t,!0)||e.isImportCall(t)&&1===t.arguments.length&&9===t.arguments[0].kind?(n||(n=[])).push(t.arguments[0]):e.forEachChild(t,f)}}function Ae(t,n,r,i){if(e.hasExtension(t)){if(!o.allowNonTsExtensions&&!e.forEach(F,(function(n){return e.fileExtensionIs(a.getCanonicalFileName(t),n)})))return void(r&&r(e.Diagnostics.File_0_has_unsupported_extension_The_only_supported_extensions_are_1,t,"'"+F.join("', '")+"'"));var s=n(t);return r&&(s?i&&a.getCanonicalFileName(t)===a.getCanonicalFileName(i.fileName)&&r(e.Diagnostics.A_file_cannot_have_a_reference_to_itself):r(e.Diagnostics.File_0_not_found,t)),s}var l=o.allowNonTsExtensions&&n(t);if(l)return l;if(!r||!o.allowNonTsExtensions){var c=e.forEach(F,(function(e){return n(t+e)}));return r&&!c&&r(e.Diagnostics.File_0_not_found,t+".ts"),c}r(e.Diagnostics.File_0_not_found,t)}function we(t,n,r,i,s,o){Ae(t,(function(e){return De(e,ie(e),n,i,s,o,r)}),(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];E.add(void 0!==i&&void 0!==o&&void 0!==s?e.createFileDiagnostic.apply(void 0,[i,s,o-s,t].concat(n)):e.createCompilerDiagnostic.apply(void 0,[t].concat(n)))}),i)}function Ne(t,n,r,i,s){void 0!==r&&void 0!==i&&void 0!==s?E.add(e.createFileDiagnostic(r,i,s-i,e.Diagnostics.File_name_0_differs_from_already_included_file_name_1_only_in_casing,t,n)):E.add(e.createCompilerDiagnostic(e.Diagnostics.File_name_0_differs_from_already_included_file_name_1_only_in_casing,t,n))}function De(t,n,r,i,s,l,c){if(W.has(n)){var u=W.get(n);return u&&o.forceConsistentCasingInFileNames&&e.getNormalizedAbsolutePath(u.fileName,M)!==e.getNormalizedAbsolutePath(t,M)&&Ne(t,u.fileName,i,s,l),u&&I.get(u.path)&&0===S?(I.set(u.path,!1),o.noResolve||(Oe(u,r),Re(u)),C.set(u.path,!1),Fe(u)):u&&C.get(u.path)&&S<x&&(C.set(u.path,!1),Fe(u)),u}var d=a.getSourceFile(t,o.target,(function(n){void 0!==i&&void 0!==s&&void 0!==l?E.add(e.createFileDiagnostic(i,s,l-s,e.Diagnostics.Cannot_read_file_0_Colon_1,t,n)):E.add(e.createCompilerDiagnostic(e.Diagnostics.Cannot_read_file_0_Colon_1,t,n))}),q);if(c){var p=c.name+"/"+c.subModuleName+"@"+c.version,h=G.get(p);if(h){var f=function(e,t,n,r){var i=Object.create(e);return i.fileName=n,i.path=r,i.redirectInfo={redirectTarget:e,unredirected:t},Object.defineProperties(i,{id:{get:function(){return this.redirectInfo.redirectTarget.id},set:function(e){this.redirectInfo.redirectTarget.id=e}},symbol:{get:function(){return this.redirectInfo.redirectTarget.symbol},set:function(e){this.redirectInfo.redirectTarget.symbol=e}}}),i}(h,d,t,n);return K.set(h.path,!0),W.set(n,f),j.set(n,c.name),b.push(f),f}d&&(G.set(p,d),j.set(n,c.name))}if(W.set(n,d),d){if(I.set(n,S>0),d.path=n,a.useCaseSensitiveFileNames()){var m=n.toLowerCase(),_=z.get(m);_?Ne(t,_.fileName,i,s,l):z.set(m,d)}O=O||d.hasNoDefaultLib,o.noResolve||(Oe(d,r),Re(d)),Fe(d),r?b.unshift(d):b.push(d)}return d}function Oe(t,r){e.forEach(t.referencedFiles,(function(e){we(n(e.fileName,t.fileName),r,void 0,t,e.pos,e.end)}))}function Re(t){for(var n=e.map(t.typeReferenceDirectives,(function(e){return e.fileName.toLocaleLowerCase()})),r=D(n,t.fileName),i=0;i<n.length;i++){var s=t.typeReferenceDirectives[i],o=r[i],a=s.fileName.toLocaleLowerCase();e.setResolvedTypeReferenceDirective(t,a,o),Le(a,o,t,s.pos,s.end)}}function Le(t,n,r,i,s){var o=k.get(t);if(!o||!o.primary){var l=!0;if(n)if(n.primary)we(n.resolvedFileName,!1,n.packageId,r,i,s);else if(o){if(n.resolvedFileName!==o.resolvedFileName)a.readFile(n.resolvedFileName)!==pe(o.resolvedFileName).text&&E.add(Pe(r,i,s,e.Diagnostics.Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_library_to_resolve_the_conflict,t,n.resolvedFileName,o.resolvedFileName));l=!1}else we(n.resolvedFileName,!1,n.packageId,r,i,s);else E.add(Pe(r,i,s,e.Diagnostics.Cannot_find_type_definition_file_for_0,t));l&&k.set(t,n)}}function Pe(t,n,r,i){for(var s=[],o=4;o<arguments.length;o++)s[o-4]=arguments[o];return void 0===t||void 0===n||void 0===r?e.createCompilerDiagnostic.apply(void 0,[i].concat(s)):e.createFileDiagnostic.apply(void 0,[t,n,r-n,i].concat(s))}function Me(e){return a.getCanonicalFileName(e)}function Fe(t){if(Ie(t),t.imports.length||t.moduleAugmentations.length){var n=_(t),r={program:l,file:t,modifiedFilePaths:y},i=oe(n,e.getNormalizedAbsolutePath(t.fileName,M),t,r);e.Debug.assert(i.length===n.length);for(var s=0;s<n.length;s++){var a=i[s];if(e.setResolvedModule(t,n[s],a),a){var c=a.isExternalLibraryImport,u=!e.extensionIsTypeScript(a.extension),d=c&&u,p=a.resolvedFileName;c&&S++;var h=d&&S>x,m=p&&!f(o,a)&&!o.noResolve&&s<t.imports.length&&!h&&!(u&&!o.allowJs);if(h)C.set(t.path,!0);else if(m){De(p,ie(p),!1,t,e.skipTrivia(t.text,t.imports[s].pos),t.imports[s].end,a.packageId)}c&&S--}}}else t.resolvedModules=void 0}function $e(t,n,r,i,s,a){for(var l=!0,c=0,u=Ue();c<u.length;c++){var d=u[c];if(e.isObjectLiteralExpression(d.initializer))for(var p=0,h=e.getPropertyAssignment(d.initializer,t);p<h.length;p++){var f=h[p];e.isArrayLiteralExpression(f.initializer)&&f.initializer.elements.length>n&&(P.add(e.createDiagnosticForNodeInSourceFile(o.configFile,f.initializer.elements[n],r,i,s,a)),l=!1)}}l&&P.add(e.createCompilerDiagnostic(r,i,s,a))}function Be(t,n,r,i){for(var s=!0,o=0,a=Ue();o<a.length;o++){var l=a[o];e.isObjectLiteralExpression(l.initializer)&&Ke(l.initializer,t,n,void 0,r,i)&&(s=!1)}s&&P.add(e.createCompilerDiagnostic(r,i))}function Ue(){var t=je();return t?e.getPropertyAssignment(t,"paths"):e.emptyArray}function Ve(e,t,n){Ge(!0,t,n,e,t,n)}function He(e,t,n){Ge(!1,e,void 0,t,n)}function Ge(t,n,r,i,s,o){var a=je();(!a||!Ke(a,t,n,r,i,s,o))&&P.add(e.createCompilerDiagnostic(i,s,o))}function je(){if(void 0===A&&(A=null,o.configFile&&o.configFile.jsonObject))for(var t=0,n=e.getPropertyAssignment(o.configFile.jsonObject,"compilerOptions");t<n.length;t++){var r=n[t];if(e.isObjectLiteralExpression(r.initializer)){A=r.initializer;break}}return A}function Ke(t,n,r,i,s,a,l){for(var c=e.getPropertyAssignment(t,r,i),u=0,d=c;u<d.length;u++){var p=d[u];P.add(e.createDiagnosticForNodeInSourceFile(o.configFile,n?p.name:p.initializer,s,a,l))}return!!c.length}function We(e,t){$.set(ie(e),!0),P.add(t)}},e.getResolutionDiagnostic=f}(ts||(ts={})),function(e){var t,n;function r(e){return e&&void 0!==e.enableAutoDiscovery&&void 0===e.enable?{enable:e.enableAutoDiscovery,include:e.include||[],exclude:e.exclude||[]}:e}function i(){if(t)return t;var n=e.createMap(),r=e.createMap();return e.forEach(e.optionDeclarations,(function(e){n.set(e.name.toLowerCase(),e),e.shortName&&r.set(e.shortName,e.name)})),t={optionNameMap:n,shortOptionNames:r}}function s(t){return o(t,e.createCompilerDiagnostic)}function o(t,n){var r=e.arrayFrom(t.type.keys()).map((function(e){return"'"+e+"'"})).join(", ");return n(e.Diagnostics.Argument_for_0_option_must_be_Colon_1,"--"+t.name,r)}function a(e,t,n){return L(e,P(t||""),n)}function l(t,n,r){if(void 0===n&&(n=""),n=P(n),!e.startsWith(n,"-")){if(""===n)return[];var i=n.split(",");switch(t.element.type){case"number":return e.map(i,parseInt);case"string":return e.map(i,(function(e){return e||""}));default:return e.filter(e.map(i,(function(e){return a(t.element,e,r)})),(function(e){return!!e}))}}}function c(e,t){void 0===t&&(t=!1),e=e.toLowerCase();var n=i(),r=n.optionNameMap,s=n.shortOptionNames;if(t){var o=s.get(e);void 0!==o&&(e=o)}return r.get(e)}function u(t,n){var r=e.parseJsonText(t,n);return{config:f(r,r.parseDiagnostics),error:r.parseDiagnostics.length?r.parseDiagnostics[0]:void 0}}function d(t,n){var r=p(t,n);return e.isString(r)?e.parseJsonText(t,r):{parseDiagnostics:[r]}}function p(t,n){var r;try{r=n(t)}catch(n){return e.createCompilerDiagnostic(e.Diagnostics.Cannot_read_file_0_Colon_1,t,n.message)}return void 0===r?e.createCompilerDiagnostic(e.Diagnostics.The_specified_path_does_not_exist_Colon_0,t):r}function h(t){return e.arrayToMap(t,(function(e){return e.name}))}function f(e,t){return m(e,t,void 0,void 0)}function m(t,n,r,i){return t.jsonObject?s(t.jsonObject,r,void 0,void 0):{};function s(s,o,c,u){for(var d={},p=0,h=s.properties;p<h.length;p++){var f=h[p];if(261===f.kind){f.questionToken&&n.push(e.createDiagnosticForNodeInSourceFile(t,f.questionToken,e.Diagnostics._0_can_only_be_used_in_a_ts_file,"?")),l(f.name)||n.push(e.createDiagnosticForNodeInSourceFile(t,f.name,e.Diagnostics.String_literal_with_double_quotes_expected));var m=e.unescapeLeadingUnderscores(e.getTextOfPropertyName(f.name)),_=o?o.get(m):void 0;c&&!_&&n.push(e.createDiagnosticForNodeInSourceFile(t,f.name,c,m));var y=a(f.initializer,_);if(void 0!==m&&(d[m]=y,i&&(u||o===r))){var b=g(_,y);u?b&&i.onSetValidOptionKeyValueInParent(u,_,y):o===r&&(b?i.onSetValidOptionKeyValueInRoot(m,f.name,y,f.initializer):_||i.onSetUnknownOptionKeyValueInRoot(m,f.name,y,f.initializer))}}else n.push(e.createDiagnosticForNodeInSourceFile(t,f,e.Diagnostics.Property_assignment_expected))}return d}function a(r,i){switch(r.kind){case 101:return m(i&&"boolean"!==i.type),!0;case 86:return m(i&&"boolean"!==i.type),!1;case 95:return m(i&&"extends"===i.name),null;case 9:l(r)||n.push(e.createDiagnosticForNodeInSourceFile(t,r,e.Diagnostics.String_literal_with_double_quotes_expected)),m(i&&e.isString(i.type)&&"string"!==i.type);var c=r.text;if(i&&!e.isString(i.type)){var u=i;u.type.has(c.toLowerCase())||n.push(o(u,(function(n,i,s){return e.createDiagnosticForNodeInSourceFile(t,r,n,i,s)})))}return c;case 8:return m(i&&"number"!==i.type),Number(r.text);case 178:m(i&&"object"!==i.type);var d=r;if(i){var p=i;return s(d,p.elementOptions,p.extraKeyDiagnosticMessage,p.name)}return s(d,void 0,void 0,void 0);case 177:return m(i&&"list"!==i.type),h=r.elements,f=i&&i.element,h.map((function(e){return a(e,f)}))}var h,f;return void(i?m(!0):n.push(e.createDiagnosticForNodeInSourceFile(t,r,e.Diagnostics.Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_literal)));function m(s){s&&n.push(e.createDiagnosticForNodeInSourceFile(t,r,e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,i.name,_(i)))}}function l(n){return e.isStringLiteral(n)&&e.isStringDoubleQuoted(n,t)}}function _(t){return"list"===t.type?"Array":e.isString(t.type)?t.type:"string"}function g(t,n){if(t)return!!b(n)||("list"===t.type?e.isArray(n):typeof n===(e.isString(t.type)?t.type:"string"))}function y(e,t){t&&Object.defineProperty(e,"configFile",{enumerable:!1,writable:!1,value:t})}function b(e){return null==e}function v(t,n){return e.getDirectoryPath(e.toPath(t,n,e.identity))}function T(t,n,r,i,s,o,a,l){void 0===s&&(s={}),void 0===a&&(a=[]),void 0===l&&(l=[]),e.Debug.assert(void 0===t&&void 0!==n||void 0!==t&&void 0===n);var c=[],u=e.createGetCanonicalFileName(r.useCaseSensitiveFileNames),d=x(t,n,r,i,o,u,a,c),p=d.raw,h=e.extend(s,d.options||{});h.configFilePath=o,y(h,n);var f=function(){var t,s,u;e.hasProperty(p,"files")&&!b(p.files)&&(e.isArray(p.files)?0===(t=p.files).length&&T(e.Diagnostics.The_files_list_in_config_file_0_is_empty,o||"tsconfig.json"):T(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"files","Array"));e.hasProperty(p,"include")&&!b(p.include)&&(e.isArray(p.include)?s=p.include:T(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"include","Array"));if(e.hasProperty(p,"exclude")&&!b(p.exclude))e.isArray(p.exclude)?u=p.exclude:T(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"exclude","Array");else{var d=p.compilerOptions&&p.compilerOptions.outDir;d&&(u=[d])}void 0===t&&void 0===s&&(s=["**/*"]);var f=function(t,n,r,i,s,o,a,l,c){var u,d;i=e.normalizePath(i),n&&(u=H(n,a,!1,c,"include"));r&&(d=H(r,a,!0,c,"exclude"));var p=function(t,n,r,i){var s=e.getRegularExpressionForWildcard(n,r,"exclude"),o=s&&new RegExp(s,i?"":"i"),a={};if(void 0!==t){for(var l=[],c=0,u=t;c<u.length;c++){var d=u[c],p=e.normalizePath(e.combinePaths(r,d));if(!o||!o.test(p)){var h=G(p,i);if(h){var f=h.key,m=h.flags,_=a[f];(void 0===_||_<m)&&(a[f]=m,1===m&&l.push(f))}}}for(var f in a)if(e.hasProperty(a,f))for(var g=0,y=l;g<y.length;g++){var b=y[g];f!==b&&e.containsPath(b,f,r,!i)&&delete a[f]}}return a}(u,d,i,o.useCaseSensitiveFileNames);return V({filesSpecs:t,includeSpecs:n,excludeSpecs:r,validatedIncludeSpecs:u,validatedExcludeSpecs:d,wildcardDirectories:p},i,s,o,l)}(t,s,u,o?v(o,i):i,h,r,c,l,n);0!==f.fileNames.length||e.hasProperty(p,"files")||0!==a.length||c.push(k(f.spec,o));return f}(),m=f.fileNames,_=f.wildcardDirectories,g=f.spec;return{options:h,fileNames:m,typeAcquisition:d.typeAcquisition||A(),raw:p,errors:c,wildcardDirectories:_,compileOnSave:!!p.compileOnSave,configFileSpecs:g};function T(t,r,i){n||c.push(e.createCompilerDiagnostic(t,r,i))}}function k(t,n){var r=t.includeSpecs,i=t.excludeSpecs;return e.createCompilerDiagnostic(e.Diagnostics.No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2,n||"tsconfig.json",JSON.stringify(r||[]),JSON.stringify(i||[]))}function E(e){return!!e.options}function x(t,r,i,s,o,a,l,c){s=e.normalizeSlashes(s);var u=e.toPath(o||"",s,a);if(l.indexOf(u)>=0)return c.push(e.createCompilerDiagnostic(e.Diagnostics.Circularity_detected_while_resolving_configuration_Colon_0,l.concat([u]).join(" -> "))),{raw:t||f(r,c)};var p=t?function(t,n,r,i,s,o){e.hasProperty(t,"excludes")&&o.push(e.createCompilerDiagnostic(e.Diagnostics.Unknown_option_excludes_Did_you_mean_exclude));var a,l=I(t.compilerOptions,r,o,s),c=w(t.typeAcquisition||t.typingOptions,r,o,s);if(t.compileOnSave=function(t,n,r){if(!e.hasProperty(t,e.compileOnSaveCommandLineOption.name))return;var i=D(e.compileOnSaveCommandLineOption,t.compileOnSave,n,r);if("boolean"==typeof i&&i)return i;return!1}(t,r,o),t.extends)if(e.isString(t.extends)){var u=s?v(s,r):r;a=S(t.extends,n,u,i,o,e.createCompilerDiagnostic)}else o.push(e.createCompilerDiagnostic(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"extends","string"));return{raw:t,options:l,typeAcquisition:c,extendedConfigPath:a}}(t,i,s,a,o,c):function(t,r,i,s,o,a){var l,c,u,d=C(o),p={onSetValidOptionKeyValueInParent:function(t,n,r){e.Debug.assert("compilerOptions"===t||"typeAcquisition"===t||"typingOptions"===t),("compilerOptions"===t?d:"typeAcquisition"===t?l||(l=A(o)):c||(c=A(o)))[n.name]=O(n,i,r)},onSetValidOptionKeyValueInRoot:function(n,l,c,d){switch(n){case"extends":var p=o?v(o,i):i;return void(u=S(c,r,p,s,a,(function(n,r){return e.createDiagnosticForNodeInSourceFile(t,d,n,r)})));case"files":return void(0===c.length&&a.push(e.createDiagnosticForNodeInSourceFile(t,d,e.Diagnostics.The_files_list_in_config_file_0_is_empty,o||"tsconfig.json")))}},onSetUnknownOptionKeyValueInRoot:function(n,r,i,s){"excludes"===n&&a.push(e.createDiagnosticForNodeInSourceFile(t,r,e.Diagnostics.Unknown_option_excludes_Did_you_mean_exclude))}},f=m(t,a,(void 0===n&&(n=h([{name:"compilerOptions",type:"object",elementOptions:h(e.optionDeclarations),extraKeyDiagnosticMessage:e.Diagnostics.Unknown_compiler_option_0},{name:"typingOptions",type:"object",elementOptions:h(e.typeAcquisitionDeclarations),extraKeyDiagnosticMessage:e.Diagnostics.Unknown_type_acquisition_option_0},{name:"typeAcquisition",type:"object",elementOptions:h(e.typeAcquisitionDeclarations),extraKeyDiagnosticMessage:e.Diagnostics.Unknown_type_acquisition_option_0},{name:"extends",type:"string"},{name:"files",type:"list",element:{name:"files",type:"string"}},{name:"include",type:"list",element:{name:"include",type:"string"}},{name:"exclude",type:"list",element:{name:"exclude",type:"string"}},e.compileOnSaveCommandLineOption])),n),p);l||(l=c?void 0!==c.enableAutoDiscovery?{enable:c.enableAutoDiscovery,include:c.include,exclude:c.exclude}:c:A(o));return{raw:f,options:d,typeAcquisition:l,extendedConfigPath:u}}(r,i,s,a,o,c);if(p.extendedConfigPath){l=l.concat([u]);var _=function(t,n,r,i,s,o,a){var l=d(n,(function(e){return r.readFile(e)}));t&&(t.extendedSourceFiles||(t.extendedSourceFiles=[])).push(l.fileName);if(l.parseDiagnostics.length)return void a.push.apply(a,l.parseDiagnostics);var c,u=e.getDirectoryPath(n),p=x(void 0,l,r,u,e.getBaseFileName(n),s,o,a);t&&(c=t.extendedSourceFiles).push.apply(c,l.extendedSourceFiles);if(E(p)){var h=e.convertToRelativePath(u,i,s),f=function(t){return e.isRootedDiskPath(t)?t:e.combinePaths(h,t)},m=function(t){_[t]&&(_[t]=e.map(_[t],f))},_=p.raw;m("include"),m("exclude"),m("files")}return p}(r,p.extendedConfigPath,i,s,a,l,c);if(_&&E(_)){var g=_.raw,y=p.raw,b=function(e){var t=y[e]||g[e];t&&(y[e]=t)};b("include"),b("exclude"),b("files"),void 0===y.compileOnSave&&(y.compileOnSave=g.compileOnSave),p.options=e.assign({},_.options,p.options)}}return p}function S(t,n,r,i,s,o){if(t=e.normalizeSlashes(t),e.isRootedDiskPath(t)||e.startsWith(t,"./")||e.startsWith(t,"../")){var a=e.toPath(t,r,i);if(n.fileExists(a)||e.endsWith(a,".json")||(a+=".json",n.fileExists(a)))return a;s.push(o(e.Diagnostics.File_0_does_not_exist,t))}else s.push(o(e.Diagnostics.A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not,t))}function C(t){return"jsconfig.json"===e.getBaseFileName(t)?{allowJs:!0,maxNodeModuleJsDepth:2,allowSyntheticDefaultImports:!0,skipLibCheck:!0}:{}}function I(t,n,r,i){var s=C(i);return N(e.optionDeclarations,t,n,s,e.Diagnostics.Unknown_compiler_option_0,r),s}function A(t){return{enable:"jsconfig.json"===e.getBaseFileName(t),include:[],exclude:[]}}function w(t,n,i,s){var o=A(s),a=r(t);return N(e.typeAcquisitionDeclarations,a,n,o,e.Diagnostics.Unknown_type_acquisition_option_0,i),o}function N(t,n,r,i,s,o){if(n){var a=h(t);for(var l in n){var c=a.get(l);c?i[c.name]=D(c,n[l],r,o):o.push(e.createCompilerDiagnostic(s,l))}}}function D(t,n,r,i){if(g(t,n)){var s=t.type;return"list"===s&&e.isArray(n)?function(t,n,r,i){return e.filter(e.map(n,(function(e){return D(t.element,e,r,i)})),(function(e){return!!e}))}(t,n,r,i):e.isString(s)?R(t,r,n):L(t,n,i)}i.push(e.createCompilerDiagnostic(e.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,t.name,_(t)))}function O(t,n,r){if(!b(r)){if("list"===t.type){var i=t;return i.element.isFilePath||!e.isString(i.element.type)?e.filter(e.map(r,(function(e){return O(i.element,n,e)})),(function(e){return!!e})):r}return e.isString(t.type)?R(t,n,r):t.type.get(e.isString(r)?r.toLowerCase():r)}}function R(t,n,r){return t.isFilePath&&""===(r=e.normalizePath(e.combinePaths(n,r)))&&(r="."),r}function L(e,t,n){if(!b(t)){var r=t.toLowerCase(),i=e.type.get(r);if(void 0!==i)return i;n.push(s(e))}}function P(e){return"function"==typeof e.trim?e.trim():e.replace(/^[\s]+|[\s]+$/g,"")}e.compileOnSaveCommandLineOption={name:"compileOnSave",type:"boolean"},e.optionDeclarations=[{name:"help",shortName:"h",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Print_this_message},{name:"help",shortName:"?",type:"boolean"},{name:"all",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Show_all_compiler_options},{name:"version",shortName:"v",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Print_the_compiler_s_version},{name:"init",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file},{name:"project",shortName:"p",type:"string",isFilePath:!0,showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,paramType:e.Diagnostics.FILE_OR_DIRECTORY,description:e.Diagnostics.Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json},{name:"pretty",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Stylize_errors_and_messages_using_color_and_context_experimental},{name:"watch",shortName:"w",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Command_line_Options,description:e.Diagnostics.Watch_input_files},{name:"target",shortName:"t",type:e.createMapFromTemplate({es3:0,es5:1,es6:2,es2015:2,es2016:3,es2017:4,esnext:5}),paramType:e.Diagnostics.VERSION,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT},{name:"module",shortName:"m",type:e.createMapFromTemplate({none:e.ModuleKind.None,commonjs:e.ModuleKind.CommonJS,amd:e.ModuleKind.AMD,system:e.ModuleKind.System,umd:e.ModuleKind.UMD,es6:e.ModuleKind.ES2015,es2015:e.ModuleKind.ES2015,esnext:e.ModuleKind.ESNext}),paramType:e.Diagnostics.KIND,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext},{name:"lib",type:"list",element:{name:"lib",type:e.createMapFromTemplate({es5:"lib.es5.d.ts",es6:"lib.es2015.d.ts",es2015:"lib.es2015.d.ts",es7:"lib.es2016.d.ts",es2016:"lib.es2016.d.ts",es2017:"lib.es2017.d.ts",esnext:"lib.esnext.d.ts",dom:"lib.dom.d.ts","dom.iterable":"lib.dom.iterable.d.ts",webworker:"lib.webworker.d.ts",scripthost:"lib.scripthost.d.ts","es2015.core":"lib.es2015.core.d.ts","es2015.collection":"lib.es2015.collection.d.ts","es2015.generator":"lib.es2015.generator.d.ts","es2015.iterable":"lib.es2015.iterable.d.ts","es2015.promise":"lib.es2015.promise.d.ts","es2015.proxy":"lib.es2015.proxy.d.ts","es2015.reflect":"lib.es2015.reflect.d.ts","es2015.symbol":"lib.es2015.symbol.d.ts","es2015.symbol.wellknown":"lib.es2015.symbol.wellknown.d.ts","es2016.array.include":"lib.es2016.array.include.d.ts","es2017.object":"lib.es2017.object.d.ts","es2017.sharedmemory":"lib.es2017.sharedmemory.d.ts","es2017.string":"lib.es2017.string.d.ts","es2017.intl":"lib.es2017.intl.d.ts","esnext.asynciterable":"lib.esnext.asynciterable.d.ts"})},showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_library_files_to_be_included_in_the_compilation_Colon},{name:"allowJs",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Allow_javascript_files_to_be_compiled},{name:"checkJs",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Report_errors_in_js_files},{name:"jsx",type:e.createMapFromTemplate({preserve:1,"react-native":3,react:2}),paramType:e.Diagnostics.KIND,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_JSX_code_generation_Colon_preserve_react_native_or_react},{name:"declaration",shortName:"d",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Generates_corresponding_d_ts_file},{name:"sourceMap",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Generates_corresponding_map_file},{name:"outFile",type:"string",isFilePath:!0,paramType:e.Diagnostics.FILE,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Concatenate_and_emit_output_to_single_file},{name:"outDir",type:"string",isFilePath:!0,paramType:e.Diagnostics.DIRECTORY,showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Redirect_output_structure_to_the_directory},{name:"rootDir",type:"string",isFilePath:!0,paramType:e.Diagnostics.LOCATION,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir},{name:"removeComments",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Do_not_emit_comments_to_output},{name:"noEmit",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Do_not_emit_outputs},{name:"importHelpers",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Import_emit_helpers_from_tslib},{name:"downlevelIteration",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3},{name:"isolatedModules",type:"boolean",category:e.Diagnostics.Basic_Options,description:e.Diagnostics.Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule},{name:"strict",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Enable_all_strict_type_checking_options},{name:"noImplicitAny",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Raise_error_on_expressions_and_declarations_with_an_implied_any_type},{name:"strictNullChecks",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Enable_strict_null_checks},{name:"strictFunctionTypes",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Enable_strict_checking_of_function_types},{name:"noImplicitThis",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Raise_error_on_this_expressions_with_an_implied_any_type},{name:"alwaysStrict",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Strict_Type_Checking_Options,description:e.Diagnostics.Parse_in_strict_mode_and_emit_use_strict_for_each_source_file},{name:"noUnusedLocals",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_errors_on_unused_locals},{name:"noUnusedParameters",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_errors_on_unused_parameters},{name:"noImplicitReturns",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_error_when_not_all_code_paths_in_function_return_a_value},{name:"noFallthroughCasesInSwitch",type:"boolean",showInSimplifiedHelpView:!0,category:e.Diagnostics.Additional_Checks,description:e.Diagnostics.Report_errors_for_fallthrough_cases_in_switch_statement},{name:"moduleResolution",type:e.createMapFromTemplate({node:e.ModuleResolutionKind.NodeJs,classic:e.ModuleResolutionKind.Classic}),paramType:e.Diagnostics.STRATEGY,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6},{name:"baseUrl",type:"string",isFilePath:!0,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Base_directory_to_resolve_non_absolute_module_names},{name:"paths",type:"object",isTSConfigOnly:!0,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl},{name:"rootDirs",type:"list",isTSConfigOnly:!0,element:{name:"rootDirs",type:"string",isFilePath:!0},category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime},{name:"typeRoots",type:"list",element:{name:"typeRoots",type:"string",isFilePath:!0},category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.List_of_folders_to_include_type_definitions_from},{name:"types",type:"list",element:{name:"types",type:"string"},showInSimplifiedHelpView:!0,category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Type_declaration_files_to_be_included_in_compilation},{name:"allowSyntheticDefaultImports",type:"boolean",category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typechecking},{name:"preserveSymlinks",type:"boolean",category:e.Diagnostics.Module_Resolution_Options,description:e.Diagnostics.Do_not_resolve_the_real_path_of_symlinks},{name:"sourceRoot",type:"string",isFilePath:!0,paramType:e.Diagnostics.LOCATION,category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations},{name:"mapRoot",type:"string",isFilePath:!0,paramType:e.Diagnostics.LOCATION,category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations},{name:"inlineSourceMap",type:"boolean",category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file},{name:"inlineSources",type:"boolean",category:e.Diagnostics.Source_Map_Options,description:e.Diagnostics.Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap_to_be_set},{name:"experimentalDecorators",type:"boolean",category:e.Diagnostics.Experimental_Options,description:e.Diagnostics.Enables_experimental_support_for_ES7_decorators},{name:"emitDecoratorMetadata",type:"boolean",category:e.Diagnostics.Experimental_Options,description:e.Diagnostics.Enables_experimental_support_for_emitting_type_metadata_for_decorators},{name:"jsxFactory",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h},{name:"diagnostics",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Show_diagnostic_information},{name:"extendedDiagnostics",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Show_verbose_diagnostic_information},{name:"traceResolution",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Enable_tracing_of_the_name_resolution_process},{name:"listFiles",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Print_names_of_files_part_of_the_compilation},{name:"listEmittedFiles",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Print_names_of_generated_files_part_of_the_compilation},{name:"out",type:"string",isFilePath:!1,category:e.Diagnostics.Advanced_Options,paramType:e.Diagnostics.FILE,description:e.Diagnostics.Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file},{name:"reactNamespace",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react_JSX_emit},{name:"skipDefaultLibCheck",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files},{name:"charset",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.The_character_set_of_the_input_files},{name:"emitBOM",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files},{name:"locale",type:"string",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.The_locale_used_when_displaying_messages_to_the_user_e_g_en_us},{name:"newLine",type:e.createMapFromTemplate({crlf:0,lf:1}),paramType:e.Diagnostics.NEWLINE,category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix},{name:"noErrorTruncation",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_truncate_error_messages},{name:"noLib",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_include_the_default_library_file_lib_d_ts},{name:"noResolve",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files},{name:"stripInternal",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_emit_declarations_for_code_that_has_an_internal_annotation},{name:"disableSizeLimit",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Disable_size_limitations_on_JavaScript_projects},{name:"noImplicitUseStrict",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_emit_use_strict_directives_in_module_output},{name:"noEmitHelpers",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_generate_custom_helper_functions_like_extends_in_compiled_output},{name:"noEmitOnError",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_emit_outputs_if_any_errors_were_reported},{name:"preserveConstEnums",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_erase_const_enum_declarations_in_generated_code},{name:"declarationDir",type:"string",isFilePath:!0,paramType:e.Diagnostics.DIRECTORY,category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Output_directory_for_generated_declaration_files},{name:"skipLibCheck",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Skip_type_checking_of_declaration_files},{name:"allowUnusedLabels",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_report_errors_on_unused_labels},{name:"allowUnreachableCode",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Do_not_report_errors_on_unreachable_code},{name:"suppressExcessPropertyErrors",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Suppress_excess_property_checks_for_object_literals},{name:"suppressImplicitAnyIndexErrors",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures},{name:"forceConsistentCasingInFileNames",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Disallow_inconsistently_cased_references_to_the_same_file},{name:"maxNodeModuleJsDepth",type:"number",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files},{name:"noStrictGenericChecks",type:"boolean",category:e.Diagnostics.Advanced_Options,description:e.Diagnostics.Disable_strict_checking_of_generic_signatures_in_function_types},{name:"plugins",type:"list",isTSConfigOnly:!0,element:{name:"plugin",type:"object"},description:e.Diagnostics.List_of_language_service_plugins}],e.typeAcquisitionDeclarations=[{name:"enableAutoDiscovery",type:"boolean"},{name:"enable",type:"boolean"},{name:"include",type:"list",element:{name:"include",type:"string"}},{name:"exclude",type:"list",element:{name:"exclude",type:"string"}}],e.defaultInitCompilerOptions={module:e.ModuleKind.CommonJS,target:1,strict:!0},e.convertEnableAutoDiscoveryToEnable=r,e.createCompilerDiagnosticForInvalidCustomType=s,e.parseCustomTypeOption=a,e.parseListTypeOption=l,e.parseCommandLine=function(t,n){var r={},i=[],s=[];return o(t),{options:r,fileNames:i,errors:s};function o(t){for(var n=0;n<t.length;){var o=t[n];if(n++,64===o.charCodeAt(0))u(o.slice(1));else if(45===o.charCodeAt(0)){var d=c(o.slice(45===o.charCodeAt(1)?2:1),!0);if(d)if(d.isTSConfigOnly)s.push(e.createCompilerDiagnostic(e.Diagnostics.Option_0_can_only_be_specified_in_tsconfig_json_file,d.name));else switch(t[n]||"boolean"===d.type||s.push(e.createCompilerDiagnostic(e.Diagnostics.Compiler_option_0_expects_an_argument,d.name)),d.type){case"number":r[d.name]=parseInt(t[n]),n++;break;case"boolean":var p=t[n];r[d.name]="false"!==p,"false"!==p&&"true"!==p||n++;break;case"string":r[d.name]=t[n]||"",n++;break;case"list":var h=l(d,t[n],s);r[d.name]=h||[],h&&n++;break;default:r[d.name]=a(d,t[n],s),n++}else s.push(e.createCompilerDiagnostic(e.Diagnostics.Unknown_compiler_option_0,o))}else i.push(o)}}function u(t){var r=n?n(t):e.sys.readFile(t);if(r){for(var i=[],a=0;;){for(;a<r.length&&r.charCodeAt(a)<=32;)a++;if(a>=r.length)break;var l=a;if(34===r.charCodeAt(l)){for(a++;a<r.length&&34!==r.charCodeAt(a);)a++;a<r.length?(i.push(r.substring(l+1,a)),a++):s.push(e.createCompilerDiagnostic(e.Diagnostics.Unterminated_quoted_string_in_response_file_0,t))}else{for(;r.charCodeAt(a)>32;)a++;i.push(r.substring(l,a))}}o(i)}else s.push(e.createCompilerDiagnostic(e.Diagnostics.File_0_not_found,t))}},e.readConfigFile=function(t,n){var r=p(t,n);return e.isString(r)?u(t,r):{config:{},error:r}},e.parseConfigFileTextToJson=u,e.readJsonConfigFile=d,e.convertToObject=f,e.generateTSConfig=function(t,n,r){var s=function(t){var n=e.createMap(),r=i().optionNameMap,s=function(i){if(e.hasProperty(t,i)){if(r.has(i)&&r.get(i).category===e.Diagnostics.Command_line_Options)return"continue";var s=t[i],l=r.get(i.toLowerCase());if(l){var c=o(l);c?"list"===l.type?n.set(i,s.map((function(e){return a(e,c)}))):n.set(i,a(s,c)):n.set(i,s)}}};for(var l in t)s(l);return n}(e.extend(t,e.defaultInitCompilerOptions));return function(){for(var t=e.createMultiMap(),i=0,o=e.optionDeclarations;i<o.length;i++){var a=o[i],u=a.category;void 0!==u&&u!==e.Diagnostics.Command_line_Options&&u!==e.Diagnostics.Advanced_Options&&t.add(e.getLocaleSpecificMessage(u),a)}var d=0,p=0,h=[],f=[];t.forEach((function(t,n){0!==h.length&&(h.push(""),f.push("")),h.push("/* "+n+" */"),f.push("");for(var r=0,i=t;r<i.length;r++){var o=i[r],a=void 0;a=s.has(o.name)?'"'+o.name+'": '+JSON.stringify(s.get(o.name))+((p+=1)===s.size?"":","):'// "'+o.name+'": '+JSON.stringify(l(o))+",",h.push(a),f.push("/* "+(o.description&&e.getLocaleSpecificMessage(o.description)||o.name)+" */"),d=Math.max(a.length,d)}}));var m=c(2),_=[];_.push("{"),_.push(m+'"compilerOptions": {');for(var g=0;g<h.length;g++){var y=h[g],b=f[g];_.push(y&&""+m+m+y+(b&&c(d-y.length+2)+b))}if(n.length){_.push(m+"},"),_.push(m+'"files": [');for(g=0;g<n.length;g++)_.push(""+m+m+JSON.stringify(n[g])+(g===n.length-1?"":","));_.push(m+"]")}else _.push(m+"}");return _.push("}"),_.join(r)}();function o(e){return"string"===e.type||"number"===e.type||"boolean"===e.type?void 0:"list"===e.type?o(e.element):e.type}function a(t,n){return e.forEachEntry(n,(function(e,n){if(e===t)return n}))}function l(e){switch(e.type){case"number":return 1;case"boolean":return!0;case"string":return e.isFilePath?"./":"";case"list":return[];case"object":return{};default:return e.type.keys().next().value}}function c(e){return Array(e+1).join(" ")}},e.parseJsonConfigFileContent=function(e,t,n,r,i,s,o){return T(e,void 0,t,n,r,i,s,o)},e.parseJsonSourceFileConfigFileContent=function(e,t,n,r,i,s,o){return T(void 0,e,t,n,r,i,s,o)},e.setConfigFileInOptions=y,e.isErrorNoInputFiles=function(t){return t.code===e.Diagnostics.No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2.code},e.getErrorForNoInputFiles=k,e.convertCompilerOptionsFromJson=function(e,t,n){var r=[];return{options:I(e,t,r,n),errors:r}},e.convertTypeAcquisitionFromJson=function(e,t,n){var r=[];return{options:w(e,t,r,n),errors:r}};var M=/(^|\/)\*\*\/?$/,F=/(^|\/)\*\*\/(.*\/)?\*\*($|\/)/,$=/(^|\/)\*\*\/(.*\/)?\.\.($|\/)/,B=/\/[^/]*?[*?][^/]*\//,U=/^[^*?]*(?=\/[^/]*[*?])/;function V(t,n,r,i,s){void 0===s&&(s=[]),n=e.normalizePath(n);var o=i.useCaseSensitiveFileNames?W:z,a=e.createMap(),l=e.createMap(),c=t.filesSpecs,u=t.validatedIncludeSpecs,d=t.validatedExcludeSpecs,p=t.wildcardDirectories,h=e.getSupportedExtensions(r,s);if(c)for(var f=0,m=c;f<m.length;f++){var _=m[f],g=e.getNormalizedAbsolutePath(_,n);a.set(o(g),g)}if(u&&u.length>0)for(var y=0,b=i.readDirectory(n,h,d,u,void 0);y<b.length;y++){if(!j(g=b[y],a,l,h,o)){K(g,l,h,o);var v=o(g);a.has(v)||l.has(v)||l.set(v,g)}}var T=e.arrayFrom(a.values()),k=e.arrayFrom(l.values());return{fileNames:T.concat(k),wildcardDirectories:p,spec:t}}function H(t,n,r,i,s){return t.filter((function(t){var o=function(t,n){if(!n&&M.test(t))return e.Diagnostics.File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0;if(F.test(t))return e.Diagnostics.File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0;if($.test(t))return e.Diagnostics.File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0}(t,r);return void 0!==o&&n.push(function(t,n){if(i&&i.jsonObject)for(var r=0,o=e.getPropertyAssignment(i.jsonObject,s);r<o.length;r++){var a=o[r];if(e.isArrayLiteralExpression(a.initializer))for(var l=0,c=a.initializer.elements;l<c.length;l++){var u=c[l];if(e.isStringLiteral(u)&&u.text===n)return e.createDiagnosticForNodeInSourceFile(i,u,t,n)}}return e.createCompilerDiagnostic(t,n)}(o,t)),void 0===o}))}function G(t,n){var r=U.exec(t);return r?{key:n?r[0]:r[0].toLowerCase(),flags:B.test(t)?1:0}:e.isImplicitGlob(t)?{key:t,flags:1}:void 0}function j(t,n,r,i,s){for(var o=e.getExtensionPriority(t,i),a=e.adjustExtensionPriority(o,i),l=0;l<a;l++){var c=i[l],u=s(e.changeExtension(t,c));if(n.has(u)||r.has(u))return!0}return!1}function K(t,n,r,i){for(var s=e.getExtensionPriority(t,r),o=e.getNextLowestExtensionPriority(s,r);o<r.length;o++){var a=r[o],l=i(e.changeExtension(t,a));n.delete(l)}}function W(e){return e}function z(e){return e.toLowerCase()}function q(t,n){switch(n.type){case"object":case"string":return"";case"number":return"number"==typeof t?t:"";case"boolean":return"boolean"==typeof t?t:"";case"list":var r=n.element;return e.isArray(t)?t.map((function(e){return q(e,r)})):"";default:return e.forEachEntry(n.type,(function(e,n){if(e===t)return n}))}}e.getFileNamesFromConfigSpecs=V,e.convertCompilerOptionsForTelemetry=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=c(n);void 0!==r&&(t[n]=q(e[n],r))}return t}}(ts||(ts={})),function(e){!function(e){var t=function(){function e(e){this.text=e}return e.prototype.getText=function(e,t){return 0===e&&t===this.text.length?this.text:this.text.substring(e,t)},e.prototype.getLength=function(){return this.text.length},e.prototype.getChangeRange=function(){},e}();e.fromString=function(e){return new t(e)}}(e.ScriptSnapshot||(e.ScriptSnapshot={}));var t=function(){};e.TextChange=t,function(e){e.none="none",e.definition="definition",e.reference="reference",e.writtenReference="writtenReference"}(e.HighlightSpanKind||(e.HighlightSpanKind={})),function(e){e[e.None=0]="None",e[e.Block=1]="Block",e[e.Smart=2]="Smart"}(e.IndentStyle||(e.IndentStyle={})),function(e){e[e.aliasName=0]="aliasName",e[e.className=1]="className",e[e.enumName=2]="enumName",e[e.fieldName=3]="fieldName",e[e.interfaceName=4]="interfaceName",e[e.keyword=5]="keyword",e[e.lineBreak=6]="lineBreak",e[e.numericLiteral=7]="numericLiteral",e[e.stringLiteral=8]="stringLiteral",e[e.localName=9]="localName",e[e.methodName=10]="methodName",e[e.moduleName=11]="moduleName",e[e.operator=12]="operator",e[e.parameterName=13]="parameterName",e[e.propertyName=14]="propertyName",e[e.punctuation=15]="punctuation",e[e.space=16]="space",e[e.text=17]="text",e[e.typeParameterName=18]="typeParameterName",e[e.enumMemberName=19]="enumMemberName",e[e.functionName=20]="functionName",e[e.regularExpressionLiteral=21]="regularExpressionLiteral"}(e.SymbolDisplayPartKind||(e.SymbolDisplayPartKind={})),function(e){e[e.JavaScript=0]="JavaScript",e[e.SourceMap=1]="SourceMap",e[e.Declaration=2]="Declaration"}(e.OutputFileType||(e.OutputFileType={})),function(e){e[e.None=0]="None",e[e.InMultiLineCommentTrivia=1]="InMultiLineCommentTrivia",e[e.InSingleQuoteStringLiteral=2]="InSingleQuoteStringLiteral",e[e.InDoubleQuoteStringLiteral=3]="InDoubleQuoteStringLiteral",e[e.InTemplateHeadOrNoSubstitutionTemplate=4]="InTemplateHeadOrNoSubstitutionTemplate",e[e.InTemplateMiddleOrTail=5]="InTemplateMiddleOrTail",e[e.InTemplateSubstitutionPosition=6]="InTemplateSubstitutionPosition"}(e.EndOfLineState||(e.EndOfLineState={})),function(e){e[e.Punctuation=0]="Punctuation",e[e.Keyword=1]="Keyword",e[e.Operator=2]="Operator",e[e.Comment=3]="Comment",e[e.Whitespace=4]="Whitespace",e[e.Identifier=5]="Identifier",e[e.NumberLiteral=6]="NumberLiteral",e[e.StringLiteral=7]="StringLiteral",e[e.RegExpLiteral=8]="RegExpLiteral"}(e.TokenClass||(e.TokenClass={})),function(e){e.unknown="",e.warning="warning",e.keyword="keyword",e.scriptElement="script",e.moduleElement="module",e.classElement="class",e.localClassElement="local class",e.interfaceElement="interface",e.typeElement="type",e.enumElement="enum",e.enumMemberElement="enum member",e.variableElement="var",e.localVariableElement="local var",e.functionElement="function",e.localFunctionElement="local function",e.memberFunctionElement="method",e.memberGetAccessorElement="getter",e.memberSetAccessorElement="setter",e.memberVariableElement="property",e.constructorImplementationElement="constructor",e.callSignatureElement="call",e.indexSignatureElement="index",e.constructSignatureElement="construct",e.parameterElement="parameter",e.typeParameterElement="type parameter",e.primitiveType="primitive type",e.label="label",e.alias="alias",e.constElement="const",e.letElement="let",e.directory="directory",e.externalModuleName="external module name",e.jsxAttribute="JSX attribute"}(e.ScriptElementKind||(e.ScriptElementKind={})),function(e){e.none="",e.publicMemberModifier="public",e.privateMemberModifier="private",e.protectedMemberModifier="protected",e.exportedModifier="export",e.ambientModifier="declare",e.staticModifier="static",e.abstractModifier="abstract"}(e.ScriptElementKindModifier||(e.ScriptElementKindModifier={})),function(e){e.comment="comment",e.identifier="identifier",e.keyword="keyword",e.numericLiteral="number",e.operator="operator",e.stringLiteral="string",e.whiteSpace="whitespace",e.text="text",e.punctuation="punctuation",e.className="class name",e.enumName="enum name",e.interfaceName="interface name",e.moduleName="module name",e.typeParameterName="type parameter name",e.typeAliasName="type alias name",e.parameterName="parameter name",e.docCommentTagName="doc comment tag name",e.jsxOpenTagName="jsx open tag name",e.jsxCloseTagName="jsx close tag name",e.jsxSelfClosingTagName="jsx self closing tag name",e.jsxAttribute="jsx attribute",e.jsxText="jsx text",e.jsxAttributeStringLiteralValue="jsx attribute string literal value"}(e.ClassificationTypeNames||(e.ClassificationTypeNames={})),function(e){e[e.comment=1]="comment",e[e.identifier=2]="identifier",e[e.keyword=3]="keyword",e[e.numericLiteral=4]="numericLiteral",e[e.operator=5]="operator",e[e.stringLiteral=6]="stringLiteral",e[e.regularExpressionLiteral=7]="regularExpressionLiteral",e[e.whiteSpace=8]="whiteSpace",e[e.text=9]="text",e[e.punctuation=10]="punctuation",e[e.className=11]="className",e[e.enumName=12]="enumName",e[e.interfaceName=13]="interfaceName",e[e.moduleName=14]="moduleName",e[e.typeParameterName=15]="typeParameterName",e[e.typeAliasName=16]="typeAliasName",e[e.parameterName=17]="parameterName",e[e.docCommentTagName=18]="docCommentTagName",e[e.jsxOpenTagName=19]="jsxOpenTagName",e[e.jsxCloseTagName=20]="jsxCloseTagName",e[e.jsxSelfClosingTagName=21]="jsxSelfClosingTagName",e[e.jsxAttribute=22]="jsxAttribute",e[e.jsxText=23]="jsxText",e[e.jsxAttributeStringLiteralValue=24]="jsxAttributeStringLiteralValue"}(e.ClassificationType||(e.ClassificationType={}))}(ts||(ts={})),function(e){function t(t){switch(t.kind){case 146:case 226:case 176:case 149:case 148:case 261:case 262:case 151:case 150:case 152:case 153:case 154:case 228:case 186:case 187:case 260:case 253:return 1;case 145:case 230:case 231:case 163:return 2;case 283:return void 0===t.name?3:2;case 264:case 229:return 3;case 233:return e.isAmbientModule(t)||1===e.getModuleInstanceState(t)?5:4;case 232:case 241:case 242:case 237:case 238:case 243:case 244:return 7;case 265:return 5}return 7}function n(t){for(;143===t.parent.kind;)t=t.parent;return e.isInternalModuleImportEqualsDeclaration(t.parent)&&t.parent.moduleReference===t}function r(e,t){var n=i(e);return n&&n.parent&&n.parent.kind===t&&n.parent.expression===n}function i(e){return o(e)?e.parent:e}function s(e){return 71===e.kind&&(218===e.parent.kind||217===e.parent.kind)&&e.parent.label===e}function o(e){return e&&e.parent&&179===e.parent.kind&&e.parent.name===e}e.scanner=e.createScanner(5,!0),function(e){e[e.None=0]="None",e[e.Value=1]="Value",e[e.Type=2]="Type",e[e.Namespace=4]="Namespace",e[e.All=7]="All"}(e.SemanticMeaning||(e.SemanticMeaning={})),e.getMeaningFromDeclaration=t,e.getMeaningFromLocation=function(r){return 265===r.kind?1:243===r.parent.kind?7:n(r)?function(t){if(e.Debug.assert(71===t.kind),143===t.parent.kind&&t.parent.right===t&&237===t.parent.parent.kind)return 7;return 4}(r):e.isDeclarationName(r)?t(r.parent):function(t){e.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent);switch(t.kind){case 99:return!e.isPartOfExpression(t);case 169:return!0}switch(t.parent.kind){case 159:return!0;case 201:return!e.isExpressionWithTypeArgumentsInClassExtendsClause(t.parent)}return!1}(r)?2:function(e){return function(e){var t=e,n=!0;if(143===t.parent.kind){for(;t.parent&&143===t.parent.kind;)t=t.parent;n=t.right===e}return 159===t.parent.kind&&!n}(e)||function(e){var t=e,n=!0;if(179===t.parent.kind){for(;t.parent&&179===t.parent.kind;)t=t.parent;n=t.name===e}if(!n&&201===t.parent.kind&&259===t.parent.parent.kind){var r=t.parent.parent.parent;return 229===r.kind&&108===t.parent.parent.token||230===r.kind&&85===t.parent.parent.token}return!1}(e)}(r)?4:e.isTypeParameterDeclaration(r.parent)?(e.Debug.assert(e.isJSDocTemplateTag(r.parent.parent)),2):1},e.isInRightSideOfInternalImportEqualsDeclaration=n,e.isCallExpressionTarget=function(e){return r(e,181)},e.isNewExpressionTarget=function(e){return r(e,182)},e.climbPastPropertyAccess=i,e.getTargetLabel=function(e,t){for(;e;){if(222===e.kind&&e.label.escapedText===t)return e.label;e=e.parent}},e.isJumpStatementTarget=s,e.isLabelName=function(e){return function(e){return 71===e.kind&&222===e.parent.kind&&e.parent.label===e}(e)||s(e)},e.isRightSideOfQualifiedName=function(e){return 143===e.parent.kind&&e.parent.right===e},e.isRightSideOfPropertyAccess=o,e.isNameOfModuleDeclaration=function(e){return 233===e.parent.kind&&e.parent.name===e},e.isNameOfFunctionDeclaration=function(t){return 71===t.kind&&e.isFunctionLike(t.parent)&&t.parent.name===t},e.isLiteralNameOfPropertyDeclarationOrIndexAccess=function(t){switch(t.parent.kind){case 149:case 148:case 261:case 264:case 151:case 150:case 153:case 154:case 233:return e.getNameOfDeclaration(t.parent)===t;case 180:return t.parent.argumentExpression===t;case 144:return!0;case 173:return 171===t.parent.parent.kind}},e.isExpressionOfExternalModuleImportEqualsDeclaration=function(t){return e.isExternalModuleImportEqualsDeclaration(t.parent.parent)&&e.getExternalModuleImportEqualsDeclarationExpression(t.parent.parent)===t},e.getContainerNode=function(e){for(283===e.kind&&(e=e.parent.parent);;){if(!(e=e.parent))return;switch(e.kind){case 265:case 151:case 150:case 228:case 186:case 153:case 154:case 229:case 230:case 232:case 233:return e}}},e.getNodeKind=function t(n){switch(n.kind){case 265:return e.isExternalModule(n)?"module":"script";case 233:return"module";case 229:case 199:return"class";case 230:return"interface";case 231:return"type";case 232:return"enum";case 226:return o(n);case 176:return o(e.getRootDeclaration(n));case 187:case 228:case 186:return"function";case 153:return"getter";case 154:return"setter";case 151:case 150:return"method";case 149:case 148:return"property";case 157:return"index";case 156:return"construct";case 155:return"call";case 152:return"constructor";case 145:return"type parameter";case 264:return"enum member";case 146:return e.hasModifier(n,92)?"property":"parameter";case 237:case 242:case 239:case 246:case 240:return"alias";case 283:return"type";case 194:var r=e.getSpecialPropertyAssignmentKind(n),i=n.right;switch(r){case 0:return"";case 1:case 2:var s=t(i);return""===s?"const":s;case 3:return"method";case 4:return"property";case 5:return e.isFunctionExpression(i)?"method":"property";default:return e.assertTypeIsNever(r),""}default:return""}function o(t){return e.isConst(t)?"const":e.isLet(t)?"let":"var"}},e.isThis=function(t){switch(t.kind){case 99:return!0;case 71:return e.identifierIsThisKeyword(t)&&146===t.parent.kind;default:return!1}};var a=/^\/\/\/\s*</;function l(e,t,n){return e<=n.pos&&t>=n.end}function c(e,t,n,r){return Math.max(e,n)<Math.min(t,r)}function u(t,n){if(e.nodeIsMissing(t))return!1;switch(t.kind){case 229:case 230:case 232:case 178:case 174:case 163:case 207:case 234:case 235:case 241:case 245:return d(t,18,n);case 260:return u(t.block,n);case 182:if(!t.arguments)return!0;case 181:case 185:case 168:return d(t,20,n);case 160:case 161:return u(t.type,n);case 152:case 153:case 154:case 228:case 186:case 151:case 150:case 156:case 155:case 187:return t.body?u(t.body,n):t.type?u(t.type,n):p(t,20,n);case 233:return t.body&&u(t.body,n);case 211:return t.elseStatement?u(t.elseStatement,n):u(t.thenStatement,n);case 210:return u(t.expression,n)||p(t,25);case 177:case 175:case 180:case 144:case 165:return d(t,22,n);case 157:return t.type?u(t.type,n):p(t,22,n);case 257:case 258:return!1;case 214:case 215:case 216:case 213:return u(t.statement,n);case 212:return h(t,106,n)?d(t,20,n):u(t.statement,n);case 162:return u(t.exprName,n);case 189:case 188:case 190:case 197:case 198:return u(t.expression,n);case 183:return u(t.template,n);case 196:return u(e.lastOrUndefined(t.templateSpans),n);case 205:return e.nodeIsPresent(t.literal);case 244:case 238:return e.nodeIsPresent(t.moduleSpecifier);case 192:return u(t.operand,n);case 194:return u(t.right,n);case 195:return u(t.whenFalse,n);default:return!0}}function d(t,n,r){var i=t.getChildren(r);if(i.length){var s=e.lastOrUndefined(i);if(s.kind===n)return!0;if(25===s.kind&&1!==i.length)return i[i.length-2].kind===n}return!1}function p(e,t,n){return!!h(e,t,n)}function h(t,n,r){return e.forEach(t.getChildren(r),(function(e){return e.kind===n&&e}))}function f(t){var n=e.forEach(t.parent.getChildren(),(function(n){if(e.isSyntaxList(n)&&n.pos<=t.pos&&n.end>=t.end)return n}));return e.Debug.assert(!n||e.contains(n.getChildren(),t)),n}function m(e,t,n,r){return g(e,t,!1,r,!1,n)}function _(e,t,n,r){return g(e,t,!0,void 0,r,n)}function g(t,n,r,i,s,o){var a=t;e:for(;;){if(e.isToken(a))return a;for(var l=0,c=a.getChildren();l<c.length;l++){var u=c[l];if(o||!e.isJSDocNode(u)){if((r?u.getFullStart():u.getStart(t,o))>n)break;var d=u.getEnd();if(n<d||n===d&&(1===u.kind||s)){a=u;continue e}if(i&&d===n){var p=y(n,t,u);if(p&&i(p))return p}}}return a}}function y(t,n,r,i){var s=function s(l){if(e.isToken(l))return l;for(var c=l.getChildren(),u=0;u<c.length;u++){var d=c[u];if(t<d.end)return d.getStart(n,i)>=t||!T(d)||b(d)?(p=a(c,u))&&o(p):s(d)}if(e.Debug.assert(void 0!==r||265===l.kind||e.isJSDocCommentContainingNode(l)),c.length){var p;return(p=a(c,c.length))&&o(p)}}(r||n);return e.Debug.assert(!(s&&b(s))),s;function o(t){if(e.isToken(t))return t;var n=t.getChildren(),r=a(n,n.length);return r&&o(r)}function a(t,n){for(var r=n-1;r>=0;r--){if(b(t[r]))e.Debug.assert(r>0,"`JsxText` tokens should not be the first child of `JsxElement | JsxSelfClosingElement`");else if(T(t[r]))return t[r]}}}function b(t){return e.isJsxText(t)&&t.containsOnlyWhiteSpaces}function v(t,n,r,i){return!!e.formatting.getRangeOfEnclosingComment(t,n,!1,void 0,r,i)}function T(e){return 0!==e.getWidth()}function k(t){return 71===t||e.isKeyword(t)}e.getLineStartPositionForPosition=function(t,n){return e.getLineStarts(n)[n.getLineAndCharacterOfPosition(t).line]},e.rangeContainsRange=function(e,t){return l(e.pos,e.end,t)},e.startEndContainsRange=l,e.rangeContainsStartEnd=function(e,t,n){return e.pos<=t&&e.end>=n},e.rangeOverlapsWithStartEnd=function(e,t,n){return c(e.pos,e.end,t,n)},e.startEndOverlapsWithStartEnd=c,e.positionBelongsToNode=function(e,t,n){return t<e.end||!u(e,n)},e.isCompletedNode=u,e.findListItemInfo=function(t){var n=f(t);if(n){var r=n.getChildren();return{listItemIndex:e.indexOfNode(r,t),list:n}}},e.hasChildOfKind=p,e.findChildOfKind=h,e.findContainingList=f,e.getTouchingWord=function(e,t,n){return m(e,t,n,(function(e){return k(e.kind)}))},e.getTouchingPropertyName=function(e,t,n){return m(e,t,n,(function(e){return 9===(t=e.kind)||8===t||k(t);var t}))},e.getTouchingToken=m,e.getTokenAtPosition=_,e.findTokenOnLeftOfPosition=function(t,n){var r=_(t,n,!1);return e.isToken(r)&&n>r.getStart(t)&&n<r.getEnd()?r:y(n,t)},e.findNextToken=function(t,n){return function n(r){if(e.isToken(r)&&r.pos===t.end)return r;for(var i=r.getChildren(),s=0,o=i;s<o.length;s++){var a=o[s];if((a.pos<=t.pos&&a.end>t.end||a.pos===t.end)&&T(a))return n(a)}return}(n)},e.findPrecedingToken=y,e.isInString=function(t,n){var r=y(n,t);if(r&&e.isStringTextContainingNode(r)){var i=r.getStart(),s=r.getEnd();if(i<n&&n<s)return!0;if(n===s)return!!r.isUnterminated}return!1},e.isInsideJsxElementOrAttribute=function(e,t){var n=_(e,t,!1);return!!n&&(10===n.kind||(27===n.kind&&10===n.parent.kind||(27===n.kind&&256===n.parent.kind||(!(!n||18!==n.kind||256!==n.parent.kind)||27===n.kind&&252===n.parent.kind))))},e.isWhiteSpaceOnlyJsxText=b,e.isInTemplateString=function(t,n){var r=_(t,n,!1);return e.isTemplateLiteralKind(r.kind)&&n>r.getStart(t)},e.isInComment=v,e.hasDocComment=function(t,n){var r=_(t,n,!1),i=e.getLeadingCommentRanges(t.text,r.pos);return e.forEach(i,(function(e){var n=t.text;return n.length>=e.pos+3&&"/"===n[e.pos]&&"*"===n[e.pos+1]&&"*"===n[e.pos+2]}))},e.getNodeModifiers=function(t){var n=e.getCombinedModifierFlags(t),r=[];return 8&n&&r.push("private"),16&n&&r.push("protected"),4&n&&r.push("public"),32&n&&r.push("static"),128&n&&r.push("abstract"),1&n&&r.push("export"),e.isInAmbientContext(t)&&r.push("declare"),r.length>0?r.join(","):""},e.getTypeArgumentOrTypeParameterList=function(t){return 159===t.kind||181===t.kind?t.typeArguments:e.isFunctionLike(t)||229===t.kind||230===t.kind?t.typeParameters:void 0},e.isWord=k,e.isComment=function(e){return 2===e||3===e},e.isStringOrRegularExpressionOrTemplateLiteral=function(t){return!(9!==t&&12!==t&&!e.isTemplateLiteralKind(t))},e.isPunctuation=function(e){return 17<=e&&e<=70},e.isInsideTemplateLiteral=function(t,n){return e.isTemplateLiteralKind(t.kind)&&t.getStart()<n&&n<t.getEnd()||!!t.isUnterminated&&n===t.getEnd()},e.isAccessibilityModifier=function(e){switch(e){case 114:case 112:case 113:return!0}return!1},e.cloneCompilerOptions=function(t){var n=e.clone(t);return e.setConfigFileInOptions(n,t&&t.configFile),n},e.isArrayLiteralOrObjectLiteralDestructuringPattern=function e(t){if(177===t.kind||178===t.kind){if(194===t.parent.kind&&t.parent.left===t&&58===t.parent.operatorToken.kind)return!0;if(216===t.parent.kind&&t.parent.initializer===t)return!0;if(e(261===t.parent.kind?t.parent.parent:t.parent))return!0}return!1},e.hasTrailingDirectorySeparator=function(e){var t=e.charAt(e.length-1);return"/"===t||"\\"===t},e.isInReferenceComment=function(e,t){return v(e,t,void 0,(function(t){var n=e.text.substring(t.pos,t.end);return a.test(n)}))},e.isInNonReferenceComment=function(e,t){return v(e,t,void 0,(function(t){var n=e.text.substring(t.pos,t.end);return!a.test(n)}))},e.createTextSpanFromNode=function(t,n){return e.createTextSpanFromBounds(t.getStart(n),t.getEnd())},e.createTextSpanFromRange=function(t){return e.createTextSpanFromBounds(t.pos,t.end)},e.isTypeKeyword=function(e){switch(e){case 119:case 122:case 130:case 133:case 134:case 136:case 137:case 105:return!0;default:return!1}},e.isExternalModuleSymbol=function(t){return e.Debug.assert(!!(1536&t.flags)),34===t.name.charCodeAt(0)},e.nodeSeenTracker=function(){var t=[];return function(n){var r=e.getNodeId(n);return!t[r]&&(t[r]=!0)}}}(ts||(ts={})),function(e){function t(e){return e.declarations&&e.declarations.length>0&&146===e.declarations[0].kind}e.isFirstDeclarationOfSymbolParameter=t;var n=function(){var t,n,s;return c(),{displayParts:function(){return t},writeKeyword:function(t){return l(t,e.SymbolDisplayPartKind.keyword)},writeOperator:function(t){return l(t,e.SymbolDisplayPartKind.operator)},writePunctuation:function(t){return l(t,e.SymbolDisplayPartKind.punctuation)},writeSpace:function(t){return l(t,e.SymbolDisplayPartKind.space)},writeStringLiteral:function(t){return l(t,e.SymbolDisplayPartKind.stringLiteral)},writeParameter:function(t){return l(t,e.SymbolDisplayPartKind.parameterName)},writeProperty:function(t){return l(t,e.SymbolDisplayPartKind.propertyName)},writeSymbol:function(e,n){o(),t.push(r(e,n))},writeLine:function(){t.push(a()),n=!0},increaseIndent:function(){s++},decreaseIndent:function(){s--},clear:c,trackSymbol:e.noop,reportInaccessibleThisError:e.noop,reportPrivateInBaseOfClassExpression:e.noop};function o(){if(n){var r=e.getIndentString(s);r&&t.push(i(r,e.SymbolDisplayPartKind.space)),n=!1}}function l(e,n){o(),t.push(i(e,n))}function c(){t=[],n=!0,s=0}}();function r(n,r){return i(n,function(n){var r=n.flags;if(3&r)return t(n)?e.SymbolDisplayPartKind.parameterName:e.SymbolDisplayPartKind.localName;if(4&r)return e.SymbolDisplayPartKind.propertyName;if(32768&r)return e.SymbolDisplayPartKind.propertyName;if(65536&r)return e.SymbolDisplayPartKind.propertyName;if(8&r)return e.SymbolDisplayPartKind.enumMemberName;if(16&r)return e.SymbolDisplayPartKind.functionName;if(32&r)return e.SymbolDisplayPartKind.className;if(64&r)return e.SymbolDisplayPartKind.interfaceName;if(384&r)return e.SymbolDisplayPartKind.enumName;if(1536&r)return e.SymbolDisplayPartKind.moduleName;if(8192&r)return e.SymbolDisplayPartKind.methodName;if(262144&r)return e.SymbolDisplayPartKind.typeParameterName;if(524288&r)return e.SymbolDisplayPartKind.aliasName;if(2097152&r)return e.SymbolDisplayPartKind.aliasName;return e.SymbolDisplayPartKind.text}(r))}function i(t,n){return{text:t,kind:e.SymbolDisplayPartKind[n]}}function s(t){return i(e.tokenToString(t),e.SymbolDisplayPartKind.keyword)}function o(t){return i(t,e.SymbolDisplayPartKind.text)}e.symbolPart=r,e.displayPart=i,e.spacePart=function(){return i(" ",e.SymbolDisplayPartKind.space)},e.keywordPart=s,e.punctuationPart=function(t){return i(e.tokenToString(t),e.SymbolDisplayPartKind.punctuation)},e.operatorPart=function(t){return i(e.tokenToString(t),e.SymbolDisplayPartKind.operator)},e.textOrKeywordPart=function(t){var n=e.stringToToken(t);return void 0===n?o(t):s(n)},e.textPart=o;function a(){return i("\n",e.SymbolDisplayPartKind.lineBreak)}function l(e){try{return e(n),n.displayParts()}finally{n.clear()}}function c(e){return e.parent&&(242===e.parent.kind||246===e.parent.kind)&&e.parent.propertyName===e}function u(t,n){return e.ensureScriptKind(t,n&&n.getScriptKind&&n.getScriptKind(t))}e.getNewLineOrDefaultFromHost=function(e){return e.getNewLine?e.getNewLine():"\r\n"},e.lineBreakPart=a,e.mapToDisplayParts=l,e.typeToDisplayParts=function(e,t,n,r){return l((function(i){e.getSymbolDisplayBuilder().buildTypeDisplay(t,i,n,r)}))},e.symbolToDisplayParts=function(e,t,n,r,i){return l((function(s){e.getSymbolDisplayBuilder().buildSymbolDisplay(t,s,n,r,i)}))},e.signatureToDisplayParts=function(e,t,n,r){return r|=65536,l((function(i){e.getSymbolDisplayBuilder().buildSignatureDisplay(t,i,n,r)}))},e.getDeclaredName=function(t,n,r){if(c(r)||e.isStringOrNumericLiteral(r)&&144===r.parent.kind)return e.getTextOfIdentifierOrLiteral(r);var i=e.getLocalSymbolForExportDefault(n);return t.symbolToString(i||n)},e.isImportOrExportSpecifierName=c,e.stripQuotes=function(t){var n=t.length;return n>=2&&t.charCodeAt(0)===t.charCodeAt(n-1)&&e.isSingleOrDoubleQuote(t.charCodeAt(0))?t.substring(1,n-1):t},e.scriptKindIs=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var s=u(t,n);return e.forEach(r,(function(e){return e===s}))},e.getScriptKind=u,e.getUniqueSymbolId=function(t,n){return e.getSymbolId(e.skipAlias(t,n))},e.getFirstNonSpaceCharacterPosition=function(t,n){for(;e.isWhiteSpaceLike(t.charCodeAt(n));)n+=1;return n},e.getOpenBrace=function(e,t){return e.body.getFirstToken(t)},e.getOpenBraceOfClassLike=function(t,n){return e.getTokenAtPosition(n,t.members.pos-1,!1)},e.getSourceFileImportLocation=function(t){var n=t.text,r=e.getLeadingCommentRanges(n,0);if(!r)return 0;var i=0;r.length&&3===r[0].kind&&e.isPinnedComment(n,r[0])&&(i=r[0].end+1,r=r.slice(1));for(var s=0,o=r;s<o.length;s++){var a=o[s];if(2!==a.kind||!e.isRecognizedTripleSlashComment(t.text,a.pos,a.end))break;i=a.end+1}return i},e.getSynthesizedDeepClone=function t(n){if(void 0!==n){var r=e.visitEachChild(n,t,e.nullTransformationContext);if(r===n){var i=e.getSynthesizedClone(n);return e.isStringLiteral(i)?i.textSourceNode=n:e.isNumericLiteral(i)&&(i.numericLiteralFlags=n.numericLiteralFlags),i.pos=n.pos,i.end=n.end,i}return r.parent=void 0,r}},e.suppressLeadingAndTrailingTrivia=function(t){e.Debug.assert(void 0!==t),function t(n){e.addEmitFlags(n,512);var r=e.forEachChild(n,(function(e){return e}));r&&t(r)}(t),function t(n){e.addEmitFlags(n,1024);var r=void 0;e.forEachChild(n,(function(e){r=e}),(function(t){t.length&&(r=e.last(t))})),r&&t(r)}(t)}}(ts||(ts={})),function(e){function t(e,t){switch(t){case 233:case 229:case 230:case 228:e.throwIfCancellationRequested()}}function n(n,r,i,s,o){var a=[];return function i(l){if(l&&e.textSpanIntersectsWith(o,l.getFullStart(),l.getFullWidth())){var c=l.kind;if(t(r,c),71===c&&!e.nodeIsMissing(l)){var u=l;if(s.has(u.escapedText)){var d=n.getSymbolAtLocation(l);if(d){var p=function(t,n){var r=t.getFlags();if(0==(788448&r))return;if(32&r)return 11;if(384&r)return 12;if(524288&r)return 16;if(2&n){if(64&r)return 13;if(262144&r)return 15}else if(1536&r&&(4&n||1&n&&i(t)))return 14;return;function i(t){return e.forEach(t.declarations,(function(t){return 233===t.kind&&1===e.getModuleInstanceState(t)}))}}(d,e.getMeaningFromLocation(l));p&&function(e,t,n){a.push(e),a.push(t),a.push(n)}(l.getStart(),l.getWidth(),p)}}}e.forEachChild(l,i)}}(i),{spans:a,endOfLineState:0}}function r(e){switch(e){case 1:return"comment";case 2:return"identifier";case 3:return"keyword";case 4:return"number";case 5:return"operator";case 6:return"string";case 8:return"whitespace";case 9:return"text";case 10:return"punctuation";case 11:return"class name";case 12:return"enum name";case 13:return"interface name";case 14:return"module name";case 15:return"type parameter name";case 16:return"type alias name";case 17:return"parameter name";case 18:return"doc comment tag name";case 19:return"jsx open tag name";case 20:return"jsx close tag name";case 21:return"jsx self closing tag name";case 22:return"jsx attribute";case 23:return"jsx text";case 24:return"jsx attribute string literal value"}}function i(t){e.Debug.assert(t.spans.length%3==0);for(var n=t.spans,i=[],s=0;s<n.length;s+=3)i.push({textSpan:e.createTextSpan(n[s],n[s+1]),classificationType:r(n[s+2])});return i}function s(n,r,i){var s=i.start,o=i.length,a=e.createScanner(5,!1,r.languageVariant,r.text),l=e.createScanner(5,!1,r.languageVariant,r.text),c=[];return y(r),{spans:c,endOfLineState:0};function u(e,t,n){c.push(e),c.push(t),c.push(n)}function d(t,n,i,s){if(3===n){var o=e.parseIsolatedJSDocComment(r.text,i,s);if(o&&o.jsDoc)return o.jsDoc.parent=t,void function(e){var t=e.pos;if(e.tags)for(var n=0,r=e.tags;n<r.length;n++){var i=r[n];switch(i.pos!==t&&p(t,i.pos-t),u(i.atToken.pos,i.atToken.end-i.atToken.pos,10),u(i.tagName.pos,i.tagName.end-i.tagName.pos,18),t=i.tagName.end,i.kind){case 279:s(i);break;case 282:h(i);break;case 281:case 280:y(i.typeExpression)}t=i.end}t!==e.end&&p(t,e.end-t);return;function s(e){e.isNameFirst&&(p(t,e.name.pos-t),u(e.name.pos,e.name.end-e.name.pos,17),t=e.name.end),e.typeExpression&&(p(t,e.typeExpression.pos-t),y(e.typeExpression),t=e.typeExpression.end),e.isNameFirst||(p(t,e.name.pos-t),u(e.name.pos,e.name.end-e.name.pos,17),t=e.name.end)}}(o.jsDoc)}p(i,s)}function p(e,t){u(e,t,1)}function h(e){for(var t=0,n=e.getChildren();t<n.length;t++){y(n[t])}}function f(t,n,r){var i;for(i=n;i<r&&!e.isLineBreak(t.charCodeAt(i));i++);for(u(n,i-n,1),l.setTextPos(i);l.getTextPos()<r;)m()}function m(){var e=l.getTextPos(),t=l.scan(),n=l.getTextPos(),r=g(t);r&&u(e,n-e,r)}function _(t){if(e.isJSDoc(t))return!0;if(e.nodeIsMissing(t))return!0;var n=function(e){switch(e.parent&&e.parent.kind){case 251:if(e.parent.tagName===e)return 19;break;case 252:if(e.parent.tagName===e)return 20;break;case 250:if(e.parent.tagName===e)return 21;break;case 253:if(e.parent.name===e)return 22}return}(t);if(!e.isToken(t)&&10!==t.kind&&void 0===n)return!1;var i=10===t.kind?t.pos:function(t){for(a.setTextPos(t.pos);;){var n=a.getTextPos();if(!e.couldStartTrivia(r.text,n))return n;var i=a.scan(),s=a.getTextPos(),o=s-n;if(!e.isTrivia(i))return n;if(4!==i&&5!==i)if(e.isComment(i))d(t,i,n,o),a.setTextPos(s);else if(7===i){var l=r.text,c=l.charCodeAt(n);if(60===c||62===c){u(n,o,1);continue}e.Debug.assert(124===c||61===c),f(l,n,s)}}}(t),s=t.end-i;if(e.Debug.assert(s>=0),s>0){var o=n||g(t.kind,t);o&&u(i,s,o)}return!0}function g(t,n){if(e.isKeyword(t))return 3;if((27===t||29===t)&&n&&e.getTypeArgumentOrTypeParameterList(n.parent))return 10;if(e.isPunctuation(t)){if(n){if(58===t&&(226===n.parent.kind||149===n.parent.kind||146===n.parent.kind||253===n.parent.kind))return 5;if(194===n.parent.kind||192===n.parent.kind||193===n.parent.kind||195===n.parent.kind)return 5}return 10}if(8===t)return 4;if(9===t)return 253===n.parent.kind?24:6;if(12===t)return 6;if(e.isTemplateLiteralKind(t))return 6;if(10===t)return 23;if(71===t){if(n)switch(n.parent.kind){case 229:return n.parent.name===n?11:void 0;case 145:return n.parent.name===n?15:void 0;case 230:return n.parent.name===n?13:void 0;case 232:return n.parent.name===n?12:void 0;case 233:return n.parent.name===n?14:void 0;case 146:return n.parent.name===n?e.isThisIdentifier(n)?3:17:void 0}return 2}}function y(i){if(i&&e.decodedTextSpanIntersectsWith(s,o,i.pos,i.getFullWidth())){t(n,i.kind);for(var a=0,l=i.getChildren(r);a<l.length;a++){var c=l[a];_(c)||y(c)}}}}e.createClassifier=function(){var t=e.createScanner(5,!1),n=[];n[71]=!0,n[9]=!0,n[8]=!0,n[12]=!0,n[99]=!0,n[43]=!0,n[44]=!0,n[20]=!0,n[22]=!0,n[18]=!0,n[101]=!0,n[86]=!0;var r=[];function i(t){switch(t){case 1:return e.TokenClass.Comment;case 3:return e.TokenClass.Keyword;case 4:return e.TokenClass.NumberLiteral;case 5:return e.TokenClass.Operator;case 6:return e.TokenClass.StringLiteral;case 8:return e.TokenClass.Whitespace;case 10:return e.TokenClass.Punctuation;case 2:case 11:case 12:case 13:case 14:case 15:case 16:case 9:case 17:default:return e.TokenClass.Identifier}}function s(i,s,a){for(var l=0,c=0,u=0;r.length>0;)r.pop();switch(s){case 3:i='"\\\n'+i,l=3;break;case 2:i="'\\\n"+i,l=3;break;case 1:i="/*\n"+i,l=3;break;case 4:i="`\n"+i,l=2;break;case 5:i="}\n"+i,l=2;case 6:r.push(14)}t.setText(i);var d,p,h={endOfLineState:0,spans:[]},f=0;do{if(c=t.scan(),!e.isTrivia(c)){if(41!==c&&63!==c||n[u]){if(23===u&&o(c))c=71;else if(o(u)&&o(c)&&(d=u,p=c,e.isAccessibilityModifier(d)&&125!==p&&135!==p&&123!==p&&115!==p))c=71;else if(71===u&&27===c)f++;else if(29===c&&f>0)f--;else if(119===c||136===c||133===c||122===c||137===c)f>0&&!a&&(c=71);else if(14===c)r.push(c);else if(17===c)r.length>0&&r.push(c);else if(18===c&&r.length>0){var m=e.lastOrUndefined(r);14===m?16===(c=t.reScanTemplateToken())?r.pop():e.Debug.assertEqual(c,15,"Should have been a template middle."):(e.Debug.assertEqual(m,17,"Should have been an open brace"),r.pop())}}else 12===t.reScanSlashToken()&&(c=12);u=c}_()}while(1!==c);return h;function _(){var n=t.getTokenPos(),s=t.getTextPos();if(function(e,t,n){if(8===n)return;0===e&&l>0&&(e+=l);var r=(t-=l)-(e-=l);r>0&&(h.spans.push(e),h.spans.push(r),h.spans.push(n))}(n,s,function(t){if(o(t))return 3;if(function(e){switch(e){case 39:case 41:case 42:case 37:case 38:case 45:case 46:case 47:case 27:case 29:case 30:case 31:case 93:case 92:case 118:case 32:case 33:case 34:case 35:case 48:case 50:case 49:case 53:case 54:case 69:case 68:case 70:case 65:case 66:case 67:case 59:case 60:case 61:case 63:case 64:case 58:case 26:return!0;default:return!1}}(t)||function(e){switch(e){case 37:case 38:case 52:case 51:case 43:case 44:return!0;default:return!1}}(t))return 5;if(t>=17&&t<=70)return 10;switch(t){case 8:return 4;case 9:return 6;case 12:return 7;case 7:case 3:case 2:return 1;case 5:case 4:return 8;case 71:default:return e.isTemplateLiteralKind(t)?6:2}}(c)),s>=i.length)if(9===c){var a=t.getTokenText();if(t.isUnterminated()){for(var u=a.length-1,d=0;92===a.charCodeAt(u-d);)d++;if(1&d){var p=a.charCodeAt(0);h.endOfLineState=34===p?3:2}}}else 3===c?t.isUnterminated()&&(h.endOfLineState=1):e.isTemplateLiteralKind(c)?t.isUnterminated()&&(16===c?h.endOfLineState=5:13===c?h.endOfLineState=4:e.Debug.fail("Only 'NoSubstitutionTemplateLiteral's and 'TemplateTail's can be unterminated; got SyntaxKind #"+c)):r.length>0&&14===e.lastOrUndefined(r)&&(h.endOfLineState=6)}}function o(e){return e>=72&&e<=142}return{getClassificationsForLine:function(t,n,r){return function(t,n){for(var r=[],s=t.spans,o=0,a=0;a<s.length;a+=3){var l=s[a],c=s[a+1],u=s[a+2];if(o>=0){var d=l-o;d>0&&r.push({length:d,classification:e.TokenClass.Whitespace})}r.push({length:c,classification:i(u)}),o=l+c}var p=n.length-o;return p>0&&r.push({length:p,classification:e.TokenClass.Whitespace}),{entries:r,finalLexState:t.endOfLineState}}(s(t,n,r),t)},getEncodedLexicalClassifications:s}},e.getSemanticClassifications=function(e,t,r,s,o){return i(n(e,t,r,s,o))},e.getEncodedSemanticClassifications=n,e.getSyntacticClassifications=function(e,t,n){return i(s(e,t,n))},e.getEncodedSyntacticClassifications=s}(ts||(ts={})),function(e){!function(t){!function(t){function n(t,n,r,i,s,o,l,u){void 0===u&&(u=[]),void 0===t&&(t=""),t=e.normalizeSlashes(t),""===(t=e.getDirectoryPath(t))&&(t="."+e.directorySeparator),t=e.ensureTrailingDirectorySeparator(t);var d=c(e.isRootedDiskPath(t)?t:e.combinePaths(n,t)),f=e.getDirectoryPath(d),_=!(o.useCaseSensitiveFileNames&&o.useCaseSensitiveFileNames());if(m(o,f)){var g=h(o,f,r,void 0,["./*"]);if(g){for(var y=e.createMap(),b=0,v=g;b<v.length;b++){var T=v[b];if(T=e.normalizePath(T),!l||0!==e.comparePaths(T,l,n,_)){var k=i?e.getBaseFileName(T):e.removeFileExtension(e.getBaseFileName(T));y.get(k)||y.set(k,!0)}}e.forEachKey(y,(function(e){u.push(a(e,"script",s))}))}var E=p(o,f);if(E)for(var x=0,S=E;x<S.length;x++){var C=S[x],I=e.getBaseFileName(e.normalizePath(C));u.push(a(I,"directory",s))}}return u}function r(t,n,r,i,s){if(s.readDirectory){var o=e.hasZeroOrOneAsteriskCharacter(r)?e.tryParsePattern(r):void 0;if(o){var a=c(o.prefix),l=e.getDirectoryPath(a),u=e.getBaseFileName(a),d=e.stringContains(t,e.directorySeparator),p=d?e.combinePaths(l,u+e.getDirectoryPath(t)):l,f=e.normalizePath(o.suffix),m=e.combinePaths(n,p),_=d?m:e.ensureTrailingDirectorySeparator(m)+u,g=h(s,m,i,void 0,[f?"**/*":"./*"]);if(g){for(var y=[],b=0,v=g;b<v.length;b++){var T=v[b],k=e.normalizePath(T);if(e.endsWith(k,f)&&e.startsWith(k,_)){var E=_.length,x=k.length-E-f.length;y.push(e.removeFileExtension(k.substr(E,x)))}}return y}}}}function i(t,n,r,i,l){if(void 0===l&&(l=[]),n.types)for(var c=0,u=n.types;c<u.length;c++){var d=u[c];l.push(a(d,"external module name",i))}else if(t.getDirectories){var p=void 0;try{p=e.getEffectiveTypeRoots(n,t)}catch(e){}if(p)for(var h=0,f=p;h<f.length;h++){s(t,f[h],i,l)}}if(t.getDirectories)for(var m=0,_=o(r,t);m<_.length;m++){var g=_[m];s(t,e.combinePaths(e.getDirectoryPath(g),"node_modules/@types"),i,l)}return l}function s(t,n,r,i){if(t.getDirectories&&m(t,n)){var s=p(t,n);if(s)for(var o=0,l=s;o<l.length;o++){var c=l[o];c=e.normalizePath(c),i.push(a(e.getBaseFileName(c),"external module name",r))}}}function o(t,n){for(var r,i=[];r=e.findConfigFile(t,(function(e){return f(n,e)}),"package.json");){i.push(r),t=e.getDirectoryPath(r);var s=e.getDirectoryPath(t);if(t===s)break;t=s}return i}function a(e,t,n){return{name:e,kind:t,kindModifiers:"",sortText:e,replacementSpan:n}}function l(t,n){var r=t.lastIndexOf(e.directorySeparator),i=-1!==r?r+1:0;return{start:n+i,length:t.length-i}}function c(t){return e.hasTrailingDirectorySeparator(t)?e.ensureTrailingDirectorySeparator(e.normalizePath(t)):e.normalizePath(t)}t.getStringLiteralCompletionEntriesFromModuleNames=function(t,s,c,u){var p,f=e.normalizeSlashes(t.text),m=t.getSourceFile().path,g=e.getDirectoryPath(m),y=l(t.text,t.getStart()+1);if(function(e){if(e&&e.length>=2&&46===e.charCodeAt(0)){var t=e.length>=3&&46===e.charCodeAt(1)?2:1,n=e.charCodeAt(t);return 47===n||92===n}return!1}(f)||e.isRootedDiskPath(f)){var b=e.getSupportedExtensions(s);p=s.rootDirs?function(t,r,i,s,o,a,l,c,u){for(var d=l.project||c.getCurrentDirectory(),p=!(c.useCaseSensitiveFileNames&&c.useCaseSensitiveFileNames()),h=function(t,n,r,i){t=e.map(t,(function(t){return e.normalizePath(e.isRootedDiskPath(t)?t:e.combinePaths(n,t))}));var s=e.forEach(t,(function(t){return e.containsPath(t,r,n,i)?r.substr(t.length):void 0}));return e.deduplicate(e.map(t,(function(t){return e.combinePaths(t,s)})))}(t,d,i,p),f=[],m=0,_=h;m<_.length;m++){n(r,_[m],s,o,a,c,u,f)}return f}(s.rootDirs,f,g,b,!1,y,s,c,m):n(f,g,b,!1,y,c,m)}else p=function(t,s,l,c,u,p){var f,m=c.baseUrl,g=c.paths;if(m){var y=e.getSupportedExtensions(c),b=c.project||u.getCurrentDirectory(),v=e.isRootedDiskPath(m)?m:e.combinePaths(b,m);if(f=n(t,e.normalizePath(v),y,!1,l,u),g)for(var T in g)if(g.hasOwnProperty(T))if("*"===T){if(g[T])for(var k=0,E=g[T];k<E.length;k++)for(var x=0,S=r(t,m,E[k],y,u);x<S.length;x++){var C=S[x];f.push(a(C,"external module name",l))}}else if(e.startsWith(T,t)){g[T]&&1===g[T].length&&g[T][0]&&f.push(a(T,"external module name",l))}}else f=[];i(u,c,s,l,f);for(var I=0,A=function(t,n,r,i,s){var a=e.stringContains(t,e.directorySeparator),l=a?t.substr(0,t.lastIndexOf(e.directorySeparator)):void 0,c=e.map(i.getAmbientModules(),(function(t){return e.stripQuotes(t.name)})),u=e.filter(c,(function(n){return e.startsWith(n,t)}));if(a){var p=e.ensureTrailingDirectorySeparator(l);u=e.map(u,(function(t){return e.removePrefix(t,p)}))}if(!r.moduleResolution||r.moduleResolution===e.ModuleResolutionKind.NodeJs)for(var f=0,m=function(t,n){var r=[];if(t.readFile&&t.fileExists)for(var i=0,s=o(n,t);i<s.length;i++){var a=s[i],l=b(a);if(!l)return;for(var c=e.combinePaths(e.getDirectoryPath(a),"node_modules"),u=[],p=0,h=d;p<h.length;p++){v(l[h[p]],u)}for(var f=0,m=u;f<m.length;f++){var g=m[f],y=e.combinePaths(c,g);r.push({moduleName:g,moduleDir:y})}}return r;function b(e){try{var n=function(e,t){return _(e,e.readFile,t)}(t,e);return n?JSON.parse(n):void 0}catch(e){return}}function v(t,n){if(t)for(var r in t)t.hasOwnProperty(r)&&!e.startsWith(r,"@types/")&&n.push(r)}}(s,n);f<m.length;f++){var g=m[f];if(a){if(e.startsWith(g.moduleName,l)){var y=h(s,g.moduleDir,e.supportedTypeScriptExtensions,void 0,["./*"]);if(y)for(var b=0,v=y;b<v.length;b++){var T=v[b];T=e.normalizePath(T);var k=e.removeFileExtension(e.getBaseFileName(T));u.push(k)}}}else u.push(g.moduleName)}return e.deduplicate(u)}(t,s,c,p,u);I<A.length;I++){var w=A[I];f.push(a(w,"external module name",l))}return f}(f,g,y,s,c,u);return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:p}},t.getTripleSlashReferenceCompletion=function(t,r,s,o){var a=e.getTokenAtPosition(t,r,!1);if(a){var c=e.getLeadingCommentRanges(t.text,a.pos);if(c&&c.length){var d=e.forEach(c,(function(e){return r>=e.pos&&r<=e.end&&e}));if(d){var p={isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:[]},h=t.text.substr(d.pos,r-d.pos),f=u.exec(h);if(f){var m=f[1],_=f[2],g=f[3],y=e.getDirectoryPath(t.path);if("path"===_){var b=l(g,d.pos+m.length);p.entries=n(g,y,e.getSupportedExtensions(s),!0,b,o,t.path)}else{var v={start:d.pos+m.length,length:f[0].length-m.length};p.entries=i(o,s,y,v)}}return p}}}};var u=/^(\/\/\/\s*<reference\s+(path|types)\s*=\s*(?:'|"))([^\3"]*)$/,d=["dependencies","devDependencies","peerDependencies","optionalDependencies"];function p(e,t){return _(e,e.getDirectories,t)}function h(e,t,n,r,i){return _(e,e.readDirectory,t,n,r,i)}function f(e,t){return _(e,e.fileExists,t)}function m(t,n){try{return e.directoryProbablyExists(n,t)}catch(e){}}function _(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return t&&t.apply(e,n)}catch(e){}}}(t.PathCompletions||(t.PathCompletions={}))}(e.Completions||(e.Completions={}))}(ts||(ts={})),function(e){!function(t){var n;function r(t,n,r,s,o,a,l){var c=u(t,o,r,a);if(c)return{name:c,kind:e.SymbolDisplay.getSymbolKind(s,t,n),kindModifiers:e.SymbolDisplay.getSymbolModifiers(t),sortText:"0",source:i(l),hasAction:void 0!==l||void 0}}function i(t){return t&&e.stripQuotes(t.moduleSymbol.name)}function s(t,n,i,s,o,a,l,c,u){var d=e.timestamp(),p=e.createMap();if(t)for(var h=0,f=t;h<f.length;h++){var m=f[h],_=u?u[e.getSymbolId(m)]:void 0,g=r(m,i,s,o,a,c,_);if(g){var y=g.name;p.has(y)||(_||void 0===m.parent&&!e.some(m.declarations,(function(e){return e.getSourceFile()===i.getSourceFile()}))||p.set(y,!0),n.push(g))}}return l("getCompletionsAtPosition: getCompletionEntriesFromSymbols: "+(e.timestamp()-d)),p}function o(e,t){if(e){var n=[];if(a(e,n,t),n.length)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!1,entries:n}}}function a(t,n,r,i){if(void 0===i&&(i=e.createMap()),t&&16384&t.flags&&(t=r.getBaseConstraintOfType(t)),t)if(65536&t.flags)for(var s=0,o=t.types;s<o.length;s++){a(o[s],n,r,i)}else if(32&t.flags&&!(256&t.flags)){var l=t.value;i.has(l)||(i.set(l,!0),n.push({name:l,kindModifiers:"",kind:"var",sortText:"0"}))}}function l(t,n,r,s,o,a,l){var d=a.name,p=a.source,h=c(t,n,s,o,l);if(h){var f=h.symbols,m=h.location,_=h.allowStringLiteral,g=h.symbolToOriginInfoMap,y=e.find(f,(function(t){return u(t,r.target,!1,_)===d&&i(g[e.getSymbolId(t)])===p}));return y&&{symbol:y,location:m,symbolToOriginInfoMap:g}}}function c(t,n,r,i,s){var o,a=e.isSourceFileJavaScript(r),l=e.timestamp(),c=e.getTokenAtPosition(r,i,!1);n("getCompletionData: Get current token: "+(e.timestamp()-l)),l=e.timestamp();var u=e.isInComment(r,i,c);n("getCompletionData: Is inside comment: "+(e.timestamp()-l));var d=!1;if(u){if(e.hasDocComment(r,i))if(64===r.text.charCodeAt(i-1))o={kind:"JsDocTagName"};else{var p=e.getLineStartPositionForPosition(i,r);r.text.substring(p,i).match(/[^\*|\s|(/\*\*)]/)||(o={kind:"JsDocTag"})}var h=function(t,n){var r=function(t){if(!e.isToken(t))return t;switch(t.kind){case 104:case 110:case 76:return t.parent.parent;default:return t.parent}}(t).jsDoc;if(!r)return;for(var i=0,s=r;i<s.length;i++){var o=s[i],a=o.pos,l=o.end,c=o.tags;if(!(!c||n<a||n>l))for(var u=c.length-1;u>=0;u--){var d=c[u];if(n>=d.pos)return d}}}(c,i);if(h&&(h.tagName.pos<=i&&i<=h.tagName.end&&(o={kind:"JsDocTagName"}),function(e){switch(e.kind){case 279:case 284:case 280:case 281:case 283:return!0}}(h)&&h.typeExpression&&267===h.typeExpression.kind&&((c=e.getTokenAtPosition(r,i,!0))&&(e.isDeclarationName(c)||284===c.parent.kind&&c.parent.name===c)||(d=K(h.typeExpression))),e.isJSDocParameterTag(h)&&(e.nodeIsMissing(h.name)||h.name.pos<=i&&i<=h.name.end)&&(o={kind:"JsDocParameterName",tag:h})),o)return{symbols:void 0,isGlobalCompletion:!1,isMemberCompletion:!1,allowStringLiteral:!1,isNewIdentifierLocation:!1,location:void 0,isRightOfDot:!1,request:o,keywordFilters:0,symbolToOriginInfoMap:void 0};if(!d)return void n("Returning an empty list because completion was inside a regular comment or plain text part of a JsDoc comment.")}l=e.timestamp();var y=e.findPrecedingToken(i,r,void 0,d);n("getCompletionData: Get previous token 1: "+(e.timestamp()-l));var b=y;if(b&&i<=b.end&&e.isWord(b.kind)){var v=e.timestamp();b=e.findPrecedingToken(b.getFullStart(),r,void 0,d),n("getCompletionData: Get previous token 2: "+(e.timestamp()-v))}var T=c,k=!1,E=!1,x=!1,S=e.getTouchingPropertyName(r,i,d);if(b){if(function(t){var r=e.timestamp(),s=function(t){if(9===t.kind||12===t.kind||e.isTemplateLiteralKind(t.kind)){var n=t.getStart(),r=t.getEnd();if(n<i&&i<r)return!0;if(i===r)return!!t.isUnterminated||12===t.kind}return!1}(t)||function(t){var n=t.parent.kind;switch(t.kind){case 26:return 226===n||227===n||208===n||232===n||j(n)||230===n||175===n||231===n||e.isClassLike(t.parent)&&t.parent.typeParameters&&t.parent.typeParameters.end>=t.pos;case 23:return 175===n;case 56:return 176===n;case 21:return 175===n;case 19:return 260===n||j(n);case 17:return 232===n||230===n||163===n;case 25:return 148===n&&t.parent&&t.parent.parent&&(230===t.parent.parent.kind||163===t.parent.parent.kind);case 27:return 229===n||199===n||230===n||231===n||e.isFunctionLikeKind(n);case 115:return 149===n&&!e.isClassLike(t.parent.parent);case 24:return 146===n||t.parent&&t.parent.parent&&175===t.parent.parent.kind;case 114:case 112:case 113:return 146===n&&!e.isConstructorDeclaration(t.parent.parent);case 118:return 242===n||246===n||240===n;case 125:case 135:if(H(t))return!1;case 75:case 83:case 109:case 89:case 104:case 91:case 110:case 76:case 116:case 138:return!0}if(m(t.getText())&&H(t))return!1;if(G(t)&&(!e.isIdentifier(t)||g(t.getText())||K(t)))return!1;switch(t.getText()){case"abstract":case"async":case"class":case"const":case"declare":case"enum":case"function":case"interface":case"let":case"private":case"protected":case"public":case"static":case"var":case"yield":return!0}return e.isDeclarationName(t)&&!e.isJsxAttribute(t.parent)}(t)||function(e){if(8===e.kind){var t=e.getFullText();return"."===t.charAt(t.length-1)}return!1}(t)||function(e){if(10===e.kind)return!0;if(29===e.kind&&e.parent){if(251===e.parent.kind)return!0;if(252===e.parent.kind||250===e.parent.kind)return e.parent.parent&&249===e.parent.parent.kind}return!1}(t);return n("getCompletionsAtPosition: isCompletionListBlocker: "+(e.timestamp()-r)),s}(b))return void n("Returning an empty list because completion was requested in an invalid position.");var C=b.parent;if(23===b.kind)if(179===C.kind)T=b.parent.expression,k=!0;else{if(143!==C.kind)return;T=b.parent.left,k=!0}else if(1===r.languageVariant)switch(C&&179===C.kind&&(b=C,C=C.parent),C.kind){case 252:41===b.kind&&(x=!0,S=b);break;case 194:if(!(32768&C.left.flags))break;case 250:case 249:case 251:27===b.kind&&(E=!0,S=b)}}var I,A,w=e.timestamp(),N=!1,D=!1,O=0,R=[],L=[];if(k)!function(){N=!1,I=!0,A=!1;var n=d||e.isPartOfTypeNode(T.parent),r=e.isInRightSideOfInternalImportEqualsDeclaration(T);if(e.isEntityName(T)){var i=t.getSymbolAtLocation(T);if(i&&1920&(i=e.skipAlias(i,t)).flags){for(var s=t.getExportsOfModule(i),o=function(e){return t.isValidPropertyAccess(T.parent,e.name)},a=function(e){return U(e)},l=r?function(e){return a(e)||o(e)}:n?a:o,c=0,u=s;c<u.length;c++){var p=u[c];l(p)&&R.push(p)}return void(!n&&i.declarations.some((function(e){return 265!==e.kind&&233!==e.kind&&232!==e.kind}))&&$(t.getTypeOfSymbolAtLocation(i,T)))}}n||$(t.getTypeAtLocation(T))}();else if(E){var P=t.getJsxIntrinsicTagNames();R=B()?P.concat(R.filter((function(e){return!!(2204607&e.flags)}))):P,I=!0,A=!1}else if(x){var M=b.parent.parent.openingElement.tagName,F=t.getSymbolAtLocation(M);t.isUnknownSymbol(F)||(R=[F]),I=!0,A=!1}else if(!B())return;return n("getCompletionData: Semantic work: "+(e.timestamp()-w)),{symbols:R,isGlobalCompletion:N,isMemberCompletion:I,allowStringLiteral:D,isNewIdentifierLocation:A,location:S,isRightOfDot:k||E,request:o,keywordFilters:O,symbolToOriginInfoMap:L};function $(e){for(var n=0,r=e.getApparentProperties();n<r.length;n++){var i=r[n];t.isValidPropertyAccess(T.parent,i.name)&&R.push(i)}if(a&&65536&e.flags)for(var s=0,o=e.types;s<o.length;s++){$(o[s])}}function B(){var n,o,a,l;if(n=function(t){if(t)switch(t.kind){case 17:case 26:var n=t.parent;if(e.isObjectLiteralExpression(n)||e.isObjectBindingPattern(n))return n}return}(b))return function(n){var r,i;if(I=!0,D=!0,178===n.kind){if(A=!0,!(a=t.getContextualType(n)))return!1;r=function(e,t){if(!(65536&e.flags))return t.getPropertiesOfType(e);var n=e.types.filter((function(e){return!(8190&e.flags||t.isArrayLikeType(e))}));return t.getAllPossiblePropertiesOfTypes(n)}(a,t),i=n.properties}else{e.Debug.assert(174===n.kind),A=!1;var s=e.getRootDeclaration(n.parent);if(!e.isVariableLike(s))throw e.Debug.fail("Root declaration is not variable-like.");var o=s.initializer||s.type||216===s.parent.parent.kind;if(o||146!==s.kind||(e.isExpression(s.parent)?o=!!t.getContextualType(s.parent):151!==s.parent.kind&&154!==s.parent.kind||(o=e.isExpression(s.parent.parent)&&!!t.getContextualType(s.parent.parent))),o){var a;if(!(a=t.getTypeAtLocation(n)))return!1;r=t.getPropertiesOfType(a).filter((function(t){return!(24&e.getDeclarationModifierFlagsFromSymbol(t))})),i=n.elements}}r&&r.length>0&&(R=function(t,n){if(!n||0===n.length)return t;for(var r=e.createUnderscoreEscapedMap(),i=0,s=n;i<s.length;i++){var o=s[i];if((261===o.kind||262===o.kind||176===o.kind||151===o.kind||153===o.kind||154===o.kind)&&!K(o)){var a=void 0;if(176===o.kind&&o.propertyName)71===o.propertyName.kind&&(a=o.propertyName.escapedText);else{var l=e.getNameOfDeclaration(o);a=e.getEscapedTextOfIdentifierOrLiteral(l)}r.set(a,!0)}}return e.filter(t,(function(e){return!r.get(e.escapedName)}))}(r,i));return!0}(n);if(o=function(e){if(e)switch(e.kind){case 17:case 26:switch(e.parent.kind){case 241:case 245:return e.parent}}return}(b))return function(n){var r=241===n.kind?238:244,i=e.getAncestor(n,r).moduleSpecifier;if(!i)return!1;I=!0,A=!1;var s=t.getSymbolAtLocation(i);if(!s)return R=e.emptyArray,!0;var o=t.getExportsAndPropertiesOfModule(s);return R=function(t,n){for(var r=e.createUnderscoreEscapedMap(),i=0,s=n;i<s.length;i++){var o=s[i];if(!K(o)){var a=o.propertyName||o.name;r.set(a.escapedText,!0)}}if(0===r.size)return e.filter(t,(function(e){return"default"!==e.escapedName}));return e.filter(t,(function(e){return"default"!==e.escapedName&&!r.get(e.escapedName)}))}(o,n.elements),!0}(o);if(function(t){if(t)switch(t.kind){case 19:case 26:return e.isConstructorDeclaration(t.parent)&&t.parent;default:if(G(t))return t.parent.parent}return}(b))return I=!1,A=!0,O=2,!0;if(a=function(t){if(t)switch(t.kind){case 17:case 26:if(e.isClassLike(t.parent))return t.parent;break;case 25:case 18:if(e.isClassLike(S))return S;if(H(S)&&S.parent.name===S)return S.parent.parent;break;default:if(H(t)&&(f(t.kind)||m(t.getText())))return t.parent.parent}if(S&&286===S.kind&&e.isClassLike(S.parent))return S.parent;return}(b))return function(n){I=!0,A=!0,O=1;var r=e.getClassExtendsHeritageClauseElement(n),i=e.getClassImplementsHeritageClauseElements(n);if(r||i){var s=b.parent,o=e.isClassElement(s)&&e.getModifierFlags(s);if(71===b.kind&&!K(b))switch(b.getText()){case"private":o|=8;break;case"static":o|=32}if(!(8&o)){var a=void 0;r&&(a=t.getTypeAtLocation(r),32&o&&(a=t.getTypeOfSymbolAtLocation(a.symbol,n)));var l=32&o?e.emptyArray:e.flatMap(i||e.emptyArray,(function(e){return t.getPropertiesOfType(t.getTypeAtLocation(e))}));R=function(t,n,r,i){for(var s=e.createUnderscoreEscapedMap(),o=0,a=r;o<a.length;o++){var l=a[o];if((149===l.kind||151===l.kind||153===l.kind||154===l.kind)&&(!K(l)&&!e.hasModifier(l,8))){var c=e.hasModifier(l,32),u=!!(32&i);if(!(c&&!u||!c&&u)){var d=e.getPropertyNameForPropertyNameNode(l.name);d&&s.set(d,!0)}}}var p=[];return h(t,8),h(n,24),p;function h(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];f(i,t)&&p.push(i)}}function f(t,n){return!s.get(t.escapedName)&&t.getDeclarations()&&!(e.getDeclarationModifierFlagsFromSymbol(t)&n)}}(a?t.getPropertiesOfType(a):e.emptyArray,l,n.members,o)}}}(a),!0;if(l=function(e){if(e){var t=e.parent;switch(e.kind){case 28:case 41:case 71:case 179:case 254:case 253:case 255:if(t&&(250===t.kind||251===t.kind))return t;if(253===t.kind)return t.parent.parent;break;case 9:if(t&&(253===t.kind||255===t.kind))return t.parent.parent;break;case 18:if(t&&256===t.kind&&t.parent&&253===t.parent.kind)return t.parent.parent.parent;if(t&&255===t.kind)return t.parent.parent}}return}(b)){var c=void 0;if((250===l.kind||251===l.kind)&&(c=t.getAllAttributesTypeFromJsxOpeningLikeElement(l)))return R=function(t,n){for(var r=e.createUnderscoreEscapedMap(),i=0,s=n;i<s.length;i++){var o=s[i];K(o)||253===o.kind&&r.set(o.name.escapedText,!0)}return e.filter(t,(function(e){return!r.get(e.escapedName)}))}(t.getPropertiesOfType(c),l.attributes.properties),I=!0,A=!1,!0}I=!1,A=function(e){if(e){var t=e.parent.kind;switch(e.kind){case 26:return 181===t||152===t||182===t||177===t||194===t||160===t;case 19:return 181===t||152===t||182===t||185===t||168===t;case 21:return 177===t||157===t||144===t;case 128:case 129:return!0;case 23:return 233===t;case 17:return 229===t;case 58:return 226===t||194===t;case 14:return 196===t;case 15:return 205===t;case 114:case 112:case 113:return 149===t}switch(e.getText()){case"public":case"protected":case"private":return!0}}return!1}(b),y!==b&&e.Debug.assert(!!y,"Expected 'contextToken' to be defined when different from 'previousToken'.");var u=y!==b?y.getStart():i,p=function(t,n,r){var i=t;for(;i&&!e.positionBelongsToNode(i,n,r);)i=i.parent;return i}(b,u,r)||r;p&&(N=265===p.kind||196===p.kind||256===p.kind||e.isStatement(p));return function(n,i){var o=i.toLowerCase();e.codefix.forEachExternalModule(t,s,(function(i){if(i!==r.symbol)for(var s=0,a=t.getExportsOfModule(i);s<a.length;s++){var l=a[s],c=l.name,u="default"===c;if(u){var d=e.getLocalSymbolForExportDefault(l);d&&(l=d,c=d.name)}l.declarations&&l.declarations.some((function(t){return e.isExportSpecifier(t)&&!!t.parent.parent.moduleSpecifier}))||V(c.toLowerCase(),o)&&(n.push(l),L[e.getSymbolId(l)]={moduleSymbol:i,isDefaultExport:u})}}))}(R=t.getSymbolsInScope(p,2998271),y&&e.isIdentifier(y)?y.text:""),function(n){e.filterMutate(n,(function(n){if(!e.isSourceFile(S)){if(e.isExportAssignment(S.parent))return!0;if(n&&2097152&n.flags&&(n=t.getAliasedSymbol(n)),e.isInRightSideOfInternalImportEqualsDeclaration(S))return!!(1920&n.flags);if(d||!function(e){return e&&103===e.kind&&162===e.parent.kind}(b)&&(e.isPartOfTypeNode(S)||function(t){if(t){var n=t.parent.kind;switch(t.kind){case 56:return 149===n||148===n||146===n||226===n||e.isFunctionLikeKind(n);case 58:return 231===n;case 118:return 202===n}}}(b)))return U(n)}return!!(107455&e.getCombinedLocalAndExportSymbolFlags(n))}))}(R),!0}function U(n){if(n=n.exportSymbol||n,793064&(n=e.skipAlias(n,t)).flags)return!0;if(1536&n.flags){var r=t.getExportsOfModule(n);return e.forEach(r,U)}}function V(e,t){if(0===t.length)return!0;for(var n=0,r=0;r<e.length;r++)if(e.charCodeAt(r)===t.charCodeAt(n)&&++n===t.length)return!0;return!1}function H(t){return e.isClassElement(t.parent)&&e.isClassLike(t.parent.parent)}function G(t){return t.parent&&function(t){return e.isParameter(t)&&e.isConstructorDeclaration(t.parent)}(t.parent)&&(_(t.kind)||e.isDeclarationName(t))}function j(t){return e.isFunctionLikeKind(t)&&152!==t}function K(e){return e.getStart()<=i&&i<=e.getEnd()}}function u(t,n,r,i){var s=t.name;if(s){if(1920&t.flags){var o=s.charCodeAt(0);if(e.isSingleOrDoubleQuote(o))return}return d(s,n,r,i)}}function d(t,n,r,i){return r&&!e.isIdentifierText(t,n)?i?JSON.stringify(t):void 0:t}!function(e){e[e.None=0]="None",e[e.ClassElementKeywords=1]="ClassElementKeywords",e[e.ConstructorParameterKeywords=2]="ConstructorParameterKeywords"}(n||(n={})),t.getCompletionsAtPosition=function(n,r,i,l,u,p,f){if(e.isInReferenceComment(u,p))return t.PathCompletions.getTripleSlashReferenceCompletion(u,p,l,n);if(e.isInString(u,p))return function(n,r,i,l,c,u){var d=e.findPrecedingToken(r,n);if(!d||9!==d.kind)return;if(261===d.parent.kind&&178===d.parent.parent.kind&&d.parent.name===d)return function(e,t,n,r){var i=t.getContextualType(e.parent),o=[];if(i&&(s(i.getApparentProperties(),o,e,!1,t,n,r,!0),o.length))return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!0,entries:o}}(d.parent,i,l.target,u);if(e.isElementAccessExpression(d.parent)&&d.parent.argumentExpression===d)return function(e,t,n,r){var i=t.getTypeAtLocation(e.expression),o=[];if(i&&(s(i.getApparentProperties(),o,e,!1,t,n,r,!0),o.length))return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!0,entries:o};return}(d.parent,i,l.target,u);if(238===d.parent.kind||e.isExpressionOfExternalModuleImportEqualsDeclaration(d)||e.isRequireCall(d.parent,!1))return t.PathCompletions.getStringLiteralCompletionEntriesFromModuleNames(d,l,c,i);if(function(t){return e.isBinaryExpression(t)&&(n=t.operatorToken.kind,32===n||33===n||34===n||35===n);var n}(d.parent))return o(i.getTypeAtLocation(d.parent.left===d?d.parent.right:d.parent.left),i);if(e.isCaseOrDefaultClause(d.parent))return o(i.getTypeAtLocation(d.parent.parent.parent.expression),i);var p=e.SignatureHelp.getImmediatelyContainingArgumentInfo(d,r,n);return p?function(t,n){var r=[],i=[],s=e.createMap();n.getResolvedSignature(t.invocation,r,t.argumentCount);for(var o=0,l=r;o<l.length;o++){var c=l[o];a(n.getParameterType(c,t.argumentIndex),i,n,s)}if(i.length)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:i};return}(p,i):o(i.getContextualType(d),i)}(u,p,r,l,n,i);var m=c(r,i,u,p,f);if(m){var _=m.symbols,g=m.isGlobalCompletion,y=m.isMemberCompletion,b=m.allowStringLiteral,v=m.isNewIdentifierLocation,T=m.location,k=m.request,E=m.keywordFilters,x=m.symbolToOriginInfoMap;if(1===u.languageVariant&&T&&T.parent&&252===T.parent.kind)return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!1,entries:[{name:T.parent.parent.openingElement.tagName.getFullText(),kind:"class",kindModifiers:void 0,sortText:"0"}]};if(k)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!1,entries:"JsDocTagName"===k.kind?e.JsDoc.getJSDocTagNameCompletions():"JsDocTag"===k.kind?e.JsDoc.getJSDocTagCompletions():e.JsDoc.getJSDocParameterNameCompletions(k.tag)};var S=[];if(e.isSourceFileJavaScript(u)){var C=s(_,S,T,!0,r,l.target,i,b,x);!function(t,n,r,i,s){e.getNameTable(t).forEach((function(t,o){if(t!==n){var a=e.unescapeLeadingUnderscores(o);if(!r.has(a)){r.set(a,!0);var l=d(a,i,!0,!1);l&&s.push({name:l,kind:"warning",kindModifiers:"",sortText:"1"})}}}))}(u,T.pos,C,l.target,S)}else{if((!_||0===_.length)&&0===E)return;s(_,S,T,!0,r,l.target,i,b,x)}return 0===E&&y||e.addRange(S,h(E)),{isGlobalCompletion:g,isMemberCompletion:y,isNewIdentifierLocation:v,entries:S}}},t.getCompletionEntryDetails=function(t,n,r,i,s,o,a,c,u){var d=o.name,p=o.source,f=l(t,n,r,i,s,o,a);if(f){var m=f.symbol,_=f.location,g=function(t,n,r,i,s,o,a){var l=t[e.getSymbolId(n)];if(!l)return;var c=l.moduleSymbol,u=l.isDefaultExport;return e.codefix.getCodeActionForImport(c,{host:i,checker:r,newLineCharacter:i.getNewLine(),compilerOptions:s,sourceFile:o,rulesProvider:a,symbolName:n.name,getCanonicalFileName:e.createGetCanonicalFileName(!!i.useCaseSensitiveFileNames&&i.useCaseSensitiveFileNames()),symbolToken:void 0,kind:u?1:0})}(f.symbolToOriginInfoMap,m,t,c,r,i,u),y=e.SymbolDisplay.getSymbolModifiers(m),b=e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(t,m,i,_,_,7),v=b.displayParts,T=b.documentation,k=b.symbolKind,E=b.tags;return{name:d,kindModifiers:y,kind:k,displayParts:v,documentation:T,tags:E,codeActions:g,source:void 0===p?void 0:[e.textPart(p)]}}if(void 0===p&&e.some(h(0),(function(e){return e.name===d})))return{name:d,kind:"keyword",kindModifiers:"",displayParts:[e.displayPart(d,e.SymbolDisplayPartKind.keyword)],documentation:void 0,tags:void 0,codeActions:void 0,source:void 0}},t.getCompletionEntrySymbol=function(e,t,n,r,i,s,o){var a=l(e,t,n,r,i,s,o);return a&&a.symbol};var p=[];function h(t){var n=p[t];return n||(p[t]=function(t){switch(t){case 0:return function(){for(var t=[],n=72;n<=142;n++)t.push({name:e.tokenToString(n),kind:"keyword",kindModifiers:"",sortText:"0"});return t}();case 1:return r(m);case 2:return r(g)}}(t));function r(t){return e.filter(h(0),(function(e){return t(e.name)}))}}function f(e){switch(e){case 114:case 113:case 112:case 117:case 115:case 123:case 131:case 125:case 135:case 120:return!0}}function m(t){return f(e.stringToToken(t))}function _(e){switch(e){case 114:case 112:case 113:case 131:return!0}}function g(t){return _(e.stringToToken(t))}}(e.Completions||(e.Completions={}))}(ts||(ts={})),function(e){!function(t){function n(t,n){return{fileName:n.fileName,textSpan:e.createTextSpanFromNode(t,n),kind:"none"}}function r(e,t){return void 0!==e&&e.kind===t}function i(e){return e&&e.parent}function s(t){var n=[];return function t(r){if(223===r.kind)n.push(r);else if(224===r.kind){var i=r;i.catchClause?t(i.catchClause):t(i.tryBlock),i.finallyBlock&&t(i.finallyBlock)}else e.isFunctionLike(r)||e.forEachChild(r,t)}(t),n}function o(t){var n=[];return function t(r){218===r.kind||217===r.kind?n.push(r):e.isFunctionLike(r)||e.forEachChild(r,t)}(t),n}function a(e,t){var n=l(t);return n&&n===e}function l(t){for(var n=t.parent;n;n=n.parent)switch(n.kind){case 221:if(217===t.kind)continue;case 214:case 215:case 216:case 213:case 212:if(!t.label||p(n,t.label.text))return n;break;default:if(e.isFunctionLike(n))return}}function c(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return!(!n||!e.contains(r,n.kind))&&(t.push(n),!0)}function u(t){var n=[];if(c(n,t.getFirstToken(),88,106,81)&&212===t.kind)for(var r=t.getChildren(),i=r.length-1;i>=0&&!c(n,r[i],106);i--);var s=o(t.statement);return e.forEach(s,(function(e){a(t,e)&&c(n,e.getFirstToken(),72,77)})),n}function d(t){var n=[];return c(n,t.getFirstToken(),98),e.forEach(t.caseBlock.clauses,(function(r){c(n,r.getFirstToken(),73,79);var i=o(r);e.forEach(i,(function(e){a(t,e)&&c(n,e.getFirstToken(),72)}))})),n}function p(e,t){for(var n=e.parent;222===n.kind;n=n.parent)if(n.label.escapedText===t)return!0;return!1}t.getDocumentHighlights=function(t,o,a,p,h){var f=e.getTouchingWord(a,p,!0);if(f!==a){if(e.Debug.assert(void 0!==f.parent),e.isJsxOpeningElement(f.parent)&&f.parent.tagName===f||e.isJsxClosingElement(f.parent)){var m=f.parent.parent,_=[m.openingElement,m.closingElement].map((function(e){return n(e.tagName,a)}));return[{fileName:a.fileName,highlightSpans:_}]}return function(t,n,r,i){var s=e.FindAllReferences.getReferenceEntriesForNode(t,n,i,r);return s&&function(t){for(var n=e.createMap(),r=0,i=t;r<i.length;r++){var s=i[r],o=e.FindAllReferences.toHighlightSpan(s),a=o.fileName,l=o.span,c=n.get(a);c||n.set(a,c=[]),c.push(l)}return e.arrayFrom(n.entries(),(function(e){return{fileName:e[0],highlightSpans:e[1]}}))}(s)}(f,t,o,h)||function(t,o){var a=function(t,o){if(!t)return;switch(t.kind){case 90:case 82:if(r(t.parent,211))return function(t,i){var s=[];for(;r(t.parent,211)&&t.parent.elseStatement===t;)t=t.parent;for(;t;){var o=t.getChildren();c(s,o[0],90);for(var a=o.length-1;a>=0&&!c(s,o[a],82);a--);if(!r(t.elseStatement,211))break;t=t.elseStatement}var l=[];for(a=0;a<s.length;a++){if(82===s[a].kind&&a<s.length-1){for(var u=s[a],d=s[a+1],p=!0,h=d.getStart()-1;h>=u.end;h--)if(!e.isWhiteSpaceSingleLine(i.text.charCodeAt(h))){p=!1;break}if(p){l.push({fileName:i.fileName,textSpan:e.createTextSpanFromBounds(u.getStart(),d.end),kind:"reference"}),a++;continue}}l.push(n(s[a],i))}return l}(t.parent,o);break;case 96:if(r(t.parent,219))return m(function(t){var n=e.getContainingFunction(t);if(!n||!r(n.body,207))return;var i=[];return e.forEachReturnStatement(n.body,(function(e){c(i,e.getFirstToken(),96)})),e.forEach(s(n.body),(function(e){c(i,e.getFirstToken(),100)})),i}(t.parent));break;case 100:if(r(t.parent,223))return m(function(t){var n=function(t){var n=t;for(;n.parent;){var r=n.parent;if(e.isFunctionBlock(r)||265===r.kind)return r;if(224===r.kind){var i=r;if(i.tryBlock===n&&i.catchClause)return n}n=r}return}(t);if(!n)return;var r=[];e.forEach(s(n),(function(e){c(r,e.getFirstToken(),100)})),e.isFunctionBlock(n)&&e.forEachReturnStatement(n,(function(e){c(r,e.getFirstToken(),96)}));return r}(t.parent));break;case 102:case 74:case 87:var a=74===t.kind?i(i(t)):i(t);if(r(a,224))return m(function(t,n){var r=[];c(r,t.getFirstToken(),102),t.catchClause&&c(r,t.catchClause.getFirstToken(),74);if(t.finallyBlock){c(r,e.findChildOfKind(t,87,n),87)}return r}(a,o));break;case 98:if(r(t.parent,221))return m(d(t.parent));break;case 73:case 79:if(r(i(i(i(t))),221))return m(d(t.parent.parent.parent));break;case 72:case 77:if(r(t.parent,218)||r(t.parent,217))return m(function(e){var t=l(e);if(t)switch(t.kind){case 214:case 215:case 216:case 212:case 213:return u(t);case 221:return d(t)}return}(t.parent));break;case 88:if(r(t.parent,214)||r(t.parent,215)||r(t.parent,216))return m(u(t.parent));break;case 106:case 81:if(r(t.parent,213)||r(t.parent,212))return m(u(t.parent));break;case 123:if(r(t.parent,152))return m((p=t.parent,h=p.symbol.getDeclarations(),f=[],e.forEach(h,(function(t){e.forEach(t.getChildren(),(function(e){return c(f,e,123)}))})),f));break;case 125:case 135:if(r(t.parent,153)||r(t.parent,154))return m(function(t){var n=[];return r(t.symbol,153),r(t.symbol,154),n;function r(t,r){var i=e.getDeclarationOfKind(t,r);i&&e.forEach(i.getChildren(),(function(e){return c(n,e,125,135)}))}}(t.parent));break;default:if(e.isModifierKind(t.kind)&&t.parent&&(e.isDeclaration(t.parent)||208===t.parent.kind))return m(function(t,n){if(!function(e,t){var n=t.parent;switch(e){case 112:case 113:case 114:switch(n.kind){case 229:case 199:return!0;case 152:return 146===t.kind;default:return!1}case 115:return 229===n.kind||199===n.kind;case 84:case 124:return 234===n.kind||265===n.kind;case 117:return 229===n.kind||229===t.kind;default:return!1}}(t,n))return;var r=e.modifierToFlag(t);return e.mapDefined(function(t,n){var r=t.parent;switch(r.kind){case 234:case 265:case 207:case 257:case 258:return 128&n?t.members.concat([t]):r.statements;case 152:return r.parameters.concat(r.parent.members);case 229:case 199:var i=r.members;if(28&n){var s=e.find(r.members,e.isConstructorDeclaration);if(s)return i.concat(s.parameters)}else if(128&n)return i.concat([r]);return i;default:e.Debug.fail("Invalid container kind.")}}(n,r),(function(n){if(e.getModifierFlags(n)&r){var i=e.find(n.modifiers,(function(e){return e.kind===t}));return e.Debug.assert(!!i),i}}))}(t.kind,t.parent))}var p,h,f;function m(e){return e&&e.map((function(e){return n(e,o)}))}}(t,o);if(!a||0===a.length)return;return[{fileName:o.fileName,highlightSpans:a}]}(f,a)}}}(e.DocumentHighlights||(e.DocumentHighlights={}))}(ts||(ts={})),function(e){e.createDocumentRegistry=function(t,n){void 0===n&&(n="");var r=e.createMap(),i=e.createGetCanonicalFileName(!!t);function s(e){return"_"+e.target+"|"+e.module+"|"+e.noResolve+"|"+e.jsx+"|"+e.allowJs+"|"+e.baseUrl+"|"+JSON.stringify(e.typeRoots)+"|"+JSON.stringify(e.rootDirs)+"|"+JSON.stringify(e.paths)}function o(t,n){var i=r.get(t);return!i&&n&&r.set(t,i=e.createMap()),i}function a(e,t,n,r,i,s,o){return c(e,t,n,r,i,s,!0,o)}function l(e,t,n,r,i,s,o){return c(e,t,n,r,i,s,!1,o)}function c(t,n,r,i,s,a,l,c){var u=o(i,!0),d=u.get(n);d?(d.sourceFile.version!==a&&(d.sourceFile=e.updateLanguageServiceSourceFile(d.sourceFile,s,a,s.getChangeRange(d.sourceFile.scriptSnapshot))),l&&d.languageServiceRefCount++):(d={sourceFile:e.createLanguageServiceSourceFile(t,s,r.target,a,!1,c),languageServiceRefCount:1,owners:[]},u.set(n,d));return d.sourceFile}function u(t,n){var r=o(n,!1);e.Debug.assert(void 0!==r);var i=r.get(t);i.languageServiceRefCount--,e.Debug.assert(i.languageServiceRefCount>=0),0===i.languageServiceRefCount&&r.delete(t)}return{acquireDocument:function(t,r,o,l,c){return a(t,e.toPath(t,n,i),r,s(r),o,l,c)},acquireDocumentWithKey:a,updateDocument:function(t,r,o,a,c){return l(t,e.toPath(t,n,i),r,s(r),o,a,c)},updateDocumentWithKey:l,releaseDocument:function(t,r){return u(e.toPath(t,n,i),s(r))},releaseDocumentWithKey:u,reportStats:function(){var t=e.arrayFrom(r.keys()).filter((function(e){return e&&"_"===e.charAt(0)})).map((function(e){var t=r.get(e),n=[];return t.forEach((function(e,t){n.push({name:t,refCount:e.languageServiceRefCount,references:e.owners.slice(0)})})),n.sort((function(e,t){return t.refCount-e.refCount})),{bucket:e,sourceFiles:n}}));return JSON.stringify(t,void 0,2)},getKeyForCompilationSettings:s}}}(ts||(ts={})),function(e){!function(t){function n(t,n){return e.forEach(265===t.kind?t.statements:t.body.statements,(function(t){return n(t)||c(t)&&e.forEach(t.body&&t.body.statements,n)}))}function r(e,t){if(e.externalModuleIndicator||void 0!==e.imports)for(var r=0,s=e.imports;r<s.length;r++){var o=s[r];t(i(o),o)}else n(e,(function(e){switch(e.kind){case 244:case 238:(n=e).moduleSpecifier&&9===n.moduleSpecifier.kind&&t(n,n.moduleSpecifier);break;case 237:var n,r=(n=e).moduleReference;248===r.kind&&9===r.expression.kind&&t(n,r.expression)}}))}function i(t){var n=t.parent;switch(n.kind){case 181:case 238:case 244:return n;case 248:return n.parent;default:e.Debug.fail("Unexpected module specifier parent: "+n.kind)}}function s(t,n,r){var i=r.getMergedSymbol(t.parent);return e.isExternalModuleSymbol(i)?{exportingModuleSymbol:i,exportKind:n}:void 0}function o(t){return"default"!==t.escapedName?t.escapedName:e.forEach(t.declarations,(function(t){var n=e.getNameOfDeclaration(t);return n&&71===n.kind&&n.escapedText}))}function a(e,t){return t.getMergedSymbol(l(e).symbol)}function l(t){if(181===t.kind)return t.getSourceFile();var n=t.parent;return 265===n.kind?n:(e.Debug.assert(234===n.kind&&c(n.parent)),n.parent)}function c(e){return 233===e.kind&&9===e.name.kind}function u(e){var t=e.moduleReference;return 248===t.kind&&9===t.expression.kind}t.createImportTracker=function(t,i,s){var c=function(t,n,i){for(var s=e.createMap(),o=0,a=t;o<a.length;o++){var l=a[o];i.throwIfCancellationRequested(),r(l,(function(t,r){var i=n.getSymbolAtLocation(r);if(i){var o=e.getSymbolId(i).toString(),a=s.get(o);a||s.set(o,a=[]),a.push(t)}}))}return s}(t,i,s);return function(r,d,p){var h=function(t,r,i,s,o){var c=i.exportingModuleSymbol,u=i.exportKind,d=e.nodeSeenTracker(),p=e.nodeSeenTracker(),h=[],f=!!c.globalExports,m=f?void 0:[];return g(c),{directImports:h,indirectUsers:_()};function _(){if(f)return t;for(var n=0,r=c.declarations;n<r.length;n++){var i=r[n];e.isExternalModuleAugmentation(i)&&b(i)}return m.map(e.getSourceFileOfNode)}function g(t){var n=T(t);if(n)for(var r=0,i=n;r<i.length;r++){var l=i[r];if(d(l))switch(o.throwIfCancellationRequested(),l.kind){case 181:if(!f){var c=l.parent;if(2===u&&226===c.kind){var p=c.name;if(71===p.kind){h.push(p);break}}b(l.getSourceFile())}break;case 237:y(l,l.name,e.hasModifier(l,1));break;case 238:var m=l.importClause&&l.importClause.namedBindings;m&&240===m.kind?y(l,m.name):h.push(l);break;case 244:l.exportClause?h.push(l):g(a(l,s))}}}function y(t,r,i){if(2===u)h.push(t);else if(!f){var o=l(t);e.Debug.assert(265===o.kind||233===o.kind),i||function(e,t,r){var i=r.getSymbolAtLocation(t);return n(e,(function(e){if(244===e.kind){var t=e,n=t.exportClause;if(!t.moduleSpecifier&&n)for(var s=0,o=n.elements;s<o.length;s++){var a=o[s];if(r.getExportSpecifierLocalTargetSymbol(a)===i)return!0}}}))}(o,r,s)?v(o):b(o)}}function b(t){e.Debug.assert(!f);var n=p(t);return n&&m.push(t),n}function v(t){if(b(t)){var n=s.getMergedSymbol(t.symbol);e.Debug.assert(!!(1536&n.flags));var r=T(n);if(r)for(var i=0,o=r;i<o.length;i++){v(l(o[i]))}}}function T(t){return r.get(e.getSymbolId(t).toString())}}(t,c,d,i,s),f=h.directImports,m=h.indirectUsers;return __assign({indirectUsers:m},function(e,t,n,r,i){var s=[],a=[];function l(e,t){s.push([e,t])}if(e)for(var c=0,d=e;c<d.length;c++){p(d[c])}return{importSearches:s,singleReferences:a};function p(e){if(237!==e.kind)if(71!==e.kind){if(9===e.moduleSpecifier.kind)if(244!==e.kind){var s=e.importClause;if(s){var a=s.namedBindings;if(a&&240===a.kind)h(a.name);else if(0===n)f(a);else{var c=s.name;if(c&&(!i||c.escapedText===o(t)))l(c,r.getSymbolAtLocation(c));i||1!==n||f(a)}}}else f(e.exportClause)}else h(e);else u(e)&&h(e.name)}function h(e){2!==n||i&&!m(e.escapedText)||l(e,r.getSymbolAtLocation(e))}function f(e){if(e)for(var t=0,n=e.elements;t<n.length;t++){var s=n[t],o=s.name,c=s.propertyName;if(m((c||o).escapedText))if(c)a.push(c),i||l(o,r.getSymbolAtLocation(o));else l(o,246===s.kind&&s.propertyName?r.getExportSpecifierLocalTargetSymbol(s):r.getSymbolAtLocation(o))}}function m(e){return e===t.escapedName||0!==n&&"default"===e}}(f,r,d.exportKind,i,p))}},function(e){e[e.Named=0]="Named",e[e.Default=1]="Default",e[e.ExportEquals=2]="ExportEquals"}(t.ExportKind||(t.ExportKind={})),function(e){e[e.Import=0]="Import",e[e.Export=1]="Export"}(t.ImportExport||(t.ImportExport={})),t.findModuleReferences=function(e,t,n){for(var i=[],s=e.getTypeChecker(),o=0,a=t;o<a.length;o++){var l=a[o],c=n.valueDeclaration;if(265===c.kind){for(var u=0,d=l.referencedFiles;u<d.length;u++){var p=d[u];e.getSourceFileFromReference(l,p)===c&&i.push({kind:"reference",referencingFile:l,ref:p})}for(var h=0,f=l.typeReferenceDirectives;h<f.length;h++){p=f[h];var m=e.getResolvedTypeReferenceDirectives().get(p.fileName);void 0!==m&&m.resolvedFileName===c.fileName&&i.push({kind:"reference",referencingFile:l,ref:p})}}r(l,(function(e,t){s.getSymbolAtLocation(t)===n&&i.push({kind:"import",literal:t})}))}return i},t.getImportOrExportSymbol=function(t,n,r,i){return i?a():a()||function(){var i=function(t){var n=t.parent;switch(n.kind){case 237:return n.name===t&&u(n)?{isNamedImport:!1}:void 0;case 242:return n.propertyName?void 0:{isNamedImport:!0};case 239:case 240:return e.Debug.assert(n.name===t),{isNamedImport:!1};default:return}}(t);if(!i)return;var s=r.getImmediateAliasedSymbol(n);if(!s)return;"export="===(s=function(t,n){if(t.declarations)for(var r=0,i=t.declarations;r<i.length;r++){var s=i[r];if(e.isExportSpecifier(s)&&!s.propertyName&&!s.parent.parent.moduleSpecifier)return n.getExportSpecifierLocalTargetSymbol(s)}return t}(s,r)).escapedName&&(s=function(t,n){if(2097152&t.flags)return n.getImmediateAliasedSymbol(t);var r=t.valueDeclaration;if(e.isExportAssignment(r))return r.expression.symbol;if(e.isBinaryExpression(r))return r.right.symbol;e.Debug.fail()}(s,r));var a=o(s);if(void 0===a||"default"===a||a===n.escapedName)return __assign({kind:0,symbol:s},i)}();function a(){var s=t.parent;if(n.exportSymbol)return 179===s.kind?n.declarations.some((function(e){return e===s}))&&e.isBinaryExpression(s.parent)?u(s.parent,!1):void 0:l(n.exportSymbol,c(s));var o=function(e,t){if(226===e.kind){var n=e;return n.name!==t||260===n.parent.kind?void 0:208===n.parent.parent.kind?n.parent.parent:void 0}return e}(s,t);if(o&&e.hasModifier(o,1)){if(e.isImportEqualsDeclaration(o)&&o.moduleReference===t){if(i)return;return{kind:0,symbol:r.getSymbolAtLocation(o.name),isNamedImport:!1}}return l(n,c(o))}if(e.isExportAssignment(s))return a(s);if(e.isExportAssignment(s.parent))return a(s.parent);if(e.isBinaryExpression(s))return u(s,!0);if(e.isBinaryExpression(s.parent))return u(s.parent,!0);function a(t){var r=t.symbol.parent;e.Debug.assert(!!r);var i=t.isExportEquals?2:1;return{kind:1,symbol:n,exportInfo:{exportingModuleSymbol:r,exportKind:i}}}function u(t,i){var s;switch(e.getSpecialPropertyAssignmentKind(t)){case 1:s=0;break;case 2:s=2;break;default:return}var o=i?r.getSymbolAtLocation(t.left.name):n;return o&&l(o,s)}}function l(e,t){var n=s(e,t,r);return n&&{kind:1,symbol:e,exportInfo:n}}function c(t){return e.hasModifier(t,512)?1:0}},t.getExportInfo=s}(e.FindAllReferences||(e.FindAllReferences={}))}(ts||(ts={})),function(e){!function(t){function n(e,t){return{type:"node",node:e,isInString:t}}function r(e,n,r,i,o){return void 0===o&&(o={}),s(t.Core.getReferencedSymbolsForNode(e,n,r,i,o))}function i(n,r,i,s,o,a){var l=e.getTouchingPropertyName(s,o,!0);return t.Core.getReferencedSymbolsForNode(l,n,i,r,a)}function s(t){return t&&e.flatMap(t,(function(e){return e.references}))}function o(t,n){var r=function(){switch(t.type){case"symbol":var r=t.symbol,i=t.node,s=a(r,i,n),o=s.displayParts,l=s.kind;return{node:i,name:o.map((function(e){return e.text})).join(""),kind:l,displayParts:o};case"label":var c=t.node;return{node:c,name:c.text,kind:"label",displayParts:[e.displayPart(c.text,e.SymbolDisplayPartKind.text)]};case"keyword":var u=t.node,d=e.tokenToString(u.kind);return{node:u,name:d,kind:"keyword",displayParts:[{text:d,kind:"keyword"}]};case"this":var p=t.node,h=(r=n.getSymbolAtLocation(p))&&e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(n,r,p.getSourceFile(),e.getContainerNode(p),p).displayParts;return{node:p,name:"this",kind:"var",displayParts:h};case"string":var f=t.node;return{node:f,name:f.text,kind:"var",displayParts:[e.displayPart(e.getTextOfNode(f),e.SymbolDisplayPartKind.stringLiteral)]}}}();if(r){var i=r.node,s=r.name,o=r.kind,l=r.displayParts,c=i.getSourceFile();return{containerKind:"",containerName:"",fileName:c.fileName,kind:o,name:s,textSpan:e.createTextSpanFromNode(i,c),displayParts:l}}}function a(t,n,r){var i=e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(r,t,n.getSourceFile(),e.getContainerNode(n),n);return{displayParts:i.displayParts,kind:i.symbolKind}}function l(t){if("span"===t.type)return{textSpan:t.textSpan,fileName:t.fileName,isWriteAccess:!1,isDefinition:!1};var n=t.node,r=t.isInString;return{fileName:n.getSourceFile().fileName,textSpan:c(n),isWriteAccess:u(n),isDefinition:79===n.kind||e.isAnyDeclarationName(n)||e.isLiteralComputedPropertyDeclarationName(n),isInString:r}}function c(t){var n=t.getStart(),r=t.getEnd();return 9===t.kind&&(n+=1,r-=1),e.createTextSpanFromBounds(n,r)}function u(t){return 79===t.kind||e.isAnyDeclarationName(t)||e.isWriteAccess(t)}t.nodeEntry=n,t.findReferencedSymbols=function(e,t,n,r,s){var a=i(e,t,n,r,s);if(a&&a.length){for(var c=[],u=e.getTypeChecker(),d=0,p=a;d<p.length;d++){var h=p[d],f=h.definition,m=h.references;f&&c.push({definition:o(f,u),references:m.map(l)})}return c}},t.getImplementationsAtPosition=function(i,s,o,l,u){var d=function(i,s,o,a){if(265===a.kind)return;var l=i.getTypeChecker();if(262===a.parent.kind){var c=[];return t.Core.getReferenceEntriesForShorthandPropertyAssignment(a,l,(function(e){return c.push(n(e))})),c}if(97===a.kind||e.isSuperProperty(a.parent)){var u=l.getSymbolAtLocation(a);return u.valueDeclaration&&[n(u.valueDeclaration)]}return r(a,i,o,s,{implementations:!0})}(i,s,o,e.getTouchingPropertyName(l,u,!1)),p=i.getTypeChecker();return e.map(d,(function(t){return function(t,n){if("node"===t.type){var r=t.node;return __assign({textSpan:c(r),fileName:r.getSourceFile().fileName},function(t,n){var r=n.getSymbolAtLocation(e.isDeclaration(t)&&t.name?t.name:t);return r?a(r,t,n):178===t.kind?{kind:"interface",displayParts:[e.punctuationPart(19),e.textPart("object literal"),e.punctuationPart(20)]}:199===t.kind?{kind:"local class",displayParts:[e.punctuationPart(19),e.textPart("anonymous local class"),e.punctuationPart(20)]}:{kind:e.getNodeKind(t),displayParts:[]}}(r,n))}return{textSpan:t.textSpan,fileName:t.fileName,kind:"",displayParts:[]}}(t,p)}))},t.findReferencedEntries=function(t,n,r,o,a,c){var u=s(i(t,n,r,o,a,c));return e.map(u,l)},t.getReferenceEntriesForNode=r,t.toHighlightSpan=function(e){if("span"===e.type)return{fileName:e.fileName,span:{textSpan:e.textSpan,kind:"reference"}};var t=e.node,n=e.isInString,r=e.node.getSourceFile().fileName,i=u(t);return{fileName:r,span:{textSpan:c(t),kind:i?"writtenReference":"reference",isInString:n}}}}(e.FindAllReferences||(e.FindAllReferences={}))}(ts||(ts={})),function(e){!function(t){!function(n){n.getReferencedSymbolsForNode=function(n,s,a,c,p){if(void 0===p&&(p={}),265!==n.kind){if(!p.implementations){var f=function(n,r,i){if(e.isTypeKeyword(n.kind))return function(t,n,r){for(var i=[],s=0,o=t;s<o.length;s++){var a=o[s];r.throwIfCancellationRequested(),h(a,n,e.tokenToString(n),i)}return i.length?[{definition:{type:"keyword",node:i[0].node},references:i}]:void 0}(r,n.kind,i);if(e.isLabelName(n)){if(e.isJumpStatementTarget(n)){var s=e.getTargetLabel(n.parent,n.text);return s&&d(s.parent,s)}return d(n.parent,n)}if(e.isThis(n))return function(n,r,i){var s=e.getThisContainer(n,!1),o=32;switch(s.kind){case 151:case 150:if(e.isObjectLiteralMethod(s))break;case 149:case 148:case 152:case 153:case 154:o&=e.getModifierFlags(s),s=s.parent;break;case 265:if(e.isExternalModule(s))return;case 228:case 186:break;default:return}var a=[];if(265===s.kind)e.forEach(r,(function(e){i.throwIfCancellationRequested(),c(e,e,u(e,"this"),a)}));else{var l=s.getSourceFile();c(l,s,u(l,"this",s),a)}return[{definition:{type:"this",node:n},references:a}];function c(n,r,i,s){e.forEach(i,(function(i){var a=e.getTouchingWord(n,i,!1);if(a&&e.isThis(a)){var l=e.getThisContainer(a,!1);switch(r.kind){case 186:case 228:r.symbol===l.symbol&&s.push(t.nodeEntry(a));break;case 151:case 150:e.isObjectLiteralMethod(r)&&r.symbol===l.symbol&&s.push(t.nodeEntry(a));break;case 199:case 229:l.parent&&r.symbol===l.parent.symbol&&(32&e.getModifierFlags(l))===o&&s.push(t.nodeEntry(a));break;case 265:265!==l.kind||e.isExternalModule(l)||s.push(t.nodeEntry(a))}}}))}}(n,r,i);if(97===n.kind)return function(n){var r=e.getSuperContainer(n,!1);if(!r)return;var i=32;switch(r.kind){case 149:case 148:case 151:case 150:case 152:case 153:case 154:i&=e.getModifierFlags(r),r=r.parent;break;default:return}for(var s=[],o=r.getSourceFile(),a=u(o,"super",r),l=0,c=a;l<c.length;l++){var d=c[l],p=e.getTouchingWord(o,d,!1);if(p&&97===p.kind){var h=e.getSuperContainer(p,!1);h&&(32&e.getModifierFlags(h))===i&&h.parent.symbol===r.symbol&&s.push(t.nodeEntry(p))}}return[{definition:{type:"symbol",symbol:r.symbol,node:n},references:s}]}(n);return}(n,a,c);if(f)return f}var _=s.getTypeChecker(),b=_.getSymbolAtLocation(n);return b?1536&b.flags&&function(t){if(9!==t.kind)return!1;switch(t.parent.kind){case 233:case 248:case 238:case 244:return!0;case 181:return e.isRequireCall(t.parent,!1)||e.isImportCall(t.parent);default:return!1}}(n)?function(n,r,i){e.Debug.assert(!!r.valueDeclaration);for(var s=t.findModuleReferences(n,i,r).map((function(t){return"import"===t.kind?{type:"node",node:t.literal}:{type:"span",fileName:t.referencingFile.fileName,textSpan:e.createTextSpanFromRange(t.ref)}})),o=0,a=r.declarations;o<a.length;o++){var l=a[o];switch(l.kind){case 265:break;case 233:s.push({type:"node",node:l.name});break;default:e.Debug.fail("Expected a module symbol to be declared by a SourceFile or ModuleDeclaration.")}}return[{definition:{type:"symbol",symbol:r,node:r.valueDeclaration},references:s}]}(s,b,a):function(t,n,s,a,c,u){t=function(t,n,r){var i=n.parent;if(e.isExportSpecifier(i))return g(n,t,i,r);if(e.isImportSpecifier(i)&&i.propertyName===n)return r.getImmediateAliasedSymbol(t);return t}(t,n,a);var d=function(t,n){if(n){var r=void 0;do{r=t;for(var i=0,s=n;i<s.length;i++){var o=s[i],a=e.getMeaningFromDeclaration(o);a&t&&(t|=a)}}while(t!==r)}return t}(e.getMeaningFromLocation(n),t.declarations),p=[],h=new r(s,123===n.kind,a,c,d,u,p);if(79===n.kind)y(n,t,n,h),i(n,t,{exportingModuleSymbol:t.parent,exportKind:1},h);else{var f=h.createSearch(n,t,void 0,{allSearchSymbols:k(t,n,a,u.implementations)}),_=function(t){var n=t.declarations,r=t.flags,i=t.parent,s=t.valueDeclaration;if(s&&(186===s.kind||199===s.kind))return s;if(!n)return;if(8196&r){var o=e.find(n,(function(t){return e.hasModifier(t,8)}));return o?e.getAncestor(o,229):void 0}if(l(t))return;var a,c=i&&!(262144&t.flags);if(c&&(!(1536&i.flags&&e.isExternalModuleSymbol(i))||i.globalExports))return;for(var u=0,d=n;u<d.length;u++){var p=d[u],h=e.getContainerNode(p);if(a&&a!==h)return;if(!h||265===h.kind&&!e.isExternalOrCommonJsModule(h))return;a=h}return c?a.getSourceFile():a}(t);if(_)m(_,_.getSourceFile(),f,h);else for(var b=0,v=h.sourceFiles;b<v.length;b++){var T=v[b];h.cancellationToken.throwIfCancellationRequested(),o(T,f,h)}}return p}(b,n,a,_,c,p):p.implementations||9!==n.kind?void 0:function(n,r,i){for(var s=[],o=0,a=r;o<a.length;o++){var l=a[o];i.throwIfCancellationRequested();var c=u(l,n.text);d(l,n.text,c,s)}return[{definition:{type:"string",node:n},references:s}];function d(n,r,i,s){for(var o=0,a=i;o<a.length;o++){var l=a[o],c=e.getTouchingWord(n,l,!1);c&&9===c.kind&&c.text===r&&s.push(t.nodeEntry(c,!0))}}}(n,a,c)}};var r=function(){function n(t,n,r,i,s,o,a){this.sourceFiles=t,this.isForConstructor=n,this.checker=r,this.cancellationToken=i,this.searchMeaning=s,this.options=o,this.result=a,this.inheritsFromCache=e.createMap(),this.markSeenContainingTypeReference=e.nodeSeenTracker(),this.markSeenReExportRHS=e.nodeSeenTracker(),this.symbolIdToReferences=[],this.sourceFileToSeenSymbols=[]}return n.prototype.getImportSearches=function(e,n){return this.importTracker||(this.importTracker=t.createImportTracker(this.sourceFiles,this.checker,this.cancellationToken)),this.importTracker(e,n,this.options.isForRename)},n.prototype.createSearch=function(t,n,r,i){void 0===i&&(i={});var s=i.text,o=void 0===s?e.stripQuotes(e.unescapeLeadingUnderscores((e.getLocalSymbolForExportDefault(n)||n).escapedName)):s,a=i.allSearchSymbols,l=void 0===a?void 0:a,c=e.escapeLeadingUnderscores(o),u=this.options.implementations&&function(t,n,r){var i=(s=t,e.isRightSideOfPropertyAccess(s)&&s.parent);var s;if(!i)return;var o=r.getTypeAtLocation(i.expression);if(!o)return;if(o.symbol&&96&o.symbol.flags&&o.symbol!==n.parent)return[o.symbol];if(196608&o.flags)return b(o)}(t,n,this.checker);return{location:t,symbol:n,comingFrom:r,text:o,escapedText:c,parents:u,includes:function(t){return l?e.contains(l,t):t===n}}},n.prototype.referenceAdder=function(n,r){var i=e.getSymbolId(n),s=this.symbolIdToReferences[i];return s||(s=this.symbolIdToReferences[i]=[],this.result.push({definition:{type:"symbol",symbol:n,node:r},references:s})),function(e){return s.push(t.nodeEntry(e))}},n.prototype.addStringOrCommentReference=function(e,t){this.result.push({definition:void 0,references:[{type:"span",fileName:e,textSpan:t}]})},n.prototype.markSearchedSymbol=function(t,n){var r=e.getNodeId(t),i=e.getSymbolId(n),s=this.sourceFileToSeenSymbols[r]||(this.sourceFileToSeenSymbols[r]=[]);return!s[i]&&(s[i]=!0)},n}();function i(e,t,n,r){var i=r.getImportSearches(t,n),s=i.importSearches,a=i.singleReferences,l=i.indirectUsers;if(a.length)for(var c=r.referenceAdder(t,e),u=0,d=a;u<d.length;u++){c(d[u])}for(var p=0,h=s;p<h.length;p++){var m=h[p],_=m[0],g=m[1];f(_.getSourceFile(),r.createSearch(_,g,1),r)}if(l.length){var y=void 0;switch(n.exportKind){case 0:y=r.createSearch(e,t,1);break;case 1:y=r.options.isForRename?void 0:r.createSearch(e,t,1,{text:"default"})}if(y)for(var b=0,v=l;b<v.length;b++){o(v[b],y,r)}}}function s(e,t){for(var n=0,r=e.declarations;n<r.length;n++){var i=r[n];f(i.getSourceFile(),t.createSearch(i,e,0),t)}}function o(t,n,r){void 0!==e.getNameTable(t).get(n.escapedText)&&f(t,n,r)}function a(t,n){return e.isArrayLiteralOrObjectLiteralDestructuringPattern(t.parent.parent)&&n.getPropertySymbolOfDestructuringAssignment(t)}function l(t){var n=e.getDeclarationOfKind(t,176);if(n&&174===n.parent.kind&&!n.propertyName)return n}function c(t,n){var r=l(t);if(r){var i=n.getTypeAtLocation(r.parent),s=i&&n.getPropertyOfType(i,r.name.text);return s&&98304&s.flags?(e.Debug.assert(!!(33554432&s.flags)),s.target):s}}function u(t,n,r){void 0===r&&(r=t);var i=[];if(!n||!n.length)return i;for(var s=t.text,o=s.length,a=n.length,l=s.indexOf(n,r.pos);l>=0&&!(l>r.end);){var c=l+a;0!==l&&e.isIdentifierPart(s.charCodeAt(l-1),5)||c!==o&&e.isIdentifierPart(s.charCodeAt(c),5)||i.push(l),l=s.indexOf(n,l+a+1)}return i}function d(n,r){for(var i=[],s=n.getSourceFile(),o=r.text,a=0,l=u(s,o,n);a<l.length;a++){var c=l[a],d=e.getTouchingWord(s,c,!1);d&&(d===r||e.isJumpStatementTarget(d)&&e.getTargetLabel(d,o)===r)&&i.push(t.nodeEntry(d))}return[{definition:{type:"label",node:r},references:i}]}function p(t,n){switch(t.kind){case 71:return t.text.length===n.length;case 9:return(e.isLiteralNameOfPropertyDeclarationOrIndexAccess(t)||function(t){if(9===t.kind)return e.isNameOfModuleDeclaration(t)||e.isExpressionOfExternalModuleImportEqualsDeclaration(t);return!1}(t))&&t.text.length===n.length;case 8:return e.isLiteralNameOfPropertyDeclarationOrIndexAccess(t)&&t.text.length===n.length;case 79:return"default".length===n.length;default:return!1}}function h(n,r,i,s){for(var o=0,a=u(n,i,n);o<a.length;o++){var l=a[o],c=e.getTouchingPropertyName(n,l,!0);c.kind===r&&s.push(t.nodeEntry(c))}}function f(e,t,n){return n.cancellationToken.throwIfCancellationRequested(),m(e,e,t,n)}function m(e,t,n,r){if(r.markSearchedSymbol(t,n.symbol))for(var i=0,s=u(t,n.text,e);i<s.length;i++){_(t,s[i],n,r)}}function _(n,r,o,l){var u=e.getTouchingPropertyName(n,r,!0);if(p(u,o.text)){if(e.getMeaningFromLocation(u)&l.searchMeaning){var d=l.checker.getSymbolAtLocation(u);if(d){var h=u.parent;if(!e.isImportSpecifier(h)||h.propertyName!==u){if(e.isExportSpecifier(h))return e.Debug.assert(71===u.kind),void function(n,r,o,a,l){var c=o.parent,u=o.propertyName,d=o.name,p=c.parent,h=g(n,r,o,l.checker);if(!a.includes(h))return;u?n===u?(p.moduleSpecifier||_(),!l.options.isForRename&&l.markSeenReExportRHS(d)&&y(d,r,d,l)):l.markSeenReExportRHS(n)&&_():_();if(n!==u||!l.options.isForRename){var f=79===n.originalKeywordKind?1:0,m=t.getExportInfo(r,f,l.checker);e.Debug.assert(!!m),i(n,r,m,l)}1!==a.comingFrom&&p.moduleSpecifier&&!u&&s(l.checker.getExportSpecifierLocalTargetSymbol(o),l);function _(){y(n,h,a.location,l)}}(u,d,h,o,l);var f=function(t,n,r,i){if(t.includes(n))return n;var s=e.getContainingObjectLiteralElement(r);if(s){var o=e.forEach(x(s,i.checker),(function(n){return e.find(i.checker.getRootSymbols(n),t.includes)}));if(o)return o;var l=a(r,i.checker);if(l&&t.includes(l))return l}var u=c(n,i.checker);if(u){var d=p(u);if(d)return d}return p(n);function p(n){return e.forEach(i.checker.getRootSymbols(n),(function(n){if(t.includes(n))return n;if(n.parent&&96&n.parent.flags){if(t.parents&&!e.some(t.parents,(function(t){return function(t,n,r,i){var s=64&n.getFlags();return o(t);function o(t){if(t===n)return!0;var i=e.getSymbolId(t)+","+e.getSymbolId(n),o=r.get(i);if(void 0!==o)return o;r.set(i,!1);var l=e.forEach(t.getDeclarations(),(function(t){if(e.isClassLike(t)){if(s){var n=e.getClassImplementsHeritageClauseElements(t);if(n)for(var r=0,i=n;r<i.length;r++){if(a(i[r]))return!0}}return a(e.getClassExtendsHeritageClauseElement(t))}return!(230!==t.kind||!s)&&e.forEach(e.getInterfaceBaseTypeNodes(t),a)}));return r.set(i,l),l}function a(e){if(e){var t=i.getTypeAtLocation(e);if(t&&t.symbol)return o(t.symbol)}return!1}}(n.parent,t,i.inheritsFromCache,i.checker)})))return;var r=[];return E(n.parent,n.name,r,e.createSymbolTable(),i.checker),e.find(r,t.includes)}}))}}(o,d,u,l);f?(l.isForConstructor?function(t,n,r,i){e.isNewExpressionTarget(t)&&y(t,r.symbol,r.location,i);var s=i.referenceAdder(r.symbol,r.location);if(e.isClassLike(t.parent))e.Debug.assert(t.parent.name===t),function(t,n,r){for(var i=0,s=t.members.get("__constructor").declarations;i<s.length;i++){var o=s[i],a=e.findChildOfKind(o,123,n);e.Debug.assert(152===o.kind&&!!a),r(a)}t.exports.forEach((function(t){var n=t.valueDeclaration;if(n&&151===n.kind){var i=n.body;i&&C(i,99,(function(t){e.isNewExpressionTarget(t)&&r(t)}))}}))}(r.symbol,n,s);else{var o=(a=t,e.tryGetClassExtendingExpressionWithTypeArguments(e.climbPastPropertyAccess(a).parent));o&&e.isClassLike(o)&&function(t,n){var r=t.symbol.members.get("__constructor");if(!r)return;for(var i=0,s=r.declarations;i<s.length;i++){var o=s[i];e.Debug.assert(152===o.kind);var a=o.body;a&&C(a,97,(function(t){e.isCallExpressionTarget(t)&&n(t)}))}}(o,s)}var a}(u,n,o,l):y(u,f,o.location,l),function(e,n,r,o){var a=t.getImportOrExportSymbol(e,n,o.checker,1===r.comingFrom);if(!a)return;var l=a.symbol;0===a.kind?o.options.isForRename&&!a.isNamedImport||s(l,o):i(e,l,a.exportInfo,o)}(u,d,o,l)):function(t,n,r){var i=t.flags,s=t.valueDeclaration,o=r.checker.getShorthandAssignmentValueSymbol(s);33554432&i||!n.includes(o)||y(e.getNameOfDeclaration(s),o,n.location,r)}(d,o,l)}}}}else!l.options.implementations&&(l.options.findInStrings&&e.isInString(n,r)||l.options.findInComments&&e.isInNonReferenceComment(n,r))&&l.addStringOrCommentReference(n.fileName,e.createTextSpan(r,o.text.length))}function g(t,n,r,i){return function(t,n){var r=n.parent,i=n.propertyName,s=n.name;return e.Debug.assert(i===t||s===t),i?i===t:!r.parent.moduleSpecifier}(t,r)?i.getExportSpecifierLocalTargetSymbol(r):n}function y(t,n,r,i){var s=i.referenceAdder(n,r);i.options.implementations?function(t,n,r){if(e.isDeclarationName(t)&&function(t){if(!t)return!1;if(e.isVariableLike(t)){if(t.initializer)return!0;if(226===t.kind){var n=function(t){if(t.parent&&t.parent.parent&&208===t.parent.parent.kind)return e.Debug.assert(227===t.parent.kind),t.parent.parent}(t);return n&&e.hasModifier(n,2)}}else{if(e.isFunctionLike(t))return!!t.body||e.hasModifier(t,2);switch(t.kind){case 229:case 199:case 232:case 233:return!0}}return!1}(t.parent))return void n(t.parent);if(71!==t.kind)return;262===t.parent.kind&&S(t,r.checker,n);var i=v(t);if(i)return void n(i);var s=function(t){var n=void 0;for(;t;)e.isTypeNode(t)&&(n=t),t=t.parent;return n}(t);if(s&&r.markSeenContainingTypeReference(s)){var o=s.parent;if(e.isVariableLike(o)&&o.type===s&&o.initializer&&T(o.initializer))n(o.initializer);else if(e.isFunctionLike(o)&&o.type===s&&o.body){var a=o.body;207===a.kind?e.forEachReturnStatement(a,(function(e){e.expression&&T(e.expression)&&n(e.expression)})):T(a)&&n(a)}else e.isAssertionExpression(o)&&T(o.expression)&&n(o.expression)}}(t,s,i):s(t)}function b(e,t){void 0===t&&(t=[]);for(var n=0,r=e.types;n<r.length;n++){var i=r[n];i.symbol&&96&i.symbol.getFlags()&&t.push(i.symbol),196608&i.getFlags()&&b(i,t)}return t}function v(t){if(t&&t.parent){if(201===t.kind&&259===t.parent.kind&&e.isClassLike(t.parent.parent))return t.parent.parent;if(71===t.kind||179===t.kind)return v(t.parent)}}function T(e){switch(e.kind){case 185:return T(e.expression);case 187:case 186:case 178:case 199:case 177:return!0;default:return!1}}function k(t,n,r,i){var s=[t],o=e.getContainingObjectLiteralElement(n);if(o){if(262!==o.kind){var l=a(n,r);l&&s.push(l)}e.forEach(x(o,r),(function(t){e.addRange(s,r.getRootSymbols(t))}));var u=r.getShorthandAssignmentValueSymbol(n.parent);u&&s.push(u)}t.valueDeclaration&&146===t.valueDeclaration.kind&&e.isParameterPropertyDeclaration(t.valueDeclaration)&&e.addRange(s,r.getSymbolsOfParameterPropertyDeclaration(t.valueDeclaration,t.name));var d=c(t,r);return d&&(s.push(d),p(d)),p(t),s;function p(t){for(var n=0,o=r.getRootSymbols(t);n<o.length;n++){var a=o[n];a!==t&&s.push(a),!i&&a.parent&&96&a.parent.flags&&E(a.parent,a.name,s,e.createSymbolTable(),r)}}}function E(t,n,r,i,s){function o(e){if(e){var o=s.getTypeAtLocation(e);if(o){var a=s.getPropertyOfType(o,n);a&&r.push.apply(r,s.getRootSymbols(a)),i.set(t.escapedName,t),E(o.symbol,n,r,i,s)}}}!t||i.has(t.escapedName)||96&t.flags&&e.forEach(t.getDeclarations(),(function(t){e.isClassLike(t)?(o(e.getClassExtendsHeritageClauseElement(t)),e.forEach(e.getClassImplementsHeritageClauseElements(t),o)):230===t.kind&&e.forEach(e.getInterfaceBaseTypeNodes(t),o)}))}function x(t,n){var r=t.parent,i=n.getContextualType(r),s=function(t){if(144===t.name.kind){var n=t.name.expression;return e.isStringOrNumericLiteral(n)?n.text:void 0}return e.getTextOfIdentifierOrLiteral(t.name)}(t);if(s&&i){var o=[],a=i.getProperty(s);return a&&o.push(a),65536&i.flags&&e.forEach(i.types,(function(e){var t=e.getProperty(s);t&&o.push(t)})),o}}function S(t,n,r){var i=n.getSymbolAtLocation(t),s=n.getShorthandAssignmentValueSymbol(i.valueDeclaration);if(s)for(var o=0,a=s.getDeclarations();o<a.length;o++){var l=a[o];1&e.getMeaningFromDeclaration(l)&&r(l)}}function C(t,n,r){e.forEachChild(t,(function(e){e.kind===n&&r(e),C(e,n,r)}))}n.getReferenceEntriesForShorthandPropertyAssignment=S}(t.Core||(t.Core={}))}(e.FindAllReferences||(e.FindAllReferences={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,s){var a=[],l=n.getDeclarations(),c=o(t,n,s),u=c.symbolName,d=c.symbolKind,p=c.containerName;return function(t,n,r,i,s,o){if((e.isNewExpressionTarget(n)||123===n.kind)&&32&t.flags){for(var a=0,l=t.getDeclarations();a<l.length;a++){var c=l[a];if(e.isClassLike(c))return h(c.members,!0,r,i,s,o)}e.Debug.fail("Expected declaration to have at least one class-like declaration")}return!1}(n,s,d,u,p,a)||function(t,n,r,i,s,o){if(e.isCallExpressionTarget(n)||e.isNewExpressionTarget(n)||e.isNameOfFunctionDeclaration(n))return h(t.declarations,!1,r,i,s,o);return!1}(n,s,d,u,p,a)||e.forEach(l,(function(e){a.push(i(e,d,u,p))})),a;function h(t,n,s,o,a,l){if(!t)return!1;for(var c,u=[],d=0,p=t;d<p.length;d++){var h=p[d];(n?152===h.kind:r(h))&&(u.push(h),h.body&&(c=h))}return!!u.length&&(l.push(i(c||e.lastOrUndefined(u),s,o,a)),!0)}}function r(e){switch(e.kind){case 152:case 228:case 151:case 150:return!0;default:return!1}}function i(t,n,r,i){return s(e.getNameOfDeclaration(t)||t,n,r,i)}function s(t,n,r,i){var s=t.getSourceFile();return{fileName:s.fileName,textSpan:e.createTextSpanFromNode(t,s),kind:n,name:r,containerKind:void 0,containerName:i}}function o(t,n,r){return{symbolName:t.symbolToString(n),symbolKind:e.SymbolDisplay.getSymbolKind(t,n,r),containerName:n.parent?t.symbolToString(n.parent,r):""}}function a(e,t){var n=o(e,t.symbol,t),r=n.symbolName;return i(t,n.symbolKind,r,n.containerName)}function l(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.pos<=t&&t<=i.end)return i}}function c(t,n){return{fileName:n,textSpan:e.createTextSpanFromBounds(0,0),kind:"script",name:t,containerName:void 0,containerKind:void 0}}function u(t){return e.isRightSideOfPropertyAccess(t)?u(t.parent):t}t.getDefinitionAtPosition=function(t,o,d){var p=l(o.referencedFiles,d);if(p&&(h=e.tryResolveScriptReference(t,o,p)))return[c(p.fileName,h.fileName)];var h,f=l(o.typeReferenceDirectives,d);if(f)return(h=t.getResolvedTypeReferenceDirectives().get(f.fileName))&&h.resolvedFileName&&[c(f.fileName,h.resolvedFileName)];var m=e.getTouchingPropertyName(o,d,!0);if(m!==o){if(e.isJumpStatementTarget(m)){var _=m.text,g=e.getTargetLabel(m.parent,_);return g?[s(g,"label",_,void 0)]:void 0}var y=t.getTypeChecker(),b=function(t,n){var i=function(t){var n=u(t),r=n.parent;return r&&e.isCallLikeExpression(r)&&e.getInvokedExpression(r)===n&&r}(n),s=i&&t.getResolvedSignature(i);if(s){var o=s.declaration;if(o&&r(o))return o}return}(y,m);if(b)return[a(y,b)];var v=y.getSymbolAtLocation(m);if(v){if(2097152&v.flags&&function(e,t){if(71!==e.kind)return!1;if(e.parent===t)return!0;switch(t.kind){case 239:case 237:return!0;case 242:return 241===t.parent.kind;default:return!1}}(m,v.declarations[0])){var T=y.getAliasedSymbol(v);T.declarations&&(v=T)}if(262===m.parent.kind){var k=y.getShorthandAssignmentValueSymbol(v.valueDeclaration);if(!k)return[];var E=k.getDeclarations(),x=e.SymbolDisplay.getSymbolKind(y,k,m),S=y.symbolToString(k),C=y.symbolToString(v.parent,m);return e.map(E,(function(e){return i(e,x,S,C)}))}if(e.isPropertyName(m)&&e.isBindingElement(m.parent)&&e.isObjectBindingPattern(m.parent.parent)&&m===(m.parent.propertyName||m.parent.name)){var I=y.getTypeAtLocation(m.parent.parent);if(I){var A=e.getPropertySymbolsFromType(I,m);if(A)return e.flatMap(A,(function(e){return n(y,e,m)}))}}var w=e.getContainingObjectLiteralElement(m);return w&&y.getContextualType(w.parent)?e.flatMap(e.getPropertySymbolsFromContextualType(y,w),(function(e){return n(y,e,m)})):n(y,v,m)}}},t.getTypeDefinitionAtPosition=function(t,r,i){var s=e.getTouchingPropertyName(r,i,!0);if(s!==r){var o=t.getSymbolAtLocation(s);if(o){var a=t.getTypeOfSymbolAtLocation(o,s);if(a){if(65536&a.flags&&!(16&a.flags)){var l=[];return e.forEach(a.types,(function(r){r.symbol&&e.addRange(l,n(t,r.symbol,s))})),l}if(a.symbol)return n(t,a.symbol,s)}}}}}(e.GoToDefinition||(e.GoToDefinition={}))}(ts||(ts={})),function(e){!function(t){var n,r,i=["augments","author","argument","borrows","class","constant","constructor","constructs","default","deprecated","description","event","example","extends","field","fileOverview","function","ignore","inner","lends","link","memberOf","method","name","namespace","param","private","prop","property","public","requires","returns","see","since","static","throws","type","typedef","version"];function s(t,n){if(t)for(var r=0;r<t.length;r++)if(e.indexOf(t,t[r])===r){var i=n(t[r],r);if(i)return i}}function o(t){for(;185===t.kind;)t=t.expression;switch(t.kind){case 186:case 187:return t.parameters;case 199:for(var n=0,r=t.members;n<r.length;n++){var i=r[n];if(152===i.kind)return i.parameters}}return e.emptyArray}t.getJsDocCommentsFromDeclarations=function(t){var n=[];return s(t,(function(t){e.forEach(e.getAllJSDocs(t),(function(t){t.comment&&(n.length&&n.push(e.lineBreakPart()),n.push(e.textPart(t.comment)))}))})),n},t.getJsDocTagsFromDeclarations=function(t){var n=[];return s(t,(function(t){for(var r=0,i=e.getJSDocTags(t);r<i.length;r++){var s=i[r];276===s.kind&&n.push({name:s.tagName.text,text:s.comment})}})),n},t.getJSDocTagNameCompletions=function(){return n||(n=e.map(i,(function(e){return{name:e,kind:"keyword",kindModifiers:"",sortText:"0"}})))},t.getJSDocTagCompletions=function(){return r||(r=e.map(i,(function(e){return{name:"@"+e,kind:"keyword",kindModifiers:"",sortText:"0"}})))},t.getJSDocParameterNameCompletions=function(t){if(!e.isIdentifier(t.name))return e.emptyArray;var n=t.name.text,r=t.parent,i=r.parent;return e.isFunctionLike(i)?e.mapDefined(i.parameters,(function(i){if(e.isIdentifier(i.name)){var s=i.name.text;if(!r.tags.some((function(n){return n!==t&&e.isJSDocParameterTag(n)&&e.isIdentifier(n.name)&&n.name.escapedText===s}))&&(void 0===n||e.startsWith(s,n)))return{name:s,kind:"parameter",kindModifiers:"",sortText:"0"}}})):[]},t.getDocCommentTemplateAtPosition=function(t,n,r){if(!(e.isInString(n,r)||e.isInComment(n,r)||e.hasDocComment(n,r))){var i=e.getTokenAtPosition(n,r,!1),s=i.getStart();if(i&&!(s<r)){var a=function(t){for(var n=t;n;n=n.parent)switch(n.kind){case 228:case 151:case 152:return{commentOwner:n,parameters:n.parameters};case 229:return{commentOwner:n};case 208:var r=n.declarationList.declarations;return{commentOwner:n,parameters:1===r.length&&r[0].initializer?o(r[0].initializer):void 0};case 265:return;case 233:return 233===n.parent.kind?void 0:{commentOwner:n};case 194:var i=n;if(0===e.getSpecialPropertyAssignmentKind(i))return;return{commentOwner:n,parameters:e.isFunctionLike(i.right)?i.right.parameters:e.emptyArray}}}(i);if(a){var l=a.commentOwner,c=a.parameters;if(!(l.getStart()<r)){var u=n.getLineAndCharacterOfPosition(r),d=n.getLineStarts()[u.line],p=n.text.substr(d,u.character).replace(/\S/i,(function(){return" "})),h=e.hasJavaScriptFileExtension(n.fileName),f="";if(c)for(var m=0;m<c.length;m++){var _=c[m].name,g=71===_.kind?_.escapedText:"param"+m;f+=h?p+" * @param {any} "+g+t:p+" * @param "+g+t}var y="/**"+t+p+" * ";return{newText:y+t+f+p+" */"+(s===r?t+p:""),caretOffset:y.length}}}}}}}(e.JsDoc||(e.JsDoc={}))}(ts||(ts={})),function(e){!function(t){t.nodeCoreModuleList=["buffer","querystring","events","http","cluster","zlib","os","https","punycode","repl","readline","vm","child_process","url","dns","net","dgram","fs","path","string_decoder","tls","crypto","stream","util","assert","tty","domain","constants","process","v8","timers","console"];var n=e.arrayToSet(t.nodeCoreModuleList);t.loadSafeList=function(t,n){var r=e.readConfigFile(n,(function(e){return t.readFile(e)}));return e.createMapFromTemplate(r.config)},t.loadTypesMap=function(t,n){var r=e.readConfigFile(n,(function(e){return t.readFile(e)}));if(r.config)return e.createMapFromTemplate(r.config.simpleMap)},t.discoverTypings=function(t,r,i,s,o,a,l,c){if(!l||!l.enable)return{cachedTypingPaths:[],newTypingNames:[],filesToWatch:[]};var u=e.createMap();i=e.mapDefined(i,(function(t){var n=e.normalizePath(t);if(e.hasJavaScriptFileExtension(n))return n}));var d=[];l.include&&T(l.include,"Explicitly included types");var p=l.exclude||[],h=e.arrayToSet(i,e.getDirectoryPath);h.set(s,!0),h.forEach((function(t,n){k(e.combinePaths(n,"package.json"),d),k(e.combinePaths(n,"bower.json"),d),E(e.combinePaths(n,"bower_components"),d),E(e.combinePaths(n,"node_modules"),d)})),function(t){var n=e.mapDefined(t,(function(t){if(e.hasJavaScriptFileExtension(t)){var n=e.removeFileExtension(e.getBaseFileName(t.toLowerCase())).replace(/((?:\.|-)min(?=\.|$))|((?:-|\.)\d+)/g,"");return o.get(n)}}));n.length&&T(n,"Inferred typings from file names");e.some(t,(function(t){return e.fileExtensionIs(t,".jsx")}))&&(r&&r("Inferred 'react' typings due to presence of '.jsx' extension"),v("react"))}(i),c&&T(e.deduplicate(c.map((function(e){return n.has(e)?"node":e}))),"Inferred typings from unresolved imports"),a.forEach((function(e,t){u.has(t)&&void 0===u.get(t)&&u.set(t,e)}));for(var f=0,m=p;f<m.length;f++){var _=m[f];u.delete(_)&&r&&r("Typing for "+_+" is in exclude list, will be ignored.")}var g=[],y=[];u.forEach((function(e,t){void 0!==e?y.push(e):g.push(t)}));var b={cachedTypingPaths:y,newTypingNames:g,filesToWatch:d};return r&&r("Result: "+JSON.stringify(b)),b;function v(e){u.has(e)||u.set(e,void 0)}function T(t,n){r&&r(n+": "+JSON.stringify(t)),e.forEach(t,v)}function k(n,r){if(t.fileExists(n)){r.push(n);var i=e.readConfigFile(n,(function(e){return t.readFile(e)})).config;T(e.flatMap([i.dependencies,i.devDependencies,i.optionalDependencies,i.peerDependencies],e.getOwnKeys),"Typing names in '"+n+"' dependencies")}}function E(n,i){if(i.push(n),t.directoryExists(n)){var s=t.readDirectory(n,[".json"],void 0,void 0,2);r&&r("Searching for typing names in "+n+"; all files: "+JSON.stringify(s));for(var o=[],a=0,l=s;a<l.length;a++){var c=l[a],d=e.normalizePath(c),p=e.getBaseFileName(d);if("package.json"===p||"bower.json"===p){var h=e.readConfigFile(d,(function(e){return t.readFile(e)})).config;if(("package.json"!==p||!h._requiredBy||0!==e.filter(h._requiredBy,(function(e){return"#"===e[0]||"/"===e})).length)&&h.name){var f=h.types||h.typings;if(f){var m=e.getNormalizedAbsolutePath(f,e.getDirectoryPath(d));r&&r("    Package '"+h.name+"' provides its own types."),u.set(h.name,m)}else o.push(h.name)}}}T(o,"    Found package names")}}},function(e){e[e.Ok=0]="Ok",e[e.ScopedPackagesNotSupported=1]="ScopedPackagesNotSupported",e[e.EmptyName=2]="EmptyName",e[e.NameTooLong=3]="NameTooLong",e[e.NameStartsWithDot=4]="NameStartsWithDot",e[e.NameStartsWithUnderscore=5]="NameStartsWithUnderscore",e[e.NameContainsNonURISafeCharacters=6]="NameContainsNonURISafeCharacters"}(t.PackageNameValidationResult||(t.PackageNameValidationResult={}));t.validatePackageName=function(e){return e?e.length>214?3:46===e.charCodeAt(0)?4:95===e.charCodeAt(0)?5:/^@[^/]+\/[^/]+$/.test(e)?1:encodeURIComponent(e)!==e?6:0:2},t.renderPackageNameValidationFailure=function(t,n){switch(t){case 2:return"Package name '"+n+"' cannot be empty";case 3:return"Package name '"+n+"' should be less than 214 characters";case 4:return"Package name '"+n+"' cannot start with '.'";case 5:return"Package name '"+n+"' cannot start with '_'";case 1:return"Package '"+n+"' is scoped and currently is not supported";case 6:return"Package name '"+n+"' contains non URI safe characters";case 0:throw e.Debug.fail();default:e.Debug.assertNever(t)}}}(e.JsTyping||(e.JsTyping={}))}(ts||(ts={})),function(e){!function(t){function n(e,t){switch(e.kind){case 239:case 242:case 237:var n=t.getSymbolAtLocation(e.name),r=t.getAliasedSymbol(n);return n.escapedName!==r.escapedName;default:return!0}}function r(t){e.Debug.assert(t.length>0);for(var n=0,r=t;n<r.length;n++){if(!r[n].isCaseSensitive)return!1}return!0}function i(t,n){if(t){var r=e.getNameOfDeclaration(t);if(r){var i=e.getTextOfIdentifierOrLiteral(r);if(void 0===i)return 144===r.kind&&s(r.expression,n,!0);n.unshift(i)}}return!0}function s(t,n,r){var i=e.getTextOfIdentifierOrLiteral(t);if(void 0!==i)return r&&n.unshift(i),!0;if(179===t.kind){var o=t;return r&&n.unshift(o.name.text),s(o.expression,n,!0)}return!1}function o(t){var n=[],r=e.getNameOfDeclaration(t);if(144!==r.kind||s(r.expression,n,!1)){for(t=e.getContainerNode(t);t;){if(!i(t,n))return;t=e.getContainerNode(t)}return n}}function a(t){e.Debug.assert(t.length>0);for(var n=e.PatternMatchKind.camelCase,r=0,i=t;r<i.length;r++){var s=i[r].kind;s<n&&(n=s)}return n}function l(t,n){return t.matchKind-n.matchKind||e.compareStringsCaseInsensitive(t.name,n.name)||e.compareStrings(t.name,n.name)}function c(t){var n=t.declaration,r=e.getContainerNode(n),i=r&&e.getNameOfDeclaration(r);return{name:t.name,kind:e.getNodeKind(n),kindModifiers:e.getNodeModifiers(n),matchKind:e.PatternMatchKind[t.matchKind],isCaseSensitive:t.isCaseSensitive,fileName:t.fileName,textSpan:e.createTextSpanFromNode(n),containerName:i?i.text:"",containerKind:i?e.getNodeKind(r):""}}t.getNavigateToItems=function(t,i,s,u,d,p){for(var h=e.createPatternMatcher(u),f=[],m=function(t){if(s.throwIfCancellationRequested(),p&&e.fileExtensionIs(t.fileName,".d.ts"))return"continue";e.forEachEntry(t.getNamedDeclarations(),(function(e,s){!function(e,t,i,s,l,c){var u=e.getMatchesForLastSegmentOfPattern(t);if(!u)return;for(var d=0,p=i;d<p.length;d++){var h=p[d];if(n(h,s)){var f=u;if(!e.patternContainsDots||(f=e.getMatches(o(h),t))){var m=a(f),_=r(f);c.push({name:t,fileName:l,matchKind:m,isCaseSensitive:_,declaration:h})}}}}(h,s,e,i,t.fileName,f)}))},_=0,g=t;_<g.length;_++){m(g[_])}return f.sort(l),void 0!==d&&(f=f.slice(0,d)),f.map(c)}}(e.NavigateTo||(e.NavigateTo={}))}(ts||(ts={})),function(e){!function(t){var n,r,i,s=/\s+/g,o=[],a=[];function l(){r=void 0,n=void 0,o=[],i=void 0,a=[]}function c(e){return e.getText(r)}function u(e){return e.node.kind}function d(e,t){e.children?e.children.push(t):e.children=[t]}function p(t){e.Debug.assert(!o.length);var n={node:t,additionalNodes:void 0,parent:void 0,children:void 0,indent:0};i=n;for(var r=0,s=t.statements;r<s.length;r++){y(s[r])}return _(),e.Debug.assert(!i&&!o.length),n}function h(e){d(i,f(e))}function f(e){return{node:e,additionalNodes:void 0,parent:i,children:void 0,indent:i.indent+1}}function m(e){var t=f(e);d(i,t),o.push(i),i=t}function _(){i.children&&(b(i.children),v(i.children)),i=o.pop()}function g(e,t){m(e),y(t),_()}function y(t){if(n.throwIfCancellationRequested(),t&&!e.isToken(t))switch(t.kind){case 152:var r=t;g(r,r.body);for(var i=0,s=r.parameters;i<s.length;i++){var o=s[i];e.isParameterPropertyDeclaration(o)&&h(o)}break;case 151:case 153:case 154:case 150:e.hasDynamicName(t)||g(t,t.body);break;case 149:case 148:e.hasDynamicName(t)||h(t);break;case 239:var a=t;a.name&&h(a);var l=a.namedBindings;if(l)if(240===l.kind)h(l);else for(var c=0,u=l.elements;c<u.length;c++){h(u[c])}break;case 176:case 226:var d=t,p=d.name,f=d.initializer;e.isBindingPattern(p)?y(p):f&&function(e){switch(e.kind){case 187:case 186:case 199:return!0;default:return!1}}(f)?f.name?y(f):(m(t),e.forEachChild(f,y),_()):g(t,f);break;case 187:case 228:case 186:g(t,t.body);break;case 232:m(t);for(var b=0,v=t.members;b<v.length;b++){N(E=v[b])||h(E)}_();break;case 229:case 199:case 230:m(t);for(var T=0,k=t.members;T<k.length;T++){var E;y(E=k[T])}_();break;case 233:g(t,w(t).body);break;case 246:case 237:case 157:case 155:case 156:case 231:h(t);break;default:e.hasJSDocNodes(t)&&e.forEach(t.jsDoc,(function(t){e.forEach(t.tags,(function(e){283===e.kind&&h(e)}))})),e.forEachChild(t,y)}}function b(t){var n=e.createMap();e.filterMutate(t,(function(t){var r=e.getNameOfDeclaration(t.node),i=r&&c(r);if(!i)return!0;var s=n.get(i);if(!s)return n.set(i,t),!0;if(s instanceof Array){for(var o=0,a=s;o<a.length;o++){var l;if(u(l=a[o],t))return!1}return s.push(t),!0}return!u(l=s,t)&&(n.set(i,[l,t]),!0);function u(t,n){return!!function(e,t){return e.kind===t.kind&&(233!==e.kind||n(e,t));function n(e,t){return e.body.kind===t.body.kind&&(233!==e.body.kind||n(e.body,t.body))}}(t.node,n.node)&&(function(t,n){t.additionalNodes=t.additionalNodes||[],t.additionalNodes.push(n.node),n.additionalNodes&&(r=t.additionalNodes).push.apply(r,n.additionalNodes);t.children=e.concatenate(t.children,n.children),t.children&&(b(t.children),v(t.children));var r}(t,n),!0)}}))}function v(e){e.sort(T)}function T(t,n){var r=k(t.node),i=k(n.node);if(r&&i){var s=e.compareStringsCaseInsensitive(r,i);return 0!==s?s:u(t)-u(n)}return r?1:i?-1:u(t)-u(n)}function k(t){if(233===t.kind)return A(t);var n=e.getNameOfDeclaration(t);if(n)return e.unescapeLeadingUnderscores(e.getPropertyNameForPropertyNameNode(n));switch(t.kind){case 186:case 187:case 199:return R(t);case 283:return x(t);default:return}}function E(t){if(233===t.kind)return A(t);var n=e.getNameOfDeclaration(t);if(n){var r=c(n);if(r.length>0)return r}switch(t.kind){case 265:var i=t;return e.isExternalModule(i)?'"'+e.escapeString(e.getBaseFileName(e.removeFileExtension(e.normalizePath(i.fileName))))+'"':"<global>";case 187:case 228:case 186:case 229:case 199:return 512&e.getModifierFlags(t)?"default":R(t);case 152:return"constructor";case 156:return"new()";case 155:return"()";case 157:return"[]";case 283:return x(t);default:return"<unknown>"}}function x(e){if(e.name)return e.name.text;var t=e.parent&&e.parent.parent;if(t&&208===t.kind&&t.declarationList.declarations.length>0){var n=t.declarationList.declarations[0].name;if(71===n.kind)return n.text}return"<typedef>"}function S(t){return{text:E(t.node),kind:e.getNodeKind(t.node),kindModifiers:O(t.node),spans:I(t),childItems:e.map(t.children,S)}}function C(t){return{text:E(t.node),kind:e.getNodeKind(t.node),kindModifiers:O(t.node),spans:I(t),childItems:e.map(t.children,(function(t){return{text:E(t.node),kind:e.getNodeKind(t.node),kindModifiers:e.getNodeModifiers(t.node),spans:I(t),childItems:a,indent:0,bolded:!1,grayed:!1}}))||a,indent:t.indent,bolded:!1,grayed:!1}}function I(e){var t=[D(e.node)];if(e.additionalNodes)for(var n=0,r=e.additionalNodes;n<r.length;n++){var i=r[n];t.push(D(i))}return t}function A(t){if(e.isAmbientModule(t))return e.getTextOfNode(t.name);var n=[];for(n.push(e.getTextOfIdentifierOrLiteral(t.name));t.body&&233===t.body.kind;)t=t.body,n.push(e.getTextOfIdentifierOrLiteral(t.name));return n.join(".")}function w(e){return 233===e.body.kind?w(e.body):e}function N(e){return!e.name||144===e.name.kind}function D(t){return 265===t.kind?e.createTextSpanFromBounds(t.getFullStart(),t.getEnd()):e.createTextSpanFromNode(t,r)}function O(t){return t.parent&&226===t.parent.kind&&(t=t.parent),e.getNodeModifiers(t)}function R(t){return t.name&&e.getFullWidth(t.name)>0?e.declarationNameToString(t.name):226===t.parent.kind?e.declarationNameToString(t.parent.name):194===t.parent.kind&&58===t.parent.operatorToken.kind?c(t.parent.left).replace(s,""):261===t.parent.kind&&t.parent.name?c(t.parent.name):512&e.getModifierFlags(t)?"default":e.isClassLike(t)?"<class>":"<function>"}t.getNavigationBarItems=function(t,i){n=i,r=t;try{return e.map(function(t){var n=[];function r(e){if(i(e)&&(n.push(e),e.children))for(var t=0,s=e.children;t<s.length;t++){r(s[t])}}return r(t),n;function i(t){switch(u(t)){case 229:case 199:case 232:case 230:case 233:case 265:case 231:case 283:return!0;case 152:case 151:case 153:case 154:case 226:return r(t);case 187:case 228:case 186:return n(t);default:return!1}function n(e){if(!e.node.body)return!1;switch(u(e.parent)){case 234:case 265:case 151:case 152:return!0;default:return r(e)}}function r(t){return e.forEach(t.children,(function(e){var t=u(e);return 226!==t&&176!==t}))}}}(p(t)),C)}finally{l()}},t.getNavigationTree=function(e,t){n=t,r=e;try{return S(p(e))}finally{l()}}}(e.NavigationBar||(e.NavigationBar={}))}(ts||(ts={})),function(e){!function(t){var n="...",r=new RegExp("^\\s*//\\s*#(end)?region(?:\\s+(.*))?$");t.collectElements=function(t,i){var s=[],o=0,a=[];return function r(a){if(i.throwIfCancellationRequested(),o>40)return;e.isDeclaration(a)&&function(n){var r=e.getLeadingCommentRangesOfNode(n,t);if(r){for(var s=-1,o=-1,a=!0,l=0,d=0,p=r;d<p.length;d++){var h=p[d];i.throwIfCancellationRequested(),2===h.kind?(a&&(s=h.pos),a=!1,o=h.end,l++):3===h.kind&&(u(l,s,o),c(h,!1),l=0,o=-1,a=!0)}u(l,s,o)}}(a);switch(a.kind){case 207:if(!e.isFunctionBlock(a)){var p=a.parent,h=e.findChildOfKind(a,17,t),f=e.findChildOfKind(a,18,t);if(212===p.kind||215===p.kind||216===p.kind||214===p.kind||211===p.kind||213===p.kind||220===p.kind||260===p.kind){l(p,h,f,d(a),!0);break}if(224===p.kind){var m=p;if(m.tryBlock===a){l(p,h,f,d(a),!0);break}if(m.finallyBlock===a){var _=e.findChildOfKind(m,87,t);if(_){l(_,h,f,d(a),!0);break}}}var g=e.createTextSpanFromNode(a);s.push({textSpan:g,hintSpan:g,bannerText:n,autoCollapse:d(a)});break}case 234:var y=e.findChildOfKind(a,17,t),b=e.findChildOfKind(a,18,t);l(a.parent,y,b,d(a),!0);break;case 229:case 230:case 232:case 235:var v=e.findChildOfKind(a,17,t),T=e.findChildOfKind(a,18,t);l(a,v,T,d(a),!0);break;case 178:var k=e.findChildOfKind(a,17,t),E=e.findChildOfKind(a,18,t);l(a,k,E,d(a),!e.isArrayLiteralExpression(a.parent));break;case 177:var x=e.findChildOfKind(a,21,t),S=e.findChildOfKind(a,22,t);l(a,x,S,d(a),!e.isArrayLiteralExpression(a.parent))}o++,e.forEachChild(a,r),o--}(t),function(){for(var n=t.getLineStarts(),i=0;i<n.length;i++){var o=n[i],l=n[i+1]-1||t.getEnd(),c=t.text.substring(o,l).match(r);if(c&&!e.isInComment(t,o))if(c[1]){(p=a.pop())&&(p.textSpan.length=l-p.textSpan.start,p.hintSpan.length=l-p.textSpan.start,s.push(p))}else{var u=t.getFullText().indexOf("//",o),d=e.createTextSpanFromBounds(u,l),p={textSpan:d,hintSpan:d,bannerText:c[2]||"#region",autoCollapse:!1};a.push(p)}}}(),s.sort((function(e,t){return e.textSpan.start-t.textSpan.start}));function l(r,i,o,a,l){if(r&&i&&o){var c={textSpan:e.createTextSpanFromBounds(l?i.getFullStart():i.getStart(),o.getEnd()),hintSpan:e.createTextSpanFromNode(r,t),bannerText:n,autoCollapse:a};s.push(c)}}function c(t,r){if(t){var i={textSpan:e.createTextSpanFromBounds(t.pos,t.end),hintSpan:e.createTextSpanFromBounds(t.pos,t.end),bannerText:n,autoCollapse:r};s.push(i)}}function u(e,t,n){e>1&&c({kind:2,pos:t,end:n},!1)}function d(t){return e.isFunctionBlock(t)&&187!==t.parent.kind}}}(e.OutliningElementsCollector||(e.OutliningElementsCollector={}))}(ts||(ts={})),function(e){var t;function n(e,t,n,r){return{kind:e,punctuationStripped:t,isCaseSensitive:n,camelCaseWeight:r}}function r(e){return 0===e.subWordTextChunks.length}function i(t){if(t>=65&&t<=90)return!0;if(t<127||!e.isUnicodeIdentifierStart(t,5))return!1;var n=String.fromCharCode(t);return n===n.toUpperCase()}function s(t){if(t>=97&&t<=122)return!0;if(t<127||!e.isUnicodeIdentifierStart(t,5))return!1;var n=String.fromCharCode(t);return n===n.toLowerCase()}function o(e,t,n){for(var r=0;r<t.length;r++){if(a(e.charCodeAt(r+n))!==t.charCodeAt(r))return!1}return!0}function a(e){return e>=65&&e<=90?e-65+97:e<127?e:String.fromCharCode(e).toLowerCase().charCodeAt(0)}function l(e){return e>=48&&e<=57}function c(e){return i(e)||s(e)||l(e)||95===e||36===e}function u(e){for(var t=[],n=0,r=0,i=0;i<e.length;i++){c(e.charCodeAt(i))?(0===r&&(n=i),r++):r>0&&(t.push(d(e.substr(n,r))),r=0)}return r>0&&t.push(d(e.substr(n,r))),t}function d(e){var t=e.toLowerCase();return{text:e,textLowerCase:t,isLowerCase:e===t,characterSpans:p(e)}}function p(e){return f(e,!1)}function h(e){return f(e,!0)}function f(t,n){for(var r=[],i=0,s=1;s<t.length;s++){var o=l(t.charCodeAt(s-1)),a=l(t.charCodeAt(s)),c=y(t,n,s),u=g(t,n,s,i);(m(t.charCodeAt(s-1))||m(t.charCodeAt(s))||o!==a||c||u)&&(_(t,i,s)||r.push(e.createTextSpan(i,s-i)),i=s)}return _(t,i,t.length)||r.push(e.createTextSpan(i,t.length-i)),r}function m(e){switch(e){case 33:case 34:case 35:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 45:case 46:case 47:case 58:case 59:case 63:case 64:case 91:case 92:case 93:case 95:case 123:case 125:return!0}return!1}function _(e,t,n){for(var r=t;r<n;r++){var i=e.charCodeAt(r);if(!m(i)||95===i||36===i)return!1}return!0}function g(e,t,n,r){if(t&&n!==r&&n+1<e.length){var o=i(e.charCodeAt(n)),a=s(e.charCodeAt(n+1));if(o&&a){for(var l=r;l<n;l++)if(!i(e.charCodeAt(l)))return!1;return!0}}return!1}function y(e,t,n){var r=i(e.charCodeAt(n-1)),s=i(e.charCodeAt(n));return t?s&&!r:s}!function(e){e[e.exact=0]="exact",e[e.prefix=1]="prefix",e[e.substring=2]="substring",e[e.camelCase=3]="camelCase"}(t=e.PatternMatchKind||(e.PatternMatchKind={})),e.createPatternMatcher=function(s){var l=e.createMap(),c=(s=s.trim()).split(".").map((function(e){return{totalTextChunk:d(t=e.trim()),subWordTextChunks:u(t)};var t})),p=0===c.length||e.forEach(c,r);return{getMatches:function(t,n){if(f(n))return;var r=g(n,e.lastOrUndefined(c));if(!r)return;if(t=t||[],c.length-1>t.length)return;for(var i=r,s=c.length-2,o=t.length-1;s>=0;s-=1,o-=1){var a=c[s],l=g(t[o],a);if(!l)return;e.addRange(i,l)}return i},getMatchesForLastSegmentOfPattern:function(t){if(f(t))return;return g(t,e.lastOrUndefined(c))},patternContainsDots:c.length>1};function f(e){return p||!e}function m(e){var t=l.get(e);return t||l.set(e,t=h(e)),t}function _(r,s,a){var l=function(e,t){for(var n=e.length-t.length,r=0;r<=n;r++)if(o(e,t,r))return r;return-1}(r,s.textLowerCase);if(0===l)return s.text.length===r.length?n(t.exact,a,r===s.text):n(t.prefix,a,e.startsWith(r,s.text));var c=s.isLowerCase;if(c){if(l>0)for(var u=0,d=m(r);u<d.length;u++){var p=d[u];if(y(r,p,s.text,!0))return n(t.substring,a,y(r,p,s.text,!1))}}else if(r.indexOf(s.text)>0)return n(t.substring,a,!0);if(!c&&s.characterSpans.length>0){var h=m(r),f=b(r,h,s,!1);if(void 0!==f)return n(t.camelCase,a,!0,f);if(void 0!==(f=b(r,h,s,!0)))return n(t.camelCase,a,!1,f)}return c&&s.text.length<r.length&&l>0&&i(r.charCodeAt(l))?n(t.substring,a,!1):void 0}function g(e,t){if(!function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(32===n||42===n)return!0}return!1}(t.totalTextChunk.text)){var n=_(e,t.totalTextChunk,!1);if(n)return[n]}for(var r=void 0,i=0,s=t.subWordTextChunks;i<s.length;i++){var o=_(e,s[i],!0);if(!o)return;(r=r||[]).push(o)}return r}function y(e,t,n,r,i){var s=i?i.start:0,o=i?i.length:n.length;if(o>t.length)return!1;if(r)for(var l=0;l<o;l++){var c=n.charCodeAt(s+l),u=e.charCodeAt(t.start+l);if(a(c)!==a(u))return!1}else for(l=0;l<o;l++){if((c=n.charCodeAt(s+l))!==(u=e.charCodeAt(t.start+l)))return!1}return!0}function b(t,n,r,s){for(var o=r.characterSpans,a=0,l=0,c=void 0,u=void 0;;){if(l===o.length){var d=0;return u&&(d+=1),0===c&&(d+=2),d}if(a===n.length)return;for(var p=n[a],h=!1;l<o.length;l++){var f=o[l];if(h&&(!i(r.text.charCodeAt(o[l-1].start))||!i(r.text.charCodeAt(o[l].start))))break;if(!y(t,p,r.text,s,f))break;h=!0,c=void 0===c?a:c,u=void 0===u||u,p=e.createTextSpan(p.start+f.length,p.length-f.length)}h||void 0===u||(u=!1),a++}}},e.breakIntoCharacterSpans=p,e.breakIntoWordSpans=h}(ts||(ts={})),function(e){e.preProcessFile=function(t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!1);var i,s,o=[],a=[],l=[],c=!1,u=0,d=!1;function p(){var t=e.scanner.scan();return 17===t?u++:18===t&&u--,t}function h(){var t=e.scanner.getTokenValue(),n=e.scanner.getTokenPos();return{fileName:t,pos:n,end:n+t.length}}function f(){l.push(h()),m()}function m(){0===u&&(d=!0)}function _(){var t=e.scanner.getToken();return 124===t&&(128===(t=p())&&9===(t=p())&&(i||(i=[]),i.push({ref:h(),depth:u})),!0)}function g(){var t=e.scanner.getToken();if(91===t){if(19===(t=p())){if(9===(t=p()))return f(),!0}else{if(9===t)return f(),!0;if(71===t||e.isKeyword(t))if(140===(t=p())){if(9===(t=p()))return f(),!0}else if(58===t){if(b(!0))return!0}else{if(26!==t)return!0;t=p()}if(17===t){for(t=p();18!==t&&1!==t;)t=p();18===t&&140===(t=p())&&9===(t=p())&&f()}else 39===t&&118===(t=p())&&(71===(t=p())||e.isKeyword(t))&&140===(t=p())&&9===(t=p())&&f()}return!0}return!1}function y(){var t=e.scanner.getToken();if(84===t){if(m(),17===(t=p())){for(t=p();18!==t&&1!==t;)t=p();18===t&&140===(t=p())&&9===(t=p())&&f()}else if(39===t)140===(t=p())&&9===(t=p())&&f();else if(91===t&&(71===(t=p())||e.isKeyword(t))&&58===(t=p())&&b(!0))return!0;return!0}return!1}function b(t){var n=t?p():e.scanner.getToken();return 132===n&&(19===(n=p())&&9===(n=p())&&f(),!0)}function v(){var t=e.scanner.getToken();if(71===t&&"define"===e.scanner.getTokenValue()){if(19!==(t=p()))return!0;if(9===(t=p())){if(26!==(t=p()))return!0;t=p()}if(21!==t)return!0;for(t=p();22!==t&&1!==t;)9===t&&f(),t=p();return!0}return!1}if(n&&function(){for(e.scanner.setText(t),p();1!==e.scanner.getToken();)_()||g()||y()||r&&(b(!1)||v())||p();e.scanner.setText(void 0)}(),s=e.getLeadingCommentRanges(t,0),e.forEach(s,(function(n){var r=t.substring(n.pos,n.end),i=e.getFileReferenceFromReferencePath(r,n);if(i){c=i.isNoDefaultLib;var s=i.fileReference;s&&(i.isTypeReferenceDirective?a:o).push(s)}})),d){if(i)for(var T=0,k=i;T<k.length;T++){var E=k[T];l.push(E.ref)}return{referencedFiles:o,typeReferenceDirectives:a,importedFiles:l,isLibFile:c,ambientExternalModules:void 0}}var x=void 0;if(i)for(var S=0,C=i;S<C.length;S++){0===(E=C[S]).depth?(x||(x=[]),x.push(E.ref.fileName)):l.push(E.ref)}return{referencedFiles:o,typeReferenceDirectives:a,importedFiles:l,isLibFile:c,ambientExternalModules:x}}}(ts||(ts={})),function(e){!function(t){function n(e,t,n,r,s,o){return{canRename:!0,kind:n,displayName:e,localizedErrorMessage:void 0,fullDisplayName:t,kindModifiers:r,triggerSpan:i(s,o)}}function r(t){return{canRename:!1,localizedErrorMessage:e.getLocaleSpecificMessage(t),displayName:void 0,fullDisplayName:void 0,kind:void 0,kindModifiers:void 0,triggerSpan:void 0}}function i(t,n){var r=t.getStart(n),i=t.getWidth(n);return 9===t.kind&&(r+=1,i-=2),e.createTextSpan(r,i)}t.getRenameInfo=function(t,i,s,o,a){var l=e.memoize((function(){return s(e.normalizePath(i))})),c=e.getTouchingWord(o,a,!0);return(c&&function(t){switch(t.kind){case 71:case 9:case 99:return!0;case 8:return e.isLiteralNameOfPropertyDeclarationOrIndexAccess(t);default:return!1}}(c)?function(t,i,s,o){var a=i.getSymbolAtLocation(t);if(a){var l=a.getDeclarations();if(l&&l.length>0){if(e.some(l,o))return r(e.Diagnostics.You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library);if(71===t.kind&&79===t.originalKeywordKind&&1536&a.parent.flags)return;var c=e.stripQuotes(e.getDeclaredName(i,a,t)),u=e.SymbolDisplay.getSymbolKind(i,a,t);return u?n(c,i.getFullyQualifiedName(a),u,e.SymbolDisplay.getSymbolModifiers(a),t,s):void 0}}else if(9===t.kind){return o(t)?r(e.Diagnostics.You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library):n(c=e.stripQuotes(t.text),c,"var","",t,s)}}(c,t,o,(function(t){if(!i)return!1;var n=t.getSourceFile();return s(e.normalizePath(n.fileName))===l()})):void 0)||r(e.Diagnostics.You_cannot_rename_this_element)}}(e.Rename||(e.Rename={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,i){if(e.isCallOrNewExpression(t.parent)){var s=t.parent,o=void 0,a=void 0;if(27===t.kind||19===t.kind)o=function(t,n,r){var i=t.getChildren(r),s=i.indexOf(n);return e.Debug.assert(s>=0&&i.length>s+1),i[s+1]}(s,t,i),e.Debug.assert(void 0!==o),a=0;else{if(!(o=e.findContainingList(t)))return;a=function(e,t){for(var n=0,r=e.getChildren(),i=0,s=r;i<s.length;i++){var o=s[i];if(o===t)break;26!==o.kind&&n++}return n}(o,t)}var l=s.typeArguments&&s.typeArguments.pos===o.pos?0:1,c=function(t){var n=t.getChildren(),r=e.countWhere(n,(function(e){return 26!==e.kind}));n.length>0&&26===e.lastOrUndefined(n).kind&&r++;return r}(o);return 0!==a&&e.Debug.assertLessThan(a,c),{kind:l,invocation:s,argumentsSpan:function(t,n){var r=t.getFullStart(),i=e.skipTrivia(n.text,t.getEnd(),!1);return e.createTextSpan(r,i-r)}(o,i),argumentIndex:a,argumentCount:c}}if(13===t.kind&&183===t.parent.kind){if(e.isInsideTemplateLiteral(t,n))return r(t.parent,0,i)}else{if(14===t.kind&&183===t.parent.parent.kind){var u=(d=t.parent).parent;return e.Debug.assert(196===d.kind),r(u,a=e.isInsideTemplateLiteral(t,n)?0:1,i)}if(205===t.parent.kind&&183===t.parent.parent.parent.kind){var d,p=t.parent;u=(d=p.parent).parent;if(e.Debug.assert(196===d.kind),16===t.kind&&!e.isInsideTemplateLiteral(t,n))return;return r(u,a=function(t,n,r){if(e.Debug.assert(r>=n.getStart(),"Assumed 'position' could not occur before node."),e.isTemplateLiteralKind(n.kind))return e.isInsideTemplateLiteral(n,r)?0:t+2;return t+1}(d.templateSpans.indexOf(p),t,n),i)}if(t.parent&&e.isJsxOpeningLikeElement(t.parent)){var h=t.parent.attributes.getFullStart(),f=e.skipTrivia(i.text,t.parent.attributes.getEnd(),!1);return{kind:3,invocation:t.parent,argumentsSpan:e.createTextSpan(h,f-h),argumentIndex:0,argumentCount:1}}}}function r(t,n,r){var s=13===t.template.kind?1:t.template.templateSpans.length+1;return 0!==n&&e.Debug.assertLessThan(n,s),{kind:2,invocation:t,argumentsSpan:i(t,r),argumentIndex:n,argumentCount:s}}function i(t,n){var r=t.template,i=r.getStart(),s=r.getEnd();196===r.kind&&(0===e.lastOrUndefined(r.templateSpans).literal.getFullWidth()&&(s=e.skipTrivia(n.text,s,!1)));return e.createTextSpan(i,s-i)}function s(t,r,i){for(var s=t;265!==s.kind;s=s.parent){if(e.isFunctionBlock(s))return;(s.pos<s.parent.pos||s.end>s.parent.end)&&e.Debug.fail("Node of kind "+s.kind+" is not a subspan of its parent of kind "+s.parent.kind);var o=n(s,r,i);if(o)return o}}function o(t,n,r,i){var s=r.argumentCount,o=r.argumentsSpan,a=r.invocation,l=r.argumentIndex,c=0===r.kind,u=e.getInvokedExpression(a),d=i.getSymbolAtLocation(u),p=d&&e.symbolToDisplayParts(i,d,void 0,void 0),h=e.map(t,(function(t){var n,r,s=[],o=[];if(p&&e.addRange(s,p),c){r=!1,s.push(e.punctuationPart(27));var l=(t.target||t).typeParameters;n=l&&l.length>0?e.map(l,_):e.emptyArray,o.push(e.punctuationPart(29));var u=e.mapToDisplayParts((function(e){return i.getSymbolDisplayBuilder().buildDisplayForParametersAndDelimiters(t.thisParameter,t.parameters,e,a)}));e.addRange(o,u)}else{r=t.hasRestParameter;var d=e.mapToDisplayParts((function(e){return i.getSymbolDisplayBuilder().buildDisplayForTypeParametersAndDelimiters(t.typeParameters,e,a)}));e.addRange(s,d),s.push(e.punctuationPart(19)),n=e.map(t.parameters,m),o.push(e.punctuationPart(20))}var h=e.mapToDisplayParts((function(e){return i.getSymbolDisplayBuilder().buildReturnTypeDisplay(t,e,a)}));return e.addRange(o,h),{isVariadic:r,prefixDisplayParts:s,suffixDisplayParts:o,separatorDisplayParts:[e.punctuationPart(26),e.spacePart()],parameters:n,documentation:t.getDocumentationComment(),tags:t.getJsDocTags()}}));0!==l&&e.Debug.assertLessThan(l,s);var f=t.indexOf(n);return e.Debug.assert(-1!==f),{items:h,applicableSpan:o,selectedItemIndex:f,argumentIndex:l,argumentCount:s};function m(t){var n=e.mapToDisplayParts((function(e){return i.getSymbolDisplayBuilder().buildParameterDisplay(t,e,a)}));return{name:t.name,documentation:t.getDocumentationComment(),displayParts:n,isOptional:i.isOptionalParameter(t.valueDeclaration)}}function _(t){var n=e.mapToDisplayParts((function(e){return i.getSymbolDisplayBuilder().buildTypeParameterDisplay(t,e,a)}));return{name:t.symbol.name,documentation:e.emptyArray,displayParts:n,isOptional:!1}}}!function(e){e[e.TypeArguments=0]="TypeArguments",e[e.CallArguments=1]="CallArguments",e[e.TaggedTemplateArguments=2]="TaggedTemplateArguments",e[e.JSXAttributesArguments=3]="JSXAttributesArguments"}(t.ArgumentListKind||(t.ArgumentListKind={})),t.getSignatureHelpItems=function(t,n,r,i){var a=t.getTypeChecker(),l=e.findTokenOnLeftOfPosition(n,r);if(l){var c=s(l,r,n);if(c){i.throwIfCancellationRequested();var u=c.invocation,d=[],p=a.getResolvedSignature(u,d,c.argumentCount);return i.throwIfCancellationRequested(),d.length?o(d,p,c,a):e.isSourceFileJavaScript(n)?function(e,t){if(181!==e.invocation.kind)return;var n=e.invocation.expression,r=71===n.kind?n:179===n.kind?n.name:void 0;if(!r||!r.escapedText)return;for(var i=t.getTypeChecker(),s=0,a=t.getSourceFiles();s<a.length;s++){var l=a[s].getNamedDeclarations().get(r.text);if(l)for(var c=0,u=l;c<u.length;c++){var d=u[c],p=d.symbol;if(p){var h=i.getTypeOfSymbolAtLocation(p,d);if(h){var f=h.getCallSignatures();if(f&&f.length)return o(f,f[0],e,i)}}}}}(c,t):void 0}}},t.getImmediatelyContainingArgumentInfo=n,t.getContainingArgumentInfo=s}(e.SignatureHelp||(e.SignatureHelp={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,i){var s=e.getCombinedLocalAndExportSymbolFlags(n);if(32&s)return e.getDeclarationOfKind(n,199)?"local class":"class";if(384&s)return"enum";if(524288&s)return"type";if(64&s)return"interface";if(262144&s)return"type parameter";var o=r(t,n,i);if(""===o){if(262144&s)return"type parameter";if(8&s)return"enum member";if(2097152&s)return"alias";if(1536&s)return"module"}return o}function r(t,n,r){if(t.isUndefinedSymbol(n))return"var";if(t.isArgumentsSymbol(n))return"local var";if(99===r.kind&&e.isExpression(r))return"parameter";var s=e.getCombinedLocalAndExportSymbolFlags(n);if(3&s)return e.isFirstDeclarationOfSymbolParameter(n)?"parameter":n.valueDeclaration&&e.isConst(n.valueDeclaration)?"const":e.forEach(n.declarations,e.isLet)?"let":i(n)?"local var":"var";if(16&s)return i(n)?"local function":"function";if(32768&s)return"getter";if(65536&s)return"setter";if(8192&s)return"method";if(16384&s)return"constructor";if(4&s){if(33554432&s&&6&n.checkFlags){var o=e.forEach(t.getRootSymbols(n),(function(t){var n=t.getFlags();if(98311&n)return"property";e.Debug.assert(!!(8208&n))}));return o||(t.getTypeOfSymbolAtLocation(n,r).getCallSignatures().length?"method":"property")}return r.parent&&e.isJsxAttribute(r.parent)?"JSX attribute":"property"}return""}function i(t){return!t.parent&&e.forEach(t.declarations,(function(t){if(186===t.kind)return!0;if(226!==t.kind&&228!==t.kind)return!1;for(var n=t.parent;!e.isFunctionBlock(n);n=n.parent)if(265===n.kind||234===n.kind)return!1;return!0}))}t.getSymbolKind=n,t.getSymbolModifiers=function(t){return t&&t.declarations&&t.declarations.length>0?e.getNodeModifiers(t.declarations[0]):""},t.getSymbolDisplayPartsDocumentationAndSymbolKind=function(t,i,s,o,a,l){void 0===l&&(l=e.getMeaningFromLocation(a));var c,u,d,p,h=[],f=e.getCombinedLocalAndExportSymbolFlags(i),m=r(t,i,a),_=99===a.kind&&e.isExpression(a);if(""!==m||32&f||2097152&f){"getter"!==m&&"setter"!==m||(m="property");var g=void 0;if(p=_?t.getTypeAtLocation(a):t.getTypeOfSymbolAtLocation(i.exportSymbol||i,a),a.parent&&179===a.parent.kind){var y=a.parent.name;(y===a||y&&0===y.getFullWidth())&&(a=a.parent)}var b=void 0;if(e.isCallOrNewExpression(a)?b=a:(e.isCallExpressionTarget(a)||e.isNewExpressionTarget(a)||a.parent&&e.isJsxOpeningLikeElement(a.parent)&&e.isFunctionLike(i.valueDeclaration))&&(b=a.parent),b){g=t.getResolvedSignature(b,[]);var v=182===b.kind||e.isCallExpression(b)&&97===b.expression.kind,T=v?p.getConstructSignatures():p.getCallSignatures();if(e.contains(T,g.target)||e.contains(T,g)||(g=T.length?T[0]:void 0),g){switch(v&&32&f?(m="constructor",L(p.symbol,m)):2097152&f?(P(m="alias"),h.push(e.spacePart()),v&&(h.push(e.keywordPart(94)),h.push(e.spacePart())),R(i)):L(i,m),m){case"JSX attribute":case"property":case"var":case"const":case"let":case"parameter":case"local var":h.push(e.punctuationPart(56)),h.push(e.spacePart()),v&&(h.push(e.keywordPart(94)),h.push(e.spacePart())),32768&p.flags&&16&p.objectFlags||!p.symbol||e.addRange(h,e.symbolToDisplayParts(t,p.symbol,o,void 0,1)),M(g,T,16);break;default:M(g,T)}d=!0}}else if(e.isNameOfFunctionDeclaration(a)&&!(98304&f)||123===a.kind&&152===a.parent.kind){var k=a.parent;if(e.find(i.declarations,(function(e){return e===(123===a.kind?k.parent:k)}))){T=152===k.kind?p.getNonNullableType().getConstructSignatures():p.getNonNullableType().getCallSignatures();g=t.isImplementationOfOverload(k)?T[0]:t.getSignatureFromDeclaration(k),152===k.kind?(m="constructor",L(p.symbol,m)):L(155!==k.kind||2048&p.symbol.flags||4096&p.symbol.flags?i:p.symbol,m),M(g,T),d=!0}}}if(32&f&&!d&&!_&&(e.getDeclarationOfKind(i,199)?P("local class"):h.push(e.keywordPart(75)),h.push(e.spacePart()),R(i),F(i,s)),64&f&&2&l&&(D(),h.push(e.keywordPart(109)),h.push(e.spacePart()),R(i),F(i,s)),524288&f&&(D(),h.push(e.keywordPart(138)),h.push(e.spacePart()),R(i),F(i,s),h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),e.addRange(h,e.typeToDisplayParts(t,t.getDeclaredTypeOfSymbol(i),o,1024))),384&f&&(D(),e.forEach(i.declarations,e.isConstEnumDeclaration)&&(h.push(e.keywordPart(76)),h.push(e.spacePart())),h.push(e.keywordPart(83)),h.push(e.spacePart()),R(i)),1536&f){D();var E=(w=e.getDeclarationOfKind(i,233))&&w.name&&71===w.name.kind;h.push(e.keywordPart(E?129:128)),h.push(e.spacePart()),R(i)}if(262144&f&&2&l)if(D(),h.push(e.punctuationPart(19)),h.push(e.textPart("type parameter")),h.push(e.punctuationPart(20)),h.push(e.spacePart()),R(i),i.parent)O(),R(i.parent,o),F(i.parent,o);else{var x=e.getDeclarationOfKind(i,145);if(e.Debug.assert(void 0!==x),w=x.parent)if(e.isFunctionLikeKind(w.kind)){O();g=t.getSignatureFromDeclaration(w);156===w.kind?(h.push(e.keywordPart(94)),h.push(e.spacePart())):155!==w.kind&&w.name&&R(w.symbol),e.addRange(h,e.signatureToDisplayParts(t,g,s,64))}else 231===w.kind&&(O(),h.push(e.keywordPart(138)),h.push(e.spacePart()),R(w.symbol),F(w.symbol,s))}if(8&f&&(m="enum member",L(i,"enum member"),264===(w=i.declarations[0]).kind)){var S=t.getConstantValue(w);void 0!==S&&(h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),h.push(e.displayPart(e.getTextOfConstantValue(S),"number"==typeof S?e.SymbolDisplayPartKind.numericLiteral:e.SymbolDisplayPartKind.stringLiteral)))}if(2097152&f){switch(D(),i.declarations[0].kind){case 236:h.push(e.keywordPart(84)),h.push(e.spacePart()),h.push(e.keywordPart(129));break;case 243:h.push(e.keywordPart(84)),h.push(e.spacePart()),h.push(e.keywordPart(i.declarations[0].isExportEquals?58:79));break;default:h.push(e.keywordPart(91))}h.push(e.spacePart()),R(i),e.forEach(i.declarations,(function(n){if(237===n.kind){var r=n;if(e.isExternalModuleImportEqualsDeclaration(r))h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),h.push(e.keywordPart(132)),h.push(e.punctuationPart(19)),h.push(e.displayPart(e.getTextOfNode(e.getExternalModuleImportEqualsDeclarationExpression(r)),e.SymbolDisplayPartKind.stringLiteral)),h.push(e.punctuationPart(20));else{var i=t.getSymbolAtLocation(r.moduleReference);i&&(h.push(e.spacePart()),h.push(e.operatorPart(58)),h.push(e.spacePart()),R(i,o))}return!0}}))}if(!d)if(""!==m){if(p)if(_?(D(),h.push(e.keywordPart(99))):L(i,m),"property"===m||"JSX attribute"===m||3&f||"local var"===m||_)if(h.push(e.punctuationPart(56)),h.push(e.spacePart()),p.symbol&&262144&p.symbol.flags){var C=e.mapToDisplayParts((function(e){t.getSymbolDisplayBuilder().buildTypeParameterDisplay(p,e,o)}));e.addRange(h,C)}else e.addRange(h,e.typeToDisplayParts(t,p,o));else if(16&f||8192&f||16384&f||131072&f||98304&f||"method"===m){(T=p.getNonNullableType().getCallSignatures()).length&&M(T[0],T)}}else m=n(t,i,a);if(!c&&(c=i.getDocumentationComment(),u=i.getJsDocTags(),0===c.length&&4&f&&i.parent&&e.forEach(i.parent.declarations,(function(e){return 265===e.kind}))))for(var I=0,A=i.declarations;I<A.length;I++){var w;if((w=A[I]).parent&&194===w.parent.kind){var N=t.getSymbolAtLocation(w.parent.right);if(N&&(c=N.getDocumentationComment(),u=N.getJsDocTags(),c.length>0))break}}return{displayParts:h,documentation:c,symbolKind:m,tags:u};function D(){h.length&&h.push(e.lineBreakPart())}function O(){h.push(e.spacePart()),h.push(e.keywordPart(92)),h.push(e.spacePart())}function R(n,r){var i=e.symbolToDisplayParts(t,n,r||s,void 0,3);e.addRange(h,i)}function L(t,n){D(),n&&(P(n),h.push(e.spacePart()),R(t))}function P(t){switch(t){case"var":case"function":case"let":case"const":case"constructor":return void h.push(e.textOrKeywordPart(t));default:return h.push(e.punctuationPart(19)),h.push(e.textOrKeywordPart(t)),void h.push(e.punctuationPart(20))}}function M(n,r,i){e.addRange(h,e.signatureToDisplayParts(t,n,o,64|i)),r.length>1&&(h.push(e.spacePart()),h.push(e.punctuationPart(19)),h.push(e.operatorPart(37)),h.push(e.displayPart((r.length-1).toString(),e.SymbolDisplayPartKind.numericLiteral)),h.push(e.spacePart()),h.push(e.textPart(2===r.length?"overload":"overloads")),h.push(e.punctuationPart(20))),c=n.getDocumentationComment(),u=n.getJsDocTags()}function F(n,r){var i=e.mapToDisplayParts((function(e){t.getSymbolDisplayBuilder().buildTypeParameterDisplayFromSymbol(n,e,r)}));e.addRange(h,i)}}}(e.SymbolDisplay||(e.SymbolDisplay={}))}(ts||(ts={})),function(e){function t(t,n){var i=[],s=n.compilerOptions?r(n.compilerOptions,i):e.getDefaultCompilerOptions();s.isolatedModules=!0,s.suppressOutputPathCheck=!0,s.allowNonTsExtensions=!0,s.noLib=!0,s.lib=void 0,s.types=void 0,s.noEmit=void 0,s.noEmitOnError=void 0,s.paths=void 0,s.rootDirs=void 0,s.declaration=void 0,s.declarationDir=void 0,s.out=void 0,s.outFile=void 0,s.noResolve=!0;var o=n.fileName||(s.jsx?"module.tsx":"module.ts"),a=e.createSourceFile(o,t,s.target);n.moduleName&&(a.moduleName=n.moduleName),n.renamedDependencies&&(a.renamedDependencies=e.createMapFromTemplate(n.renamedDependencies));var l,c,u=e.getNewLineCharacter(s),d={getSourceFile:function(t){return t===e.normalizePath(o)?a:void 0},writeFile:function(t,n){e.fileExtensionIs(t,".map")?(e.Debug.assertEqual(c,void 0,"Unexpected multiple source map outputs, file:",t),c=n):(e.Debug.assertEqual(l,void 0,"Unexpected multiple outputs, file:",t),l=n)},getDefaultLibFileName:function(){return"lib.d.ts"},useCaseSensitiveFileNames:function(){return!1},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return""},getNewLine:function(){return u},fileExists:function(e){return e===o},readFile:function(){return""},directoryExists:function(){return!0},getDirectories:function(){return[]}},p=e.createProgram([o],s,d);return n.reportDiagnostics&&(e.addRange(i,p.getSyntacticDiagnostics(a)),e.addRange(i,p.getOptionsDiagnostics())),p.emit(void 0,void 0,void 0,void 0,n.transformers),e.Debug.assert(void 0!==l,"Output generation failed"),{outputText:l,diagnostics:i,sourceMapText:c}}var n;function r(t,r){n=n||e.filter(e.optionDeclarations,(function(t){return"object"==typeof t.type&&!e.forEachEntry(t.type,(function(e){return"number"!=typeof e}))})),t=e.cloneCompilerOptions(t);for(var i=function(n){if(!e.hasProperty(t,n.name))return"continue";var i=t[n.name];e.isString(i)?t[n.name]=e.parseCustomTypeOption(n,i,r):e.forEachEntry(n.type,(function(e){return e===i}))||r.push(e.createCompilerDiagnosticForInvalidCustomType(n))},s=0,o=n;s<o.length;s++){i(o[s])}return t}e.transpileModule=t,e.transpile=function(n,r,i,s,o){var a=t(n,{compilerOptions:r,fileName:i,reportDiagnostics:!!s,moduleName:o});return e.addRange(s,a.diagnostics),a.outputText},e.fixupCompilerOptions=r}(ts||(ts={})),function(e){!function(t){var n,r=e.createScanner(5,!1,0),i=e.createScanner(5,!1,1);!function(e){e[e.Scan=0]="Scan",e[e.RescanGreaterThanToken=1]="RescanGreaterThanToken",e[e.RescanSlashToken=2]="RescanSlashToken",e[e.RescanTemplateToken=3]="RescanTemplateToken",e[e.RescanJsxIdentifier=4]="RescanJsxIdentifier",e[e.RescanJsxText=5]="RescanJsxText"}(n||(n={})),t.getFormattingScanner=function(t,n,s,o,a){var l=1===n?i:r;l.setText(t),l.setTextPos(s);var c,u,d,p,h,f=!0,m=a({advance:function(){h=void 0,l.getStartPos()!==s?f=u&&4===e.lastOrUndefined(u).kind:l.scan();c=void 0,u=void 0;var t=l.getStartPos();for(;t<o;){var n=l.getToken();if(!e.isTrivia(n))break;l.scan();var r={pos:t,end:l.getStartPos(),kind:n};t=l.getStartPos(),c=e.append(c,r)}d=l.getStartPos()},readTokenInfo:function(t){e.Debug.assert(_());var n=function(e){switch(e.kind){case 31:case 66:case 67:case 47:case 46:return!0}return!1}(t)?1:(i=t,12===i.kind?2:function(e){return 15===e.kind||16===e.kind}(t)?3:function(t){if(t.parent)switch(t.parent.kind){case 253:case 251:case 252:case 250:return e.isKeyword(t.kind)||71===t.kind}return!1}(t)?4:(r=t,10===r.kind?5:0));var r;var i;if(h&&n===p)return g(h,t);l.getStartPos()!==d&&(e.Debug.assert(void 0!==h),l.setTextPos(d),l.scan());var s=function(t,n){var r=l.getToken();switch(p=0,n){case 1:if(29===r){p=1;var i=l.reScanGreaterToken();return e.Debug.assert(t.kind===i),i}break;case 2:if(41===(s=r)||63===s){p=2;i=l.reScanSlashToken();return e.Debug.assert(t.kind===i),i}break;case 3:if(18===r)return p=3,l.reScanTemplateToken();break;case 4:return p=4,l.scanJsxIdentifier();case 5:return p=5,l.reScanJsxToken();case 0:break;default:e.Debug.assertNever(n)}var s;return r}(t,n),a={pos:l.getStartPos(),end:l.getTextPos(),kind:s};u&&(u=void 0);for(;l.getStartPos()<o&&(s=l.scan(),e.isTrivia(s));){var f={pos:l.getStartPos(),end:l.getTextPos(),kind:s};if(u||(u=[]),u.push(f),4===s){l.scan();break}}return g(h={leadingTrivia:c,trailingTrivia:u,token:a},t)},isOnToken:_,getCurrentLeadingTrivia:function(){return c},lastTrailingTriviaWasNewLine:function(){return f},skipToEndOf:function(e){l.setTextPos(e.end),d=l.getStartPos(),p=void 0,h=void 0,f=!1,c=void 0,u=void 0}});return h=void 0,l.setText(void 0),m;function _(){var t=h?h.token.kind:l.getToken();return(h?h.token.pos:l.getStartPos())<o&&1!==t&&!e.isTrivia(t)}function g(t,n){return e.isToken(n)&&t.token.kind!==n.kind&&(t.token.kind=n.kind),t}}}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function t(e,t,n){this.sourceFile=e,this.formattingRequestKind=t,this.options=n}return t.prototype.updateContext=function(t,n,r,i,s){e.Debug.assert(void 0!==t,"currentTokenSpan is null"),e.Debug.assert(void 0!==n,"currentTokenParent is null"),e.Debug.assert(void 0!==r,"nextTokenSpan is null"),e.Debug.assert(void 0!==i,"nextTokenParent is null"),e.Debug.assert(void 0!==s,"commonParent is null"),this.currentTokenSpan=t,this.currentTokenParent=n,this.nextTokenSpan=r,this.nextTokenParent=i,this.contextNode=s,this.contextNodeAllOnSameLine=void 0,this.nextNodeAllOnSameLine=void 0,this.tokensAreOnSameLine=void 0,this.contextNodeBlockIsOnOneLine=void 0,this.nextNodeBlockIsOnOneLine=void 0},t.prototype.ContextNodeAllOnSameLine=function(){return void 0===this.contextNodeAllOnSameLine&&(this.contextNodeAllOnSameLine=this.NodeIsOnOneLine(this.contextNode)),this.contextNodeAllOnSameLine},t.prototype.NextNodeAllOnSameLine=function(){return void 0===this.nextNodeAllOnSameLine&&(this.nextNodeAllOnSameLine=this.NodeIsOnOneLine(this.nextTokenParent)),this.nextNodeAllOnSameLine},t.prototype.TokensAreOnSameLine=function(){if(void 0===this.tokensAreOnSameLine){var e=this.sourceFile.getLineAndCharacterOfPosition(this.currentTokenSpan.pos).line,t=this.sourceFile.getLineAndCharacterOfPosition(this.nextTokenSpan.pos).line;this.tokensAreOnSameLine=e===t}return this.tokensAreOnSameLine},t.prototype.ContextNodeBlockIsOnOneLine=function(){return void 0===this.contextNodeBlockIsOnOneLine&&(this.contextNodeBlockIsOnOneLine=this.BlockIsOnOneLine(this.contextNode)),this.contextNodeBlockIsOnOneLine},t.prototype.NextNodeBlockIsOnOneLine=function(){return void 0===this.nextNodeBlockIsOnOneLine&&(this.nextNodeBlockIsOnOneLine=this.BlockIsOnOneLine(this.nextTokenParent)),this.nextNodeBlockIsOnOneLine},t.prototype.NodeIsOnOneLine=function(e){return this.sourceFile.getLineAndCharacterOfPosition(e.getStart(this.sourceFile)).line===this.sourceFile.getLineAndCharacterOfPosition(e.getEnd()).line},t.prototype.BlockIsOnOneLine=function(t){var n=e.findChildOfKind(t,17,this.sourceFile),r=e.findChildOfKind(t,18,this.sourceFile);return!(!n||!r)&&this.sourceFile.getLineAndCharacterOfPosition(n.getEnd()).line===this.sourceFile.getLineAndCharacterOfPosition(r.getStart(this.sourceFile)).line},t}();t.FormattingContext=n}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){!function(e){e[e.FormatDocument=0]="FormatDocument",e[e.FormatSelection=1]="FormatSelection",e[e.FormatOnEnter=2]="FormatOnEnter",e[e.FormatOnSemicolon=3]="FormatOnSemicolon",e[e.FormatOnOpeningCurlyBrace=4]="FormatOnOpeningCurlyBrace",e[e.FormatOnClosingCurlyBrace=5]="FormatOnClosingCurlyBrace"}(e.FormattingRequestKind||(e.FormattingRequestKind={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(e,t,n){void 0===n&&(n=0),this.Descriptor=e,this.Operation=t,this.Flag=n};e.Rule=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){!function(e){e[e.Ignore=1]="Ignore",e[e.Space=2]="Space",e[e.NewLine=4]="NewLine",e[e.Delete=8]="Delete"}(e.RuleAction||(e.RuleAction={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(){function t(e,t){this.LeftTokenRange=e,this.RightTokenRange=t}return t.prototype.toString=function(){return"[leftRange="+this.LeftTokenRange+",rightRange="+this.RightTokenRange+"]"},t.create1=function(n,r){return t.create4(e.Shared.TokenRange.FromToken(n),e.Shared.TokenRange.FromToken(r))},t.create2=function(n,r){return t.create4(n,e.Shared.TokenRange.FromToken(r))},t.create3=function(n,r){return t.create4(e.Shared.TokenRange.FromToken(n),r)},t.create4=function(e,n){return new t(e,n)},t}();e.RuleDescriptor=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){!function(e){e[e.None=0]="None",e[e.CanDeleteNewLines=1]="CanDeleteNewLines"}(e.RuleFlags||(e.RuleFlags={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(){function t(e,t){this.Context=e,this.Action=t}return t.prototype.toString=function(){return"[context="+this.Context+",action="+this.Action+"]"},t.create1=function(n){return t.create2(e.RuleOperationContext.Any,n)},t.create2=function(e,n){return new t(e,n)},t}();e.RuleOperation=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(e){var t=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.customContextChecks=e}return e.prototype.IsAny=function(){return this===e.Any},e.prototype.InContext=function(e){if(this.IsAny())return!0;for(var t=0,n=this.customContextChecks;t<n.length;t++){if(!(0,n[t])(e))return!1}return!0},e.Any=new e,e}();e.RuleOperationContext=t}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function n(){if(this.IgnoreBeforeComment=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.Comments),t.RuleOperation.create1(1)),this.IgnoreAfterLineComment=new t.Rule(t.RuleDescriptor.create3(2,t.Shared.TokenRange.Any),t.RuleOperation.create1(1)),this.NoSpaceBeforeSemicolon=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,25),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeColon=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,56),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.NoSpaceBeforeQuestionMark=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,55),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.SpaceAfterColon=new t.Rule(t.RuleDescriptor.create3(56,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),2)),this.SpaceAfterQuestionMarkInConditionalOperator=new t.Rule(t.RuleDescriptor.create3(55,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsConditionalOperatorContext),2)),this.NoSpaceAfterQuestionMark=new t.Rule(t.RuleDescriptor.create3(55,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterSemicolon=new t.Rule(t.RuleDescriptor.create3(25,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterCloseBrace=new t.Rule(t.RuleDescriptor.create3(18,t.Shared.TokenRange.FromRange(0,142,[20])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsAfterCodeBlockContext),2)),this.SpaceBetweenCloseBraceAndElse=new t.Rule(t.RuleDescriptor.create1(18,82),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenCloseBraceAndWhile=new t.Rule(t.RuleDescriptor.create1(18,106),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterCloseBrace=new t.Rule(t.RuleDescriptor.create3(18,t.Shared.TokenRange.FromTokens([22,26,25])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeDot=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,23),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterDot=new t.Rule(t.RuleDescriptor.create3(23,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeOpenBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.AnyExcept(120),21),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterCloseBracket=new t.Rule(t.RuleDescriptor.create3(22,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBeforeBlockInFunctionDeclarationContext),8)),this.FunctionOpenBraceLeftTokenRange=t.Shared.TokenRange.AnyIncludingMultilineComments,this.SpaceBeforeOpenBraceInFunction=new t.Rule(t.RuleDescriptor.create2(this.FunctionOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForFunctions"),n.IsFunctionDeclContext,n.IsBeforeBlockContext,n.IsNotFormatOnEnter,n.IsSameLineTokenOrBeforeBlockContext),2),1),this.TypeScriptOpenBraceLeftTokenRange=t.Shared.TokenRange.FromTokens([71,3,75,84,91]),this.SpaceBeforeOpenBraceInTypeScriptDeclWithBlock=new t.Rule(t.RuleDescriptor.create2(this.TypeScriptOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForFunctions"),n.IsTypeScriptDeclWithBlockContext,n.IsNotFormatOnEnter,n.IsSameLineTokenOrBeforeBlockContext),2),1),this.ControlOpenBraceLeftTokenRange=t.Shared.TokenRange.FromTokens([20,3,81,102,87,82]),this.SpaceBeforeOpenBraceInControl=new t.Rule(t.RuleDescriptor.create2(this.ControlOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForControlBlocks"),n.IsControlDeclContext,n.IsNotFormatOnEnter,n.IsSameLineTokenOrBeforeBlockContext),2),1),this.SpaceAfterOpenBrace=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsBraceWrappedContext),2)),this.SpaceBeforeCloseBrace=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsBraceWrappedContext),2)),this.NoSpaceAfterOpenBrace=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseBrace=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBetweenEmptyBraceBrackets=new t.Rule(t.RuleDescriptor.create1(17,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsObjectContext),8)),this.NewLineAfterOpenBraceInBlockContext=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsMultilineBlockContext),4)),this.NewLineBeforeCloseBraceInBlockContext=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.AnyIncludingMultilineComments,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsMultilineBlockContext),4)),this.NoSpaceAfterUnaryPrefixOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.UnaryPrefixOperators,t.Shared.TokenRange.UnaryPrefixExpressions),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.NoSpaceAfterUnaryPreincrementOperator=new t.Rule(t.RuleDescriptor.create3(43,t.Shared.TokenRange.UnaryPreincrementExpressions),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterUnaryPredecrementOperator=new t.Rule(t.RuleDescriptor.create3(44,t.Shared.TokenRange.UnaryPredecrementExpressions),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeUnaryPostincrementOperator=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.UnaryPostincrementExpressions,43),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeUnaryPostdecrementOperator=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.UnaryPostdecrementExpressions,44),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterPostincrementWhenFollowedByAdd=new t.Rule(t.RuleDescriptor.create1(43,37),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterAddWhenFollowedByUnaryPlus=new t.Rule(t.RuleDescriptor.create1(37,37),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterAddWhenFollowedByPreincrement=new t.Rule(t.RuleDescriptor.create1(37,43),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterPostdecrementWhenFollowedBySubtract=new t.Rule(t.RuleDescriptor.create1(44,38),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterSubtractWhenFollowedByUnaryMinus=new t.Rule(t.RuleDescriptor.create1(38,38),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterSubtractWhenFollowedByPredecrement=new t.Rule(t.RuleDescriptor.create1(38,44),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.NoSpaceBeforeComma=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,26),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterCertainKeywords=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([104,100,94,80,96,103,121]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterNewKeywordOnConstructorSignature=new t.Rule(t.RuleDescriptor.create1(94,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsConstructorSignatureContext),8)),this.SpaceAfterLetConstInVariableDeclaration=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([110,76]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsStartOfVariableDeclarationList),2)),this.NoSpaceBeforeOpenParenInFuncCall=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsFunctionCallOrNewContext,n.IsPreviousTokenNotComma),8)),this.SpaceAfterFunctionInFuncDecl=new t.Rule(t.RuleDescriptor.create3(89,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclContext),2)),this.SpaceBeforeOpenParenInFuncDecl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceBeforeFunctionParenthesis"),n.IsNonJsxSameLineTokenContext,n.IsFunctionDeclContext),2)),this.NoSpaceBeforeOpenParenInFuncDecl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceBeforeFunctionParenthesis"),n.IsNonJsxSameLineTokenContext,n.IsFunctionDeclContext),8)),this.SpaceAfterVoidOperator=new t.Rule(t.RuleDescriptor.create3(105,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsVoidOpContext),2)),this.NoSpaceBetweenReturnAndSemicolon=new t.Rule(t.RuleDescriptor.create1(96,25),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceBetweenStatements=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([20,81,82,73]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNonJsxElementContext,n.IsNotForContext),2)),this.SpaceAfterTryFinally=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.FromTokens([102,87]),17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterGetSetInMember=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.FromTokens([125,135]),71),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclContext),2)),this.SpaceBeforeBinaryKeywordOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.BinaryKeywordOperators),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterBinaryKeywordOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.BinaryKeywordOperators,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterConstructor=new t.Rule(t.RuleDescriptor.create1(123,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterConstructor"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterConstructor=new t.Rule(t.RuleDescriptor.create1(123,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterConstructor"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterModuleImport=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.FromTokens([128,132]),19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterCertainTypeScriptKeywords=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([117,75,124,79,83,84,85,125,108,91,109,128,129,112,114,113,131,135,115,138,140,127]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCertainTypeScriptKeywords=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([85,108,140])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterModuleName=new t.Rule(t.RuleDescriptor.create1(9,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsModuleDeclContext),2)),this.SpaceBeforeArrow=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,36),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterArrow=new t.Rule(t.RuleDescriptor.create3(36,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterEllipsis=new t.Rule(t.RuleDescriptor.create1(24,71),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOptionalParameters=new t.Rule(t.RuleDescriptor.create3(55,t.Shared.TokenRange.FromTokens([20,26])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNotBinaryOpContext),8)),this.NoSpaceBeforeOpenAngularBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.TypeNames,27),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBetweenCloseParenAndAngularBracket=new t.Rule(t.RuleDescriptor.create1(20,27),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceAfterOpenAngularBracket=new t.Rule(t.RuleDescriptor.create3(27,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBeforeCloseAngularBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,29),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceAfterCloseAngularBracket=new t.Rule(t.RuleDescriptor.create3(29,t.Shared.TokenRange.FromTokens([19,21,29,26])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBetweenEmptyInterfaceBraceBrackets=new t.Rule(t.RuleDescriptor.create1(17,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsObjectTypeContext),8)),this.SpaceBeforeAt=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,57),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterAt=new t.Rule(t.RuleDescriptor.create3(57,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterDecorator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([117,71,84,79,75,115,114,112,113,125,135,21,39])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsEndOfDecoratorContextOnSameLine),2)),this.NoSpaceBetweenFunctionKeywordAndStar=new t.Rule(t.RuleDescriptor.create1(89,39),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclarationOrFunctionExpressionContext),8)),this.SpaceAfterStarInGeneratorDeclaration=new t.Rule(t.RuleDescriptor.create3(39,t.Shared.TokenRange.FromTokens([71,19])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsFunctionDeclarationOrFunctionExpressionContext),2)),this.NoSpaceBetweenYieldKeywordAndStar=new t.Rule(t.RuleDescriptor.create1(116,39),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsYieldOrYieldStarWithOperand),8)),this.SpaceBetweenYieldOrYieldStarAndOperand=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([116,39]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsYieldOrYieldStarWithOperand),2)),this.SpaceBetweenAsyncAndOpenParen=new t.Rule(t.RuleDescriptor.create1(120,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsArrowFunctionContext,n.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenAsyncAndFunctionKeyword=new t.Rule(t.RuleDescriptor.create1(120,89),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenTagAndTemplateString=new t.Rule(t.RuleDescriptor.create3(71,t.Shared.TokenRange.FromTokens([13,14])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.SpaceBeforeJsxAttribute=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,71),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNextTokenParentJsxAttribute,n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeSlashInJsxOpeningElement=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,41),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxSelfClosingElementContext,n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBeforeGreaterThanTokenInJsxOpeningElement=new t.Rule(t.RuleDescriptor.create1(41,29),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxSelfClosingElementContext,n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeEqualInJsxAttribute=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,58),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxAttributeContext,n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterEqualInJsxAttribute=new t.Rule(t.RuleDescriptor.create3(58,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsJsxAttributeContext,n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeNonNullAssertionOperator=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,51),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext,n.IsNonNullAssertionContext),8)),this.SpaceAfterComma=new t.Rule(t.RuleDescriptor.create3(26,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterCommaDelimiter"),n.IsNonJsxSameLineTokenContext,n.IsNonJsxElementContext,n.IsNextTokenNotCloseBracket),2)),this.NoSpaceAfterComma=new t.Rule(t.RuleDescriptor.create3(26,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterCommaDelimiter"),n.IsNonJsxSameLineTokenContext,n.IsNonJsxElementContext),8)),this.SpaceBeforeBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.BinaryOperators),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.SpaceAfterBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.BinaryOperators,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),2)),this.NoSpaceBeforeBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.BinaryOperators),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),8)),this.NoSpaceAfterBinaryOperator=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.BinaryOperators,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceBeforeAndAfterBinaryOperators"),n.IsNonJsxSameLineTokenContext,n.IsBinaryOpContext),8)),this.SpaceAfterKeywordInControl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Keywords,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterKeywordsInControlFlowStatements"),n.IsControlDeclContext),2)),this.NoSpaceAfterKeywordInControl=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Keywords,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterKeywordsInControlFlowStatements"),n.IsControlDeclContext),8)),this.NewLineBeforeOpenBraceInFunction=new t.Rule(t.RuleDescriptor.create2(this.FunctionOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("placeOpenBraceOnNewLineForFunctions"),n.IsFunctionDeclContext,n.IsBeforeMultilineBlockContext),4),1),this.NewLineBeforeOpenBraceInTypeScriptDeclWithBlock=new t.Rule(t.RuleDescriptor.create2(this.TypeScriptOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("placeOpenBraceOnNewLineForFunctions"),n.IsTypeScriptDeclWithBlockContext,n.IsBeforeMultilineBlockContext),4),1),this.NewLineBeforeOpenBraceInControl=new t.Rule(t.RuleDescriptor.create2(this.ControlOpenBraceLeftTokenRange,17),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("placeOpenBraceOnNewLineForControlBlocks"),n.IsControlDeclContext,n.IsBeforeMultilineBlockContext),4),1),this.SpaceAfterSemicolonInFor=new t.Rule(t.RuleDescriptor.create3(25,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterSemicolonInForStatements"),n.IsNonJsxSameLineTokenContext,n.IsForContext),2)),this.NoSpaceAfterSemicolonInFor=new t.Rule(t.RuleDescriptor.create3(25,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterSemicolonInForStatements"),n.IsNonJsxSameLineTokenContext,n.IsForContext),8)),this.SpaceAfterOpenParen=new t.Rule(t.RuleDescriptor.create3(19,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCloseParen=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,20),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenOpenParens=new t.Rule(t.RuleDescriptor.create1(19,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenParens=new t.Rule(t.RuleDescriptor.create1(19,20),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOpenParen=new t.Rule(t.RuleDescriptor.create3(19,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseParen=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,20),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterOpenBracket=new t.Rule(t.RuleDescriptor.create3(21,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCloseBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,22),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenBrackets=new t.Rule(t.RuleDescriptor.create1(21,22),t.RuleOperation.create2(new t.RuleOperationContext(n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOpenBracket=new t.Rule(t.RuleDescriptor.create3(21,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseBracket=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,22),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),n.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterTemplateHeadAndMiddle=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([14,15]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterTemplateHeadAndMiddle=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.FromTokens([14,15]),t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBeforeTemplateMiddleAndTail=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([15,16])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),8)),this.SpaceBeforeTemplateMiddleAndTail=new t.Rule(t.RuleDescriptor.create4(t.Shared.TokenRange.Any,t.Shared.TokenRange.FromTokens([15,16])),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),n.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterOpenBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),8)),this.SpaceAfterOpenBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create3(17,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),2)),this.NoSpaceBeforeCloseBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),8)),this.SpaceBeforeCloseBraceInJsxExpression=new t.Rule(t.RuleDescriptor.create2(t.Shared.TokenRange.Any,18),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),n.IsNonJsxSameLineTokenContext,n.IsJsxExpressionContext),2)),this.SpaceAfterAnonymousFunctionKeyword=new t.Rule(t.RuleDescriptor.create1(89,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterFunctionKeywordForAnonymousFunctions"),n.IsFunctionDeclContext),2)),this.NoSpaceAfterAnonymousFunctionKeyword=new t.Rule(t.RuleDescriptor.create1(89,19),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterFunctionKeywordForAnonymousFunctions"),n.IsFunctionDeclContext),8)),this.NoSpaceAfterTypeAssertion=new t.Rule(t.RuleDescriptor.create3(29,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionDisabledOrUndefined("insertSpaceAfterTypeAssertion"),n.IsNonJsxSameLineTokenContext,n.IsTypeAssertionContext),8)),this.SpaceAfterTypeAssertion=new t.Rule(t.RuleDescriptor.create3(29,t.Shared.TokenRange.Any),t.RuleOperation.create2(new t.RuleOperationContext(n.IsOptionEnabled("insertSpaceAfterTypeAssertion"),n.IsNonJsxSameLineTokenContext,n.IsTypeAssertionContext),2)),this.HighPriorityCommonRules=[this.IgnoreBeforeComment,this.IgnoreAfterLineComment,this.NoSpaceBeforeColon,this.SpaceAfterColon,this.NoSpaceBeforeQuestionMark,this.SpaceAfterQuestionMarkInConditionalOperator,this.NoSpaceAfterQuestionMark,this.NoSpaceBeforeDot,this.NoSpaceAfterDot,this.NoSpaceAfterUnaryPrefixOperator,this.NoSpaceAfterUnaryPreincrementOperator,this.NoSpaceAfterUnaryPredecrementOperator,this.NoSpaceBeforeUnaryPostincrementOperator,this.NoSpaceBeforeUnaryPostdecrementOperator,this.SpaceAfterPostincrementWhenFollowedByAdd,this.SpaceAfterAddWhenFollowedByUnaryPlus,this.SpaceAfterAddWhenFollowedByPreincrement,this.SpaceAfterPostdecrementWhenFollowedBySubtract,this.SpaceAfterSubtractWhenFollowedByUnaryMinus,this.SpaceAfterSubtractWhenFollowedByPredecrement,this.NoSpaceAfterCloseBrace,this.NewLineBeforeCloseBraceInBlockContext,this.SpaceAfterCloseBrace,this.SpaceBetweenCloseBraceAndElse,this.SpaceBetweenCloseBraceAndWhile,this.NoSpaceBetweenEmptyBraceBrackets,this.NoSpaceBetweenFunctionKeywordAndStar,this.SpaceAfterStarInGeneratorDeclaration,this.SpaceAfterFunctionInFuncDecl,this.NewLineAfterOpenBraceInBlockContext,this.SpaceAfterGetSetInMember,this.NoSpaceBetweenYieldKeywordAndStar,this.SpaceBetweenYieldOrYieldStarAndOperand,this.NoSpaceBetweenReturnAndSemicolon,this.SpaceAfterCertainKeywords,this.SpaceAfterLetConstInVariableDeclaration,this.NoSpaceBeforeOpenParenInFuncCall,this.SpaceBeforeBinaryKeywordOperator,this.SpaceAfterBinaryKeywordOperator,this.SpaceAfterVoidOperator,this.SpaceBetweenAsyncAndOpenParen,this.SpaceBetweenAsyncAndFunctionKeyword,this.NoSpaceBetweenTagAndTemplateString,this.SpaceBeforeJsxAttribute,this.SpaceBeforeSlashInJsxOpeningElement,this.NoSpaceBeforeGreaterThanTokenInJsxOpeningElement,this.NoSpaceBeforeEqualInJsxAttribute,this.NoSpaceAfterEqualInJsxAttribute,this.NoSpaceAfterModuleImport,this.SpaceAfterCertainTypeScriptKeywords,this.SpaceBeforeCertainTypeScriptKeywords,this.SpaceAfterModuleName,this.SpaceBeforeArrow,this.SpaceAfterArrow,this.NoSpaceAfterEllipsis,this.NoSpaceAfterOptionalParameters,this.NoSpaceBetweenEmptyInterfaceBraceBrackets,this.NoSpaceBeforeOpenAngularBracket,this.NoSpaceBetweenCloseParenAndAngularBracket,this.NoSpaceAfterOpenAngularBracket,this.NoSpaceBeforeCloseAngularBracket,this.NoSpaceAfterCloseAngularBracket,this.SpaceBeforeAt,this.NoSpaceAfterAt,this.SpaceAfterDecorator,this.NoSpaceBeforeNonNullAssertionOperator,this.NoSpaceAfterNewKeywordOnConstructorSignature],this.UserConfigurableRules=[this.SpaceAfterConstructor,this.NoSpaceAfterConstructor,this.SpaceAfterComma,this.NoSpaceAfterComma,this.SpaceAfterAnonymousFunctionKeyword,this.NoSpaceAfterAnonymousFunctionKeyword,this.SpaceAfterKeywordInControl,this.NoSpaceAfterKeywordInControl,this.SpaceAfterOpenParen,this.SpaceBeforeCloseParen,this.SpaceBetweenOpenParens,this.NoSpaceBetweenParens,this.NoSpaceAfterOpenParen,this.NoSpaceBeforeCloseParen,this.SpaceAfterOpenBracket,this.SpaceBeforeCloseBracket,this.NoSpaceBetweenBrackets,this.NoSpaceAfterOpenBracket,this.NoSpaceBeforeCloseBracket,this.SpaceAfterOpenBrace,this.SpaceBeforeCloseBrace,this.NoSpaceBetweenEmptyBraceBrackets,this.NoSpaceAfterOpenBrace,this.NoSpaceBeforeCloseBrace,this.SpaceAfterTemplateHeadAndMiddle,this.SpaceBeforeTemplateMiddleAndTail,this.NoSpaceAfterTemplateHeadAndMiddle,this.NoSpaceBeforeTemplateMiddleAndTail,this.SpaceAfterOpenBraceInJsxExpression,this.SpaceBeforeCloseBraceInJsxExpression,this.NoSpaceAfterOpenBraceInJsxExpression,this.NoSpaceBeforeCloseBraceInJsxExpression,this.SpaceAfterSemicolonInFor,this.NoSpaceAfterSemicolonInFor,this.SpaceBeforeBinaryOperator,this.SpaceAfterBinaryOperator,this.NoSpaceBeforeBinaryOperator,this.NoSpaceAfterBinaryOperator,this.SpaceBeforeOpenParenInFuncDecl,this.NoSpaceBeforeOpenParenInFuncDecl,this.NewLineBeforeOpenBraceInControl,this.NewLineBeforeOpenBraceInFunction,this.NewLineBeforeOpenBraceInTypeScriptDeclWithBlock,this.SpaceAfterTypeAssertion,this.NoSpaceAfterTypeAssertion],this.LowPriorityCommonRules=[this.NoSpaceBeforeSemicolon,this.SpaceBeforeOpenBraceInControl,this.SpaceBeforeOpenBraceInFunction,this.SpaceBeforeOpenBraceInTypeScriptDeclWithBlock,this.NoSpaceBeforeComma,this.NoSpaceBeforeOpenBracket,this.NoSpaceAfterCloseBracket,this.SpaceAfterSemicolon,this.SpaceBetweenStatements,this.SpaceAfterTryFinally],e.Debug.isDebugging){for(var r in this){var i=this[r];i instanceof t.Rule&&(i.debugName=r)}}}return n.IsOptionEnabled=function(e){return function(t){return t.options&&t.options.hasOwnProperty(e)&&!!t.options[e]}},n.IsOptionDisabled=function(e){return function(t){return t.options&&t.options.hasOwnProperty(e)&&!t.options[e]}},n.IsOptionDisabledOrUndefined=function(e){return function(t){return!t.options||!t.options.hasOwnProperty(e)||!t.options[e]}},n.isOptionDisabledOrUndefinedOrTokensOnSameLine=function(e){return function(t){return!t.options||!t.options.hasOwnProperty(e)||!t.options[e]||t.TokensAreOnSameLine()}},n.IsOptionEnabledOrUndefined=function(e){return function(t){return!t.options||!t.options.hasOwnProperty(e)||!!t.options[e]}},n.IsForContext=function(e){return 214===e.contextNode.kind},n.IsNotForContext=function(e){return!n.IsForContext(e)},n.IsBinaryOpContext=function(e){switch(e.contextNode.kind){case 194:case 195:case 202:case 246:case 242:case 158:case 166:case 167:return!0;case 176:case 231:case 237:case 226:case 146:case 264:case 149:case 148:return 58===e.currentTokenSpan.kind||58===e.nextTokenSpan.kind;case 215:case 145:return 92===e.currentTokenSpan.kind||92===e.nextTokenSpan.kind;case 216:return 142===e.currentTokenSpan.kind||142===e.nextTokenSpan.kind}return!1},n.IsNotBinaryOpContext=function(e){return!n.IsBinaryOpContext(e)},n.IsConditionalOperatorContext=function(e){return 195===e.contextNode.kind},n.IsSameLineTokenOrBeforeBlockContext=function(e){return e.TokensAreOnSameLine()||n.IsBeforeBlockContext(e)},n.IsBraceWrappedContext=function(e){return 174===e.contextNode.kind||n.IsSingleLineBlockContext(e)},n.IsBeforeMultilineBlockContext=function(e){return n.IsBeforeBlockContext(e)&&!(e.NextNodeAllOnSameLine()||e.NextNodeBlockIsOnOneLine())},n.IsMultilineBlockContext=function(e){return n.IsBlockContext(e)&&!(e.ContextNodeAllOnSameLine()||e.ContextNodeBlockIsOnOneLine())},n.IsSingleLineBlockContext=function(e){return n.IsBlockContext(e)&&(e.ContextNodeAllOnSameLine()||e.ContextNodeBlockIsOnOneLine())},n.IsBlockContext=function(e){return n.NodeIsBlockContext(e.contextNode)},n.IsBeforeBlockContext=function(e){return n.NodeIsBlockContext(e.nextTokenParent)},n.NodeIsBlockContext=function(e){if(n.NodeIsTypeScriptDeclWithBlockContext(e))return!0;switch(e.kind){case 207:case 235:case 178:case 234:return!0}return!1},n.IsFunctionDeclContext=function(e){switch(e.contextNode.kind){case 228:case 151:case 150:case 153:case 154:case 155:case 186:case 152:case 187:case 230:return!0}return!1},n.IsFunctionDeclarationOrFunctionExpressionContext=function(e){return 228===e.contextNode.kind||186===e.contextNode.kind},n.IsTypeScriptDeclWithBlockContext=function(e){return n.NodeIsTypeScriptDeclWithBlockContext(e.contextNode)},n.NodeIsTypeScriptDeclWithBlockContext=function(e){switch(e.kind){case 229:case 199:case 230:case 232:case 163:case 233:case 244:case 245:case 238:case 241:return!0}return!1},n.IsAfterCodeBlockContext=function(e){switch(e.currentTokenParent.kind){case 229:case 233:case 232:case 260:case 234:case 221:return!0;case 207:var t=e.currentTokenParent.parent;if(!t||187!==t.kind&&186!==t.kind)return!0}return!1},n.IsControlDeclContext=function(e){switch(e.contextNode.kind){case 211:case 221:case 214:case 215:case 216:case 213:case 224:case 212:case 220:case 260:return!0;default:return!1}},n.IsObjectContext=function(e){return 178===e.contextNode.kind},n.IsFunctionCallContext=function(e){return 181===e.contextNode.kind},n.IsNewContext=function(e){return 182===e.contextNode.kind},n.IsFunctionCallOrNewContext=function(e){return n.IsFunctionCallContext(e)||n.IsNewContext(e)},n.IsPreviousTokenNotComma=function(e){return 26!==e.currentTokenSpan.kind},n.IsNextTokenNotCloseBracket=function(e){return 22!==e.nextTokenSpan.kind},n.IsArrowFunctionContext=function(e){return 187===e.contextNode.kind},n.IsNonJsxSameLineTokenContext=function(e){return e.TokensAreOnSameLine()&&10!==e.contextNode.kind},n.IsNonJsxElementContext=function(e){return 249!==e.contextNode.kind},n.IsJsxExpressionContext=function(e){return 256===e.contextNode.kind},n.IsNextTokenParentJsxAttribute=function(e){return 253===e.nextTokenParent.kind},n.IsJsxAttributeContext=function(e){return 253===e.contextNode.kind},n.IsJsxSelfClosingElementContext=function(e){return 250===e.contextNode.kind},n.IsNotBeforeBlockInFunctionDeclarationContext=function(e){return!n.IsFunctionDeclContext(e)&&!n.IsBeforeBlockContext(e)},n.IsEndOfDecoratorContextOnSameLine=function(e){return e.TokensAreOnSameLine()&&e.contextNode.decorators&&n.NodeIsInDecoratorContext(e.currentTokenParent)&&!n.NodeIsInDecoratorContext(e.nextTokenParent)},n.NodeIsInDecoratorContext=function(t){for(;e.isPartOfExpression(t);)t=t.parent;return 147===t.kind},n.IsStartOfVariableDeclarationList=function(e){return 227===e.currentTokenParent.kind&&e.currentTokenParent.getStart(e.sourceFile)===e.currentTokenSpan.pos},n.IsNotFormatOnEnter=function(e){return 2!==e.formattingRequestKind},n.IsModuleDeclContext=function(e){return 233===e.contextNode.kind},n.IsObjectTypeContext=function(e){return 163===e.contextNode.kind},n.IsConstructorSignatureContext=function(e){return 156===e.contextNode.kind},n.IsTypeArgumentOrParameterOrAssertion=function(e,t){if(27!==e.kind&&29!==e.kind)return!1;switch(t.kind){case 159:case 184:case 231:case 229:case 199:case 230:case 228:case 186:case 187:case 151:case 150:case 155:case 156:case 181:case 182:case 201:return!0;default:return!1}},n.IsTypeArgumentOrParameterOrAssertionContext=function(e){return n.IsTypeArgumentOrParameterOrAssertion(e.currentTokenSpan,e.currentTokenParent)||n.IsTypeArgumentOrParameterOrAssertion(e.nextTokenSpan,e.nextTokenParent)},n.IsTypeAssertionContext=function(e){return 184===e.contextNode.kind},n.IsVoidOpContext=function(e){return 105===e.currentTokenSpan.kind&&190===e.currentTokenParent.kind},n.IsYieldOrYieldStarWithOperand=function(e){return 197===e.contextNode.kind&&void 0!==e.contextNode.expression},n.IsNonNullAssertionContext=function(e){return 203===e.contextNode.kind},n}();t.Rules=n}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function t(e){this.mapRowLength=143,this.map=new Array(this.mapRowLength*this.mapRowLength);for(var t=new Array(this.map.length),n=0,r=e;n<r.length;n++){var i=r[n];this.FillRule(i,t)}}return t.prototype.GetRuleBucketIndex=function(t,n){return e.Debug.assert(t<=142&&n<=142,"Must compute formatting context from tokens"),t*this.mapRowLength+n},t.prototype.FillRule=function(e,t){var n=this,r=e.Descriptor.LeftTokenRange.isSpecific()&&e.Descriptor.RightTokenRange.isSpecific();e.Descriptor.LeftTokenRange.GetTokens().forEach((function(i){e.Descriptor.RightTokenRange.GetTokens().forEach((function(o){var a=n.GetRuleBucketIndex(i,o),l=n.map[a];void 0===l&&(l=n.map[a]=new s),l.AddRule(e,r,t,a)}))}))},t.prototype.GetRule=function(e){var t=this.GetRuleBucketIndex(e.currentTokenSpan.kind,e.nextTokenSpan.kind),n=this.map[t];if(n)for(var r=0,i=n.Rules();r<i.length;r++){var s=i[r];if(s.Operation.Context.InContext(e))return s}},t}();t.RulesMap=n;var r;!function(e){e[e.IgnoreRulesSpecific=0]="IgnoreRulesSpecific",e[e.IgnoreRulesAny=5]="IgnoreRulesAny",e[e.ContextRulesSpecific=10]="ContextRulesSpecific",e[e.ContextRulesAny=15]="ContextRulesAny",e[e.NoContextRulesSpecific=20]="NoContextRulesSpecific",e[e.NoContextRulesAny=25]="NoContextRulesAny"}(r||(r={}));var i=function(){function t(){this.rulesInsertionIndexBitmap=0}return t.prototype.GetInsertionIndex=function(e){for(var t=0,n=0,r=this.rulesInsertionIndexBitmap;n<=e;)t+=31&r,r>>=5,n+=5;return t},t.prototype.IncreaseInsertionIndex=function(t){var n=this.rulesInsertionIndexBitmap>>t&31;n++,e.Debug.assert((31&n)===n,"Adding more rules into the sub-bucket than allowed. Maximum allowed is 32 rules.");var r=this.rulesInsertionIndexBitmap&~(31<<t);r|=n<<t,this.rulesInsertionIndexBitmap=r},t}();t.RulesBucketConstructionState=i;var s=function(){function e(){this.rules=[]}return e.prototype.Rules=function(){return this.rules},e.prototype.AddRule=function(e,t,n,s){var o;o=1===e.Operation.Action?t?r.IgnoreRulesSpecific:r.IgnoreRulesAny:e.Operation.Context.IsAny()?t?r.NoContextRulesSpecific:r.NoContextRulesAny:t?r.ContextRulesSpecific:r.ContextRulesAny;var a=n[s];void 0===a&&(a=n[s]=new i);var l=a.GetInsertionIndex(o);this.rules.splice(l,0,e),a.IncreaseInsertionIndex(o)},e}();t.RulesBucket=s}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){!function(t){for(var n=[],r=0;r<=142;r++)n.push(r);var i=function(){function e(e){void 0===e&&(e=[]),this.tokens=e}return e.prototype.GetTokens=function(){return this.tokens},e.prototype.Contains=function(e){return this.tokens.indexOf(e)>=0},e.prototype.isSpecific=function(){return!0},e}(),s=function(){function e(e){this.token=e}return e.prototype.GetTokens=function(){return[this.token]},e.prototype.Contains=function(e){return e===this.token},e.prototype.isSpecific=function(){return!0},e}(),o=function(){function e(){}return e.prototype.GetTokens=function(){return n},e.prototype.Contains=function(){return!0},e.prototype.toString=function(){return"[allTokens]"},e.prototype.isSpecific=function(){return!1},e}(),a=function(){function e(e){this.except=e}return e.prototype.GetTokens=function(){var e=this;return n.filter((function(t){return t!==e.except}))},e.prototype.Contains=function(e){return e!==this.except},e.prototype.isSpecific=function(){return!1},e}();!function(t){t.FromToken=function(e){return new s(e)},t.FromTokens=function(e){return new i(e)},t.FromRange=function(t,n,r){void 0===r&&(r=[]);for(var s=[],o=t;o<=n;o++)e.indexOf(r,o)<0&&s.push(o);return new i(s)},t.AnyExcept=function(e){return new a(e)},t.Any=new o,t.AnyIncludingMultilineComments=t.FromTokens(n.concat([3])),t.Keywords=t.FromRange(72,142),t.BinaryOperators=t.FromRange(27,70),t.BinaryKeywordOperators=t.FromTokens([92,93,142,118,126]),t.UnaryPrefixOperators=t.FromTokens([43,44,52,51]),t.UnaryPrefixExpressions=t.FromTokens([8,71,19,21,17,99,94]),t.UnaryPreincrementExpressions=t.FromTokens([71,19,99,94]),t.UnaryPostincrementExpressions=t.FromTokens([71,20,22,94]),t.UnaryPredecrementExpressions=t.FromTokens([71,19,99,94]),t.UnaryPostdecrementExpressions=t.FromTokens([71,20,22,94]),t.Comments=t.FromTokens([2,3]),t.TypeNames=t.FromTokens([71,133,136,122,137,105,119])}(t.TokenRange||(t.TokenRange={}))}(t.Shared||(t.Shared={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n=function(){function n(){this.globalRules=new t.Rules;var e=this.globalRules.HighPriorityCommonRules.concat(this.globalRules.UserConfigurableRules).concat(this.globalRules.LowPriorityCommonRules);this.rulesMap=new t.RulesMap(e)}return n.prototype.getRulesMap=function(){return this.rulesMap},n.prototype.getFormatOptions=function(){return this.options},n.prototype.ensureUpToDate=function(t){this.options&&e.compareDataObjects(this.options,t)||(this.options=e.clone(t))},n}();t.RulesProvider=n}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){var n,r,i,s;function o(t,n,r){var i=e.findPrecedingToken(t,r);return i&&i.kind===n&&t===i.getEnd()?i:void 0}function a(e){for(var t=e;t&&t.parent&&t.parent.end===e.end&&!l(t.parent,t);)t=t.parent;return t}function l(t,n){switch(t.kind){case 229:case 230:return e.rangeContainsRange(t.members,n);case 233:var r=t.body;return r&&234===r.kind&&e.rangeContainsRange(r.statements,n);case 265:case 207:case 234:return e.rangeContainsRange(t.statements,n);case 260:return e.rangeContainsRange(t.block.statements,n)}return!1}function c(t,n,r,i,s){return t?u({pos:e.getLineStartPositionForPosition(t.getStart(n),n),end:t.end},n,r,i,s):[]}function u(n,r,i,s,o){var a=function(t,n){return function r(i){var s=e.forEachChild(i,(function(r){return e.startEndContainsRange(r.getStart(n),r.end,t)&&r}));if(s){var o=r(s);if(o)return o}return i}(n)}(n,r);return t.getFormattingScanner(r.text,r.languageVariant,function(t,n,r){var i=t.getStart(r);if(i===n.pos&&t.end===n.end)return i;var s=e.findPrecedingToken(n.pos,r);return s?s.end>=n.pos?t.pos:s.end:t.pos}(a,n,r),n.end,(function(l){return d(n,a,t.SmartIndenter.getIndentationForNode(a,n,r,i),function(e,n,r){for(var i,s=-1;e;){var o=r.getLineAndCharacterOfPosition(e.getStart(r)).line;if(-1!==s&&o!==s)break;if(t.SmartIndenter.shouldIndentChildNode(e,i))return n.indentSize;s=o,i=e,e=e.parent}return 0}(a,i,r),l,i,s,o,function(t,n){if(!t.length)return s;var r=t.filter((function(t){return e.rangeOverlapsWithStartEnd(n,t.start,t.start+t.length)})).sort((function(e,t){return e.start-t.start}));if(!r.length)return s;var i=0;return function(t){for(;;){if(i>=r.length)return!1;var n=r[i];if(t.end<=n.start)return!1;if(e.startEndOverlapsWithStartEnd(t.pos,t.end,n.start,n.start+n.length))return!0;i++}};function s(){return!1}}(r.parseDiagnostics,n),r)}))}function d(n,r,i,s,o,a,l,c,u,d){var h,f,m,_,g,y=new t.FormattingContext(d,c,a),b=[];if(o.advance(),o.isOnToken()){var v=d.getLineAndCharacterOfPosition(r.getStart(d)).line,T=v;r.decorators&&(T=d.getLineAndCharacterOfPosition(e.getNonDecoratorTokenPosOfNode(r,d)).line),function r(i,s,l,c,p,f){if(!e.rangeOverlapsWithStartEnd(n,i.getStart(d),i.getEnd()))return;var m=x(i,l,p,f),y=s;e.forEachChild(i,(function(e){v(e,-1,i,m,l,c,!1)}),(function(e){T(e,i,l,m)}));for(;o.isOnToken();){var b=o.readTokenInfo(i);if(b.token.end>i.end)break;k(b,i,m,i)}function v(s,l,c,u,p,h,f,m){var _=s.getStart(d),g=d.getLineAndCharacterOfPosition(_).line,b=g;s.decorators&&(b=d.getLineAndCharacterOfPosition(e.getNonDecoratorTokenPosOfNode(s,d)).line);var v=-1;if(f&&e.rangeContainsRange(n,c)&&-1!==(v=function(n,r,i,s,o){if(e.rangeOverlapsWithStartEnd(s,n,r)||e.rangeContainsStartEnd(s,n,r)){if(-1!==o)return o}else{var l=d.getLineAndCharacterOfPosition(n).line,c=e.getLineStartPositionForPosition(n,d),u=t.SmartIndenter.findFirstNonWhitespaceColumn(c,n,d,a);if(l!==i||n===u){var p=t.SmartIndenter.getBaseIndentation(a);return p>u?p:u}}return-1}(_,s.end,p,n,l))&&(l=v),!e.rangeOverlapsWithStartEnd(n,s.pos,s.end))return s.end<n.pos&&o.skipToEndOf(s),l;if(0===s.getFullWidth())return l;for(;o.isOnToken();){if((T=o.readTokenInfo(i)).token.end>_)break;k(T,i,u,i)}if(!o.isOnToken())return l;if(e.isToken(s)&&10!==s.kind){var T=o.readTokenInfo(s);return e.Debug.assert(T.token.end===s.end,"Token end is child end"),k(T,i,u,s),l}var x=147===s.kind?g:h,S=E(s,g,v,i,u,x);return r(s,y,g,b,S.indentation,S.delta),y=i,m&&177===c.kind&&-1===l&&(l=S.indentation),l}function T(t,n,r,s){e.Debug.assert(e.isNodeArray(t));var a=function(e,t){switch(e.kind){case 152:case 228:case 186:case 151:case 150:case 187:if(e.typeParameters===t)return 27;if(e.parameters===t)return 19;break;case 181:case 182:if(e.typeArguments===t)return 27;if(e.arguments===t)return 19;break;case 159:if(e.typeArguments===t)return 27}return 0}(n,t),l=function(e){switch(e){case 19:return 20;case 27:return 29}return 0}(a),c=s,u=r;if(0!==a)for(;o.isOnToken();){if((h=o.readTokenInfo(n)).token.end>t.pos)break;if(h.token.kind===a){u=d.getLineAndCharacterOfPosition(h.token.pos).line;var p=E(h.token,u,-1,n,s,r);k(h,n,c=x(n,r,p.indentation,p.delta),n)}else k(h,n,s,n)}for(var h,f=-1,m=0;m<t.length;m++){f=v(t[m],f,i,c,u,u,!0,0===m)}0!==l&&(o.isOnToken()&&(h=o.readTokenInfo(n)).token.kind===l&&e.rangeContainsRange(n,h.token)&&k(h,n,c,n))}function k(t,r,i,s){e.Debug.assert(e.rangeContainsRange(r,t.token));var a,l=o.lastTrailingTriviaWasNewLine(),c=!1;t.leadingTrivia&&S(t.leadingTrivia,r,y,i);var p=e.rangeContainsRange(n,t.token),f=d.getLineAndCharacterOfPosition(t.token.pos);if(p){var m=u(t.token),b=h;if(a=C(t.token,f,r,y,i),m)c=!1;else if(void 0!==a)c=a;else{var v=b&&d.getLineAndCharacterOfPosition(b.end).line;c=l&&f.line!==v}}if(t.trailingTrivia&&S(t.trailingTrivia,r,y,i),c){var T=p&&!u(t.token)?i.getIndentationForToken(f.line,t.token.kind,s):-1,k=!0;if(t.leadingTrivia)for(var E=i.getIndentationForComment(t.token.kind,T,s),x=0,w=t.leadingTrivia;x<w.length;x++){var N=w[x],D=e.rangeContainsRange(n,N);switch(N.kind){case 3:D&&A(N,E,!k),k=!1;break;case 2:k&&D&&I(N.pos,E,!1),k=!1;break;case 4:k=!0}}-1!==T&&k&&(I(t.token.pos,T,a),_=f.line,g=T)}o.advance(),y=r}}(r,r,v,T,i,s)}if(!o.isOnToken()){var k=o.getCurrentLeadingTrivia();k&&(S(k,r,r,void 0),function(){var e=h?h.end:n.pos,t=d.getLineAndCharacterOfPosition(e).line,r=d.getLineAndCharacterOfPosition(n.end).line;w(t,r+1,h)}())}return b;function E(e,n,r,i,s,o){var l=r,c=t.SmartIndenter.shouldIndentChildNode(e)?a.indentSize:0;return o===n?(l=n===_?g:s.getIndentation(),c=Math.min(a.indentSize,s.getDelta(e)+c)):-1===l&&(l=t.SmartIndenter.childStartsOnTheSameLineWithElseInIfStatement(i,e,n,d)?s.getIndentation():s.getIndentation()+s.getDelta(e)),{indentation:l,delta:c}}function x(n,r,i,s){return{getIndentationForComment:function(e,t,n){switch(e){case 18:case 22:case 20:return i+o(s,n)}return-1!==t?t:i},getIndentationForToken:function(t,a,l){if(r!==t&&n.decorators&&a===function(t){if(t.modifiers&&t.modifiers.length)return t.modifiers[0].kind;switch(t.kind){case 229:return 75;case 230:return 109;case 228:return 89;case 232:return 232;case 153:return 125;case 154:return 135;case 151:if(t.asteriskToken)return 39;case 149:case 146:return e.getNameOfDeclaration(t).kind}}(n))return i;switch(a){case 17:case 18:case 19:case 20:case 82:case 106:case 57:return i;case 41:case 29:if(251===l.kind||252===l.kind||250===l.kind)return i;break;case 21:case 22:if(172!==l.kind)return i}return r!==t?i+o(s,l):i},getIndentation:function(){return i},getDelta:function(e){return o(s,e)},recomputeIndentation:function(e){n.parent&&t.SmartIndenter.shouldIndentChildNode(n.parent,n)&&(e?i+=a.indentSize:i-=a.indentSize,s=t.SmartIndenter.shouldIndentChildNode(n)?a.indentSize:0)}};function o(e,r){return t.SmartIndenter.nodeWillIndentChild(n,r,!0)?e:0}}function S(t,r,i,s){for(var o=0,a=t;o<a.length;o++){var l=a[o];if(e.isComment(l.kind)&&e.rangeContainsRange(n,l))C(l,d.getLineAndCharacterOfPosition(l.pos),r,i,s)}}function C(e,t,r,i,s){var o;u(e)||(h?o=function(e,t,n,r,i,s,o,c){y.updateContext(r,s,e,n,o);var u,p,h=l.getRulesMap().GetRule(y);h?(!function(e,t,n,r,i){switch(e.Operation.Action){case 1:return;case 8:t.end!==r.pos&&O(t.end,r.pos-t.end);break;case 4:if(1!==e.Flag&&n!==i)return;1!==i-n&&R(t.end,r.pos-t.end,a.newLineCharacter);break;case 2:if(1!==e.Flag&&n!==i)return;1===r.pos-t.end&&32===d.text.charCodeAt(t.end)||R(t.end,r.pos-t.end," ")}}(h,r,i,e,t),10&h.Operation.Action&&t!==i?(p=!1,n.getStart(d)===e.pos&&c.recomputeIndentation(!1)):4&h.Operation.Action&&t===i&&(p=!0,n.getStart(d)===e.pos&&c.recomputeIndentation(!0)),u=!(8&h.Operation.Action)&&1!==h.Flag):u=!0;t!==i&&u&&w(i,t,r);return p}(e,t.line,r,h,m,f,i,s):w(d.getLineAndCharacterOfPosition(n.pos).line,t.line));return h=e,f=r,m=t.line,o}function I(t,n,r){var i=p(n,a);if(r)R(t,0,i);else{var s=d.getLineAndCharacterOfPosition(t),o=e.getStartPositionOfLine(s.line,d);(n!==function(e,t){for(var n=0,r=0;r<t;r++)9===d.text.charCodeAt(e+r)?n+=a.tabSize-n%a.tabSize:n++;return n}(o,s.character)||function(e,t){return e!==d.text.substr(t,e.length)}(i,o))&&R(o,s.character,i)}}function A(n,r,i){var s,o=d.getLineAndCharacterOfPosition(n.pos).line,l=d.getLineAndCharacterOfPosition(n.end).line;if(o!==l){s=[];for(var c=n.pos,u=o;u<l;u++){var h=e.getEndLinePosition(u,d);s.push({pos:c,end:h}),c=e.getStartPositionOfLine(u+1,d)}s.push({pos:c,end:n.end});var f=e.getStartPositionOfLine(o,d),m=t.SmartIndenter.findFirstNonWhitespaceCharacterAndColumn(f,s[0].pos,d,a);if(r!==m.column){var _=0;i&&(_=1,o++);for(var g=r-m.column,y=_;y<s.length;y++,o++){var b=e.getStartPositionOfLine(o,d),v=0===y?m:t.SmartIndenter.findFirstNonWhitespaceCharacterAndColumn(s[y].pos,s[y].end,d,a),T=v.column+g;if(T>0){var k=p(T,a);R(b,v.character,k)}else O(b,v.character)}}}else i||I(n.pos,r,!1)}function w(t,n,r){for(var i=t;i<n;i++){var s=e.getStartPositionOfLine(i,d),o=e.getEndLinePosition(i,d);if(!(r&&(e.isComment(r.kind)||e.isStringOrRegularExpressionOrTemplateLiteral(r.kind))&&r.pos<=o&&r.end>o)){var a=N(s,o);-1!==a&&(e.Debug.assert(a===s||!e.isWhiteSpaceSingleLine(d.text.charCodeAt(a-1))),O(a,o+1-a))}}}function N(t,n){for(var r=n;r>=t&&e.isWhiteSpaceSingleLine(d.text.charCodeAt(r));)r--;return r!==n?r+1:-1}function D(t,n,r){return{span:e.createTextSpan(t,n),newText:r}}function O(e,t){t&&b.push(D(e,t,""))}function R(e,t,n){(t||n)&&b.push(D(e,t,n))}}function p(e,t){if((!r||r.tabSize!==t.tabSize||r.indentSize!==t.indentSize)&&(r={tabSize:t.tabSize,indentSize:t.indentSize},i=s=void 0),t.convertTabsToSpaces){var n=void 0,o=Math.floor(e/t.indentSize),a=e%t.indentSize;return s||(s=[]),void 0===s[o]?(n=d(" ",t.indentSize*o),s[o]=n):n=s[o],a?n+d(" ",a):n}var l=Math.floor(e/t.tabSize),c=e-l*t.tabSize,u=void 0;return i||(i=[]),void 0===i[l]?i[l]=u=d("\t",l):u=i[l],c?u+d(" ",c):u;function d(e,t){for(var n="",r=0;r<t;r++)n+=e;return n}}!function(e){e[e.Unknown=-1]="Unknown"}(n||(n={})),t.formatOnEnter=function(t,n,r,i){var s=n.getLineAndCharacterOfPosition(t).line;if(0===s)return[];for(var o=e.getEndLinePosition(s,n);e.isWhiteSpaceSingleLine(n.text.charCodeAt(o));)o--;return e.isLineBreak(n.text.charCodeAt(o))&&o--,u({pos:e.getStartPositionOfLine(s-1,n),end:o+1},n,i,r,2)},t.formatOnSemicolon=function(e,t,n,r){return c(a(o(e,25,t)),t,r,n,3)},t.formatOnOpeningCurly=function(t,n,r,i){var s=o(t,17,n);if(!s)return[];var l=a(s.parent);return u({pos:e.getLineStartPositionForPosition(l.getStart(n),n),end:t},n,i,r,4)},t.formatOnClosingCurly=function(e,t,n,r){return c(a(o(e,18,t)),t,r,n,5)},t.formatDocument=function(e,t,n){return u({pos:0,end:e.text.length},e,n,t,0)},t.formatSelection=function(t,n,r,i,s){return u({pos:e.getLineStartPositionForPosition(t,r),end:n},r,s,i,1)},t.formatNodeGivenIndentation=function(e,n,r,i,s,o){var a={pos:0,end:n.text.length};return t.getFormattingScanner(n.text,r,a.pos,a.end,(function(t){return d(a,e,i,s,t,o.getFormatOptions(),o,1,(function(e){return!1}),n)}))},t.getRangeOfEnclosingComment=function(t,n,r,i,s,o){if(void 0===s&&(s=e.getTokenAtPosition(t,n,!1)),!(s.getStart(t)<=n&&n<s.getEnd())){void 0===i&&(i=e.findPrecedingToken(n,t));var a=i&&e.getTrailingCommentRanges(t.text,i.end),l=e.getLeadingCommentRangesOfNode(s,t),c=a&&l?a.concat(l):a||l;if(c)for(var u=0,d=c;u<d.length;u++){var p=d[u];if(p.pos<n&&n<p.end||n===p.end&&(2===p.kind||n===t.getFullWidth()))return 3!==p.kind&&r||o&&!o(p)?void 0:p}}},t.getIndentationString=p}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){!function(n){var r,i;function s(e){return e.baseIndentSize||0}function o(e,t,n,r,i,o){for(var c,u=e.parent;u;){var h=!0;if(n){var f=e.getStart(i);h=f<n.pos||f>n.end}if(h)if(-1!==(y=m(e,i,o)))return y+r;var g=(c=a(u,e,i)).line===t.line||p(u,e,t.line,i);if(h){var y;if(-1!==(y=l(e,u,t,g,i,o)))return y+r;if(-1!==(y=_(e,i,o)))return y+r}k(u,e)&&!g&&(r+=o.indentSize);var b=d(u,e,t.line,i);u=(e=u).parent,t=b?i.getLineAndCharacterOfPosition(e.getStart()):c}return r+s(o)}function a(e,t,n){var r=f(t,n),i=r?r.pos:e.getStart(n);return n.getLineAndCharacterOfPosition(i)}function l(t,n,r,i,s,o){return(e.isDeclaration(t)||e.isStatementButNotDeclaration(t))&&(265===n.kind||!i)?y(r,s,o):-1}function c(t,n,r,i){var s=e.findNextToken(t,n);return s?17===s.kind?1:18===s.kind&&r===u(s,i).line?2:0:0}function u(e,t){return t.getLineAndCharacterOfPosition(e.getStart(t))}function d(t,n,r,i){if(!e.isCallExpression(t)||!e.contains(t.arguments,n))return!1;var s=t.expression.getEnd();return e.getLineAndCharacterOfPosition(i,s).line===r}function p(t,n,r,i){if(211===t.kind&&t.elseStatement===n){var s=e.findChildOfKind(t,82,i);return e.Debug.assert(void 0!==s),u(s,i).line===r}return!1}function h(t,n,r){return t&&e.rangeContainsStartEnd(t,n,r)?t:void 0}function f(e,t){if(e.parent)switch(e.parent.kind){case 159:return h(e.parent.typeArguments,e.getStart(t),e.getEnd());case 178:return e.parent.properties;case 177:return e.parent.elements;case 228:case 186:case 187:case 151:case 150:case 155:case 152:case 161:case 156:var n=e.getStart(t);return h(e.parent.typeParameters,n,e.getEnd())||h(e.parent.parameters,n,e.getEnd());case 229:return h(e.parent.typeParameters,e.getStart(t),e.getEnd());case 182:case 181:n=e.getStart(t);return h(e.parent.typeArguments,n,e.getEnd())||h(e.parent.arguments,n,e.getEnd());case 227:return h(e.parent.declarations,e.getStart(t),e.getEnd());case 241:case 245:return h(e.parent.elements,e.getStart(t),e.getEnd())}}function m(t,n,r){var i,s,o=f(t,n);return o?(i=o,-1!==(s=e.indexOf(i,t))?g(i,s,n,r):-1):-1}function _(t,n,r){if(20===t.kind)return-1;if(t.parent&&e.isCallOrNewExpression(t.parent)&&t.parent.expression!==t){var i=t.parent.expression,s=function(e){for(;;)switch(e.kind){case 181:case 182:case 179:case 180:e=e.expression;break;default:return e}}(i);if(i===s)return-1;var o=n.getLineAndCharacterOfPosition(i.end),a=n.getLineAndCharacterOfPosition(s.end);return o.line===a.line?-1:y(o,n,r)}return-1}function g(t,n,r,i){e.Debug.assert(n>=0&&n<t.length);for(var s=u(t[n],r),o=n-1;o>=0;o--)if(26!==t[o].kind){if(r.getLineAndCharacterOfPosition(t[o].end).line!==s.line)return y(s,r,i);s=u(t[o],r)}return-1}function y(e,t,n){var r=t.getPositionOfLineAndCharacter(e.line,0);return v(r,r+e.character,t,n)}function b(t,n,r,i){for(var s=0,o=0,a=t;a<n;a++){var l=r.text.charCodeAt(a);if(!e.isWhiteSpaceSingleLine(l))break;9===l?o+=i.tabSize+o%i.tabSize:o++,s++}return{column:o,character:s}}function v(e,t,n,r){return b(e,t,n,r).column}function T(e,t,n){var r=t?t.kind:0;switch(e.kind){case 212:case 213:case 215:case 216:case 214:case 211:case 228:case 186:case 151:case 187:case 152:case 153:case 154:return 207!==r;case 244:return 245!==r;case 238:return 239!==r||t.namedBindings&&241!==t.namedBindings.kind;case 249:return 252!==r}return n}function k(e,t){return function(e){switch(e){case 210:case 229:case 199:case 230:case 232:case 231:case 177:case 207:case 234:case 178:case 163:case 172:case 165:case 235:case 258:case 257:case 185:case 179:case 181:case 182:case 208:case 226:case 243:case 219:case 195:case 175:case 174:case 251:case 250:case 256:case 150:case 155:case 156:case 146:case 160:case 161:case 168:case 183:case 191:case 245:case 241:case 246:case 242:case 261:case 149:return!0}return!1}(e.kind)||T(e,t,!1)}!function(e){e[e.Unknown=-1]="Unknown"}(r||(r={})),n.getIndentation=function(r,i,a,l){if(void 0===l&&(l=!1),r>i.text.length)return s(a);if(a.indentStyle===e.IndentStyle.None)return 0;var d=e.findPrecedingToken(r,i),p=t.getRangeOfEnclosingComment(i,r,!0,d||null);if(p){var h=e.getLineAndCharacterOfPosition(i,r).line-1,f=e.getLineAndCharacterOfPosition(i,p.pos).line;if(e.Debug.assert(f>=0),h<=f)return v(e.getStartPositionOfLine(f,i),r,i,a);var y=e.getStartPositionOfLine(h,i),T=b(y,r,i,a),E=T.column,x=T.character;return 0===E?E:42===i.text.charCodeAt(y+x)?E-1:E}if(!d)return s(a);if(e.isStringOrRegularExpressionOrTemplateLiteral(d.kind)&&d.getStart(i)<=r&&r<d.end)return 0;var S,C=i.getLineAndCharacterOfPosition(r).line;if(a.indentStyle===e.IndentStyle.Block){for(var I=r;I>0;){var A=i.text.charCodeAt(I);if(!e.isWhiteSpaceLike(A))break;I--}var w=e.getLineStartPositionForPosition(I,i);return n.findFirstNonWhitespaceColumn(w,I,i,a)}if(26===d.kind&&194!==d.parent.kind&&-1!==(L=function(t,n,r){var i=e.findListItemInfo(t);return i&&i.listItemIndex>0?g(i.list.getChildren(),i.listItemIndex-1,n,r):-1}(d,i,a)))return L;for(var N,D,O=d;O;){if(e.positionBelongsToNode(O,r,i)&&k(O,S)){N=u(O,i);var R=c(d,O,C,i);D=0!==R?l&&2===R?a.indentSize:0:C!==N.line?a.indentSize:0;break}var L;if(-1!==(L=m(O,i,a)))return L;if(-1!==(L=_(O,i,a)))return L+a.indentSize;S=O,O=O.parent}return O?o(O,N,void 0,D,i,a):s(a)},n.getIndentationForNode=function(e,t,n,r){var i=n.getLineAndCharacterOfPosition(e.getStart(n));return o(e,i,t,0,n,r)},n.getBaseIndentation=s,function(e){e[e.Unknown=0]="Unknown",e[e.OpenBrace=1]="OpenBrace",e[e.CloseBrace=2]="CloseBrace"}(i||(i={})),n.isArgumentAndStartLineOverlapsExpressionBeingCalled=d,n.childStartsOnTheSameLineWithElseInIfStatement=p,n.getContainingList=f,n.findFirstNonWhitespaceCharacterAndColumn=b,n.findFirstNonWhitespaceColumn=v,n.nodeWillIndentChild=T,n.shouldIndentChildNode=k}(t.SmartIndenter||(t.SmartIndenter={}))}(e.formatting||(e.formatting={}))}(ts||(ts={})),function(e){!function(t){function n(t){var n=t.__pos;return e.Debug.assert("number"==typeof n),n}function r(t,n){e.Debug.assert("number"==typeof n),t.__pos=n}function i(t){var n=t.__end;return e.Debug.assert("number"==typeof n),n}function s(t,n){e.Debug.assert("number"==typeof n),t.__end=n}var o,a;function l(t,n){return e.skipTrivia(t,n,!1,!0)}function c(t,n,r,i){if(r.useNonAdjustedStartPosition)return n.getFullStart();var s=n.getFullStart(),a=n.getStart(t);if(s===a)return a;var c=e.getLineStartPositionForPosition(s,t);if(e.getLineStartPositionForPosition(a,t)===c)return i===o.Start?a:s;var u=s>0?1:0,d=e.getStartPositionOfLine(e.getLineOfLocalPosition(t,c)+u,t);return d=l(t.text,d),e.getStartPositionOfLine(e.getLineOfLocalPosition(t,d),t)}function u(t,n,r){if(r.useNonAdjustedEndPosition||e.isExpression(n))return n.getEnd();var i=n.getEnd(),s=e.skipTrivia(t.text,i,!0);return s!==i&&e.isLineBreak(t.text.charCodeAt(s-1))?s:i}function d(e,t){return t&&e.parent&&(26===t.kind||25===t.kind&&178===e.parent.kind)}!function(e){e[e.FullStart=0]="FullStart",e[e.Start=1]="Start"}(o=t.Position||(t.Position={})),function(e){e[e.Remove=0]="Remove",e[e.ReplaceWithSingleNode=1]="ReplaceWithSingleNode",e[e.ReplaceWithMultipleNodes=2]="ReplaceWithMultipleNodes"}(a||(a={})),t.getSeparatorCharacter=function(t){return e.tokenToString(t.kind)},t.getAdjustedStartPosition=c,t.getAdjustedEndPosition=u;var p=function(){function t(t,n,r){this.newLine=t,this.rulesProvider=n,this.validator=r,this.changes=[],this.newLineCharacter=e.getNewLineCharacter({newLine:t})}return t.fromContext=function(e){return new t("\n"===e.newLineCharacter?1:0,e.rulesProvider)},t.with=function(e,n){var r=t.fromContext(e);return n(r),r.getChanges()},t.prototype.deleteRange=function(e,t){return this.changes.push({kind:a.Remove,sourceFile:e,range:t}),this},t.prototype.deleteNode=function(e,t,n){void 0===n&&(n={});var r=c(e,t,n,o.FullStart),i=u(e,t,n);return this.changes.push({kind:a.Remove,sourceFile:e,range:{pos:r,end:i}}),this},t.prototype.deleteNodeRange=function(e,t,n,r){void 0===r&&(r={});var i=c(e,t,r,o.FullStart),s=u(e,n,r);return this.changes.push({kind:a.Remove,sourceFile:e,range:{pos:i,end:s}}),this},t.prototype.deleteNodeInList=function(t,n){var r=e.formatting.SmartIndenter.getContainingList(n,t);if(!r)return e.Debug.fail("node is not a list element"),this;var i=e.indexOfNode(r,n);if(i<0)return this;if(1===r.length)return this.deleteNode(t,n),this;if(i!==r.length-1){var s=e.getTokenAtPosition(t,n.end,!1);if(s&&d(n,s)){var a=e.skipTrivia(t.text,c(t,n,{},o.FullStart),!1,!0),l=r[i+1],u=e.skipTrivia(t.text,c(t,l,{},o.FullStart),!1,!0);this.deleteRange(t,{pos:a,end:u})}}else{var p=e.getTokenAtPosition(t,r[i-1].end,!1);p&&d(n,p)&&this.deleteNodeRange(t,p,n)}return this},t.prototype.replaceRange=function(e,t,n,r){return void 0===r&&(r={}),this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:e,range:t,options:r,node:n}),this},t.prototype.replaceNode=function(e,t,n,r){void 0===r&&(r={});var i=c(e,t,r,o.Start),s=u(e,t,r);return this.replaceWithSingle(e,i,s,n,r)},t.prototype.replaceNodeRange=function(e,t,n,r,i){void 0===i&&(i={});var s=c(e,t,i,o.Start),a=u(e,n,i);return this.replaceWithSingle(e,s,a,r,i)},t.prototype.replaceWithSingle=function(e,t,n,r,i){return this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:e,options:i,node:r,range:{pos:t,end:n}}),this},t.prototype.replaceWithMultiple=function(e,t,n,r,i){return this.changes.push({kind:a.ReplaceWithMultipleNodes,sourceFile:e,options:i,nodes:r,range:{pos:t,end:n}}),this},t.prototype.replaceNodeWithNodes=function(e,t,n,r){var i=c(e,t,r,o.Start),s=u(e,t,r);return this.replaceWithMultiple(e,i,s,n,r)},t.prototype.replaceNodesWithNodes=function(t,n,r,i){var s=c(t,n[0],i,o.Start),a=u(t,e.lastOrUndefined(n),i);return this.replaceWithMultiple(t,s,a,r,i)},t.prototype.replaceRangeWithNodes=function(e,t,n,r){return this.replaceWithMultiple(e,t.pos,t.end,n,r)},t.prototype.replaceNodeRangeWithNodes=function(e,t,n,r,i){var s=c(e,t,i,o.Start),a=u(e,n,i);return this.replaceWithMultiple(e,s,a,r,i)},t.prototype.insertNodeAt=function(e,t,n,r){return void 0===r&&(r={}),this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:e,options:r,node:n,range:{pos:t,end:t}}),this},t.prototype.insertNodeBefore=function(e,t,n,r){void 0===r&&(r={});var i=c(e,t,r,o.Start);return this.replaceWithSingle(e,i,i,n,r)},t.prototype.insertNodeAfter=function(t,n,r,i){void 0===i&&(i={}),(e.isStatementButNotDeclaration(n)||149===n.kind||148===n.kind||150===n.kind)&&59!==t.text.charCodeAt(n.end-1)&&this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,options:{},range:{pos:n.end,end:n.end},node:e.createToken(25)});var s=u(t,n,i);return this.replaceWithSingle(t,s,s,r,i)},t.prototype.insertNodeInListAfter=function(t,n,r){var i=e.formatting.SmartIndenter.getContainingList(n,t);if(!i)return e.Debug.fail("node is not a list element"),this;var s=e.indexOfNode(i,n);if(s<0)return this;var o=n.getEnd();if(s!==i.length-1){var c=e.getTokenAtPosition(t,n.end,!1);if(c&&d(n,c)){var u=e.getLineAndCharacterOfPosition(t,l(t.text,i[s+1].getFullStart())),p=e.getLineAndCharacterOfPosition(t,c.end),h=void 0,f=void 0;p.line===u.line?(f=c.end,h=function(e){for(var t="",n=0;n<e;n++)t+=" ";return t}(u.character-p.character)):f=e.getStartPositionOfLine(u.line,t),this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:f,end:i[s+1].getStart(t)},node:r,options:{prefix:h,suffix:""+e.tokenToString(c.kind)+t.text.substring(c.end,i[s+1].getStart(t))}})}}else{var m=n.getStart(t),_=e.getLineStartPositionForPosition(m,t),g=void 0,y=!1;if(1===i.length)g=26;else{var b=e.findPrecedingToken(n.pos,t);g=d(n,b)?b.kind:26,y=e.getLineStartPositionForPosition(i[s-1].getStart(t),t)!==_}if(function(t,n){for(var r=n;r<t.length;){var i=t.charCodeAt(r);if(!e.isWhiteSpaceSingleLine(i))return 47===i;r++}return!1}(t.text,n.end)&&(y=!0),y){this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:o,end:o},node:e.createToken(g),options:{}});var v=e.formatting.SmartIndenter.findFirstNonWhitespaceColumn(_,m,t,this.rulesProvider.getFormatOptions()),T=e.skipTrivia(t.text,o,!0,!1);T!==o&&e.isLineBreak(t.text.charCodeAt(T-1))&&T--,this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:T,end:T},node:r,options:{indentation:v,prefix:this.newLineCharacter}})}else this.changes.push({kind:a.ReplaceWithSingleNode,sourceFile:t,range:{pos:o,end:o},node:r,options:{prefix:e.tokenToString(g)+" "}})}return this},t.prototype.getChanges=function(){for(var n=this,r=e.createMap(),i=0,s=this.changes;i<s.length;i++){var o=s[i],a=r.get(o.sourceFile.path);a||r.set(o.sourceFile.path,a=[]),a.push(o)}var l=[];return r.forEach((function(e){for(var r=e[0].sourceFile,i={fileName:r.fileName,textChanges:[]},s=0,o=t.normalize(e);s<o.length;s++){var a=o[s];i.textChanges.push({span:n.computeSpan(a,r),newText:n.computeNewText(a,r)})}l.push(i)})),l},t.prototype.computeSpan=function(t,n){return e.createTextSpanFromBounds(t.range.pos,t.range.end)},t.prototype.computeNewText=function(t,n){var r=this;if(t.kind===a.Remove)return"";var i,s=t.options||{},o=t.range.pos,l=e.getLineStartPositionForPosition(o,n)===o;t.kind===a.ReplaceWithMultipleNodes?i=t.nodes.map((function(e){return r.getFormattedTextOfNode(e,n,o,s)})).join(t.options.nodeSeparator):(e.Debug.assert(t.kind===a.ReplaceWithSingleNode,"change.kind === ReplaceWithSingleNode"),i=this.getFormattedTextOfNode(t.node,n,o,s));return i=l||void 0!==s.indentation?i:i.replace(/^\s+/,""),(s.prefix||"")+i+(s.suffix||"")},t.prototype.getFormattedTextOfNode=function(t,n,r,i){var s=function(t,n,r){var i={newLine:r,target:n&&n.languageVersion},s=new _(e.getNewLineCharacter(i));return e.createPrinter(i,s).writeNode(4,t,n,s),{text:s.getText(),node:f(t)}}(t,n,this.newLine);this.validator&&this.validator(s);var o=this.rulesProvider.getFormatOptions(),a=e.getLineStartPositionForPosition(r,n)===r;return function(t,n,r,i,s){var o=e.computeLineStarts(t.text),a={text:t.text,lineMap:o,getLineAndCharacterOfPosition:function(t){return e.computeLineAndCharacterOfPosition(o,t)}},l=e.formatting.formatNodeGivenIndentation(t.node,a,n.languageVariant,r,i,s);return h(t.text,l)}(s,n,void 0!==i.indentation?i.indentation:!1!==i.useIndentationFromFile?e.formatting.SmartIndenter.getIndentation(r,n,o,a||i.prefix===this.newLineCharacter):0,void 0!==i.delta?i.delta:e.formatting.SmartIndenter.shouldIndentChildNode(t)&&o.indentSize||0,this.rulesProvider)},t.normalize=function(t){for(var n=e.stableSort(t,(function(e,t){return e.range.pos-t.range.pos})),r=0;r<n.length-2;r++)e.Debug.assert(n[r].range.end<=n[r+1].range.pos);return n},t}();function h(t,n){for(var r=n.length-1;r>=0;r--){var i=n[r];t=""+t.substring(0,i.span.start)+i.newText+t.substring(e.textSpanEnd(i.span))}return t}function f(t){var r=e.visitEachChild(t,f,e.nullTransformationContext,m,f),s=e.nodeIsSynthesized(r)?r:Object.create(r);return s.pos=n(t),s.end=i(t),s}function m(t,r,s,o,a){var l=e.visitNodes(t,r,s,o,a);if(!l)return l;var c=l===t?e.createNodeArray(l.slice(0)):l;return c.pos=n(t),c.end=i(t),c}t.ChangeTracker=p,t.applyChanges=h;var _=function(){function t(t){var n=this;this.lastNonTriviaPosition=0,this.writer=e.createTextWriter(t),this.onEmitNode=function(e,t,i){t&&r(t,n.lastNonTriviaPosition),i(e,t),t&&s(t,n.lastNonTriviaPosition)},this.onBeforeEmitNodeArray=function(e){e&&r(e,n.lastNonTriviaPosition)},this.onAfterEmitNodeArray=function(e){e&&s(e,n.lastNonTriviaPosition)},this.onBeforeEmitToken=function(e){e&&r(e,n.lastNonTriviaPosition)},this.onAfterEmitToken=function(e){e&&s(e,n.lastNonTriviaPosition)}}return t.prototype.setLastNonTriviaPosition=function(t,n){if(n||!function(t){return e.skipTrivia(t,0)===t.length}(t)){this.lastNonTriviaPosition=this.writer.getTextPos();for(var r=0;e.isWhiteSpaceLike(t.charCodeAt(t.length-r-1));)r++;this.lastNonTriviaPosition-=r}},t.prototype.write=function(e){this.writer.write(e),this.setLastNonTriviaPosition(e,!1)},t.prototype.writeTextOfNode=function(e,t){this.writer.writeTextOfNode(e,t)},t.prototype.writeLine=function(){this.writer.writeLine()},t.prototype.increaseIndent=function(){this.writer.increaseIndent()},t.prototype.decreaseIndent=function(){this.writer.decreaseIndent()},t.prototype.getText=function(){return this.writer.getText()},t.prototype.rawWrite=function(e){this.writer.rawWrite(e),this.setLastNonTriviaPosition(e,!1)},t.prototype.writeLiteral=function(e){this.writer.writeLiteral(e),this.setLastNonTriviaPosition(e,!0)},t.prototype.getTextPos=function(){return this.writer.getTextPos()},t.prototype.getLine=function(){return this.writer.getLine()},t.prototype.getColumn=function(){return this.writer.getColumn()},t.prototype.getIndent=function(){return this.writer.getIndent()},t.prototype.isAtStartOfLine=function(){return this.writer.isAtStartOfLine()},t.prototype.reset=function(){this.writer.reset(),this.lastNonTriviaPosition=0},t}()}(e.textChanges||(e.textChanges={}))}(ts||(ts={})),function(e){!function(t){var n=[];t.registerCodeFix=function(t){e.forEach(t.errorCodes,(function(e){var r=n[e];r||(r=[],n[e]=r),r.push(t)}))},t.getSupportedErrorCodes=function(){return Object.keys(n)},t.getFixes=function(t){var r=n[t.errorCode],i=[];return e.forEach(r,(function(e){var n=e.getCodeActions(t);if(n&&n.length>0)for(var r=0,s=n;r<s.length;r++){var o=s[r];void 0===o?t.host.log("Action for error code "+t.errorCode+" added an invalid action entry; please log a bug"):i.push(o)}})),i}}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){var t,n;t=e.refactor||(e.refactor={}),n=e.createMap(),t.registerRefactor=function(e){n.set(e.name,e)},t.getApplicableRefactors=function(t){return e.flatMapIter(n.values(),(function(e){return t.cancellationToken&&t.cancellationToken.isCancellationRequested()?void 0:e.getAvailableActions(t)}))},t.getEditsForRefactor=function(e,t,r){var i=n.get(t);return i&&i.getEditsForAction(e,r)},e.getRefactorContextLength=function(e){return void 0===e.endPosition?0:e.endPosition-e.startPosition}}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics._0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0.code],getCodeActions:function(t){var n=t.sourceFile,r=e.getTokenAtPosition(n,t.span.start,!1),i=e.getAncestor(r,147);e.Debug.assert(!!i,"Expected position to be owned by a decorator.");var s=e.createCall(i.expression,void 0,void 0),o=e.textChanges.ChangeTracker.fromContext(t);return o.replaceNode(n,i.expression,s),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Call_decorator_expression),changes:o.getChanges()}]}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1.code],getCodeActions:function(t){var n=t.sourceFile,r=e.getTokenAtPosition(n,t.span.start,!1),i=e.getAncestor(r,143);if(e.Debug.assert(!!i,"Expected position to be owned by a qualified name."),e.isIdentifier(i.left)){var s=i.left.getText(n),o=i.right.getText(n),a=e.createIndexedAccessTypeNode(e.createTypeReferenceNode(i.left,void 0),e.createLiteralTypeNode(e.createLiteral(o))),l=e.textChanges.ChangeTracker.fromContext(t);return l.replaceNode(n,i,a),[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Rewrite_as_the_indexed_access_type_0),[s+'["'+o+'"]']),changes:l.getChanges()}]}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Class_0_incorrectly_implements_interface_1.code],getCodeActions:function(n){var r=n.sourceFile,i=n.span.start,s=e.getTokenAtPosition(r,i,!1),o=n.program.getTypeChecker(),a=e.getContainingClass(s);if(!a)return;for(var l=e.getOpenBraceOfClassLike(a,r),c=o.getTypeAtLocation(a),u=e.getClassImplementsHeritageClauseElements(a),d=!!o.getIndexTypeOfType(c,1),p=!!o.getIndexTypeOfType(c,0),h=[],f=0,m=u;f<m.length;f++){var _=m[f],g=o.getTypeAtLocation(_),y=o.getPropertiesOfType(g).filter((function(t){return!(8&e.getModifierFlags(t.valueDeclaration))})),b=[];T(g,1,d,b),T(g,0,p,b),b=b.concat(t.createMissingMemberNodes(a,y,o));var v=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Implement_interface_0),[_.getText()]);b.length>0&&k(h,b,v)}return h;function T(e,t,n,r){if(!n){var i=o.getIndexInfoOfType(e,t);if(i){var s=o.indexInfoToIndexSignatureDeclaration(i,t,a);r.push(s)}}}function k(e,r,i){e.push({description:i,changes:t.newNodesToChanges(r,l,n)})}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Property_0_does_not_exist_on_type_1.code,e.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2.code],getCodeActions:function(n){var r=n.sourceFile,i=n.span.start,s=e.getTokenAtPosition(r,i,!1);if(71!==s.kind)return;if(!e.isPropertyAccessExpression(s.parent))return;var o,a=s.getText(r),l=!1;if(99===s.parent.expression.kind){var c=e.getThisContainer(s,!1);if(!e.isClassElement(c))return;o=c.parent,l=o&&e.hasModifier(c,32)}else{var u=n.program.getTypeChecker(),d=s.parent.expression,p=u.getTypeAtLocation(d);if(32768&p.flags){var h=p.symbol;32&h.flags&&(o=h.declarations&&h.declarations[0],p!==u.getDeclaredTypeOfSymbol(h)&&(l=!0))}}if(!o||!e.isClassLike(o))return;var f=e.getSourceFileOfNode(o),m=e.getOpenBraceOfClassLike(o,f);return e.isInJavaScriptFile(f)?function(t,r){var i,s=_(!1);s&&(i=[s]);if(r){if(199===t.kind)return i;var o=t.name.getText(),l=e.createStatement(e.createAssignment(e.createPropertyAccess(e.createIdentifier(o),a),e.createIdentifier("undefined"))),c=e.textChanges.ChangeTracker.fromContext(n);c.insertNodeAfter(f,t,l,{prefix:n.newLineCharacter,suffix:n.newLineCharacter});var u={description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Initialize_static_property_0),[a]),changes:c.getChanges()};return(i||(i=[])).push(u),i}var d=e.getFirstConstructorWithBody(t);if(!d)return i;var p=e.createStatement(e.createAssignment(e.createPropertyAccess(e.createThis(),a),e.createIdentifier("undefined"))),h=e.textChanges.ChangeTracker.fromContext(n);h.insertNodeBefore(f,d.body.getLastToken(),p,{suffix:n.newLineCharacter});var m={description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Initialize_property_0_in_the_constructor),[a]),changes:h.getChanges()};return(i||(i=[])).push(m),i}(o,l):function(t,r){var i,o,l=_(!0);l&&(i=[l]);if(194===s.parent.parent.kind){var c=s.parent.parent,u=s.parent===c.left?c.right:c.left,d=n.program.getTypeChecker(),p=d.getWidenedType(d.getBaseTypeOfLiteralType(d.getTypeAtLocation(u)));o=d.typeToTypeNode(p,t)}o=o||e.createKeywordTypeNode(119);var h=e.createProperty(void 0,r?[e.createToken(115)]:void 0,a,void 0,o,void 0),g=e.textChanges.ChangeTracker.fromContext(n);g.insertNodeAfter(f,m,h,{suffix:n.newLineCharacter});var y=r?e.Diagnostics.Declare_static_property_0:e.Diagnostics.Declare_property_0;if(i=e.append(i,{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(y),[a]),changes:g.getChanges()}),!r){var b=e.createKeywordTypeNode(136),v=e.createParameter(void 0,void 0,void 0,"x",void 0,b,void 0),T=e.createIndexSignature(void 0,void 0,[v],o),k=e.textChanges.ChangeTracker.fromContext(n);k.insertNodeAfter(f,m,T,{suffix:n.newLineCharacter}),i.push({description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Add_index_signature_for_property_0),[a]),changes:k.getChanges()})}return i}(o,l);function _(r){if(181===s.parent.parent.kind){var i=s.parent.parent,o=t.createMethodFromCallExpression(i,a,r,l),c=e.textChanges.ChangeTracker.fromContext(n);c.insertNodeAfter(f,m,o,{suffix:n.newLineCharacter});var u=l?e.Diagnostics.Declare_static_method_0:e.Diagnostics.Declare_method_0;return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(u),[a]),changes:c.getChanges()}}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2.code,e.Diagnostics.Cannot_find_name_0_Did_you_mean_1.code],getCodeActions:function(t){var n,r=t.sourceFile,i=e.getTokenAtPosition(r,t.span.start,!1),s=t.program.getTypeChecker();if(e.isPropertyAccessExpression(i.parent)&&i.parent.name===i){e.Debug.assert(71===i.kind);var o=s.getTypeAtLocation(i.parent.expression);n=s.getSuggestionForNonexistentProperty(i,o)}else{var a=e.getMeaningFromLocation(i);n=s.getSuggestionForNonexistentSymbol(i,e.getTextOfNode(i),function(e){var t=0;4&e&&(t|=1920);2&e&&(t|=793064);1&e&&(t|=107455);return t}(a))}if(n)return[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Change_spelling_to_0),[n]),changes:[{fileName:r.fileName,textChanges:[{span:{start:i.getStart(),length:i.getWidth()},newText:n}]}]}]}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(t,n){var r=e.getPackageName(n).packageName;if(t.isKnownTypesPackageName(r)){var i=e.getTypesPackageName(r);return{description:"Install '"+i+"'",changes:[],commands:[{type:"install package",packageName:i}]}}}t.registerCodeFix({errorCodes:[e.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type.code],getCodeActions:function(t){var r=t.sourceFile,i=t.span.start,s=e.getTokenAtPosition(r,i,!1);if(!e.isStringLiteral(s))throw e.Debug.fail();var o=n(t.host,s.text);return o&&[o]}}),t.tryGetCodeActionForInstallPackageTypes=n}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(n){var i=n.sourceFile,s=n.span.start,o=e.getTokenAtPosition(i,s,!1),a=n.program.getTypeChecker();if(e.isClassLike(o.parent)){var l=o.parent,c=e.getClassExtendsHeritageClauseElement(l),u=a.getTypeAtLocation(c),d=a.getPropertiesOfType(u).filter(r),p=t.createMissingMemberNodes(l,d,a),h=t.newNodesToChanges(p,e.getOpenBraceOfClassLike(l,i),n);if(h&&h.length>0)return[{description:e.getLocaleSpecificMessage(e.Diagnostics.Implement_inherited_abstract_class),changes:h}]}}function r(t){var n=t.getDeclarations();e.Debug.assert(!!(n&&n.length>0));var r=e.getModifierFlags(n[0]);return!(8&r||!(128&r))}t.registerCodeFix({errorCodes:[e.Diagnostics.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2.code],getCodeActions:n}),t.registerCodeFix({errorCodes:[e.Diagnostics.Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1.code],getCodeActions:n})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class.code],getCodeActions:function(t){var n=t.sourceFile,r=e.getTokenAtPosition(n,t.span.start,!1);if(99===r.kind){var i=e.getContainingFunction(r),s=function t(n){if(210===n.kind&&e.isSuperCall(n.expression))return n;if(e.isFunctionLike(n))return;return e.forEachChild(n,t)}(i.body);if(s){if(s.expression&&181===s.expression.kind)for(var o=s.expression.arguments,a=0;a<o.length;a++)if(o[a].expression===r)return;var l=e.textChanges.ChangeTracker.fromContext(t);return l.insertNodeAfter(n,e.getOpenBrace(i,n),s,{suffix:t.newLineCharacter}),l.deleteNode(n,s),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Make_super_call_the_first_statement_in_the_constructor),changes:l.getChanges()}]}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Constructors_for_derived_classes_must_contain_a_super_call.code],getCodeActions:function(t){var n=t.sourceFile,r=e.getTokenAtPosition(n,t.span.start,!1);if(123===r.kind){var i=e.textChanges.ChangeTracker.fromContext(t),s=e.createStatement(e.createCall(e.createSuper(),void 0,e.emptyArray));return i.insertNodeAfter(n,e.getOpenBrace(r.parent,n),s,{suffix:t.newLineCharacter}),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Add_missing_super_call),changes:i.getChanges()}]}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_extend_an_interface_0_Did_you_mean_implements.code],getCodeActions:function(t){var n=t.sourceFile,r=t.span.start,i=e.getTokenAtPosition(n,r,!1),s=e.getContainingClass(i);if(71===i.kind&&e.isClassLike(s)){var o=s.heritageClauses;if(o&&o.length>0){var a=o[0].getFirstToken();if(a&&85===a.kind){var l=e.textChanges.ChangeTracker.fromContext(t);l.replaceNode(n,a,e.createToken(108));for(var c=1;c<o.length;c++){var u=o[c].getFirstToken();u&&l.replaceNode(n,u,e.createToken(26))}return[{description:e.getLocaleSpecificMessage(e.Diagnostics.Change_extends_to_implements),changes:l.getChanges()}]}}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_find_name_0_Did_you_mean_the_instance_member_this_0.code],getCodeActions:function(t){var n=t.sourceFile,r=e.getTokenAtPosition(n,t.span.start,!1);if(71===r.kind){var i=e.textChanges.ChangeTracker.fromContext(t);return i.replaceNode(n,r,e.createPropertyAccess(e.createThis(),r)),[{description:e.getLocaleSpecificMessage(e.Diagnostics.Add_this_to_unresolved_variable),changes:i.getChanges()}]}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){t.registerCodeFix({errorCodes:[e.Diagnostics._0_is_declared_but_its_value_is_never_read.code,e.Diagnostics.Property_0_is_declared_but_its_value_is_never_read.code],getCodeActions:function(t){var n=t.sourceFile,r=t.span.start,i=e.getTokenAtPosition(n,r,!1);switch(21===i.kind&&(i=e.getTokenAtPosition(n,r+1,!1)),i.kind){case 71:return function(t){var r=t.parent;switch(r.kind){case 226:return function(t,n){switch(n.parent.parent.kind){case 214:var r=n.parent.parent.initializer;return[1===r.declarations.length?l(r):u(n)];case 216:var i=n.parent.parent;return e.Debug.assert(227===i.initializer.kind),[p(i.initializer.declarations[0],e.createObjectLiteral()),o(t)];case 215:return[o(t)];default:var s=n.parent.parent;return 1===s.declarationList.declarations.length?[l(s)]:[u(n)]}}(t,r);case 145:var i=r.parent.typeParameters;if(1===i.length){var h=e.getTokenAtPosition(n,i.pos-1,!1),f=e.getTokenAtPosition(n,i.end,!1);return e.Debug.assert(27===h.kind),e.Debug.assert(29===f.kind),[d(h,f)]}return[u(r)];case 146:return[1===r.parent.parameters.length?l(r):u(r),o(t)];case 237:return[l(e.getAncestor(t,237))];case 242:var m=r.parent;return 1===m.elements.length?a(m):[u(r)];case 239:var _=r;if(_.namedBindings){var g=_.name.getStart(n);return(f=e.getTokenAtPosition(n,_.name.end,!1))&&26===f.kind?[c({pos:g,end:e.skipTrivia(n.text,f.end,!1,!0)})]:[l(_.name)]}return[l(e.getAncestor(_,238))];case 240:return a(r);default:return s()}}(i);case 149:case 240:return[l(i.parent)];default:return s()}function s(){return e.isDeclarationName(i)?[l(i.parent)]:e.isLiteralComputedPropertyDeclarationName(i)?[l(i.parent.parent)]:void 0}function o(t){var r=t.getStart(n,!1);return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Prefix_0_with_an_underscore),{0:i.getText()}),changes:[{fileName:n.path,textChanges:[{span:{start:r,length:0},newText:"_"}]}]}}function a(t){if(t.parent.name){var r=e.getTokenAtPosition(n,t.pos-1,!1);return r&&26===r.kind?[c({pos:r.getStart(),end:t.end})]:void 0}return[l(e.getAncestor(t,238))]}function l(r){return h(e.textChanges.ChangeTracker.fromContext(t).deleteNode(n,r))}function c(r){return h(e.textChanges.ChangeTracker.fromContext(t).deleteRange(n,r))}function u(r){return h(e.textChanges.ChangeTracker.fromContext(t).deleteNodeInList(n,r))}function d(r,i){return h(e.textChanges.ChangeTracker.fromContext(t).deleteNodeRange(n,r,i))}function p(r,i){return h(e.textChanges.ChangeTracker.fromContext(t).replaceNode(n,r,i))}function h(t){return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Remove_declaration_for_Colon_0),{0:i.getText()}),changes:t.getChanges()}}}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,r,i){return{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Change_0_to_1),[r,i]),changes:[{fileName:n,textChanges:[{span:{start:t.getStart(),length:t.getWidth()},newText:i}]}]}}t.registerCodeFix({errorCodes:[e.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments.code],getCodeActions:function(t){var r=t.sourceFile,i=e.getTokenAtPosition(r,t.span.start,!1),s=e.findAncestor(i,(function(e){return 202===e.kind||155===e.kind||156===e.kind||228===e.kind||153===e.kind||157===e.kind||172===e.kind||151===e.kind||150===e.kind||146===e.kind||149===e.kind||148===e.kind||154===e.kind||231===e.kind||184===e.kind||226===e.kind}));if(!s)return;var o=t.program.getTypeChecker(),a=s.type;if(!a)return;var l=e.getTextOfNode(a),c=o.getTypeFromTypeNode(a),u=[n(a,r.fileName,l,o.typeToString(c,void 0,8))];if(270===a.kind){var d=o.typeToString(o.getNullableType(c,2048),void 0,8);u.push(n(a,r.fileName,l,d))}return u}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){var n,r=e.textChanges.ChangeTracker;t.registerCodeFix({errorCodes:[e.Diagnostics.Cannot_find_name_0.code,e.Diagnostics.Cannot_find_name_0_Did_you_mean_1.code,e.Diagnostics.Cannot_find_namespace_0.code,e.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead.code],getCodeActions:function(t){var n=function(t){var n=!!t.host.useCaseSensitiveFileNames&&t.host.useCaseSensitiveFileNames(),r=t.program.getTypeChecker(),i=e.getTokenAtPosition(t.sourceFile,t.span.start,!1);return{host:t.host,newLineCharacter:t.newLineCharacter,rulesProvider:t.rulesProvider,sourceFile:t.sourceFile,checker:r,compilerOptions:t.program.getCompilerOptions(),cachedImportDeclarations:[],getCanonicalFileName:e.createGetCanonicalFileName(n),symbolName:i.getText(),symbolToken:i}}(t);return t.errorCode===e.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead.code?function(t){var n,r,i=t.checker,s=t.symbolToken,a=i.getSymbolAtLocation(s);2097152&a.flags?(n=i.getAliasedSymbol(a),r=t.symbolName):e.isJsxOpeningLikeElement(s.parent)&&s.parent.tagName===s?r=(n=i.getAliasedSymbol(i.resolveName(i.getJsxNamespace(),s.parent.tagName,107455))).name:e.Debug.fail("Either the symbol or the JSX namespace should be a UMD global if we got here");return o(n,__assign({},t,{symbolName:r,kind:2}))}(n):function(t,n,r){var s=t.sourceFile,a=t.checker,l=t.symbolName,c=t.symbolToken;e.Debug.assert("default"!==l);var u=new i,d=e.getMeaningFromLocation(c);return m(a,n,(function(n){if(n!==s.symbol){r.throwIfCancellationRequested();var i=a.tryGetMemberInModuleExports("default",n);if(i){var c=e.getLocalSymbolForExportDefault(i);if(c&&c.escapedName===l&&f(c,d)){var p=e.getUniqueSymbolId(c,a);u.addActions(p,o(n,__assign({},t,{kind:1})))}}var h=a.tryGetMemberInModuleExportsAndProperties(l,n);if(h&&f(h,d)){p=e.getUniqueSymbolId(h,a);u.addActions(p,o(n,__assign({},t,{kind:0})))}}})),u.getAllActions()}(n,t.program.getSourceFiles(),t.cancellationToken)}}),function(e){e[e.Better=0]="Better",e[e.Equal=1]="Equal",e[e.Worse=2]="Worse"}(n||(n={}));var i=function(){function t(){this.symbolIdToActionMap=[]}return t.prototype.addAction=function(e,t){var n=this.symbolIdToActionMap[e];if(n)if("CodeChange"!==t.kind){for(var r=[],i=0,s=this.symbolIdToActionMap[e];i<s.length;i++){var o=s[i];if("CodeChange"!==o.kind)switch(this.compareModuleSpecifiers(o.moduleSpecifier,t.moduleSpecifier)){case 0:if("NewImport"===t.kind)return;case 1:r.push(o);break;case 2:continue}else r.push(o)}r.push(t),this.symbolIdToActionMap[e]=r}else n.push(t);else this.symbolIdToActionMap[e]=[t]},t.prototype.addActions=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];this.addAction(e,i)}},t.prototype.getAllActions=function(){var t=[];for(var n in this.symbolIdToActionMap)t=e.concatenate(t,this.symbolIdToActionMap[n]);return t},t.prototype.compareModuleSpecifiers=function(t,n){if(t===n)return 1;if(0===n.indexOf(t))return 0;if(0===t.indexOf(n))return 2;if(e.isExternalModuleNameRelative(t)&&e.isExternalModuleNameRelative(n)){var r=new RegExp(e.directorySeparator,"g"),i=(t.match(r)||[]).length,s=(n.match(r)||[]).length;return i<s?0:i===s?1:2}return 1},t}();function s(t,n,r,i,s){return{description:e.formatMessage.apply(void 0,[void 0,t].concat(n)),changes:r,kind:i,moduleSpecifier:s}}function o(t,n){var i=function(t,n,r,i){var s=r.imports;void 0===i&&(i=[]);var o=e.getUniqueSymbolId(t,n),a=i[o];a||(a=i[o]=e.mapDefined(s,(function(r){return n.getSymbolAtLocation(r)===t?function(t){var n=t.parent;switch(n.kind){case 238:return n;case 248:return n.parent;default:return void e.Debug.assert(244===n.kind)}}(r):void 0})));return a}(t,n.checker,n.sourceFile,n.cachedImportDeclarations),o=[];if(n.symbolToken)for(var f=0,m=i;f<m.length;f++){var _=a(m[f]);_&&o.push(h(_.text,n,n.symbolToken))}return o.push(function(t,n,i){var o=e.firstDefined(i,(function(t){if(238===t.kind&&t.importClause){var i=function(t,n){var i=t.symbolName,s=t.sourceFile,o=t.kind,a=n.name,l=n.namedBindings;switch(o){case 1:return a?void 0:r.with(t,(function(t){return t.replaceNode(s,n,e.createImportClause(e.createIdentifier(i),l))}));case 0:var c=e.createImportSpecifier(void 0,e.createIdentifier(i));return l&&241===l.kind&&0!==l.elements.length?r.with(t,(function(e){return e.insertNodeInListAfter(s,l.elements[l.elements.length-1],c)})):!l||241===l.kind&&0===l.elements.length?r.with(t,(function(t){return t.replaceNode(s,n,e.createImportClause(a,e.createNamedImports([c])))})):void 0;case 2:return l?void 0:r.with(t,(function(t){return t.replaceNode(s,n,e.createImportClause(a,e.createNamespaceImport(e.createIdentifier(i))))}));default:e.Debug.assertNever(o)}}(n,t.importClause);if(i){var o=e.stripQuotes(t.moduleSpecifier.getText());return s(e.Diagnostics.Add_0_to_existing_import_declaration_from_1,[n.symbolName,o],i,"InsertingIntoExistingImport",o)}}}));if(o)return o;var a=e.firstDefined(i,p)||function(t,n,r,i,s){var o=n.valueDeclaration.getSourceFile().fileName,a=e.getDirectoryPath(t.fileName);return function(t){var n=t.valueDeclaration;if(e.isModuleDeclaration(n)&&e.isStringLiteral(n.name))return n.name.text}(n)||function(t,n,r,i){var s=e.getEffectiveTypeRoots(t,n);return s&&e.firstDefined(s,(function(t){var n=e.toPath(t,void 0,r);if(e.startsWith(i,n))return c(i.substring(n.length+1))}))}(r,s,i,o)||function(t,n,r,i,s){if(e.getEmitModuleResolutionKind(t)!==e.ModuleResolutionKind.NodeJs)return;var o=function(e){var t,n=0,r=0,i=0,s=0;!function(e){e[e.BeforeNodeModules=0]="BeforeNodeModules",e[e.NodeModules=1]="NodeModules",e[e.Scope=2]="Scope",e[e.PackageContent=3]="PackageContent"}(t||(t={}));var o=0,a=0,l=0;for(;a>=0;)switch(o=a,a=e.indexOf("/",o+1),l){case 0:e.indexOf("/node_modules/",o)===o&&(n=o,r=a,l=1);break;case 1:case 2:1===l&&"@"===e.charAt(o+1)?l=2:(i=a,l=3);break;case 3:l=e.indexOf("/node_modules/",o)===o?1:3}return s=o,l>1?{topLevelNodeModulesIndex:n,topLevelPackageNameIndex:r,packageRootIndex:i,fileNameIndex:s}:void 0}(n);if(!o)return;var a=l(n);return a=c(a),e.getPackageNameFromAtTypesDirectory(a);function l(t){var n=t.substring(0,o.packageRootIndex),s=e.combinePaths(n,"package.json");if(r.fileExists(s)){var a=JSON.parse(r.readFile(s));if(a){var l=a.typings||a.types||a.main;if(l)if(e.toPath(l,n,i)===i(t))return n}}var c=e.removeFileExtension(t);return"/index"===i(c.substring(o.fileNameIndex))?c.substring(0,o.fileNameIndex):c}function c(e){var t=e.substring(0,o.topLevelNodeModulesIndex);return 0===s.indexOf(t)?e.substring(o.topLevelPackageNameIndex+1):d(e,s,i)}}(r,o,s,i,a)||function(t,n,r){if(!t.baseUrl)return;var i=u(n,t.baseUrl,r);if(!i)return;var s=e.removeFileExtension(i);if(i=c(i),t.paths)for(var o in t.paths)for(var a=0,l=t.paths[o];a<l.length;a++){var d=l[a],p=d.indexOf("*");if(0!==p||1!==d.length)if(-1!==p){var h=d.substr(0,p),f=d.substr(p+1);if(i.length>=h.length+f.length&&e.startsWith(i,h)&&e.endsWith(i,f)){var m=i.substr(h.length,i.length-f.length);return o.replace("*",m)}}else if(d===i||d===s)return o}return i}(r,o,i)||r.rootDirs&&function(t,n,r,i){var s=l(n,t,i);if(void 0===s)return;var o=l(r,t,i),a=void 0!==o?d(s,o,i):s;return e.removeFileExtension(a)}(r.rootDirs,o,a,i)||e.removeFileExtension(d(o,a,i))}(n.sourceFile,t,n.compilerOptions,n.getCanonicalFileName,n.host);return function(t,n){var i=t.kind,o=t.sourceFile,a=t.newLineCharacter,l=t.symbolName,c=e.findLast(o.statements,e.isAnyImportSyntax),u=e.stripQuotes(n),d=e.createImportDeclaration(void 0,void 0,function(t,n){var r=e.createIdentifier(n);switch(t){case 1:return e.createImportClause(r,void 0);case 2:return e.createImportClause(void 0,e.createNamespaceImport(r));case 0:return e.createImportClause(void 0,e.createNamedImports([e.createImportSpecifier(void 0,r)]));default:e.Debug.assertNever(t)}}(i,l),function(t,n){var r=e.createLiteral(n),i=e.firstOrUndefined(t.imports);return r.singleQuote=!!i&&!e.isStringDoubleQuoted(i,t),r}(o,u)),p=r.with(t,(function(t){c?t.insertNodeAfter(o,c,d,{suffix:a}):t.insertNodeAt(o,e.getSourceFileImportLocation(o),d,{suffix:""+a+a})}));return s(e.Diagnostics.Import_0_from_1,[l,u],p,"NewImport",u)}(n,a)}(t,n,i)),o}function a(e){if(238===e.kind){var t=e.importClause&&e.importClause.namedBindings;return t&&240===t.kind?t.name:void 0}return e.name}function l(t,n,r){return e.firstDefined(n,(function(e){return u(t,e,r)}))}function c(t){return t=e.removeFileExtension(t),e.endsWith(t,"/index")&&(t=t.substr(0,t.length-6)),t}function u(t,n,r){var i=e.getRelativePathToDirectoryOrUrl(n,t,n,r,!1);return e.isRootedDiskPath(i)||e.startsWith(i,"..")?void 0:i}function d(t,n,r){var i=e.getRelativePathToDirectoryOrUrl(n,t,n,r,!1);return e.pathIsRelative(i)?i:"./"+i}function p(t){var n=238===t.kind?t.moduleSpecifier:248===t.moduleReference.kind?t.moduleReference.expression:void 0;return n&&e.isStringLiteral(n)?n.text:void 0}function h(t,n,i){var o=n.symbolName,a=n.sourceFile;return s(e.Diagnostics.Change_0_to_1,[o,t+"."+o],r.with(n,(function(n){return n.replaceNode(a,i,e.createPropertyAccess(e.createIdentifier(t),o))})),"CodeChange",void 0)}function f(t,n){var r=t.declarations;return e.some(r,(function(t){return!!(e.getMeaningFromDeclaration(t)&n)}))}function m(t,n,r){for(var i=0,s=t.getAmbientModules();i<s.length;i++){r(s[i])}for(var o=0,a=n;o<a.length;o++){var l=a[o];e.isExternalOrCommonJsModule(l)&&r(l.symbol)}}!function(e){e[e.Named=0]="Named",e[e.Default=1]="Default",e[e.Namespace=2]="Namespace"}(t.ImportKind||(t.ImportKind={})),t.getCodeActionForImport=o,t.forEachExternalModule=m}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){var n;function r(t,n,r){var i=e.getLineAndCharacterOfPosition(t,n).line,s=e.getStartPositionOfLine(i,t),o=e.getFirstNonSpaceCharacterPosition(t.text,s);if(!e.isInComment(t,o)&&!e.isInString(t,o)&&!e.isInTemplateString(t,o)){var a=e.getTouchingToken(t,o,!1),l=e.getLeadingCommentRangesOfNode(a,t);if(!l||!l.length||l[0].pos>=o)return{span:{start:o,length:0},newText:"// @ts-ignore"+r}}return{span:{start:n,length:0},newText:(n===o?"":r)+"// @ts-ignore"+r}}t.registerCodeFix({errorCodes:(n=e.Diagnostics,Object.keys(n).filter((function(t){return n[t]&&n[t].category===e.DiagnosticCategory.Error})).map((function(e){return n[e].code}))),getCodeActions:function(t){var n=t.sourceFile,i=t.program,s=t.newLineCharacter,o=t.span;if(!e.isInJavaScriptFile(n)||!e.isCheckJsEnabledForFile(n,i.getCompilerOptions()))return;return[{description:e.getLocaleSpecificMessage(e.Diagnostics.Ignore_this_error_message),changes:[{fileName:n.fileName,textChanges:[r(n,o.start,s)]}]},{description:e.getLocaleSpecificMessage(e.Diagnostics.Disable_checking_for_this_file),changes:[{fileName:n.fileName,textChanges:[{span:{start:n.checkJsDirective?n.checkJsDirective.pos:0,length:n.checkJsDirective?n.checkJsDirective.end-n.checkJsDirective.pos:0},newText:"// @ts-nocheck"+s}]}]}]}})}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){function n(t,n,o){var a=t.getDeclarations();if(a&&a.length){var l=a[0],c=e.getSynthesizedClone(e.getNameOfDeclaration(l)),u=function(t){if(4&t)return e.createToken(114);if(16&t)return e.createToken(113);return}(e.getModifierFlags(l)),d=u?e.createNodeArray([u]):void 0,p=o.getWidenedType(o.getTypeOfSymbolAtLocation(t,n)),h=!!(16777216&t.flags);switch(l.kind){case 153:case 154:case 148:case 149:var f=o.typeToTypeNode(p,n);return e.createProperty(void 0,d,c,h?e.createToken(55):void 0,f,void 0);case 150:case 151:var m=o.getSignaturesOfType(p,0);if(!e.some(m))return;if(1===a.length)return e.Debug.assert(1===m.length),v(m[0],n,s());for(var _=[],g=0;g<m.length;g++){(y=v(m[g],n))&&_.push(y)}if(a.length>m.length){var y;(y=v(o.getSignatureFromDeclaration(a[a.length-1]),n,s()))&&_.push(y)}else{e.Debug.assert(a.length===m.length);var b=function(t,n,s,o){for(var a=t[0],l=t[0].minArgumentCount,c=!1,u=0;u<t.length;u++){var d=t[u];l=Math.min(d.minArgumentCount,l),d.hasRestParameter&&(c=!0),d.parameters.length>=a.parameters.length&&(!d.hasRestParameter||a.hasRestParameter)&&(a=d)}var p=a.parameters.length-(a.hasRestParameter?1:0),h=a.parameters.map((function(e){return e.name})),f=r(p,h,l,!0);if(c){var m=e.createArrayTypeNode(e.createKeywordTypeNode(119)),_=e.createParameter(void 0,void 0,e.createToken(24),h[p]||"rest",p>=l?e.createToken(55):void 0,m,void 0);f.push(_)}return i(o,n,s,void 0,f,void 0)}(m,c,h,d);_.push(b)}return _;default:return}}function v(t,n,r){var i=o.signatureToSignatureDeclaration(t,151,n,e.NodeBuilderFlags.SuppressAnyReturnType);return i&&(i.decorators=void 0,i.modifiers=d,i.name=c,i.questionToken=h?e.createToken(55):void 0,i.body=r),i}}function r(t,n,r,i){for(var s=[],o=0;o<t;o++){var a=e.createParameter(void 0,void 0,void 0,n&&n[o]||"arg"+o,void 0!==r&&o>=r?e.createToken(55):void 0,i?e.createKeywordTypeNode(119):void 0,void 0);s.push(a)}return s}function i(t,n,r,i,o,a){return e.createMethod(void 0,t,void 0,n,r?e.createToken(55):void 0,i,o,a,s())}function s(){return e.createBlock([e.createThrow(e.createNew(e.createIdentifier("Error"),void 0,[e.createLiteral("Method not implemented.")]))],!0)}t.newNodesToChanges=function(t,n,r){for(var i=r.sourceFile,s=e.textChanges.ChangeTracker.fromContext(r),o=0,a=t;o<a.length;o++){var l=a[o];s.insertNodeAfter(i,n,l,{suffix:r.newLineCharacter})}var c=s.getChanges();return e.some(c)?(e.Debug.assert(1===c.length),[{fileName:c[0].fileName,textChanges:[{span:c[0].textChanges[0].span,newText:c[0].textChanges.reduce((function(e,t){return e+t.newText}),"")}]}]):c},t.createMissingMemberNodes=function(e,t,r){for(var i=e.symbol.members,s=[],o=0,a=t.filter((function(e){return!i.has(e.escapedName)}));o<a.length;o++){var l=n(a[o],e,r);l&&(Array.isArray(l)?s=s.concat(l):s.push(l))}return s},t.createMethodFromCallExpression=function(t,n,i,o){var a,l=r(t.arguments.length,void 0,void 0,i);if(i)for(var c=e.length(t.typeArguments),u=0;u<c;u++){var d=c<8?String.fromCharCode(84+u):"T"+u,p=e.createTypeParameterDeclaration(d,void 0,void 0);(a||(a=[])).push(p)}return e.createMethod(void 0,o?[e.createToken(115)]:void 0,void 0,n,void 0,a,l,i?e.createKeywordTypeNode(119):void 0,s())},t.createStubbedMethod=i}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){var n;t.registerCodeFix({errorCodes:[e.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined.code,e.Diagnostics.Variable_0_implicitly_has_an_1_type.code,e.Diagnostics.Parameter_0_implicitly_has_an_1_type.code,e.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type.code,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation.code,e.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type.code,e.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation.code,e.Diagnostics.Member_0_implicitly_has_an_1_type.code],getCodeActions:function(t){var r,i=t.sourceFile,s=t.program,o=t.span.start,a=t.errorCode,l=t.cancellationToken,c=e.getTokenAtPosition(i,o,!1);if(e.isInJavaScriptFile(c))return;switch(c.kind){case 71:case 24:case 114:case 112:case 113:case 131:break;default:return}var u=e.getContainingFunction(c),d=s.getTypeChecker();switch(a){case e.Diagnostics.Member_0_implicitly_has_an_1_type.code:case e.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined.code:return p(c.parent);case e.Diagnostics.Variable_0_implicitly_has_an_1_type.code:return function(e){var t=d.getSymbolAtLocation(e);return t&&t.valueDeclaration&&p(t.valueDeclaration)}(c);case e.Diagnostics.Parameter_0_implicitly_has_an_1_type.code:if(e.isSetAccessor(u))return h(u);case e.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type.code:return function(t){if(!e.isIdentifier(t.name)||!function(e){switch(e.kind){case 228:case 151:case 152:return!0;case 186:return!!e.name}return!1}(u))return;var r=function(e){switch(e.kind){case 152:case 186:case 228:case 151:var t=152===e.kind?b(e,i,123):e.name;if(t)return n.inferTypeForParametersFromReferences(m(t),e,d,l)}}(u)||e.map(u.parameters,(function(t){return e.isIdentifier(t.name)&&_(t.name)}));if(!r)return;var s=e.zipWith(u.parameters,r,(function(e,t){if(t&&!e.type&&!e.initializer){var n=y(t,u);return n?{span:{start:e.end,length:0},newText:": "+n}:void 0}})).filter((function(e){return!!e}));return s.length?[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Infer_parameter_types_from_usage),[t.name.getText()]),changes:[{fileName:i.fileName,textChanges:s}]}]:void 0}(c.parent);case e.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation.code:case e.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type.code:return e.isGetAccessor(u)?function(t){if(!e.isIdentifier(t.name))return;var n=_(t.name),r=n&&y(n,u);if(!r)return;var s=b(t,i,20);return f(t.name.getText(),s.getEnd(),": "+r)}(u):void 0;case e.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation.code:return e.isSetAccessor(u)?h(u):void 0}return;function p(t){if(e.isIdentifier(t.name)){var n=_(t.name),r=n&&y(n,t);if(r)return f(t.name.getText(),t.name.getEnd(),": "+r)}}function h(t){var n=t.parameters[0];if(n&&e.isIdentifier(t.name)&&e.isIdentifier(n.name)){var r=_(t.name)||_(n.name),i=r&&y(r,u);if(i)return f(t.name.getText(),n.name.getEnd(),": "+i)}}function f(t,n,r){return[{description:e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Infer_type_of_0_from_usage),[t]),changes:[{fileName:i.fileName,textChanges:[{span:{start:n,length:0},newText:r}]}]}]}function m(t){var n=e.FindAllReferences.findReferencedSymbols(s,l,s.getSourceFiles(),t.getSourceFile(),t.getStart());return e.Debug.assert(!!n,"Found no references!"),e.Debug.assert(1===n.length,"Found more references than expected"),e.map(n[0].references,(function(t){return e.getTokenAtPosition(s.getSourceFile(t.fileName),t.textSpan.start,!1)}))}function _(e){return n.inferTypeFromReferences(m(e),d,l)}function g(){if(!r){var t="",n=!0,i=function(e){return t+=e};r={string:function(){return n?t:void 0},writeKeyword:i,writeOperator:i,writePunctuation:i,writeSpace:i,writeStringLiteral:i,writeParameter:i,writeProperty:i,writeSymbol:i,writeLine:function(){return t+=" "},increaseIndent:e.noop,decreaseIndent:e.noop,clear:function(){t="",n=!0},trackSymbol:function(e,t,r){0!==d.isSymbolAccessible(e,t,r,!1).accessibility&&(n=!1)},reportInaccessibleThisError:function(){n=!1},reportPrivateInBaseOfClassExpression:function(){n=!1}}}return r.clear(),r}function y(e,t){var n=g();return d.getSymbolDisplayBuilder().buildTypeDisplay(e,n,t),n.string()}function b(e,t,n){for(var r=0,i=e.getChildren(t);r<i.length;r++){var s=i[r];if(s.kind===n)return s}}}}),function(t){function n(t,i,s){for(;e.isRightSideOfQualifiedNameOrPropertyAccess(t);)t=t.parent;switch(t.parent.kind){case 193:s.isNumber=!0;break;case 192:!function(e,t){switch(e.operator){case 43:case 44:case 38:case 52:t.isNumber=!0;break;case 37:t.isNumberOrString=!0}}(t.parent,s);break;case 194:!function(t,n,r,i){switch(n.operatorToken.kind){case 40:case 39:case 41:case 42:case 45:case 46:case 47:case 48:case 49:case 50:case 60:case 62:case 61:case 63:case 64:case 68:case 69:case 70:case 65:case 67:case 66:case 38:case 27:case 30:case 29:case 31:var s=r.getTypeAtLocation(n.left===t?n.right:n.left);272&s.flags?a(i,s):i.isNumber=!0;break;case 59:case 37:var o=r.getTypeAtLocation(n.left===t?n.right:n.left);272&o.flags?a(i,o):84&o.flags?i.isNumber=!0:262178&o.flags?i.isString=!0:i.isNumberOrString=!0;break;case 58:case 32:case 34:case 35:case 33:a(i,r.getTypeAtLocation(n.left===t?n.right:n.left));break;case 92:t===n.left&&(i.isString=!0);break;case 54:t!==n.left||226!==t.parent.parent.kind&&!e.isAssignmentExpression(t.parent.parent,!0)||a(i,r.getTypeAtLocation(n.right))}}(t,t.parent,i,s);break;case 257:case 258:!function(e,t,n){a(n,t.getTypeAtLocation(e.parent.parent.expression))}(t.parent,i,s);break;case 181:case 182:t.parent.expression===t?function(e,t,r){var i={argumentTypes:[],returnType:{}};if(e.arguments)for(var s=0,o=e.arguments;s<o.length;s++){var a=o[s];i.argumentTypes.push(t.getTypeAtLocation(a))}n(e,t,i.returnType),181===e.kind?(r.callContexts||(r.callContexts=[])).push(i):(r.constructContexts||(r.constructContexts=[])).push(i)}(t.parent,i,s):r(t,i,s);break;case 179:!function(t,r,i){var s=e.escapeLeadingUnderscores(t.name.text);i.properties||(i.properties=e.createUnderscoreEscapedMap());var o=i.properties.get(s)||{};n(t,r,o),i.properties.set(s,o)}(t.parent,i,s);break;case 180:!function(e,t,r,i){if(t===e.argumentExpression)return void(i.isNumberOrString=!0);var s=r.getTypeAtLocation(e),o={};n(e,r,o),84&s.flags?i.numberIndexContext=o:i.stringIndexContext=o}(t.parent,t,i,s);break;default:return r(t,i,s)}}function r(t,n,r){e.isPartOfExpression(t)&&a(r,n.getContextualType(t))}function i(t,n){if(t.isNumberOrString&&!t.isNumber&&!t.isString)return n.getUnionType([n.getNumberType(),n.getStringType()]);if(t.isNumber)return n.getNumberType();if(t.isString)return n.getStringType();if(t.candidateTypes)return n.getWidenedType(n.getUnionType(e.map(t.candidateTypes,(function(e){return n.getBaseTypeOfLiteralType(e)})),!0));if(t.properties&&l(t.properties.get("then"))){var r=s(0,t.properties.get("then").callContexts,!1,n).getCallSignatures().map((function(e){return e.getReturnType()}));return n.createPromiseType(r.length?n.getUnionType(r,!0):n.getAnyType())}if(t.properties&&l(t.properties.get("push")))return n.createArrayType(s(0,t.properties.get("push").callContexts,!1,n));if(t.properties||t.callContexts||t.constructContexts||t.numberIndexContext||t.stringIndexContext){var a=e.createUnderscoreEscapedMap(),c=[],u=[],d=void 0,p=void 0;if(t.properties&&t.properties.forEach((function(e,t){var r=n.createSymbol(4,t);r.type=i(e,n)||n.getAnyType(),a.set(t,r)})),t.callContexts)for(var h=0,f=t.callContexts;h<f.length;h++){var m=f[h];c.push(o(m,n))}if(t.constructContexts)for(var _=0,g=t.constructContexts;_<g.length;_++){var y=g[_];u.push(o(y,n))}return t.numberIndexContext&&(p=n.createIndexInfo(i(t.numberIndexContext,n),!1)),t.stringIndexContext&&(d=n.createIndexInfo(i(t.stringIndexContext,n),!1)),n.createAnonymousType(void 0,a,c,u,d,p)}}function s(t,n,r,i){var s=[];if(n)for(var o=0,a=n;o<a.length;o++){var l=a[o];l.argumentTypes.length>t&&(r?s=e.concatenate(s,e.map(l.argumentTypes.slice(t),(function(e){return i.getBaseTypeOfLiteralType(e)}))):s.push(i.getBaseTypeOfLiteralType(l.argumentTypes[t])))}if(s.length){var c=i.getWidenedType(i.getUnionType(s,!0));return r?i.createArrayType(c):c}}function o(t,n){for(var r=[],s=0;s<t.argumentTypes.length;s++){var o=n.createSymbol(1,e.escapeLeadingUnderscores("arg"+s));o.type=n.getWidenedType(n.getBaseTypeOfLiteralType(t.argumentTypes[s])),r.push(o)}var a=i(t.returnType,n)||n.getVoidType();return n.createSignature(void 0,void 0,void 0,r,a,void 0,t.argumentTypes.length,!1,!1)}function a(e,t){!t||1&t.flags||8192&t.flags||(e.candidateTypes||(e.candidateTypes=[])).push(t)}function l(e){return e&&e.callContexts}t.inferTypeFromReferences=function(e,t,r){for(var s={},o=0,a=e;o<a.length;o++){var l=a[o];r.throwIfCancellationRequested(),n(l,t,s)}return i(s,t)},t.inferTypeForParametersFromReferences=function(t,r,i,s){if(r.parameters){for(var o={},a=0,l=t;a<l.length;a++){var c=l[a];s.throwIfCancellationRequested(),n(c,i,o)}var u=152===r.kind?o.constructContexts:o.callContexts;if(u){for(var d=[],p=0;p<r.parameters.length;p++){for(var h=[],f=e.isRestParameter(r.parameters[p]),m=0,_=u;m<_.length;m++){var g=_[m];g.argumentTypes.length>p&&(f?h=e.concatenate(h,e.map(g.argumentTypes.slice(p),(function(e){return i.getBaseTypeOfLiteralType(e)}))):h.push(i.getBaseTypeOfLiteralType(g.argumentTypes[p])))}if(h.length){var y=i.getWidenedType(i.getUnionType(h,!0));d[p]=f?i.createArrayType(y):y}}return d}}}}(n||(n={}))}(e.codefix||(e.codefix={}))}(ts||(ts={})),function(e){!function(t){!function(n){var r="annotate",i={name:"Annotate with type from JSDoc",description:e.Diagnostics.Annotate_with_type_from_JSDoc.message,getEditsForAction:function(n,i){if(r!==i)return e.Debug.fail("actionName !== action: annotate !== "+i);var s=e.getTokenAtPosition(n.file,n.startPosition,!1),l=e.findAncestor(s,o);if(!l||l.type)return;var c=e.getJSDocType(l);if(e.isFunctionLikeDeclaration(l)&&(e.getJSDocReturnType(l)||l.parameters.some((function(t){return!!e.getJSDocType(t)})))||c&&146===l.kind)return function(t){var n=t.file,r=e.getTokenAtPosition(n,t.startPosition,!1),i=e.findAncestor(r,e.isFunctionLikeDeclaration),s=e.textChanges.ChangeTracker.fromContext(t),o=function(t){var n=e.getEffectiveTypeParameterDeclarations(t,!0),r=t.parameters.map((function(t){return e.createParameter(t.decorators,t.modifiers,t.dotDotDotToken,t.name,t.questionToken,a(e.getEffectiveTypeAnnotationNode(t,!0)),t.initializer)})),i=a(e.getEffectiveReturnTypeNode(t,!0));switch(t.kind){case 228:return e.createFunctionDeclaration(t.decorators,t.modifiers,t.asteriskToken,t.name,n,r,i,t.body);case 152:return e.createConstructor(t.decorators,t.modifiers,r,t.body);case 186:return e.createFunctionExpression(t.modifiers,t.asteriskToken,t.name,n,r,i,t.body);case 187:return e.createArrowFunction(t.modifiers,n,r,i,t.equalsGreaterThanToken,t.body);case 151:return e.createMethod(t.decorators,t.modifiers,t.asteriskToken,t.name,t.questionToken,n,r,i,t.body);case 153:return e.createGetAccessor(t.decorators,t.modifiers,t.name,t.parameters,i,t.body);case 154:return e.createSetAccessor(t.decorators,t.modifiers,t.name,r,t.body);default:return e.Debug.assertNever(t,"Unexpected SyntaxKind: "+t.kind)}}(i);return e.suppressLeadingAndTrailingTrivia(o),s.replaceRange(n,{pos:i.getStart(),end:i.end},o),{edits:s.getChanges(),renameFilename:void 0,renameLocation:void 0}}(n);if(c)return function(t){var n=t.file,r=e.getTokenAtPosition(n,t.startPosition,!1),i=e.findAncestor(r,o),s=e.getJSDocType(i);if(!i||!s||i.type)return e.Debug.fail("!decl || !jsdocType || decl.type: !"+i+" || !"+s+" || "+i.type);var l=e.textChanges.ChangeTracker.fromContext(t),c=function(t,n){switch(t.kind){case 226:return e.createVariableDeclaration(t.name,n,t.initializer);case 148:return e.createPropertySignature(t.modifiers,t.name,t.questionToken,n,t.initializer);case 149:return e.createProperty(t.decorators,t.modifiers,t.name,t.questionToken,n,t.initializer);default:return e.Debug.fail("Unexpected SyntaxKind: "+t.kind)}}(i,a(s));return e.suppressLeadingAndTrailingTrivia(c),l.replaceRange(n,{pos:i.getStart(),end:i.end},c),{edits:l.getChanges(),renameFilename:void 0,renameLocation:void 0}}(n);e.Debug.assert(!!t,"No applicable refactor found.")},getAvailableActions:function(t){if(e.isInJavaScriptFile(t.file))return;var n=e.getTokenAtPosition(t.file,t.startPosition,!1);if(s(e.findAncestor(n,o)))return[{name:i.name,description:i.description,actions:[{description:i.description,name:r}]}]}};function s(t){return!!t&&(e.isFunctionLikeDeclaration(t)?t.parameters.some(s)||!t.type&&!!e.getJSDocReturnType(t):!t.type&&!!e.getJSDocType(t))}function o(t){return e.isFunctionLikeDeclaration(t)||226===t.kind||146===t.kind||148===t.kind||149===t.kind}function a(t){if(void 0!==t)switch(t.kind){case 268:case 269:return e.createTypeReferenceNode("any",e.emptyArray);case 272:return function(t){return e.createUnionTypeNode([e.visitNode(t.type,a),e.createTypeReferenceNode("undefined",e.emptyArray)])}(t);case 271:return a(t.type);case 270:return function(t){return e.createUnionTypeNode([e.visitNode(t.type,a),e.createTypeReferenceNode("null",e.emptyArray)])}(t);case 274:return function(t){return e.createArrayTypeNode(e.visitNode(t.type,a))}(t);case 273:return function(t){var n=t.parameters&&t.parameters.map(a);return e.createFunctionTypeNode(e.emptyArray,n,t.type)}(t);case 146:return function(t){var n=t.parent.parameters.indexOf(t),r=274===t.type.kind&&n===t.parent.parameters.length-1,i=t.name||(r?"rest":"arg"+n),s=r?e.createToken(24):t.dotDotDotToken;return e.createParameter(t.decorators,t.modifiers,s,i,t.questionToken,e.visitNode(t.type,a),t.initializer)}(t);case 159:return function(t){var n=t.typeName,r=t.typeArguments;if(e.isIdentifier(t.typeName)){if(e.isJSDocIndexSignature(t))return function(t){var n=e.createParameter(void 0,void 0,void 0,133===t.typeArguments[0].kind?"n":"s",void 0,e.createTypeReferenceNode(133===t.typeArguments[0].kind?"number":"string",[]),void 0),r=e.createTypeLiteralNode([e.createIndexSignature(void 0,void 0,[n],t.typeArguments[1])]);return e.setEmitFlags(r,1),r}(t);var i=t.typeName.text;switch(t.typeName.text){case"String":case"Boolean":case"Object":case"Number":i=i.toLowerCase();break;case"array":case"date":case"promise":i=i[0].toUpperCase()+i.slice(1)}n=e.createIdentifier(i),r="Array"!==i&&"Promise"!==i||t.typeArguments?e.visitNodes(t.typeArguments,a):e.createNodeArray([e.createTypeReferenceNode("any",e.emptyArray)])}return e.createTypeReferenceNode(n,r)}(t);default:var n=e.visitEachChild(t,a,void 0);return e.setEmitFlags(n,1),n}}t.registerRefactor(i)}(t.annotateWithTypeFromJSDoc||(t.annotateWithTypeFromJSDoc={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){!function(t){!function(n){var r="convert",i={name:"Convert to ES2015 class",description:e.Diagnostics.Convert_function_to_an_ES2015_class.message,getEditsForAction:function(t,n){if(r!==n)return;var i=t.file,o=s(t),a=t.rulesProvider.getFormatOptions().newLineCharacter,l=[],c=[];if(!(19&o.flags))return;var u,d,p=o.valueDeclaration,h=e.textChanges.ChangeTracker.fromContext(t);switch(p.kind){case 228:u=p,_(p),d=function(t){var n=g(o);t.body&&n.unshift(e.createConstructor(void 0,void 0,t.parameters,t.body));var r=b(t,84);return e.createClassDeclaration(void 0,r,t.name,void 0,void 0,n)}(p);break;case 226:u=p.parent.parent,1===p.parent.declarations.length?_(u):_(p,!0),d=function(t){var n=t.initializer;if(!n||186!==n.kind)return;if(71!==t.name.kind)return;var r=g(n.symbol);n.body&&r.unshift(e.createConstructor(void 0,void 0,n.parameters,n.body));var i=b(u,84);return e.createClassDeclaration(void 0,i,t.name,void 0,void 0,r)}(p)}if(!d)return;h.insertNodeAfter(i,u,d,{suffix:a});for(var f=0,m=c;f<m.length;f++){(0,m[f])()}return{edits:h.getChanges(),renameFilename:void 0,renameLocation:void 0};function _(t,n){void 0===n&&(n=!1),l.some((function(n){return e.isNodeDescendantOf(t,n)}))||(l.push(t),n?c.push((function(){return h.deleteNodeInList(i,t)})):c.push((function(){return h.deleteNode(i,t)})))}function g(t){var n=[];return t.members&&t.members.forEach((function(e){var t=r(e,void 0);t&&n.push(t)})),t.exports&&t.exports.forEach((function(t){var i=r(t,[e.createToken(115)]);i&&n.push(i)})),n;function r(t,n){if(4&t.flags){var r=t.valueDeclaration,s=r.parent;if(o=s.right,e.isFunctionLike(o)){var o;if(_(s.parent&&210===s.parent.kind?s.parent:s),!s.right)return e.createProperty([],n,t.name,void 0,void 0,void 0);switch(s.right.kind){case 186:var a=s.right,l=e.concatenate(n,b(a,120));return y(s,h=e.createMethod(void 0,l,void 0,r.name,void 0,void 0,a.parameters,void 0,a.body)),h;case 187:var c=s.right,u=c.body,d=void 0;if(207===u.kind)d=u;else{var p=u;d=e.createBlock([e.createReturn(p)])}var h;l=e.concatenate(n,b(c,120));return y(s,h=e.createMethod(void 0,l,void 0,r.name,void 0,void 0,c.parameters,void 0,d)),h;default:if(e.isSourceFileJavaScript(i))return;var f=e.createProperty(void 0,n,r.name,void 0,void 0,s.right);return y(s.parent,f),f}}}}}function y(t,n){e.forEachLeadingCommentRange(i.text,t.pos,(function(t,r,s,o){3===s?(t+=2,r-=2):t+=2,e.addSyntheticLeadingComment(n,s,i.text.slice(t,r),o)}))}function b(t,n){return e.filter(t.modifiers,(function(e){return e.kind===n}))}},getAvailableActions:function(t){if(!e.isInJavaScriptFile(t.file))return;var n=s(t);if(!n)return;e.isDeclarationOfFunctionOrClassExpression(n)&&(n=n.valueDeclaration.initializer.symbol);if(16&n.flags&&n.members&&n.members.size>0)return[{name:i.name,description:i.description,actions:[{description:i.description,name:r}]}]}};function s(t){var n=t.startPosition,r=t.file,i=t.program.getTypeChecker(),s=e.getTokenAtPosition(r,n,!1);return i.getSymbolAtLocation(s)}t.registerRefactor(i)}(t.convertFunctionToES6Class||(t.convertFunctionToES6Class={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){!function(t){!function(n){var r,i,s,o,a={name:"Extract Symbol",description:e.getLocaleSpecificMessage(e.Diagnostics.Extract_symbol),getAvailableActions:l,getEditsForAction:c};function l(t){var n=u(t.file,{start:t.startPosition,length:e.getRefactorContextLength(t)}).targetRange;if(void 0!==n){var r=function(t,n){var r=h(t,n),i=r.scopes,s=r.readsAndWrites,o=s.functionErrorsPerScope,a=s.constantErrorsPerScope;return i.map((function(t,n){var r,i,s=function(t){return e.isFunctionLikeDeclaration(t)?"inner function":e.isClassLike(t)?"method":"function"}(t),l=function(t){return e.isClassLike(t)?"readonly field":"constant"}(t),c=e.isFunctionLikeDeclaration(t)?function(t){switch(t.kind){case 152:return"constructor";case 186:return t.name?"function expression '"+t.name.text+"'":"anonymous function expression";case 228:return"function '"+t.name.text+"'";case 187:return"arrow function";case 151:return"method '"+t.name.getText();case 153:return"'get "+t.name.getText()+"'";case 154:return"'set "+t.name.getText()+"'";default:e.Debug.assertNever(t)}}(t):e.isClassLike(t)?function(e){return 229===e.kind?"class '"+e.name.text+"'":e.name?"class expression '"+e.name.text+"'":"anonymous class expression"}(t):function(e){return 234===e.kind?"namespace '"+e.parent.name.getText()+"'":e.externalModuleIndicator?0:1}(t);return 1===c?(r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[s,"global"]),i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[l,"global"])):0===c?(r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[s,"module"]),i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1_scope),[l,"module"])):(r=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1),[s,c]),i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_1),[l,c])),0!==n||e.isClassLike(t)||(i=e.formatStringFromArgs(e.getLocaleSpecificMessage(e.Diagnostics.Extract_to_0_in_enclosing_scope),[l])),{functionExtraction:{description:r,errors:o[n]},constantExtraction:{description:i,errors:a[n]}}}))}(n,t);if(void 0!==r){for(var i=[],s=e.createMap(),o=[],l=e.createMap(),c=0,d=0,p=r;d<p.length;d++){var f=p[d],m=f.functionExtraction,_=f.constantExtraction;if(0===m.errors.length){var g=m.description;s.has(g)||(s.set(g,!0),i.push({description:g,name:"function_scope_"+c}))}if(0===_.errors.length){g=_.description;l.has(g)||(l.set(g,!0),o.push({description:g,name:"constant_scope_"+c}))}c++}var y=[];return i.length&&y.push({name:a.name,description:e.getLocaleSpecificMessage(e.Diagnostics.Extract_function),actions:i}),o.length&&y.push({name:a.name,description:e.getLocaleSpecificMessage(e.Diagnostics.Extract_constant),actions:o}),y.length?y:void 0}}}function c(t,n){var r=u(t.file,{start:t.startPosition,length:e.getRefactorContextLength(t)}).targetRange,s=/^function_scope_(\d+)$/.exec(n);if(s){var o=+s[1];return e.Debug.assert(isFinite(o),"Expected to parse a finite number from the function scope index"),function(t,n,r){var s=h(t,n),o=s.scopes,a=s.readsAndWrites,l=a.target,c=a.usagesPerScope,u=a.functionErrorsPerScope,d=a.exposedVariableDeclarations;return e.Debug.assert(!u[r].length,"The extraction went missing? How?"),n.cancellationToken.throwIfCancellationRequested(),function(t,n,r,s,o,a){var l,c=r.usages,u=r.typeParameterUsages,d=r.substitutions,p=a.program.getTypeChecker(),h=n.getSourceFile(),v=f(e.isClassLike(n)?"newMethod":"newFunction",h.text),T=e.isInJavaScriptFile(n),k=e.createIdentifier(v),E=void 0,x=[],S=[];c.forEach((function(n,r){var i=void 0;if(!T){var s=p.getTypeOfSymbolAtLocation(n.symbol,n.node);s=p.getBaseTypeOfLiteralType(s),i=p.typeToTypeNode(s,t,e.NodeBuilderFlags.NoTruncation)}var o=e.createParameter(void 0,void 0,void 0,r,void 0,i);x.push(o),2===n.usage&&(l||(l=[])).push(n),S.push(e.createIdentifier(r))}));var C=e.arrayFrom(u.values()).map((function(e){return{type:e,declaration:_(e)}})).sort(g),I=0===C.length?void 0:C.map((function(e){return e.declaration})),A=void 0!==I?I.map((function(t){return e.createTypeReferenceNode(t.name,void 0)})):void 0;if(e.isExpression(t)&&!T){var w=p.getContextualType(t);E=p.typeToTypeNode(w,n,e.NodeBuilderFlags.NoTruncation)}var N,D=function(t,n,r,i,s){var o,a=void 0!==r||n.length>0;if(e.isBlock(t)&&!a&&0===i.size)return{body:e.createBlock(t.statements,!0),returnValueProperty:void 0};var l=!1,c=e.createNodeArray(e.isBlock(t)?t.statements.slice(0):[e.isStatement(t)?t:e.createReturn(t)]);if(a||i.size){var u=e.visitNodes(c,p).slice();if(a&&!s&&e.isStatement(t)){var d=y(n,r);1===d.length?u.push(e.createReturn(d[0].name)):u.push(e.createReturn(e.createObjectLiteral(d)))}return{body:e.createBlock(u,!0),returnValueProperty:o}}return{body:e.createBlock(c,!0),returnValueProperty:void 0};function p(t){if(!l&&219===t.kind&&a){var s=y(n,r);return t.expression&&(o||(o="__return"),s.unshift(e.createPropertyAssignment(o,e.visitNode(t.expression,p)))),1===s.length?e.createReturn(s[0].name):e.createReturn(e.createObjectLiteral(s))}var c=l;l=l||e.isFunctionLikeDeclaration(t)||e.isClassLike(t);var u=i.get(e.getNodeId(t).toString()),d=u?e.getSynthesizedDeepClone(u):e.visitEachChild(t,p,e.nullTransformationContext);return l=c,d}}(t,s,l,d,!!(o.facts&i.HasReturn)),O=D.body,R=D.returnValueProperty;if(e.suppressLeadingAndTrailingTrivia(O),e.isClassLike(n)){var L=T?[]:[e.createToken(112)];o.facts&i.InStaticRegion&&L.push(e.createToken(115)),o.facts&i.IsAsyncFunction&&L.push(e.createToken(120)),N=e.createMethod(void 0,L.length?L:void 0,o.facts&i.IsGenerator?e.createToken(39):void 0,k,void 0,I,x,E,O)}else N=e.createFunctionDeclaration(void 0,o.facts&i.IsAsyncFunction?[e.createToken(120)]:void 0,o.facts&i.IsGenerator?e.createToken(39):void 0,k,I,x,E,O);var P=e.textChanges.ChangeTracker.fromContext(a),M=function(t,n){return e.find(function(t){if(e.isFunctionLikeDeclaration(t)){var n=t.body;if(e.isBlock(n))return n.statements}else{if(e.isModuleBlock(t)||e.isSourceFile(t))return t.statements;if(e.isClassLike(t))return t.members;e.assertTypeIsNever(t)}return e.emptyArray}(n),(function(n){return n.pos>=t&&e.isFunctionLikeDeclaration(n)&&!e.isConstructorDeclaration(n)}))}((b(o.range)?e.last(o.range):o.range).end,n);M?P.insertNodeBefore(a.file,M,N,{suffix:a.newLineCharacter+a.newLineCharacter}):P.insertNodeBefore(a.file,n.getLastToken(),N,{prefix:e.isLineBreak(h.text.charCodeAt(n.getLastToken().pos))?a.newLineCharacter:a.newLineCharacter+a.newLineCharacter,suffix:a.newLineCharacter});var F=[],$=function(t,n,r){var s=e.createIdentifier(r);if(e.isClassLike(t)){var o=n.facts&i.InStaticRegion?e.createIdentifier(t.name.text):e.createThis();return e.createPropertyAccess(o,s)}return s}(n,o,v),B=e.createCall($,A,S);o.facts&i.IsGenerator&&(B=e.createYield(e.createToken(39),B));o.facts&i.IsAsyncFunction&&(B=e.createAwait(B));if(s.length&&!l)if(e.Debug.assert(!R),e.Debug.assert(!(o.facts&i.HasReturn)),1===s.length){var U=s[0];F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.getSynthesizedDeepClone(U.name),e.getSynthesizedDeepClone(U.type),B)],U.parent.flags)))}else{for(var V=[],H=[],G=s[0].parent.flags,j=!1,K=0,W=s;K<W.length;K++){U=W[K];V.push(e.createBindingElement(void 0,void 0,e.getSynthesizedDeepClone(U.name)));var z=p.typeToTypeNode(p.getBaseTypeOfLiteralType(p.getTypeAtLocation(U)),n,e.NodeBuilderFlags.NoTruncation);H.push(e.createPropertySignature(void 0,U.symbol.name,void 0,z,void 0)),j=j||void 0!==U.type,G&=U.parent.flags}var q=j?e.createTypeLiteralNode(H):void 0;q&&e.setEmitFlags(q,1),F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(e.createObjectBindingPattern(V),q,B)],G)))}else if(s.length||l){if(s.length)for(var J=0,Y=s;J<Y.length;J++){var X=(U=Y[J]).parent.flags;2&X&&(X=-3&X|1),F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(U.symbol.name,re(U.type))],X)))}R&&F.push(e.createVariableStatement(void 0,e.createVariableDeclarationList([e.createVariableDeclaration(R,re(E))],1)));var Q=y(s,l);R&&Q.unshift(e.createShorthandPropertyAssignment(R)),1===Q.length?(e.Debug.assert(!R),F.push(e.createStatement(e.createAssignment(Q[0].name,B))),o.facts&i.HasReturn&&F.push(e.createReturn())):(F.push(e.createStatement(e.createAssignment(e.createObjectLiteral(Q),B))),R&&F.push(e.createReturn(e.createIdentifier(R))))}else o.facts&i.HasReturn?F.push(e.createReturn(B)):b(o.range)?F.push(e.createStatement(B)):F.push(B);var Z=b(o.range)?{pos:e.first(o.range).getStart(),end:e.last(o.range).end}:{pos:o.range.getStart(),end:o.range.end};P.replaceRangeWithNodes(a.file,Z,F,{nodeSeparator:a.newLineCharacter});var ee=P.getChanges(),te=(b(o.range)?e.first(o.range):o.range).getSourceFile().fileName,ne=m(ee,te,v,!1);return{renameFilename:te,renameLocation:ne,edits:ee};function re(t){if(void 0!==t){for(var n=e.getSynthesizedDeepClone(t),r=n;e.isParenthesizedTypeNode(r);)r=r.type;return e.isUnionTypeNode(r)&&e.find(r.types,(function(e){return 139===e.kind}))?n:e.createUnionTypeNode([n,e.createKeywordTypeNode(139)])}}}(l,o[r],c[r],d,t,n)}(r,t,o)}var a=/^constant_scope_(\d+)$/.exec(n);if(a){o=+a[1];return e.Debug.assert(isFinite(o),"Expected to parse a finite number from the constant scope index"),function(t,n,r){var s=h(t,n),o=s.scopes,a=s.readsAndWrites,l=a.target,c=a.usagesPerScope,u=a.constantErrorsPerScope,d=a.exposedVariableDeclarations;return e.Debug.assert(!u[r].length,"The extraction went missing? How?"),e.Debug.assert(0===d.length,"Extract constant accepted a range containing a variable declaration?"),n.cancellationToken.throwIfCancellationRequested(),function(t,n,r,s,o){var a=r.substitutions,l=o.program.getTypeChecker(),c=n.getSourceFile(),u=f(e.isClassLike(n)?"newProperty":"newLocal",c.text),d=e.isInJavaScriptFile(n),h=d?void 0:l.typeToTypeNode(l.getContextualType(t),n,e.NodeBuilderFlags.NoTruncation),_=function(t,n){return n.size?r(t):t;function r(t){var i=n.get(e.getNodeId(t).toString());return i?e.getSynthesizedDeepClone(i):e.visitEachChild(t,r,e.nullTransformationContext)}}(t,a);e.suppressLeadingAndTrailingTrivia(_);var g=e.textChanges.ChangeTracker.fromContext(o);if(e.isClassLike(n)){e.Debug.assert(!d);var y=[];y.push(e.createToken(112)),s&i.InStaticRegion&&y.push(e.createToken(115)),y.push(e.createToken(131));var b=e.createProperty(void 0,y,u,void 0,h,_),v=e.createPropertyAccess(s&i.InStaticRegion?e.createIdentifier(n.name.getText()):e.createThis(),e.createIdentifier(u)),T=function(t,n){var r=n.members;e.Debug.assert(r.length>0);for(var i=void 0,s=!0,o=0,a=r;o<a.length;o++){var l=a[o];if(l.pos>t)return i||r[0];if(s&&!e.isPropertyDeclaration(l)){if(void 0!==i)return l;s=!1}i=l}return e.Debug.assert(void 0!==i),i}(t.pos,n);g.insertNodeBefore(o.file,T,b,{suffix:o.newLineCharacter+o.newLineCharacter}),g.replaceRange(o.file,{pos:t.getStart(),end:t.end},v)}else{var E=e.createVariableDeclaration(u,h,_),x=function(t,n){var r=void 0;for(;void 0!==t&&t!==n;){if(e.isVariableDeclaration(t)&&t.initializer===r&&e.isVariableDeclarationList(t.parent)&&t.parent.declarations.length>1)return t;r=t,t=t.parent}}(t,n);if(x){g.insertNodeAt(o.file,x.getStart(),E,{suffix:", "});v=e.createIdentifier(u);g.replaceRange(o.file,{pos:t.getStart(),end:t.end},v)}else if(210===t.parent.kind&&n===e.findAncestor(t,p)){var S=e.createVariableStatement(void 0,e.createVariableDeclarationList([E],2));g.replaceRange(o.file,{pos:t.parent.getStart(),end:t.parent.end},S)}else{S=e.createVariableStatement(void 0,e.createVariableDeclarationList([E],2));if(0===(T=function(t,n){e.Debug.assert(!e.isClassLike(n));for(var r=void 0,i=t;i!==n;i=i.parent)p(i)&&(r=i);for(i=(r||t).parent;;i=i.parent){if(k(i)){for(var s=void 0,o=0,a=i.statements;o<a.length;o++){var l=a[o];if(l.pos>t.pos)break;s=l}return e.Debug.assert(void 0!==s),s}if(i===n){e.Debug.fail("Didn't encounter a block-like before encountering scope");break}}}(t,n)).pos){var C=e.getSourceFileImportLocation(c);g.insertNodeAt(o.file,C,S,{prefix:0===C?void 0:o.newLineCharacter,suffix:e.isLineBreak(c.text.charCodeAt(C))?o.newLineCharacter:o.newLineCharacter+o.newLineCharacter})}else g.insertNodeBefore(o.file,T,S,{suffix:o.newLineCharacter+o.newLineCharacter});if(210===t.parent.kind)g.deleteRange(o.file,{pos:t.parent.getStart(),end:t.parent.end});else{v=e.createIdentifier(u);g.replaceRange(o.file,{pos:t.getStart(),end:t.end},v)}}}var I=g.getChanges(),A=t.getSourceFile().fileName,w=m(I,A,u,!0);return{renameFilename:A,renameLocation:w,edits:I}}(e.isExpression(l)?l:l.statements[0].expression,o[r],c[r],t.facts,n)}(r,t,o)}e.Debug.fail("Unrecognized action name")}function u(t,n){var s=n.length;if(0===s)return{errors:[e.createFileDiagnostic(t,n.start,s,r.CannotExtractEmpty)]};var o=v(e.getTokenAtPosition(t,n.start,!1),t,n),a=v(e.findTokenOnLeftOfPosition(t,e.textSpanEnd(n)),t,n),l=[],c=i.None;if(!o||!a)return{errors:[e.createFileDiagnostic(t,n.start,s,r.CannotExtractRange)]};if(o.parent!==a.parent)return{errors:[e.createFileDiagnostic(t,n.start,s,r.CannotExtractRange)]};if(o!==a){if(!k(o.parent))return{errors:[e.createFileDiagnostic(t,n.start,s,r.CannotExtractRange)]};for(var u=[],p=0,h=o.parent.statements;p<h.length;p++){var f=h[p];if(f===o||u.length){var m=g(f);if(m)return{errors:m};u.push(f)}if(f===a)break}return{targetRange:{range:u,facts:c,declarations:l}}}var _=function(t){if(e.isIdentifier(e.isExpressionStatement(t)?t.expression:t))return[e.createDiagnosticForNode(t,r.CannotExtractIdentifier)];return}(o)||g(o);return _?{errors:_}:{targetRange:{range:d(o),facts:c,declarations:l}};function g(t){var s;if(function(e){e[e.None=0]="None",e[e.Break=1]="Break",e[e.Continue=2]="Continue",e[e.Return=4]="Return"}(s||(s={})),!(e.isStatement(t)||e.isPartOfExpression(t)&&function(e){switch(e.parent.kind){case 264:return!1}switch(e.kind){case 9:return 238!==e.parent.kind&&242!==e.parent.kind;case 198:case 174:case 176:return!1;case 71:return 176!==e.parent.kind&&242!==e.parent.kind&&246!==e.parent.kind}return!0}(t)))return[e.createDiagnosticForNode(t,r.StatementOrExpressionExpected)];if(e.isInAmbientContext(t))return[e.createDiagnosticForNode(t,r.CannotExtractAmbientBlock)];var o,a=e.getContainingClass(t);a&&function(t,n){for(var r=t;r!==n;){if(149===r.kind){e.hasModifier(r,32)&&(c|=i.InStaticRegion);break}if(146===r.kind){152===e.getContainingFunction(r).kind&&(c|=i.InStaticRegion);break}151===r.kind&&e.hasModifier(r,32)&&(c|=i.InStaticRegion),r=r.parent}}(t,a);var u,d=4;return function t(s){if(o)return!0;if(e.isDeclaration(s)){var a=226===s.kind?s.parent.parent:s;if(e.hasModifier(a,1))return(o||(o=[])).push(e.createDiagnosticForNode(s,r.CannotExtractExportedEntity)),!0;l.push(s.symbol)}switch(s.kind){case 238:return(o||(o=[])).push(e.createDiagnosticForNode(s,r.CannotExtractImport)),!0;case 97:if(181===s.parent.kind){var p=e.getContainingClass(s);if(p.pos<n.start||p.end>=n.start+n.length)return(o||(o=[])).push(e.createDiagnosticForNode(s,r.CannotExtractSuper)),!0}else c|=i.UsesThis}if(!s||e.isFunctionLikeDeclaration(s)||e.isClassLike(s)){switch(s.kind){case 228:case 229:265===s.parent.kind&&void 0===s.parent.externalModuleIndicator&&(o||(o=[])).push(e.createDiagnosticForNode(s,r.FunctionWillNotBeVisibleInTheNewScope))}return!1}var h=d;switch(s.kind){case 211:case 224:d=0;break;case 207:s.parent&&224===s.parent.kind&&s.parent.finallyBlock===s&&(d=4);break;case 257:d|=1;break;default:e.isIterationStatement(s,!1)&&(d|=3)}switch(s.kind){case 169:case 99:c|=i.UsesThis;break;case 222:var f=s.label;(u||(u=[])).push(f.escapedText),e.forEachChild(s,t),u.pop();break;case 218:case 217:(f=s.label)?e.contains(u,f.escapedText)||(o||(o=[])).push(e.createDiagnosticForNode(s,r.CannotExtractRangeContainingLabeledBreakOrContinueStatementWithTargetOutsideOfTheRange)):d&(218===s.kind?1:2)||(o||(o=[])).push(e.createDiagnosticForNode(s,r.CannotExtractRangeContainingConditionalBreakOrContinueStatements));break;case 191:c|=i.IsAsyncFunction;break;case 197:c|=i.IsGenerator;break;case 219:4&d?c|=i.HasReturn:(o||(o=[])).push(e.createDiagnosticForNode(s,r.CannotExtractRangeContainingConditionalReturnStatement));break;default:e.forEachChild(s,t)}d=h}(t),o}}function d(t){return e.isStatement(t)?[t]:e.isPartOfExpression(t)?e.isExpressionStatement(t.parent)?[t.parent]:t:void 0}function p(t){return e.isFunctionLikeDeclaration(t)||e.isSourceFile(t)||e.isModuleBlock(t)||e.isClassLike(t)}function h(t,n){var s=n.file,o=function(t){var n=b(t.range)?e.first(t.range):t.range;if(t.facts&i.UsesThis){var r=e.getContainingClass(n);if(r){var s=e.findAncestor(n,e.isFunctionLikeDeclaration);return s?[s,r]:[r]}}for(var o=[];;)if(146===(n=n.parent).kind&&(n=e.findAncestor(n,(function(t){return e.isFunctionLikeDeclaration(t)})).parent),p(n)&&(o.push(n),265===n.kind))return o}(t);return{scopes:o,readsAndWrites:function(t,n,s,o,a,l){var c=e.createMap(),u=[],d=[],p=[],h=[],f=[],m=e.createMap(),_=[],g=void 0,y=b(t.range)?1===t.range.length&&e.isExpressionStatement(t.range[0])?t.range[0].expression:void 0:t.range,v=void 0;if(void 0===y){var T=t.range,k=e.first(T).getStart(),E=e.last(T).end;v=e.createFileDiagnostic(o,k,E-k,r.ExpressionExpected)}else 9216&a.getTypeAtLocation(y).flags&&(v=e.createDiagnosticForNode(y,r.UselessConstantType));for(var x=0,S=n;x<S.length;x++){var C=S[x];u.push({usages:e.createMap(),typeParameterUsages:e.createMap(),substitutions:e.createMap()}),d.push(e.createMap()),p.push(e.isFunctionLikeDeclaration(C)&&228!==C.kind?[e.createDiagnosticForNode(C,r.CannotExtractToOtherFunctionLike)]:[]);var I=[];v&&I.push(v),e.isClassLike(C)&&e.isInJavaScriptFile(C)&&I.push(e.createDiagnosticForNode(C,r.CannotExtractToJSClass)),e.isArrowFunction(C)&&!e.isBlock(C.body)&&I.push(e.createDiagnosticForNode(C,r.CannotExtractToExpressionArrowFunction)),h.push(I)}var A=e.createMap(),w=b(t.range)?e.createBlock(t.range):t.range,N=b(t.range)?e.first(t.range):t.range,D=G(N);if(K(w),D&&!b(t.range)){j(a.getContextualType(t.range))}if(c.size>0){for(var O=e.createMap(),R=0,L=N;void 0!==L&&R<n.length;L=L.parent)if(L===n[R]&&(O.forEach((function(e,t){u[R].typeParameterUsages.set(t,e)})),R++),e.isDeclarationWithTypeParameters(L)&&L.typeParameters)for(var P=0,M=L.typeParameters;P<M.length;P++){var F=M[P],$=a.getTypeAtLocation(F);c.has($.id.toString())&&O.set($.id.toString(),$)}e.Debug.assert(R===n.length)}if(f.length){var B=e.isBlockScope(n[0],n[0].parent)?n[0]:e.getEnclosingBlockScopeContainer(n[0]);e.forEachChild(B,q)}for(var U=function(n){var i=u[n];if(n>0&&(i.usages.size>0||i.typeParameterUsages.size>0)){var s=b(t.range)?t.range[0]:t.range;h[n].push(e.createDiagnosticForNode(s,r.CannotAccessVariablesFromNestedScopes))}var o=!1,a=void 0;if(u[n].usages.forEach((function(t){2===t.usage&&(o=!0,106500&t.symbol.flags&&t.symbol.valueDeclaration&&e.hasModifier(t.symbol.valueDeclaration,64)&&(a=t.symbol.valueDeclaration))})),e.Debug.assert(b(t.range)||0===_.length),o&&!b(t.range)){var l=e.createDiagnosticForNode(t.range,r.CannotWriteInExpression);p[n].push(l),h[n].push(l)}else if(a&&n>0){l=e.createDiagnosticForNode(a,r.CannotExtractReadonlyPropertyInitializerOutsideConstructor);p[n].push(l),h[n].push(l)}else if(g){l=e.createDiagnosticForNode(g,r.CannotExtractExportedEntity);p[n].push(l),h[n].push(l)}},V=0;V<n.length;V++)U(V);return{target:w,usagesPerScope:u,functionErrorsPerScope:p,constantErrorsPerScope:h,exposedVariableDeclarations:_};function H(t){return e.isDeclarationWithTypeParameters(t)&&void 0!==t.typeParameters&&t.typeParameters.length>0}function G(e){for(;e;e=e.parent)if(H(e))return!0;return!1}function j(e){for(var t=0,n=a.getSymbolWalker((function(){return l.throwIfCancellationRequested(),!0})).walkType(e).visitedTypes;t<n.length;t++){var r=n[t];16384&r.flags&&c.set(r.id.toString(),r)}}function K(t,n){(void 0===n&&(n=1),D)&&j(a.getTypeAtLocation(t));if(e.isDeclaration(t)&&t.symbol&&f.push(t),e.isAssignmentExpression(t))K(t.left,2),K(t.right);else if(e.isUnaryExpressionWithWrite(t))K(t.operand,2);else if(e.isPropertyAccessExpression(t)||e.isElementAccessExpression(t))e.forEachChild(t,K);else if(e.isIdentifier(t)){if(!t.parent)return;if(e.isQualifiedName(t.parent)&&t!==t.parent.left)return;if(e.isPropertyAccessExpression(t.parent)&&t!==t.parent.expression)return;W(t,n,e.isPartOfTypeNode(t))}else e.forEachChild(t,K)}function W(t,r,i){var s=z(t,r,i);if(s)for(var o=0;o<n.length;o++){var a=d[o].get(s);a&&u[o].substitutions.set(e.getNodeId(t).toString(),a)}}function z(l,c,f){var m=J(l);if(m){var _=e.getSymbolId(m).toString(),g=A.get(_);if(g&&g>=c)return _;if(A.set(_,c),g){for(var y=0,b=u;y<b.length;y++){var v=b[y];v.usages.get(l.text)&&v.usages.set(l.text,{usage:c,symbol:m,node:l})}return _}var T=e.find(m.getDeclarations(),(function(e){return e.getSourceFile()===o}));if(T&&!e.rangeContainsStartEnd(s,T.getStart(),T.end)){if(t.facts&i.IsGenerator&&2===c){for(var k=e.createDiagnosticForNode(l,r.CannotExtractRangeThatContainsWritesToReferencesLocatedOutsideOfTheTargetRangeInGenerators),E=0,x=p;E<x.length;E++){x[E].push(k)}for(var S=0,C=h;S<C.length;S++){C[S].push(k)}}for(var I=0;I<n.length;I++){var w=n[I];if(a.resolveName(m.name,w,m.flags)!==m&&!d[I].has(_)){var N=Y(m.exportSymbol||m,w,f);if(N)d[I].set(_,N);else if(f){if(!(262144&m.flags)){k=e.createDiagnosticForNode(l,r.TypeWillNotBeVisibleInTheNewScope);p[I].push(k),h[I].push(k)}}else u[I].usages.set(l.text,{usage:c,symbol:m,node:l})}}return _}}}function q(n){if(!(n===t.range||b(t.range)&&t.range.indexOf(n)>=0)){var r=e.isIdentifier(n)?J(n):a.getSymbolAtLocation(n);if(r){var i=e.find(f,(function(e){return e.symbol===r}));if(i)if(e.isVariableDeclaration(i)){var s=i.symbol.id.toString();m.has(s)||(_.push(i),m.set(s,!0))}else g=g||i}e.forEachChild(n,q)}}function J(t){return t.parent&&e.isShorthandPropertyAssignment(t.parent)&&t.parent.name===t?a.getShorthandAssignmentValueSymbol(t.parent):a.getSymbolAtLocation(t)}function Y(t,n,r){if(t){if(t.getDeclarations().some((function(e){return e.parent===n})))return e.createIdentifier(t.name);var i=Y(t.parent,n,r);if(void 0!==i)return r?e.createQualifiedName(i,e.createIdentifier(t.name)):e.createPropertyAccess(i,t.name)}}}(t,o,function(t,n){return b(t.range)?{pos:e.first(t.range).getStart(n),end:e.last(t.range).getEnd()}:t.range}(t,s),s,n.program.getTypeChecker(),n.cancellationToken)}}function f(t,n){for(var r=t,i=1;e.stringContains(n,r);i++)r=t+"_"+i;return r}function m(t,n,r,i){for(var s=0,o=-1,a=0,l=t;a<l.length;a++){var c=l[a],u=c.fileName,d=c.textChanges;e.Debug.assert(u===n);for(var p=0,h=d;p<h.length;p++){var f=h[p],m=f.span,_=f.newText,g=_.indexOf(r);if(-1!==g&&(o=m.start+s+g,!i))return o;s+=_.length-m.length}}return e.Debug.assert(i),e.Debug.assert(o>=0),o}function _(e){var t=void 0,n=e.symbol;if(n&&n.declarations)for(var r=0,i=n.declarations;r<i.length;r++){var s=i[r];(void 0===t||s.pos<t.pos)&&(t=s)}return t}function g(t,n){var r=t.type,i=t.declaration,s=n.type,o=n.declaration;if(i){if(!o)return 1;var a=i.pos-o.pos;if(0!==a)return a}else if(o)return-1;var l=r.symbol?r.symbol.getName():"",c=s.symbol?s.symbol.getName():"",u=e.compareStrings(l,c);return 0!==u?u:r.id-s.id}function y(t,n){var r=e.map(t,(function(t){return e.createShorthandPropertyAssignment(t.symbol.name)})),i=e.map(n,(function(t){return e.createShorthandPropertyAssignment(t.symbol.name)}));return void 0===r?i:void 0===i?r:r.concat(i)}function b(t){return e.isArray(t)}function v(t,n,r){if(t)for(;t.parent;){if(e.isSourceFile(t.parent)||!T(r,t.parent,n))return t;t=t.parent}}function T(t,n,r){return e.textSpanContainsPosition(t,n.getStart(r))&&n.getEnd()<=e.textSpanEnd(t)}function k(e){switch(e.kind){case 207:case 265:case 234:case 257:return!0;default:return!1}}t.registerRefactor(a),n.getAvailableActions=l,n.getEditsForAction=c,function(t){function n(t){return{message:t,code:0,category:e.DiagnosticCategory.Message,key:t}}t.CannotExtractRange=n("Cannot extract range."),t.CannotExtractImport=n("Cannot extract import statement."),t.CannotExtractSuper=n("Cannot extract super call."),t.CannotExtractEmpty=n("Cannot extract empty range."),t.ExpressionExpected=n("expression expected."),t.UselessConstantType=n("No reason to extract constant of type."),t.StatementOrExpressionExpected=n("Statement or expression expected."),t.CannotExtractRangeContainingConditionalBreakOrContinueStatements=n("Cannot extract range containing conditional break or continue statements."),t.CannotExtractRangeContainingConditionalReturnStatement=n("Cannot extract range containing conditional return statement."),t.CannotExtractRangeContainingLabeledBreakOrContinueStatementWithTargetOutsideOfTheRange=n("Cannot extract range containing labeled break or continue with target outside of the range."),t.CannotExtractRangeThatContainsWritesToReferencesLocatedOutsideOfTheTargetRangeInGenerators=n("Cannot extract range containing writes to references located outside of the target range in generators."),t.TypeWillNotBeVisibleInTheNewScope=n("Type will not visible in the new scope."),t.FunctionWillNotBeVisibleInTheNewScope=n("Function will not visible in the new scope."),t.CannotExtractIdentifier=n("Select more than a single identifier."),t.CannotExtractExportedEntity=n("Cannot extract exported declaration"),t.CannotWriteInExpression=n("Cannot write back side-effects when extracting an expression"),t.CannotExtractReadonlyPropertyInitializerOutsideConstructor=n("Cannot move initialization of read-only class property outside of the constructor"),t.CannotExtractAmbientBlock=n("Cannot extract code from ambient contexts"),t.CannotAccessVariablesFromNestedScopes=n("Cannot access variables from nested scopes"),t.CannotExtractToOtherFunctionLike=n("Cannot extract method to a function-like scope that is not a function"),t.CannotExtractToJSClass=n("Cannot extract constant to a class scope in JS"),t.CannotExtractToExpressionArrowFunction=n("Cannot extract constant to an arrow function without a block")}(r=n.Messages||(n.Messages={})),function(e){e[e.None=0]="None",e[e.HasReturn=1]="HasReturn",e[e.IsGenerator=2]="IsGenerator",e[e.IsAsyncFunction=4]="IsAsyncFunction",e[e.UsesThis=8]="UsesThis",e[e.InStaticRegion=16]="InStaticRegion"}(i||(i={})),n.getRangeToExtract=u,function(e){e[e.Module=0]="Module",e[e.Global=1]="Global"}(s||(s={})),function(e){e[e.Read=1]="Read",e[e.Write=2]="Write"}(o||(o={}))}(t.extractSymbol||(t.extractSymbol={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){!function(t){!function(n){var r="install",i={name:"Install missing types package",description:"Install missing types package",getEditsForAction:function(t,n){e.Debug.assertEqual(r,n);var i=s(t);return{edits:[],renameFilename:void 0,renameLocation:void 0,commands:i.commands}},getAvailableActions:function(e){var t=e.program.getCompilerOptions();if(void 0===t.noImplicitAny?t.strict:t.noImplicitAny)return;var n=s(e);return n&&[{name:i.name,description:i.description,actions:[{description:n.description,name:r}]}]}};function s(t){var n=t.file,r=t.startPosition,i=e.getTokenAtPosition(n,r,!1);if(e.isStringLiteral(i)&&function(e){switch(e.parent.kind){case 238:case 248:return!0;default:return!1}}(i)&&void 0===e.getResolvedModule(n,i.text))return e.codefix.tryGetCodeActionForInstallPackageTypes(t.host,i.text)}t.registerRefactor(i)}(t.installTypesForPackage||(t.installTypesForPackage={}))}(e.refactor||(e.refactor={}))}(ts||(ts={})),function(e){var t;function n(t,n,i,s){var l=e.isNodeKind(t)?new r(t,n,i):71===t?new a(71,n,i):new o(t,n,i);return l.parent=s,l}e.servicesVersion="0.6";var r=function(){function t(e,t,n){this.pos=t,this.end=n,this.flags=0,this.transformFlags=void 0,this.parent=void 0,this.kind=e}return t.prototype.getSourceFile=function(){return e.getSourceFileOfNode(this)},t.prototype.getStart=function(t,n){return e.getTokenPosOfNode(this,t,n)},t.prototype.getFullStart=function(){return this.pos},t.prototype.getEnd=function(){return this.end},t.prototype.getWidth=function(e){return this.getEnd()-this.getStart(e)},t.prototype.getFullWidth=function(){return this.end-this.pos},t.prototype.getLeadingTriviaWidth=function(e){return this.getStart(e)-this.pos},t.prototype.getFullText=function(e){return(e||this.getSourceFile()).text.substring(this.pos,this.end)},t.prototype.getText=function(e){return e||(e=this.getSourceFile()),e.text.substring(this.getStart(e),this.getEnd())},t.prototype.addSyntheticNodes=function(t,r,i){for(e.scanner.setTextPos(r);r<i;){var s=e.scanner.scan(),o=e.scanner.getTextPos();if(o<=i&&t.push(n(s,r,o,this)),r=o,1===s)break}return r},t.prototype.createSyntaxList=function(e){var t=n(286,e.pos,e.end,this);t._children=[];for(var r=e.pos,i=0,s=e;i<s.length;i++){var o=s[i];r<o.pos&&(r=this.addSyntheticNodes(t._children,r,o.pos)),t._children.push(o),r=o.end}return r<e.end&&this.addSyntheticNodes(t._children,r,e.end),t},t.prototype.createChildren=function(t){var n=this;if(e.isNodeKind(this.kind)){if(e.isJSDocCommentContainingNode(this)){var r=[];return this.forEachChild((function(e){r.push(e)})),void(this._children=r)}var i=[];e.scanner.setText((t||this.getSourceFile()).text);var s=this.pos,o=function(e){s=n.addSyntheticNodes(i,s,e.pos),i.push(e),s=e.end};if(this.jsDoc)for(var a=0,l=this.jsDoc;a<l.length;a++){o(l[a])}s=this.pos,e.forEachChild(this,o,(function(e){s<e.pos&&(s=n.addSyntheticNodes(i,s,e.pos)),i.push(n.createSyntaxList(e)),s=e.end})),s<this.end&&this.addSyntheticNodes(i,s,this.end),e.scanner.setText(void 0),this._children=i}else this._children=e.emptyArray},t.prototype.getChildCount=function(e){return this._children||this.createChildren(e),this._children.length},t.prototype.getChildAt=function(e,t){return this._children||this.createChildren(t),this._children[e]},t.prototype.getChildren=function(e){return this._children||this.createChildren(e),this._children},t.prototype.getFirstToken=function(t){var n=this.getChildren(t);if(n.length){var r=e.find(n,(function(e){return e.kind<267||e.kind>285}));return r.kind<143?r:r.getFirstToken(t)}},t.prototype.getLastToken=function(t){var n=this.getChildren(t),r=e.lastOrUndefined(n);if(r)return r.kind<143?r:r.getLastToken(t)},t.prototype.forEachChild=function(t,n){return e.forEachChild(this,t,n)},t}(),i=function(){function t(e,t){this.pos=e,this.end=t,this.flags=0,this.parent=void 0}return t.prototype.getSourceFile=function(){return e.getSourceFileOfNode(this)},t.prototype.getStart=function(t,n){return e.getTokenPosOfNode(this,t,n)},t.prototype.getFullStart=function(){return this.pos},t.prototype.getEnd=function(){return this.end},t.prototype.getWidth=function(e){return this.getEnd()-this.getStart(e)},t.prototype.getFullWidth=function(){return this.end-this.pos},t.prototype.getLeadingTriviaWidth=function(e){return this.getStart(e)-this.pos},t.prototype.getFullText=function(e){return(e||this.getSourceFile()).text.substring(this.pos,this.end)},t.prototype.getText=function(e){return(e||this.getSourceFile()).text.substring(this.getStart(),this.getEnd())},t.prototype.getChildCount=function(){return 0},t.prototype.getChildAt=function(){},t.prototype.getChildren=function(){return e.emptyArray},t.prototype.getFirstToken=function(){},t.prototype.getLastToken=function(){},t.prototype.forEachChild=function(){},t}(),s=function(){function t(e,t){this.flags=e,this.escapedName=t}return t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"name",{get:function(){return e.symbolName(this)},enumerable:!0,configurable:!0}),t.prototype.getEscapedName=function(){return this.escapedName},t.prototype.getName=function(){return this.name},t.prototype.getDeclarations=function(){return this.declarations},t.prototype.getDocumentationComment=function(){return void 0===this.documentationComment&&(this.documentationComment=e.JsDoc.getJsDocCommentsFromDeclarations(this.declarations)),this.documentationComment},t.prototype.getJsDocTags=function(){return void 0===this.tags&&(this.tags=e.JsDoc.getJsDocTagsFromDeclarations(this.declarations)),this.tags},t}(),o=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.kind=t,i}return __extends(t,e),t}(i),a=function(t){function n(e,n,r){return t.call(this,n,r)||this}return __extends(n,t),Object.defineProperty(n.prototype,"text",{get:function(){return e.idText(this)},enumerable:!0,configurable:!0}),n}(i);a.prototype.kind=71;var l=function(){function e(e,t){this.checker=e,this.flags=t}return e.prototype.getFlags=function(){return this.flags},e.prototype.getSymbol=function(){return this.symbol},e.prototype.getProperties=function(){return this.checker.getPropertiesOfType(this)},e.prototype.getProperty=function(e){return this.checker.getPropertyOfType(this,e)},e.prototype.getApparentProperties=function(){return this.checker.getAugmentedPropertiesOfType(this)},e.prototype.getCallSignatures=function(){return this.checker.getSignaturesOfType(this,0)},e.prototype.getConstructSignatures=function(){return this.checker.getSignaturesOfType(this,1)},e.prototype.getStringIndexType=function(){return this.checker.getIndexTypeOfType(this,0)},e.prototype.getNumberIndexType=function(){return this.checker.getIndexTypeOfType(this,1)},e.prototype.getBaseTypes=function(){return 32768&this.flags&&3&this.objectFlags?this.checker.getBaseTypes(this):void 0},e.prototype.getNonNullableType=function(){return this.checker.getNonNullableType(this)},e}(),c=function(){function t(e){this.checker=e}return t.prototype.getDeclaration=function(){return this.declaration},t.prototype.getTypeParameters=function(){return this.typeParameters},t.prototype.getParameters=function(){return this.parameters},t.prototype.getReturnType=function(){return this.checker.getReturnTypeOfSignature(this)},t.prototype.getDocumentationComment=function(){return void 0===this.documentationComment&&(this.documentationComment=this.declaration?e.JsDoc.getJsDocCommentsFromDeclarations([this.declaration]):[]),this.documentationComment},t.prototype.getJsDocTags=function(){return void 0===this.jsDocTags&&(this.jsDocTags=this.declaration?e.JsDoc.getJsDocTagsFromDeclarations([this.declaration]):[]),this.jsDocTags},t}(),u=function(t){function n(e,n,r){return t.call(this,e,n,r)||this}return __extends(n,t),n.prototype.update=function(t,n){return e.updateSourceFile(this,t,n)},n.prototype.getLineAndCharacterOfPosition=function(t){return e.getLineAndCharacterOfPosition(this,t)},n.prototype.getLineStarts=function(){return e.getLineStarts(this)},n.prototype.getPositionOfLineAndCharacter=function(t,n){return e.getPositionOfLineAndCharacter(this,t,n)},n.prototype.getLineEndOfPosition=function(e){var t,n=this.getLineAndCharacterOfPosition(e).line,r=this.getLineStarts();n+1>=r.length&&(t=this.getEnd()),t||(t=r[n+1]-1);var i=this.getFullText();return"\n"===i[t]&&"\r"===i[t-1]?t-1:t},n.prototype.getNamedDeclarations=function(){return this.namedDeclarations||(this.namedDeclarations=this.computeNamedDeclarations()),this.namedDeclarations},n.prototype.computeNamedDeclarations=function(){var t=e.createMultiMap();return e.forEachChild(this,(function i(s){switch(s.kind){case 228:case 186:case 151:case 150:var o=s,a=r(o);if(a){var l=function(e){var n=t.get(e);n||t.set(e,n=[]);return n}(a),c=e.lastOrUndefined(l);c&&o.parent===c.parent&&o.symbol===c.symbol?o.body&&!c.body&&(l[l.length-1]=o):l.push(o)}e.forEachChild(s,i);break;case 229:case 199:case 230:case 231:case 232:case 233:case 237:case 246:case 242:case 239:case 240:case 153:case 154:case 163:n(s),e.forEachChild(s,i);break;case 146:if(!e.hasModifier(s,92))break;case 226:case 176:var u=s;if(e.isBindingPattern(u.name)){e.forEachChild(u.name,i);break}u.initializer&&i(u.initializer);case 264:case 149:case 148:n(s);break;case 244:s.exportClause&&e.forEach(s.exportClause.elements,i);break;case 238:var d=s.importClause;d&&(d.name&&n(d),d.namedBindings&&(240===d.namedBindings.kind?n(d.namedBindings):e.forEach(d.namedBindings.elements,i)));break;case 194:0!==e.getSpecialPropertyAssignmentKind(s)&&n(s);default:e.forEachChild(s,i)}})),t;function n(e){var n=r(e);n&&t.add(n,e)}function r(t){var n=e.getNameOfDeclaration(t);if(n){var r=e.getTextOfIdentifierOrLiteral(n);if(void 0!==r)return r;if(144===n.kind){var i=n.expression;return 179===i.kind?i.name.text:e.getTextOfIdentifierOrLiteral(i)}}}},n}(r),d=function(){function t(e,t,n){this.fileName=e,this.text=t,this.skipTrivia=n}return t.prototype.getLineAndCharacterOfPosition=function(t){return e.getLineAndCharacterOfPosition(this,t)},t}();function p(t){var n=!0;for(var r in t)if(e.hasProperty(t,r)&&!h(r)){n=!1;break}if(n)return t;var i={};for(var r in t){if(e.hasProperty(t,r))i[h(r)?r:r.charAt(0).toLowerCase()+r.substr(1)]=t[r]}return i}function h(e){return!e.length||e.charAt(0)===e.charAt(0).toLowerCase()}function f(){return{target:1,jsx:1}}e.toEditorSettings=p,e.displayPartsToString=function(t){return t?e.map(t,(function(e){return e.text})).join(""):""},e.getDefaultCompilerOptions=f,e.getSupportedCodeFixes=function(){return e.codefix.getSupportedErrorCodes()};var m=function(){function t(t,n){this.host=t,this.currentDirectory=t.getCurrentDirectory(),this.fileNameToEntry=e.createMap();for(var r=0,i=t.getScriptFileNames();r<i.length;r++){var s=i[r];this.createEntry(s,e.toPath(s,this.currentDirectory,n))}this._compilationSettings=t.getCompilationSettings()||{target:1,jsx:1}}return t.prototype.compilationSettings=function(){return this._compilationSettings},t.prototype.createEntry=function(t,n){var r,i=this.host.getScriptSnapshot(t);return r=i?{hostFileName:t,version:this.host.getScriptVersion(t),scriptSnapshot:i,scriptKind:e.getScriptKind(t,this.host)}:t,this.fileNameToEntry.set(n,r),r},t.prototype.getEntryByPath=function(e){return this.fileNameToEntry.get(e)},t.prototype.getHostFileInformation=function(t){var n=this.fileNameToEntry.get(t);return e.isString(n)?void 0:n},t.prototype.getOrCreateEntryByPath=function(t,n){var r=this.getEntryByPath(n)||this.createEntry(t,n);return e.isString(r)?void 0:r},t.prototype.getRootFileNames=function(){return e.arrayFrom(this.fileNameToEntry.values(),(function(t){return e.isString(t)?t:t.hostFileName}))},t.prototype.getVersion=function(e){var t=this.getHostFileInformation(e);return t&&t.version},t.prototype.getScriptSnapshot=function(e){var t=this.getHostFileInformation(e);return t&&t.scriptSnapshot},t}(),_=function(){function t(e){this.host=e}return t.prototype.getCurrentSourceFile=function(t){var n=this.host.getScriptSnapshot(t);if(!n)throw new Error("Could not find file: '"+t+"'.");var r,i=e.getScriptKind(t,this.host),s=this.host.getScriptVersion(t);if(this.currentFileName!==t)r=y(t,n,5,s,!0,i);else if(this.currentFileVersion!==s){var o=n.getChangeRange(this.currentFileScriptSnapshot);r=b(this.currentSourceFile,n,s,o)}return r&&(this.currentFileVersion=s,this.currentFileName=t,this.currentFileScriptSnapshot=n,this.currentSourceFile=r),this.currentSourceFile},t}();function g(e,t,n){e.version=n,e.scriptSnapshot=t}function y(t,n,r,i,s,o){var a=n.getText(0,n.getLength()),l=e.createSourceFile(t,a,r,s,o);return g(l,n,i),l}function b(t,n,r,i,s){if(i&&r!==t.version&&!e.disableIncrementalParsing){var o=void 0,a=0!==i.span.start?t.text.substr(0,i.span.start):"",l=e.textSpanEnd(i.span)!==t.text.length?t.text.substr(e.textSpanEnd(i.span)):"";if(0===i.newLength)o=a&&l?a+l:a||l;else{var c=n.getText(i.span.start,i.span.start+i.newLength);o=a&&l?a+c+l:a?a+c:c+l}var u=e.updateSourceFile(t,o,i,s);return g(u,n,r),u.nameTable=void 0,t!==u&&t.scriptSnapshot&&(t.scriptSnapshot.dispose&&t.scriptSnapshot.dispose(),t.scriptSnapshot=void 0),u}return y(t.fileName,n,t.languageVersion,r,!0,t.scriptKind)}e.createLanguageServiceSourceFile=y,e.disableIncrementalParsing=!1,e.updateLanguageServiceSourceFile=b;var v=function(){function t(e){this.cancellationToken=e}return t.prototype.isCancellationRequested=function(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()},t.prototype.throwIfCancellationRequested=function(){if(this.isCancellationRequested())throw new e.OperationCanceledException},t}(),T=function(){function t(e,t){void 0===t&&(t=20),this.hostCancellationToken=e,this.throttleWaitMilliseconds=t,this.lastCancellationCheckTime=0}return t.prototype.isCancellationRequested=function(){var t=e.timestamp();return Math.abs(t-this.lastCancellationCheckTime)>=this.throttleWaitMilliseconds&&(this.lastCancellationCheckTime=t,this.hostCancellationToken.isCancellationRequested())},t.prototype.throwIfCancellationRequested=function(){if(this.isCancellationRequested())throw new e.OperationCanceledException},t}();function k(e){switch(e.kind){case 253:case 255:case 261:case 262:case 151:case 153:case 154:return!0}return!1}function E(t,n){var r=e.unescapeLeadingUnderscores(e.getTextOfPropertyName(n));if(r&&t){var i=[],s=t.getProperty(r);if(65536&t.flags)return e.forEach(t.types,(function(e){var t=e.getProperty(r);t&&i.push(t)})),i;if(s)return i.push(s),i}}e.ThrottledCancellationToken=T,e.createLanguageService=function(n,r){void 0===r&&(r=e.createDocumentRegistry(n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames(),n.getCurrentDirectory()));var i,s,o=new _(n);t=t||new e.formatting.RulesProvider;var a=0,l=n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames(),c=new v(n.getCancellationToken&&n.getCancellationToken()),u=n.getCurrentDirectory();function d(e){n.log&&n.log(e)}!e.localizedDiagnosticMessages&&n.getLocalizedDiagnosticMessages&&(e.localizedDiagnosticMessages=n.getLocalizedDiagnosticMessages());var h=e.createGetCanonicalFileName(l);function f(e){var t=i.getSourceFile(e);if(!t)throw new Error("Could not find file: '"+e+"'.");return t}function g(e){return t.ensureUpToDate(e),t}function y(){if(n.getProjectVersion){var t=n.getProjectVersion();if(t){if(s===t&&!n.hasChangedAutomaticTypeDirectiveNames)return;s=t}}var o=n.getTypeRootsVersion?n.getTypeRootsVersion():0;a!==o&&(d("TypeRoots version has changed; provide new program"),i=void 0,a=o);var p=new m(n,h),f=p.getRootFileNames(),_=n.hasInvalidatedResolution||e.returnFalse;if(!e.isProgramUptoDate(i,f,p.compilationSettings(),(function(e){return p.getVersion(e)}),v,_,n.hasChangedAutomaticTypeDirectiveNames)){var g=p.compilationSettings(),y={getSourceFile:function(t,n,r,i){return T(t,e.toPath(t,u,h),n,r,i)},getSourceFileByPath:T,getCancellationToken:function(){return c},getCanonicalFileName:h,useCaseSensitiveFileNames:function(){return l},getNewLine:function(){return e.getNewLineCharacter(g,{newLine:e.getNewLineOrDefaultFromHost(n)})},getDefaultLibFileName:function(e){return n.getDefaultLibFileName(e)},writeFile:e.noop,getCurrentDirectory:function(){return u},fileExists:v,readFile:function(t){var r=e.toPath(t,u,h),i=p.getEntryByPath(r);return i?e.isString(i)?void 0:i.scriptSnapshot.getText(0,i.scriptSnapshot.getLength()):n.readFile&&n.readFile(t)},directoryExists:function(t){return e.directoryProbablyExists(t,n)},getDirectories:function(e){return n.getDirectories?n.getDirectories(e):[]},onReleaseOldSourceFile:function(e,t){var n=r.getKeyForCompilationSettings(t);r.releaseDocumentWithKey(e.path,n)},hasInvalidatedResolution:_,hasChangedAutomaticTypeDirectiveNames:n.hasChangedAutomaticTypeDirectiveNames};n.trace&&(y.trace=function(e){return n.trace(e)}),n.resolveModuleNames&&(y.resolveModuleNames=function(e,t,r){return n.resolveModuleNames(e,t,r)}),n.resolveTypeReferenceDirectives&&(y.resolveTypeReferenceDirectives=function(e,t){return n.resolveTypeReferenceDirectives(e,t)});var b=r.getKeyForCompilationSettings(g);return i=e.createProgram(f,g,y,i),p=void 0,void i.getTypeChecker()}function v(t){var r=e.toPath(t,u,h),i=p.getEntryByPath(r);return i?!e.isString(i):n.fileExists&&n.fileExists(t)}function T(t,n,s,o,a){e.Debug.assert(void 0!==p);var l=p.getOrCreateEntryByPath(t,n);if(l){if(!a){var c=i&&i.getSourceFileByPath(n);if(c)return e.Debug.assertEqual(l.scriptKind,c.scriptKind,"Registered script kind should match new script kind.",n),r.updateDocumentWithKey(t,n,g,b,l.scriptSnapshot,l.version,l.scriptKind)}return r.acquireDocumentWithKey(t,n,g,b,l.scriptSnapshot,l.version,l.scriptKind)}}}function b(){return y(),i}function T(t,n,r){y();var s=e.map(r,(function(e){return i.getSourceFile(e)})),o=f(t);return e.DocumentHighlights.getDocumentHighlights(i,c,o,n,s)}function k(t,n,r){y();var s=[];if(r&&r.isForRename)for(var o=0,a=i.getSourceFiles();o<a.length;o++){var l=a[o];i.isSourceFileDefaultLibrary(l)||s.push(l)}else s=i.getSourceFiles().slice();return e.FindAllReferences.findReferencedEntries(i,c,s,f(t),n,r)}function E(e){return o.getCurrentSourceFile(e)}function x(t){var r=e.getScriptKind(t,n);return 3===r||4===r}function S(e,t,r){var i="number"==typeof t?[t,void 0]:[t.pos,t.end];return{file:e,startPosition:i[0],endPosition:i[1],program:b(),newLineCharacter:r?r.newLineCharacter:n.getNewLine(),host:n,rulesProvider:g(r),cancellationToken:c}}return{dispose:function(){i&&(e.forEach(i.getSourceFiles(),(function(e){return r.releaseDocument(e.fileName,i.getCompilerOptions())})),i=void 0),n=void 0},cleanupSemanticCache:function(){i=void 0},getSyntacticDiagnostics:function(e){return y(),i.getSyntacticDiagnostics(f(e),c).slice()},getSemanticDiagnostics:function(e){y();var t=f(e),n=i.getSemanticDiagnostics(t,c);if(!i.getCompilerOptions().declaration)return n.slice();var r=i.getDeclarationDiagnostics(t,c);return n.concat(r)},getCompilerOptionsDiagnostics:function(){return y(),i.getOptionsDiagnostics(c).concat(i.getGlobalDiagnostics(c))},getSyntacticClassifications:function(t,n){return e.getSyntacticClassifications(c,o.getCurrentSourceFile(t),n)},getSemanticClassifications:function(t,n){return x(t)?(y(),e.getSemanticClassifications(i.getTypeChecker(),c,f(t),i.getClassifiableNames(),n)):[]},getEncodedSyntacticClassifications:function(t,n){return e.getEncodedSyntacticClassifications(c,o.getCurrentSourceFile(t),n)},getEncodedSemanticClassifications:function(t,n){return x(t)?(y(),e.getEncodedSemanticClassifications(i.getTypeChecker(),c,f(t),i.getClassifiableNames(),n)):{spans:[],endOfLineState:0}},getCompletionsAtPosition:function(t,r){return y(),e.Completions.getCompletionsAtPosition(n,i.getTypeChecker(),d,i.getCompilerOptions(),f(t),r,i.getSourceFiles())},getCompletionEntryDetails:function(t,r,s,o,a){y();var l=o?g(o):void 0;return e.Completions.getCompletionEntryDetails(i.getTypeChecker(),d,i.getCompilerOptions(),f(t),r,{name:s,source:a},i.getSourceFiles(),n,l)},getCompletionEntrySymbol:function(t,n,r,s){return y(),e.Completions.getCompletionEntrySymbol(i.getTypeChecker(),d,i.getCompilerOptions(),f(t),n,{name:r,source:s},i.getSourceFiles())},getSignatureHelpItems:function(t,n){y();var r=f(t);return e.SignatureHelp.getSignatureHelpItems(i,r,n,c)},getQuickInfoAtPosition:function(t,n){y();var r=f(t),s=e.getTouchingPropertyName(r,n,!0);if(s!==r&&!e.isLabelName(s)){var o=i.getTypeChecker(),a=function(t,n){if((e.isIdentifier(t)||e.isStringLiteral(t))&&e.isPropertyAssignment(t.parent)&&t.parent.name===t){var r=n.getContextualType(t.parent.parent);if(r){var i=n.getPropertyOfType(r,e.getTextOfIdentifierOrLiteral(t));if(i)return i}}return n.getSymbolAtLocation(t)}(s,o);if(a&&!o.isUnknownSymbol(a)){var l=e.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(o,a,r,e.getContainerNode(s),s);return{kind:l.symbolKind,kindModifiers:e.SymbolDisplay.getSymbolModifiers(a),textSpan:e.createTextSpan(s.getStart(),s.getWidth()),displayParts:l.displayParts,documentation:l.documentation,tags:l.tags}}switch(s.kind){case 71:case 179:case 143:case 99:case 169:case 97:var c=o.getTypeAtLocation(s);if(c)return{kind:"",kindModifiers:"",textSpan:e.createTextSpan(s.getStart(),s.getWidth()),displayParts:e.typeToDisplayParts(o,c,e.getContainerNode(s)),documentation:c.symbol?c.symbol.getDocumentationComment():void 0,tags:c.symbol?c.symbol.getJsDocTags():void 0}}}},getDefinitionAtPosition:function(t,n){return y(),e.GoToDefinition.getDefinitionAtPosition(i,f(t),n)},getImplementationAtPosition:function(t,n){return y(),e.FindAllReferences.getImplementationsAtPosition(i,c,i.getSourceFiles(),f(t),n)},getTypeDefinitionAtPosition:function(t,n){return y(),e.GoToDefinition.getTypeDefinitionAtPosition(i.getTypeChecker(),f(t),n)},getReferencesAtPosition:function(e,t){return k(e,t)},findReferences:function(t,n){return y(),e.FindAllReferences.findReferencedSymbols(i,c,i.getSourceFiles(),f(t),n)},getOccurrencesAtPosition:function(t,n){var r=function(e,t){return n(T(e,t,[e]));function n(e){if(e){for(var t=[],n=0,r=e;n<r.length;n++)for(var i=r[n],s=0,o=i.highlightSpans;s<o.length;s++){var a=o[s];t.push({fileName:i.fileName,textSpan:a.textSpan,isWriteAccess:"writtenReference"===a.kind,isDefinition:!1,isInString:a.isInString})}return t}}}(t,n);if(r){var i=h(e.normalizeSlashes(t));r=e.filter(r,(function(t){return h(e.normalizeSlashes(t.fileName))===i}))}return r},getDocumentHighlights:T,getNameOrDottedNameSpan:function(t,n,r){var i=o.getCurrentSourceFile(t),s=e.getTouchingPropertyName(i,n,!1);if(s!==i){switch(s.kind){case 179:case 143:case 9:case 86:case 101:case 95:case 97:case 99:case 169:case 71:break;default:return}for(var a=s;;)if(e.isRightSideOfPropertyAccess(a)||e.isRightSideOfQualifiedName(a))a=a.parent;else{if(!e.isNameOfModuleDeclaration(a))break;if(233!==a.parent.parent.kind||a.parent.parent.body!==a.parent)break;a=a.parent.parent.name}return e.createTextSpanFromBounds(a.getStart(),s.getEnd())}},getBreakpointStatementAtPosition:function(t,n){var r=o.getCurrentSourceFile(t);return e.BreakpointResolver.spanInSourceFileAtLocation(r,n)},getNavigateToItems:function(t,n,r,s){y();var o=r?[f(r)]:i.getSourceFiles();return e.NavigateTo.getNavigateToItems(o,i.getTypeChecker(),c,t,n,s)},getRenameInfo:function(t,r){y();var s=n.getDefaultLibFileName(n.getCompilationSettings());return e.Rename.getRenameInfo(i.getTypeChecker(),s,h,f(t),r)},findRenameLocations:function(e,t,n,r){return k(e,t,{findInStrings:n,findInComments:r,isForRename:!0})},getNavigationBarItems:function(t){return e.NavigationBar.getNavigationBarItems(o.getCurrentSourceFile(t),c)},getNavigationTree:function(t){return e.NavigationBar.getNavigationTree(o.getCurrentSourceFile(t),c)},getOutliningSpans:function(t){var n=o.getCurrentSourceFile(t);return e.OutliningElementsCollector.collectElements(n,c)},getTodoComments:function(t,n){y();var r=f(t);c.throwIfCancellationRequested();var i,s,o=r.text,a=[];if(n.length>0&&(s=r.fileName,!e.stringContains(s,"/node_modules/")))for(var l=function(){var t="("+/(?:^(?:\s|\*)*)/.source+"|"+/(?:\/\/+\s*)/.source+"|"+/(?:\/\*+\s*)/.source+")",r="(?:"+e.map(n,(function(e){return"("+(e.text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")")})).join("|")+")";return new RegExp(t+"("+r+/(?:.*?)/.source+")"+/(?:$|\*\/)/.source,"gim")}(),u=void 0;u=l.exec(o);){c.throwIfCancellationRequested();e.Debug.assert(u.length===n.length+3);var d=u[1],p=u.index+d.length;if(e.isInComment(r,p)){for(var h=void 0,m=0;m<n.length;m++)u[m+3]&&(h=n[m]);if(e.Debug.assert(void 0!==h),!((i=o.charCodeAt(p+h.text.length))>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57)){var _=u[2];a.push({descriptor:h,message:_,position:p})}}}return a},getBraceMatchingAtPosition:function(t,n){var r=o.getCurrentSourceFile(t),i=[],s=e.getTouchingToken(r,n,!1);if(s.getStart(r)===n){var a=function(e){switch(e.kind){case 17:return 18;case 19:return 20;case 21:return 22;case 27:return 29;case 18:return 17;case 20:return 19;case 22:return 21;case 29:return 27}return}(s);if(a)for(var l=0,c=s.parent.getChildren(r);l<c.length;l++){var u=c[l];if(u.kind===a){var d=e.createTextSpan(s.getStart(r),s.getWidth(r)),p=e.createTextSpan(u.getStart(r),u.getWidth(r));d.start<p.start?i.push(d,p):i.push(p,d);break}}}return i},getIndentationAtPosition:function(t,n,r){var i=e.timestamp(),s=p(r),a=o.getCurrentSourceFile(t);d("getIndentationAtPosition: getCurrentSourceFile: "+(e.timestamp()-i)),i=e.timestamp();var l=e.formatting.SmartIndenter.getIndentation(n,a,s);return d("getIndentationAtPosition: computeIndentation  : "+(e.timestamp()-i)),l},getFormattingEditsForRange:function(t,n,r,i){var s=o.getCurrentSourceFile(t),a=p(i);return e.formatting.formatSelection(n,r,s,g(a),a)},getFormattingEditsForDocument:function(t,n){var r=o.getCurrentSourceFile(t),i=p(n);return e.formatting.formatDocument(r,g(i),i)},getFormattingEditsAfterKeystroke:function(t,n,r,i){var s=o.getCurrentSourceFile(t),a=p(i);if(!e.isInComment(s,n)){if("{"===r)return e.formatting.formatOnOpeningCurly(n,s,g(a),a);if("}"===r)return e.formatting.formatOnClosingCurly(n,s,g(a),a);if(";"===r)return e.formatting.formatOnSemicolon(n,s,g(a),a);if("\n"===r)return e.formatting.formatOnEnter(n,s,g(a),a)}return[]},getDocCommentTemplateAtPosition:function(t,r){return e.JsDoc.getDocCommentTemplateAtPosition(e.getNewLineOrDefaultFromHost(n),o.getCurrentSourceFile(t),r)},isValidBraceCompletionAtPosition:function(t,n,r){if(60===r)return!1;var i=o.getCurrentSourceFile(t);if(e.isInString(i,n))return!1;if(e.isInsideJsxElementOrAttribute(i,n))return 123===r;if(e.isInTemplateString(i,n))return!1;switch(r){case 39:case 34:case 96:return!e.isInComment(i,n)}return!0},getSpanOfEnclosingComment:function(t,n,r){var i=o.getCurrentSourceFile(t),s=e.formatting.getRangeOfEnclosingComment(i,n,r);return s&&e.createTextSpanFromRange(s)},getCodeFixesAtPosition:function(t,r,s,o,a){y();var l=f(t),u=e.createTextSpanFromBounds(r,s),d=e.getNewLineOrDefaultFromHost(n),p=g(a);return e.flatMap(e.deduplicate(o),(function(t){return c.throwIfCancellationRequested(),e.codefix.getFixes({errorCode:t,sourceFile:l,span:u,program:i,newLineCharacter:d,host:n,cancellationToken:c,rulesProvider:p})}))},applyCodeActionCommand:function(t,r){switch(t=e.toPath(t,u,h),r.type){case"install package":return n.installPackage?n.installPackage({fileName:t,packageName:r.packageName}):Promise.reject("Host does not implement `installPackage`");default:e.Debug.fail()}},getEmitOutput:function(t,r){y();var s=f(t),o=n.getCustomTransformers&&n.getCustomTransformers();return e.getFileEmitOutput(i,s,r,c,o)},getNonBoundSourceFile:E,getSourceFile:function(e){return E(e)},getProgram:b,getApplicableRefactors:function(t,n){y();var r=f(t);return e.refactor.getApplicableRefactors(S(r,n))},getEditsForRefactor:function(t,n,r,i,s){y();var o=f(t);return e.refactor.getEditsForRefactor(S(o,r,n),i,s)}}},e.getNameTable=function(t){return t.nameTable||function(t){var n=t.nameTable=e.createUnderscoreEscapedMap();t.forEachChild((function t(r){if(e.isIdentifier(r)&&r.escapedText||e.isStringOrNumericLiteral(r)&&function(t){return e.isDeclarationName(t)||248===t.parent.kind||function(e){return e&&e.parent&&180===e.parent.kind&&e.parent.argumentExpression===e}(t)||e.isLiteralComputedPropertyDeclarationName(t)}(r)){var i=e.getEscapedTextOfIdentifierOrLiteral(r);n.set(i,void 0===n.get(i)?r.pos:-1)}if(e.forEachChild(r,t),e.hasJSDocNodes(r))for(var s=0,o=r.jsDoc;s<o.length;s++){var a=o[s];e.forEachChild(a,t)}}))}(t),t.nameTable},e.getContainingObjectLiteralElement=function(e){switch(e.kind){case 9:case 8:if(144===e.parent.kind)return k(e.parent.parent)?e.parent.parent:void 0;case 71:return!k(e.parent)||178!==e.parent.parent.kind&&254!==e.parent.parent.kind||e.parent.name!==e?void 0:e.parent}},e.getPropertySymbolsFromContextualType=function(e,t){var n=t.parent;return E(e.getContextualType(n),t.name)},e.getPropertySymbolsFromType=E,e.getDefaultLibFilePath=function(t){if("undefined"!=typeof __dirname)return __dirname+e.directorySeparator+e.getDefaultLibFileName(t);throw new Error("getDefaultLibFilePath is only supported when consumed as a node module. ")},e.objectAllocator={getNodeConstructor:function(){return r},getTokenConstructor:function(){return o},getIdentifierConstructor:function(){return a},getSourceFileConstructor:function(){return u},getSymbolConstructor:function(){return s},getTypeConstructor:function(){return l},getSignatureConstructor:function(){return c},getSourceMapSourceConstructor:function(){return d}}}(ts||(ts={})),function(e){!function(t){t.spanInSourceFileAtLocation=function(t,n){if(!t.isDeclarationFile){var r=e.getTokenAtPosition(t,n,!1),i=t.getLineAndCharacterOfPosition(n).line;if((!(t.getLineAndCharacterOfPosition(r.getStart(t)).line>i)||(r=e.findPrecedingToken(r.pos,t))&&t.getLineAndCharacterOfPosition(r.getEnd()).line===i)&&!e.isInAmbientContext(r))return u(r)}function s(n,r){var i=n.decorators?e.skipTrivia(t.text,n.decorators.end):n.getStart(t);return e.createTextSpanFromBounds(i,(r||n).getEnd())}function o(t,n){return s(t,e.findNextToken(n,n.parent))}function a(e,n){return e&&i===t.getLineAndCharacterOfPosition(e.getStart(t)).line?u(e):u(n)}function l(n){return u(e.findPrecedingToken(n.pos,t))}function c(t){return u(e.findNextToken(t,t.parent))}function u(n){if(n)switch(n.kind){case 208:return h(n.declarationList.declarations[0]);case 226:case 149:case 148:return h(n);case 146:return function t(n){if(e.isBindingPattern(n.name))return g(n.name);if(function(t){return!!t.initializer||void 0!==t.dotDotDotToken||e.hasModifier(t,12)}(n))return s(n);var r=n.parent,i=e.indexOf(r.parameters,n);return i?t(r.parameters[i-1]):u(r.body)}(n);case 228:case 151:case 150:case 153:case 154:case 152:case 186:case 187:return function(e){if(!e.body)return;if(f(e))return s(e);return u(e.body)}(n);case 207:if(e.isFunctionBlock(n))return function(e){var t=e.statements.length?e.statements[0]:e.getLastToken();if(f(e.parent))return a(e.parent,t);return u(t)}(n);case 234:return m(n);case 260:return m(n.block);case 210:return s(n.expression);case 219:return s(n.getChildAt(0),n.expression);case 213:return o(n,n.expression);case 212:return u(n.statement);case 225:return s(n.getChildAt(0));case 211:return o(n,n.expression);case 222:return u(n.statement);case 218:case 217:return s(n.getChildAt(0),n.label);case 214:return function(e){if(e.initializer)return _(e);if(e.condition)return s(e.condition);if(e.incrementor)return s(e.incrementor)}(n);case 215:return o(n,n.expression);case 216:return _(n);case 221:return o(n,n.expression);case 257:case 258:return u(n.statements[0]);case 224:return m(n.tryBlock);case 223:case 243:return s(n,n.expression);case 237:return s(n,n.moduleReference);case 238:case 244:return s(n,n.moduleSpecifier);case 233:if(1!==e.getModuleInstanceState(n))return;case 229:case 232:case 264:case 176:return s(n);case 220:return u(n.statement);case 147:return d=n.parent.decorators,e.createTextSpanFromBounds(e.skipTrivia(t.text,d.pos),d.end);case 174:case 175:return g(n);case 230:case 231:return;case 25:case 1:return a(e.findPrecedingToken(n.pos,t));case 26:return l(n);case 17:return function(n){switch(n.parent.kind){case 232:var r=n.parent;return a(e.findPrecedingToken(n.pos,t,n.parent),r.members.length?r.members[0]:r.getLastToken(t));case 229:var i=n.parent;return a(e.findPrecedingToken(n.pos,t,n.parent),i.members.length?i.members[0]:i.getLastToken(t));case 235:return a(n.parent.parent,n.parent.clauses[0])}return u(n.parent)}(n);case 18:return function(t){switch(t.parent.kind){case 234:if(1!==e.getModuleInstanceState(t.parent.parent))return;case 232:case 229:return s(t);case 207:if(e.isFunctionBlock(t.parent))return s(t);case 260:return u(e.lastOrUndefined(t.parent.statements));case 235:var n=t.parent,r=e.lastOrUndefined(n.clauses);return r?u(e.lastOrUndefined(r.statements)):void 0;case 174:var i=t.parent;return u(e.lastOrUndefined(i.elements)||i);default:if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(t.parent)){var o=t.parent;return s(e.lastOrUndefined(o.properties)||o)}return u(t.parent)}}(n);case 22:return function(t){switch(t.parent.kind){case 175:var n=t.parent;return s(e.lastOrUndefined(n.elements)||n);default:if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(t.parent)){var r=t.parent;return s(e.lastOrUndefined(r.elements)||r)}return u(t.parent)}}(n);case 19:return function(e){if(212===e.parent.kind||181===e.parent.kind||182===e.parent.kind)return l(e);if(185===e.parent.kind)return c(e);return u(e.parent)}(n);case 20:return function(e){switch(e.parent.kind){case 186:case 228:case 187:case 151:case 150:case 153:case 154:case 152:case 213:case 212:case 214:case 216:case 181:case 182:case 185:return l(e);default:return u(e.parent)}}(n);case 56:return function(t){if(e.isFunctionLike(t.parent)||261===t.parent.kind||146===t.parent.kind)return l(t);return u(t.parent)}(n);case 29:case 27:return function(e){if(184===e.parent.kind)return c(e);return u(e.parent)}(n);case 106:return function(e){if(212===e.parent.kind)return o(e,e.parent.expression);return u(e.parent)}(n);case 82:case 74:case 87:return c(n);case 142:return function(e){if(216===e.parent.kind)return c(e);return u(e.parent)}(n);default:if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(n))return y(n);if((71===n.kind||198===n.kind||261===n.kind||262===n.kind)&&e.isArrayLiteralOrObjectLiteralDestructuringPattern(n.parent))return s(n);if(194===n.kind){var r=n;if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(r.left))return y(r.left);if(58===r.operatorToken.kind&&e.isArrayLiteralOrObjectLiteralDestructuringPattern(r.parent))return s(n);if(26===r.operatorToken.kind)return u(r.left)}if(e.isPartOfExpression(n))switch(n.parent.kind){case 212:return l(n);case 147:return u(n.parent);case 214:case 216:return s(n);case 194:if(26===n.parent.operatorToken.kind)return s(n);break;case 187:if(n.parent.body===n)return s(n)}if(261===n.parent.kind&&n.parent.name===n&&!e.isArrayLiteralOrObjectLiteralDestructuringPattern(n.parent.parent))return u(n.parent.initializer);if(184===n.parent.kind&&n.parent.type===n)return c(n.parent.type);if(e.isFunctionLike(n.parent)&&n.parent.type===n)return l(n);if(226===n.parent.kind||146===n.parent.kind){var i=n.parent;if(i.initializer===n||i.type===n||e.isAssignmentOperator(n.kind))return l(n)}if(194===n.parent.kind){r=n.parent;if(e.isArrayLiteralOrObjectLiteralDestructuringPattern(r.left)&&(r.right===n||r.operatorToken===n))return l(n)}return u(n.parent)}var d;function p(n){return 227===n.parent.kind&&n.parent.declarations[0]===n?s(e.findPrecedingToken(n.pos,t,n.parent),n):s(n)}function h(n){return 215===n.parent.parent.kind?u(n.parent.parent):e.isBindingPattern(n.name)?g(n.name):n.initializer||e.hasModifier(n,1)||216===n.parent.parent.kind?p(n):227===n.parent.kind&&n.parent.declarations[0]!==n?u(e.findPrecedingToken(n.pos,t,n.parent)):void 0}function f(t){return e.hasModifier(t,1)||229===t.parent.kind&&152!==t.kind}function m(n){switch(n.parent.kind){case 233:if(1!==e.getModuleInstanceState(n.parent))return;case 213:case 211:case 215:return a(n.parent,n.statements[0]);case 214:case 216:return a(e.findPrecedingToken(n.pos,t,n.parent),n.statements[0])}return u(n.statements[0])}function _(e){if(227!==e.initializer.kind)return u(e.initializer);var t=e.initializer;return t.declarations.length>0?u(t.declarations[0]):void 0}function g(t){var n=e.forEach(t.elements,(function(e){return 200!==e.kind?e:void 0}));return n?u(n):176===t.parent.kind?s(t.parent):p(t.parent)}function y(t){e.Debug.assert(175!==t.kind&&174!==t.kind);var n=177===t.kind?t.elements:t.properties,r=e.forEach(n,(function(e){return 200!==e.kind?e:void 0}));return r?u(r):s(194===t.parent.kind?t.parent:t)}}}}(e.BreakpointResolver||(e.BreakpointResolver={}))}(ts||(ts={})),function(e){e.transform=function(t,n,r){var i=[];r=e.fixupCompilerOptions(r,i);var s=e.isArray(t)?t:[t],o=e.transformNodes(void 0,void 0,r,s,n,!0);return o.diagnostics=e.concatenate(o.diagnostics,i),o}}(ts||(ts={}));var debugObjectHost=function(){return this}(),ts,TypeScript;!function(e){function t(e,t){e&&e.log("*INTERNAL ERROR* - Exception in typescript services: "+t.message)}var n=function(){function t(e){this.scriptSnapshotShim=e}return t.prototype.getText=function(e,t){return this.scriptSnapshotShim.getText(e,t)},t.prototype.getLength=function(){return this.scriptSnapshotShim.getLength()},t.prototype.getChangeRange=function(t){var n=t,r=this.scriptSnapshotShim.getChangeRange(n.scriptSnapshotShim);if(null===r)return null;var i=JSON.parse(r);return e.createTextChangeRange(e.createTextSpan(i.span.start,i.span.length),i.newLength)},t.prototype.dispose=function(){"dispose"in this.scriptSnapshotShim&&this.scriptSnapshotShim.dispose()},t}(),r=function(){function t(t){var n=this;this.shimHost=t,this.loggingEnabled=!1,this.tracingEnabled=!1,"getModuleResolutionsForFile"in this.shimHost&&(this.resolveModuleNames=function(t,r){var i=JSON.parse(n.shimHost.getModuleResolutionsForFile(r));return e.map(t,(function(t){var n=e.getProperty(i,t);return n?{resolvedFileName:n,extension:e.extensionFromPath(n),isExternalLibraryImport:!1}:void 0}))}),"directoryExists"in this.shimHost&&(this.directoryExists=function(e){return n.shimHost.directoryExists(e)}),"getTypeReferenceDirectiveResolutionsForFile"in this.shimHost&&(this.resolveTypeReferenceDirectives=function(t,r){var i=JSON.parse(n.shimHost.getTypeReferenceDirectiveResolutionsForFile(r));return e.map(t,(function(t){return e.getProperty(i,t)}))})}return t.prototype.log=function(e){this.loggingEnabled&&this.shimHost.log(e)},t.prototype.trace=function(e){this.tracingEnabled&&this.shimHost.trace(e)},t.prototype.error=function(e){this.shimHost.error(e)},t.prototype.getProjectVersion=function(){if(this.shimHost.getProjectVersion)return this.shimHost.getProjectVersion()},t.prototype.getTypeRootsVersion=function(){return this.shimHost.getTypeRootsVersion?this.shimHost.getTypeRootsVersion():0},t.prototype.useCaseSensitiveFileNames=function(){return!!this.shimHost.useCaseSensitiveFileNames&&this.shimHost.useCaseSensitiveFileNames()},t.prototype.getCompilationSettings=function(){var e=this.shimHost.getCompilationSettings();if(null===e||""===e)throw Error("LanguageServiceShimHostAdapter.getCompilationSettings: empty compilationSettings");var t=JSON.parse(e);return t.allowNonTsExtensions=!0,t},t.prototype.getScriptFileNames=function(){var e=this.shimHost.getScriptFileNames();return this.files=JSON.parse(e)},t.prototype.getScriptSnapshot=function(e){var t=this.shimHost.getScriptSnapshot(e);return t&&new n(t)},t.prototype.getScriptKind=function(e){return"getScriptKind"in this.shimHost?this.shimHost.getScriptKind(e):0},t.prototype.getScriptVersion=function(e){return this.shimHost.getScriptVersion(e)},t.prototype.getLocalizedDiagnosticMessages=function(){var e=this.shimHost.getLocalizedDiagnosticMessages();if(null===e||""===e)return null;try{return JSON.parse(e)}catch(e){return this.log(e.description||"diagnosticMessages.generated.json has invalid JSON format"),null}},t.prototype.getCancellationToken=function(){var t=this.shimHost.getCancellationToken();return new e.ThrottledCancellationToken(t)},t.prototype.getCurrentDirectory=function(){return this.shimHost.getCurrentDirectory()},t.prototype.getDirectories=function(e){return JSON.parse(this.shimHost.getDirectories(e))},t.prototype.getDefaultLibFileName=function(e){return this.shimHost.getDefaultLibFileName(JSON.stringify(e))},t.prototype.readDirectory=function(t,n,r,i,s){var o=e.getFileMatcherPatterns(t,r,i,this.shimHost.useCaseSensitiveFileNames(),this.shimHost.getCurrentDirectory());return JSON.parse(this.shimHost.readDirectory(t,JSON.stringify(n),JSON.stringify(o.basePaths),o.excludePattern,o.includeFilePattern,o.includeDirectoryPattern,s))},t.prototype.readFile=function(e,t){return this.shimHost.readFile(e,t)},t.prototype.fileExists=function(e){return this.shimHost.fileExists(e)},t}();e.LanguageServiceShimHostAdapter=r;var i=function(){function t(e){var t=this;this.shimHost=e,this.useCaseSensitiveFileNames=!!this.shimHost.useCaseSensitiveFileNames&&this.shimHost.useCaseSensitiveFileNames(),"directoryExists"in this.shimHost&&(this.directoryExists=function(e){return t.shimHost.directoryExists(e)}),"realpath"in this.shimHost&&(this.realpath=function(e){return t.shimHost.realpath(e)})}return t.prototype.readDirectory=function(t,n,r,i,s){var o=e.getFileMatcherPatterns(t,r,i,this.shimHost.useCaseSensitiveFileNames(),this.shimHost.getCurrentDirectory());return JSON.parse(this.shimHost.readDirectory(t,JSON.stringify(n),JSON.stringify(o.basePaths),o.excludePattern,o.includeFilePattern,o.includeDirectoryPattern,s))},t.prototype.fileExists=function(e){return this.shimHost.fileExists(e)},t.prototype.readFile=function(e){return this.shimHost.readFile(e)},t.prototype.getDirectories=function(e){return JSON.parse(this.shimHost.getDirectories(e))},t}();function s(e,t,n,r){return o(e,t,!0,n,r)}function o(n,r,i,s,o){try{var a=function(t,n,r,i){var s;i&&(t.log(n),s=e.timestamp());var o=r();if(i){var a=e.timestamp();if(t.log(n+" completed in "+(a-s)+" msec"),e.isString(o)){var l=o;l.length>128&&(l=l.substring(0,128)+"..."),t.log("  result.length="+l.length+", result='"+JSON.stringify(l)+"'")}}return o}(n,r,s,o);return i?JSON.stringify({result:a}):a}catch(i){return i instanceof e.OperationCanceledException?JSON.stringify({canceled:!0}):(t(n,i),i.description=r,JSON.stringify({error:i}))}}e.CoreServicesShimHostAdapter=i;var a=function(){function e(e){this.factory=e,e.registerShim(this)}return e.prototype.dispose=function(e){this.factory.unregisterShim(this)},e}();function l(t,n){return t.map((function(t){return function(t,n){return{message:e.flattenDiagnosticMessageText(t.messageText,n),start:t.start,length:t.length,category:e.DiagnosticCategory[t.category].toLowerCase(),code:t.code}}(t,n)}))}e.realizeDiagnostics=l;var c=function(t){function n(e,n,r){var i=t.call(this,e)||this;return i.host=n,i.languageService=r,i.logPerformance=!1,i.logger=i.host,i}return __extends(n,t),n.prototype.forwardJSONCall=function(e,t){return s(this.logger,e,t,this.logPerformance)},n.prototype.dispose=function(e){this.logger.log("dispose()"),this.languageService.dispose(),this.languageService=null,debugObjectHost&&debugObjectHost.CollectGarbage&&(debugObjectHost.CollectGarbage(),this.logger.log("CollectGarbage()")),this.logger=null,t.prototype.dispose.call(this,e)},n.prototype.refresh=function(e){this.forwardJSONCall("refresh("+e+")",(function(){return null}))},n.prototype.cleanupSemanticCache=function(){var e=this;this.forwardJSONCall("cleanupSemanticCache()",(function(){return e.languageService.cleanupSemanticCache(),null}))},n.prototype.realizeDiagnostics=function(t){var n=e.getNewLineOrDefaultFromHost(this.host);return e.realizeDiagnostics(t,n)},n.prototype.getSyntacticClassifications=function(t,n,r){var i=this;return this.forwardJSONCall("getSyntacticClassifications('"+t+"', "+n+", "+r+")",(function(){return i.languageService.getSyntacticClassifications(t,e.createTextSpan(n,r))}))},n.prototype.getSemanticClassifications=function(t,n,r){var i=this;return this.forwardJSONCall("getSemanticClassifications('"+t+"', "+n+", "+r+")",(function(){return i.languageService.getSemanticClassifications(t,e.createTextSpan(n,r))}))},n.prototype.getEncodedSyntacticClassifications=function(t,n,r){var i=this;return this.forwardJSONCall("getEncodedSyntacticClassifications('"+t+"', "+n+", "+r+")",(function(){return u(i.languageService.getEncodedSyntacticClassifications(t,e.createTextSpan(n,r)))}))},n.prototype.getEncodedSemanticClassifications=function(t,n,r){var i=this;return this.forwardJSONCall("getEncodedSemanticClassifications('"+t+"', "+n+", "+r+")",(function(){return u(i.languageService.getEncodedSemanticClassifications(t,e.createTextSpan(n,r)))}))},n.prototype.getSyntacticDiagnostics=function(e){var t=this;return this.forwardJSONCall("getSyntacticDiagnostics('"+e+"')",(function(){var n=t.languageService.getSyntacticDiagnostics(e);return t.realizeDiagnostics(n)}))},n.prototype.getSemanticDiagnostics=function(e){var t=this;return this.forwardJSONCall("getSemanticDiagnostics('"+e+"')",(function(){var n=t.languageService.getSemanticDiagnostics(e);return t.realizeDiagnostics(n)}))},n.prototype.getCompilerOptionsDiagnostics=function(){var e=this;return this.forwardJSONCall("getCompilerOptionsDiagnostics()",(function(){var t=e.languageService.getCompilerOptionsDiagnostics();return e.realizeDiagnostics(t)}))},n.prototype.getQuickInfoAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getQuickInfoAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getQuickInfoAtPosition(e,t)}))},n.prototype.getNameOrDottedNameSpan=function(e,t,n){var r=this;return this.forwardJSONCall("getNameOrDottedNameSpan('"+e+"', "+t+", "+n+")",(function(){return r.languageService.getNameOrDottedNameSpan(e,t,n)}))},n.prototype.getBreakpointStatementAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getBreakpointStatementAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getBreakpointStatementAtPosition(e,t)}))},n.prototype.getSignatureHelpItems=function(e,t){var n=this;return this.forwardJSONCall("getSignatureHelpItems('"+e+"', "+t+")",(function(){return n.languageService.getSignatureHelpItems(e,t)}))},n.prototype.getDefinitionAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getDefinitionAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getDefinitionAtPosition(e,t)}))},n.prototype.getTypeDefinitionAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getTypeDefinitionAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getTypeDefinitionAtPosition(e,t)}))},n.prototype.getImplementationAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getImplementationAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getImplementationAtPosition(e,t)}))},n.prototype.getRenameInfo=function(e,t){var n=this;return this.forwardJSONCall("getRenameInfo('"+e+"', "+t+")",(function(){return n.languageService.getRenameInfo(e,t)}))},n.prototype.findRenameLocations=function(e,t,n,r){var i=this;return this.forwardJSONCall("findRenameLocations('"+e+"', "+t+", "+n+", "+r+")",(function(){return i.languageService.findRenameLocations(e,t,n,r)}))},n.prototype.getBraceMatchingAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getBraceMatchingAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getBraceMatchingAtPosition(e,t)}))},n.prototype.isValidBraceCompletionAtPosition=function(e,t,n){var r=this;return this.forwardJSONCall("isValidBraceCompletionAtPosition('"+e+"', "+t+", "+n+")",(function(){return r.languageService.isValidBraceCompletionAtPosition(e,t,n)}))},n.prototype.getSpanOfEnclosingComment=function(e,t,n){var r=this;return this.forwardJSONCall("getSpanOfEnclosingComment('"+e+"', "+t+")",(function(){return r.languageService.getSpanOfEnclosingComment(e,t,n)}))},n.prototype.getIndentationAtPosition=function(e,t,n){var r=this;return this.forwardJSONCall("getIndentationAtPosition('"+e+"', "+t+")",(function(){var i=JSON.parse(n);return r.languageService.getIndentationAtPosition(e,t,i)}))},n.prototype.getReferencesAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getReferencesAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getReferencesAtPosition(e,t)}))},n.prototype.findReferences=function(e,t){var n=this;return this.forwardJSONCall("findReferences('"+e+"', "+t+")",(function(){return n.languageService.findReferences(e,t)}))},n.prototype.getOccurrencesAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getOccurrencesAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getOccurrencesAtPosition(e,t)}))},n.prototype.getDocumentHighlights=function(t,n,r){var i=this;return this.forwardJSONCall("getDocumentHighlights('"+t+"', "+n+")",(function(){var s=i.languageService.getDocumentHighlights(t,n,JSON.parse(r)),o=e.normalizeSlashes(t).toLowerCase();return e.filter(s,(function(t){return e.normalizeSlashes(t.fileName).toLowerCase()===o}))}))},n.prototype.getCompletionsAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getCompletionsAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getCompletionsAtPosition(e,t)}))},n.prototype.getCompletionEntryDetails=function(e,t,n,r,i){var s=this;return this.forwardJSONCall("getCompletionEntryDetails('"+e+"', "+t+", '"+n+"')",(function(){var o=JSON.parse(r);return s.languageService.getCompletionEntryDetails(e,t,n,o,i)}))},n.prototype.getFormattingEditsForRange=function(e,t,n,r){var i=this;return this.forwardJSONCall("getFormattingEditsForRange('"+e+"', "+t+", "+n+")",(function(){var s=JSON.parse(r);return i.languageService.getFormattingEditsForRange(e,t,n,s)}))},n.prototype.getFormattingEditsForDocument=function(e,t){var n=this;return this.forwardJSONCall("getFormattingEditsForDocument('"+e+"')",(function(){var r=JSON.parse(t);return n.languageService.getFormattingEditsForDocument(e,r)}))},n.prototype.getFormattingEditsAfterKeystroke=function(e,t,n,r){var i=this;return this.forwardJSONCall("getFormattingEditsAfterKeystroke('"+e+"', "+t+", '"+n+"')",(function(){var s=JSON.parse(r);return i.languageService.getFormattingEditsAfterKeystroke(e,t,n,s)}))},n.prototype.getDocCommentTemplateAtPosition=function(e,t){var n=this;return this.forwardJSONCall("getDocCommentTemplateAtPosition('"+e+"', "+t+")",(function(){return n.languageService.getDocCommentTemplateAtPosition(e,t)}))},n.prototype.getNavigateToItems=function(e,t,n){var r=this;return this.forwardJSONCall("getNavigateToItems('"+e+"', "+t+", "+n+")",(function(){return r.languageService.getNavigateToItems(e,t,n)}))},n.prototype.getNavigationBarItems=function(e){var t=this;return this.forwardJSONCall("getNavigationBarItems('"+e+"')",(function(){return t.languageService.getNavigationBarItems(e)}))},n.prototype.getNavigationTree=function(e){var t=this;return this.forwardJSONCall("getNavigationTree('"+e+"')",(function(){return t.languageService.getNavigationTree(e)}))},n.prototype.getOutliningSpans=function(e){var t=this;return this.forwardJSONCall("getOutliningSpans('"+e+"')",(function(){return t.languageService.getOutliningSpans(e)}))},n.prototype.getTodoComments=function(e,t){var n=this;return this.forwardJSONCall("getTodoComments('"+e+"')",(function(){return n.languageService.getTodoComments(e,JSON.parse(t))}))},n.prototype.getEmitOutput=function(e){var t=this;return this.forwardJSONCall("getEmitOutput('"+e+"')",(function(){return t.languageService.getEmitOutput(e)}))},n.prototype.getEmitOutputObject=function(e){var t=this;return o(this.logger,"getEmitOutput('"+e+"')",!1,(function(){return t.languageService.getEmitOutput(e)}),this.logPerformance)},n}(a);function u(e){return{spans:e.spans.join(","),endOfLineState:e.endOfLineState}}var d=function(t){function n(n,r){var i=t.call(this,n)||this;return i.logger=r,i.logPerformance=!1,i.classifier=e.createClassifier(),i}return __extends(n,t),n.prototype.getEncodedLexicalClassifications=function(e,t,n){var r=this;return s(this.logger,"getEncodedLexicalClassifications",(function(){return u(r.classifier.getEncodedLexicalClassifications(e,t,n))}),this.logPerformance)},n.prototype.getClassificationsForLine=function(e,t,n){for(var r=this.classifier.getClassificationsForLine(e,t,n),i="",s=0,o=r.entries;s<o.length;s++){var a=o[s];i+=a.length+"\n",i+=a.classification+"\n"}return i+=r.finalLexState},n}(a),p=function(t){function n(e,n,r){var i=t.call(this,e)||this;return i.logger=n,i.host=r,i.logPerformance=!1,i}return __extends(n,t),n.prototype.forwardJSONCall=function(e,t){return s(this.logger,e,t,this.logPerformance)},n.prototype.resolveModuleName=function(t,n,r){var i=this;return this.forwardJSONCall("resolveModuleName('"+t+"')",(function(){var s=JSON.parse(r),o=e.resolveModuleName(n,e.normalizeSlashes(t),s,i.host),a=o.resolvedModule?o.resolvedModule.resolvedFileName:void 0;return o.resolvedModule&&".ts"!==o.resolvedModule.extension&&".tsx"!==o.resolvedModule.extension&&".d.ts"!==o.resolvedModule.extension&&(a=void 0),{resolvedFileName:a,failedLookupLocations:o.failedLookupLocations}}))},n.prototype.resolveTypeReferenceDirective=function(t,n,r){var i=this;return this.forwardJSONCall("resolveTypeReferenceDirective("+t+")",(function(){var s=JSON.parse(r),o=e.resolveTypeReferenceDirective(n,e.normalizeSlashes(t),s,i.host);return{resolvedFileName:o.resolvedTypeReferenceDirective?o.resolvedTypeReferenceDirective.resolvedFileName:void 0,primary:!o.resolvedTypeReferenceDirective||o.resolvedTypeReferenceDirective.primary,failedLookupLocations:o.failedLookupLocations}}))},n.prototype.getPreProcessedFileInfo=function(t,n){var r=this;return this.forwardJSONCall("getPreProcessedFileInfo('"+t+"')",(function(){var t=e.preProcessFile(n.getText(0,n.getLength()),!0,!0);return{referencedFiles:r.convertFileReferences(t.referencedFiles),importedFiles:r.convertFileReferences(t.importedFiles),ambientExternalModules:t.ambientExternalModules,isLibFile:t.isLibFile,typeReferenceDirectives:r.convertFileReferences(t.typeReferenceDirectives)}}))},n.prototype.getAutomaticTypeDirectiveNames=function(t){var n=this;return this.forwardJSONCall("getAutomaticTypeDirectiveNames('"+t+"')",(function(){var r=JSON.parse(t);return e.getAutomaticTypeDirectiveNames(r,n.host)}))},n.prototype.convertFileReferences=function(t){if(t){for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({path:e.normalizeSlashes(s.fileName),position:s.pos,length:s.end-s.pos})}return n}},n.prototype.getTSConfigFileInfo=function(t,n){var r=this;return this.forwardJSONCall("getTSConfigFileInfo('"+t+"')",(function(){var i=n.getText(0,n.getLength()),s=e.parseJsonText(t,i),o=e.normalizeSlashes(t),a=e.parseJsonSourceFileConfigFileContent(s,r.host,e.getDirectoryPath(o),{},o);return{options:a.options,typeAcquisition:a.typeAcquisition,files:a.fileNames,raw:a.raw,errors:l(s.parseDiagnostics.concat(a.errors),"\r\n")}}))},n.prototype.getDefaultCompilationSettings=function(){return this.forwardJSONCall("getDefaultCompilationSettings()",(function(){return e.getDefaultCompilerOptions()}))},n.prototype.discoverTypings=function(t){var n=this,r=e.createGetCanonicalFileName(!1);return this.forwardJSONCall("discoverTypings()",(function(){var i=JSON.parse(t);return void 0===n.safeList&&(n.safeList=e.JsTyping.loadSafeList(n.host,e.toPath(i.safeListPath,i.safeListPath,r))),e.JsTyping.discoverTypings(n.host,(function(e){return n.logger.log(e)}),i.fileNames,e.toPath(i.projectRootPath,i.projectRootPath,r),n.safeList,i.packageNameToTypingLocation,i.typeAcquisition,i.unresolvedImports)}))},n}(a),h=function(){function n(){this._shims=[]}return n.prototype.getServicesVersion=function(){return e.servicesVersion},n.prototype.createLanguageServiceShim=function(n){try{void 0===this.documentRegistry&&(this.documentRegistry=e.createDocumentRegistry(n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames(),n.getCurrentDirectory()));var i=new r(n),s=e.createLanguageService(i,this.documentRegistry);return new c(this,n,s)}catch(e){throw t(n,e),e}},n.prototype.createClassifierShim=function(e){try{return new d(this,e)}catch(n){throw t(e,n),n}},n.prototype.createCoreServicesShim=function(e){try{var n=new i(e);return new p(this,e,n)}catch(n){throw t(e,n),n}},n.prototype.close=function(){e.clear(this._shims),this.documentRegistry=void 0},n.prototype.registerShim=function(e){this._shims.push(e)},n.prototype.unregisterShim=function(e){for(var t=0;t<this._shims.length;t++)if(this._shims[t]===e)return void delete this._shims[t];throw new Error("Invalid operation")},n}();e.TypeScriptServicesFactory=h,"undefined"!=typeof module&&module.exports&&(module.exports=e)}(ts||(ts={})),function(e){!function(e){e.TypeScriptServicesFactory=ts.TypeScriptServicesFactory}(e.Services||(e.Services={}))}(TypeScript||(TypeScript={}));var toolsVersion="2.6",e=function(){function t(e,t){postMessage({action:Ue,cbn:t,result:e})}function n(e){var t=[];return t[e-1]=void 0,t}function r(e,t){return o(e[0]+t[0],e[1]+t[1])}function i(e,t){return function(e,t){var n;return n=t,0>t&&(n+=He),[n,e*He]}(~~Math.max(Math.min(e[1]/He,2147483647),-2147483648)&~~Math.max(Math.min(t[1]/He,2147483647),-2147483648),c(e)&c(t))}function s(e,t){var n,r;return e[0]==t[0]&&e[1]==t[1]?0:(n=0>e[1],r=0>t[1],n&&!r?-1:!n&&r?1:h(e,t)[1]<0?-1:1)}function o(e,t){var n,r;for(e%=0x10000000000000000,t=(t%=0x10000000000000000)-(n=t%He)+(r=Math.floor(e/He)*He),e=e-r+n;0>e;)e+=He,t-=He;for(;e>4294967295;)e-=He,t+=He;for(t%=0x10000000000000000;t>0x7fffffff00000000;)t-=0x10000000000000000;for(;-0x8000000000000000>t;)t+=0x10000000000000000;return[e,t]}function a(e,t){return e[0]==t[0]&&e[1]==t[1]}function l(e){return e>=0?[e,0]:[e+He,-He]}function c(e){return e[0]>=2147483648?~~Math.max(Math.min(e[0]-He,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function u(e){return 30>=e?1<<e:u(30)*u(e-30)}function d(e,t){var n,r,i,s;if(t&=63,a(e,je))return t?Ke:e;if(0>e[1])throw Error("Neg");return s=u(t),r=e[1]*s%0x10000000000000000,(r+=n=(i=e[0]*s)-i%He)>=0x8000000000000000&&(r-=0x10000000000000000),[i-=n,r]}function p(e,t){var n;return n=u(t&=63),o(Math.floor(e[0]/n),e[1]/n)}function h(e,t){return o(e[0]-t[0],e[1]-t[1])}function f(e,t){return e.Mc=t,e.Lc=0,e.Yb=t.length,e}function m(e){return e.Lc>=e.Yb?-1:255&e.Mc[e.Lc++]}function _(e,t,n,r){return e.Lc>=e.Yb?-1:(r=Math.min(r,e.Yb-e.Lc),T(e.Mc,e.Lc,t,n,r),e.Lc+=r,r)}function g(e){return e.Mc=n(32),e.Yb=0,e}function y(e){var t=e.Mc;return t.length=e.Yb,t}function b(e,t){e.Mc[e.Yb++]=t<<24>>24}function v(e,t,n,r){T(t,n,e.Mc,e.Yb,r),e.Yb+=r}function T(e,t,n,r,i){for(var s=0;i>s;++s)n[r+s]=e[t+s]}function k(t,n,r,i,o){var a,l;if(s(i,Ge)<0)throw Error("invalid length "+i);for(t.Tb=i,function(e,t){(function(e,t){e.ab=t;for(var n=0;t>1<<n;++n);e.$b=2*n})(t,1<<e.s),t.n=e.f,function(e,t){var n=e.X;e.X=t,e.b&&n!=e.X&&(e.wb=-1,e.b=null)}(t,e.m),t.eb=0,t.fb=3,t.Y=2,t.y=3}(o,a=J({})),a.Gc=void 0===e.disableEndMark,function(e,t){e.fc[0]=9*(5*e.Y+e.eb)+e.fb<<24>>24;for(var n=0;4>n;++n)e.fc[1+n]=e.ab>>8*n<<24>>24;v(t,e.fc,0,5)}(a,r),l=0;64>l;l+=8)b(r,255&c(p(i,l)));t.yb=(a.W=0,a.oc=n,a.pc=0,function(e){var t,n;e.b||(t={},n=4,e.X||(n=2),function(e,t){e.qb=t>2,e.qb?(e.w=0,e.xb=4,e.R=66560):(e.w=2,e.xb=3,e.R=0)}(t,n),e.b=t),pe(e.A,e.eb,e.fb),(e.ab!=e.wb||e.Hb!=e.n)&&(D(e.b,e.ab,4096,e.n,274),e.wb=e.ab,e.Hb=e.n)}(a),a.d.Ab=r,function(e){(function(e){e.l=0,e.J=0;for(var t=0;4>t;++t)e.v[t]=0})(e),function(e){e.mc=Ke,e.xc=Ke,e.E=-1,e.Jb=1,e.Oc=0}(e.d),we(e.C),we(e._),we(e.bb),we(e.hb),we(e.Ub),we(e.vc),we(e.Sb),function(e){var t,n=1<<e.u+e.I;for(t=0;n>t;++t)we(e.V[t].tb)}(e.A);for(var t=0;4>t;++t)we(e.K[t].G);oe(e.$,1<<e.Y),oe(e.i,1<<e.Y),we(e.S.G),e.N=0,e.jb=0,e.q=0,e.s=0}(a),X(a),Y(a),a.$.rb=a.n+1-2,de(a.$,1<<a.Y),a.i.rb=a.n+1-2,de(a.i,1<<a.Y),a.g=Ke,function(e,t){return e.cb=t,e.Z=null,e.zc=1,e}({},a))}function E(e,t,n){return e.Nb=g({}),k(e,f({},t),e.Nb,l(t.length),n),e}function x(e,t,n){var r,i,s,o,a="",c=[];for(i=0;5>i;++i){if(-1==(s=m(t)))throw Error("truncated input");c[i]=s<<24>>24}if(!function(e,t){var n,r,i,s,o,a,l;if(5>t.length)return 0;for(l=255&t[0],i=l%9,s=(a=~~(l/9))%5,o=~~(a/5),n=0,r=0;4>r;++r)n+=(255&t[1+r])<<8*r;return n>99999999||!function(e,t,n,r){if(t>8||n>4||r>4)return 0;W(e.gb,n,t);var i=1<<r;return H(e.Rb,i),H(e.sb,i),e.Dc=i-1,1}(e,i,s,o)?0:function(e,t){return 0>t?0:(e.Ob!=t&&(e.Ob=t,e.nb=Math.max(e.Ob,1),L(e.B,Math.max(e.nb,4096))),1)}(e,n)}(r=V({}),c))throw Error("corrupted input");for(i=0;64>i;i+=8){if(-1==(s=m(t)))throw Error("truncated input");1==(s=s.toString(16)).length&&(s="0"+s),a=s+""+a}/^0+$|^f+$/i.test(a)?e.Tb=Ge:(o=parseInt(a,16),e.Tb=o>4294967295?Ge:l(o)),e.yb=function(e,t,n,r){return e.e.Ab=t,F(e.B),e.B.cc=n,function(e){e.B.h=0,e.B.o=0,we(e.Gb),we(e.pb),we(e.Zb),we(e.Cb),we(e.Db),we(e.Eb),we(e.kc),function(e){var t,n;for(n=1<<e.u+e.I,t=0;n>t;++t)we(e.V[t].Ib)}(e.gb);for(var t=0;4>t;++t)we(e.kb[t].G);K(e.Rb),K(e.sb),we(e.Fb.G),function(e){e.Bb=0,e.E=-1;for(var t=0;5>t;++t)e.Bb=e.Bb<<8|m(e.Ab)}(e.e)}(e),e.U=0,e.ib=0,e.Jc=0,e.Ic=0,e.Qc=0,e.Nc=r,e.g=Ke,e.jc=0,function(e,t){return e.Z=t,e.cb=null,e.zc=1,e}({},e)}(r,t,n,e.Tb)}function S(e,t){return e.Nb=g({}),x(e,f({},t),e.Nb),e}function C(e,t){return e.c[e.f+e.o+t]}function I(e,t,n,r){var i,s;for(e.T&&e.o+t+r>e.h&&(r=e.h-(e.o+t)),++n,s=e.f+e.o+t,i=0;r>i&&e.c[s+i]==e.c[s+i-n];++i);return i}function A(e){return e.h-e.o}function w(e){var t,n;if(!e.T)for(;;){if(!(n=-e.f+e.Kb-e.h))return;if(-1==(t=_(e.cc,e.c,e.f+e.h,n)))return e.zb=e.h,e.f+e.zb>e.H&&(e.zb=e.H-e.f),void(e.T=1);e.h+=t,e.h>=e.o+e._b&&(e.zb=e.h-e._b)}}function N(e,t){e.f+=t,e.zb-=t,e.o-=t,e.h-=t}function D(e,t,r,i,s){var o,a;1073741567>t&&(e.Fc=16+(i>>1),function(e,t,r,i){var s;e.Bc=t,e._b=r,s=t+r+i,(null==e.c||e.Kb!=s)&&(e.c=null,e.Kb=s,e.c=n(e.Kb)),e.H=e.Kb-r}(e,t+r,i+s,256+~~((t+r+i+s)/2)),e.ob=i,o=t+1,e.p!=o&&(e.L=n(2*(e.p=o))),a=65536,e.qb&&(a=t-1,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a>>=1,(a|=65535)>16777216&&(a>>=1),e.Ec=a,++a,a+=e.R),a!=e.rc&&(e.ub=n(e.rc=a)))}function O(e){var t;++e.k>=e.p&&(e.k=0),function(e){++e.o,e.o>e.zb&&(e.f+e.o>e.H&&function(e){var t,n,r;for((r=e.f+e.o-e.Bc)>0&&--r,n=e.f+e.h-r,t=0;n>t;++t)e.c[t]=e.c[r+t];e.f-=r}(e),w(e))}(e),1073741823==e.o&&(t=e.o-e.p,R(e.L,2*e.p,t),R(e.ub,e.rc,t),N(e,t))}function R(e,t,n){var r,i;for(r=0;t>r;++r)n>=(i=e[r]||0)?i=0:i-=n,e[r]=i}function L(e,t){(null==e.Lb||e.M!=t)&&(e.Lb=n(t)),e.M=t,e.o=0,e.h=0}function P(e){var t=e.o-e.h;t&&(v(e.cc,e.Lb,e.h,t),e.o>=e.M&&(e.o=0),e.h=e.o)}function M(e,t){var n=e.o-t-1;return 0>n&&(n+=e.M),e.Lb[n]}function F(e){P(e),e.cc=null}function $(e){return 4>(e-=2)?e:3}function B(e){return 4>e?0:10>e?e-3:e-6}function U(e){if(!e.zc)throw Error("bad state");return e.cb?function(e){(function(e,t,n,i){var o,u,d,p,f,m,_,g,y,b,v,T,k,E,x;if(t[0]=Ke,n[0]=Ke,i[0]=1,e.oc&&(e.b.cc=e.oc,function(e){e.f=0,e.o=0,e.h=0,e.T=0,w(e),e.k=0,N(e,-1)}(e.b),e.W=1,e.oc=null),!e.pc){if(e.pc=1,E=e.g,a(e.g,Ke)){if(!A(e.b))return void Q(e,c(e.g));re(e),k=c(e.g)&e.y,Ne(e.d,e.C,(e.l<<4)+k,0),e.l=B(e.l),d=C(e.b,-e.s),fe(he(e.A,c(e.g),e.J),e.d,d),e.J=d,--e.s,e.g=r(e.g,We)}if(!A(e.b))return void Q(e,c(e.g));for(;;){if(_=Z(e,c(e.g)),b=e.mb,k=c(e.g)&e.y,u=(e.l<<4)+k,1==_&&-1==b)Ne(e.d,e.C,u,0),d=C(e.b,-e.s),x=he(e.A,c(e.g),e.J),7>e.l?fe(x,e.d,d):(y=C(e.b,-e.v[0]-1-e.s),me(x,e.d,y,d)),e.J=d,e.l=B(e.l);else{if(Ne(e.d,e.C,u,1),4>b){if(Ne(e.d,e.bb,e.l,1),b?(Ne(e.d,e.hb,e.l,1),1==b?Ne(e.d,e.Ub,e.l,0):(Ne(e.d,e.Ub,e.l,1),Ne(e.d,e.vc,e.l,b-2))):(Ne(e.d,e.hb,e.l,0),Ne(e.d,e._,u,1==_?0:1)),1==_?e.l=7>e.l?9:11:(le(e.i,e.d,_-2,k),e.l=7>e.l?8:11),p=e.v[b],0!=b){for(m=b;m>=1;--m)e.v[m]=e.v[m-1];e.v[0]=p}}else{for(Ne(e.d,e.bb,e.l,0),e.l=7>e.l?7:10,le(e.$,e.d,_-2,k),T=se(b-=4),g=$(_),ke(e.K[g],e.d,T),T>=4&&(v=b-(o=(2|1&T)<<(f=(T>>1)-1)),14>T?Ce(e.Sb,o-T-1,e.d,f,v):(De(e.d,v>>4,f-4),xe(e.S,e.d,15&v),++e.Qb)),p=b,m=3;m>=1;--m)e.v[m]=e.v[m-1];e.v[0]=p,++e.Mb}e.J=C(e.b,_-1-e.s)}if(e.s-=_,e.g=r(e.g,l(_)),!e.s){if(e.Mb>=128&&X(e),e.Qb>=16&&Y(e),t[0]=e.g,n[0]=Oe(e.d),!A(e.b))return void Q(e,c(e.g));if(s(h(e.g,E),[4096,0])>=0)return e.pc=0,void(i[0]=0)}}}})(e.cb,e.cb.Xb,e.cb.uc,e.cb.Kc),e.Pb=e.cb.Xb[0],e.cb.Kc[0]&&(function(e){ie(e),e.d.Ab=null}(e.cb),e.zc=0)}(e):function(e){var t=function(e){var t,n,i,o,a,u;if(u=c(e.g)&e.Dc,Ae(e.e,e.Gb,(e.U<<4)+u)){if(Ae(e.e,e.Zb,e.U))i=0,Ae(e.e,e.Cb,e.U)?(Ae(e.e,e.Db,e.U)?(Ae(e.e,e.Eb,e.U)?(n=e.Qc,e.Qc=e.Ic):n=e.Ic,e.Ic=e.Jc):n=e.Jc,e.Jc=e.ib,e.ib=n):Ae(e.e,e.pb,(e.U<<4)+u)||(e.U=7>e.U?9:11,i=1),i||(i=G(e.sb,e.e,u)+2,e.U=7>e.U?8:11);else if(e.Qc=e.Ic,e.Ic=e.Jc,e.Jc=e.ib,i=2+G(e.Rb,e.e,u),e.U=7>e.U?7:10,(a=ve(e.kb[$(i)],e.e))>=4){if(o=(a>>1)-1,e.ib=(2|1&a)<<o,14>a)e.ib+=function(e,t,n,r){var i,s,o=1,a=0;for(s=0;r>s;++s)i=Ae(n,e,t+o),o<<=1,o+=i,a|=i<<s;return a}(e.kc,e.ib-a-1,e.e,o);else if(e.ib+=function(e,t){var n,r,i=0;for(n=t;0!=n;--n)e.E>>>=1,r=e.Bb-e.E>>>31,e.Bb-=e.E&r-1,i=i<<1|1-r,-16777216&e.E||(e.Bb=e.Bb<<8|m(e.Ab),e.E<<=8);return i}(e.e,o-4)<<4,e.ib+=function(e,t){var n,r,i=1,s=0;for(r=0;e.F>r;++r)n=Ae(t,e.G,i),i<<=1,i+=n,s|=n<<r;return s}(e.Fb,e.e),0>e.ib)return-1==e.ib?1:-1}else e.ib=a;if(s(l(e.ib),e.g)>=0||e.ib>=e.nb)return-1;(function(e,t,n){var r=e.o-t-1;for(0>r&&(r+=e.M);0!=n;--n)r>=e.M&&(r=0),e.Lb[e.o++]=e.Lb[r++],e.o>=e.M&&P(e)})(e.B,e.ib,i),e.g=r(e.g,l(i)),e.jc=M(e.B,0)}else t=function(e,t,n){return e.V[((t&e.qc)<<e.u)+((255&n)>>>8-e.u)]}(e.gb,c(e.g),e.jc),e.jc=7>e.U?function(e,t){var n=1;do{n=n<<1|Ae(t,e.Ib,n)}while(256>n);return n<<24>>24}(t,e.e):function(e,t,n){var r,i,s=1;do{if(i=n>>7&1,n<<=1,r=Ae(t,e.Ib,(1+i<<8)+s),s=s<<1|r,i!=r){for(;256>s;)s=s<<1|Ae(t,e.Ib,s);break}}while(256>s);return s<<24>>24}(t,e.e,M(e.B,e.ib)),function(e,t){e.Lb[e.o++]=t,e.o>=e.M&&P(e)}(e.B,e.jc),e.U=B(e.U),e.g=r(e.g,We);return 0}(e.Z);if(-1==t)throw Error("corrupted input");e.Pb=Ge,e.Pc=e.Z.g,(t||s(e.Z.Nc,Ke)>=0&&s(e.Z.g,e.Z.Nc)>=0)&&(P(e.Z.B),F(e.Z.B),e.Z.e.Ab=null,e.zc=0)}(e),e.zc}function V(e){e.B={},e.e={},e.Gb=n(192),e.Zb=n(12),e.Cb=n(12),e.Db=n(12),e.Eb=n(12),e.pb=n(192),e.kb=n(4),e.kc=n(114),e.Fb=be({},4),e.Rb=j({}),e.sb=j({}),e.gb={};for(var t=0;4>t;++t)e.kb[t]=be({},6);return e}function H(e,t){for(;t>e.O;++e.O)e.ec[e.O]=be({},3),e.hc[e.O]=be({},3)}function G(e,t,n){return Ae(t,e.wc,0)?8+(Ae(t,e.wc,1)?8+ve(e.tc,t):ve(e.hc[n],t)):ve(e.ec[n],t)}function j(e){return e.wc=n(2),e.ec=n(16),e.hc=n(16),e.tc=be({},8),e.O=0,e}function K(e){we(e.wc);for(var t=0;e.O>t;++t)we(e.ec[t].G),we(e.hc[t].G);we(e.tc.G)}function W(e,t,r){var i,s;if(null==e.V||e.u!=r||e.I!=t)for(e.I=t,e.qc=(1<<t)-1,e.u=r,s=1<<e.u+e.I,e.V=n(s),i=0;s>i;++i)e.V[i]=z({})}function z(e){return e.Ib=n(768),e}function q(e,t){var n,r,i,s;e.jb=t,i=e.a[t].r,r=e.a[t].j;do{e.a[t].t&&(ye(e.a[i]),e.a[i].r=i-1,e.a[t].Ac&&(e.a[i-1].t=0,e.a[i-1].r=e.a[t].r2,e.a[i-1].j=e.a[t].j2)),s=i,n=r,r=e.a[s].j,i=e.a[s].r,e.a[s].j=n,e.a[s].r=t,t=s}while(t>0);return e.mb=e.a[0].j,e.q=e.a[0].r}function J(e){var t;for(e.v=n(4),e.a=[],e.d={},e.C=n(192),e.bb=n(12),e.hb=n(12),e.Ub=n(12),e.vc=n(12),e._=n(192),e.K=[],e.Sb=n(114),e.S=Te({},4),e.$=ce({}),e.i=ce({}),e.A={},e.m=[],e.P=[],e.lb=[],e.nc=n(16),e.x=n(4),e.Q=n(4),e.Xb=[Ke],e.uc=[Ke],e.Kc=[0],e.fc=n(5),e.yc=n(128),e.vb=0,e.X=1,e.D=0,e.Hb=-1,e.mb=0,t=0;4096>t;++t)e.a[t]={};for(t=0;4>t;++t)e.K[t]=Te({},6);return e}function Y(e){for(var t=0;16>t;++t)e.nc[t]=Se(e.S,t);e.Qb=0}function X(e){var t,n,r,i,s,o,a,l;for(i=4;128>i;++i)t=(2|1&(o=se(i)))<<(r=(o>>1)-1),e.yc[i]=Ie(e.Sb,t-o-1,r,i-t);for(s=0;4>s;++s){for(n=e.K[s],a=s<<6,o=0;e.$b>o;++o)e.P[a+o]=Ee(n,o);for(o=14;e.$b>o;++o)e.P[a+o]+=(o>>1)-1-4<<6;for(l=128*s,i=0;4>i;++i)e.lb[l+i]=e.P[a+i];for(;128>i;++i)e.lb[l+i]=e.P[a+se(i)]+e.yc[i]}e.Mb=0}function Q(e,t){ie(e),function(e,t){if(e.Gc){Ne(e.d,e.C,(e.l<<4)+t,1),Ne(e.d,e.bb,e.l,0),e.l=7>e.l?7:10,le(e.$,e.d,0,t);var n=$(2);ke(e.K[n],e.d,63),De(e.d,67108863,26),xe(e.S,e.d,15)}}(e,t&e.y);for(var n=0;5>n;++n)Re(e.d)}function Z(e,t){var n,r,i,s,o,a,l,c,u,d,p,h,f,m,_,g,y,b,v,T,k,E,x,S,w,N,D,O,R,L,P,M,F,$,U,V,H,G,j,K,W,z,J,Y;if(e.jb!=e.q)return f=e.a[e.q].r-e.q,e.mb=e.a[e.q].j,e.q=e.a[e.q].r,f;if(e.q=e.jb=0,e.N?(h=e.vb,e.N=0):h=re(e),N=e.D,2>(S=A(e.b)+1))return e.mb=-1,1;for(S>273&&(S=273),j=0,u=0;4>u;++u)e.x[u]=e.v[u],e.Q[u]=I(e.b,-1,e.x[u],273),e.Q[u]>e.Q[j]&&(j=u);if(e.Q[j]>=e.n)return e.mb=j,ne(e,(f=e.Q[j])-1),f;if(h>=e.n)return e.mb=e.m[N-1]+4,ne(e,h-1),h;if(l=C(e.b,-1),y=C(e.b,-e.v[0]-1-1),2>h&&l!=y&&2>e.Q[j])return e.mb=-1,1;if(e.a[0].Hc=e.l,F=t&e.y,e.a[1].z=Je[e.C[(e.l<<4)+F]>>>2]+ge(he(e.A,t,e.J),e.l>=7,y,l),ye(e.a[1]),G=(b=Je[2048-e.C[(e.l<<4)+F]>>>2])+Je[2048-e.bb[e.l]>>>2],y==l&&(K=G+function(e,t,n){return Je[e.hb[t]>>>2]+Je[e._[(t<<4)+n]>>>2]}(e,e.l,F),e.a[1].z>K&&(e.a[1].z=K,function(e){e.j=0,e.t=0}(e.a[1]))),2>(p=h>=e.Q[j]?h:e.Q[j]))return e.mb=e.a[1].j,1;e.a[1].r=0,e.a[0].bc=e.x[0],e.a[0].ac=e.x[1],e.a[0].dc=e.x[2],e.a[0].lc=e.x[3],d=p;do{e.a[d--].z=268435455}while(d>=2);for(u=0;4>u;++u)if(!(2>(H=e.Q[u]))){U=G+te(e,u,e.l,F);do{s=U+ue(e.i,H-2,F),(L=e.a[H]).z>s&&(L.z=s,L.r=0,L.j=u,L.t=0)}while(--H>=2)}if(x=b+Je[e.bb[e.l]>>>2],h>=(d=e.Q[0]>=2?e.Q[0]+1:2)){for(D=0;d>e.m[D];)D+=2;for(;s=x+ee(e,c=e.m[D+1],d,F),(L=e.a[d]).z>s&&(L.z=s,L.r=0,L.j=c+4,L.t=0),d!=e.m[D]||(D+=2)!=N;++d);}for(n=0;;){if(++n==p)return q(e,n);if(v=re(e),N=e.D,v>=e.n)return e.vb=v,e.N=1,q(e,n);if(++t,M=e.a[n].r,e.a[n].t?(--M,e.a[n].Ac?(z=e.a[e.a[n].r2].Hc,z=4>e.a[n].j2?7>z?8:11:7>z?7:10):z=e.a[M].Hc,z=B(z)):z=e.a[M].Hc,M==n-1?z=e.a[n].j?B(z):7>z?9:11:(e.a[n].t&&e.a[n].Ac?(M=e.a[n].r2,P=e.a[n].j2,z=7>z?8:11):z=4>(P=e.a[n].j)?7>z?8:11:7>z?7:10,R=e.a[M],4>P?P?1==P?(e.x[0]=R.ac,e.x[1]=R.bc,e.x[2]=R.dc,e.x[3]=R.lc):2==P?(e.x[0]=R.dc,e.x[1]=R.bc,e.x[2]=R.ac,e.x[3]=R.lc):(e.x[0]=R.lc,e.x[1]=R.bc,e.x[2]=R.ac,e.x[3]=R.dc):(e.x[0]=R.bc,e.x[1]=R.ac,e.x[2]=R.dc,e.x[3]=R.lc):(e.x[0]=P-4,e.x[1]=R.bc,e.x[2]=R.ac,e.x[3]=R.dc)),e.a[n].Hc=z,e.a[n].bc=e.x[0],e.a[n].ac=e.x[1],e.a[n].dc=e.x[2],e.a[n].lc=e.x[3],a=e.a[n].z,l=C(e.b,-1),y=C(e.b,-e.x[0]-1-1),F=t&e.y,r=a+Je[e.C[(z<<4)+F]>>>2]+ge(he(e.A,t,C(e.b,-2)),z>=7,y,l),T=0,(k=e.a[n+1]).z>r&&(k.z=r,k.r=n,k.j=-1,k.t=0,T=1),G=(b=a+Je[2048-e.C[(z<<4)+F]>>>2])+Je[2048-e.bb[z]>>>2],y!=l||n>k.r&&!k.j||(K=G+(Je[e.hb[z]>>>2]+Je[e._[(z<<4)+F]>>>2]),k.z>=K&&(k.z=K,k.r=n,k.j=0,k.t=0,T=1)),!(2>(S=w=(w=A(e.b)+1)>4095-n?4095-n:w))){if(S>e.n&&(S=e.n),!T&&y!=l&&(Y=Math.min(w-1,e.n),(_=I(e.b,0,e.x[0],Y))>=2)){for(J=B(z),$=t+1&e.y,E=r+Je[2048-e.C[(J<<4)+$]>>>2]+Je[2048-e.bb[J]>>>2],O=n+1+_;O>p;)e.a[++p].z=268435455;s=E+(ue(e.i,_-2,$)+te(e,0,J,$)),(L=e.a[O]).z>s&&(L.z=s,L.r=n+1,L.j=0,L.t=1,L.Ac=0)}for(W=2,V=0;4>V;++V)if(!(2>(m=I(e.b,-1,e.x[V],S)))){g=m;do{for(;n+m>p;)e.a[++p].z=268435455;s=G+(ue(e.i,m-2,F)+te(e,V,z,F)),(L=e.a[n+m]).z>s&&(L.z=s,L.r=n,L.j=V,L.t=0)}while(--m>=2);if(m=g,V||(W=m+1),w>m&&(Y=Math.min(w-1-m,e.n),(_=I(e.b,m,e.x[V],Y))>=2)){for(J=7>z?8:11,$=t+m&e.y,i=G+(ue(e.i,m-2,F)+te(e,V,z,F))+Je[e.C[(J<<4)+$]>>>2]+ge(he(e.A,t+m,C(e.b,m-1-1)),1,C(e.b,m-1-(e.x[V]+1)),C(e.b,m-1)),J=B(J),$=t+m+1&e.y,E=i+Je[2048-e.C[(J<<4)+$]>>>2]+Je[2048-e.bb[J]>>>2],O=m+1+_;n+O>p;)e.a[++p].z=268435455;s=E+(ue(e.i,_-2,$)+te(e,0,J,$)),(L=e.a[n+O]).z>s&&(L.z=s,L.r=n+m+1,L.j=0,L.t=1,L.Ac=1,L.r2=n,L.j2=V)}}if(v>S){for(v=S,N=0;v>e.m[N];N+=2);e.m[N]=v,N+=2}if(v>=W){for(x=b+Je[e.bb[z]>>>2];n+v>p;)e.a[++p].z=268435455;for(D=0;W>e.m[D];)D+=2;for(m=W;;++m)if(s=x+ee(e,o=e.m[D+1],m,F),(L=e.a[n+m]).z>s&&(L.z=s,L.r=n,L.j=o+4,L.t=0),m==e.m[D]){if(w>m&&(Y=Math.min(w-1-m,e.n),(_=I(e.b,m,o,Y))>=2)){for(J=7>z?7:10,$=t+m&e.y,i=s+Je[e.C[(J<<4)+$]>>>2]+ge(he(e.A,t+m,C(e.b,m-1-1)),1,C(e.b,m-(o+1)-1),C(e.b,m-1)),J=B(J),$=t+m+1&e.y,E=i+Je[2048-e.C[(J<<4)+$]>>>2]+Je[2048-e.bb[J]>>>2],O=m+1+_;n+O>p;)e.a[++p].z=268435455;s=E+(ue(e.i,_-2,$)+te(e,0,J,$)),(L=e.a[n+O]).z>s&&(L.z=s,L.r=n+m+1,L.j=0,L.t=1,L.Ac=1,L.r2=n,L.j2=o+4)}if((D+=2)==N)break}}}}}function ee(e,t,n,r){var i=$(n);return(128>t?e.lb[128*i+t]:e.P[(i<<6)+function(e){return 131072>e?qe[e>>6]+12:134217728>e?qe[e>>16]+32:qe[e>>26]+52}(t)]+e.nc[15&t])+ue(e.$,n-2,r)}function te(e,t,n,r){var i;return t?(i=Je[2048-e.hb[n]>>>2],1==t?i+=Je[e.Ub[n]>>>2]:(i+=Je[2048-e.Ub[n]>>>2],i+=Le(e.vc[n],t-2))):(i=Je[e.hb[n]>>>2],i+=Je[2048-e._[(n<<4)+r]>>>2]),i}function ne(e,t){t>0&&(function(e,t){var n,r,i,s,o,a,l,c,u,d,p,h,f,m,_,g,y;do{if(e.h>=e.o+e.ob)h=e.ob;else if(h=e.h-e.o,e.xb>h){O(e);continue}for(f=e.o>e.p?e.o-e.p:0,r=e.f+e.o,e.qb?(a=1023&(y=ze[255&e.c[r]]^255&e.c[r+1]),e.ub[a]=e.o,l=65535&(y^=(255&e.c[r+2])<<8),e.ub[1024+l]=e.o,c=(y^ze[255&e.c[r+3]]<<5)&e.Ec):c=255&e.c[r]^(255&e.c[r+1])<<8,i=e.ub[e.R+c],e.ub[e.R+c]=e.o,_=1+(e.k<<1),g=e.k<<1,d=p=e.w,n=e.Fc;;){if(f>=i||0==n--){e.L[_]=e.L[g]=0;break}if(o=e.o-i,s=(e.k>=o?e.k-o:e.k-o+e.p)<<1,m=e.f+i,u=p>d?d:p,e.c[m+u]==e.c[r+u]){for(;++u!=h&&e.c[m+u]==e.c[r+u];);if(u==h){e.L[g]=e.L[s],e.L[_]=e.L[s+1];break}}(255&e.c[r+u])>(255&e.c[m+u])?(e.L[g]=i,g=s+1,i=e.L[g],p=u):(e.L[_]=i,_=s,i=e.L[_],d=u)}O(e)}while(0!=--t)}(e.b,t),e.s+=t)}function re(e){var t=0;return e.D=function(e,t){var n,r,i,s,o,a,l,c,u,d,p,h,f,m,_,g,y,b,v,T,k;if(e.h>=e.o+e.ob)m=e.ob;else if(m=e.h-e.o,e.xb>m)return O(e),0;for(y=0,_=e.o>e.p?e.o-e.p:0,r=e.f+e.o,g=1,c=0,u=0,e.qb?(c=1023&(k=ze[255&e.c[r]]^255&e.c[r+1]),u=65535&(k^=(255&e.c[r+2])<<8),d=(k^ze[255&e.c[r+3]]<<5)&e.Ec):d=255&e.c[r]^(255&e.c[r+1])<<8,i=e.ub[e.R+d]||0,e.qb&&(s=e.ub[c]||0,o=e.ub[1024+u]||0,e.ub[c]=e.o,e.ub[1024+u]=e.o,s>_&&e.c[e.f+s]==e.c[r]&&(t[y++]=g=2,t[y++]=e.o-s-1),o>_&&e.c[e.f+o]==e.c[r]&&(o==s&&(y-=2),t[y++]=g=3,t[y++]=e.o-o-1,s=o),0!=y&&s==i&&(y-=2,g=1)),e.ub[e.R+d]=e.o,v=1+(e.k<<1),T=e.k<<1,h=f=e.w,0!=e.w&&i>_&&e.c[e.f+i+e.w]!=e.c[r+e.w]&&(t[y++]=g=e.w,t[y++]=e.o-i-1),n=e.Fc;;){if(_>=i||0==n--){e.L[v]=e.L[T]=0;break}if(l=e.o-i,a=(e.k>=l?e.k-l:e.k-l+e.p)<<1,b=e.f+i,p=f>h?h:f,e.c[b+p]==e.c[r+p]){for(;++p!=m&&e.c[b+p]==e.c[r+p];);if(p>g&&(t[y++]=g=p,t[y++]=l-1,p==m)){e.L[T]=e.L[a],e.L[v]=e.L[a+1];break}}(255&e.c[r+p])>(255&e.c[b+p])?(e.L[T]=i,T=a+1,i=e.L[T],f=p):(e.L[v]=i,v=a,i=e.L[v],h=p)}return O(e),y}(e.b,e.m),e.D>0&&((t=e.m[e.D-2])==e.n&&(t+=I(e.b,t-1,e.m[e.D-1],273-t))),++e.s,t}function ie(e){e.b&&e.W&&(e.b.cc=null,e.W=0)}function se(e){return 2048>e?qe[e]:2097152>e?qe[e>>10]+20:qe[e>>20]+40}function oe(e,t){we(e.db);for(var n=0;t>n;++n)we(e.Vb[n].G),we(e.Wb[n].G);we(e.ic.G)}function ae(e,t,n,r,i){var s,o,a,l,c;for(s=Je[e.db[0]>>>2],a=(o=Je[2048-e.db[0]>>>2])+Je[e.db[1]>>>2],l=o+Je[2048-e.db[1]>>>2],c=0,c=0;8>c;++c){if(c>=n)return;r[i+c]=s+Ee(e.Vb[t],c)}for(;16>c;++c){if(c>=n)return;r[i+c]=a+Ee(e.Wb[t],c-8)}for(;n>c;++c)r[i+c]=l+Ee(e.ic,c-8-8)}function le(e,t,n,r){(function(e,t,n,r){8>n?(Ne(t,e.db,0,0),ke(e.Vb[r],t,n)):(n-=8,Ne(t,e.db,0,1),8>n?(Ne(t,e.db,1,0),ke(e.Wb[r],t,n)):(Ne(t,e.db,1,1),ke(e.ic,t,n-8)))})(e,t,n,r),0==--e.sc[r]&&(ae(e,r,e.rb,e.Cc,272*r),e.sc[r]=e.rb)}function ce(e){return function(e){e.db=n(2),e.Vb=n(16),e.Wb=n(16),e.ic=Te({},8);for(var t=0;16>t;++t)e.Vb[t]=Te({},3),e.Wb[t]=Te({},3)}(e),e.Cc=[],e.sc=[],e}function ue(e,t,n){return e.Cc[272*n+t]}function de(e,t){for(var n=0;t>n;++n)ae(e,n,e.rb,e.Cc,272*n),e.sc[n]=e.rb}function pe(e,t,r){var i,s;if(null==e.V||e.u!=r||e.I!=t)for(e.I=t,e.qc=(1<<t)-1,e.u=r,s=1<<e.u+e.I,e.V=n(s),i=0;s>i;++i)e.V[i]=_e({})}function he(e,t,n){return e.V[((t&e.qc)<<e.u)+((255&n)>>>8-e.u)]}function fe(e,t,n){var r,i,s=1;for(i=7;i>=0;--i)r=n>>i&1,Ne(t,e.tb,s,r),s=s<<1|r}function me(e,t,n,r){var i,s,o,a,l=1,c=1;for(s=7;s>=0;--s)i=r>>s&1,a=c,l&&(a+=1+(o=n>>s&1)<<8,l=o==i),Ne(t,e.tb,a,i),c=c<<1|i}function _e(e){return e.tb=n(768),e}function ge(e,t,n,r){var i,s,o=1,a=7,l=0;if(t)for(;a>=0;--a)if(s=n>>a&1,i=r>>a&1,l+=Le(e.tb[(1+s<<8)+o],i),o=o<<1|i,s!=i){--a;break}for(;a>=0;--a)i=r>>a&1,l+=Le(e.tb[o],i),o=o<<1|i;return l}function ye(e){e.j=-1,e.t=0}function be(e,t){return e.F=t,e.G=n(1<<t),e}function ve(e,t){var n,r=1;for(n=e.F;0!=n;--n)r=(r<<1)+Ae(t,e.G,r);return r-(1<<e.F)}function Te(e,t){return e.F=t,e.G=n(1<<t),e}function ke(e,t,n){var r,i,s=1;for(i=e.F;0!=i;)r=n>>>--i&1,Ne(t,e.G,s,r),s=s<<1|r}function Ee(e,t){var n,r,i=1,s=0;for(r=e.F;0!=r;)n=t>>>--r&1,s+=Le(e.G[i],n),i=(i<<1)+n;return s}function xe(e,t,n){var r,i,s=1;for(i=0;e.F>i;++i)r=1&n,Ne(t,e.G,s,r),s=s<<1|r,n>>=1}function Se(e,t){var n,r,i=1,s=0;for(r=e.F;0!=r;--r)n=1&t,t>>>=1,s+=Le(e.G[i],n),i=i<<1|n;return s}function Ce(e,t,n,r,i){var s,o,a=1;for(o=0;r>o;++o)Ne(n,e,t+a,s=1&i),a=a<<1|s,i>>=1}function Ie(e,t,n,r){var i,s,o=1,a=0;for(s=n;0!=s;--s)i=1&r,r>>>=1,a+=Je[(2047&(e[t+o]-i^-i))>>>2],o=o<<1|i;return a}function Ae(e,t,n){var r,i=t[n];return(-2147483648^(r=(e.E>>>11)*i))>(-2147483648^e.Bb)?(e.E=r,t[n]=i+(2048-i>>>5)<<16>>16,-16777216&e.E||(e.Bb=e.Bb<<8|m(e.Ab),e.E<<=8),0):(e.E-=r,e.Bb-=r,t[n]=i-(i>>>5)<<16>>16,-16777216&e.E||(e.Bb=e.Bb<<8|m(e.Ab),e.E<<=8),1)}function we(e){for(var t=e.length-1;t>=0;--t)e[t]=1024}function Ne(e,t,n,s){var o,a=t[n];o=(e.E>>>11)*a,s?(e.xc=r(e.xc,i(l(o),[4294967295,0])),e.E-=o,t[n]=a-(a>>>5)<<16>>16):(e.E=o,t[n]=a+(2048-a>>>5)<<16>>16),-16777216&e.E||(e.E<<=8,Re(e))}function De(e,t,n){for(var i=n-1;i>=0;--i)e.E>>>=1,1==(t>>>i&1)&&(e.xc=r(e.xc,l(e.E))),-16777216&e.E||(e.E<<=8,Re(e))}function Oe(e){return r(r(l(e.Jb),e.mc),[4,0])}function Re(e){var t,n=c(function(e,t){var n;return n=p(e,t&=63),0>e[1]&&(n=r(n,d([2,0],63-t))),n}(e.xc,32));if(0!=n||s(e.xc,[4278190080,0])<0){e.mc=r(e.mc,l(e.Jb)),t=e.Oc;do{b(e.Ab,t+n),t=255}while(0!=--e.Jb);e.Oc=c(e.xc)>>>24}++e.Jb,e.xc=d(i(e.xc,[16777215,0]),8)}function Le(e,t){return Je[(2047&(e-t^-t))>>>2]}function Pe(e){for(var t,n,r,i=0,s=0,o=e.length,a=[],l=[];o>i;++i,++s){if(128&(t=255&e[i]))if(192==(224&t)){if(i+1>=o)return e;if(128!=(192&(n=255&e[++i])))return e;l[s]=(31&t)<<6|63&n}else{if(224!=(240&t))return e;if(i+2>=o)return e;if(128!=(192&(n=255&e[++i])))return e;if(128!=(192&(r=255&e[++i])))return e;l[s]=(15&t)<<12|(63&n)<<6|63&r}else{if(!t)return e;l[s]=t}16383==s&&(a.push(String.fromCharCode.apply(String,l)),s=-1)}return s>0&&(l.length=s,a.push(String.fromCharCode.apply(String,l))),a.join("")}function Me(e){var t,n,r,i=[],s=0,o=e.length;if("object"==typeof e)return e;for(function(e,t,n,r,i){var s;for(s=t;n>s;++s)r[i++]=e.charCodeAt(s)}(e,0,o,i,0),r=0;o>r;++r)(t=i[r])>=1&&127>=t?++s:s+=!t||t>=128&&2047>=t?2:3;for(n=[],s=0,r=0;o>r;++r)(t=i[r])>=1&&127>=t?n[s++]=t<<24>>24:!t||t>=128&&2047>=t?(n[s++]=(192|t>>6&31)<<24>>24,n[s++]=(128|63&t)<<24>>24):(n[s++]=(224|t>>12&15)<<24>>24,n[s++]=(128|t>>6&63)<<24>>24,n[s++]=(128|63&t)<<24>>24);return n}function Fe(e){return e[1]+e[0]}var $e=1,Be=2,Ue=3,Ve="function"==typeof setImmediate?setImmediate:setTimeout,He=4294967296,Ge=[4294967295,-He],je=[0,-0x8000000000000000],Ke=[0,0],We=[1,0],ze=function(){var e,t,n,r=[];for(e=0;256>e;++e){for(n=e,t=0;8>t;++t)0!=(1&n)?n=n>>>1^-306674912:n>>>=1;r[e]=n}return r}(),qe=function(){var e,t,n,r=2,i=[0,1];for(n=2;22>n;++n)for(t=1<<(n>>1)-1,e=0;t>e;++e,++r)i[r]=n<<24>>24;return i}(),Je=function(){var e,t,n,r=[];for(t=8;t>=0;--t)for(e=1<<9-t,n=1<<9-t-1;e>n;++n)r[n]=(t<<6)+(e-n<<6>>>9-t-1);return r}(),Ye=function(){var e=[{s:16,f:64,m:0},{s:20,f:64,m:0},{s:19,f:64,m:1},{s:20,f:64,m:1},{s:21,f:128,m:1},{s:22,f:128,m:1},{s:23,f:128,m:1},{s:24,f:255,m:1},{s:25,f:255,m:1}];return function(t){return e[t-1]||e[6]}}();return"undefined"==typeof onmessage||"undefined"!=typeof window&&void 0!==window.document||(onmessage=function(t){t&&t.gc&&(t.gc.action==Be?e.decompress(t.gc.gc,t.gc.cbn):t.gc.action==$e&&e.compress(t.gc.gc,t.gc.Rc,t.gc.cbn))}),{compress:function(e,n,r,i){var s,o,a={},l=void 0===r&&void 0===i;if("function"!=typeof r&&(o=r,r=i=0),i=i||function(e){return void 0!==o?t(e,o):void 0},r=r||function(e,t){return void 0!==o?postMessage({action:$e,cbn:o,result:e,error:t}):void 0},l){for(a.c=E({},Me(e),Ye(n));U(a.c.yb););return y(a.c.Nb)}try{a.c=E({},Me(e),Ye(n)),i(0)}catch(e){return r(null,e)}Ve((function e(){try{for(var t,n=(new Date).getTime();U(a.c.yb);)if(s=Fe(a.c.yb.Pb)/Fe(a.c.Tb),(new Date).getTime()-n>200)return i(s),Ve(e,0),0;i(1),t=y(a.c.Nb),Ve(r.bind(null,t),0)}catch(e){r(null,e)}}),0)},decompress:function(e,n,r){var i,s,o,a,l={},c=void 0===n&&void 0===r;if("function"!=typeof n&&(s=n,n=r=0),r=r||function(e){return void 0!==s?t(o?e:-1,s):void 0},n=n||function(e,t){return void 0!==s?postMessage({action:Be,cbn:s,result:e,error:t}):void 0},c){for(l.d=S({},e);U(l.d.yb););return Pe(y(l.d.Nb))}try{l.d=S({},e),a=Fe(l.d.Tb),o=a>-1,r(0)}catch(e){return n(null,e)}Ve((function e(){try{for(var t,s=0,c=(new Date).getTime();U(l.d.yb);)if(++s%1e3==0&&(new Date).getTime()-c>200)return o&&(i=Fe(l.d.yb.Z.g)/a,r(i)),Ve(e,0),0;r(1),t=Pe(y(l.d.Nb)),Ve(n.bind(null,t),0)}catch(e){n(null,e)}}),0)}}}(),pxt,pxt,pxt,pxt,pxt,ts;this.LZMA=this.LZMA_WORKER=e,function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).DOMPurify=t()}(this,(function(){var e=Object.hasOwnProperty,t=Object.setPrototypeOf,n=Object.isFrozen,r=Object.keys,i=Object.freeze,s=Object.seal,o=Object.create,a="undefined"!=typeof Reflect&&Reflect,l=a.apply,c=a.construct;l||(l=function(e,t,n){return e.apply(t,n)}),i||(i=function(e){return e}),s||(s=function(e){return e}),c||(c=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))))});var u=x(Array.prototype.forEach),d=x(Array.prototype.indexOf),p=x(Array.prototype.join),h=x(Array.prototype.pop),f=x(Array.prototype.push),m=x(Array.prototype.slice),_=x(String.prototype.toLowerCase),g=x(String.prototype.match),y=x(String.prototype.replace),b=x(String.prototype.indexOf),v=x(String.prototype.trim),T=x(RegExp.prototype.test),k=S(RegExp),E=S(TypeError);function x(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return l(e,t,r)}}function S(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return c(e,n)}}function C(e,r){t&&t(e,null);for(var i=r.length;i--;){var s=r[i];if("string"==typeof s){var o=_(s);o!==s&&(n(r)||(r[i]=o),s=o)}e[s]=!0}return e}function I(t){var n=o(null),r=void 0;for(r in t)l(e,t,[r])&&(n[r]=t[r]);return n}var A=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),w=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),N=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),O=i(["#text"]),R=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),L=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),P=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=s(/\{\{[\s\S]*|[\s\S]*\}\}/gm),$=s(/<%[\s\S]*|[\s\S]*%>/gm),B=s(/^data-[\-\w.\u00B7-\uFFFF]/),U=s(/^aria-[\-\w]+$/),V=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H=s(/^(?:\w+script|data):/i),G=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function K(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var W=function(){return"undefined"==typeof window?null:window},z=function(e,t){if("object"!==(void 0===e?"undefined":j(e))||"function"!=typeof e.createPolicy)return null;var n=null;t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")&&(n=t.currentScript.getAttribute("data-tt-policy-suffix"));var r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W(),n=function(t){return e(t)};if(n.version="2.0.17",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var s=t.document,o=!1,a=t.document,l=t.DocumentFragment,c=t.HTMLTemplateElement,x=t.Node,S=t.NodeFilter,q=t.NamedNodeMap,J=void 0===q?t.NamedNodeMap||t.MozNamedAttrMap:q,Y=t.Text,X=t.Comment,Q=t.DOMParser,Z=t.trustedTypes;if("function"==typeof c){var ee=a.createElement("template");ee.content&&ee.content.ownerDocument&&(a=ee.content.ownerDocument)}var te=z(Z,s),ne=te&&Pe?te.createHTML(""):"",re=a,ie=re.implementation,se=re.createNodeIterator,oe=re.getElementsByTagName,ae=re.createDocumentFragment,le=s.importNode,ce={};try{ce=I(a).documentMode?a.documentMode:{}}catch(e){}var ue={};n.isSupported=ie&&void 0!==ie.createHTMLDocument&&9!==ce;var de=F,pe=$,he=B,fe=U,me=H,_e=G,ge=V,ye=null,be=C({},[].concat(K(A),K(w),K(N),K(D),K(O))),ve=null,Te=C({},[].concat(K(R),K(L),K(P),K(M))),ke=null,Ee=null,xe=!0,Se=!0,Ce=!1,Ie=!1,Ae=!1,we=!1,Ne=!1,De=!1,Oe=!1,Re=!1,Le=!1,Pe=!1,Me=!0,Fe=!0,$e=!1,Be={},Ue=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ve=null,He=C({},["audio","video","img","source","image","track"]),Ge=null,je=C({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Ke=null,We=a.createElement("form"),ze=function(e){Ke&&Ke===e||(e&&"object"===(void 0===e?"undefined":j(e))||(e={}),e=I(e),ye="ALLOWED_TAGS"in e?C({},e.ALLOWED_TAGS):be,ve="ALLOWED_ATTR"in e?C({},e.ALLOWED_ATTR):Te,Ge="ADD_URI_SAFE_ATTR"in e?C(I(je),e.ADD_URI_SAFE_ATTR):je,Ve="ADD_DATA_URI_TAGS"in e?C(I(He),e.ADD_DATA_URI_TAGS):He,ke="FORBID_TAGS"in e?C({},e.FORBID_TAGS):{},Ee="FORBID_ATTR"in e?C({},e.FORBID_ATTR):{},Be="USE_PROFILES"in e&&e.USE_PROFILES,xe=!1!==e.ALLOW_ARIA_ATTR,Se=!1!==e.ALLOW_DATA_ATTR,Ce=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ie=e.SAFE_FOR_JQUERY||!1,Ae=e.SAFE_FOR_TEMPLATES||!1,we=e.WHOLE_DOCUMENT||!1,Oe=e.RETURN_DOM||!1,Re=e.RETURN_DOM_FRAGMENT||!1,Le=e.RETURN_DOM_IMPORT||!1,Pe=e.RETURN_TRUSTED_TYPE||!1,De=e.FORCE_BODY||!1,Me=!1!==e.SANITIZE_DOM,Fe=!1!==e.KEEP_CONTENT,$e=e.IN_PLACE||!1,ge=e.ALLOWED_URI_REGEXP||ge,Ae&&(Se=!1),Re&&(Oe=!0),Be&&(ye=C({},[].concat(K(O))),ve=[],!0===Be.html&&(C(ye,A),C(ve,R)),!0===Be.svg&&(C(ye,w),C(ve,L),C(ve,M)),!0===Be.svgFilters&&(C(ye,N),C(ve,L),C(ve,M)),!0===Be.mathMl&&(C(ye,D),C(ve,P),C(ve,M))),e.ADD_TAGS&&(ye===be&&(ye=I(ye)),C(ye,e.ADD_TAGS)),e.ADD_ATTR&&(ve===Te&&(ve=I(ve)),C(ve,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&C(Ge,e.ADD_URI_SAFE_ATTR),Fe&&(ye["#text"]=!0),we&&C(ye,["html","head","body"]),ye.table&&(C(ye,["tbody"]),delete ke.tbody),i&&i(e),Ke=e)},qe=function(e){f(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=ne}},Je=function(e,t){try{f(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){f(n.removed,{attribute:null,from:t})}t.removeAttribute(e)},Ye=function(e){var t=void 0,n=void 0;if(De)e="<remove></remove>"+e;else{var r=g(e,/^[\r\n\t ]+/);n=r&&r[0]}var i=te?te.createHTML(e):e;try{t=(new Q).parseFromString(i,"text/html")}catch(e){}if(o&&C(ke,["title"]),!t||!t.documentElement){var s=(t=ie.createHTMLDocument("")).body;s.parentNode.removeChild(s.parentNode.firstElementChild),s.outerHTML=i}return e&&n&&t.body.insertBefore(a.createTextNode(n),t.body.childNodes[0]||null),oe.call(t,we?"html":"body")[0]};n.isSupported&&function(){try{var e=Ye("<x/><title>&lt;/title&gt;&lt;img&gt;");T(/<\/title/,e.querySelector("title").innerHTML)&&(o=!0)}catch(e){}}();var Xe=function(e){return se.call(e.ownerDocument||e,e,S.SHOW_ELEMENT|S.SHOW_COMMENT|S.SHOW_TEXT,(function(){return S.FILTER_ACCEPT}),!1)},Qe=function(e){return!(e instanceof Y||e instanceof X||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof J&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI)},Ze=function(e){return"object"===(void 0===x?"undefined":j(x))?e instanceof x:e&&"object"===(void 0===e?"undefined":j(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},et=function(e,t,r){ue[e]&&u(ue[e],(function(e){e.call(n,t,r,Ke)}))},tt=function(e){var t=void 0;if(et("beforeSanitizeElements",e,null),Qe(e))return qe(e),!0;if(g(e.nodeName,/[\u0080-\uFFFF]/))return qe(e),!0;var r=_(e.nodeName);if(et("uponSanitizeElement",e,{tagName:r,allowedTags:ye}),("svg"===r||"math"===r)&&0!==e.querySelectorAll("p, br, form, table").length)return qe(e),!0;if(!ye[r]||ke[r]){if(Fe&&!Ue[r]&&"function"==typeof e.insertAdjacentHTML)try{var i=e.innerHTML;e.insertAdjacentHTML("AfterEnd",te?te.createHTML(i):i)}catch(e){}return qe(e),!0}return"noscript"===r&&T(/<\/noscript/i,e.innerHTML)||"noembed"===r&&T(/<\/noembed/i,e.innerHTML)?(qe(e),!0):(!Ie||Ze(e.firstElementChild)||Ze(e.content)&&Ze(e.content.firstElementChild)||!T(/</g,e.textContent)||(f(n.removed,{element:e.cloneNode()}),e.innerHTML?e.innerHTML=y(e.innerHTML,/</g,"&lt;"):e.innerHTML=y(e.textContent,/</g,"&lt;")),Ae&&3===e.nodeType&&(t=e.textContent,t=y(t,de," "),t=y(t,pe," "),e.textContent!==t&&(f(n.removed,{element:e.cloneNode()}),e.textContent=t)),et("afterSanitizeElements",e,null),!1)},nt=function(e,t,n){if(Me&&("id"===t||"name"===t)&&(n in a||n in We))return!1;if(Se&&T(he,t));else if(xe&&T(fe,t));else{if(!ve[t]||Ee[t])return!1;if(Ge[t]);else if(T(ge,y(n,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==b(n,"data:")||!Ve[e])if(Ce&&!T(me,y(n,_e,"")));else if(n)return!1}return!0},rt=function(e){var t=void 0,i=void 0,s=void 0,o=void 0,a=void 0;et("beforeSanitizeAttributes",e,null);var l=e.attributes;if(l){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ve};for(a=l.length;a--;){var u=t=l[a],f=u.name,g=u.namespaceURI;if(i=v(t.value),s=_(f),c.attrName=s,c.attrValue=i,c.keepAttr=!0,c.forceKeepAttr=void 0,et("uponSanitizeAttribute",e,c),i=c.attrValue,!c.forceKeepAttr){if("name"===s&&"IMG"===e.nodeName&&l.id)o=l.id,l=m(l,[]),Je("id",e),Je(f,e),d(l,o)>a&&e.setAttribute("id",o.value);else{if("INPUT"===e.nodeName&&"type"===s&&"file"===i&&c.keepAttr&&(ve[s]||!Ee[s]))continue;"id"===f&&e.setAttribute(f,""),Je(f,e)}if(c.keepAttr)if(Ie&&T(/\/>/i,i))Je(f,e);else if(T(/svg|math/i,e.namespaceURI)&&T(k("</("+p(r(Ue),"|")+")","i"),i))Je(f,e);else{Ae&&(i=y(i,de," "),i=y(i,pe," "));var b=e.nodeName.toLowerCase();if(nt(b,s,i))try{g?e.setAttributeNS(g,f,i):e.setAttribute(f,i),h(n.removed)}catch(e){}}}}et("afterSanitizeAttributes",e,null)}},it=function e(t){var n=void 0,r=Xe(t);for(et("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)et("uponSanitizeShadowNode",n,null),tt(n)||(n.content instanceof l&&e(n.content),rt(n));et("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e,r){var i=void 0,o=void 0,a=void 0,c=void 0,u=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Ze(e)){if("function"!=typeof e.toString)throw E("toString is not a function");if("string"!=typeof(e=e.toString()))throw E("dirty is not a string, aborting")}if(!n.isSupported){if("object"===j(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(Ze(e))return t.toStaticHTML(e.outerHTML)}return e}if(Ne||ze(r),n.removed=[],"string"==typeof e&&($e=!1),$e);else if(e instanceof x)1===(o=(i=Ye("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?i=o:i.appendChild(o);else{if(!Oe&&!Ae&&!we&&-1===e.indexOf("<"))return te&&Pe?te.createHTML(e):e;if(!(i=Ye(e)))return Oe?null:ne}i&&De&&qe(i.firstChild);for(var d=Xe($e?e:i);a=d.nextNode();)3===a.nodeType&&a===c||tt(a)||(a.content instanceof l&&it(a.content),rt(a),c=a);if(c=null,$e)return e;if(Oe){if(Re)for(u=ae.call(i.ownerDocument);i.firstChild;)u.appendChild(i.firstChild);else u=i;return Le&&(u=le.call(s,u,!0)),u}var p=we?i.outerHTML:i.innerHTML;return Ae&&(p=y(p,de," "),p=y(p,pe," ")),te&&Pe?te.createHTML(p):p},n.setConfig=function(e){ze(e),Ne=!0},n.clearConfig=function(){Ke=null,Ne=!1},n.isValidAttribute=function(e,t,n){Ke||ze({});var r=_(e),i=_(t);return nt(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&(ue[e]=ue[e]||[],f(ue[e],t))},n.removeHook=function(e){ue[e]&&h(ue[e])},n.removeHooks=function(e){ue[e]&&(ue[e]=[])},n.removeAllHooks=function(){ue={}},n}()})),pxt||(pxt={}),function(e){!function(t){const n={},r={};let i,s=!1;function o(e){Object.keys(e).forEach((t=>{"string"==typeof e[t]?n[t]=e[t]:r[t]=e[t]}))}!function(e){e[e.Off=0]="Off",e[e.Short=1]="Short",e[e.Verbose=2]="Verbose"}(i=t.ConsoleTickOptions||(t.ConsoleTickOptions={})),t.consoleTicks=i.Off,t.addDefaultProperties=o,t.enable=function(a){if(!e.aiTrackException||!e.aiTrackEvent||s)return;s=!0,"string"==typeof a&&0!=a.length||(a="en"),o({lang:a}),e.debug("setting up app insights");const l=e.tickEvent;e.tickEvent=function(s,o,a){if(t.consoleTicks!=i.Off){const e=t.consoleTicks==i.Short?"":`${(new Date).toLocaleTimeString(void 0,{hour12:!1})} - Tick - `,n=`${s} ${o?JSON.stringify(o):"<no data>"} ${a?JSON.stringify(a):"<no opts>"}`;console.log(e+n)}if(l&&l(s,o,a),(null==a?void 0:a.interactiveConsent)&&e.setInteractiveConsent(!0),o){const t=Object.assign({},n)||{},i=Object.assign({},r)||{};Object.keys(o).forEach((e=>{"string"==typeof o[e]?t[e]=o[e]:"number"==typeof o[e]?i[e]=o[e]:t[e]=JSON.stringify(o[e]||"")})),e.aiTrackEvent(s,t,i)}else e.aiTrackEvent(s)};const c=e.reportException;e.reportException=function(t,n){c&&c(t,n);const r={target:e.appTarget.id,version:e.appTarget.versions.target};n&&e.Util.jsonMergeFrom(r,n),e.aiTrackException(t,"exception",r)};const u=e.reportError;e.reportError=function(t,n,r){u&&u(t,n,r);try{throw n}catch(i){const s={target:e.appTarget.id,version:e.appTarget.versions.target,category:t,message:n};r&&e.Util.jsonMergeFrom(s,r),e.aiTrackException(i,"error",s)}}},t.trackPerformanceReport=function(){if(e.perf.perfReportLogged)return;const t=e.perf.report();if(t){const{durations:n,milestones:r}=t;e.tickEvent("performance.milestones",r),e.tickEvent("performance.durations",n)}}}(e.analytics||(e.analytics={}))}(pxt||(pxt={})),pxt||(pxt={}),function(e){!function(e){let t,n,r,i=0,s=!1;function o(){return t||(t=function(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}return}()),t}function a(){t&&(r.gain.setTargetAtTime(0,t.currentTime,.015),i=0)}e.mute=function(e){t&&(s=e,a(),e&&n&&(n.disconnect(),r.disconnect(),n=void 0,r=void 0))},e.stop=a,e.frequency=function(){return i},e.tone=function(e){if(s)return;if(isNaN(e)||e<0)return;i=e;let a=o();if(a)try{n||(n=a.createOscillator(),n.type="triangle",r=a.createGain(),r.gain.value=0,r.connect(a.destination),n.connect(r),n.start(0)),n.frequency.linearRampToValueAtTime(e,t.currentTime),r.gain.setTargetAtTime(.2,t.currentTime,.015)}catch(e){return void(n=void 0)}}}(e.AudioContextManager||(e.AudioContextManager={}))}(pxt||(pxt={})),function(e){!function(t){const n="auth",r="csrf-token",i="login-state",s="user-state",o="interactive-login-until";let a,l=!1;t.DEFAULT_USER_PREFERENCES=()=>({highContrast:!1,language:e.appTarget.appTheme.defaultLocale,reader:"",skillmap:{mapProgress:{},completedTags:{}},email:!1}),t.client=function(){if(!l)return a};let c=0,u=0;async function d(t,r){return r?await e.storage.shared.setAsync(n,t,r):await e.storage.shared.delAsync(n,t)}async function p(t){try{return await e.storage.shared.getAsync(n,t)}catch(e){return}}async function h(){const e=await p(r);return t.cachedHasAuthToken=!!e,e}async function f(e){return t.cachedHasAuthToken=!!e,await d(r,e)}async function m(){return!!await h()}async function _(){return t.cachedHasAuthToken=!1,await d(r,void 0)}async function g(){let r;try{r=await e.storage.shared.getAsync(n,s)}catch(e){r={}}return t.cachedUserState=r,r}async function y(r){return t.cachedUserState=Object.assign({},r),await e.storage.shared.setAsync(n,s,r)}async function b(){return t.cachedUserState=void 0,await e.storage.shared.delAsync(n,s)}t.cachedHasAuthToken=!1,t.getAuthTokenAsync=h,t.hasAuthTokenAsync=m,t.getUserStateAsync=g;class v{constructor(){this.initialUserPreferences_=void 0,this.initialAuthCheck_=void 0,this.patchQueue=[],a=this}async initAsync(){const e=await g();this.setUserProfileAsync(null==e?void 0:e.profile),this.setUserPreferencesAsync(null==e?void 0:e.preferences)}async loginAsync(t,r,s){if(!E()||!function(e){return k().filter((t=>t.id===e)).length>0}(t))return;s=null!=s?s:T,this.clearAuthStateAsync();const a={key:(Math.PI*Math.random()).toString(36).slice(2),callbackState:s,callbackPathname:window.location.pathname,idp:t,persistent:r},l=(parseInt(await p(o))||0)>Date.now(),c=e.Util.stringifyQueryString("/api/auth/login",{response_type:"token",provider:t,persistent:r,redirect_uri:`${window.location.origin}${window.location.pathname}?authcallback=1&state=${a.key}`,prompt:l?"select_account":"silent"}),u=await this.apiAsync(c);if(u.success)a.authCodeVerifier=u.resp.authCodeVerifier,await e.storage.shared.setAsync(n,i,a),e.tickEvent("auth.login.start",{provider:t}),window.location.href=u.resp.loginUrl;else try{await this.onSignInFailed()}catch(e){}}async logoutAsync(e){if(E()){await v.staticLogoutAsync(e);try{await this.onStateCleared()}catch(e){}try{await this.onSignedOut()}catch(e){}}}static async staticLogoutAsync(t){if(!E())return;e.tickEvent("auth.logout"),await d(o,(Date.now()+6e4).toString()),t=t?t.startsWith("#")?t:`#${t}`:"";const n=`${window.location.origin}${window.location.pathname}${window.location.search}${t}`;let r="";try{const t=e.Util.stringifyQueryString("/api/auth/logout",{redirect_uri:n,authcallback:"1"}),i=await v.staticApiAsync(t);i.success&&(r=i.resp.logoutUrl)}catch(e){}await _(),await b(),e.BrowserUtils.hasWindow()&&(r?window.location.href=r:(window.location.href=n,location.reload()))}async deleteProfileAsync(){var t;if(!await this.loggedInAsync())return;const n=await g(),r=null===(t=null==n?void 0:n.profile)||void 0===t?void 0:t.id,i=await this.apiAsync("/api/user",null,"DELETE");if(i.err)try{await this.onApiError(i.err)}catch(e){}else try{await this.clearAuthStateAsync();try{await this.onProfileDeleted(r)}catch(e){}}finally{e.tickEvent("auth.profile.deleted")}}async initialUserPreferencesAsync(){if(await this.loggedInAsync())return this.initialUserPreferences_||(this.initialUserPreferences_=this.fetchUserPreferencesAsync()),this.initialUserPreferences_}async userProfileAsync(){if(!await this.loggedInAsync())return;const e=await g();return Object.assign({},e.profile)}async userPreferencesAsync(){const e=await g();return Object.assign({},e.preferences)}async authCheckAsync(){var e;if(!E())return;if(!await m())return;const t=await g();return(null===(e=null==t?void 0:t.profile)||void 0===e?void 0:e.id)?this.initialAuthCheck_||(this.initialAuthCheck_=Promise.resolve(t.profile)):this.initialAuthCheck_||(this.initialAuthCheck_=this.fetchUserAsync()),this.initialAuthCheck_}async loggedInAsync(){return!!await this.authCheckAsync()&&await this.hasUserIdAsync()}async updateUserProfileAsync(e){if(!await this.loggedInAsync())return!1;const t=await g(),n=await this.apiAsync("/api/user/profile",{id:t.profile.id,username:e.username,avatarUrl:e.avatarUrl});return n.success&&await this.setUserProfileAsync(n.resp),n.success}async patchUserPreferencesAsync(n,r={}){const i=async()=>({success:!0,res:await this.userPreferencesAsync()});if(!(n=(n=Array.isArray(n)?n:[n]).filter((e=>!!e))).length)return await i();const s=(t,n,r)=>{const i=e.U.deepCopy(t);ts.pxtc.jsonPatch.patchInPlace(i,n);let s=ts.pxtc.jsonPatch.diff(t,i);return s.length&&r&&(s=s.filter(r)),s},o=await this.userPreferencesAsync(),a=s(o,n,r.filter);if(!a.length)return await i();if(ts.pxtc.jsonPatch.patchInPlace(o,a),await this.setUserPreferencesAsync(o),!await this.loggedInAsync())return await i();this.patchQueue.push({ops:n,filter:r.filter}),clearTimeout(c);const l=async()=>{if(u=0,!this.patchQueue.length)return await i();const n=await this.apiAsync("/api/user/preferences");if(!n.success)return e.reportError("identity","failed to fetch preferences for patch",n),{success:!1,res:void 0};const r=e.U.deepCopy(n.resp)||t.DEFAULT_USER_PREFERENCES(),o=this.patchQueue;this.patchQueue=[],o.forEach((e=>{const t=s(r,e.ops,e.filter);ts.pxtc.jsonPatch.patchInPlace(r,t)}));const a=pxtc.jsonPatch.diff(n.resp,r),l=await this.apiAsync("/api/user/preferences",a,"PATCH");return l.success?this.setUserPreferencesAsync(l.resp):e.reportError("identity","failed to patch preferences",l),{success:l.success,res:l.resp}};return r.immediate?await l():(u||(u=e.U.now()),1e4<e.U.now()-u?await l():(c=setTimeout(l,1e3),{success:!1,res:void 0}))}async hasUserIdAsync(){var e;if(!E())return!1;if(!await m())return;const t=await g();return!!(null===(e=null==t?void 0:t.profile)||void 0===e?void 0:e.id)}async fetchUserAsync(){var e;if(!E())return;if(!await m())return;const t=await g();if(null===(e=null==t?void 0:t.profile)||void 0===e?void 0:e.id)return t.profile;const n=await this.apiAsync("/api/user/profile");if(n.success){const e=n.resp;return await this.setUserProfileAsync(e),e}}async setUserProfileAsync(e){const t=await this.hasUserIdAsync();await this.transformUserProfileAsync(e);const n=await this.hasUserIdAsync();try{await this.onUserProfileChanged()}catch(e){}if(n&&!t)try{await this.onSignedIn()}catch(e){}else if(!n&&t)try{await this.onSignedOut()}catch(e){}}async setUserPreferencesAsync(e){var n;const r=await g(),i=null!==(n=null==r?void 0:r.preferences)&&void 0!==n?n:t.DEFAULT_USER_PREFERENCES(),s=ts.pxtc.jsonPatch.diff(i,e),o=await this.transformUserPreferencesAsync(Object.assign(Object.assign({},i),e));try{await this.onUserPreferencesChanged(s)}catch(e){}return o}async fetchUserPreferencesAsync(){if(!await this.loggedInAsync())return;await g();const e=await this.apiAsync("/api/user/preferences");if(e.success&&e.resp){return this.setUserPreferencesAsync(e.resp)}}async transformUserProfileAsync(e){let t=await g();return t=Object.assign(Object.assign({},t),{profile:Object.assign({},e)}),await y(t),t.profile}async transformUserPreferencesAsync(e){let t=await g();return t=Object.assign(Object.assign({},t),{preferences:Object.assign({},e)}),await y(t),t.preferences}async clearAuthStateAsync(){await _(),await b();try{await this.onStateCleared()}catch(e){}}async apiAsync(e,t,n,r){return await v.staticApiAsync(e,t,n,r)}static async staticApiAsync(t,n,r,i){var s;const o={};return(i=i||await h())&&(o.authorization=`mkcd ${i}`),o["x-pxt-target"]=null===(s=e.appTarget)||void 0===s?void 0:s.id,t=e.BrowserUtils.isLocalHostDev()?`${e.cloud.DEV_BACKEND}${t}`:t,e.Util.requestAsync({url:t,headers:o,data:n,method:r||(n?"POST":"GET"),withCredentials:!0}).then((e=>({statusCode:e.statusCode,resp:e.json,success:2===Math.floor(e.statusCode/100),err:null}))).catch((async e=>(/logout/.test(t)||401!=e.statusCode||await v.staticLogoutAsync(),{statusCode:e.statusCode,err:e,resp:null,success:!1})))}}t.AuthClient=v;const T={hash:"",params:{}};function k(){var t,n;return Object.keys((null===(n=null===(t=e.appTarget)||void 0===t?void 0:t.cloud)||void 0===n?void 0:n.cloudProviders)||{}).map((t=>e.appTarget.cloud.cloudProviders[t])).filter((e=>e.identity)).sort(((e,t)=>e.order-t.order))}function E(){return!l&&!e.BrowserUtils.isPxtElectron()&&k().length>0}function x(e,t){return e.id===t.id&&e.sourceURL===t.sourceURL}t.loginCallbackAsync=async function(t){let r,s=Object.assign({},T);do{if(r=await e.storage.shared.getAsync(n,i),!r)return void e.debug("Auth state not found in storge.");await e.storage.shared.delAsync(n,i);const a=t.state;if(!a||r.key!==a)return void e.debug("Failed to get auth state for key");s=Object.assign(Object.assign({},T),r.callbackState);const l=t.error;if(l){const n=t.error_description;e.tickEvent("auth.login.error",{error:l,provider:r.idp}),e.log(`Auth failed: ${l}:${n}`),s=Object.assign({},T);break}const c=t.token;if(!c){e.debug("Missing authToken in auth callback.");break}if(r.authCodeVerifier){const t=e.Util.stringifyQueryString("/api/otac/check",{persistent:r.persistent});await v.staticApiAsync(t,null,null,r.authCodeVerifier)}await f(c),await d(o,void 0),e.tickEvent("auth.login.success",{provider:r.idp})}while(0);const a=s.hash.startsWith("#")?s.hash:`#${s.hash}`,l=e.Util.stringifyQueryString("",s.params),c=`${r.callbackPathname.startsWith("/")?r.callbackPathname:`/${r.callbackPathname}`}${l}${a}`;window.location.href=c},t.identityProviders=k,t.identityProvider=function(e){return k().filter((t=>t.id===e)).shift()},t.hasIdentity=E,t.enableAuth=function(e=!0){l=!e},t.userName=function(e){var t,n,r,i;return null!==(i=null!==(n=null===(t=null==e?void 0:e.idp)||void 0===t?void 0:t.displayName)&&void 0!==n?n:null===(r=null==e?void 0:e.idp)||void 0===r?void 0:r.username)&&void 0!==i?i:"??"},t.identityProviderId=function(e){var t;return null===(t=null==e?void 0:e.idp)||void 0===t?void 0:t.provider},t.firstName=function(t){const n=e.auth.userName(t);return(null==n?void 0:n.split(" ").shift())||n},t.userInitials=function(t){const n=e.auth.userName(t);return ts.pxtc.Util.initials(n)},t.generateUserProfilePicDataUrl=function(t){var n,r;if(null===(r=null===(n=null==t?void 0:t.idp)||void 0===n?void 0:n.picture)||void 0===r?void 0:r.encoded){const n=window.URL||window.webkitURL;try{const r=e.Util.stringToUint8Array(atob(t.idp.picture.encoded)),i=new Blob([r],{type:t.idp.picture.mimeType});t.idp.picture.dataUrl=n.createObjectURL(i)}catch(e){}}},t.badgeEquals=x,t.hasBadge=function(e,t){return e.badges.some((e=>x(e,t)))}}(e.auth||(e.auth={}))}(pxt||(pxt={})),function(e){e.tickEvent=function(e){}}(pxt||(pxt={})),function(e){!function(e){e.__dummy=42}(e.pxtc||(e.pxtc={}))}(ts||(ts={}));var pxtc=ts.pxtc;!function(e){!function(e){!function(e){function t(e){return e.replace(/[^\w .!?\-$]/g,(e=>{let t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substr(0,4-t.length)+t}))}e.assert=function(e,t="Assertion failed"){if(!e)throw new Error(t)},e.flatClone=function(e){if(null==e)return null;let t={};return Object.keys(e).forEach((n=>{t[n]=e[n]})),t},e.clone=function(e){return null==e?null:JSON.parse(JSON.stringify(e))},e.htmlEscape=function(e){return e?e.replace(/([^\w .!?\-$])/g,(e=>"&#"+e.charCodeAt(0)+";")):e},e.htmlUnescape=function(e){return e?e.replace(/(&#\d+;)/g,(e=>String.fromCharCode(Number(e.substr(2,e.length-3))))):e},e.jsStringQuote=t,e.jsStringLiteral=function(e){return'"'+t(e)+'"'},e.initials=function(e){if(/^\w+@/.test(e)){return e.match(/^\w\w/).shift().toUpperCase()}{const t=e.match(/\b\w/g)||[];return((t.shift()||"")+(t.pop()||"")).toUpperCase()}};let n="en",r={},i={},s=!1;function o(){return n}function a(e){const t=/^(\w{2,3})-(\w{2,4}$)/i.exec(e);return t&&t[1]&&t[2]?[`${t[1].toLowerCase()}-${t[2].toUpperCase()}`,t[1].toLowerCase(),`${t[1].toLowerCase()}-${t[2].toLowerCase()}`]:[(e||"en").toLowerCase()]}function l(t,n){return 0==n.length?t:t.replace(/\{([0-9]+)(\:[^\}]+)?\}/g,(function(t,r,i){let s=n[parseInt(r)],o="",a=/^:f(\d*)\.(\d+)/.exec(i);if(a){let e=parseInt(a[2]),t=parseInt(a[1])||0,n=/^0/.test(a[1])?"0":" ",r=s.toFixed(e);if(t>0&&e>0&&(t+=e+1),t>0)for(;r.length<t;)r=n+r;o=r}else o=":x"==i?"0x"+s.toString(16):void 0===s?"(undef)":null===s?"(null)":s.toString?s.toString():s+"";return":a"==i?/^\s*[euioah]/.test(o.toLowerCase())?o="an "+o:/^\s*[bcdfgjklmnpqrstvwxz]/.test(o.toLowerCase())&&(o="a "+o):":s"==i?o=1==s?"":"s":":q"==i?o=e.htmlEscape(o):":jq"==i?o=e.jsStringQuote(o):":uri"==i?o=encodeURIComponent(o).replace(/'/g,"%27").replace(/"/g,"%22"):":url"==i?o=encodeURI(o).replace(/'/g,"%27").replace(/"/g,"%22"):":%"==i&&(o=(100*s).toFixed(1).toString()+"%"),o}))}e.enableLiveLocalizationUpdates=function(){s=!0},e.liveLocalizationEnabled=function(){return s},e.localeInfo=function(){return`${s?"live-":""}${o()}`},e.userLanguage=o,e.normalizeLanguageCode=a,e.setUserLanguage=function(e){n=a(e)[0]},e.isUserLanguageRtl=function(){return/^ar|dv|fa|ha|he|ks|ku|ps|ur|yi/i.test(n)},e.TRANSLATION_LOCALE="pxt",e.isTranslationMode=function(){return o()==e.TRANSLATION_LOCALE},e._localize=function(e){return r[e]||e},e.getLocalizedStrings=function(){return r},e.setLocalizedStrings=function(e){r=e},e.translationsCache=function(){return i},e.fmt_va=l,e.fmt=function(e,...t){return l(e,t)};const c={};e.dumpLocStats=function(){const e={};Object.keys(c).sort(((e,t)=>c[t]-c[e])).forEach((t=>e[t]=t)),console.log("prioritized list of strings:"),console.log(JSON.stringify(e,null,2))};function u(t,n){if(!t)return t;c[t]=(c[t]||0)+1;let r=e._localize(t);return r=r.replace(/^\{(id|loc):[^\}]+\}/g,""),l(r,n)}e.lf_va=u,e.lf=function(e,...t){return u(e,t)},e.rlf=function(e,...t){return u(e,t)},e.lookup=function(e,t){return e.hasOwnProperty(t)?e[t]:null},e.isoTime=function(t){let n=new Date(1e3*t);return e.fmt("{0}-{1:f02.0}-{2:f02.0} {3:f02.0}:{4:f02.0}:{5:f02.0}",n.getFullYear(),n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())},e.userError=function(e){let t=new Error(e);throw t.isUserError=!0,t},e.deq=function e(t,n){if(t===n)return null;if(!t||!n)return"Null value";if("object"==typeof t&&"object"==typeof n){if(Array.isArray(t)){if(!Array.isArray(n))return"Expected array";if(t.length!=n.length)return"Expected array of length "+t.length+", got "+n.length;for(let r=0;r<t.length;r++)if(null!=e(t[r],n[r]))return"Expected array value "+t[r]+" got "+n[r];return null}let r=Object.keys(t),i=Object.keys(t);if(r.length!=i.length)return"Expected "+r.length+" keys, got "+i.length;for(let i=0;i<r.length;i++){if(!Object.prototype.hasOwnProperty.call(n,r[i]))return"Missing key "+r[i];if(null!=e(t[r[i]],n[r[i]]))return"Expected value of "+r[i]+" to be "+t[r[i]]+", got "+n[r[i]]}return null}return"Unable to compare "+t+", "+n}}(e.Util||(e.Util={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={}));const lf=ts.pxtc.Util.lf;var ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,ts,pxt,pxt,pxt,pxt,ts,pxt,ts,pxtmelody,pxtmelody,pxtmelody,pxt,pxt,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,pxt,pxt,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim;!function(e){!function(e){e.decodeBase64=function(e){return atob(e)},e.encodeBase64=function(e){return btoa(e)}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){function r(e,t){if(t)for(let n=0;n<t.length;++n)e.push(t[n])}function i(e){let t=[];for(let n=0;n<e.length;++n)r(t,e[n]);return t}function s(e){return!!e&&"object"==typeof e&&!Array.isArray(e)}function o(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=n.length-r);for(let s=0;s<i;++s)e[t+s]=n[r+s]}function a(e,t){return e==t?0:e<t?-1:1}n.CancellationToken=class{constructor(){this.pending=!1,this.cancelled=!1}startOperation(){this.pending=!0}isRunning(){return this.pending}onProgress(e){this.progressHandler=e}reportProgress(e,t){this.progressHandler&&this.progressHandler(e,t)}cancel(){this.cancelled=!0,this.pending=!1}cancelAsync(){return this.cancelled||!this.pending?(this.cancelled=!0,this.pending=!1,Promise.resolve()):(this.cancelled=!0,this.deferred=new Promise((e=>{this.resolve=e})),this.deferred)}isCancelled(){return this.cancelled}throwIfCancelled(){if(this.isCancelled())throw new Error}resolveCancel(){this.pending=!1,this.deferred&&(this.resolve(),this.deferred=void 0,this.resolve=void 0)}},n.codalHash16=function(e){const t=[251,175,119,215,81,14,79,191,103,49,181,143,186,157,0,232,31,32,55,60,152,58,17,237,174,70,160,144,220,90,57,223,59,3,18,140,111,166,203,196,134,243,124,95,222,179,197,65,180,48,36,15,107,46,233,130,165,30,123,161,209,23,97,16,40,91,219,61,100,10,210,109,250,127,22,138,29,108,244,67,207,9,178,204,74,98,126,249,167,116,34,77,193,200,121,5,20,113,71,35,128,13,182,94,25,226,227,199,75,27,41,245,230,224,43,225,177,26,155,150,212,142,218,115,241,73,88,105,39,114,62,255,192,201,145,214,168,158,221,148,154,122,12,84,82,163,44,139,228,236,205,242,217,11,187,146,159,64,86,239,195,42,106,198,118,112,184,172,87,2,173,117,176,229,247,253,137,185,99,164,102,147,45,66,231,52,141,211,194,206,246,238,56,110,78,248,63,240,189,93,92,51,53,183,19,171,72,50,33,104,101,69,8,252,83,120,76,135,85,54,202,125,188,213,96,235,136,208,162,129,190,132,156,38,47,1,7,254,24,4,216,131,89,21,28,133,37,153,149,80,170,68,6,169,234,151];function n(e){let n=0;for(let r=0;r<e.length;r++){let i=e[r];n=t[n^i]}return n}return e?function(e,t){let r;const i=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);i[t]=255&n}let s=0;for(let e=0;e<t;++e)r=n(i),s|=r<<8*e,i[0]=(i[0]+1)%255;return s}(e,2):0},n.bufferSerial=function(e,t="",n="?",r=255){for(let i=0;i<t.length;++i){const s=t[i];if(e[n]=(e[n]||"")+s,"\n"===s||e[n].length>r){let t=e[n];e[n]="",window.postMessage({type:"serial",id:n,data:t},"*")}}},n.blobReadAsDataURL=function(e){return e?new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=e=>n(e),r.readAsDataURL(e)})):Promise.resolve(void 0)},n.fileReadAsBufferAsync=function(e){return e?new Promise(((t,n)=>{let r=new FileReader;r.onerror=e=>t(null),r.onload=e=>t(new Uint8Array(r.result)),r.readAsArrayBuffer(e)})):Promise.resolve(null)},n.fileReadAsTextAsync=function(e){return e?new Promise(((t,n)=>{let r=new FileReader;r.onerror=e=>t(null),r.onload=e=>t(r.result),r.readAsText(e)})):Promise.resolve(null)},n.sanitizeFileName=function(e){return e.replace(/[()\\\/.,?*^:<>!;'#$%^&|"@+={}\[\]~`\x00-\x1F]/g,"").trim().replace(/\s+/g,"-")},n.repeatMap=function(e,t){e=e||0;let n=[];for(let r=0;r<e;++r)n.push(t(r));return n},n.listsEqual=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},n.oops=function(e="OOPS"){throw new Error(e)},n.reversed=function(e){return(e=e.slice(0)).reverse(),e},n.arrayEquals=function(e,t,n=((e,t)=>e===t)){if(e==t)return!0;if(!e&&t||!t&&e||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0},n.iterMap=function(e,t){Object.keys(e).forEach((n=>t(n,e[n])))},n.mapMap=function(e,t){let n={};return Object.keys(e).forEach((r=>n[r]=t(r,e[r]))),n},n.values=function(e){return Object.keys(e||{}).map((t=>e[t]))},n.pushRange=r,n.concatArrayLike=function(e){return i(e)},n.concat=i,n.memcpy=o,n.uint8ArrayConcat=function(e){let t=0;for(let n of e)t+=n.length;let n=new Uint8Array(t),r=0;for(let t of e)o(n,r,t),r+=t.length;return n},n.jsonTryParse=function(e){try{return JSON.parse(e)}catch(e){return}},n.jsonMergeFrom=function e(t,r){r&&Object.keys(r).forEach((i=>{s(t[i])&&s(r[i])?e(t[i],r[i]):t[i]=n.clone(r[i])}))},n.jsonCopyFrom=function(e,t){let r=n.clone(t);for(let n of Object.keys(t))e[n]=r[n]},n.jsonFlatten=function(e){let t={},r=(e,i)=>{if(null!==i&&"object"==typeof i){n.assert(!Array.isArray(i)),e&&(e+=".");for(let t of Object.keys(i))r(e+t,i[t])}else t[e]=i};return r("",e),t},n.jsonUnFlatten=function(e){let t={};for(let n of Object.keys(e)){let r=t,i=n.split(".");for(let t=0;t<i.length;++t){let s=i[t];t==i.length-1?r[s]=e[n]:("object"!=typeof r[s]&&(r[s]={}),r=r[s])}}return t},n.strcmp=a,n.stringMapEq=function(e,t){let n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(let r of n){if(!t.hasOwnProperty(r))return!1;if(e[r]!==t[r])return!1}return!0},n.endsWith=function(e,t){return!(e.length<t.length)&&(0==t.length||e.slice(-t.length)==t)},n.startsWith=function(e,t){return!(e.length<t.length)&&(0==t.length||e.slice(0,t.length)==t)},n.contains=function(e,t){return!(e.length<t.length)&&(0==t.length||e.indexOf(t)>-1)},n.replaceAll=function(e,t,n){return t?e.split(t).join(n):e},n.snakify=function(e){const t=e.toUpperCase(),n=e.toLowerCase();if(e==t||e==n)return e;if(e.lastIndexOf("_")>0)return e;const r=t=>e[t]!=n[t],i=n=>e[n]!=t[n];let s="",o=0;for(;o<e.length;){let t=r(o),n=o;for(;n<e.length;){if(t&&i(n)){if(n-o>2){n--;break}t=!1}if(!t&&r(n))break;n++}s&&(s+="_"),s+=e.slice(o,n),o=n}return s.toUpperCase()===s?s:s.toLowerCase()},n.sortObjectFields=function(e){let t=Object.keys(e);t.sort(a);let n={};return t.forEach((t=>n[t]=e[t])),n},n.chopArray=function(e,t){let n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n},n.unique=function(e,t){let n=[],r={};return e.forEach((e=>{let i=t(e);r.hasOwnProperty(i)||(r[i]=null,n.push(e))})),n},n.groupBy=function(e,t){let n={};return e.forEach((e=>{let r=t(e);n.hasOwnProperty(r)||(n[r]=[]),n[r].push(e)})),n},n.toDictionary=function(e,t){let n={};return e.forEach((e=>{n[t(e)]=e})),n},n.toSet=function(e,t){let n={};return e.forEach((e=>{n[t(e)]=!0})),n},n.deepCopy=function e(t){if("object"!=typeof t||null===t)return t;const n=Array.isArray(t)?[]:{};for(const r in t){const i=t[r];n[r]=e(i)}return n},n.toArray=function(e){if(Array.isArray(e))return e;let t=[];if(!e)return t;for(let n=0;n<e.length;++n)t.push(e[n]);return t},n.indexOfMatching=function(e,t){for(let n=0;n<e.length;++n)if(t(e[n]))return n;return-1};const l=Promise.resolve();async function c(e,t,n){let r=0;const i=[],s=[];for(let o=0;o<e;o++){const e=(async()=>{for(;r<t.length;){const e=r++,i=t[e];s[e]=await n(i)}})();i.push(e)}try{await Promise.all(i)}catch(e){throw r=t.length,e}return s}function u(e,t){const n={};return r=>{const i=e(r);return n.hasOwnProperty(i)?n[i]:n[i]=t(r)}}n.nextTick=function(e){l.then(e)},n.delay=async function(e,t){const n=await t;return await new Promise((t=>setTimeout((()=>t()),e))),n},n.promiseMapAll=function(e,t){return Promise.all(e.map((e=>t(e))))},n.promiseMapAllSeries=function(e,t){return c(1,e,t)},n.promisePoolAsync=c,n.memoizeString=function(e){return u((e=>e),e)},n.promiseTimeout=async function(e,t,n){let r,i;const s=new Promise(((t,s)=>{i=t,r=setTimeout((()=>{i=void 0,clearTimeout(r),s(n||`Promise timed out after ${e}ms`)}),e)}));return Promise.race([t,s]).then((e=>(i&&(clearTimeout(r),i()),e)))},n.defer=function(){let e,t,n,r=!1;return{resolve:function(n){r?pxt.debug("Deferred promise already resolved"):(t?t(n):e=e||new Promise((function(e){e(n)})),r=!0)},reject:function(t){r?pxt.debug("Deferred promise already resolved"):(n?n(t):e=e||new Promise((function(e,n){n(t)})),r=!0)},promise:new Promise((function(r,i){e?r(e):(t=r,n=i)}))}},n.memoize=u,n.debounce=function(e,t,n){let r;return function(){let i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)},a=n&&!r;return clearTimeout(r),r=setTimeout(o,t),a&&e.apply(i,s),r}};function d(e){return e&&(e=e.replace(/\\/g,"/")),e}function p(e){return n.httpRequestCoreAsync(e).then((r=>{const i=r.statusCode;if((e.successCodes||[304,200,201,202]).indexOf(i)<0&&!e.allowHttpErrors){const t=n.lf("Bad HTTP status code: {0} at {1}; message: {2}",r.statusCode,e.url,(r.text||"").slice(0,500)),i=new Error(t);return i.statusCode=r.statusCode,Promise.reject(i)}return r.text&&/application\/json/.test(r.headers["content-type"])&&(r.json=t.U.jsonTryParse(r.text)),r}))}function h(e,t){let n="";if(!e)return n;for(let r=0;r<e.length;++r){let i=e.charCodeAt(r);if(i<=127)n+=e.charAt(r);else if(i<=2047)n+=String.fromCharCode(192|i>>6,128|63&i);else{if(!t&&55296<=i&&i<=56319){let t=e.charCodeAt(++r);isNaN(t)||(i=65536+(i-55296<<10)+(t-56320))}n+=i<=65535?String.fromCharCode(224|i>>12,128|i>>6&63,128|63&i):String.fromCharCode(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)}}return n}n.AdaptiveDebouncer=class{constructor(e,t=300,n=2e3,r=2){this.func=e,this.minDelay=t,this.maxDelay=n,this.slowdownFactor=r,this.lastPoke=0,this.recentGaps=[],this.wrapped=()=>{this.timeout=null,this.func()}}poke(){const e=Date.now();if(this.lastPoke){const t=e-this.lastPoke;if(t<10)return;for(t<4e3&&this.recentGaps.push(t);this.recentGaps.length>10;)this.recentGaps.shift()}this.lastPoke=e}trigger(){let e=this.maxDelay;if(this.lastPoke){const t=this.recentGaps.slice();t.sort();const n=t[t.length>>1]||1;e=Math.min(Math.max(n*this.slowdownFactor|0,this.minDelay),this.maxDelay);e-=Date.now()-this.lastPoke,e<0&&(e=0),this.lastPoke=null}clearTimeout(this.timeout),this.timeout=setTimeout(this.wrapped,e)}},n.throttle=function(e,t,n){let r;return function(){let i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)},a=n&&!r;r||(r=setTimeout(o,t)),a&&e.apply(i,s)}},n.randomPermute=function(e){for(let t=0;t<e.length;++t){let n=m()%e.length,r=e[t];e[t]=e[n],e[n]=r}},n.randomPick=function(e){return 0==e.length?null:e[m()%e.length]},n.timeSince=function(e){let t=(Date.now()-(e*=1e3))/1e3;return isNaN(t)?"":t<-30?(t=-t,t<60?n.lf("in a few seconds"):t<120?n.lf("in a minute"):t<3600?n.lf("in {0} minute{0:s}",Math.floor(t/60)):t<7200?n.lf("in an hour"):t<86400?n.lf("in {0} hour{0:s}",Math.floor(t/60/60)):t<2592e3?n.lf("in {0} day{0:s}",Math.floor(t/60/60/24)):t<31536e3?n.lf("in {0} month{0:s}",Math.floor(t/60/60/24/30)):n.lf("in {0} year{0:s}",Math.floor(t/60/60/24/365))):t<0?n.lf("now"):t<10?n.lf("a few seconds ago"):t<60?n.lf("{0} second{0:s} ago",Math.floor(t)):t<120?n.lf("a minute ago"):t<3600?n.lf("{0} minute{0:s} ago",Math.floor(t/60)):t<7200?n.lf("an hour ago"):t<86400?n.lf("{0} hour{0:s} ago",Math.floor(t/60/60)):t<2592e3?n.lf("{0} day{0:s} ago",Math.floor(t/60/60/24)):t<31536e3?n.lf("{0} month{0:s} ago",Math.floor(t/60/60/24/30)):n.lf("{0} year{0:s} ago",Math.floor(t/60/60/24/365))},n.unicodeToChar=function(e){return e.replace(/\\u([\d\w]{4})/gi,(function(e,t){return String.fromCharCode(parseInt(t,16))}))},n.escapeForRegex=function(e){return null==e?void 0:e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},n.stripUrlProtocol=function(e){return null==e?void 0:e.replace(/.*?:\/\//g,"")},n.normalizePath=d,n.pathJoin=function(e,t){if(d(e),d(t),e||t)return e?t?("/"!==e.charAt(e.length-1)&&(e+="/"),"/"==t.charAt(0)&&(t=t.substring(1)),e+t):e:t},n.isNodeJS="undefined"==typeof window,n.requestAsync=p,n.httpGetTextAsync=function(e){return p({url:e}).then((e=>e.text))},n.httpGetJsonAsync=function(e){return p({url:e}).then((e=>e.json))},n.httpPostJsonAsync=function(e,t){return p({url:e,data:t||{}}).then((e=>e.json))},n.stringToUint8Array=function(e){let t=e.length,n=new Uint8Array(t);for(let r=0;r<t;++r)n[r]=255&e.charCodeAt(r);return n},n.uint8ArrayToString=function(e){let t=e.length,n="";for(let r=0;r<t;++r)n+=String.fromCharCode(e[r]);return n},n.fromUTF8=function(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){let r=255&e.charCodeAt(n);t+=37==r||r>127?"%"+r.toString(16):e.charAt(n)}return decodeURIComponent(t)},n.toUTF8=h,n.toHex=function(e){let t="";for(let n=0;n<e.length;++n)t+=("0"+e[n].toString(16)).slice(-2);return t},n.fromHex=function(e){let t=new Uint8Array(e.length>>1);for(let n=0;n<e.length;n+=2)t[n>>1]=parseInt(e.slice(n,n+2),16);return t};n.PromiseQueue=class{constructor(){this.promises={}}enqueue(e,t){return new Promise(((n,r)=>{let i=this.promises[e];i||(i=this.promises[e]=[]),i.push((()=>t().finally((()=>{i.shift(),0==i.length?delete this.promises[e]:i[0]()})).then(n,r))),1==i.length&&i[0]()}))}};function f(){return Date.now()}function m(){let e=new Uint8Array(4);return n.getRandomBuf(e),new Uint32Array(e.buffer)[0]}function _(e,t,n){function r(r){pxt.debug(`downloading translations for ${e} ${t}`);let i=pxt.BrowserUtils.isLocalHost()||pxt.webConfig.isStatic?"https://makecode.com/api/":"",s=`${i}translations?lang=${encodeURIComponent(e)}&filename=${encodeURIComponent(t)}&approved=true`;const o={};return n&&!pxt.Cloud.useCdnApi()&&(o["If-None-Match"]=n),(i?p:pxt.Cloud.apiRequestWithCdnAsync)({url:s,headers:o}).then((i=>304==i.statusCode||200==i.statusCode?(n=i.headers.etag||"",pxt.BrowserUtils.translationDbAsync().then((s=>s.setAsync(e,t,n,i.json||r))).then((()=>i.json||r))):i.json),(e=>{console.log(`failed to load translations from ${s}`)}))}return pxt.BrowserUtils.translationDbAsync().then((n=>n.getAsync(e,t))).then((e=>{if(e){n=e.etag;return(Date.now()-e.time)/1e3>300&&r(e.strings),e.strings}return r()}))}function g(e){let[t,r]=n.normalizeLanguageCode(e),i=pxt.appTarget.appTheme;if(i&&i.availableLocales){if(i.availableLocales.indexOf(t)>-1)return!0;if(r&&i.availableLocales.indexOf(r)>-1)return!0}return!1}let y;function b(e,r,i,s,o){if(o=o||y.Editor,"en-US"===(i=n.normalizeLanguageCode(i)[0])||"en"===i)return Promise.resolve(void 0);let a,l,c=`${i}/${s}/${o}`;if(n.translationsCache()[c])return Promise.resolve(n.translationsCache()[c]);switch(o){case y.Editor:a=[{staticName:"strings.json",path:"strings.json"},{staticName:"target-strings.json",path:e+"/target-strings.json"}];break;case y.Sim:a=[{staticName:"sim-strings.json",path:e+"/sim-strings.json"}];break;case y.Apis:a=[{staticName:"bundled-strings.json",path:e+"/bundled-strings.json"}];break;case y.SkillMap:a=[{staticName:"skillmap-strings.json",path:"/skillmap-strings.json"}]}function u(e){e&&(l||(l={}),Object.keys(e).filter((t=>!!e[t])).forEach((t=>l[t]=e[t])))}if(s){let s=0;return t.U.promiseMapAllSeries(a,(e=>_(i,e.path).then(u,(e=>{console.log(e.message),++s})))).then((()=>(s&&(n.translationsCache()[c]=l),s!==a.length&&l?Promise.resolve(l):(pxt.tickEvent("translations.livetranslationsfailed"),b(e,r,i,!1,o)))))}return Promise.all(a.map((e=>n.httpGetJsonAsync(`${r}locales/${i}/${e.staticName}`).catch((e=>{}))))).then((e=>{let t={};e.forEach((e=>pxt.Util.jsonMergeFrom(t,e))),Object.keys(t).length&&(l=t,n.translationsCache()[c]=l)}),(e=>{console.error("failed to load localizations")})).then((()=>l))}function v(e){const t={};for(const n of Object.keys(e))t[n]=T(e[n]);return t}function T(e){var t;return{attributes:Object.assign({},e.attributes),parameters:null===(t=e.parameters)||void 0===t?void 0:t.map(k),extendsTypes:e.extendsTypes?[...e.extendsTypes]:void 0,pkgs:e.pkgs?[...e.pkgs]:void 0,combinedProperties:e.combinedProperties?[...e.combinedProperties]:void 0,name:e.name,namespace:e.namespace,fileName:e.fileName,kind:e.kind,retType:e.retType,isInstance:e.isInstance,isContextual:e.isContextual,qName:e.qName,pkg:e.pkg,snippet:e.snippet,snippetName:e.snippetName,snippetWithMarkers:e.snippetWithMarkers,pySnippet:e.pySnippet,pySnippetName:e.pySnippetName,pySnippetWithMarkers:e.pySnippetWithMarkers,blockFields:e.blockFields,isReadOnly:e.isReadOnly,pyName:e.pyName,pyQName:e.pyQName,snippetAddsDefinitions:e.snippetAddsDefinitions}}function k(e){var n,r;return{name:e.name,description:e.description,type:e.type,pyTypeString:e.pyTypeString,initializer:e.initializer,default:e.default,properties:null===(n=e.properties)||void 0===n?void 0:n.map(E),handlerParameters:null===(r=e.handlerParameters)||void 0===r?void 0:r.map(E),options:e.options?t.U.clone(e.options):void 0,isEnum:e.isEnum}}function E(e){return{name:e.name,type:e.type}}n.PromiseBuffer=class{constructor(){this.waiting=[],this.available=[]}drain(){for(let e of this.waiting)e(new Error("Promise Buffer Reset"));this.waiting=[],this.available=[]}pushError(e){this.push(e)}push(e){let t=this.waiting.shift();t?t(e):this.available.push(e)}shiftAsync(e=0){if(this.available.length>0){let e=this.available.shift();return e instanceof Error?Promise.reject(e):Promise.resolve(e)}return new Promise(((n,r)=>{let i=e=>{e instanceof Error?r(e):n(e)};this.waiting.push(i),e>0&&t.U.delay(e).then((()=>{let e=this.waiting.indexOf(i);e>=0&&(this.waiting.splice(e,1),r(new Error("Timeout")))}))}))}},n.now=f,n.nowSeconds=function(){return Math.round(f()/1e3)},n.timeout=function(e){return new Promise((t=>setTimeout((()=>t()),e)))},n.cpuUs=()=>{const e="undefined"!=typeof performance?performance.now.bind(performance)||performance.moznow.bind(performance)||performance.msNow.bind(performance)||performance.webkitNow.bind(performance)||performance.oNow.bind(performance):Date.now;return n.cpuUs=()=>1e3*e(),n.cpuUs()},n.getMime=function(e){let t=/\.([a-zA-Z0-9]+)$/.exec(e);if(!t)return"application/octet-stream";switch(t[1].toLowerCase()){case"txt":return"text/plain";case"html":case"htm":return"text/html";case"css":return"text/css";case"js":return"application/javascript";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"ico":return"image/x-icon";case"manifest":return"text/cache-manifest";case"webmanifest":return"application/manifest+json";case"json":return"application/json";case"svg":return"image/svg+xml";case"eot":return"application/vnd.ms-fontobject";case"ttf":return"font/ttf";case"woff":return"application/font-woff";case"woff2":return"application/font-woff2";case"md":return"text/markdown";case"xml":return"application/xml";case"m4a":return"audio/m4a";case"mp3":return"audio/mp3";default:return"application/octet-stream"}},n.randomUint32=m,n.guidGen=function(){function e(){return(65536|m()).toString(16).slice(-4)}return e()+e()+"-"+e()+"-4"+e().slice(-3)+"-"+e()+"-"+e()+e()+e()},n.downloadLiveTranslationsAsync=_,n.pxtLangCookieId="PXT_LANG",n.langCookieExpirationDays=30,n.allLanguages={af:{englishName:"Afrikaans",localizedName:"Afrikaans"},ar:{englishName:"Arabic",localizedName:""},az:{englishName:"Azerbaijani",localizedName:" "},bg:{englishName:"Bulgarian",localizedName:""},bi:{englishName:"Bislama",localizedName:"Bislama"},bn:{englishName:"Bengali",localizedName:""},ca:{englishName:"Catalan",localizedName:"Catal"},cs:{englishName:"Czech",localizedName:"etina"},cy:{englishName:"Welsh",localizedName:"Cymraeg"},da:{englishName:"Danish",localizedName:"Dansk"},de:{englishName:"German",localizedName:"Deutsch"},el:{englishName:"Greek",localizedName:""},en:{englishName:"English",localizedName:"English"},"es-ES":{englishName:"Spanish (Spain)",localizedName:"Espaol (Espaa)"},"es-MX":{englishName:"Spanish (Mexico)",localizedName:"Espaol (Mxico)"},et:{englishName:"Estonian",localizedName:"Eesti"},eu:{englishName:"Basque",localizedName:"Euskara"},fa:{englishName:"Persian",localizedName:""},fi:{englishName:"Finnish",localizedName:"Suomi"},fil:{englishName:"Filipino",localizedName:"Filipino"},fo:{englishName:"Faroese",localizedName:"froyskt"},fr:{englishName:"French",localizedName:"Franais"},"fr-CA":{englishName:"French (Canada)",localizedName:"Franais (Canada)"},gl:{englishName:"Galician",localizedName:"galego"},"gu-IN":{englishName:"Gujarati",localizedName:""},haw:{englishName:"Hawaiian",localizedName:"lelo Hawaii"},hi:{englishName:"Hindi",localizedName:""},he:{englishName:"Hebrew",localizedName:""},hr:{englishName:"Croatian",localizedName:"Hrvatski"},hu:{englishName:"Hungarian",localizedName:"Magyar"},"hy-AM":{englishName:"Armenian (Armenia)",localizedName:" ()"},id:{englishName:"Indonesian",localizedName:"Bahasa Indonesia"},is:{englishName:"Icelandic",localizedName:"slenska"},it:{englishName:"Italian",localizedName:"Italiano"},ja:{englishName:"Japanese",localizedName:""},"ja-HIRA":{englishName:"Hiragana",localizedName:""},ka:{englishName:"Georgian",localizedName:""},kab:{englishName:"Kabyle",localizedName:""},kk:{englishName:"Kazakh",localizedName:" "},km:{englishName:"Khmer",localizedName:""},kmr:{englishName:"Kurmanji (Kurdish)",localizedName:""},kn:{englishName:"Kannada",localizedName:""},ko:{englishName:"Korean",localizedName:""},lt:{englishName:"Lithuanian",localizedName:"Lietuvi"},lv:{englishName:"Latvian",localizedName:"Latvieu"},"ml-IN":{englishName:"Malayalam",localizedName:""},mr:{englishName:"Marathi",localizedName:""},ms:{englishName:"Malay",localizedName:"Melayu"},nl:{englishName:"Dutch",localizedName:"Nederlands"},no:{englishName:"Norwegian",localizedName:"Norsk"},nb:{englishName:"Norwegian Bokmal",localizedName:"Norsk bokml"},"nn-NO":{englishName:"Norwegian Nynorsk",localizedName:"Norsk nynorsk"},"pa-IN":{englishName:"Punjabi",localizedName:""},pl:{englishName:"Polish",localizedName:"Polski"},ps:{englishName:"Pashto",localizedName:""},"pt-BR":{englishName:"Portuguese (Brazil)",localizedName:"Portugus (Brasil)"},"pt-PT":{englishName:"Portuguese (Portugal)",localizedName:"Portugus (Portugal)"},ro:{englishName:"Romanian",localizedName:"Romn"},ru:{englishName:"Russian",localizedName:""},sat:{englishName:"Santali",localizedName:""},"si-LK":{englishName:"Sinhala",localizedName:""},sk:{englishName:"Slovak",localizedName:"Slovenina"},sl:{englishName:"Slovenian",localizedName:"Slovenski"},sq:{englishName:"Albanian",localizedName:"shqip"},sr:{englishName:"Serbian (Cyrillic)",localizedName:"Srpski"},su:{englishName:"Sundanese",localizedName:" "},"sv-SE":{englishName:"Swedish",localizedName:"Svenska"},sw:{englishName:"Swahili",localizedName:"Kiswahili"},"sw-TZ":{englishName:"Swahili (Tanzania)",localizedName:"Kiswahili (Tanzania)"},ta:{englishName:"Tamil",localizedName:""},te:{englishName:"Telugu",localizedName:""},th:{englishName:"Thai",localizedName:""},tl:{englishName:"Tagalog",localizedName:" "},tr:{englishName:"Turkish",localizedName:"Trke"},uk:{englishName:"Ukrainian",localizedName:""},"ur-IN":{englishName:"Urdu (India)",localizedName:" ()"},"ur-PK":{englishName:"Urdu (Pakistan)",localizedName:" ()"},vi:{englishName:"Vietnamese",localizedName:"Ting vit"},"zh-CN":{englishName:"Chinese (Simplified)",localizedName:"()"},"zh-TW":{englishName:"Chinese (Traditional)",localizedName:"()"}},n.isLocaleEnabled=g,n.updateLocalizationAsync=function(t){const{targetId:r,baseUrl:i,force:s}=t;let{code:o}=t;if(o=n.normalizeLanguageCode(o)[0],"en-US"===o&&(o="en"),o===n.userLanguage()||!g(o)&&!s)return pxt.debug(`loc: ${o} (using built-in)`),Promise.resolve();pxt.debug(`loc: ${o}`);const a=pxt.Util.liveLocalizationEnabled();return b(r,i,o,a,e.pxtc.Util.TranslationsKind.Editor).then((t=>{var s;return t&&(n.setUserLanguage(o),null===(s=pxt.analytics)||void 0===s||s.addDefaultProperties({lang:o}),n.setLocalizedStrings(t)),e.pxtc.Util.downloadTranslationsAsync(r,i,o,a,e.pxtc.Util.TranslationsKind.Apis).then((t=>{t&&(e.pxtc.apiLocalizationStrings=t)}))}))},function(e){e[e.Editor=0]="Editor",e[e.Sim=1]="Sim",e[e.Apis=2]="Apis",e[e.SkillMap=3]="SkillMap"}(y=n.TranslationsKind||(n.TranslationsKind={})),n.downloadTranslationsAsync=b,n.capitalize=function(e){return e?e[0].toLocaleUpperCase()+e.slice(1):e},n.uncapitalize=function(e){return(e||"").split(/(?=[A-Z])/g).join(" ").toLowerCase()},n.camelCaseToLowercaseWithSpaces=function(e){return e.replace(/([A-Z])/gm," $1").toLocaleLowerCase().trim()},n.snakeCaseToLowercaseWithSpaces=function(e){return e.replace(/_/g," ").toLocaleLowerCase().trim()},n.range=function(e){let t=[];for(let n=0;n<e;++n)t.push(n);return t},n.multipartPostAsync=function(e,t={},r=null,i=null){const s="--------------------------0461489f461126c5";let o="";Object.keys(t).forEach((e=>function(e,t){o+=s+"\r\n",o+='Content-Disposition: form-data; name="'+e+'"\r\n\r\n',o+=t+"\r\n"}(e,t[e]))),r&&function(e,t){const n=e.split("/").reverse()[0];o+=s+"\r\n",o+='Content-Disposition: form-data; name="files['+e+']"; filename="'+n+'"\r\n',o+="\r\n",o+=t+"\r\n"}(r,i),o+=s+"--\r\n";const a={url:e,method:"POST",headers:{"Content-Type":"multipart/form-data; boundary="+s.slice(2)},data:o};return n.httpRequestCoreAsync(a)},n.toDataUri=function(e,n){return/^https?:/i.test(e)||/^data:/i.test(e)?e:(n||/^<svg/i.test(e)&&(n="image/svg+xml"),/xml|svg/.test(n)?`data:${n},${encodeURIComponent(e)}`:`data:${n||"image/png"};base64,${t.encodeBase64(h(e))}`)},n.imageMagic=1496611453,n.imageHeaderSize=36,n.encodeBlobAsync=function(e,t){const r=n.imageHeaderSize+t.length,i=3*(e.width*e.height-1);let s=1;for(;s<4&&!(i*s>=8*r);)s++;let o=i*s>>3,a=r-o,l=0,c=e.width*e.height*4;if(a>0){const t=3*e.width;l=Math.ceil(a/t);const n=document.createElement("canvas");n.width=e.width,n.height=e.height+l;n.getContext("2d").drawImage(e,0,0),e=n}let u=pxt.HF2.encodeU32LE([n.imageMagic,t.length,l,0,0,0,0,0,0]);function d(e,t,n,r){let i=0,s=0,o=r[s++];const a=(1<<n)-1;let l=!0;for(;l;){let c=o>>i&a,u=8-i;if(u<=n){if(s>=r.length){if(0==u)break;l=!1}o=r[s++],c|=o<<u&a,i=n-u}else i+=n;e[t]=255&(e[t]&~a|c),3==(3&++t)&&(e[t++]=255)}return t}pxt.Util.assert(u.length==n.imageHeaderSize);const p=e.getContext("2d"),h=p.getImageData(0,0,e.width,e.height);d(h.data,0,1,[s]);let f=4;if(f=d(h.data,f,s,u),pxt.Util.assert(0==(3&f)),0==l)f=d(h.data,f,s,t);else{let e=o-u.length;f=d(h.data,f,s,t.slice(0,e)),f=d(h.data,c,8,t.slice(e))}for(f|=3;f<h.data.length;)h.data[f]=255,f+=4;return p.putImageData(h,0,0),e},n.decodeBlobAsync=function(e){return pxt.BrowserUtils.loadCanvasAsync(e).then((e=>{const t=e.getContext("2d").getImageData(0,0,e.width,e.height).data,r=1&t[0]|(1&t[1])<<1|(1&t[2])<<2;if(r>5||0==r)return Promise.reject(new Error(n.lf("Invalid encoded PNG format")));function i(e,n,r){let i=0,s=0,o=0;const a=(1<<n)-1;for(;s<r.length;)o|=(t[e++]&a)<<i,3==(3&e)&&e++,i+=n,i>=8&&(r[s++]=255&o,o>>=8,i-=8);return e}const s=new Uint8Array(pxt.Util.imageHeaderSize);let o=i(4,r,s);const a=pxt.HF2.decodeU32LE(s);if(a[0]!=pxt.Util.imageMagic)return Promise.reject(new Error(n.lf("Invalid magic in encoded PNG")));const l=new Uint8Array(a[1]),c=a[2];if(c>0){const t=(e.height-c)*e.width,n=new Uint8Array((3*(t-1)*r>>3)-pxt.Util.imageHeaderSize);i(o,r,n),l.set(n);const s=new Uint8Array(l.length-n.length);i(4*t,8,s),l.set(s,n.length)}else i(o,r,l);return l}))},n.parseQueryString=function(e){let t={};return e.replace(/\+/g," ").replace(/([^#?&=]+)=([^#?&=]*)/g,((e,n,r)=>(t[decodeURIComponent(n)]=decodeURIComponent(r),""))),t},n.stringifyQueryString=function(e,t){for(let n of Object.keys(t))e.indexOf("?")>=0?e+="&":e+="?",e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]);return e},n.cloneTargetBundle=function(e){const t=(e=Object.assign({},e)).apiInfo;delete e.apiInfo;const r=e.bundleddirs;delete e.bundleddirs;const i=e.bundledpkgs;delete e.bundledpkgs;const s=e.tutorialInfo;delete e.tutorialInfo;const o=n.clone(e);if(t){o.apiInfo={};for(const e of Object.keys(t)){const n=t[e].apis;o.apiInfo[e]={sha:t[e].sha,apis:{jres:Object.assign({},n.jres),byQName:v(n.byQName)}}}}if(r&&(o.bundleddirs=[...r]),i){o.bundledpkgs={};for(const e of Object.keys(i))o.bundledpkgs[e]=Object.assign({},i[e])}if(s){o.tutorialInfo={};for(const e of Object.keys(s)){const t=s[e];o.tutorialInfo[e]={hash:t.hash,usedBlocks:Object.assign({},t.usedBlocks),snippetBlocks:Object.assign({},t.snippetBlocks),highlightBlocks:Object.assign({},t.highlightBlocks),validateBlocks:Object.assign({},t.validateBlocks)}}}return o},n.cloneApis=v,n.cloneSymbolInfo=T,n.toUTF8Array=function(e){return(new TextEncoder).encode(e)},n.fromUTF8Array=function(e){return(new TextDecoder).decode(e)}}(t.Util||(t.Util={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){e.Util.httpRequestCoreAsync=function(t){return new Promise(((n,r)=>{let i,s=!1,o=e.Util.clone(t.headers)||{};i=new XMLHttpRequest,t.responseArrayBuffer&&(i.responseType="arraybuffer"),t.withCredentials&&(i.withCredentials=!0),i.onreadystatechange=()=>{if(!s&&4==i.readyState){s=!0;let e={statusCode:i.status,headers:{},buffer:i.responseBody||i.response,text:t.responseArrayBuffer?void 0:i.responseText};i.getAllResponseHeaders().split(/\r?\n/).forEach((t=>{let n=/^\s*([^:]+): (.*)/.exec(t);n&&(e.headers[n[1].toLowerCase()]=n[2])})),n(e)}};let a,l=t.data,c=t.method||(null==l?"GET":"POST");null==l?a=null:l instanceof Uint8Array?a=l:"object"==typeof l?(a=JSON.stringify(l),o["content-type"]="application/json; charset=utf8"):"string"==typeof l?a=l:e.Util.oops("bad data"),i.open(c,t.url),Object.keys(o).forEach((e=>{i.setRequestHeader(e,o[e])})),null==a?i.send():i.send(a)}))},e.Util.sha256=o,e.Util.getRandomBuf=e=>{if(window.crypto)window.crypto.getRandomValues(e);else for(let t=0;t<e.length;++t)e[t]=Math.floor(255*Math.random())};const n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(e,t){return e>>>t|e<<32-t}function i(t,i){e.Util.assert(8==t.length),e.Util.assert(64==i.length);for(let e=16;e<64;++e){let t=r(i[e-15],7)^r(i[e-15],18)^i[e-15]>>>3,n=r(i[e-2],17)^r(i[e-2],19)^i[e-2]>>>10;i[e]=i[e-16]+t+i[e-7]+n|0}let s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],p=t[7];for(let e=0;e<64;++e){let t=p+(r(c,6)^r(c,11)^r(c,25))+(c&u^~c&d)+n[e]+i[e]|0,h=s&o^s&a^o&a;p=d,d=u,u=c,c=l+t|0,l=a,a=o,o=s,s=t+((r(s,2)^r(s,13)^r(s,22))+h|0)|0}t[0]+=s,t[1]+=o,t[2]+=a,t[3]+=l,t[4]+=c,t[5]+=u,t[6]+=d,t[7]+=p}function s(e){let t=new Uint32Array(8);t[0]=1779033703,t[1]=3144134277,t[2]=1013904242,t[3]=2773480762,t[4]=1359893119,t[5]=2600822924,t[6]=528734635,t[7]=1541459225;let n=new Uint32Array(64);function r(e){let r=e.length-63;for(let s=0;s<r;s+=64){for(let t=0;t<16;t++){let r=(t<<2)+s;n[t]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]}i(t,n)}}r(e);let s=64-(e.length+9)%64;64==s&&(s=0);let o=e.length-e.length%64,a=new Uint8Array(e.length-o+1+s+8),l=0;for(;o<e.length;)a[l++]=e[o++];for(a[l++]=128;s-- >0;)a[l++]=0;let c=8*e.length;for(l=a.length;c>0;)a[--l]=255&c,c>>=8;r(a);let u="";for(let e=0;e<t.length;++e)u+=("000000000"+t[e].toString(16)).slice(-8);return u.toLowerCase()}function o(t){pxt.perf.measureStart("sha256buffer");const n=s(e.Util.toUTF8Array(t));return pxt.perf.measureEnd("sha256buffer"),n}t.sha256buffer=s,t.sha256string=o}(e.BrowserImpl||(e.BrowserImpl={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){const n={add:(e,t,n)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");if(t in e)throw new Error(`jsonPatch: object already contains key ${t}`);e[t]=n},replace:(e,t,n)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");e[t]=n},remove:(e,t)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");delete e[t]}},r={add:(e,t,n)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");if(t in e)throw new Error(`jsonPatch: key ${t} already exists in array`);"number"!=typeof t||t!==Math.floor(t)?e[t]=n:e.splice(t,0,n)},replace:(e,t,n)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");"number"!=typeof t||t!==Math.floor(t)?e[t]=n:e.splice(t,1,n)},remove:(e,t)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");"number"!=typeof t||t!==Math.floor(t)?delete e[t]:e.splice(t,1)}};t.diff=function(e,t){const n={add:[],remove:[],replace:[]};function r(e,t){if(!Array.isArray(e))return t;const n=Number.parseFloat(t);return Number.isNaN(n)?t:n}return function e(t,i,s){if(!Object.is(t,i)){i=i||{},t=t||{};for(let e of Object.keys(t))if(!(e in i)){const i=r(t,e);n.remove.push({op:"remove",path:s.concat(i)})}for(const o of Object.keys(i)){const a=t[o],l=i[o],c=r(i,o);c in t?"object"!=typeof a&&"object"!=typeof l&&a!==l||typeof a!=typeof l||Array.isArray(a)!==Array.isArray(l)?n.replace.push({op:"replace",path:s.concat(c),value:l}):e(a,l,s.concat(c)):void 0!==i[c]&&(s.length&&n.add.push({op:"add",path:s,value:Array.isArray(i)?[]:{}}),n.add.push({op:"add",path:s.concat(c),value:l}))}}}(e,t,[]),[...n.remove.reverse(),...n.replace,...n.add.sort(((e,t)=>e.path.length-t.path.length))]},t.patchInPlace=function(e,t){if(!e||"object"!=typeof e)throw new Error("jsonPatch: Must be an object or an array.");for(const i of t){const t=i.path.slice(),s=t.pop();if(null==s)throw new Error("jsonPatch: missing last key");let o=e,a=t.shift();for(;null!=a;){if(!(a in o))throw new Error(`jsonPatch: missing parent element ${a}`);o=o[a],a=t.shift()}if(Array.isArray(o)&&"number"!=typeof s)throw new Error("jsonPatch: expected numeric index for array object");const l=Array.isArray(o)?r:n;"remove"===i.op?l.remove(o,s):"add"!==i.op||s in o?"replace"===i.op&&l.replace(o,s,i.value):l.add(o,s,i.value)}},t.opsAreEqual=function(t,n){return t.op===n.op&&e.U.arrayEquals(t.path,n.path)}}(e.jsonPatch||(e.jsonPatch={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(t){!function(t){function n(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){const r=Array.isArray(e),i=Array.isArray(t);if(r&&i){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}if(r!==i)return!1;const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!1;for(const r of s){if(!t.hasOwnProperty(r))return!1;if(!n(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}t.diffTests=function(){const t=[{comment:"test 1",obja:{a:4,b:5},objb:{a:3,b:5},expected:[{op:"replace",path:["a"],value:3}]},{comment:"test 2",obja:{a:3,b:5},objb:{a:4,c:5},expected:[{op:"remove",path:["b"]},{op:"replace",path:["a"],value:4},{op:"add",path:["c"],value:5}]},{comment:"test 3",obja:{a:4,b:[1,2,3]},objb:{a:3,b:[1,2,4]},expected:[{op:"replace",path:["a"],value:3},{op:"replace",path:["b",2],value:4}]},{comment:"test 4",obja:{a:3,b:[1,2,4]},objb:{a:3,b:[1,2,4,5]},expected:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",3],value:5}]},{comment:"test 5",obja:{a:4,b:{c:3}},objb:{a:4,b:{c:4}},expected:[{op:"replace",path:["b","c"],value:4}]},{comment:"test 6",obja:{a:4,b:{c:4}},objb:{a:5,b:{d:4}},expected:[{op:"remove",path:["b","c"]},{op:"replace",path:["a"],value:5},{op:"add",path:["b"],value:{}},{op:"add",path:["b","d"],value:4}]},{comment:"test 7",obja:{a:4,b:[2,"foo"]},objb:{a:4,b:[2,"foo",["this","that"]]},expected:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",2],value:["this","that"]}]}];for(const r of t){console.log(r.comment);const t=e.pxtc.jsonPatch.diff(r.obja,r.objb);n(t,r.expected)?console.log("succeeded"):(console.error("FAILED"),console.log("got",t),console.log("exp",r.expected))}},t.patchTests=function(){const t=[{comment:"test 1",obj:{a:"foo",b:[4,11]},patches:[{op:"remove",path:["b"]},{op:"replace",path:["a"],value:4},{op:"add",path:["c"],value:5}],expected:{a:4,c:5}},{comment:"test 2",obj:{a:4,b:[1,2,3]},patches:[{op:"replace",path:["a"],value:3},{op:"replace",path:["b",2],value:4},{op:"add",path:["b",3],value:9}],expected:{a:3,b:[1,2,4,9]}},{comment:"test 3",obj:{a:4,b:{c:3}},patches:[{op:"replace",path:["a"],value:5},{op:"remove",path:["b","c"]},{op:"add",path:["b","d"],value:4}],expected:{a:5,b:{d:4}}},{comment:"test 4",obj:{a:4},patches:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",0],value:"foo"},{op:"add",path:["b",1],value:"bar"}],expected:{a:4,b:["foo","bar"]},validate:e=>e.b&&e.b.forEach}];for(const r of t){console.log(r.comment),e.pxtc.jsonPatch.patchInPlace(r.obj,r.patches);!n(r.obj,r.expected)||!r.validate||r.validate(r.obj)?console.log("succeeded"):r.expected&&(console.error("FAILED"),console.log("got",r.obj),console.log("exp",r.expected))}}}(t.tests||(t.tests={}))}(t.jsonPatch||(t.jsonPatch={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){e.perf||(e.perf={})}(pxt||(pxt={})),pxt.perf.report||(pxt.perf.report=()=>{}),pxt.perf.recordMilestone||(pxt.perf.recordMilestone=()=>{}),pxt.perf.measureStart||(pxt.perf.measureStart=()=>{}),pxt.perf.measureEnd||(pxt.perf.measureEnd=()=>{}),function(e){let t;e.U=pxtc.Util,e.Util=pxtc.Util;let n,r,i,s={};function o(n,r){/^csv-/.test(n)?e.setAppTargetVariant(n.replace(/^csv-*/,"")):e.appTarget&&(s[n]=r,e.U.jsonCopyFrom(e.appTarget.compile.switches,s),e.U.jsonCopyFrom(t.compile.switches,s))}function a(e,t,n){if(Array.isArray(e))return e.map((e=>a(e,t,n)));if("object"==typeof e){for(const r of Object.keys(e))e[r]=a(e[r],t,n);return e}return"string"==typeof e&&t.test(e)?n(e):e}function l(){let t=e.appTarget.compile;t||(t=e.appTarget.compile={isNative:!1,hasHex:!1,switches:{}}),t.hasHex&&(t.nativeType||(t.nativeType=pxtc.NATIVE_TYPE_THUMB)),t.switches||(t.switches={}),t.nativeType==pxtc.NATIVE_TYPE_VM&&(t.sourceMap=!0),e.U.jsonCopyFrom(t.switches,s),t.jsRefCounting=!1,t.useUF2||t.useELF||null!=t.noSourceInFlash||(t.noSourceInFlash=!0),void 0===t.utf8&&(t.utf8=!0),e.appTarget.appTheme||(e.appTarget.appTheme={}),e.appTarget.appTheme.embedUrl||(e.appTarget.appTheme.embedUrl=e.appTarget.appTheme.homeUrl);let n=e.appTarget.compileService;if(n&&n.yottaTarget&&!n.yottaBinary&&(n.yottaBinary="pxt-microbit-app-combined.hex"),e.appTarget=a(e.appTarget,/^@cdnUrl@/i,(t=>e.BrowserUtils.patchCdn(t))),Object.keys(e.appTarget.bundledpkgs).forEach((t=>{const n=e.appTarget.bundledpkgs[t],r=JSON.parse(n[e.CONFIG_NAME]);r.icon&&(r.icon=e.BrowserUtils.patchCdn(r.icon)),n[e.CONFIG_NAME]=e.Package.stringifyConfig(r)})),"undefined"!=typeof window){const t={"lockededitor=1":{appTheme:{lockedEditor:!0}},"hidemenu=1":{appTheme:{hideMenuBar:!0}}};e.appTarget.queryVariants&&e.Util.jsonCopyFrom(t,e.appTarget.queryVariants);const n=window.location.href;Object.keys(t).forEach((r=>{if(new RegExp(r,"i").exec(n)){let n=t[r];n&&e.U.jsonMergeFrom(e.appTarget,n)}}))}}function c(n=!1){e.perf.measureStart("reloadAppTargetVariant");const r=n?"":JSON.stringify(e.appTarget);if(e.appTarget=e.U.cloneTargetBundle(t),e.appTargetVariant){const t=e.appTarget.variants&&e.appTarget.variants[e.appTargetVariant];t?e.U.jsonMergeFrom(e.appTarget,t):e.U.userError(lf("Variant '{0}' not defined in pxtarget.json",e.appTargetVariant))}l(),!n&&e.onAppTargetChanged&&r!=JSON.stringify(e.appTarget)&&e.onAppTargetChanged(),e.perf.measureEnd("reloadAppTargetVariant")}function u(){return{relprefix:"/--",workerjs:"/worker.js",monacoworkerjs:"/monacoworker.js",gifworkerjs:"/gifjs/gif.worker.js",serviceworkerjs:"/serviceworker.js",typeScriptWorkerJs:"/tsworker.js",pxtVersion:"local",pxtRelId:"localRelId",pxtCdnUrl:"/cdn/",commitCdnUrl:"/cdn/",blobCdnUrl:"/blb/",cdnUrl:"/cdn/",targetUrl:"",targetVersion:"local",targetRelId:"",targetId:e.appTarget?e.appTarget.id:"",simUrl:"/sim/simulator.html",simserviceworkerUrl:"/simulatorserviceworker.js",simworkerconfigUrl:"/sim/workerConfig.js",partsUrl:"/sim/siminstructions.html"}}function d(){return i||(i=e.Cloud.downloadTargetConfigAsync().then((e=>e||{}),(e=>({})))),i}function p(t=null){return t||(t=e.appTarget.compile),t.nativeType==ts.pxtc.NATIVE_TYPE_VM?t.useESP?t.useUF2?ts.pxtc.BINARY_UF2:ts.pxtc.BINARY_ESP:ts.pxtc.BINARY_PXT64:t.useUF2&&!t.switches.rawELF?ts.pxtc.BINARY_UF2:t.useELF?ts.pxtc.BINARY_ELF:ts.pxtc.BINARY_HEX}e.setAppTarget=function(n){e.appTarget=n||{},l(),t=e.U.cloneTargetBundle(e.appTarget)},e.setBundledApiInfo=function(e){for(const t of Object.keys(e)){const n=e[t].apis.byQName;for(const e of Object.keys(n)){const t=n[e],r=e.lastIndexOf("."),i=t.pyQName,s=n[e]={kind:Math.abs(t.kind||7),qName:e,namespace:e.slice(0,r<0?0:r),name:e.slice(r+1),pyQName:i,pyName:i?i.slice(i.lastIndexOf(".")+1):void 0,fileName:"",attributes:t.attributes||{},retType:t.retType||"void",parameters:t.parameters?t.parameters.map((e=>({name:e.name,description:e.description||"",type:e.type||"number",initializer:e.initializer,default:e.default,options:e.options||{},isEnum:!!e.isEnum,handlerParameters:e.handlerParameters}))):null,extendsTypes:t.extendsTypes,snippet:t.kind&&t.kind<0?null:void 0,isInstance:!!t.isInstance,isReadOnly:!!t.isReadOnly},o=s.attributes;o.paramDefl||(o.paramDefl={}),o.callingConvention||(o.callingConvention=0),o.paramHelp||(o.paramHelp={}),o.jsDoc||(o.jsDoc=""),o._name=s.name.replace(/@.*/,"")}}n=e},e.getBundledApiInfo=function(){return n},e.savedAppTheme=function(){return t?t.appTheme:void 0},e.setCompileSwitch=o,e.setCompileSwitches=function(e){if(e)for(let t of e.split(/[\s,;:]+/))t&&("-"==t[0]?o(t.slice(1),!1):o(t,!0))},e.bundledSvg=function(t){if(!t)return;let n=r&&r[t];if(n)return n;if(!e.appTarget.simulator||!e.appTarget.simulator.dynamicBoardDefinition)return;r||(r={});const i=e.appTarget.bundledpkgs[t];if(!i)return;if(JSON.parse(i["pxt.json"]).core&&i["board.json"]){const n=JSON.parse(i["board.json"]);if(n&&n.visual&&n.visual.image){let s=n.visual.image;/^pkg:\/\//.test(s)&&(s=i[s.slice(6)]),r[t]=`data:image/svg+xml;base64,${ts.pxtc.encodeBase64(e.Util.toUTF8(s))}`}}return r[t]},e.replaceStringsInJsonBlob=a,e.reloadAppTargetVariant=c,e.setAppTargetVariant=function(t,n={}){e.debug(`app variant: ${t}`),(n.force||e.appTargetVariant!==t&&(e.appTargetVariant||t))&&(e.appTargetVariant=t,c(n.temporary))},e.setHwVariant=function(t,n){t=t.replace(/.*---/,""),/^[\w\-]+$/.test(t)?(e.hwVariant=t,e.hwName=n||t):(e.hwVariant=null,e.hwName=null),e.debug(`hwVariant: ${e.hwVariant} (${e.hwName})`)},e.hasHwVariants=function(){return!!e.appTarget.variants&&Object.keys(e.appTarget.bundledpkgs).some((e=>/^hw---/.test(e)))},e.getHwVariants=function(){return e.appTarget.variants?Object.keys(e.appTarget.bundledpkgs).filter((e=>/^hw---/.test(e))).map((t=>JSON.parse(e.appTarget.bundledpkgs[t][e.CONFIG_NAME]))).filter((t=>!!e.appTarget.appTheme.experimentalHw||!t.experimentalHw)):[]},e.options={},e.debug="undefined"!=typeof console&&console.debug?t=>{e.options.debug&&console.debug(t)}:()=>{},e.log="undefined"!=typeof console&&console.log?e=>{console.log(e)}:()=>{},e.reportException=function(e,t){if(console&&(console.error(e),t))try{console.log(t)}catch(e){}},e.reportError=function(t,n,r){if(console&&(console.error(`${t}: ${n}`),r))try{e.log(JSON.stringify(r,null,2))}catch(e){}},e.localWebConfig=u,e.getOnlineCdnUrl=function(){if(!e.webConfig)return null;let t=/^(https:\/\/[^\/]+)/.exec(e.webConfig.commitCdnUrl);return t?t[1]:null},e.setupWebConfig=function(t){t?e.webConfig=t:e.webConfig||(e.webConfig=u())},e.getEmbeddedScript=function(t){return e.U.lookup(e.appTarget.bundledpkgs||{},t)},e.targetConfigAsync=d,e.packagesConfigAsync=function(){return d().then((e=>e?e.packages:void 0))},e.CONFIG_NAME="pxt.json",e.SIMSTATE_JSON=".simstate.json",e.SERIAL_EDITOR_FILE="serial.txt",e.README_FILE="README.md",e.GITIGNORE_FILE=".gitignore",e.ASSETS_FILE="assets.json",e.CLOUD_ID="pxt/",e.BLOCKS_PROJECT_NAME="blocksprj",e.JAVASCRIPT_PROJECT_NAME="tsprj",e.PYTHON_PROJECT_NAME="pyprj",e.MAIN_BLOCKS="main.blocks",e.MAIN_TS="main.ts",e.MAIN_PY="main.py",e.DEFAULT_GROUP_NAME="other",e.TILEMAP_CODE="tilemap.g.ts",e.TILEMAP_JRES="tilemap.g.jres",e.IMAGES_CODE="images.g.ts",e.IMAGES_JRES="images.g.jres",e.TUTORIAL_CODE_START="_onCodeStart.ts",e.TUTORIAL_CODE_STOP="_onCodeStop.ts",e.TUTORIAL_INFO_FILE="tutorial-info-cache.json",e.TUTORIAL_CUSTOM_TS="tutorial.custom.ts",e.BREAKPOINT_TABLET=991,e.PALETTES_FILE="_palettes.json",e.HISTORY_FILE="_history",e.outputName=p,e.isOutputText=function(e=null){return p(e)==ts.pxtc.BINARY_HEX}}(pxt||(pxt={})),function(e){!function(t){const n="this";let r;function i(){if(r={device_while:{name:e.Util.lf("a loop that repeats while the condition is true"),tooltip:e.Util.lf("Run the same sequence of actions while the condition is met."),url:"/blocks/loops/while",category:"loops",block:{message0:e.Util.lf("while %1"),appendField:e.Util.lf("{id:while}do")}},pxt_controls_for:{name:e.Util.lf("a loop that repeats the number of times you say"),tooltip:e.Util.lf("Have the variable '{0}' take on the values from 0 to the end number, counting by 1, and do the specified blocks."),url:"/blocks/loops/for",category:"loops",block:{message0:e.Util.lf("for %1 from 0 to %2"),variable:e.Util.lf("{id:var}index"),appendField:e.Util.lf("{id:for}do")}},controls_simple_for:{name:e.Util.lf("a loop that repeats the number of times you say"),tooltip:e.Util.lf("Have the variable '{0}' take on the values from 0 to the end number, counting by 1, and do the specified blocks."),url:"/blocks/loops/for",category:"loops",block:{message0:e.Util.lf("for %1 from 0 to %2"),variable:e.Util.lf("{id:var}index"),appendField:e.Util.lf("{id:for}do")}},pxt_controls_for_of:{name:e.Util.lf("a loop that repeats for each value in an array"),tooltip:e.Util.lf("Have the variable '{0}' take the value of each item in the array one by one, and do the specified blocks."),url:"/blocks/loops/for-of",category:"loops",block:{message0:e.Util.lf("for element %1 of %2"),variable:e.Util.lf("{id:var}value"),appendField:e.Util.lf("{id:for_of}do")}},controls_for_of:{name:e.Util.lf("a loop that repeats for each value in an array"),tooltip:e.Util.lf("Have the variable '{0}' take the value of each item in the array one by one, and do the specified blocks."),url:"/blocks/loops/for-of",category:"loops",block:{message0:e.Util.lf("for element %1 of %2"),variable:e.Util.lf("{id:var}value"),appendField:e.Util.lf("{id:for_of}do")}},math_op2:{name:e.Util.lf("minimum or maximum of 2 numbers"),tooltip:{min:e.Util.lf("smaller value of 2 numbers"),max:e.Util.lf("larger value of 2 numbers")},url:"/blocks/math",operators:{op:["min","max"]},category:"math"},math_op3:{name:e.Util.lf("absolute number"),tooltip:e.Util.lf("absolute value of a number"),url:"/reference/math",category:"math",block:{message0:e.Util.lf("absolute of %1")}},math_number:{name:e.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:e.appTarget&&e.appTarget.compile?e.Util.lf("a decimal number"):e.Util.lf("an integer number")},math_integer:{name:e.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:e.Util.lf("an integer number")},math_whole_number:{name:e.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:e.Util.lf("a whole number")},math_number_minmax:{name:e.Util.lf("{id:block}number"),url:"/blocks/math",category:"math"},math_arithmetic:{name:e.Util.lf("arithmetic operation"),url:"/blocks/math",tooltip:{ADD:e.Util.lf("Return the sum of the two numbers."),MINUS:e.Util.lf("Return the difference of the two numbers."),MULTIPLY:e.Util.lf("Return the product of the two numbers."),DIVIDE:e.Util.lf("Return the quotient of the two numbers."),POWER:e.Util.lf("Return the first number raised to the power of the second number.")},operators:{OP:["ADD","MINUS","MULTIPLY","DIVIDE","POWER"]},category:"math",block:{MATH_ADDITION_SYMBOL:e.Util.lf("{id:op}+"),MATH_SUBTRACTION_SYMBOL:e.Util.lf("{id:op}-"),MATH_MULTIPLICATION_SYMBOL:e.Util.lf("{id:op}"),MATH_DIVISION_SYMBOL:e.Util.lf("{id:op}/"),MATH_POWER_SYMBOL:e.Util.lf("{id:op}**")}},math_modulo:{name:e.Util.lf("division remainder"),tooltip:e.Util.lf("Return the remainder from dividing the two numbers."),url:"/blocks/math",category:"math",block:{MATH_MODULO_TITLE:e.Util.lf("remainder of %1 / %2")}},math_js_op:{name:e.Util.lf("math function"),tooltip:{sqrt:e.Util.lf("Returns the square root of the argument"),sin:e.Util.lf("Returns the sine of the argument"),cos:e.Util.lf("Returns the cosine of the argument"),acos:e.Util.lf("Returns the arccosine of the argument"),asine:e.Util.lf("Returns the arcsine of the argument"),tan:e.Util.lf("Returns the tangent of the argument"),atan2:e.Util.lf("Returns the arctangent of the quotient of the two arguments"),idiv:e.Util.lf("Returns the integer portion of the division operation on the two arguments"),imul:e.Util.lf("Returns the integer portion of the multiplication operation on the two arguments")},url:"/blocks/math",operators:{OP:["sqrt","sin","cos","tan","atan2","idiv","imul"]},category:"math",block:{sqrt:e.Util.lf("{id:op}square root"),sin:e.Util.lf("{id:op}sin"),cos:e.Util.lf("{id:op}cos"),asin:e.Util.lf("{id:op}asin"),acos:e.Util.lf("{id:op}acos"),tan:e.Util.lf("{id:op}tan"),atan2:e.Util.lf("{id:op}atan2"),idiv:e.Util.lf("{id:op}integer /"),imul:e.Util.lf("{id:op}integer ")}},math_js_round:{name:e.Util.lf("rounding functions"),tooltip:{round:e.Util.lf("Increases the argument to the next higher whole number if its fractional part is more than one half"),ceil:e.Util.lf("Increases the argument to the next higher whole number"),floor:e.Util.lf("Decreases the argument to the next lower whole number"),trunc:e.Util.lf("Removes the fractional part of the argument")},url:"/blocks/math",operators:{OP:["round","ceil","floor","trunc"]},category:"math",block:{round:e.Util.lf("{id:op}round"),ceil:e.Util.lf("{id:op}ceiling"),floor:e.Util.lf("{id:op}floor"),trunc:e.Util.lf("{id:op}truncate")}},variables_change:{name:e.Util.lf("update the value of a number variable"),tooltip:e.Util.lf("Changes the value of the variable by this amount"),url:"/blocks/variables/change",category:"variables",block:{message0:e.Util.lf("change %1 by %2")}},controls_repeat_ext:{name:e.Util.lf("a loop that repeats and increments an index"),tooltip:e.Util.lf("Do some statements several times."),url:"/blocks/loops/repeat",category:"loops",block:{CONTROLS_REPEAT_TITLE:e.Util.lf("repeat %1 times"),CONTROLS_REPEAT_INPUT_DO:e.Util.lf("{id:repeat}do")}},variables_get:{name:e.Util.lf("get the value of a variable"),tooltip:e.Util.lf("Returns the value of this variable."),url:"/blocks/variables",category:"variables",block:{VARIABLES_GET_CREATE_SET:e.Util.lf("Create 'set %1'")}},variables_get_reporter:{name:e.Util.lf("get the value of a variable"),tooltip:e.Util.lf("Returns the value of this variable."),url:"/blocks/variables",category:"variables",block:{VARIABLES_GET_CREATE_SET:e.Util.lf("Create 'set %1'")}},variables_set:{name:e.Util.lf("assign the value of a variable"),tooltip:e.Util.lf("Sets this variable to be equal to the input."),url:"/blocks/variables/assign",category:"variables",block:{VARIABLES_SET:e.Util.lf("set %1 to %2")}},controls_if:{name:e.Util.lf("a conditional statement"),tooltip:{CONTROLS_IF_TOOLTIP_1:e.Util.lf("If a value is true, then do some statements."),CONTROLS_IF_TOOLTIP_2:e.Util.lf("If a value is true, then do the first block of statements. Otherwise, do the second block of statements."),CONTROLS_IF_TOOLTIP_3:e.Util.lf("If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements."),CONTROLS_IF_TOOLTIP_4:e.Util.lf("If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.")},tooltipSearch:"CONTROLS_IF_TOOLTIP_2",url:"/blocks/logic/if",category:"logic",block:{CONTROLS_IF_MSG_IF:e.Util.lf("{id:logic}if"),CONTROLS_IF_MSG_THEN:e.Util.lf("{id:logic}then"),CONTROLS_IF_MSG_ELSE:e.Util.lf("{id:logic}else"),CONTROLS_IF_MSG_ELSEIF:e.Util.lf("{id:logic}else if")}},lists_create_with:{name:e.Util.lf("create an array"),tooltip:e.Util.lf("Creates a new array."),url:"/reference/arrays/create",category:"arrays",blockTextSearch:"LISTS_CREATE_WITH_INPUT_WITH",block:{LISTS_CREATE_EMPTY_TITLE:e.Util.lf("empty array"),LISTS_CREATE_WITH_INPUT_WITH:e.Util.lf("array of"),LISTS_CREATE_WITH_CONTAINER_TITLE_ADD:e.Util.lf("array"),LISTS_CREATE_WITH_ITEM_TITLE:e.Util.lf("value")}},lists_length:{name:e.Util.lf("array length"),tooltip:e.Util.lf("Returns the number of items in an array."),url:"/reference/arrays/length",category:"arrays",block:{LISTS_LENGTH_TITLE:e.Util.lf("length of array %1")}},lists_index_get:{name:e.Util.lf("get a value in an array"),tooltip:e.Util.lf("Returns the value at the given index in an array."),url:"/reference/arrays/get",category:"arrays",block:{message0:e.Util.lf("%1 get value at %2")}},lists_index_set:{name:e.Util.lf("set a value in an array"),tooltip:e.Util.lf("Sets the value at the given index in an array"),url:"/reference/arrays/set",category:"arrays",block:{message0:e.Util.lf("%1 set value at %2 to %3")}},logic_compare:{name:e.Util.lf("comparing two numbers"),tooltip:{LOGIC_COMPARE_TOOLTIP_EQ:e.Util.lf("Return true if both inputs equal each other."),LOGIC_COMPARE_TOOLTIP_NEQ:e.Util.lf("Return true if both inputs are not equal to each other."),LOGIC_COMPARE_TOOLTIP_LT:e.Util.lf("Return true if the first input is smaller than the second input."),LOGIC_COMPARE_TOOLTIP_LTE:e.Util.lf("Return true if the first input is smaller than or equal to the second input."),LOGIC_COMPARE_TOOLTIP_GT:e.Util.lf("Return true if the first input is greater than the second input."),LOGIC_COMPARE_TOOLTIP_GTE:e.Util.lf("Return true if the first input is greater than or equal to the second input.")},url:"/blocks/logic/boolean",category:"logic",block:{search:"=  <  > "}},logic_operation:{name:e.Util.lf("boolean operation"),tooltip:{LOGIC_OPERATION_TOOLTIP_AND:e.Util.lf("Return true if both inputs are true."),LOGIC_OPERATION_TOOLTIP_OR:e.Util.lf("Return true if at least one of the inputs is true.")},url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_OPERATION_AND:e.Util.lf("{id:op}and"),LOGIC_OPERATION_OR:e.Util.lf("{id:op}or")}},logic_negate:{name:e.Util.lf("logical negation"),tooltip:e.Util.lf("Returns true if the input is false. Returns false if the input is true."),url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_NEGATE_TITLE:e.Util.lf("not %1")}},logic_boolean:{name:e.Util.lf("a `true` or `false` value"),tooltip:e.Util.lf("Returns either true or false."),url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_BOOLEAN_TRUE:e.Util.lf("{id:boolean}true"),LOGIC_BOOLEAN_FALSE:e.Util.lf("{id:boolean}false")}},text:{name:e.Util.lf("a piece of text"),tooltip:e.Util.lf("A letter, word, or line of text."),url:"/types/string",category:"text",block:{search:e.Util.lf("a piece of text")}},text_length:{name:e.Util.lf("number of characters in the string"),tooltip:e.Util.lf("Returns the number of letters (including spaces) in the provided text."),url:"/reference/text/length",category:"text",block:{TEXT_LENGTH_TITLE:e.Util.lf("length of %1")}},text_join:{name:e.Util.lf("join items to create text"),tooltip:e.Util.lf("Create a piece of text by joining together any number of items."),url:"/reference/text/join",category:"text",block:{TEXT_JOIN_TITLE_CREATEWITH:e.Util.lf("join")}},procedures_defnoreturn:{name:e.Util.lf("define the function"),tooltip:e.Util.lf("Create a function."),url:"/types/function/define",category:"functions",block:{PROCEDURES_DEFNORETURN_TITLE:e.Util.lf("function"),PROCEDURE_ALREADY_EXISTS:e.Util.lf("A function named '%1' already exists.")}},procedures_callnoreturn:{name:e.Util.lf("call the function"),tooltip:e.Util.lf("Call the user-defined function."),url:"/types/function/call",category:"functions",block:{PROCEDURES_CALLNORETURN_TITLE:e.Util.lf("call function")}},function_return:{name:e.Util.lf("return a value from within a function"),tooltip:e.Util.lf("Return a value from within a user-defined function."),url:"/types/function/return",category:"functions",block:{message_with_value:e.Util.lf("return %1"),message_no_value:e.Util.lf("return")}},function_definition:{name:e.Util.lf("define the function"),tooltip:e.Util.lf("Create a function."),url:"/types/function/define",category:"functions",block:{FUNCTIONS_EDIT_OPTION:e.Util.lf("Edit Function")}},function_call:{name:e.Util.lf("call the function"),tooltip:e.Util.lf("Call the user-defined function."),url:"/types/function/call",category:"functions",block:{FUNCTIONS_CALL_TITLE:e.Util.lf("call"),FUNCTIONS_GO_TO_DEFINITION_OPTION:e.Util.lf("Go to Definition")}},function_call_output:{name:e.Util.lf("call the function with a return value"),tooltip:e.Util.lf("Call the user-defined function with a return value."),url:"/types/function/call",category:"functions",block:{}}},r[pxtc.ON_START_TYPE]={name:e.Util.lf("on start event"),tooltip:e.Util.lf("Run code when the program starts"),url:"/blocks/on-start",category:"loops",block:{message0:e.Util.lf("on start %1 %2")}},r[pxtc.PAUSE_UNTIL_TYPE]={name:e.Util.lf("pause until"),tooltip:e.Util.lf("Pause execution of code until the given boolean expression is true"),url:"/blocks/pause-until",category:"loops",block:{message0:e.Util.lf("pause until %1")}},r[pxtc.TS_BREAK_TYPE]={name:e.Util.lf("break"),tooltip:e.Util.lf("Break out of the current loop or switch"),url:"/blocks/loops/break",category:"loops",block:{message0:e.Util.lf("break")}},r[pxtc.TS_CONTINUE_TYPE]={name:e.Util.lf("continue"),tooltip:e.Util.lf("Skip current iteration and continues with the next iteration in the loop"),url:"/blocks/loops/continue",category:"loops",block:{message0:e.Util.lf("continue")}},e.blocks.showBlockIdInTooltip)for(const e of Object.keys(r)){const t=r[e].tooltip;if("object"==typeof t&&null!==t)for(const n in t)t.hasOwnProperty(n)&&(r[e].tooltip[n]=`${t[n]} (id: ${e})`);else r[e].tooltip=`${r[e].tooltip} (id: ${e})`}}t.showBlockIdInTooltip=!1,t.requirePxtBlockly=()=>{},t.requireBlockly=()=>{},t.registerFieldEditor=()=>{},t.MATH_FUNCTIONS={unary:["sqrt","sin","cos","tan","asin","acos"],binary:["atan2"],infix:["idiv","imul"]},t.ROUNDING_FUNCTIONS=["round","ceil","floor","trunc"],t.builtinFunctionInfo={"Math.abs":{blockId:"math_op3",params:["x"]},"Math.min":{blockId:"math_op2",params:["x","y"]},"Math.max":{blockId:"math_op2",params:["x","y"]}},t.normalizeBlock=function(t,n=e.log){if(!t)return t;let r=t.replace(/(?:^|[^\\])([%$])\s+/g,"$1");return r!=t&&(n(`block has extra spaces: ${t}`),t=r),r=(t=r).replace(/([%$]\w+)\s*=\s*(\w+)/,"$1=$2"),r!=t&&(n(`block has space between %name and = : ${t}`),t=r),r=r.replace(/\s*\|\s*/g,"|"),r},t.compileInfo=function(e){const r={parameters:[],actualNameToParam:{},definitionNameToParam:{},handlerArgs:[]},i=(1==e.kind||2==e.kind)&&!e.attributes.defaultInstance,s=!!e.attributes._def,o=s?e.attributes._def.parameters.slice(0):void 0,a=s?o.length:e.parameters?e.parameters.length:0,l=t.builtinFunctionInfo[e.qName];s&&e.attributes._expandedDef&&o.push(...e.attributes._expandedDef.parameters);const c={},u=o?o.filter((e=>!e.ref||(c[e.name]=e,!1))):[];if(i&&s&&o.length){const t=c.this||o[0],i=t.name,s=!t.shadowBlockId||"variables_get"===t.shadowBlockId;let a=e.attributes.paramDefl[i]||e.attributes.paramDefl.this;s&&(a=t.varName||a),r.thisParameter={actualName:n,definitionName:i,shadowBlockId:t.shadowBlockId,type:e.namespace,defaultValue:a,definitionIndex:o.indexOf(t),fieldEditor:d(i,n),fieldOptions:p(i,n),shadowOptions:h(i,n)}}if(e.parameters){let t=i&&!c.this?1:0;e.parameters.forEach(((e,n)=>{let i;if(c[e.name]?i=c[e.name]:t<u.length&&(i=u[t],++t),i||!s){let s;e.options&&e.options.min&&e.options.max&&(s={min:e.options.min.value,max:e.options.max.value});const c=i?i.name:l?l.params[t++]:e.name,u=i&&("variables_get"===i.shadowBlockId||"lists_create_with"==i.shadowBlockId);r.parameters.push({actualName:e.name,type:e.type,defaultValue:u&&i.varName||e.default,definitionName:c,definitionIndex:i?o.indexOf(i):n,shadowBlockId:i&&i.shadowBlockId,isOptional:!!o&&o.indexOf(i)>=a,fieldEditor:d(c,e.name),fieldOptions:p(c,e.name),shadowOptions:h(c,e.name),range:s})}e.handlerParameters&&e.handlerParameters.forEach((e=>{r.handlerArgs.push({name:e.name,type:e.type,inBlockDef:!!o&&o.some((t=>t.ref&&t.name===e.name))})}))}))}return r.parameters.forEach((e=>{r.actualNameToParam[e.actualName]=e,r.definitionNameToParam[e.definitionName]=e})),r;function d(t,n){return e.attributes.paramFieldEditor&&(e.attributes.paramFieldEditor[t]||e.attributes.paramFieldEditor[n])}function p(t,n){return e.attributes.paramFieldEditorOptions&&(e.attributes.paramFieldEditorOptions[t]||e.attributes.paramFieldEditorOptions[n])}function h(t,n){return e.attributes.paramShadowOptions&&(e.attributes.paramShadowOptions[t]||e.attributes.paramShadowOptions[n])}},t.hasHandler=function(e){return e.parameters&&e.parameters.some((e=>{var t,n;return"() => void"==e.type||"Action"==e.type||!!(null===(t=e.properties)||void 0===t?void 0:t.length)||!!(null===(n=e.handlerParameters)||void 0===n?void 0:n.length)}))},t.getHelpUrl=function(t){if(t.attributes.help){const e=t.attributes.help.replace(/^\//,"");if(/^github:/.test(e))return e;if("none"!==e)return"/reference/"+e}else if(t.pkg&&!e.appTarget.bundledpkgs[t.pkg]){let e=t.qName.toLowerCase().split(".");return e[0]==t.pkg&&e.shift(),`/pkg/${t.pkg}#${encodeURIComponent(e.join("-"))}`}},t.reporterTypeForArgType=function(e){let t="argument_reporter_custom";return"boolean"!==e&&"number"!==e&&"string"!==e||(t=`argument_reporter_${e}`),/^(?:Array<(?:.+)>)|(?:(?:.+)\[\])$/.test(e)&&(t="argument_reporter_array"),t},t.defaultIconForArgType=function(e=""){switch(e){case"number":return"calculator";case"string":return"text width";case"boolean":return"random";case"Array":return"list";default:return"align justify"}},t.parseFields=function(e){return e.split("|").map(((e,t)=>{let n=/([^%]*)\s*%([a-zA-Z0-9_]+)/.exec(e);if(!n)return{n:e,ni:t};let r=n[1];return r&&(r=r.trim()),{n:e,ni:t,pre:r,p:n[2]}}))},t.blockDefinitions=function(){return r||i(),r},t.getBlockDefinition=function(e){return r||i(),r[e]},t.initInContextTranslationAsync=async function(){r||i();const t={};return await Promise.all(e.Util.values(r).filter((e=>e.block)).map((async n=>{const r=Object.keys(n.block);n.translationIds=e.Util.values(n.block),await Promise.all(r.map((async r=>{const i=await e.crowdin.inContextLoadAsync(n.block[r]);n.block[r]=i,/^[A-Z_]+$/.test(r)&&(t[r]=i)})))}))),t}}(e.blocks||(e.blocks={}))}(pxt||(pxt={})),function(e){!function(t){function n(){return"undefined"!=typeof navigator}function r(){return n()&&/(Win32|Win64|WOW64)/i.test(navigator.platform)}function i(){return n()&&/mobi/i.test(navigator.userAgent)}function s(){return n()&&/Mac/i.test(navigator.platform)}function o(){return!!navigator&&/Linux/i.test(navigator.platform)}function a(){return n()&&/arm/i.test(navigator.platform)}function l(){return n()&&/Edge/i.test(navigator.userAgent)}function c(){return n()&&/Trident/i.test(navigator.userAgent)}function u(){return!l()&&!c()&&!!navigator&&(/Chrome/i.test(navigator.userAgent)||/Chromium/i.test(navigator.userAgent))}function d(){return!u()&&!l()&&!!navigator&&/(Macintosh|Safari|iPod|iPhone|iPad)/i.test(navigator.userAgent)}function p(){return!d()&&!!navigator&&(/Firefox/i.test(navigator.userAgent)||/Seamonkey/i.test(navigator.userAgent))}function h(){return n()&&/Opera|OPR/i.test(navigator.userAgent)}function f(){return n()&&/Midori/i.test(navigator.userAgent)}function m(){return n()&&/Epiphany/i.test(navigator.userAgent)}function _(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&navigator.maxTouchPoints>0)}function g(){return"undefined"!=typeof window&&!!window.pxtElectron}function y(){return"undefined"!=typeof window&&!!window.ipcRenderer}function b(){return g()||y()}function v(t){var n;try{return"undefined"!=typeof window&&/^http:\/\/(localhost|127\.0\.0\.1|192\.168\.\d+\.\d+):\d+\//.test(window.location.href)&&(t||!/nolocalhost=1/.test(window.location.href))&&!(null===(n=null==e?void 0:e.webConfig)||void 0===n?void 0:n.isStatic)}catch(e){return!1}}function T(){return"undefined"!=typeof window&&!!window.PointerEvent}function k(){return r()?"windows":s()?"mac":o()&&a()?"rpi":o()?"linux":"unknown"}function E(){return l()?"edge":m()?"epiphany":f()?"midori":h()?"opera":c()?"ie":u()?"chrome":d()?"safari":p()?"firefox":"unknown"}function x(){if(!n())return null;let e=[];return h()&&(e=/(Opera|OPR)\/([0-9\.]+)/i.exec(navigator.userAgent)),m()?e=/Epiphany\/([0-9\.]+)/i.exec(navigator.userAgent):f()?e=/Midori\/([0-9\.]+)/i.exec(navigator.userAgent):d()?(e=/Version\/([0-9\.]+)/i.exec(navigator.userAgent),e||(e=/(Macintosh|iPod( touch)?|iPhone|iPad); (CPU|Intel).*?OS (X )?(\d+)/i.exec(navigator.userAgent))):e=u()?/(Chrome|Chromium)\/([0-9\.]+)/i.exec(navigator.userAgent):l()?/Edge\/([0-9\.]+)/i.exec(navigator.userAgent):c()?/(MSIE |rv:)([0-9\.]+)/i.exec(navigator.userAgent):/(Firefox|Seamonkey)\/([0-9\.]+)/i.exec(navigator.userAgent),e&&0!=e.length?e[e.length-1]:null}t.isDocumentVisible=function(){return"undefined"!=typeof window&&"visible"===document.visibilityState},t.isIFrame=function(){try{return window&&window.self!==window.top}catch(e){return!0}},t.hasNavigator=n,t.hasWindow=function(){return"undefined"!=typeof window},t.isWindows=r,t.isWindows10=function(){return n()&&/(Win32|Win64|WOW64)/i.test(navigator.platform)&&/Windows NT 10/i.test(navigator.userAgent)},t.isMobile=i,t.isIOS=function(){return n()&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)},t.isAndroid=function(){return n()&&/android/i.test(navigator.userAgent)},t.isMac=s,t.isLinux=o,t.isARM=a,t.isEdge=l,t.isChromiumEdge=function(){return n()&&/Edg\//i.test(navigator.userAgent)},t.isIE=c,t.isChrome=u,t.isSafari=d,t.isFirefox=p,t.isOpera=h,t.isMidori=f,t.isEpiphany=m,t.isTouchEnabled=_,t.isPxtElectron=g,t.isIpcRenderer=y,t.isElectron=b,t.isWinRT=()=>"undefined"!=typeof Windows,t.isLocalHost=v,t.isLocalHostDev=function(){return v()&&!b()},t.isSkillmapEditor=function(){try{return/skill(?:s?)Map=1/.test(window.location.href)}catch(e){return!1}},t.isTabletSize=function(){return(null===window||void 0===window?void 0:window.innerWidth)<=e.BREAKPOINT_TABLET},t.isComputerSize=function(){return(null===window||void 0===window?void 0:window.innerWidth)>e.BREAKPOINT_TABLET},t.noSharedLocalStorage=function(){try{return/nosharedlocalstorage/i.test(window.location.href)}catch(e){return!1}},t.useOldTutorialLayout=function(){var t,n;if(null===(n=null===(t=e.appTarget)||void 0===t?void 0:t.appTheme)||void 0===n?void 0:n.legacyTutorial)return!0;try{return/tutorialview=old/.test(window.location.href)}catch(e){return!1}},t.hasPointerEvents=T,t.os=k,t.browser=E,t.browserVersion=x;let S=!1;function C(){return i()&&d()&&!/downloadWindowOpen=0/i.test(window.location.href)}function I(t,n,r){const s=C(),o=x(),a=parseInt(o||"0");if(s)r?r.location.href=t:window.open(t,"_self");else if(e.BrowserUtils.isSafari()&&(a<10||0==o.indexOf("10.0")||i())){let n=document.getElementById("downloader");n||(e.debug("injecting downloader iframe"),n=document.createElement("iframe"),n.id="downloader",n.style.position="absolute",n.style.right="0",n.style.bottom="0",n.style.zIndex="-1",n.style.width="1px",n.style.height="1px",document.body.appendChild(n)),n.src=t}else if(/^data:/i.test(t)&&(e.BrowserUtils.isEdge()||e.BrowserUtils.isIE())){let r=atob(t.split(",")[1]),i=e.Util.stringToUint8Array(r),s=new Blob([i],{type:"img/png"});window.navigator.msSaveOrOpenBlob(s,n)}else{let e=window.document.createElement("a");"string"==typeof e.download?(e.href=t,e.download=n,document.body.appendChild(e),e.click(),document.body.removeChild(e)):document.location.href=t}}function A(t,n){let r="data";i()&&d()&&e.appTarget.appTheme.mobileSafariDownloadProtocol&&(r=e.appTarget.appTheme.mobileSafariDownloadProtocol);const s=/downloadProtocol=([a-z0-9:/?]+)/i.exec(window.location.href);s&&(r=s[1]);return r+":"+n+";base64,"+t}function w(t,n,r={}){var i;e.debug("trigger download");const{contentType:s="application/octet-stream",userContextWindow:o,onError:a,maintainObjectURL:l}=r,c=null===(i=window.URL)||void 0===i?void 0:i.createObjectURL,u=e.appTarget.appTheme.disableBlobObjectDownload;let d;try{if(c&&!u){const r=c(new Blob([e.Util.stringToUint8Array(atob(t))],{type:s}));I(r,n,o),l?d=r:window.setTimeout((()=>window.URL.revokeObjectURL(d)),0)}else d=A(t,n),I(d,n,o)}catch(t){a&&a(t),e.debug("saving failed")}return d}function N(e){const t=document.createElement("img");return new Promise(((n,r)=>{t.onload=()=>n(t),t.onerror=()=>n(void 0),t.crossOrigin="anonymous",t.src=e}))}t.isBrowserSupported=function(){var t,n;if(!navigator)return!0;if(/bot|crawler|spider|crawling/i.test(navigator.userAgent))return!0;const r=(null===(t=e.appTarget)||void 0===t?void 0:t.unsupportedBrowsers)||(null===(n=window.pxtTargetBundle)||void 0===n?void 0:n.unsupportedBrowsers);if(null==r?void 0:r.some((e=>e.id==E())))return!1;const i=x(),s=parseInt(i||"0"),c=u()&&s>=38,_=p()&&s>=31,g=l(),y=d()&&s>=9,b=h()&&u()&&s>=21;let v=c||_||g||y||b;const T=f()||o()&&a()&&m();return v=v&&!T,v=v||/anybrowser=(true|1)/.test(window.location.href),S||(e.log(`Browser: ${E()} ${i} on ${k()}`),v||e.tickEvent("browser.unsupported",{useragent:navigator.userAgent}),S=!0),v},t.devicePixelRatio=function(){if("undefined"==typeof window||!window.screen)return 1;const e=window.screen.systemXDPI,t=window.screen.logicalXDPI;return void 0!==e&&void 0!==t&&e>t?e/t:window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1},t.browserDownloadBinText=function(e,t,n){return w(ts.pxtc.encodeBase64(e),t,n)},t.browserDownloadText=function(t,n,r){return w(ts.pxtc.encodeBase64(e.Util.toUTF8(t)),n,r)},t.isBrowserDownloadInSameWindow=C,t.isBrowserDownloadWithinUserContext=function(){const e=x(),t=parseInt(e||"0");return i()&&d()&&t>=11||/downloadUserContext=1/i.test(window.location.href)},t.browserDownloadDataUri=I,t.browserDownloadUInt8Array=function(t,n,r){return w(ts.pxtc.encodeBase64(e.Util.uint8ArrayToString(t)),n,r)},t.toDownloadDataUri=A,t.browserDownloadBase64=w,t.loadImageAsync=N,t.loadCanvasAsync=function(e){return N(e).then((e=>{const t=document.createElement("canvas");t.width=e.width,t.height=e.height;return t.getContext("2d").drawImage(e,0,0),t}))},t.scaleImageData=function(e,t){const n=document.createElement("canvas"),r=document.createElement("canvas");n.width=e.width,n.height=e.height,r.width=e.width*t,r.height=e.height*t;const i=n.getContext("2d"),s=r.getContext("2d");return i.putImageData(e,0,0),s.imageSmoothingEnabled=!1,s.scale(t,t),s.drawImage(n,0,0),s.getImageData(0,0,e.width*t,e.height*t)},t.imageDataToPNG=function(e,t=1){if(!e)return;const n=document.createElement("canvas"),r=document.createElement("canvas");n.width=e.width,n.height=e.height,r.width=e.width*t,r.height=e.height*t;const i=n.getContext("2d"),s=r.getContext("2d");return i.putImageData(e,0,0),s.imageSmoothingEnabled=!1,s.scale(t,t),s.drawImage(n,0,0),r.toDataURL("image/png")};const D=1e6;function O(t){if(/^https?:\/\//i.test(t))return t;const n=(window.MonacoPaths||{})[t];return n||(e.U.startsWith(t,e.webConfig.commitCdnUrl)?t:e.webConfig.commitCdnUrl+t)}t.encodeToPngAsync=function(t,n){const{width:r,height:i,pixelDensity:s=4,maxSize:o=D,text:a}=n||{};return new Promise(((n,l)=>{const c=new Image;c.onload=function(){const t=document.createElement("canvas"),l=t.getContext("2d");t.width=(r||c.width)*s,t.height=(i||c.height)*s,a&&(l.fillStyle="#fff",l.fillRect(0,0,t.width,t.height)),l.drawImage(c,0,0,r,i,0,0,t.width,t.height);let u=t.toDataURL("image/png");for(;u.length>o;)t.width=t.width/2>>0,t.height=t.height/2>>0,e.debug(`screenshot size ${u.length}b, shrinking to ${t.width}x${t.height}`),l.drawImage(c,0,0,r,i,0,0,t.width,t.height),u=t.toDataURL("image/png");if(a){e.lzmaCompressAsync(a).then((r=>{const i=e.Util.encodeBlobAsync(t,r);n(i.toDataURL("image/png"))}))}else n(u)},c.onerror=t=>{e.reportError("png","png rendering failed"),n(void 0)},c.src=t}))},t.resolveCdnUrl=O,t.loadStyleAsync=function(t,n){n&&(t="rtl"+t);const r="style-"+t;if(document.getElementById(r))return Promise.resolve();const i=O(t),s=e.Util.toArray(document.head.getElementsByTagName("link")).filter((e=>e.getAttribute("href")==i))[0];return s?(s.id||(s.id=r),Promise.resolve()):new Promise(((e,t)=>{const n=document.createElement("link");n.href=i,n.rel="stylesheet",n.type="text/css",n.id=r,n.addEventListener("load",(()=>e())),n.addEventListener("error",(e=>t(e))),document.head.appendChild(n)}))};let R,L,P,M={};function F(e,t){if(!e)return t;if(!t)return e;return(e.indexOf("/")==e.length-1?e.substring(0,e.length-1):e)+"/"+(0==t.indexOf("/")?t.substring(1):t)}function $(){const e=n()&&window.navigator;return e&&e.storage&&e.storage.estimate?e.storage.estimate():Promise.resolve({})}t.loadScriptAsync=function(t){const n=O(t);let r=M[n];return r||(r=M[n]=new Promise(((t,r)=>{e.debug(`script: loading ${n}`);const i=document.createElement("script");i.type="text/javascript",i.addEventListener("load",(()=>t())),i.addEventListener("error",(e=>{delete M[n],r(e)})),i.src=n,i.async=!0,document.body.appendChild(i)}))),r},t.loadAjaxAsync=function(e){return new Promise(((t,n)=>{let r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,!0),r.send()}))},t.loadBlocklyAsync=function(){if(!R){e.debug("blockly: delay load");let t=e.BrowserUtils.loadStyleAsync("blockly.css",ts.pxtc.Util.isUserLanguageRtl());t=t.then((()=>{e.debug("blockly: loaded")})),R=t}return R},t.patchCdn=function(t){if(!t)return t;const n=e.getOnlineCdnUrl();return n?t.replace("@cdnUrl@",n):t.replace(/@cdnUrl@\/(blob|commit)\/[a-f0-9]{40}\//,"./")},t.initTheme=function(){const t=e.appTarget.appTheme;if(t&&t.accentColor){let e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(`.ui.accent { color: ${t.accentColor}; }\n                .ui.inverted.menu .accent.active.item, .ui.inverted.accent.menu  { background-color: ${t.accentColor}; }`)),document.getElementsByTagName("head")[0].appendChild(e)}if(e.Util.isUserLanguageRtl()){e.debug("rtl layout"),e.BrowserUtils.addClass(document.body,"rtl"),document.body.style.direction="rtl";const t=e.Util.toArray(document.head.getElementsByTagName("link")),n=t.filter((t=>e.Util.endsWith(t.getAttribute("href"),"semantic.css")))[0];if(n){const t=n.getAttribute("data-rtl");t&&(e.debug(`swapping to ${t}`),n.setAttribute("href",t))}const r=t.filter((t=>e.Util.endsWith(t.getAttribute("href"),"blockly.css")))[0];if(r){const t=r.getAttribute("data-rtl");t&&(e.debug(`swapping to ${t}`),r.setAttribute("href",t),r.removeAttribute("data-rtl"))}}},t.changeHash=function(e,t){"#"!=e.charAt(0)&&(e="#"+e),t?window.location.hash=e:window.history.replaceState("","",e)},t.urlJoin=F,t.joinURLs=function(...e){let t;if(e)for(let n=0;n<e.length;n++)t=F(t,e[n]);return t},t.storageEstimateAsync=$,t.scheduleStorageCleanup=n()&&navigator.storage&&navigator.storage.estimate?ts.pxtc.Util.throttle((function(){$().then((t=>(e.debug(`storage estimate: ${t.usage/t.quota*100>>0}%, ${t.usage/1e6>>0}/${t.quota/1e6>>0}Mb`),t.quota&&t.usage&&t.quota>1e6&&t.usage/t.quota>.9?(e.log("quota usage exceeded, clearing translations"),e.tickEvent("storage.cleanup"),j()):Promise.resolve()))).catch((t=>{e.reportException(t)}))}),1e4,!1):()=>{},t.stressTranslationsAsync=function t(){let n="...";for(let e=0;e<16;++e)n+=n+Math.random();return console.log(`adding entry ${2*n.length} bytes`),e.U.delay(1).then((()=>G())).then((e=>e.setAsync("foobar",Math.random().toString(),null,void 0,n))).then((()=>e.BrowserUtils.storageEstimateAsync())).then((e=>!e.quota||e.usage/e.quota<.8?t():Promise.resolve()))};class B{constructor(){this.translations={}}key(e,t){return`${e}|${t}|master`}get(e,t){return this.translations[this.key(e,t)]}getAsync(e,t){return Promise.resolve(this.get(e,t))}set(e,t,n,r,i,s){this.translations[this.key(e,t)]={etag:n,time:r,strings:i,md:s}}setAsync(t,n,r,i,s){return this.set(t,n,r,e.Util.now(),i),Promise.resolve()}clearAsync(){return this.translations={},Promise.resolve()}}class U{constructor(e,t,n,r,i=!1){this.name=e,this.version=t,this.upgradeHandler=n,this.quotaExceededHandler=r,this.skipErrorLog=i}throwIfNotOpened(){if(!this._db)throw new Error("Database not opened; call IDBWrapper.openAsync() first")}errorHandler(t,n,r){this.skipErrorLog?r(t):(console.error(new Error(`${this.name} IDBWrapper error for ${n}: ${t.message}`)),r(t),"QuotaExceededError"==t.name&&(e.log("storage quota exceeded..."),e.tickEvent("storage.quotaexceedederror"),this.quotaExceededHandler&&this.quotaExceededHandler()))}getObjectStore(e,t="readonly"){this.throwIfNotOpened();return this._db.transaction([e],t).objectStore(e)}static deleteDatabaseAsync(e){return new Promise(((t,n)=>{const r=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).deleteDatabase(e);r.onsuccess=()=>t(),r.onerror=()=>n(r.error)}))}openAsync(){return new Promise(((e,t)=>{const n=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(this.name,this.version);n.onsuccess=()=>{this._db=n.result,e()},n.onerror=()=>this.errorHandler(n.error,"open",t),n.onupgradeneeded=e=>this.upgradeHandler(e,n)}))}getAsync(e,t){return new Promise(((n,r)=>{const i=this.getObjectStore(e).get(t);i.onsuccess=()=>n(i.result),i.onerror=()=>this.errorHandler(i.error,"get",r)}))}getAllAsync(e){return new Promise(((t,n)=>{const r=this.getObjectStore(e).openCursor(),i=[];r.onsuccess=()=>{r.result?(i.push(r.result.value),r.result.continue()):t(i)},r.onerror=()=>this.errorHandler(r.error,"getAll",n)}))}setAsync(e,t){return new Promise(((n,r)=>{const i=this.getObjectStore(e,"readwrite");let s;s=void 0!==t.id&&null!==t.id?i.put(t):i.add(t),s.onsuccess=()=>n(),s.onerror=()=>this.errorHandler(s.error,"set",r)}))}deleteAsync(e,t){return new Promise(((n,r)=>{const i=this.getObjectStore(e,"readwrite").delete(t);i.onsuccess=()=>n(),i.onerror=()=>this.errorHandler(i.error,"delete",r)}))}deleteAllAsync(e){return new Promise(((t,n)=>{const r=this.getObjectStore(e,"readwrite").clear();r.onsuccess=()=>t(),r.onerror=()=>this.errorHandler(r.error,"deleteAll",n)}))}getObjectStoreWrapper(e){return new V(this,e)}}t.IDBWrapper=U;class V{constructor(e,t){this.db=e,this.storeName=t}getAsync(e){return this.db.getAsync(this.storeName,e)}getAllAsync(){return this.db.getAllAsync(this.storeName)}setAsync(e){return this.db.setAsync(this.storeName,e)}async deleteAsync(e){await this.db.deleteAsync(this.storeName,e)}async deleteAllAsync(){await this.db.deleteAllAsync(this.storeName)}}t.IDBObjectStoreWrapper=V;class H{constructor(e){this.db=e,this.mem=new B}static dbName(){return`__pxt_translations_${e.appTarget.id||""}`}static createAsync(){function e(){const e=new U(H.dbName(),2,((e,t)=>{t.result.createObjectStore(H.TABLE,{keyPath:H.KEYPATH})}),(()=>{j().catch((e=>{}))}));return e.openAsync().then((()=>new H(e)))}return e().catch((t=>(console.log("db: failed to open database, try delete entire store..."),U.deleteDatabaseAsync(H.dbName()).then((()=>e())))))}getAsync(e,t){e=(e||"en-US").toLowerCase();const n=this.mem.key(e,t),r=this.mem.get(e,t);return r?Promise.resolve(r):this.db.getAsync(H.TABLE,n).then((n=>n?(this.mem.set(e,t,n.etag,n.time,n.strings),Promise.resolve(n)):Promise.resolve(void 0))).catch((e=>Promise.resolve(void 0)))}setAsync(n,r,i,s,o){n=(n||"en-US").toLowerCase();const a=this.mem.key(n,r);let l=e.Util.now();this.mem.set(n,r,i,l,s,o),s&&Object.keys(s).filter((e=>!s[e])).forEach((e=>delete s[e]));const c={id:a,etag:i,time:l,strings:s,md:o};return this.db.setAsync(H.TABLE,c).finally((()=>t.scheduleStorageCleanup())).catch((e=>(console.log(`db: set failed (${e.message}), recycling...`),this.clearAsync())))}clearAsync(){return this.db.deleteAllAsync(H.TABLE).then((()=>console.debug("db: all clean"))).catch((e=>{console.error("db: failed to delete all")}))}}function G(){return e.Util.isNodeJS?Promise.resolve(new B):(L||(L=H.createAsync().catch((()=>new B))),L)}function j(){function t(){const t=H.dbName();return U.deleteDatabaseAsync(t).then((()=>{L=void 0})).catch((n=>{e.log(`db: failed to delete ${t}`),L=void 0}))}return L?L.then((e=>e.clearAsync())).catch((e=>t().then())):t()}function K(t){const n=JSON.stringify(t)+e.appTarget.versions.pxt+"_"+e.appTarget.versions.target;return pxtc.U.sha256(n)}function W(e,t){return`${e}|${t||"master"}`}H.TABLE="files",H.KEYPATH="id",t.translationDbAsync=G,t.clearTranslationDbAsync=j,t.getTutorialCodeHash=K;class z{constructor(e){this.db=e}static dbName(){return`__pxt_tutorialinfo_${e.appTarget.id||""}`}static createAsync(){function t(){const t=new e.BrowserUtils.IDBWrapper(z.dbName(),2,((e,t)=>{t.result.createObjectStore(z.TABLE,{keyPath:z.KEYPATH})}),(()=>{e.BrowserUtils.IDBWrapper.deleteDatabaseAsync(z.dbName())}));return t.openAsync().then((()=>new z(t)))}return t().catch((n=>(console.log("db: failed to open tutorial info database, try delete entire store..."),e.BrowserUtils.IDBWrapper.deleteDatabaseAsync(z.dbName()).then((()=>t())))))}getAsync(t,n,r){const i=W(t,r),s=K(n);return this.db.getAsync(z.TABLE,i).then((t=>{if(t&&t.hash==s&&e.Util.now()-(t.time||0)<864e5)return t;this.db.deleteAsync(z.TABLE,i)}))}setAsync(t,n,r,i,s,o){e.perf.measureStart("tutorial info db setAsync");W(t,o);const a=K(r);return this.setWithHashAsync(t,n,a,i,s)}setWithHashAsync(t,n,r,i,s,o){e.perf.measureStart("tutorial info db setAsync");const a=W(t,o),l={};Object.keys(n).forEach((e=>{Object.keys(n[e]).forEach((t=>{l[t]=n[e][t]}))}));const c={id:a,time:e.Util.now(),hash:r,snippets:n,blocks:l,highlightBlocks:i,validateBlocks:s};return this.db.setAsync(z.TABLE,c).then((()=>{e.perf.measureEnd("tutorial info db setAsync")}))}clearAsync(){return this.db.deleteAllAsync(z.TABLE).then((()=>console.debug("db: all clean"))).catch((e=>{console.error("db: failed to delete all")}))}}function q(e){return e.split(/\s+/).filter((e=>!!e))}function J(){const t=new RegExp(`${e.Util.escapeForRegex(e.Util.pxtLangCookieId)}=(.*?)(?:;|$)`).exec(document.cookie);return t&&t[1]||null}z.TABLE="info",z.KEYPATH="id",t.tutorialInfoDbAsync=function(){return P||(P=z.createAsync()),P},t.clearTutorialInfoDbAsync=function(){function t(){const t=z.dbName();return U.deleteDatabaseAsync(t).then((()=>{P=void 0})).catch((n=>{e.log(`db: failed to delete ${t}`),P=void 0}))}return P?P.then((e=>e.clearAsync())).catch((e=>t().then())):t()},t.pointerEvents=T()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:_()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"},t.getPageX=function(e){return"pageX"in e?e.pageX:e.changedTouches[0].pageX},t.getPageY=function(e){return"pageY"in e?e.pageY:e.changedTouches[0].pageY},t.getClientX=function(e){return"clientX"in e?e.clientX:e.changedTouches[0].clientX},t.getClientY=function(e){return"clientY"in e?e.clientY:e.changedTouches[0].clientY},t.popupWindow=function(t,n,r,i){try{const s=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c="width="+r+", height="+i+", top="+(l/2-i/2+o)+", left="+(a/2-r/2+s),u=window.open(t,n,e.BrowserUtils.isIpcRenderer()?void 0:c);return u.focus&&u.focus(),u}catch(t){return e.tickEvent("pxt.popupError",{msg:t.message}),null}},t.containsClass=function(e,t){return q(t).every((t=>function(e,t){if(e.classList)return e.classList.contains(t);return!((e.className+"").split(/\s+/).indexOf(t)<0)}(e,t)))},t.addClass=function(e,t){q(t).forEach((t=>function(e,t){if(e.classList)e.classList.add(t);else{(e.className+"").split(/\s+/).indexOf(t)<0&&(e.className.baseVal+=" "+t)}}(e,t)))},t.removeClass=function(e,t){q(t).forEach((t=>function(e,t){e.classList?e.classList.remove(t):e.className.baseVal=(e.className+"").split(/\s+/).filter((e=>e!=t)).join(" ")}(e,t)))},t.getCookieLang=J,t.setCookieLang=function(t,n=!1){if(e.Util.allLanguages[t]&&t!==J()){e.tickEvent("menu.lang.setcookielang",{lang:t,docs:`${n}`});const r=new Date;r.setTime(r.getTime()+24*e.Util.langCookieExpirationDays*60*60*1e3),document.cookie=`${e.Util.pxtLangCookieId}=${t}; expires=${r.toUTCString()}; path=/`}},t.cacheBustingUrl=function(e){return e?/[?&]rnd=/.test(e)?e:`${e}${e.indexOf("?")>0?"&":"?"}rnd=${Math.random()}`:e},t.legacyCopyText=function(t){t.focus(),t.setSelectionRange(0,9999);try{const t=document.execCommand("copy");return e.debug("copy: "+t),!!t}catch(e){return!1}},t.setApplicationTheme=function(e){const t=document.body,n=t.classList;for(let e=0;e<n.length;e++)/^theme-/.test(n[e])&&t.classList.remove(n[e]);e&&t.classList.add(`theme-${e}`)}}(e.BrowserUtils||(e.BrowserUtils={}))}(pxt||(pxt={})),function(e){!function(e){const t="https://staging.pxt.io";e.DEV_BACKEND=t,e.devBackendType=function(){return"https://makecode.com"===e.DEV_BACKEND?"prod":e.DEV_BACKEND===t?"staging":"http://localhost:8080"===e.DEV_BACKEND?"localhost":"prod"},e.cloudStatus={none:{value:"none"},synced:{value:"synced",icon:"cloud-saved-b",tooltip:lf("Project saved to cloud"),shortStatus:lf("saved"),longStatus:lf("Saved to cloud"),indicator:""},justSynced:{value:"justSynced",icon:"cloud-saved-b",tooltip:lf("Project saved to cloud"),shortStatus:lf("saved!"),longStatus:lf("Saved to cloud!"),indicator:""},offline:{value:"offline",icon:"cloud-error-b",tooltip:lf("Unable to connect to cloud"),shortStatus:lf("offline"),longStatus:lf("Offline"),indicator:lf("offline")},syncing:{value:"syncing",icon:"cloud-saving-b",tooltip:lf("Saving project to cloud..."),shortStatus:lf("saving..."),longStatus:lf("Saving to cloud..."),indicator:lf("syncing...")},conflict:{value:"conflict",icon:"cloud-error-b",tooltip:lf("Project was edited in two places and the changes conflict"),shortStatus:lf("conflict!"),longStatus:lf("Project has a conflict!"),indicator:"!"},localEdits:{value:"localEdits",icon:"cloud-saving-b",tooltip:lf("Project has local changes and will save to cloud soon."),shortStatus:"",longStatus:"",indicator:"*"}}}(e.cloud||(e.cloud={}))}(pxt||(pxt={})),function(e){!function(e){let t;!function(e){e[e.Failed=0]="Failed",e[e.Success=1]="Success",e[e.UserRejected=2]="UserRejected"}(t=e.WebUSBPairResult||(e.WebUSBPairResult={})),e.deployCoreAsync=void 0,e.deployFallbackAsync=void 0,e.hasDeployFn=()=>e.deployCoreAsync||e.deployFallbackAsync,e.deployAsync=(t,n)=>(e.deployCoreAsync||e.deployFallbackAsync)(t,n),e.patchCompileResultAsync=void 0,e.browserDownloadAsync=void 0,e.saveOnlyAsync=void 0,e.renderBrowserDownloadInstructions=void 0,e.renderUsbPairDialog=void 0,e.renderIncompatibleHardwareDialog=void 0,e.showUploadInstructionsAsync=void 0,e.saveProjectAsync=void 0,e.electronDeployAsync=void 0,e.webUsbPairDialogAsync=void 0,e.onTutorialCompleted=void 0,e.workspaceLoadedAsync=void 0}(e.commands||(e.commands={}))}(pxt||(pxt={})),function(e){function t(){let t;return t||(t=e.U.isNodeJS?Promise.resolve(require("lzma")):Promise.resolve(window.LZMA),t.then((t=>(t||e.reportError("lzma","failed to load"),t)))),t}e.lzmaDecompressAsync=function(n){return t().then((t=>new Promise(((r,i)=>{try{t.decompress(n,((t,n)=>{n&&e.debug("lzma decompression failed"),r(n?void 0:t)}))}catch(t){t&&e.debug("lzma decompression failed"),r(void 0)}}))))},e.lzmaCompressAsync=function(n){return t().then((t=>new Promise(((r,i)=>{try{t.compress(n,7,((t,n)=>{n&&e.reportException(n),r(n?void 0:new Uint8Array(t))}))}catch(t){e.reportException(t),r(void 0)}}))))}}(pxt||(pxt={})),function(e){!function(t){var n=pxtc.Util;let r=n.lf;const i={"pxt::mkAction":1,"pxt::dumpPerfCounters":1,"pxt::deepSleep":1,"pxt::getConfig":1,"pxtrt::mkMap":1,"pxtrt::mapSet":1,"pxtrt::stclo":1,"pxtrt::mklocRef":1,"pxtrt::stlocRef":1,"pxtrt::ldlocRef":1,"pxtrt::panic":1};function s(e="namespace"){let t="",n="",r=(r,i="")=>{n!=r&&(n&&(t+="}\n"),r&&(t+=i||e+" "+r+" {\n"),n=r)},i="    ";return{setNs:r,clear:()=>{t="",n=""},write:e=>{e.trim()?(e=e.trim().replace(/^\s*/gm,i).replace(/^(\s*)\*/gm,((e,t)=>t+" *")),t+=e+"\n"):t+="\n"},incrIndent:()=>{i+="    "},decrIndent:()=>{i=i.slice(4)},finish:()=>(r(""),t)}}function o(e){if(!e)return null;e=e.trim();let t=/^\((.*)\)/.exec(e);return t&&(e=t[1]),/^-?(\d+|0[xX][0-9a-fA-F]+)$/.test(e)?parseInt(e):null}t.nsWriter=s,t.parseCppInt=o;let a={};class l extends Error{constructor(e){super(e),this.isUserError=!0,this.message=e}}function c(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){let r=255&e[n];t+=37==r||r>127?"%"+r.toString(16):String.fromCharCode(r)}return decodeURIComponent(t)}function u(t){let n="",r=0;for(;r<t.length;r+=2)n=t[r]+t[r+1]+n;return e.Util.assert(r==t.length),n}function d(e){let t=[65,20,14,47,184,47,162,187];e:for(let n=0;n<e.length;n+=16){if(e[n]!=t[0])continue;for(let r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;let r=e[n+8]|e[n+9]<<8,i=e[n+10]|e[n+11]<<8|e[n+12]<<16|e[n+13]<<24;n+=16;let s=n+r+i;if(s>e.length)continue;let o=e.slice(n,n+r),a=e.slice(n+r,s);return{meta:c(o),text:a}}return null}function p(t){function n(t){return e.debug(t),Promise.reject(new Error(t))}let r;if(e.HF2.read32(t,0)==ts.pxtc.UF2.UF2_MAGIC_START0){let e=ts.pxtc.UF2.toBin(t);e&&(r=d(e.buf))}if(1179403647==e.HF2.read32(t,0)&&(r=d(t)),58==t[0]){r=function(e){if(!e)return;let t,n=0,r=0,i=0,s=0;if(e.split(/\r?\n/).forEach((e=>{let o=/^:10....0[0E]41140E2FB82FA2BB(....)(....)(....)(....)(..)/.exec(e);if(o)n=parseInt(u(o[1]),16),r=parseInt(u(o[2]),16),i=n+r,t=new Uint8Array(i);else if(i>0){if(o=/^:10....0[0E](.*)(..)$/.exec(e),!o)return;let n=o[1];for(;i>0&&n.length>0;)t[s++]=parseInt(n[0]+n[1],16),n=n.slice(2),i--}})),!t||0!=i||s!=t.length)return;let o=new Uint8Array(n),a=new Uint8Array(r);for(let e=0;e<n;++e)o[e]=t[e];for(let e=0;e<r;++e)a[e]=t[n+e];return{meta:c(o),text:a}}(c(t)||"")}if(!r||!r.meta||!r.text)return n("This .hex file doesn't contain source.");let i=JSON.parse(r.meta);return i?"LZMA"==i.compression?e.lzmaDecompressAsync(r.text).then((t=>{if(!t)return null;let n=t.slice(0,i.headerSize||i.metaSize||0),r=t.slice(n.length);return n&&e.Util.jsonCopyFrom(i,JSON.parse(n)),{meta:i,source:r}})):i.compression?n(`Compression type ${i.compression} not supported.`):Promise.resolve({source:c(r.text)}):n("This .hex file is not valid.")}t.PkgConflictError=l,t.getExtensionInfo=function(t){const c={__appVariant:e.appTargetVariant||""},u="dal.d.ts";let d="/source/",p="",h=[];const f=t.sortedDeps(!0).sort(((e,t)=>"this"==e.id?1:"this"==t.id?-1:n.strcmp(e.id,t.id)));for(let t of f)t.disablesVariant(e.appTargetVariant)||t.resolvedDependencies().some((t=>t.disablesVariant(e.appTargetVariant)))?(p&&(p+=", "),p+=t.id,e.debug(`disable variant ${e.appTargetVariant} due to ${t.id}`)):(h.push(t),t.addSnapshot(c,[u,".h",".cpp"]));const m=JSON.stringify(c),_=a[m];if(_){e.debug("Using cached extinfo");const t=n.flatClone(_);return t.disabledDeps=p,t}e.debug("Generating new extinfo");const g=pxtc.emptyExtInfo();g.disabledDeps=p;let y=e.appTarget.compileService;y||(y={gittag:"none",serviceId:"nocompile"}),y=n.clone(y);let b=t.getTargetOptions();b||(b={isNative:!1,hasHex:!1,switches:{}});const v=!!y.platformioIni,T="codal"==y.buildEngine||"dockercodal"==y.buildEngine,k="dockermake"==y.buildEngine||"dockercross"==y.buildEngine,E="dockerespidf"==y.buildEngine,x=!(v||T||k||E),S=b.nativeType==pxtc.NATIVE_TYPE_VM;v?d="/src/":T||k?d="/pxtapp/":E&&(d="/main/");let C="// Configuration defines\n",I="\nPXT_SHIMS_BEGIN\n",A="",w="",N='#include "pxt.h"\n',D="",O=e=>D+=`   ${L}(${R}): ${e}\n`,R=0,L="",P=s("namespace"),M=s("declare namespace"),F=s("declare namespace"),$="",B={},U={};const V={true:"1",false:"0",null:"0",NULL:"0"};function H(e){return e.trim().replace(/[\_\*]$/,"")}for(const t of h){if(t.getFiles().indexOf(u)>=0){const n=t.host().readFile(t,u);e.Util.assert(!!n,`dal.d.ts not found in ${t.id}`),n.split(/\r?\n/).forEach((e=>{let t=/^\s*(\w+) = (.*),/.exec(e);t&&(V[t[1]]=t[2])}))}for(const e of t.getFiles())(["Makefile","sdkconfig.defaults","CMakeLists.txt"].indexOf(e)>=0||n.endsWith(e,".mk"))&&(g.generatedFiles["/"+e]=t.host().readFile(t,e))}let G=["0","false","PXT_UTF8"],j={};function K(e){return e.replace(/\/\/.*/,"").replace(/\/\*/,"")}b.switches.boxDebug&&(j.PXT_BOX_DEBUG=1),b.utf8&&(j.PXT_UTF8=1),b.switches.profile&&(j.PXT_PROFILE=1),b.switches.gcDebug&&(j.PXT_GC_DEBUG=1),b.switches.numFloat&&(j.PXT_USE_FLOAT=1),b.nativeType==pxtc.NATIVE_TYPE_VM&&(j.PXT_VM=1);let W=0,z=!1,q="",J="",Y="",X=!1;function Q(){M.setNs(""),M.write(""),M.write(""),(Y||J)&&(M.write(J),M.write(Y),Y="",J="")}function Z(e,t){let s;q="",J="",Y="",X=!1;let a=-1;function l(){let e=q.replace(/Methods$/,"");return e==q?null:e}function c(e){switch(e.replace(/\s+/g,"")){case"void":return"void";case"int32_t":case"int":return"int32";case"uint32_t":case"unsigned":return"uint32";case"TNumber":case"float":case"double":return"number";case"uint16_t":return"uint16";case"int16_t":case"short":return"int16";case"uint8_t":case"byte":return"uint8";case"int8_t":case"sbyte":return"int8";case"bool":return b.shortPointers&&O("use 'boolean' not 'bool' on 8 bit targets"),"boolean";case"StringData*":case"String":case"ImageLiteral_":case"ImageLiteral":return"string";case"Action":return"() => void";case"TValue":return"any";default:return H(e)}}function u(e){switch(e=e.replace(/\s+/g,"")){case"int32_t":case"uint32_t":case"unsigned":case"uint16_t":case"int16_t":case"short":case"uint8_t":case"byte":case"int8_t":case"sbyte":case"int":case"ramint_t":return"I";case"void":return"V";case"float":return"F";case"TNumber":return"N";case"TValue":return"T";case"bool":return"B";case"double":return"D";case"ImageLiteral_":return"T";case"String":return"S";default:return n.lookup(B,e)?"I":"_"+e.replace(/[\*_]+$/,"")}}e=e.replace(/^(\s*#\s*if\s+(\w+)\s*$)([^]*?)(^\s*#\s*(elif|else|endif)\s*$)/gm,((e,t,n,r,i)=>G.indexOf(n)>=0&&!j[n]?t+r.replace(/[^\n]/g,"")+i:e)),R=0,z=!1,W=0,F.setNs(""),M.setNs(""),e.split(/\r?\n/).forEach((e=>{++R;let d=K(e);!function(e){let t=K(e);if(z&&t.indexOf("}")>=0&&(z=!1,F.write("}")),!z)return;let r=/^\s*(\w+)\s*(=\s*(.*?))?,?\s*$/.exec(t);if(r){let e=r[1],i=r[3],s="";if(i){i=i.trim();let e=n.lookup(V,i);null!=e&&(s="  // "+i,i=e),W=o(i),null==W&&O("cannot determine value of "+t)}else W++,i=W+"";F.write(`    ${H(e)} = ${i},${s}`)}else F.write(e)}(e);let p=/^\s*enum\s+(|class\s+|struct\s+)(\w+)\s*({|$)/.exec(d);var h,f;if(p&&(h=p[2],f=p[3],z=!0,W=-1,F.write(""),F.write(""),(Y||J)&&(F.write(J),F.write(Y),Y="",J=""),F.write(`declare const enum ${H(h)} ${f}`),B[h]=!0,t||(P.setNs(q),P.write(`enum ${p[2]} : int;`))),function(e){return!(!z&&(/^\s*\/\*\*/.test(e)?(X=!0,J=e+"\n",/\*\//.test(e)&&(X=!1),0):X?(J+=e+"\n",/\*\//.test(e)&&(X=!1),0):!/^\s*\/\/%/.test(e)||(Y+=e+"\n",0)))}(e))return;/^typedef.*;\s*$/.test(e)&&(P.setNs(q),P.write(e));let m=/^\s*namespace\s+(\w+)/.exec(e);if(m)if(q=m[1],l()){Q();let e=l();M.setNs(q,`declare interface ${e} {`)}else(Y||J)&&(Q(),M.setNs(H(q)),F.setNs(H(q)));else{if(m=/^PXT_ABI\((\w+)\)/.exec(e),m&&!S&&(I+=`PXT_FNPTR(::${m[1]}),\n`,w+=`extern "C" void ${m[1]}();\n`,g.functions.push({name:m[1],argsFmt:[],value:0})),m=/^\s*PXT_EXPORT\(([:\&\w]+)\)/.exec(e),m&&(g.vmPointers||(g.vmPointers=[]),g.vmPointers.push(m[1])),m=/^#define\s+PXT_COMM_BASE\s+([0-9a-fx]+)/.exec(e),m&&(g.commBase=parseInt(m[1])),m=/^\s*(\w+)([\*\&]*\s+[\*\&]*)(\w+)\s*\(([^\(\)]*)\)\s*(;\s*$|\{|$)/.exec(e),!Y||!m){if(m=/^\s*extern const (\w+) (\w+);/.exec(e),Y&&m){let e={name:q+"::"+m[2],argsFmt:[],value:null};return g.functions.push(e),S||(I+="PXT_FNPTR(&::"+e.name+"),\n"),void(Y="")}if(m=/^\s*(\w+)\s+(\w+)\s*;/.exec(e),Y&&m){let e=pxtc.parseCommentString(Y);e.indexedInstanceNS&&(s=e,M.setNs(e.indexedInstanceNS),a=0);let t=m[1],n=m[2];if(s)return Y=Y.trim(),Y+=` fixedInstance shim=${s.indexedInstanceShim}(${a++})`,M.write(""),M.write(J),M.write(Y),M.write(`const ${n}: ${c(t)};`),J="",void(Y="")}return Y&&e.trim()?(O("declaration not understood: "+e),Y="",void(J="")):void 0}{s=null;let e=pxtc.parseCommentString(Y);q||O("missing namespace declaration");let a=(m[1]+m[2]).replace(/\s+/g,""),d=m[3],p=m[4];Y=Y.trim().replace(/ \w+\.defl=\w+/g,"");let h=[u(a)],f=[],_=p.split(/,/).filter((e=>!!e)).map((t=>{let r=function(e,t){t=t.trim();let r=/(.*)=\s*(-?\w+)$/.exec(t),i="",s="";if(r&&(i=r[2],s="?",t=r[1].trim()),r=/^(.*?)(\w+)$/.exec(t),!r)return O("invalid argument: "+t),{name:"???",type:"int"};let a=r[2];e.paramDefl[a]&&(i=e.paramDefl[a],s="?");let l=i?n.lookup(V,i):null;return null!=l&&(i=l),i&&(null==o(i)&&O("Invalid default value (non-integer): "+i),Y+=` ${a}.defl=${i}`),{name:a+s,type:r[1]}}(e,t);return h.push(u(r.type)),f.push(r.type.replace(/ /g,"")),`${r.name}: ${c(r.type)}`})),y={name:q+"::"+d,argsFmt:h,value:null};if(J)if(M.setNs(H(q)),M.write(""),M.write(J),/ImageLiteral/.test(m[4])&&!/imageLiteral=/.test(Y)&&(Y+=" imageLiteral=1"),Y+=` shim=${y.name}`,M.write(Y),d=H(d),l()){let e=(_[0]||"").replace(/^.*:\s*/,"").trim();e.toLowerCase()!=l().toLowerCase()&&O(r("Invalid first argument; should be of type '{0}', but is '{1}'",l(),e)),_.shift(),0==_.length&&/\bproperty\b/.test(Y)?M.write(`${d}: ${c(a)};`):M.write(`${d}(${_.join(", ")}): ${c(a)};`)}else M.write(`function ${d}(${_.join(", ")}): ${c(a)};`);if(J="",Y="",t||(P.setNs(q),P.write(`${a} ${d}(${p});`)),g.functions.push(y),x)I+="(uint32_t)(void*)::"+y.name+",\n";else if(S){if(n.startsWith(y.name,"pxt::op_")||i[y.name]||e.expose||!n.startsWith(y.name,"pxt::")&&!n.startsWith(y.name,"pxtrt::")){const e=function(e,t){if("FiberContext*"==t[0])return"::"+e.name;let n="_wrp_"+e.name.replace(/:/g,"_");if(U[e.name])return n;U[e.name]=!0,A+=`\nvoid ${n}(FiberContext *ctx) {\n`;const r=t.length;let i=[],s=!1,o="";for(let n=0;n<r;++n){const a=e.argsFmt[n+1],l=t[n];let c="I"==a?"toInt":"B"==a?"numops::toBool":"";const u=n==r-1?"ctx->r0":`ctx->sp[${r-n-2}]`;let d="";switch(l){case"TValue":case"TNumber":break;case"Action":c="asRefAction";break;case"String":c="convertToString",d="ctx, ",s=!0;break;default:c||(c="as"+l.replace(/\*/g,""))}o+=`  ${l} a${n} = (${l}) ${c}(${d}${u});\n`,i.push("a"+n)}s&&(A+="  auto prevSP = ctx->sp;\n"),A+=o,s&&(A+="  if (panicCode) { ctx->sp = prevSP; return; }\n");const a=`::${e.name}(${i.join(", ")})`;return"V"==e.argsFmt[0]?(A+=`  ${a};\n`,A+="  ctx->r0 = NULL;\n"):"I"==e.argsFmt[0]?A+=`  ctx->r0 = fromInt(${a});\n`:"B"==e.argsFmt[0]?A+=`  ctx->r0 = fromBool(${a});\n`:A+=`  ctx->r0 = (TValue)${a};\n`,s&&(A+="  ctx->sp = prevSP;\n"),r>1&&(A+=`  ctx->sp += ${r-1};\n`),A+="}\n",n}(y,f),t=y.argsFmt.length-1;I+=`{ "${y.name}", (OpFun)(void*)${e}, ${t} },\n`}}else I+="PXT_FNPTR(::"+y.name+"),\n"}}}))}const ee=n.clone(y.yottaConfig||{}),te={},ne={},re={};function ie(t){const i=t.config.platformio;i&&i.dependencies&&n.jsonCopyFrom(g.platformio.dependencies,i.dependencies),g.npmDependencies&&t.config.npmDependencies&&n.jsonCopyFrom(g.npmDependencies,t.config.npmDependencies);const s=t.config.codal;if(T&&s)for(const t of s.libraries||[]){const i=e.github.parseRepoId(t);i||n.userError(r("codal library {0} doesn't look like github repo",t));const s=e.github.stringifyRepo(i),o=n.lookup(re,i.project);o?e.github.stringifyRepo(o)!=s&&n.userError(r("conflict between codal libraries: {0} and {1}",e.github.stringifyRepo(o),s)):re[i.project]=i}const o=t.config.yotta;if(o){if(o.dependencies&&n.jsonCopyFrom(g.yotta.dependencies,o.dependencies),o.config){const e=n.jsonFlatten(o.config);for(const i of Object.keys(e)){const s=n.lookup(ne,i),o=e[i];if(!s||s.config.yotta.configIsJustDefaults)ne[i]=t,ee[i]=o;else if(ee[i]===o);else if(!t.parent.config.yotta||!t.parent.config.yotta.ignoreConflicts){let e=new l(r("conflict on yotta setting {0} between extensions {1} and {2}",i,t.id,s.id));throw e.pkg0=s,e.pkg1=t,e.settingName=i,e}}}if(o.optionalConfig){const e=n.jsonFlatten(o.optionalConfig);for(const t of Object.keys(e)){const n=e[t];te[t]=n}}}}if(x&&b.hasHex){let e=y;n.assert(!!e.yottaCorePackage),n.assert(!!e.githubCorePackage),n.assert(!!e.gittag);let t=e.githubCorePackage+"#"+y.gittag;g.yotta.dependencies[e.yottaCorePackage]=t}if(t){let e=!1;for(let i of h){D="",ie(i),i==t?(e=!0,M.clear(),F.clear()):n.assert(!e);const s=e=>n.endsWith(e,".h"),o=".cpp",a=i.getFiles().filter(s).concat(i.getFiles().filter((e=>!s(e))));for(let e of a){const t=s(e);if(t||n.endsWith(e,o)){let s=i.config.name+"/"+e;("base"==i.config.name||/^core($|---)/.test(i.config.name))&&t&&(s=e),t&&(N+=`#include "${x?d.slice(1):""}${s}"\n`);let o=i.readFile(e);null==o&&n.userError(r("C++ file {0} is missing in extension {1}.",e,i.config.name)),L=s,Z(o,t),g.extensionFiles[d+s]=o,0==i.level&&(g.onlyPublic=!1),i.verProtocol()&&"pub"!=i.verProtocol()&&"embed"!=i.verProtocol()&&(g.onlyPublic=!1)}if(n.endsWith(e,".c")||n.endsWith(e,".S")||n.endsWith(e,".s")){let t=i.readFile(e);g.extensionFiles[d+i.config.name+"/"+e.replace(/\.S$/,".s")]=t}}D&&($+=r("Extension {0}:\n",i.id)+D)}e||(M.clear(),F.clear())}function se(e){return Object.keys(g.extensionFiles).concat(Object.keys(g.generatedFiles)).filter((t=>n.endsWith(t,e))).map((e=>e.slice(1)))}$&&n.userError($),n.jsonCopyFrom(te,ee),n.iterMap(te,((e,t)=>{null===t&&delete te[e]})),Object.keys(te).filter((e=>/-/.test(e))).forEach((e=>{const t=te[e];delete te[e],te[e.replace(/-/g,"_")]=t})),!x&&y.yottaConfigCompatibility&&Object.keys(te).forEach((e=>te["YOTTA_CFG_"+e]=te[e])),te.PXT_TARGET=JSON.stringify(e.appTarget.id);const oe=n.jsonUnFlatten(te);if(k){let e={name:"pxt-app",private:!0,dependencies:g.npmDependencies};g.generatedFiles["/package.json"]=JSON.stringify(e,null,4)+"\n"}else if(E){const e=n.concatArrayLike([se(".c"),se(".cpp"),se(".s")]).map((e=>e.slice(d.length-1))).concat(["main.cpp"]);e.push("pointers.cpp"),g.generatedFiles[d+"CMakeLists.txt"]="idf_component_register(\n  SRCS\n"+e.map((e=>`    "${e}"\n`)).join("")+'  INCLUDE_DIRS\n    "."\n)\n'}else if(T){let t=y,r=n.clone(t.codalDefinitions)||{},i=t.codalTarget;"string"==typeof i&&(i+=".json");let s={target:i,definitions:r,config:r,application:"pxtapp",output_folder:"build",pxt_gitrepo:t.githubCorePackage,pxt_gittag:t.gittag,libraries:n.values(re).map((e=>({name:e.project,url:"https://github.com/"+e.fullName,branch:e.tag||"master",type:"git"})))};0==s.libraries.length&&delete s.libraries,n.iterMap(n.jsonFlatten(oe),((e,t)=>{e=e.replace(/^codal\./,"device.").toUpperCase().replace(/\./g,"_"),r[e]=t})),g.generatedFiles["/codal.json"]=JSON.stringify(s,null,4)+"\n",e.debug(`codal.json: ${g.generatedFiles["/codal.json"]}`),g.codal=s}else if(v){const e=y.platformioIni.slice();e.push("lib_deps ="),n.iterMap(g.platformio.dependencies,((t,n)=>{let r=/[@#\/]/.test(n)?n:t+"@"+n;e.push("  "+r)})),g.generatedFiles["/platformio.ini"]=e.join("\n")+"\n"}else{g.yotta.config=oe;let t="pxt-app";y.yottaBinary&&(t=y.yottaBinary.replace(/-combined/,"").replace(/\.hex$/,""));let n={name:t,version:"0.0.0",description:"Auto-generated. Do not edit.",license:"n/a",dependencies:g.yotta.dependencies,targetDependencies:{},bin:"./source"};g.generatedFiles["/module.json"]=JSON.stringify(n,null,4)+"\n",e.debug(`module.json: ${g.generatedFiles["/module.json"]}`)}for(let e of Object.keys(j))C+=`#define ${e} ${j[e]}\n`;if(b.uf2Family&&(C+=`#define PXT_UF2_FAMILY ${b.uf2Family}\n`),g.generatedFiles[d+"pointers.cpp"]=N+P.finish()+w+A+I+"\nPXT_SHIMS_END\n",g.generatedFiles[d+"pxtconfig.h"]=C,e.debug(`pxtconfig.h: ${g.generatedFiles[d+"pxtconfig.h"]}`),x&&(g.generatedFiles["/config.json"]=JSON.stringify(oe,null,4)+"\n",e.debug(`yotta config.json: ${g.generatedFiles["/config.json"]}`)),g.generatedFiles[d+"main.cpp"]='\n#include "pxt.h"\n#ifdef PXT_MAIN\nPXT_MAIN\n#else\nint main() {\n    uBit.init();\n    pxt::start();\n    release_fiber();\n    return 0;   // your program will never reach this line.\n}\n#endif\n',g.generatedFiles["/Makefile"]){let e="",t=(t,n)=>{e+=`${t} = ${se(n).join(" ")}\n`};t("PXT_C",".c"),t("PXT_CPP",".cpp"),t("PXT_S",".s"),t("PXT_HEADERS",".h"),e+="PXT_SOURCES := $(PXT_C) $(PXT_S) $(PXT_CPP)\n",e+="PXT_OBJS := $(addprefix bld/, $(PXT_C:.c=.o) $(PXT_S:.s=.o) $(PXT_CPP:.cpp=.o))\n",g.generatedFiles["/Makefile.inc"]=e}g.generatedFiles["/functions.json"]=JSON.stringify(g.functions,null,1);let ae=g.extensionFiles;n.jsonCopyFrom(ae,g.generatedFiles);let le={config:y.serviceId,tag:y.gittag,replaceFiles:ae,dependencies:x?g.yotta.dependencies:null},ce=JSON.stringify(le);return g.sha=n.sha256(ce),g.skipCloudBuild=!!y.skipCloudBuild,g.compileData=ts.pxtc.encodeBase64(n.toUTF8(ce)),g.shimsDTS=M.finish(),g.enumsDTS=F.finish(),Object.keys(a).length>10&&(a={}),a[m]=g,g},t.unpackSourceFromHexFileAsync=function(t){if(t)return e.Util.fileReadAsBufferAsync(t).then((e=>p(new Uint8Array(e))))},t.unpackSourceFromHexAsync=p}(e.cpp||(e.cpp={}))}(pxt||(pxt={})),function(e){!function(t){const n={};let r,i={};function s(i){return n.hasOwnProperty(i.sha)||(n[i.sha]=function(n){let i="";return t.showLoading(e.U.lf("Compiling (this may take a minute)...")),e.tickEvent("cppcompile.start"),function(t){if(t.skipCloudBuild)return Promise.resolve({hex:["SKIP"]});if(e.webConfig&&e.webConfig.isStatic)return e.Util.requestAsync({url:`${e.webConfig.cdnUrl}hexcache/${t.sha}.hex`}).then((t=>{if(t.text){const e={enums:[],functions:[],hex:t.text.split(/\r?\n/)};return Promise.resolve(e)}return e.log("Hex info not found in bundled hex cache"),Promise.resolve()})).catch((t=>(e.log("Error fetching hex info from bundled hex cache"),Promise.resolve())));if(!e.Cloud.localToken||!window||!e.BrowserUtils.isLocalHost())return Promise.resolve(void 0);return(n="compile/"+t.sha,e.Cloud.localRequestAsync(n,r).then((e=>e.json))).then((e=>e&&!e.notInOfflineCache&&e.hex?(e.hex=e.hex.split(/\r?\n/),e):Promise.resolve(void 0))).catch((e=>Promise.resolve(void 0)));var n,r}(n).then((s=>s?(e.tickEvent("cppcompile.cachehit"),s):function(){if(r)return r;{let t=e.getOnlineCdnUrl();if(t)return r=Promise.resolve(t);const n=e.webConfig&&e.webConfig.isStatic;return r=e.Cloud.privateGetAsync("clientconfig",n).then((e=>e.primaryCdnUrl))}}().then((t=>(i=t+"/compile/"+n.sha,e.U.httpGetTextAsync(i+".hex")))).then((e=>e),(t=>e.Cloud.privatePostAsync("compile/extension",{data:n.compileData},!0).then((t=>new Promise(((n,r)=>{let s=0;const o=8e3,a=3e5,l=e.U.now(),c=()=>{if(s++,e.U.now()-l>a)return e.log("abandoning C++ build"),e.tickEvent("cppcompile.cancel",{retry:s}),n(null),null;let r=t.hex.replace(/\.hex/,".json");return e.log(`polling C++ build ${r} (attempt #${s})`),e.tickEvent("cppcompile.poll",{retry:s}),e.Util.httpGetJsonAsync(r).then((t=>{e.log(`build log ${r.replace(/\.json$/,".log")}`),e.tickEvent("cppcompile.done",{success:(null==t?void 0:t.success)?1:0,retry:s,duration:e.U.now()-l}),t.success?(e.log("fetching "+i+".hex"),n(e.U.httpGetTextAsync(i+".hex"))):(e.log("build failed"),t.mbedresponse&&t.mbedresponse.result&&t.mbedresponse.result.exception&&e.log(t.mbedresponse.result.exception),n(null))}),(t=>(e.log(`waiting ${o/1e3|0}s for C++ build...`),setTimeout(c,o),null)))};c()})))))).then((e=>(t.hideLoading(),{hex:e&&e.split(/\r?\n/)}))))).finally((()=>{t.hideLoading()}))}(i)),n[i.sha]}function o(t,n,r,i,s=10){return t.cacheStoreAsync(r,i).then((()=>t.cacheGetAsync(n))).then((i=>{let o;try{o=JSON.parse(i||"[]")}catch(e){console.error("invalid cache entry, clearing entry"),o=[]}o=o.filter((e=>e!=r)),o.unshift(r);let a=o.slice(s);return o=o.slice(0,s),e.U.promiseMapAll(a,(e=>t.cacheStoreAsync(e,"[]"))).then((()=>t.cacheStoreAsync(n,JSON.stringify(o))))}))}function a(e,t,n){return e.cacheGetAsync(t).then((r=>{let i;try{i=JSON.parse(r||"[]")}catch(n){return console.error("invalid cache entry, clearing entry"),e.cacheStoreAsync(t,"[]")}return i[0]!=n?(i=i.filter((e=>e!=n)),i.unshift(n),e.cacheStoreAsync(t,JSON.stringify(i))):null}))}t.showLoading=e=>{},t.hideLoading=()=>{},t.storeWithLimitAsync=o,t.recordGetAsync=a,t.getHexInfoAsync=function(t,n,r){if(!n.sha)return Promise.resolve(null);const l=i[n.sha];if(l)return Promise.resolve(l);e.debug("get hex info: "+n.sha);let c="hex-"+n.sha;return t.cacheGetAsync(c).then((r=>{let i;try{i=r?JSON.parse(r):null}catch(e){console.log("invalid cache entry, clearing entry"),i=null}return i&&i.hex?(e.debug("cache hit, size="+r.length),i.hex=function(t){let n=[];for(let r=0;r<t.length;r++){let i=/^([@!])(....)$/.exec(t[r]);if(!i){n.push(t[r]);continue}let s=parseInt(i[2],16),o=t[++r],a="";if("@"==i[1]){a="";let e=parseInt(o,16);for(;e-- >0;)a+="\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}else a=ts.pxtc.decodeBase64(o);e.Util.assert(a.length>0),e.Util.assert(a.length%16==0);for(let e=0;e<a.length;){let t=[16,s>>8&255,255&s,0];s+=16;for(let n=0;n<16;++n)t.push(a.charCodeAt(e++));let r=0;for(let e=0;e<t.length;++e)r+=t[e];t.push(255&-r);let i=":";for(let e=0;e<t.length;++e){let n=255&t[e];n<=15&&(i+="0"),i+=n.toString(16)}n.push(i.toUpperCase())}}return n}(i.hex),a(t,"hex-keys",c).then((()=>i))):s(n).then((e=>{let n=e.hex;e.hex=function(e){let t=[],n=0;for(let r=0;r<e.length;r+=n){let i=-1,s="";n=0;let o=!1;for(;n<500;){let a=/^:10(....)00(.{32})(..)$/.exec(e[r+n]);if(!a)break;let l=a[2],c=/^0+$/.test(l),u=parseInt(a[1],16);if(-1==i)o=c,t.push((o?"@":"!")+a[1]),i=u-16;else{if(c!=o)break;if(i+16!=u)break}o||(s+=l),i=u,n++}if(0==n)t.push(e[r]),n=1;else if(o)t.push(n.toString(16));else{let e="";for(let t=0;t<s.length;t+=2)e+=String.fromCharCode(parseInt(s.slice(t,t+2),16));t.push(ts.pxtc.encodeBase64(e))}}return t}(e.hex);let r=JSON.stringify(e);return e.hex=n,o(t,"hex-keys",c,r).then((()=>e))})).catch((t=>(e.reportException(t,{sha:n.sha}),Promise.resolve(null))))})).then((e=>(e&&(Object.keys(i).length>20&&(i={}),i[n.sha]=e),e)))}}(e.hexloader||(e.hexloader={}))}(pxt||(pxt={})),function(e){!function(t){t.KEY_VARIABLE="CROWDIN_KEY",t.testMode=!1,t.setTestMode=function(){e.crowdin.testMode=!0,e.log("CROWDIN TEST MODE - files will NOT be uploaded")},t.inContextLoadAsync=function(t){const n=document.createElement("input");n.type="text",n.setAttribute("class","hidden"),n.value=t;let r=new Promise(((r,i)=>{const s=new MutationObserver((()=>{if(t==n.value)return;const i=e.Util.rlf(n.value);n.remove(),s.disconnect(),r(i)}));s.observe(n,{attributes:!0})}));return document.body.appendChild(n),r}}(e.crowdin||(e.crowdin={}))}(pxt||(pxt={})),function(e){!function(t){function n(e){return e?e.split(/\r?\n/):[]}function r(e,t,r={}){r.ignoreWhitespace&&(e=e.replace(/[\r\n]+$/,""),t=t.replace(/[\r\n]+$/,""));const i=n(e),s=n(t),o=Math.min(r.maxDiffSize||1024,i.length+s.length);if(0==o)return[];const a=i.length>65520?Uint32Array:Uint16Array,l={};let c=0;const u=p(i),d=p(s);function p(e){const t=new a(e.length);let n=0;for(let i of e)r.ignoreWhitespace&&(i=i.replace(/\s+$/g,"").replace(/^\s+/g,"")),l.hasOwnProperty(i)?t[n]=l[i]:(++c,t[n]=c,l[i]=c),n++;return t}const h=new a(2*o+1);let f=-1;for(let e=0;e<=o;e++)null!=x(e,h)&&(f=e);if(-1==f)return null;const m=[];let _=null;for(let e=0;e<=f;e++){const t=m.length?m[m.length-1].slice(0):new a(2*f+1);if(m.push(t),_=x(e,t),null!=_)break}const g=[];let y=_;for(let e=m.length-1;e>=0;e--){const t=m[e];let n=0,r=0;y==-e||y!=e&&t[o+y-1]<t[o+y+1]?(r=y+1,n=t[o+r]):(r=y-1,n=t[o+r]+1);let a=n-y;for(let e=t[o+y]-n-1;e>=0;--e)g.push("  "+s[a+e]);r==y-1?g.push("- "+i[n-1]):a>0&&g.push("+ "+s[a-1]),y=r}if(g.reverse(),r.context==1/0||r.full)return g;let b=1,v=1,T=0;const k=[],E=r.context||3;for(;T<g.length;){let e=T;for(;e<g.length&&" "==g[e][0];)e++;if(e==g.length)break;const t=e-E,n=t-T;n>0&&(b+=n,v+=n,T=t);const r=k.length,i=b,s=v;k.push("@@");let o=T,a=0;for(;o<g.length;){if(" "==g[o][0]){if(a++,a>2*E+2){o-=E+2;break}}else a=0;o++}for(;T<o;){k.push(g[T]);switch(g[T][0]){case"-":b++;break;case"+":v++;break;case" ":b++,v++}T++}k[r]=`@@ -${i},${b-i} +${s},${v-s} @@`}return k;function x(e,t){for(let n=-e;n<=e;n+=2){let r=0;r=n==-e||n!=e&&t[o+n-1]<t[o+n+1]?t[o+n+1]:t[o+n-1]+1;let i=r-n;for(;r<u.length&&i<d.length&&u[r]==d[i];)r++,i++;if(t[o+n]=r,r>=u.length&&i>=d.length)return n}return null}}function i(e){return n(e).map((e=>e.replace(/;\s*$/,""))).join("\n")}function s(e){const t=/^@@ -(\d+),(\d+) \+(\d+),(\d+)/.exec(e);return t&&{oldStart:parseInt(t[1])-1,oldLength:parseInt(t[2]),newStart:parseInt(t[3])-1,newLength:parseInt(t[4])}}t.toLines=n,t.compute=r,t.diff3=function(t,i,s,o,a){const l=_(t),c=_(s);if(!l||!c)return;const u=n(t),d=n(s);let p=0,h=[],f=0,m=0;for(let t=0;t<l.length-1;)if(l[t]==f&&c[t]==m)h.push(u[f]),f++,m++,t++;else{let n=!0,r=!0,i=t;for(;i<l.length&&(l[i]!=f+i-t&&(n=!1),c[i]!=m+i-t&&(r=!1),null==l[i]||null==c[i]);)i++;if(e.U.assert(i<l.length),n)for(;m<c[i];)h.push(d[m++]);else if(r)for(;f<l[i];)h.push(u[f++]);else if(u.slice(f,l[i]).join("\n")==d.slice(m,c[i]).join("\n"))for(;f<l[i];)h.push(u[f++]);else{for(p++,h.push("<<<<<<< "+o);f<l[i];)h.push(u[f++]);for(h.push("=======");m<c[i];)h.push(d[m++]);h.push(">>>>>>> "+a)}t=i,f=l[i],m=c[i]}return{merged:h.join("\n"),numConflicts:p};function _(t){const n=r(i,t,{context:1/0});if(!n)return;const s=[];let o=0,a=0;for(let t of n)"+"==t[0]?o++:"-"==t[0]?(s[a]=null,a++):" "==t[0]?(s[a]=o,o++,a++):e.U.oops();return s.push(o+1),s}},t.removeTrailingSemiColumns=i,t.split=function(e,t){const n=e.split(/-{10,}/,2);if(n.length<2)return{fileA:e,fileB:void 0};let r=n[0].replace(/\n$/,""),s=n[1].replace(/^\n/,"");return t&&t.removeTrailingSemiColumns&&(r=i(r),s=i(s)),{fileA:r,fileB:s}},t.parseDiffMarker=s,t.render=function(t,n,i={}){const o=r(t,n,i);if(!o)return e.dom.el("div",null,pxtc.Util.lf("Too many differences to render diff."));const a={"@":"diff-marker"," ":"diff-unchanged","+":"diff-added","-":"diff-removed"};let l=0,c=0,u="";const d=e.dom.el("tbody"),p=e.dom.el("table",{class:"diffview "+(i.update?"update":"")},d);let h=null;return o.forEach(((t,n)=>{const p=s(t);p?(l=p.oldStart,c=p.newStart):("+"!=t[0]&&l++,"-"!=t[0]&&c++);const f=o[n+1]?o[n+1][0]:"",m=o[n+2]?o[n+2][0]:"",_=t.slice(2);let g=e.dom.el("code",null,_);if(h)g=h,h=null;else if(!("-"!=t[0]||" "!=u&&"@"!=u||"+"!=f||" "!=m&&"@"!=m&&""!=m)){const i=function(t,n){const i=r(t.split("").join("\n"),n.split("").join("\n"),{context:1/0});if(!i)return{a:e.dom.el("div",{class:"inline-diff"},e.dom.el("code",null,t)),b:e.dom.el("div",{class:"inline-diff"},e.dom.el("code",null,n))};const s=[],o=[];for(let t=0;t<i.length;){let n=t;const r=i[t][0];for(;i[n]&&i[n][0]==r;)n++;const a=i.slice(t,n).map((e=>e.slice(2))).join("");" "==r?(s.push(e.dom.el("code",{class:"ch-common"},a)),o.push(e.dom.el("code",{class:"ch-common"},a))):"-"==r?s.push(e.dom.el("code",{class:"ch-removed"},a)):"+"==r?o.push(e.dom.el("code",{class:"ch-added"},a)):e.Util.oops(),t=n}return{a:e.dom.el("div",{class:"inline-diff"},s),b:e.dom.el("div",{class:"inline-diff"},o)}}(t.slice(2),o[n+1].slice(2));g=i.a,h=i.b}if(u=t[0],i.hideMarkerLine&&"@"==u||i.hideRemoved&&"-"==u)return;const y="@"==u,b=`${a[u]}`;d.appendChild(e.dom.el("tr",{class:b},[!i.hideLineNumbers&&e.dom.el("td",{class:"line-a","data-content":l}),!i.hideLineNumbers&&e.dom.el("td",{class:"line-b","data-content":c}),y&&e.dom.el("td",{colspan:2,class:"change"},e.dom.el("code",null,t)),!i.hideMarker&&!y&&e.dom.el("td",{class:"marker","data-content":u}),!y&&e.dom.el("td",{class:"change"},g)]))})),p},t.resolveMergeConflictMarker=function(t,n,r,i){let s=e.diff.toLines(t),o=n;for(;o<s.length&&!/^<<<<<<<[^<]/.test(s[o]);)o++;let a=o+1;for(;a<s.length&&!/^=======$/.test(s[a]);)a++;let l=a+1;for(;l<s.length&&!/^>>>>>>>[^>]/.test(s[l]);)l++;if(l>=s.length)return e.debug(`diff marker mistmatch: ${s.length} -> ${o} ${a} ${l}`),t;if(s[o]=void 0,s[a]=void 0,s[l]=void 0,!r)for(let e=o;e<=a;++e)s[e]=void 0;if(!i)for(let e=a;e<=l;++e)s[e]=void 0;return s.filter((e=>void 0!==e)).join("\n")},t.mergeDiff3Config=function(t,n,r){let i=e.Util.jsonTryParse(t),s=e.Util.jsonTryParse(n),o=e.Util.jsonTryParse(r);if(i&&!o)return t;if(!i)return r||n;if(!s&&o&&(s=o),!i||!s||!o)return;delete i.installedVersion,delete s.installedVersion,delete o.installedVersion;const a={},l=e.U.unique(Object.keys(s).concat(Object.keys(i)).concat(Object.keys(o)),(e=>e));for(const t of l){const n=i[t],r=s[t],l=o[t];if(JSON.stringify(n)==JSON.stringify(l))void 0!==n&&(a[t]=n);else switch(t){case"name":a[t]=c(n,r,l);break;case"version":a[t]=e.semver.strcmp(n,l)>0?n:l;break;case"languageRestriction":case"preferredEditor":case"targetVersion":a[t]=n;break;case"public":a[t]=n&&l;break;case"files":case"testFiles":{const e=u(n||[],r||[],l||[]);if(!e)return;a[t]=e.length?e:void 0;break}case"dependencies":case"testDependencies":{const e=d(n||{},r||{},l||{});if(Object.keys(e).length)return;a[t]=e;break}case"description":if(n&&!l)a[t]=n;else{if(n||!l)return;a[t]=l}break;default:return}}return e.Package.stringifyConfig(a);function c(e,t,n){return e==t?n:n==t?e:e==lf("Untitled")?n:e}function u(t,n,r){const i=[],s=e.U.unique(n.concat(t).concat(r),(e=>e));for(const e of s){const s=t.indexOf(e)>-1,o=r.indexOf(e)>-1,a=n.indexOf(e)>-1;s==o||o==a?s&&i.push(e):o&&i.push(e)}return i}function d(t,n,r){const i={},s=e.U.unique(Object.keys(n).concat(Object.keys(t)).concat(Object.keys(r)),(e=>e));for(const o of s){const s=t[o],a=r[o],l=n[o];if(s==a)s&&(i[o]=s);else{const t=e.github.parseRepoId(s),n=e.github.parseRepoId(a);if(t&&n&&e.semver.tryParse(t.tag)&&e.semver.tryParse(n.tag)&&t.owner&&t.project&&t.owner==n.owner&&t.project==n.project){const r=e.semver.strcmp(t.tag,n.tag)>0?t.tag:n.tag;i[o]=`github:${t.owner}/${t.project}#${r}`}else a==l?s&&(i[o]=s):a&&(i[o]=a)}}return i}},t.hasMergeConflictMarker=function(e){return e&&/^(<<<<<<<[^<]|>>>>>>>[^>])/m.test(e)},t.reconstructConfig=function(t,n,r,i){let s={},o=r.tree.tree.map((e=>e.path)).filter((e=>/\.(ts|blocks|md|jres|asm|json)$/.test(e))).filter((t=>t!=e.CONFIG_NAME));return t.fileName&&(o=o.filter((e=>0===e.indexOf(t.fileName))).map((e=>e.slice(t.fileName.length+1)))),o.find((e=>/\.ts$/.test(e)))||(i.config.files.filter((e=>o.indexOf(e)<0)).forEach((e=>{o.push(e),n[e]=i.files[e]})),e.Util.jsonCopyFrom(s,i.config.dependencies)),Object.keys(s).length||(s[e.appTarget.corepkg]="*"),{name:"",files:o,dependencies:s,preferredEditor:o.find((e=>/.blocks$/.test(e)))?e.BLOCKS_PROJECT_NAME:e.JAVASCRIPT_PROJECT_NAME}}}(e.diff||(e.diff={}))}(pxt||(pxt={})),function(e){!function(t){t.extractSharedIdFromPostUrl=function(t){return e.Util.httpGetJsonAsync(t+".json").then((t=>t.post_stream&&t.post_stream.posts&&t.post_stream.posts[0]&&t.post_stream.posts[0].link_counts.map((t=>e.Cloud.parseScriptId(t.url))).filter((e=>!!e))[0]))},t.topicsByTag=function(t,n){const r=`${t=t.replace(/\/$/,"")}/tag/${n}.json`;return e.Util.httpGetJsonAsync(r).then((n=>{const r=e.Util.toDictionary(n.users,(e=>e.id.toString()));return n.topic_list.topics.map((e=>({id:e.id,title:e.title,url:`${t}/t/${e.slug}/${e.id}`,imageUrl:e.image_url,author:r[e.posters[0].user_id].username,cardType:"forumUrl"})))}))}}(e.discourse||(e.discourse={}))}(pxt||(pxt={})),function(e){!function(t){var n=pxtc.Util;let r,i={},s={};const o="\x3c!-- @CMD@ @ARGS@ --\x3e";let a={parent:o,short:o,description:"\x3c!-- desc --\x3e",activities:"\x3c!-- activities --\x3e",explicitHints:"\x3c!-- hints --\x3e",flyoutOnly:"\x3c!-- flyout --\x3e",hideIteration:"\x3c!-- iter --\x3e",codeStart:"\x3c!-- start --\x3e",codeStop:"\x3c!-- stop --\x3e",autoOpen:"\x3c!-- autoOpen --\x3e",autoexpandOff:"\x3c!-- autoexpandOff --\x3e",preferredEditor:"\x3c!-- preferredEditor --\x3e"};function l(e,t,n){return e.split(t).join(n)}function c(e){return e=l(e,"&","&amp;"),e=l(e,"<","&lt;"),e=l(e,">","&gt;"),e=l(e,'"',"&quot;"),e=l(e,"'","&#39;")}function u(e){return e?c(e.replace(/\&([#a-z0-9A-Z]+);/g,((e,t)=>{switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1))):e}}))):e}t.htmlQuote=c,t.html2Quote=u;const d=[{rx:/^vimeo\.com\/(\d+)/i,cmd:"### @vimeo $1"},{rx:/^(www\.youtube\.com\/watch\?v=|youtu\.be\/)([\w\-]+(\#t=([0-9]+m[0-9]+s|[0-9]+m|[0-9]+s))?)/i,cmd:"### @youtube $2"}];t.requireMarked=()=>"undefined"!=typeof marked?marked:"undefined"!=typeof require?require("marked"):void 0,t.requireDOMSanitizer=()=>"undefined"!=typeof DOMPurify?DOMPurify.sanitize:"undefined"!=typeof require?require("DOMPurify").sanitize:void 0;const p=e=>`<div class='ui negative message'>${c(e)}</div>`;function h(e){let t=n.clone(i),r=n.clone(s),o=n.clone(a),l={},c={},d=e.params,h=e.theme;e.boxes=t,e.macros=r,e.settings=o,e.html=e.html.replace(/<aside\s+([^<>]+)>([^]*?)<\/aside>/g,((e,n,i)=>{let s=function(e){let t={};for(;e.trim();){let n=/\s*([^=\s]+)=("([^"]*)"|'([^']*)'|(\S*))/.exec(e);if(n){let e=n[3]||n[4]||n[5]||"";t[n[1].toLowerCase()]=e}else n=/^\s*(\S+)/.exec(e),t[n[1]]="true";e=e.slice(n[0].length)}return t}(n),a=s["data-name"]||s.id;return a?(/box/.test(s.class)?t[a]=i:/aside/.test(s.class)?t[a]=`\x3c!-- BEGIN-ASIDE ${a} --\x3e${i}\x3c!-- END-ASIDE --\x3e`:/setting/.test(s.class)?o[a]=i:/menu/.test(s.class)?l[a]=i:/toc/.test(s.class)?c[a]=i:r[a]=i,`\x3c!-- macro ${a} --\x3e`):p("id or data-name missing on macro")}));let f=(e,t)=>{let n=l.item,r={NAME:e.name};if(e.subitems)n=l["toc-dropdown"]?l["toc-dropdown"]:0==t?l["top-dropdown"]:l["inner-dropdown"],r.ITEMS=e.subitems.map((e=>f(e,t+1))).join("\n");else{if(/^-+$/.test(e.name)&&(n=l.divider),e.path&&!/^(https?:|\/)/.test(e.path))return p("Invalid link: "+e.path);r.LINK=e.path}return _(n,r,["ITEMS"])},m=[{name:lf("Docs"),href:"/docs"}];const g=e.TOC||h.TOC||[];let y=[],b=t=>{for(let e of t.subitems||[])if(b(e))return y.push(t),!0;return!(!e.filepath||!t.path||0!=e.filepath.indexOf(t.path))&&(y.push(t),!0)};g.forEach(b);let v=(t,n)=>{let r=c.item,i={NAME:t.name};return t.path&&!/^(https?:|\/)/.test(t.path)?p("Invalid link: "+t.path):(/^\//.test(t.path)&&e.versionPath&&(t.path=`/${e.versionPath}${t.path}`),i.LINK=t.path,y.indexOf(t)>=0?(i.ACTIVE="active",i.EXPANDED="true",m.push({name:t.name,href:t.path})):i.EXPANDED="false",t.subitems&&t.subitems.length>0?(r=c["toc-dropdown"]?""!==t.name?c["toc-dropdown"]:c["toc-dropdown-noLink"]:0==n?""!==t.name?c["top-dropdown"]:c["top-dropdown-noHeading"]:1==n?c["inner-dropdown"]:c["nested-dropdown"],i.ITEMS=t.subitems.map((e=>v(e,n+1))).join("\n")):/^-+$/.test(t.name)&&(r=c.divider),_(r,i,["ITEMS"]))};d.menu=(h.docMenu||[]).map((e=>f(e,0))).join("\n"),d.TOC=g.map((e=>v(e,0))).join("\n"),h.appStoreID&&(d.appstoremeta=`<meta name="apple-itunes-app" content="app-id=${n.htmlEscape(h.appStoreID)}"/>`);let T="";m.length>1&&(T=`\n            <nav class="ui breadcrumb" aria-label="${lf("Breadcrumb")}">\n                ${m.map(((e,t)=>`<a class="${t==m.length-1?"active":""} section"\n                        href="${u(e.href)}" aria-current="${t==m.length-1?"page":""}">${u(e.name)}</a>`)).join('<i class="right chevron icon divider"></i>')}\n            </nav>`),d.breadcrumb=T,h.boardName&&(d.boardname=u(h.boardName)),h.boardNickname&&(d.boardnickname=u(h.boardNickname)),h.driveDisplayName&&(d.drivename=u(h.driveDisplayName)),h.homeUrl&&(d.homeurl=u(h.homeUrl)),d.targetid=h.id||"???",d.targetname=h.name||"Microsoft MakeCode",d.docsheader=h.docsHeader||"Documentation",d.orgtitle="MakeCode";const k=h.docsLogo&&n.htmlEscape(h.docsLogo),E=(h.organizationWideLogo||h.organizationLogo)&&n.htmlEscape(h.organizationWideLogo||h.organizationLogo),x=h.organizationLogo&&n.htmlEscape(h.organizationLogo);d.targetlogo=k?`<img aria-hidden="true" role="presentation" class="ui ${h.logoWide?"small":"mini"} image" src="${k}" />`:"",d.orglogo=E?`<img aria-hidden="true" role="presentation" class="ui image" src="${E}" />`:"",d.orglogomobile=x?`<img aria-hidden="true" role="presentation" class="ui image" src="${x}" />`:"";let S=e.ghEditURLs||[];if(S.length){let e='<p style="margin-top:1em">\n',t=lf("Edit this page on GitHub");for(let n of S)e+=`<a href="${n}"><i class="write icon"></i>${t}</a><br>\n`,t=lf("Edit template of this page on GitHub");e+="</p>\n",d.github=e}else d.github="";const C=`\n            <a href="#maincontent" class="ui item link" tabindex="0" role="menuitem">${lf("Skip to main content")}</a>\n        `;d.accMenu=C;const I=lf("Print this page"),A=`\n            <button id="printbtn" class="circular ui icon right floated button hideprint" title="${I}" aria-label="${I}">\n                <i class="icon print"></i>\n            </button>\n        `;d.printBtn=A;const w=`\n            <a id="togglesidebar" class="launch icon item" tabindex="0" title="Side menu" aria-label="${lf("Side menu")}" role="menuitem" aria-expanded="false">\n                <i class="content icon"></i>\n            </a>\n        `;d.sidebarToggle=w;const N=["tocsearch1","tocsearch2"].map((e=>`\n                <input type="search" name="q" placeholder="${lf("Search...")}" aria-label="${lf("Search Documentation")}">\n                <i onclick="document.getElementById('${e}').submit();" tabindex="0" class="search link icon" aria-label="${lf("Search")}" role="button"></i>\n            `));d.searchBar1=N[0],d.searchBar2=N[1];let D="";h.accentColor&&(D+=`\n.ui.accent { color: ${h.accentColor}; }\n.ui.inverted.accent { background: ${h.accentColor}; }\n`),d.targetstyle=D,d.tocclass=h.lightToc?"lighttoc":"inverted";for(let e of Object.keys(h)){let t=h[e];void 0===d[e]&&"string"==typeof t&&(d[e]=t)}e.finish=()=>_(e.html,d,["body","menu","accMenu","TOC","prev","next","printBtn","breadcrumb","targetlogo","orglogo","orglogomobile","github","JSON","appstoremeta","sidebarToggle","searchBar1","searchBar2"])}function f(e){e.image=function(e,t,n){var r,i;if(e.startsWith("youtube:")){return'<div class="tutorial-video-embed"><iframe class="yt-embed" src="https://www.youtube.com/embed/'+e.split(":").pop()+'" title="'+n+'" frameborder="0" allowFullScreen allow="autoplay; picture-in-picture"></iframe></div>'}if(e.startsWith("azuremedia:")){let t=e.split(":")[1];const n=t.split("?");let s,o;if(n[1]){t=n[0];const e=n[1];s=null===(r=/start(?:time)?=(\d+)/i.exec(e))||void 0===r?void 0:r[1],o=null===(i=/end(?:time)?=(\d+)/i.exec(e))||void 0===i?void 0:i[1]}const a=new URL(`https://makecodeprodmediaeastus-usea.streaming.media.azure.net/${t}/manifest(format=mpd-time-csf).mpd`);return s&&(a.hash=`t=${s}`,a.searchParams.append("startTime",s)),o&&a.searchParams.append("endTime",o),`<div class="tutorial-video-embed"><video class="ams-embed" controls src="${a.toString()}" /></div>`}{let r='<img class="ui image" src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=' loading="lazy"',r+=this.options.xhtml?"/>":">",r}},e.listitem=function(e){const t=/^\s*\[( |x)\]/i.exec(e);return t?`<li class="${" "==t[1]?"unchecked":"checked"}">`+e.slice(t[0].length)+"</li>\n":"<li>"+e+"</li>\n"},e.heading=function(e,t,n){let r=/(.*)#([\w\-]+)\s*$/.exec(e),i="";return r&&(e=r[1],i=r[2]),e&&(e=e.replace(/@(fullscreen|unplugged|showdialog|showhint)/gi,"")),e.match(/\{([\s\S]+)\}/)&&(e=e.match(/\{([\s\S]+)\}/)[1].trim()),""===i&&(i=e.toLowerCase().replace(/[^\w]+/g,"-")),`<h${t} id="${this.options.headerPrefix}${i}">${e}</h${t}>`}}function m(e,t){return e.replace(/<!--\s*@(ifn?def)\s+(\w+)\s*-->([^]*?)<!--\s*@endif\s*-->/g,((e,n,r,i)=>"ifdef"==n&&t[r]||"ifndef"==n&&!t[r]?`\x3c!-- ${n} ${r} --\x3e${i}\x3c!-- endif --\x3e`:`\x3c!-- ${n} ${r} endif --\x3e`))}function _(e,t,r=[]){return e?e.replace(/@(\w+)@/g,((e,i)=>{let s=n.lookup(t,i)||"";return s+="",r.indexOf(i)<0&&(s=u(s)),s})):""}t.prepTemplate=h,t.setupRenderer=f,t.renderConditionalMacros=m,t.renderMarkdown=function(e){let i=!0;e.pubinfo||(i=!1,e.pubinfo={});let s=e.pubinfo;if(e.theme||(e.theme={}),delete e.pubinfo.private,s.time){let e=parseInt(s.time);s.timems||(s.timems=1e3*e+""),s.humantime||(s.humantime=n.isoTime(e))}s.name&&(s.dirname=s.name.replace(/[^A-Za-z0-9_]/g,"-"),s.title=s.name),i&&(s.JSON=JSON.stringify(s,null,4).replace(/</g,"\\u003c"));let o=e.template;o=o.replace(/<!--\s*@include\s+(\S+)\s*-->/g,((t,n)=>"\x3c!-- include "+n+" --\x3e\n"+((e.theme.htmlDocIncludes||{})[n]||"")+"\n\x3c!-- end include --\x3e\n")),o=m(o,s),e.locale&&(o=y(o,e.locale).text);let a={html:o,theme:e.theme,filepath:e.filepath,versionPath:e.versionPath,ghEditURLs:e.ghEditURLs,params:s,TOC:e.TOC};h(a),r||(r=t.requireMarked());let l=new r.Renderer;f(l);const c=l.link;l.link=function(e,t,n){const r=new RegExp("^[/#]").test(e),i=r?"":"_blank";r&&a.versionPath&&(e=`/${a.versionPath}${e}`);return c.call(l,e,t,n).replace(/^<a /,`<a ${i?`target="${i}"`:""} rel="nofollow noopener" `)};let g=t.requireDOMSanitizer();r.setOptions({renderer:l,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!0,sanitizer:g,smartLists:!0,smartypants:!0});let b=e.markdown;e.repo&&(b+=`\n\`\`\`package\n${e.repo.name.replace(/^pxt-/,"")}=github:${e.repo.fullName}#${e.repo.tag||"master"}\n\`\`\`\n`),b=b.replace(/^\s*https?:\/\/(\S+)\s*$/gm,((e,t)=>{for(let e of d){let n=e.rx.exec(t);if(n)return e.cmd.replace(/\$(\d+)/g,((e,t)=>n[parseInt(t)]||""))+"\n"}return e})),b=b.replace(/@([a-z]+)@/gi,((t,r)=>{let i=s[r];return!i&&e.throwOnError&&n.userError(`unknown macro ${r}`),i||"unknown macro"}));let v=r(b);v=v.replace(/&lt;br\s*\/&gt;/gi,"<br/>"),v=v.replace(/(<img [^>]* src=")\/docs\/static\/([^">]+)"/g,((e,t,n)=>t+"/static/"+n+'"'));let T="",k=0;function E(e,t,n){let r=n;return e<=k&&(r=T+r,T="",k=0),r}if(v=v.replace(/<h(\d)[^>]+>\s*([~@])?\s*(.*?)<\/h\d>/g,((t,r,i,o)=>{let l=/^(\w+)\s+(.*)/.exec(o),c=l?l[1]:o,d=l?l[2]:"";if(d=u(d),c=u(c),r=parseInt(r),i){if("@"==i){let t=n.lookup(a.settings,c);if(null!=t)s[c]=d;else if(t=n.lookup(a.macros,c),null==t)return e.throwOnError&&n.userError(`Unknown command: @${c}`),p(`Unknown command: @${c}`);return E(r,0,_(t,{ARGS:d,CMD:c},["ARGS","CMD"]))}{if(!c){let e=T;return T="",e}let t=n.lookup(a.boxes,c);if(t){let e=t.split("@BODY@"),n=E(r,0,e[0].replace("@ARGS@",d));T=e[1];let i=t.match(/data-[^>\s]+/gi);return i&&i.indexOf("data-inferred")>=0&&(k=r),n}return e.throwOnError&&n.userError(`Unknown box: ~ ${c}`),p(`Unknown box: ~ ${c}`)}}return E(r,0,t)})),T&&(v+=T),!s.title){let e=/<h1[^<>]*>([^<>]+)<\/h1>/.exec(v);e&&(s.title=u(e[1]))}if(!s.description){let e=/<p>([^]+?)<\/p>/.exec(v);e&&(s.description=u(e[1]))}const x=/<div class="ui embed mdvid"[^<>]+?data-placeholder="([^"]+)"[^>]*\/?>/i.exec(v)||/<img class="ui [^"]*image" src="([^"]+)"[^>]*\/?>/i.exec(v);x&&(s.cardLogo=u(x[1])),s.twitter=u(e.theme.twitter||"@msmakecode");let S={main:""};v=v.replace(/<!-- BEGIN-ASIDE (\S+) -->([^]*?)<!-- END-ASIDE -->/g,((e,t,r)=>{let i=n.lookup(S,t);return S[t]=(i||"")+r,"\x3c!-- aside --\x3e"})),v=v.replace(/\n<\/code>/g,"</code>"),S.main=v,v="";for(let e of Object.keys(S))v+=(C=e+"-container",I=S[e],_(a.boxes[C]||"@BODY@",{BODY:I},["BODY"]));var C,I;s.body=v,s.name=s.title||"";for(let t of Object.keys(e.theme)){let n=e.theme[t];"string"==typeof n&&(s["theme_"+t]=n)}return a.finish()},t.embedUrl=function(e,t,n,r){return`<div style="position:relative;height:0;padding-bottom:70%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${`${e}#${t}:${n}`}" frameborder="0" sandbox="allow-popups allow-forms allow-scripts allow-same-origin"></iframe></div>`},t.runUrl=function(e,t,n){return`<div style="position:relative;height:0;padding-bottom:${t};overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${e}?id=${encodeURIComponent(n)}" allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe></div>`},t.codeEmbedUrl=function(e,t,n){const r=`${e}---codeembed#pub:${t}`;return`<div style="position:relative;height:calc(${n=Math.ceil(n||300)}px + 5em);width:100%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${r}" allowfullscreen="allowfullscreen" frameborder="0" sandbox="allow-scripts allow-same-origin"></iframe></div>`};const g={b:1,strong:1,em:1};function y(e,t){const r={};function i(e){let i=/^(\s*)([^]*?)(\s*)$/.exec(e),s=i[2].replace(/\s+/g," ");if(""==s||/^((IE=edge,.*|width=device-width.*|(https?:\/\/|\/)[\w@\/\.]+|@[\-\w]+@|\{[^\{\}]+\}|[^a-zA-Z]*|(&nbsp;)+)\s*)+$/.test(s))return null;let o=n.lookup(t,s);return o?s=o:r[s]="",i[1]+s+i[3]}function s(e){return e.replace(/&llt;/g,"<").replace(/&ggt;/g,">")}return{text:e=(e=(e=(e="<start>"+(e=e.replace(/<([\/\w]+)([^<>]*)>/g,((e,t,n)=>{let r=t.replace(/^\//,"").toLowerCase();return 1===g[r]?"&llt;"+t+n+"&ggt;":e})))).replace(/(<([\/\w]+)([^<>]*)>)([^<>]+)/g,((e,t,n,r,o)=>{if("script"==n||"style"==n)return s(e);let a=i(s(o));return null==a?s(e):t+a}))).replace(/(<[^<>]*)(content|placeholder|alt|title)="([^"]+)"/g,((e,t,n,r)=>null==i(r)?e:t+n+'="'+r.replace(/"/g,"''")+'"'))).replace(/^<start>/g,""),missing:r}}function b(e,t){if(e.id==t)return e;for(let n of e.children){let e=b(n,t);if(e)return e}return null}function v(e,t){let n=0,r=[{level:0,id:"",title:"",start:n,text:"",children:[]}],i=(e=e.replace(/\r/g,"")).split(/\n/),s={};for(let e of i){let i=/^\s*(#+)\s*(.*?)(#(\S+)\s*)?$/.exec(e),o=null;if(t&&i)if(i[4])if(s[i[4]])i=null;else{o=b(t,i[4]);let e=t=>{t.id&&(s[t.id]=!0),t.children.forEach(e)};o&&e(o)}else i=null;if(i){let s={level:t?1:i[1].length,title:i[2].trim(),id:i[4]||"",start:n,text:"",children:[]};if(o){e="";for(let t=0;t<o.level;++t)e+="#";e+=" ",e+=s.title||o.title,e+=" #"+s.id}for(;r[r.length-1].level>=s.level;)r.pop();r[r.length-1].children.push(s),r.push(s)}r[r.length-1].text+=e+"\n",n++}return r[0]}t.translate=y,t.buildTOC=function(n){if(!n)return null;const r=e.docs.requireMarked(),i=t.requireDOMSanitizer(),s={renderer:new r.Renderer,gfm:!0,tables:!1,breaks:!1,pedantic:!1,sanitize:!0,sanitizer:i,smartLists:!1,smartypants:!1};let o={name:"dummy",subitems:[]},a=[];a.push(o);let l=r.lexer(n,s),c=!1;l.forEach((e=>{switch(e.type){case"heading":e.depth;break;case"list_start":break;case"list_item_start":case"loose_item_start":c=!0;let t={name:"",path:"",subitems:[]};return void a.push(t);case"text":let n=a[a.length-1];e.text.indexOf("[")>=0?e.text.replace(/\[(.*?)\]\((.*?)\)/i,(function(e,t,r){n.name=t,n.path=r.replace(".md","")})):c&&(n.name=e.text);break;case"list_item_end":case"loose_item_end":let r=a.pop();a[a.length-1].subitems.push(r)}c=!1}));let u=o.subitems;return u&&0!=u.length?u:null},t.visitTOC=function(e,t){e.forEach((function(e){t(e),e.subitems&&e.subitems.forEach(t)}))};let T=!1;function k(e,t){if(T||function(){function e(e,t,n){let r=k(e,t).trim();if(r!=(n=n.trim()))throw console.log(`*** Template:\n${e}\n*** Input:\n${t}\n*** Expected:\n${n}\n*** Output:\n${r}`),new Error("augment docs test fail")}T=!0;let t="\n# T0\n## Examples #ex\n### Example 1\nTEx1\n### Example 2 #ex2\nTEx2\n### Example 3\nTEx3\n\n## See also #also\nTAlso\n",n="\n# @extends\n# #ex2\nMy example\n## See Also These! #also\nMy links\n",r="\n# T0\n## Examples #ex\n### Example 1\nTEx1\n### Example 2 #ex2\nMy example\n### Example 3\nTEx3\n\n## See Also These! #also\nMy links\n",i="\n# @extends\n### #ex\nFoo\n#### Example 1\nEx1\n#### Example 2x #ex2\nEx2\n## See Also These! #also\nMy links\n",s="\n# T0\n## Examples #ex\nFoo\n#### Example 1\nEx1\n#### Example 2x #ex2\nEx2\n## See Also These! #also\nMy links\n";e(t,"",t),e(t," ",t),e(t,n,r),e(t,i,s)}(),!t)return e;let r=v(e,null),i=v(t,r),s={},o={};for(let e of i.children)n.assert(0==e.children.length),n.assert(!!e.id),s[e.id]=e.text;let a=e=>{e.id&&void 0!==s[e.id]&&(o[e.id]=!0,e.text=s[e.id],e.children=[]),e.children.forEach(a)};a(r);let l="",c=e=>{l+=e.text,e.children.forEach(c)};c(r);let u="",d=i.text.replace(/^\s*#+\s*@extends.*/gm,"").replace(/^\s*\n/gm,"");d.trim()&&(u+=d.trim()+"\n");for(let e of i.children)o[e.id]||(u+=e.text);return u&&(l+="## Couldn't apply replacement logic to:\n"+u),l}t.augmentDocs=k}(e.docs||(e.docs={}))}(pxt||(pxt={})),function(e){!function(e){e.el=function(e,t,n){const r=document.createElement(e);return t&&Object.keys(t).forEach((e=>r.setAttribute(e,t[e]+""))),function e(t){Array.isArray(t)?t.forEach((t=>e(t))):"string"==typeof t?r.appendChild(document.createTextNode(t)):t instanceof HTMLElement&&r.appendChild(t)}(n),r}}(e.dom||(e.dom={}))}(pxt||(pxt={})),function(e){!function(t){function n(e){const t=/```package\s+((.|\s)+?)\s*```/i.exec(e);let n;return t&&(n={},t[1].split("\n").map((e=>e.replace(/\s*/g,""))).filter((e=>!!e)).map((e=>e.split("="))).forEach((e=>n[e[0]]=e[1]||"*"))),n}function r(e){const t=/```config\s+((.|\s)+?)\s*```/i.exec(e);let n=[];return t&&t[1].split("\n").map((e=>e.replace(/\s*/g,""))).filter((e=>!!e)).map((e=>e.split("="))).filter((e=>"feature"==e[0]&&!!e[1])).forEach((e=>n.push(e[1]))),n.length?n:void 0}function i(t){const n=/```jres\s+((.|\s)+?)\s*```/i.exec(t);if(n){const t=n[1],r=JSON.parse(t);return{jres:t,ts:e.emitTilemapsFromJRes(r)}}}function s(t){const n=/```assetjson\s+((.|\s)+?)\s*```/i.exec(t);return n?e.tutorial.parseAssetJson(n[1]):{}}function o(t){const n=/```simtheme\s+([\s\S]*?)```/i.exec(t);return n?e.tutorial.parseSimThemeJson(n[1]):{}}function a(t){let n=e.Util.jsonTryParse(t);return n&&!Array.isArray(n)&&(n=[n]),(null==n?void 0:n.length)?n:(n=t.split(/^---$/gm).filter((e=>!!e)).map((e=>{let t={};return e.replace(/^\s*(?:-|\*)\s+(\w+)\s*:\s*(.*)$/gm,((e,n,r)=>{if("flags"==n)t[n]=r.split(",");else if("otherAction"===n){const e=r.split(",").map((e=>null==e?void 0:e.trim()));(t.otherActions||(t.otherActions=[])).push({url:e[0],editor:e[1],cardType:e[2]})}else t[n]=r;return""})),!!Object.keys(t).length&&t})).filter((e=>!!e)),(null==n?void 0:n.length)?n:void 0)}function l(t){if(!t)return[];const n=[];let r,i=!1,s="";return t.split(/\r?\n/).forEach((t=>{if(/^## /.test(t))r=t.substr(2).trim();else if(/^(### ~ |```)codecard$/.test(t))i=!0;else if(/^(### ~|```)$/.test(t)){if(i=!1,r&&s){const t=a(s);(null==t?void 0:t.length)?n.push({name:r,cards:t}):e.log("invalid gallery format")}s="",r=void 0}else i&&(s+=t+"\n")})),n.forEach((t=>t.cards.forEach((t=>{if(t.otherActions&&!t.otherActions.length&&("tutorial"==t.cardType||"example"==t.cardType)){const n=["js"];e.appTarget.appTheme.python&&n.unshift("py"),t.otherActions=n.map((e=>({url:t.url,cardType:t.cardType,editor:e})))}})))),n}t.parsePackagesFromMarkdown=n,t.parseFeaturesFromMarkdown=r,t.parseJResFromMarkdown=i,t.parseTemplateProjectJSON=s,t.parseSimThemeJSON=o,t.parseExampleMarkdown=function(t,a){if(!a)return;const l=/```(blocks?|typescript|python|spy|sim)\s+((.|\s)+?)\s*```/i.exec(a);if(!l)return;const c=n(a),u=l[1],d=l[2],p=r(a),h=i(a),f=o(a),m={name:t,filesOverride:{[e.MAIN_BLOCKS]:'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',["python"===l[1]?e.MAIN_PY:e.MAIN_TS]:d},dependencies:c,features:p,snippetType:u,source:d,simTheme:f};return m.filesOverride=Object.assign(Object.assign({},m.filesOverride),s(a)),h&&(m.filesOverride[e.TILEMAP_JRES]=h.jres,m.filesOverride[e.TILEMAP_CODE]=h.ts),m},t.parseCodeCards=a,t.parseCodeCardsHtml=function(t){let n,r=[];return Array.from(t.children).forEach((e=>{"UL"===e.tagName||"OL"===e.tagName?(n||(n={}),Array.from(e.querySelectorAll("li")).forEach((e=>{const t=e.innerText,r=/^\s*(\w+)\s*:\s*(.*)$/.exec(t);if(r){const e=r[1];n[e]=r[2].trim(),"flags"===e&&(n[e]=n[e].split(/,\s*/))}}))):"HR"==e.tagName&&(n&&r.push(n),n=void 0)})),n&&r.push(n),0===r.length&&"CODE"===t.tagName&&(r=e.Util.jsonTryParse(t.textContent)),!!(null==r?void 0:r.length)&&r},t.parseGalleryMardown=l,t.loadGalleryAsync=function(t){return e.Cloud.markdownAsync(t).then((e=>l(e)))},t.codeCardsToMarkdown=function(e){return`### ~ codecard\n\n${(e||[]).map((e=>Object.keys(e).filter((t=>!!e[t])).map((t=>"otherActions"===t?e[t].map((e=>`* otherAction: ${e.url}, ${e.editor||""}, ${e.cardType||""}`)).join("\n"):`* ${t}: ${e[t]}`)).join("\n"))).join("\n\n---\n\n")}\n\n### ~\n`}}(e.gallery||(e.gallery={}))}(pxt||(pxt={})),function(e){e.GDBServer=class{constructor(t){this.io=t,this.q=new e.U.PromiseQueue,this.dataBuf="",this.numSent=0,this.pktSize=400,this.trace=!1,this.bmpMode=!0,this.targetInfo="",this.onEvent=e=>{},this.io.onData=e=>this.onData(e)}onData(t){for(this.dataBuf+=e.U.uint8ArrayToString(t);this.dataBuf.length>0;){let e=this.dataBuf[0];if("+"==e)this.dataBuf=this.dataBuf.slice(1);else if("$"==e||"%"==e){let t=this.decodeResp(this.dataBuf.slice(1));if(null==t)break;"$"==e?(this.io.sendPacketAsync(this.buildCmd("+")),this.onResponse?this.onResponse(t):this.numSent>0&&this.io.error("unexpected response: "+t)):this.onEvent(t)}else this.io.error("invalid character: "+e)}}buildCmd(t){if("+"==t)return e.U.stringToUint8Array(t);let n="";for(let e=0;e<t.length;++e){let r=t.charAt(e);"}"==r||"#"==r||"$"==r?(n+="}",n+=String.fromCharCode(32^r.charCodeAt(0))):n+=r}let r=0;t=n;for(let e=0;e<t.length;++e)r=r+t.charCodeAt(e)&255;return n="$"+t+"#"+("0"+r.toString(16)).slice(-2),e.U.stringToUint8Array(n)}decodeResp(e){let t="";for(let n=0;n<e.length;++n){let r=e[n];if("}"==r)++n,t+=String.fromCharCode(32^e.charCodeAt(n));else if("*"==r){++n;let r=e.charCodeAt(n)-29,i=t.charAt(t.length-1);for(;r-- >0;)t+=i}else{if("#"==r){return 2==e.slice(n+1,n+3).length?(this.dataBuf=e.slice(n+3),t):null}t+=r}}return null}sendCmdOKAsync(e){return this.sendCmdAsync(e,(e=>"OK"==e))}error(e){this.io.error(e),this.io.disconnectAsync()}sendCmdAsync(t,n){this.numSent++;const r=this.buildCmd(t);return this.q.enqueue("one",(()=>null===n?this.io.sendPacketAsync(r).then((()=>null)):new Promise((i=>{this.onResponse=r=>{this.onResponse=null,this.trace&&e.log(`GDB: '${t}' -> '${r}'`),void 0===n||n(r)||this.error(`Invalid GDB command response: '${t}' -> '${r}'`),i(r)},this.io.sendPacketAsync(r)}))))}sendRCmdAsync(t){return this.sendMCmdAsync("qRcmd,"+(n=t,e.U.toHex(e.U.stringToUint8Array(n))));var n}sendMCmdAsync(t){this.numSent++;const n=this.buildCmd(t);let r="";return this.q.enqueue("one",(()=>new Promise((i=>{this.onResponse=n=>{var s;"OK"!=n&&"O"==n[0]?r+=(s=n.slice(1),e.U.uint8ArrayToString(e.U.fromHex(s))):("OK"!=n&&(r+=" - "+n),this.onResponse=null,this.trace&&e.log(`Final GDB: '${t}' -> '${r}'`),i(r))},this.io.sendPacketAsync(n)}))))}write32Async(t,n){let r=new Uint8Array(4);return e.HF2.write32(r,0,n),this.writeMemAsync(t,r)}writeMemAsync(t,n){const r=this.pktSize/2-10;return e.U.assert(n.length<r),this.sendCmdOKAsync("M"+t.toString(16)+","+n.length.toString(16)+":"+e.U.toHex(n)).then((e=>{console.log(e)}))}readMemAsync(t,n){const r=this.pktSize/2-6;if(n>r){const i=new Uint8Array(n),s=o=>{const a=Math.min(n-o,r);return 0==a?Promise.resolve(i):this.readMemAsync(t+o,a).then((t=>(e.U.memcpy(i,o,t),s(o+a))))};return s(0)}return this.sendCmdAsync("m"+t.toString(16)+","+n.toString(16)).then((t=>e.U.fromHex(t)))}initBMPAsync(){return Promise.resolve().then((()=>this.sendRCmdAsync("swdp_scan"))).then((e=>(this.targetInfo=e,this.sendCmdAsync("vAttach;1",(e=>"T"==e[0]))))).then((()=>{}))}initAsync(){return e.U.delay(1e3).then((()=>this.sendCmdAsync("!"))).then((()=>this.sendCmdAsync("qSupported"))).then((t=>{let n={};return t=(t=";"+t+";").replace(/;([^;]+)[=:]([^:;]+)/g,((e,t,r)=>(n[t]=r,";"))),this.pktSize=parseInt(n.PacketSize)||1024,e.log("GDB-server caps: "+JSON.stringify(n)+" "+t.replace(/;+/g,";")),this.bmpMode?this.initBMPAsync():this.sendCmdAsync("c").then((()=>{}))}))}}}(pxt||(pxt={})),function(e){!function(t){function n(){var n,r;return!!t.forceProxy||!e.U.isNodeJS&&!(null===(r=null===(n=null==e?void 0:e.appTarget)||void 0===n?void 0:n.cloud)||void 0===r?void 0:r.noGithubProxy)}t.token=null,t.forceProxy=!1;const r={};function i(n){var r;return n.method=null!==(r=n.method)&&void 0!==r?r:"GET",function r(i){var s;const o=e.U.clone(n);t.token&&(o.headers||(o.headers={}),o.url==D?o.headers.Authorization=`bearer ${t.token}`:(o.url=e.BrowserUtils.cacheBustingUrl(o.url),o.headers.Authorization=`token ${t.token}`));return o.allowHttpErrors=null!==(s=o.allowHttpErrors)&&void 0!==s&&s,e.U.requestAsync(o).catch((n=>{if(e.tickEvent("github.error",{statusCode:n.statusCode}),t.handleGithubNetworkError){if(t.handleGithubNetworkError(o,n))return r(!1)}throw n}))}(t.token)}function s(e){return i({url:e,method:"GET"}).then((e=>e.json))}function o(t){return e.Cloud.apiRequestWithCdnAsync({url:"gh/"+t,forceLiveEndpoint:!0}).then((e=>e.json))}function a(t){e.log(`github proxy error: ${t.message}`),e.debug(t)}t.isOrgAsync=function(e){return i({url:`https://api.github.com/orgs/${e}`,method:"GET",allowHttpErrors:!0}).then((e=>200==e.statusCode))};class l{constructor(){this.latestVersions={},this.configs={},this.packages={}}proxyWithCdnLoadPackageAsync(t,n){const r=`${t}/${n}`;let i=this.packages[r];if(i)return e.debug(`github cache ${t}/${n}/text`),Promise.resolve(i);const s=S(t);return o(A(s.slug,n,s.fileName,"text")).then((e=>this.packages[r]={files:e}))}cacheConfig(t,n){const r=e.Package.parseAndValidConfig(n);return this.configs[t]=r,e.U.clone(r)}async loadConfigAsync(t,r){r||(e.debug("dep: default to master branch"),r="master");const i=`${t}/${r}`;let s=this.configs[i];if(s)return e.debug(`github cache ${t}/${r}/config`),e.U.clone(s);if(n())try{const n=await this.proxyWithCdnLoadPackageAsync(t,r);return this.cacheConfig(i,n.files[e.CONFIG_NAME])}catch(e){a(e)}const o=await u(t,r,e.CONFIG_NAME);return this.cacheConfig(i,o)}async latestVersionAsync(t,n){let r=this.latestVersions[t];return r||(e.debug(`dep: resolve latest version of ${t}`),this.latestVersions[t]=r=await e.github.latestVersionAsync(t,n,!0,!1)),r}async loadPackageAsync(t,r){if(r||(e.debug("load pkg: default to master branch"),r="master"),n())try{return await this.proxyWithCdnLoadPackageAsync(t,r).then((t=>e.U.clone(t)))}catch(e){a(e)}return await this.githubLoadPackageAsync(t,r)}githubLoadPackageAsync(t,n){return _(t,n).then((r=>{const i=`${t}/${r}`;let s=this.packages[i];return s?(e.debug(`github cache ${t}/${n}/text`),Promise.resolve(e.U.clone(s))):(e.log(`Downloading ${t}/${n} -> ${r}`),u(t,r,e.CONFIG_NAME).then((n=>{const s={files:{}};s.files[e.CONFIG_NAME]=n;const o=JSON.parse(n);return e.U.promiseMapAll(e.allPkgFiles(o).slice(1),(e=>u(t,r,e).then((t=>{s.files[e]=t})))).then((()=>(this.packages[i]=s,e.U.clone(s))))})))}))}}function c(t,n,s){return i({url:"https://api.github.com/repos/"+A(t.slug,"contents",t.fileName,s+"?ref="+n),method:"GET"}).then((n=>{const i=n.json;return r[t.slug]=!0,i&&"base64"==i.encoding&&null!=i.content?atob(i.content):e.U.httpGetTextAsync(i.download_url)}))}function u(t,n,i){const s=S(t);return r[s.slug]?c(s,n,i):e.U.requestAsync({url:"https://raw.githubusercontent.com/"+A(s.slug,n,s.fileName,i),allowHttpErrors:!0}).then((e=>200==e.statusCode?e.text:c(s,n,i)))}function d(e,t,n,r){return i({url:/^https:/.test(e)?e:"https://api.github.com/repos/"+e,headers:n,method:r||"POST",data:t,successCodes:[200,201,202,204]}).then((e=>e.json))}function p(e,t){let n=1;for(;e.refs[t+n];)n++;return t+n}async function h(e,t,n){return await d(e+"/git/refs",{ref:"refs/heads/"+t,sha:n}),t}function f(r,i="tags",o,a){const l=S(r),c=(u=o,!!t.forceProxy||!(t.token&&!u)&&n());var u;let d=null;const p=c?e.U.httpGetJsonAsync(e.BrowserUtils.cacheBustingUrl(`${e.Cloud.apiRoot}gh/${l.slug}/refs${a?"?nocache=1":""}`)).then((t=>{let n=Object.keys(t.refs).filter((t=>e.U.startsWith(t,"refs/"+i+"/"))).map((e=>({ref:e,object:{sha:t.refs[e]}})));return d=t.refs.HEAD,n})):s(`https://api.github.com/repos/${l.slug}/git/refs/${i}/?per_page=100`);let h=e=>e.replace(/^refs\/[^\/]+\//,"");return p.then((t=>{t.sort(((t,n)=>e.semver.strcmp(h(t.ref),h(n.ref))));let n={};for(let e of t)n[h(e.ref)]=e.object.sha;return{refs:n,head:d}}),(e=>404==e.statusCode?{refs:{}}:Promise.reject(e)))}function m(e){return"commit"==e.object.type?Promise.resolve(e.object.sha):"tag"==e.object.type?s(e.object.url).then((e=>"commit"==e.object.type?e.object.sha:Promise.reject(new Error("Bad type (2nd order) "+e.object.type)))):Promise.reject(new Error("Bad type "+e.object.type))}function _(e,t){if(/^[a-f0-9]{40}$/.test(t))return Promise.resolve(t);const n=S(e);return s(`https://api.github.com/repos/${n.slug}/git/refs/tags/${t}`).then(m,(e=>s(`https://api.github.com/repos/${n.slug}/git/refs/heads/${t}`).then(m)))}async function g(e,n,r){return n||(n=await t.db.latestVersionAsync(e,r)),await t.db.loadConfigAsync(e,n)}async function y(n,r){const i=S(n);if(!i)return void e.log("Unknown GitHub syntax");if(E(i,r))return e.tickEvent("github.download.banned"),void e.log("Github repo is banned");i.tag||(i.tag=await t.db.latestVersionAsync(i.slug,r));const s=await t.db.loadPackageAsync(i.fullName,i.tag),o=N(r,n);if(o){const t=e.Package.parseAndValidConfig(s.files[e.CONFIG_NAME]);t&&(e.log(`auto-disable ${o.join(",")} due to targetconfig entry for ${n}`),t.disablesVariants=o,s.files[e.CONFIG_NAME]=e.Package.stringifyConfig(t))}return s}let b;function v(t){return e.Cloud.cdnApiUrl(`gh/${t.fullName}/icon`)}function T(e,t){var n;if(!e)return;const r={owner:e.owner.login.toLowerCase(),slug:e.full_name.toLowerCase(),fullName:((null==t?void 0:t.fullName)||e.full_name).toLowerCase(),fileName:null===(n=null==t?void 0:t.fileName)||void 0===n?void 0:n.toLocaleLowerCase(),name:e.name,description:e.description,defaultBranch:e.default_branch,tag:null==t?void 0:t.tag,updatedAt:Math.round(new Date(e.updated_at).getTime()/1e3),fork:e.fork,private:e.private};return r.status=k(r,null==t?void 0:t.config),r}function k(e,t){return e?E(e,t)?b.Banned:function(e,t){var n,r;if(function(e,t){return!(!e||!t)&&!!(e.owner&&t.approvedOrgs&&t.approvedOrgs.some((t=>t.toLowerCase()==e.owner.toLowerCase())))}(e,t))return!0;const i=null===(n=null==e?void 0:e.fullName)||void 0===n?void 0:n.toLowerCase(),s=null===(r=null==e?void 0:e.slug)||void 0===r?void 0:r.toLowerCase();return!(!(null==t?void 0:t.approvedRepoLib)||!i&&!s)&&!(!t.approvedRepoLib[i]&&!t.approvedRepoLib[s])}(e,t)?b.Approved:b.Unknown:b.Unknown}function E(e,t){var n,r;if(function(e,t){return!(!t||e&&e.owner&&(!t.bannedOrgs||!t.bannedOrgs.some((t=>t.toLowerCase()==e.owner.toLowerCase()))))}(e,t))return!0;if(!t)return!1;if(!e)return!0;const i=null===(n=e.fullName)||void 0===n?void 0:n.toLowerCase(),s=null===(r=e.slug)||void 0===r?void 0:r.toLowerCase();return!(!t.bannedRepos||!t.bannedRepos.some((e=>e&&(e.toLowerCase()==i||e.toLowerCase()==s))))}async function x(t,r){const i=S(t);if(!i)return;const l=k(i,r);if(l==b.Banned)return;if(n())try{return await function(t,n){return o(t.slug).then((e=>{if(e)return{github:!0,owner:t.owner,fullName:t.fullName,fileName:t.fileName,slug:t.slug,name:t.fileName?`${e.name}-${t.fileName}`:e.name,description:e.description,defaultBranch:e.defaultBranch||"master",tag:t.tag,status:n}})).catch((t=>{e.reportException(t)}))}(i,l)}catch(e){a(e)}return T(await s("https://api.github.com/repos/"+i.slug),{config:r,fullName:i.fullName,fileName:i.fileName,tag:i.tag})}function S(e){if(!e)return;e=(e=e.trim()).replace(/\/$/,"");const t=/^https:\/\/([^./#]+)\.github\.io\/([^/#]+)\/?$/i.exec(e);t&&(e=`github:${t[1]}/${t[2]}`),e=(e=(e=e.replace(/^github:/i,"")).replace(/^https:\/\/github\.com\//i,"")).replace(/\.git\b/i,"");const n=/^([^#\/:]+)\/([^#\/:]+)(\/([^#]+))?(#([^\/:]*))?$/.exec(e);if(!n)return;const r=n[1],i=n[2];let s=n[4];const o=n[6],a=s&&/^tree\/([^\/]+\/)/.exec(s);return a&&(s=s.slice(a[0].length)),{owner:r,project:i,slug:A(r,i),fullName:A(r,i,s),tag:o,fileName:s}}function C(e){return!!e&&"github:"==e.slice(0,7)}function I(e,t=!1){return e?"github:"+(t?e.fullName:e.fullName.toLowerCase())+(e.tag?`#${e.tag}`:""):void 0}function A(...e){return e.filter((e=>!!e)).join("/")}function w(t,n){var r;if(!t)return null;const i=S(n);if(!i)return null;t.approvedRepoLib;return t.approvedRepoLib&&(null===(r=e.U.lookup(t.approvedRepoLib,i.slug.toLowerCase()))||void 0===r?void 0:r.upgrades)}function N(e,t){const n=w(e,t)||[];if(!n)return null;for(const e of n){const t=/^dv:(.*)/.exec(e);if(t){const e=t[1].split(/,/);return e.some((e=>!/^\w+$/.test(e)))?null:e}}return null}t.MemoryGithubDb=l,t.downloadTextAsync=u,t.db=new l,t.authenticatedUserAsync=function(){return t.token?s("https://api.github.com/user"):Promise.resolve(void 0)},t.getCommitsAsync=function(e,t){return s("https://api.github.com/repos/"+S(e).slug+"/commits?sha="+t).then((e=>e.map((e=>{const t=e.commit;return t.url=e.url,t.sha=e.sha,t}))))},t.getCommitAsync=function(e,t){return s("https://api.github.com/repos/"+S(e).slug+"/git/commits/"+t).then((e=>s(e.tree.url+"?recursive=1").then((t=>(e.tree=t,e)))))},t.createObjectAsync=function(e,t,n){return d(S(e).slug+"/git/"+t+"s",n).then((e=>e.sha))},t.postCommitComment=function(e,t,n,r,i){return d(`${S(e).slug}/commits/${t}/comments`,{body:n,path:r,position:i}).then((e=>e.id))},t.fastForwardAsync=async function(e,t,n){const r=S(e);return 200==(await i({url:`https://api.github.com/repos/${r.slug}/git/refs/heads/${t}`,method:"PATCH",allowHttpErrors:!0,data:{sha:n,force:!1}})).statusCode},t.putFileAsync=async function(t,n,r){const s=S(t);await i({url:`https://api.github.com/repos/${e.github.join(s.slug,"contents",s.fileName,n)}`,method:"PUT",allowHttpErrors:!0,data:{message:lf("Initialize empty repo"),content:btoa(e.U.toUTF8(r)),branch:"master"},successCodes:[201]})},t.createTagAsync=async function(e,t,n){await d(e+"/git/refs",{ref:"refs/tags/"+t,sha:n})},t.createReleaseAsync=async function(e,t,n){await d(e+"/releases",{tag_name:t,target_commitish:n,name:t,draft:!1,prerelease:!1})},t.createPRFromBranchAsync=async function(e,t,n,r,i){const s=await d(e+"/pulls",{title:r,body:i||lf("Automatically created from MakeCode."),head:n,base:t,maintainer_can_modify:!0});return null==s?void 0:s.html_url},t.mergeAsync=function(t,n,r,s){return i({url:`https://api.github.com/repos/${S(t).slug}/merges`,method:"POST",successCodes:[201,204,409],data:{base:n,head:r,commit_message:s}}).then((n=>{if(201==n.statusCode||204==n.statusCode)return n.json.sha;if(409==n.statusCode)return null;throw e.U.userError(lf("Cannot merge in github.com/{1}; code: {2}",t,n.statusCode))}))},t.getRefAsync=function(e,t){return s("https://api.github.com/repos/"+e+"/git/refs/heads/"+(t=t||"master")).then(m).catch((e=>{404!=e.statusCode&&Promise.reject(e)}))},t.getNewBranchNameAsync=async function(e,t="patch-"){return p(await f(e,"heads"),t)},t.createNewBranchAsync=h,t.forkRepoAsync=async function(t,n,r="pr-"){const i=S(t),s=T(await d(`${i.slug}/forks`,{}),{fullName:i.fullName,fileName:i.fileName}),o=Date.now()+3e5;let a=null;for(;!a&&Date.now()<o;){await e.U.delay(1e3);try{a=await f(s.slug,"heads")}catch(e){}}if(!a)throw new Error(lf("Timeout waiting for fork"));const l=p(a,r);return await h(s.slug,l,n),s.fullName+"#"+l},t.listRefsAsync=function(e,t="tags",n,r){return f(e,t,n,r).then((e=>Object.keys(e.refs)))},t.listRefsExtAsync=f,t.pkgConfigAsync=g,t.downloadPackageAsync=y,t.downloadLatestPackageAsync=async function(t,n,r){const i=await e.packagesConfigAsync(),s=await e.github.latestVersionAsync(t.slug,i,n,r),o=`${t.fullName}#${s}`;return await e.github.downloadPackageAsync(o,i),{version:`github:${o}`,config:await g(t.fullName,s,i)}},t.cacheProjectDependenciesAsync=async function(t){var n;const r=null===(n=Object.keys(t.dependencies))||void 0===n?void 0:n.filter((e=>C(t.dependencies[e])));if(r.length){const n=await e.packagesConfigAsync();await Promise.all(r.map((async e=>{const r=t.dependencies[e];if(!await y(r,n))throw new Error(lf("Cannot load extension {0} from {1}",e,r))})))}},function(e){e[e.Unknown=0]="Unknown",e[e.Approved=1]="Approved",e[e.Banned=2]="Banned"}(b=t.GitRepoStatus||(t.GitRepoStatus={})),t.isDefaultBranch=function(e,t){return t&&t.defaultBranch?e===t.defaultBranch:/^(main|master)$/.test(e)},t.listUserReposAsync=function(){return O('{\n  viewer {\n    repositories(first: 100, affiliations: [OWNER, COLLABORATOR], orderBy: {field: PUSHED_AT, direction: DESC}) {\n      nodes {\n        name\n        description\n        full_name: nameWithOwner\n        private: isPrivate\n        fork: isFork\n        updated_at: updatedAt\n        owner {\n          login\n        }\n        defaultBranchRef {\n          name\n        }\n        pxtjson: object(expression: "HEAD:pxt.json") {\n          ... on Blob {\n            text\n          }\n        }\n        readme: object(expression: "HEAD:README.md") {\n          ... on Blob {\n            text\n          }\n        }\n      }\n    }\n  }\n}').then((t=>t.data.viewer.repositories.nodes.filter((e=>e.pxtjson)).filter((t=>{t.default_branch=t.defaultBranchRef.name;const n=e.Package.parseAndValidConfig(t.pxtjson&&t.pxtjson.text),r=t.readme&&t.readme.text;return!!n&&(n.supportedTargets?n.supportedTargets.indexOf(e.appTarget.id)>-1:r&&r.indexOf("PXT/"+e.appTarget.id)>-1)})).map((e=>T(e,{fullName:e.full_name})))))},t.createRepoAsync=function(e,t,n){return d("https://api.github.com/user/repos",{name:e,description:t,private:!!n,has_issues:!0,has_projects:!1,has_wiki:!1,allow_rebase_merge:!1,allow_merge_commit:!0,delete_branch_on_merge:!1}).then((e=>T(e)))},t.enablePagesAsync=async function(t){const n=S(t);let r;try{const e=await s(`https://api.github.com/repos/${n.slug}/pages`);e&&(r=e.html_url)}catch(e){}if(!r)try{r=(await d(`https://api.github.com/repos/${n.slug}/pages`,{source:{branch:"master",path:"/"}},{Accept:"application/vnd.github.switcheroo-preview+json"})).html_url}catch(t){e.tickEvent("github.pages.error"),e.reportException(t)}if(r){const n=await s(`https://api.github.com/repos/${t}`);if(n&&!n.homepage)try{await d(`https://api.github.com/repos/${t}`,{homepage:r},void 0,"PATCH")}catch(t){e.tickEvent("github.homepage.error")}}},t.repoIconUrl=function(e){if(e.status==b.Approved)return v(e)},t.mkRepoIconUrl=v,t.repoStatus=k,t.repoAsync=x,t.searchAsync=function(t,n){if(!n)return Promise.resolve([]);let r=t.split("|").map(S).filter((e=>!!e));return r.length>0?Promise.all(r.map((e=>x(e.fullName,n)))).then((e=>e.filter((e=>e&&e.status!=b.Banned)))):e.U.httpGetJsonAsync(`${e.Cloud.apiRoot}ghsearch/${e.appTarget.id}/${e.appTarget.platformid||e.appTarget.id}?q=${encodeURIComponent(t)}`).then((t=>t.items.map((e=>T(e,{config:n,fullName:e.full_name}))).filter((e=>e.status==b.Approved||n.allowUnapproved&&e.status==b.Unknown)).filter((t=>!e.appTarget.appTheme.githubUrl||`https://github.com/${t.fullName}`!=e.appTarget.appTheme.githubUrl.toLowerCase())))).catch((e=>[]))},t.parseRepoId=S,t.toGithubDependencyPath=function(e,t){let n="github:"+e;return t&&(n+="#"+t),n},t.isGithubId=C,t.stringifyRepo=I,t.normalizeRepoId=function(e,t){const n=S(e);if(n)return!n.tag&&t&&(n.tag=t),I(n)},t.join=A,t.upgradedPackageReference=function(t,n){const r=w(t,n);if(!r)return null;for(const i of r){const r=/^min:(.*)/.exec(i),s=r&&e.semver.tryParse(r[1]);if(s){const t=S(n),i=e.semver.tryParse(t.tag);return i&&e.semver.cmp(i,s)<0?(t.tag=r[1],e.debug(`upgrading ${n} to ${r[1]}`),I(t)):(i||e.log(`not upgrading ${n} - cannot parse version`),null)}N(t,n)||e.log(`invalid upgrade rule: ${n} -> ${i}`)}return n},t.upgradedPackageId=function(e,t){const n=N(e,t);return n?t+"?dv="+n.join(","):t},t.latestVersionAsync=function(t,n,r,i){const s=S(t);return s?x(s.slug,n).then((t=>{if(t)return f(t.slug,"tags",r,i).then((r=>{let i=Object.keys(r.refs);i=e.semver.sortLatestTags(i);const o=e.appTarget.versions&&e.semver.tryParse(e.appTarget.versions.target);if(o&&n.releases&&n.releases["v"+o.major]){const r=n.releases["v"+o.major].map((t=>e.github.parseRepoId(t))).filter((e=>e&&e.fullName.toLowerCase()==s.fullName.toLowerCase()))[0];if(r){if(i.some((e=>e==r.tag)))return e.debug(`approved release ${r.fullName}#${r.tag} for v${o.major}`),Promise.resolve(r.tag);e.reportError("packages",`approved release ${r.fullName}#${r.tag} for v${o.major} not found anymore`,{repo:t.fullName})}}return i[0]?Promise.resolve(i[0]):r.head||_(t.slug,t.defaultBranch)}))})):Promise.resolve(null)},t.resolveMonoRepoVersions=function(n){n=e.Util.clone(n);const r={};return Object.keys(n).map((e=>({id:e,ghid:t.parseRepoId(n[e])}))).filter((e=>{var t;return null===(t=e.ghid)||void 0===t?void 0:t.tag})).forEach((t=>{const{id:n,ghid:i}=t;let s=r[i.slug];s||(s=r[i.slug]={tag:i.tag,deps:[]}),s.deps.push(t),e.semver.strcmp(s.tag,i.tag)<0&&(e.debug(`dep: resolve later monorepo tag to ${e.github.stringifyRepo(i)}`),s.tag=i.tag)})),e.U.values(r).forEach((t=>t.deps.forEach((r=>{r.ghid.tag!==t.tag&&(e.debug(`dep: ${e.github.stringifyRepo(r.ghid)} -> ${t.tag}`),r.ghid.tag=t.tag,n[r.id]=e.github.stringifyRepo(r.ghid))})))),n},t.GIT_JSON=".git.json";const D="https://api.github.com/graphql";function O(e){const t=JSON.stringify({query:e});return d(D,t)}t.lookupFile=function(e,t,n){if(!t)return null;const r=A(e.fileName,n);return t.tree.tree.find((e=>e.path==r))},t.ghGraphQLQueryAsync=O,t.findPRNumberforBranchAsync=function(e,t){const n=S(e);return O(`\n{\n    repository(owner: ${JSON.stringify(n.owner)}, name: ${JSON.stringify(n.project)}) {\n        pullRequests(last: 1, states: [OPEN, MERGED], headRefName: ${JSON.stringify(t)}) {\n            edges {\n                node {\n                    number\n                    state\n                    mergeable\n                    baseRefName\n                    url\n                    isDraft\n                }\n            }\n        }\n    }\n}\n`).then((e=>{const t=e.data.repository.pullRequests.edges[0];if(t&&t.node){const e=t.node;return{number:e.number,mergeable:e.mergeable,state:e.state,title:e.title,url:e.url,base:e.baseRefName}}return{number:-1}}))},t.getPagesStatusAsync=function(e){return s(`https://api.github.com/repos/${e}/pages`).catch((e=>({status:null})))}}(e.github||(e.github={}))}(pxt||(pxt={})),function(e){let t;e.REFCNT_FLASH="0xfffe",e.VTABLE_MAGIC=249,e.ValTypeObject=4,function(e){e[e.BoxedString=1]="BoxedString",e[e.BoxedNumber=2]="BoxedNumber",e[e.BoxedBuffer=3]="BoxedBuffer",e[e.RefAction=4]="RefAction",e[e.RefImage=5]="RefImage",e[e.RefCollection=6]="RefCollection",e[e.RefRefLocal=7]="RefRefLocal",e[e.RefMap=8]="RefMap",e[e.RefMImage=9]="RefMImage",e[e.MMap=10]="MMap",e[e.BoxedString_SkipList=11]="BoxedString_SkipList",e[e.BoxedString_ASCII=12]="BoxedString_ASCII",e[e.ZPin=13]="ZPin",e[e.User0=16]="User0"}(t=e.BuiltInType||(e.BuiltInType={}))}(pxt||(pxt={})),function(e){!function(t){function n(e,t,n){e[t+0]=n>>0&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255}function r(e,t,n){e[t+0]=n>>0&255,e[t+1]=n>>8&255}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return e[t]|e[t+1]<<8}function o(e){let t=new Uint8Array(4*e.length);for(let r=0;r<e.length;++r)n(t,4*r,e[r]);return t}t.HF2_CMD_BININFO=1,t.HF2_MODE_BOOTLOADER=1,t.HF2_MODE_USERSPACE=2,t.HF2_CMD_INFO=2,t.HF2_CMD_RESET_INTO_APP=3,t.HF2_CMD_RESET_INTO_BOOTLOADER=4,t.HF2_CMD_START_FLASH=5,t.HF2_CMD_WRITE_FLASH_PAGE=6,t.HF2_CMD_CHKSUM_PAGES=7,t.HF2_CMD_READ_WORDS=8,t.HF2_CMD_WRITE_WORDS=9,t.HF2_CMD_DMESG=16,t.HF2_FLAG_SERIAL_OUT=128,t.HF2_FLAG_SERIAL_ERR=192,t.HF2_FLAG_CMDPKT_LAST=64,t.HF2_FLAG_CMDPKT_BODY=0,t.HF2_FLAG_MASK=192,t.HF2_SIZE_MASK=63,t.HF2_STATUS_OK=0,t.HF2_STATUS_INVALID_CMD=1,t.HF2_STATUS_EXEC_ERR=2,t.HF2_STATUS_EVENT=128,t.HF2_CMD_JDS_CONFIG=32,t.HF2_CMD_JDS_SEND=33,t.HF2_EV_JDS_PACKET=8388640,t.CUSTOM_EV_JACDAC="jacdac",t.HF2_EV_MASK=8388608,t.write32=n,t.write16=r,t.read32=i,t.read16=s,t.encodeU32LE=o,t.decodeU32LE=function(e){let t=[];for(let n=0;n<e.length;n+=4)t.push(i(e,n));return t};let a=!1;function l(t){a?e.log("HF2: "+t):e.debug("HF2: "+t)}t.enableLog=function(){a=!0};class c{constructor(n){var r;this.io=n,this.initialized=!1,this.cmdSeq=e.U.randomUint32(),this.lock=new e.U.PromiseQueue,this.flashing=!1,this.rawMode=!1,this.maxMsgSize=63,this.bootloaderMode=!1,this.reconnectTries=0,this.autoReconnect=!1,this.icon=(null===(r=e.appTarget.appTheme.downloadDialogTheme)||void 0===r?void 0:r.deviceIcon)||"usb",this.msgs=new e.U.PromiseBuffer,this.eventHandlers={},this.jacdacAvailable=!1,this.onSerial=(e,t)=>{},this.onCustomEvent=(e,t)=>{},this.onConnectionChanged=()=>{};let s=[];n.onDeviceConnectionChanged=e=>this.disconnectAsync().then((()=>e&&this.reconnectAsync())),n.onSerial=(e,t)=>this.onSerial(e,t),n.onData=r=>{let i=r[0]&t.HF2_FLAG_MASK,o=63&r[0],a=new Uint8Array(o);if(e.U.memcpy(a,0,r,1,o),i&t.HF2_FLAG_SERIAL_OUT)this.onSerial(a,i==t.HF2_FLAG_SERIAL_ERR);else if(s.push(a),i!=t.HF2_FLAG_CMDPKT_BODY){e.U.assert(i==t.HF2_FLAG_CMDPKT_LAST);let r=0;for(let e of s)r+=e.length;let o=new Uint8Array(r),a=0;for(let t of s)e.U.memcpy(o,a,t),a+=t.length;s=[],o[2]&t.HF2_STATUS_EVENT?n.onEvent(o):this.msgs.push(o)}},n.onEvent=t=>{let n=i(t,0),r=e.U.lookup(this.eventHandlers,n+"");r?r(t.slice(4)):l("unhandled event: "+n.toString(16))},n.onError=e=>{l("recv error: "+e.message),this.autoReconnect&&(this.autoReconnect=!1,this.reconnectAsync().then((()=>{this.autoReconnect=!0}),(e=>{l("reconnect error: "+e.message)})))},this.onEvent(t.HF2_EV_JDS_PACKET,(e=>{this.onCustomEvent(t.CUSTOM_EV_JACDAC,e)}))}resetState(){this.initialized=!1,this.lock=new e.U.PromiseQueue,this.info=null,this.infoRaw=null,this.pageSize=null,this.flashSize=null,this.maxMsgSize=63,this.bootloaderMode=!1,this.msgs.drain()}onEvent(n,r){e.U.assert(!!(n&t.HF2_EV_MASK)),this.eventHandlers[n+""]=r}sendCustomEventAsync(e,n){return e==t.CUSTOM_EV_JACDAC?this.jacdacAvailable?this.talkAsync(t.HF2_CMD_JDS_SEND,n).then((()=>{})):Promise.resolve():Promise.reject(new Error("invalid custom event type"))}isConnected(){return this.io.isConnected()&&this.initialized}isConnecting(){return this.io.isConnecting()||this.io.isConnected()&&!this.initialized}reconnectAsync(){return this.resetState(),l(`reconnect raw=${this.rawMode}`),this.io.reconnectAsync().then((()=>this.initAsync())).catch((t=>{if(this.reconnectTries<5)return this.reconnectTries++,l(`error ${t.message}; reconnecting attempt #${this.reconnectTries}`),e.U.delay(500).then((()=>this.reconnectAsync()));throw t}))}disconnectAsync(){return l("disconnect"),this.io.disconnectAsync()}error(e){return this.io.error(e)}talkAsync(i,o){if(this.io.talksAsync)return this.io.talksAsync([{cmd:i,data:o}]).then((e=>e[0]));let a=8;o&&(a+=o.length);let c=new Uint8Array(a),u=65535&++this.cmdSeq;n(c,0,i),r(c,4,u),r(c,6,0),o&&e.U.memcpy(c,8,o,0,o.length);let d=0,p=()=>this.msgs.shiftAsync(1e3).then((e=>{if(s(e,0)!=u){if(d<3)return d++,l(`message out of sync, (${u} vs ${s(e,0)}); will re-try`),p();this.error("out of sync")}let n="";switch(e[3]&&(n="; info="+e[3]),e[2]){case t.HF2_STATUS_OK:return e.slice(4);case t.HF2_STATUS_INVALID_CMD:this.error("invalid command"+n);break;case t.HF2_STATUS_EXEC_ERR:this.error("execution error"+n);break;default:this.error("error "+e[2]+n)}return null}));return this.sendMsgAsync(c).then(p)}sendMsgAsync(e){return this.sendMsgCoreAsync(e)}sendSerialAsync(e,t=!1){return this.io.sendSerialAsync?this.io.sendSerialAsync(e,t):this.sendMsgCoreAsync(e,t?2:1)}sendMsgCoreAsync(e,n=0){let r=new Uint8Array(64),i=s=>{let o=e.length-s;if(o<=0)return Promise.resolve();o>63?(o=63,r[0]=t.HF2_FLAG_CMDPKT_BODY):r[0]=t.HF2_FLAG_CMDPKT_LAST,n&&(r[0]=1==n?t.HF2_FLAG_SERIAL_OUT:t.HF2_FLAG_SERIAL_ERR),r[0]|=o;for(let t=0;t<o;++t)r[t+1]=e[s+t];return this.io.sendPacketAsync(r).then((()=>i(s+o)))};return this.lock.enqueue("out",(()=>i(0)))}switchToBootloaderAsync(){return this.bootloaderMode?Promise.resolve():(l("Switching into bootloader mode"),this.io.isSwitchingToBootloader&&this.io.isSwitchingToBootloader(),this.maybeReconnectAsync().then((()=>this.talkAsync(t.HF2_CMD_START_FLASH).then((()=>{}),(e=>this.talkAsync(t.HF2_CMD_RESET_INTO_BOOTLOADER).then((()=>{}),(e=>{})).then((()=>this.reconnectAsync().catch((e=>{throw"devicenotfound"===e.type&&(e.type="repairbootloader"),e})))))))).then((()=>this.initAsync())).then((()=>{this.bootloaderMode||this.error("cannot switch into bootloader mode")})))}isFlashing(){return!!this.flashing}reflashAsync(t){l("reflash"),e.U.assert(e.appTarget.compile.useUF2);const n=t.outfiles[pxtc.BINARY_UF2],r=pxtc.UF2.parseFile(e.Util.stringToUint8Array(atob(n)));return this.flashing=!0,this.io.reconnectAsync().then((()=>this.flashAsync(r))).then((()=>e.U.delay(100))).finally((()=>this.flashing=!1)).then((()=>this.reconnectAsync()))}writeWordsAsync(n,r){return e.U.assert(r.length<=64),this.talkAsync(t.HF2_CMD_WRITE_WORDS,o([n,r.length].concat(r))).then((()=>{}))}readWordsAsync(r,i){let s=new Uint8Array(8);return n(s,0,r),n(s,4,i),e.U.assert(i<=64),this.talkAsync(t.HF2_CMD_READ_WORDS,s)}pingAsync(){return this.rawMode?Promise.resolve():this.talkAsync(t.HF2_CMD_BININFO).then((e=>{}))}maybeReconnectAsync(){return this.pingAsync().catch((e=>this.reconnectAsync().then((()=>this.pingAsync()))))}flashAsync(r){let i=Date.now(),s=0,o=i=>{if(i>=r.length)return Promise.resolve();let s=r[i],a=new Uint8Array(4+s.payloadSize);return n(a,0,s.targetAddr),e.U.memcpy(a,4,s.data,0,s.payloadSize),this.talkAsync(t.HF2_CMD_WRITE_FLASH_PAGE,a).then((()=>o(i+1)))};return this.switchToBootloaderAsync().then((()=>{let e=256*r.length;return l(`Starting flash (${Math.round(e/1024)}kB).`),s=Date.now(),this.pageSize>16384?r:u(r,((e,t)=>this.readWordsAsync(e,t)))})).then((e=>{if(e.length!=r.length){let t=256*(r=e).length;l(`Performing partial flash (${Math.round(t/1024)}kB).`)}})).then((()=>o(0))).then((()=>{let e=Date.now(),t=e-i,n=e-s;l(`Flashing done at ${Math.round(256*r.length/n*1e3/1024)} kB/s in ${t}ms (reset ${t-n}ms). Resetting.`)})).then((()=>this.talkAsync(t.HF2_CMD_RESET_INTO_APP).catch((e=>{})))).then((()=>{}))}initAsync(){return this.rawMode?(this.initialized=!0,Promise.resolve()):Promise.resolve().then((()=>this.talkAsync(t.HF2_CMD_BININFO))).then((e=>(this.bootloaderMode=e[0]==t.HF2_MODE_BOOTLOADER,this.pageSize=i(e,4),this.flashSize=i(e,8)*this.pageSize,this.maxMsgSize=i(e,12),this.familyID=i(e,16),l(`Connected; msgSize ${this.maxMsgSize}B; flash ${this.flashSize/1024}kB; ${this.bootloaderMode?"bootloader":"application"} mode; family=0x${this.familyID.toString(16)}`),this.talkAsync(t.HF2_CMD_INFO)))).then((t=>{this.infoRaw=e.Util.fromUTF8Array(t),e.debug("Info: "+this.infoRaw);let n={};("Header: "+this.infoRaw).replace(/^([\w\-]+):\s*([^\n\r]*)/gm,((e,t,r)=>(n[t.replace(/-/g,"")]=r,""))),this.info=n;let r=/v(\d\S+)(\s+(\S+))?/.exec(this.info.Header);this.info.Parsed=r?{Version:r[1],Features:r[3]||""}:{Version:"?",Features:""},l(`Board-ID: ${this.info.BoardID} v${this.info.Parsed.Version} f${this.info.Parsed.Features}`)})).then((()=>this.talkAsync(t.HF2_CMD_JDS_CONFIG,new Uint8Array([1])).then((()=>{this.jacdacAvailable=!0}),(e=>{this.jacdacAvailable=!1})))).then((()=>{this.reconnectTries=0,this.initialized=!0,this.io.onConnectionChanged()}))}}function u(t,n){if(!e.appTarget.compile.flashChecksumAddr)return Promise.resolve(t);let r=pxtc.UF2.readBytes(t,e.appTarget.compile.flashChecksumAddr,48),s=pxtc.parseChecksumBlock(r);return s?function(t){return e.appTarget.compile.flashChecksumAddr?t(e.appTarget.compile.flashChecksumAddr,12).then((n=>{let r=pxtc.parseChecksumBlock(n);return r?t(r.endMarkerPos,1).then((t=>i(t,0)!=r.endMarker?(e.log("end-marker mismatch"),null):r)):null})):Promise.resolve(null)}(n).then((e=>{if(!e)return t;let n=e.regions.filter((e=>s.regions.some((t=>e.checksum==t.checksum&&e.length==t.length&&e.start==t.start))));if(0==n.length)return t;l("skipping flash at: "+n.map((e=>`${pxtc.assembler.tohex(e.start)} (${e.length/1024}kB)`)).join(", "));let r=e=>n.some((t=>t.start<=e&&e<t.start+t.length));return t.filter((e=>!(r(e.targetAddr)&&r(e.targetAddr+e.payloadSize-1))))})):Promise.resolve(t)}t.Wrapper=c,t.mkHF2PacketIOWrapper=function(t){return e.debug("packetio: wrapper hf2"),new c(t)},t.onlyChangedBlocksAsync=u}(e.HF2||(e.HF2={}))}(pxt||(pxt={})),function(e){!function(t){var n=e.Util,r=e.HF2;const i=r.read32;let s,o,a,l,c,u,d,p,h=!1;function f(e){return e<<2|2}function m(e){return 1&e?e>>1:0!=e?2&e?e==t.taggedNull?null:e!=t.taggedFalse&&(e==t.taggedTrue||{tagged:e>>2}):{ptr:e}:void 0}function _(e,t){if(n.assert(!(3&e)),n.assert(e>=0),e<2097152){let r=new Uint8Array(t);return e-=d.start,n.memcpy(r,0,d.buf,e,t),Promise.resolve(r)}let r=p.maxMsgSize-32;if(t>r){let i=[];for(;t>0;){let n=Math.min(r,t);i.push(_(e,n)),t-=n,e+=n}return Promise.all(i).then(n.uint8ArrayConcat)}return p.readWordsAsync(e,Math.ceil(t/4)).then((e=>e.length>t?e.slice(0,t):e))}function g(t){if("object"!=typeof t||!t)return Promise.resolve(t);if("number"==typeof t.ptr){if(3&t.ptr)return Promise.resolve({unalignedPtr:t.ptr});let i=0;return _(t.ptr,56).then((s=>{i=r.read16(s,2);let o=s.length;return i==e.BuiltInType.BoxedString||i==e.BuiltInType.BoxedBuffer?o=r.read16(s,4)+6:i==e.BuiltInType.BoxedNumber&&(o=12),o>s.length?_(t.ptr+s.length,o-s.length).then((e=>n.uint8ArrayConcat([s,e]))):o<s.length?s.slice(0,o):s})).then((t=>i==e.BuiltInType.BoxedString?n.uint8ArrayToString(t.slice(6)):i==e.BuiltInType.BoxedBuffer?{type:"buffer",data:t.slice(6)}:i==e.BuiltInType.BoxedNumber?new Float64Array(t.buffer.slice(4))[0]:{type:"unknown",tag:i,refcnt:r.read16(t,0),data:t.slice(4)}))}return Promise.resolve(t)}function y(e){let t=[];for(let n of Object.keys(e))t.push(g(e[n]).then((t=>{e[n]=t})));return Promise.all(t).then((()=>{}))}function b(e){let t=s.breakpoints,n=t[0],r=1/0;for(let i of t){let t=e-i.binAddr;t>=0&&t<r&&(r=t,n=i)}return n}function v(e){if(h)return Promise.resolve();let i;return h=!0,x().then((t=>{let o=r.decodeU32LE(e)[0],l={};for(let e of s.procDebugInfo[0].locals){let i=t.globals,s=(()=>{switch(e.type){case"uint32":return r.read32(i,e.index);case"int32":return 0|r.read32(i,e.index);case"uint16":return r.read16(i,e.index);case"int16":return r.read16(i,e.index)<<16>>16;case"uint8":return i[e.index];case"int8":return i[e.index]<<24>>24;default:return null}})();null===s&&(n.assert(0==(3&e.index)),s=m(r.read32(i,e.index))),l[e.name]=s}return c=b(o),i={type:"debugger",subtype:"breakpoint",breakpointId:c.id,globals:l,stackframes:[]},a(),p.talkAsync(1888490768)})).then((e=>{!function(e,t){let r=c.binAddr,i=0,o=s.procDebugInfo.filter((e=>e.codeStartLoc<=r&&r<=e.codeEndLoc))[0];for(;o&&o!=s.procDebugInfo[0];){let s=b(r),a=n.clone(s);a.functionName=o.name,a.argumentNames=o.args&&o.args.map((e=>e.name)),t.stackframes.push({locals:{},funcInfo:a,breakpointId:s.id});let l=t.stackframes[t.stackframes.length-1],c=0;for(let t of o.locals)n.assert(t.index==c++),l.locals[t.name]=m(e[i++]);r=2147483646&e[i++];let d=u[r+""];for(let t of o.args)l.locals[t.name]=m(e[i+(o.args.length-1-t.index)]);if(!d)break;o=d.from,i+=d.stack-o.localsMark}}(r.decodeU32LE(e),i);let t=[i.globals].concat(i.stackframes.map((e=>e.locals)));return n.promiseMapAll(t,y)})).then((()=>t.postMessage(i)))}function T(){h=!1,o=new Promise(((e,t)=>{a=e}))}function k(e=!1){return Promise.resolve().then((()=>p.talkAsync(665147697,r.encodeU32LE([e?1:3])))).then(T)}function E(){return o||(o=Promise.resolve()),o}function x(){return(l?Promise.resolve(l):p.talkAsync(1409050336).then((e=>l={numGlobals:i(e,0),globalsPtr:i(e,4)}))).then((e=>p.readWordsAsync(e.globalsPtr,e.numGlobals))).then((e=>({staticState:l,globals:e})))}t.taggedUndefined=0,t.taggedNull=f(1),t.taggedFalse=f(2),t.taggedTrue=f(16),t.postMessage=e=>console.log(e),t.decodeValue=m,t.heapExpandAsync=g,t.heapExpandMapAsync=y,t.startDebugAsync=function(e,t){return p=t,p.onEvent(915601917,v),(h=!1,s=null,l=null,Promise.resolve()).then((()=>{s=e,u={};let t=[];for(let n of e.procDebugInfo)t[n.idx]=n;for(let n of e.procDebugInfo)for(let e of n.calls)u[e.addr+""]={from:n,to:t[e.procIndex],stack:e.stack}})).then((()=>{let e=s.outfiles[pxtc.BINARY_UF2],t=n.stringToUint8Array(atob(e));return d=pxtc.UF2.toBin(t),p.reflashAsync(s).then((()=>p.reconnectAsync()))})).then((()=>p.talkAsync(287358355).catch((e=>{})))).then((()=>n.delay(200))).then((()=>p.reconnectAsync())).then(T).then(E)},t.handleMessage=function(e){if(console.log("HWDBGMSG",e),"debugger"!=e.type)return;let t=!1;switch(e.subtype){case"stepinto":t=!0;case"stepover":k(t)}},t.resumeAsync=k,t.waitForHaltAsync=E,t.getHwStateAsync=x}(e.HWDBG||(e.HWDBG={}))}(pxt||(pxt={})),function(e){e.ImageConverter=class{logTime(){if(this.start){let t=Date.now()-this.start;e.debug("Icon creation: "+t+"ms")}}convert(t){this.start||(this.start=Date.now());let n=atob(t.slice(t.indexOf(",")+1)),r=n.charCodeAt(0),i=n.charCodeAt(1),s=n.charCodeAt(2);if(135===r&&(r=224|n.charCodeAt(1),i=n.charCodeAt(2)|n.charCodeAt(3)<<8,s=n.charCodeAt(4)|n.charCodeAt(5)<<8,n=n.slice(4)),225!=r&&228!=r)return null;if(this.palette||this.setPalette(e.appTarget.runtime.palette.map((function(e){const t=parseInt(e.replace(/#/,""),16);return[t>>0&255,t>>8&255,t>>16&255,255]}))),225==r)return this.genMonochrome(n,i,s);const o=(e.BrowserUtils.isEdge()||e.BrowserUtils.isIE())&&i<100&&s<100?3:1;return this.genColor(n,i,s,o)}setPalette(e){e[0][3]=0,this.palette=new Uint8Array(4*e.length);for(let t=0;t<e.length;++t)this.palette[4*t+0]=e[t][0],this.palette[4*t+1]=e[t][1],this.palette[4*t+2]=e[t][2],this.palette[4*t+3]=e[t][3]}genMonochrome(t,n,r){let i=n+3&-4,s=54+this.palette.length,o=s+i*r,a=new Uint8Array(o);a[0]=66,a[1]=77,e.HF2.write32(a,2,o),e.HF2.write32(a,10,s),e.HF2.write32(a,14,40),e.HF2.write32(a,18,n),e.HF2.write32(a,22,-r),e.HF2.write16(a,26,1),e.HF2.write16(a,28,8),e.HF2.write32(a,38,2835),e.HF2.write32(a,42,2835),e.HF2.write32(a,46,this.palette.length>>2),a.set(this.palette,54);let l=4,c=s,u=1,d=t.charCodeAt(l++);for(let e=0;e<n;++e){c=s+e;for(let e=0;e<r;++e)a[c]=d&u?1:0,c+=i,u<<=1,256==u&&(u=1,d=t.charCodeAt(l++))}return"data:image/bmp;base64,"+btoa(e.U.uint8ArrayToString(a))}genColor(t,n,r,i){const s=n*(i=Math.max(1,0|i)),o=r*i;let a=s<<2,l=138,c=l+a*o,u=new Uint8Array(c);u[0]=66,u[1]=77,e.HF2.write32(u,2,c),e.HF2.write32(u,10,l),e.HF2.write32(u,14,124),e.HF2.write32(u,18,s),e.HF2.write32(u,22,-o),e.HF2.write16(u,26,1),e.HF2.write16(u,28,32),e.HF2.write16(u,30,3),e.HF2.write32(u,38,2835),e.HF2.write32(u,42,2835),e.HF2.write32(u,54,16711680),e.HF2.write32(u,58,65280),e.HF2.write32(u,62,255),e.HF2.write32(u,66,4278190080),u[70]=66,u[71]=71,u[72]=82,u[73]=115;let d=4,p=l,h=!0;for(let e=0;e<s;e++){let n=!1;p=l+(e<<2);let s=d,c=t.charCodeAt(d++),f=n?(c>>4&15)<<2:(15&c)<<2;for(let e=0;e<o;e++)c&&(h=!1),u[p]=this.palette[f],u[p+1]=this.palette[f+1],u[p+2]=this.palette[f+2],u[p+3]=this.palette[f+3],p+=a,e%i==i-1&&(n&&(c=t.charCodeAt(d++)),n=!n,f=n?(c>>4&15)<<2:(15&c)<<2);if(h&&(u[141]=1),e%i==i-1)for(r%2||--d;3&d;)d++;else d=s}return"data:image/bmp;base64,"+btoa(e.U.uint8ArrayToString(u))}},e.convertUint8BufferToPngUri=function(t,n){const r=new e.ImageConverter,i=[];for(let e=0;e<16;e++)i.push([t[3*e+2],t[3*e+1],t[3*e+0],255]);r.setPalette(i);const s=String.fromCharCode.apply(null,n),o=`data:image/x-mkcd-f4;base64,${btoa(s)}`;return r.convert(o)}}(pxt||(pxt={})),function(e){!function(t){function n(){const e={"tsconfig.json":t.TS_CONFIG,"test.ts":`// ${lf("tests go here; this will not be compiled when this package is used as an extension.")}\n`,"_config.yml":"makecode:\n  target: @TARGET@\n  platform: @PLATFORM@\n  home_url: @HOMEURL@\ntheme: jekyll-theme-slate\ninclude:\n  - assets\n  - README.md\n",Makefile:"all: deploy\n\nbuild:\n\tpxt build\n\ndeploy:\n\tpxt deploy\n\ntest:\n\tpxt test\n",Gemfile:"source 'https://rubygems.org'\ngem 'github-pages', group: :jekyll_plugins","README.md":`\n> ${lf("Open this page at {0}","[https://@REPOOWNER@.github.io/@REPONAME@/](https://@REPOOWNER@.github.io/@REPONAME@/)")}\n\n## ${lf("Use as Extension")}\n\n${lf("This repository can be added as an **extension** in MakeCode.")}\n\n* ${lf("open [@HOMEURL@](@HOMEURL@)")}\n* ${lf("click on **New Project**")}\n* ${lf("click on **Extensions** under the gearwheel menu")}\n* ${lf("search for **https://github.com/@REPO@** and import")}\n\n## ${lf("Edit this project")}\n\n${lf("To edit this repository in MakeCode.")}\n\n* ${lf("open [@HOMEURL@](@HOMEURL@)")}\n* ${lf("click on **Import** then click on **Import URL**")}\n* ${lf("paste **https://github.com/@REPO@** and click import")}\n\n#### ${lf("Metadata (used for search, rendering)")}\n\n* for PXT/@TARGET@\n<script src="https://makecode.com/gh-pages-embed.js"><\/script><script>makeCodeRender("{{ site.makecode.home_url }}", "{{ site.github.owner_name }}/{{ site.github.repository_name }}");<\/script>\n`,".gitignore":"# MakeCode\nbuilt\nnode_modules\nyotta_modules\nyotta_targets\npxt_modules\n.pxt\n_site\n*.db\n*.tgz\n.header.json\n.simstate.json\n",".vscode/settings.json":'{\n    "editor.formatOnType": true,\n    "files.autoSave": "afterDelay",\n    "files.watcherExclude": {\n        "**/.git/objects/**": true,\n        "**/built/**": true,\n        "**/node_modules/**": true,\n        "**/yotta_modules/**": true,\n        "**/yotta_targets": true,\n        "**/pxt_modules/**": true,\n        "**/.pxt/**": true\n    },\n    "files.associations": {\n        "*.blocks": "html",\n        "*.jres": "json"\n    },\n    "search.exclude": {\n        "**/built": true,\n        "**/node_modules": true,\n        "**/yotta_modules": true,\n        "**/yotta_targets": true,\n        "**/pxt_modules": true,\n        "**/.pxt": true\n    },\n    "files.exclude": {\n        "**/pxt_modules": true,\n        "**/.pxt": true\n    }\n}',".vscode/extensions.json":'{\n    "recommendations": ["ms-edu.pxt-vscode-web"]\n}'},n=r();return n&&Object.keys(n).forEach((t=>e[t]=n[t])),e}function r(){const t=e.appTarget.bundledpkgs[e.template.TEMPLATE_PRJ];if(t){const n=e.Util.clone(t);return delete n[e.CONFIG_NAME],n}}t.TS_CONFIG='{\n    "compilerOptions": {\n        "target": "ES5",\n        "noImplicitAny": true,\n        "outDir": "built",\n        "rootDir": "."\n    },\n    "exclude": ["pxt_modules/**/*test.ts"]\n}\n',t.defaultFiles=n,t.targetTemplateFiles=r,t.TEMPLATE_PRJ="template",t.packageFiles=function(t){const r=e.appTarget.blocksprj||e.appTarget.tsprj,i=e.U.clone(r.config);delete i.installedVersion,delete i.additionalFilePath,delete i.additionalFilePaths,i.preferredEditor=i.files.find((e=>/\.blocks$/.test(e)))?e.BLOCKS_PROJECT_NAME:e.JAVASCRIPT_PROJECT_NAME,i.name=t,i.public=!0,i.version||(i.version="0.0.0");const s={},o=n();for(const e in o)s[e]=o[e];for(const e in r.files)"README.md"!=e&&(s[e]=r.files[e]);const a=Object.keys(s).filter((e=>/\.(blocks|md|ts|asm|cpp|h|py)$/.test(e)));return i.files=a.filter((e=>!/test/.test(e))),i.testFiles=a.filter((e=>/test/.test(e))),i.supportedTargets=[e.appTarget.id],s[e.CONFIG_NAME]=e.Package.stringifyConfig(i),s},t.packageFilesFixup=function(t,n){const r=JSON.parse(t[e.CONFIG_NAME]);n&&e.Util.jsonMergeFrom(r,n),e.webConfig&&(Object.keys(e.webConfig).forEach((t=>r[t.toLowerCase()]=e.webConfig[t])),r.platform=e.appTarget.platformid||e.appTarget.id,r.target=e.appTarget.id,r.docs=e.appTarget.appTheme.homeUrl||"./",r.homeurl=e.appTarget.appTheme.homeUrl||"???"),e.U.iterMap(t,((e,n)=>{n=n.replace(/@([A-Z]+)@/g,((e,t)=>r[t.toLowerCase()]||"")),t[e]=n}))}}(e.template||(e.template={}))}(pxt||(pxt={})),function(e){!function(t){let n,r;!function(e){e[e.Prefix=0]="Prefix",e[e.Postfix=1]="Postfix",e[e.Infix=2]="Infix",e[e.Block=3]="Block",e[e.NewLine=4]="NewLine"}(n=t.NT||(t.NT={})),function(e){e[e.None=0]="None",e[e.WithSpace=1]="WithSpace",e[e.NoSpace=2]="NoSpace"}(r=t.GlueMode||(t.GlueMode={}));const i=["break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with"];function s(e){return"`"+e.replace(/[\\`${}]/g,(e=>"\\"+e))+"`"}function o(e){return e.length>20&&/\n/.test(e)?s(e):JSON.stringify(e)}function a(e,t,n){return{type:e,op:t,children:n}}function l(){return a(n.NewLine,"",[])}function c(e,t){return a(n.Prefix,e,t)}function u(e,t,r){return a(n.Infix,t,null==e?[r]:[e,r])}function d(e){return c(e,[])}function p(e){return a(n.Block,"",e)}function h(e){return c("",e)}function f(e,t=!1){const n=[];for(const r of e)t?(n.length>0&&n.push(d(",")),n.push(l())):n.length>0&&n.push(d(", ")),n.push(r);return t&&n.push(l()),h(n)}let m;t.backtickLit=s,t.stringLit=o,t.mkNode=a,t.mkNewLine=l,t.mkPrefix=c,t.mkPostfix=function(e,t){return a(n.Postfix,t,e)},t.mkInfix=u,t.mkText=d,t.mkBlock=p,t.mkGroup=h,t.mkStmt=function(...e){let t=e[e.length-1];return t&&t.type==n.Block||e.push(l()),h(e)},t.mkCommaSep=f,function(t){function n(e,t,n=!1,r=!1){return h(r?[u(t[0],".",d(e)),d("("),f(t.slice(1),n),d(")")]:[d(e),d("("),f(t,n),d(")")])}function r(e,t,r,i){return n(e+"."+t,r,i)}function i(t,n){return e.U.assert(2==n.length),u(n[0],t,n[1])}t.mkArrayLiteral=function(e,t){return h([d("["),f(e,t),d("]")])},t.mkNumberLiteral=function(e){return d(e.toString())},t.mkBooleanLiteral=function(e){return d(e?"true":"false")},t.mkStringLiteral=function(e){return d(o(e))},t.mkPropertyAccess=function(e,t){return h([u(t,".",d(e))])},t.mkCall=n,t.stdCall=function(e,t,r){return n(e,t,r)},t.extensionCall=function(e,t,r){return n(e,t,r,!0)},t.namespaceCall=r,t.mathCall=function(e,t){return r("Math",e,t,!1)},t.mkGlobalRef=function(e){return d(e)},t.mkSimpleCall=i,t.mkWhile=function(e,t){return h([d("while ("),e,d(")"),p(t)])},t.mkComment=function(e){return d("// "+e)},t.mkMultiComment=function(e){let t=[d("/**"),l()];return e.split("\n").forEach(((e,n,r)=>{e&&(t.push(d(" * "+e)),t.push(l()),n<r.length-1&&(t.push(d(" * ")),t.push(l())))})),h(t.concat([d(" */"),l()]))},t.mkAssign=function(e,t){return i("=",[e,t])},t.mkParenthesizedExpression=function(e){return y(g([e]).output)?e:h([d("("),e,d(")")])}}(m=t.Helpers||(t.Helpers={})),t.H=m;const _={"=":3,"+=":3,"-=":3,"?":4,":":4,"||":5,"&&":6,"|":7,"^":8,"&":9,"==":10,"!=":10,"===":10,"!==":10,"<":11,">":11,"<=":11,">=":11,">>":12,">>>":12,"<<":12,"+":13,"-":13,"*":14,"/":14,"%":14,"**":15,"!":16,"~":16,"P-":16,"P+":16,"++":16,"--":16,".":18};function g(t){let i=[],s={},o="",a="",l=[{}],c=0;function u(e){"string"==typeof e&&(c+=(e.match(/\n/g)||[]).length),o+=e}let p=h(t);return function t(r,i){if(r.type!=n.Infix){for(let e of r.children)t(e,-1);return}let s=[];function o(e){"P"==e[0]&&(e=e.slice(1)),s.push(d(e))}let a=e.U.lookup(_,r.op);if(null==a&&e.U.oops("bad infix op: "+r.op),a<i&&o("("),1==r.children.length)o(r.op),t(r.children[0],a),s.push(r.children[0]);else{let e,n=3!=a&&"**"!=r.op;t(r.children[0],n?a:a+.1),s.push(r.children[0]),e&&"number"!=e&&(o(": "),o(e)),"."==r.op?o("."):o(" "+r.op+" "),t(r.children[1],n?a+.1:a),s.push(r.children[1])}a<i&&o(")"),r.type=n.Prefix,r.op="",r.children=s}(p,-1),f(p),o||u("\n"),{output:o,sourceMap:i};function f(t){t.glueToBlock&&(g(),t.glueToBlock==r.WithSpace&&u(" "));let d=c,p=o.length;switch(t.type){case n.Infix:e.U.oops("no infix should be left");break;case n.NewLine:u("\n"+a);break;case n.Block:!function(t){let n=t.noFinalNewline?"":"\n";if(0==t.children.length)return void m(" {\n\t\n}"+n);let r=e.U.clone(l[l.length-1]||{});l.push(r),a+="    "," "!=o[o.length-1]&&m(" ");m("{\n");for(let e of t.children)f(e);a=a.slice(4),g(),m("\n}"+n),l.pop()}(t);break;case n.Prefix:t.canIndentInside?u(t.op.replace(/\n/g,"\n"+a+"    ")):u(t.op),t.children.forEach(f);break;case n.Postfix:t.children.forEach(f),t.canIndentInside?u(t.op.replace(/\n/g,"\n"+a+"    ")):u(t.op)}let h=c,_=Math.max(o.length,1);if(t.id)if(s[t.id]){const e=s[t.id];e.startLine=Math.min(e.startLine,d),e.endLine=Math.max(e.endLine,h),e.startPos=Math.min(e.startPos,p),e.endPos=Math.max(e.endPos,_)}else{const e={id:t.id,startLine:d,startPos:p,endLine:h,endPos:_};s[t.id]=e,i.push(e)}}function m(e){u(e.replace(/\n/g,"\n"+a))}function g(){o=o.replace(/\n *$/,(function(){return c--,""}))}}function y(e){if("("!==e[0]||")"!==e[e.length-1])return!1;let t=1;for(let n=1;n<e.length;n++){const r=e[n];if("("===r)t++;else if(")"===r&&(t--,0===t))return n===e.length-1}return!1}t.flattenNode=g,t.isReservedWord=function(e){return-1!==i.indexOf(e)},t.isParenthesized=y}(e.blocks||(e.blocks={}))}(pxt||(pxt={})),function(e){!function(t){const n=[".","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];t.BLOCKLY_TILESET_TYPE="BLOCKLY_TILESET_TYPE",t.TILE_PREFIX="tile",t.TILE_NAMESPACE="myTiles",t.IMAGES_NAMESPACE="myImages",t.IMAGE_PREFIX="image",t.ANIMATION_NAMESPACE="myAnimations",t.ANIMATION_PREFIX="anim",t.SONG_NAMESPACE="mySongs",t.SONG_PREFIX="song";class r{constructor(e,t,n=0,r=0,i){this.width=e,this.height=t,this.x0=n,this.y0=r,this.width||(this.width=16),this.height||(this.height=16),this.buf=i||new Uint8ClampedArray(this.dataLength())}static fromData(e){return new r(e.width,e.height,e.x0,e.y0,e.data)}set(e,t,n){if(e<this.width&&t<this.height&&e>=0&&t>=0){const r=this.coordToIndex(e,t);this.setCore(r,n)}}get(e,t){if(e<this.width&&t<this.height&&e>=0&&t>=0){const n=this.coordToIndex(e,t);return this.getCore(n)}return 0}copy(e=0,t=0,n=this.width,i=this.height){const s=new r(n,i);s.x0=e,s.y0=t;for(let r=0;r<n;r++)for(let n=0;n<i;n++)s.set(r,n,this.get(e+r,t+n));return s}apply(e,t=!1){let n;for(let r=0;r<e.width;r++)for(let i=0;i<e.height;i++)n=e.get(r,i),!n&&t||this.set(e.x0+r,e.y0+i,n)}equals(e){if(this.width===e.width&&this.height===e.height&&this.x0===e.x0&&this.y0===e.y0&&this.buf.length===e.buf.length){for(let t=0;t<this.buf.length;t++)if(this.buf[t]!==e.buf[t])return!1;return!0}return!1}data(){return{width:this.width,height:this.height,x0:this.x0,y0:this.y0,data:this.buf}}resize(e,t){return p(this,e,t)}coordToIndex(e,t){return e+t*this.width}getCore(e){const t=Math.floor(e/2);return e%2==0?15&this.buf[t]:(240&this.buf[t])>>4}setCore(e,t){const n=Math.floor(e/2);this.buf[n]=e%2==0?240&this.buf[n]|15&t:15&this.buf[n]|(15&t)<<4}dataLength(){return Math.ceil(this.width*this.height/2)}}t.Bitmap=r;class i extends r{static fromData(e){return new i(e.width,e.height,e.x0,e.y0,e.data)}copy(e=0,t=0,n=this.width,r=this.height){const s=new i(n,r);s.x0=e,s.y0=t;for(let i=0;i<n;i++)for(let n=0;n<r;n++)s.set(i,n,this.get(e+i,t+n));return s}resize(e,t){return h(this,e,t)}getCore(e){return this.buf[e]}setCore(e,t){this.buf[e]=t}dataLength(){return this.width*this.height}}t.Tilemap=i;class s{constructor(e,t,n){this.tilemap=e,this.tileset=t,this.layers=n,this.nextId=0}cloneData(){const e=this.tilemap.copy(),t={tileWidth:this.tileset.tileWidth,tiles:this.tileset.tiles.map((e=>Object.assign(Object.assign({},e),{bitmap:r.fromData(e.bitmap).copy().data()})))},n=r.fromData(this.layers).copy().data();return new s(e,t,n)}equals(t){if(!this.tilemap.equals(t.tilemap)||this.tileset.tileWidth!=t.tileset.tileWidth||this.tileset.tiles.length!=t.tileset.tiles.length||!y(this.layers,t.layers))return!1;for(let n=0;n<this.tileset.tiles.length;n++)if(!e.assetEquals(this.tileset.tiles[n],t.tileset.tiles[n]))return!1;return!0}}t.TilemapData=s;function o(e){return a(atob(e.slice(e.indexOf(",")+1)))}function a(t){let n=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2);135===n&&(n=224|t.charCodeAt(1),r=t.charCodeAt(2)|t.charCodeAt(3)<<8,i=t.charCodeAt(4)|t.charCodeAt(5)<<8,t=t.slice(4));const s=new e.sprite.Bitmap(r,i);let o=4;if(225===n){let e=1,n=t.charCodeAt(o++);for(let a=0;a<r;++a)for(let r=0;r<i;++r)s.set(a,r,n&e?1:0),e<<=1,256==e&&(e=1,n=t.charCodeAt(o++))}else for(let e=0;e<r;e++){for(let n=0;n<i;n+=2){let r=t.charCodeAt(o++);s.set(e,n,15&r),n!=i-1&&s.set(e,n+1,r>>4&15)}for(;3&o;)o++}return s}function l(e,t){!(e=(e=(e=e.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:hex)/g,"").trim()).replace(/^["`\(\)]*/,"").replace(/["`\(\)]*$/,"")).replace(/&#10;/g,"\n"))&&t&&(e=t);const n=parseInt(e.substr(0,2),16)|parseInt(e.substr(2,2),16)<<8,r=parseInt(e.substr(4,2),16)|parseInt(e.substr(6,2),16)<<8,s=T(e.substring(8));return i.fromData({width:n,height:r,x0:0,y0:0,data:s})}function c(e){return`${d(e.width,2)}${d(e.height,2)}${k(e.data().data)}`}function u(e,t){return(e=e.replace(/[\[\]]/g,""))?e.split(",").filter((e=>!!e.trim())).map((e=>function(e,t){if(0===(e=e.trim()).indexOf("img")){const n=f(e);return t.createNewTile(n.data())}switch(e){case"myTiles.tile0":case"myTiles.transparency16":return t.getTransparency(16);case"myTiles.transparency8":return t.getTransparency(8);case"myTiles.transparency4":return t.getTransparency(4);case"myTiles.transparency32":return t.getTransparency(32);default:return t.resolveTile(e)}}(e,t))):[]}function d(e,t){let n=e.toString(16);const r=t<<1;for(1&n.length&&(n="0"+n);n.length<r;)n+="0";return n}function p(e,t,n){const i=new r(t,n);return i.apply(e),i}function h(e,t,n){const r=new i(t,n);return r.apply(e),r}function f(e,t="img"){const n=(e=(e=(e=(e=e.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:img)/g,"").trim()).replaceAll(t,"")).replace(/^["`\(\)]*/,"").replace(/["`\(\)]*$/,"")).replace(/&#10;/g,"\n")).split("\n"),i=[];let s=0;for(let e=0;e<n.length;e++){const t=n[e],r=[];for(let e=0;e<t.length;e++)switch(t[e]){case"0":case".":r.push(0);break;case"1":case"#":r.push(1);break;case"2":case"T":r.push(2);break;case"3":case"t":r.push(3);break;case"4":case"N":r.push(4);break;case"5":case"n":r.push(5);break;case"6":case"G":r.push(6);break;case"7":case"g":r.push(7);break;case"8":r.push(8);break;case"9":r.push(9);break;case"a":case"A":case"R":r.push(10);break;case"b":case"B":case"P":r.push(11);break;case"c":case"C":case"p":r.push(12);break;case"d":case"D":case"O":r.push(13);break;case"e":case"E":case"Y":r.push(14);break;case"f":case"F":case"W":r.push(15);break;default:if(!/\s/.test(t[e]))return}r.length&&(i.push(r),s=Math.max(s,r.length))}const o=i.length,a=new r(s,o);for(let e=0;e<o;e++){const t=i[e];for(let n=0;n<s;n++)n<t.length?a.set(n,e,t[n]):a.set(n,e,0)}return a}function m(e,t="img"){let n="";switch(e){case"python":n=`${t}("""`;break;default:n=`${t}\``}return n}function _(e){let t="";switch(e){case"python":t+='""")';break;default:t+="`"}return t}function g(e,t,r="img"){if(!e||0===e.height||0===e.width)return"";let i=m(t,r);if(e){const t=e.width*e.height>300?"":" ";for(let r=0;r<e.height;r++){i+="\n";for(let s=0;s<e.width;s++)i+=n[e.get(s,r)]+t}}return i+="\n",i+=_(t),i}function y(t,n){return e.sprite.Bitmap.fromData(t).equals(e.sprite.Bitmap.fromData(n))}function b(e){switch(e){case 4:return"TileScale.Four";case 8:return"TileScale.Eight";case 16:return"TileScale.Sixteen";case 32:return"TileScale.ThirtyTwo";default:return Math.floor(Math.log2(e)).toString()}}function v(e){switch(e=e.replace(/\s/g,"")){case"TileScale.Four":return 4;case"TileScale.Eight":return 8;case"TileScale.Sixteen":return 16;case"TileScale.ThirtyTwo":return 32;default:return Math.pow(2,parseInt(e))}}function T(e){let t=new Uint8ClampedArray(e.length>>1);for(let n=0;n<e.length;n+=2)t[n>>1]=parseInt(e.slice(n,n+2),16);return t}function k(e){const t="0123456789abcdef";let n="";for(let r=0;r<e.length;++r)n+=t[e[r]>>4],n+=t[15&e[r]];return n}function E(e,t,n){e[t]=255&n,e[t+1]=n>>8&255}function x(e){const t=function(e){if(e){if(6===e.length)return parseInt("0x"+e);if(7===e.length)return parseInt("0x"+e.substr(1))}return 0}(e);return[S(t),C(t),I(t)]}function S(e){return e>>16&255}function C(e){return e>>8&255}function I(e){return 255&e}t.Bitmask=class{constructor(e,t){this.width=e,this.height=t,this.mask=new Uint8Array(Math.ceil(e*t/8))}set(e,t){const n=e+this.width*t,r=n>>3,i=7&n;this.mask[r]|=1<<i}get(e,t){const n=e+this.width*t,r=n>>3,i=7&n;return this.mask[r]>>i&1}},t.encodeTilemap=function(e,t,n){return e?`tiles.createTilemap(${function(e){return e?`hex\`${c(e)}\``:"hex``"}(e.tilemap)}, ${g(r.fromData(e.layers),t)}, [${e.tileset.tiles.map((e=>function(e,t,n){if(n&&n[e.id])return n[e.id];return e.id}(e,0,n)))}], ${b(e.tileset.tileWidth)})`:"null"},t.decodeTilemap=function(t,n,r){if(!(t=e.Util.htmlUnescape(t).trim()).trim())return null;const i=(t=(t=t.substr(t.indexOf("(")+1)).substr(0,t.lastIndexOf(")"))).substr(0,t.indexOf(",")),o=(t=t.substr(i.length+1)).substr(0,t.indexOf(",")),a=(t=t.substr(o.length+1)).substr(0,t.lastIndexOf("]")+1),c=t=t.substr(a.length+1);return new s(l(i),{tiles:u(a,r),tileWidth:v(c)},f(o).data())},t.trimTilemapTileset=function(e){const t=e.tileset.tiles.slice(),n=e.tilemap,r={};r[t[0].id]=!0;for(let e=0;e<n.width;e++)for(let i=0;i<n.height;i++)r[t[n.get(e,i)].id]=!0;const i=e.editedTiles||[],s=t.filter((e=>r[e.id]||"*"===e.id.charAt(0)||-1!==i.indexOf(e.id)));if(s.length===t.length)return;const o=[];for(let e=0;e<t.length;e++)o.push(s.indexOf(t[e]));for(let e=0;e<n.width;e++)for(let t=0;t<n.height;t++)n.set(e,t,o[n.get(e,t)]);e.tileset.tiles=s},t.isEmptyTilemap=function(e){const t=e.tileset.tiles,n=e.tilemap,r=t[0].id;for(let e=0;e<n.width;e++)for(let i=0;i<n.height;i++)if(t[n.get(e,i)].id!==r)return!1;return!0},t.computeAverageColor=function(e,t){const n=t.map(x),r=[0,0,0];let i=0;for(let t=0;t<e.width;t++)for(let s=0;s<e.height;s++){const o=e.get(t,s);if(o){++i;const e=n[o];r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]}}return i?"#"+function(e){let t="";for(let n=0;n<e.length;++n)t+=("0"+e[n].toString(16)).slice(-2);return t}(r.map((e=>Math.floor(e/i)))):"#00000000"},t.getBitmap=function(e,t){const n=e.apis.byQName[t];return n?o(n.attributes.jresURL):null},t.getBitmapFromJResURL=o,t.hexToBitmap=a,t.filterItems=function(e,t){const n=(t=t.filter((e=>!!e)).map((e=>e.toLowerCase()))).filter((e=>0!==e.indexOf("!"))),r=t.filter((e=>0===e.indexOf("!")&&e.length>1)).map((e=>e.substring(1)));return e.filter((e=>{return t=e,n.every((e=>{const n=`?${e}`;return t.tags.some((t=>t===e||t===n))}))&&function(e){return r.every((t=>!e.tags.some((e=>e===t))))}(e);var t}))},t.getGalleryItems=function(n,r){let i=function(t,n){return e.Util.values(t.byQName).filter((e=>4===e.kind&&e.attributes.fixedInstance&&function(e,t,n){if(t==n)return!0;let r=e.byQName[t];return!(!r||!r.extendsTypes)&&r.extendsTypes.indexOf(n)>=0}(t,e.retType,n)))}(n.apis,r);return i=i.filter((e=>e.namespace!=t.TILE_NAMESPACE)),function(t){const n=new e.ImageConverter;t.forEach((e=>{e.attributes.jresURL&&!e.attributes.iconURL&&0==e.attributes.jresURL.indexOf("data:image/x-mkcd-f")&&(e.attributes.iconURL=n.convert(e.attributes.jresURL))}))}(i),i.map((t=>{const n=(t.attributes.tags||"").split(" ").filter((e=>!!e)).map((t=>e.Util.startsWith(t,"category-")?t:t.toLowerCase()));return{qName:t.qName,src:t.attributes.iconURL,alt:t.qName,tags:n}}))},t.base64EncodeBitmap=function(t){const n=r.fromData(t),i=pxtc.f4EncodeImg(t.width,t.height,4,((e,t)=>n.get(e,t)));return btoa(e.U.uint8ArrayToString(T(i)))},t.tilemapLiteralToTilemap=l,t.hexEncodeTilemap=c,t.formatByte=d,t.resizeBitmap=p,t.resizeTilemap=h,t.imageLiteralToBitmap=f,t.encodeAnimationString=function(t,n){const r=t.map((e=>e.data)),i=new Uint8ClampedArray(8+r[0].length*r.length);E(i,0,n),E(i,2,t[0].width),E(i,4,t[0].height),E(i,6,t.length);let s=8;return r.forEach((e=>{i.set(e,s),s+=e.length})),btoa(e.sprite.uint8ArrayToHex(i))},t.addMissingTilemapTilesAndReferences=function(e,t){const n=e.getProjectTiles(t.data.tileset.tileWidth,!0);t.data.projectReferences=[];for(const r of n.tiles)t.data.tileset.tiles.some((e=>e.id===r.id))||t.data.tileset.tiles.push(r),e.isAssetUsed(r,null,[t.id])&&t.data.projectReferences.push(r.id)},t.updateTilemapReferencesFromResult=function(t,n){const r=n.data;if(r.deletedTiles)for(const e of r.deletedTiles)t.deleteTile(e);if(r.editedTiles)for(const e of r.editedTiles){const n=r.tileset.tiles.findIndex((t=>t.id===e)),i=r.tileset.tiles[n];i&&(r.tileset.tiles[n]=t.updateTile(i))}for(let e=0;e<r.tileset.tiles.length;e++){const n=r.tileset.tiles[e];n.jresData||(r.tileset.tiles[e]=t.resolveTile(n.id))}e.sprite.trimTilemapTileset(r)},t.imageLiteralFromDimensions=function(e,t,r,i){let s=m(i);const o=e*t>300?"":" ";for(let i=0;i<t;i++){s+="\n";for(let t=0;t<e;t++)s+=n[r]+o}return s+="\n",s+=_(i),s},t.bitmapToImageLiteral=g,t.bitmapEquals=y,t.tileWidthToTileScale=b,t.tileScaleToTileWidth=v,t.hexToUint8Array=T,t.uint8ArrayToHex=k,t.colorStringToRGB=x}(e.sprite||(e.sprite={}))}(pxt||(pxt={})),function(e){!function(t){!function(n){const r=new RegExp(`^\\s*${t.TILE_NAMESPACE}\\s*\\.\\s*${t.TILE_PREFIX}(\\d+)\\s*$`);class i{constructor(e,t,n){this.tilemap=e,this.tileset=t,this.layers=n,this.nextId=0}}function s(e){return(e=e.replace(/[\[\]]/g,""))?e.split(",").filter((e=>!!e.trim())).map((e=>function(e){if(0===(e=e.trim()).indexOf("img")){return{data:t.imageLiteralToBitmap(e).data()}}const n=r.exec(e);if(n)return{data:null,projectId:Number(n[1])};return{data:null,qualifiedName:e}}(e))):[]}n.LegacyTilemapData=i,n.decodeTilemap=function(n,r){var o;if(!(null==(n=null===(o=e.Util.htmlUnescape(n))||void 0===o?void 0:o.trim())?void 0:n.trim()))return new i(new t.Tilemap(16,16),{tileWidth:16,tiles:[]},new t.Bitmap(16,16).data());const a=(n=(n=n.substr(n.indexOf("(")+1)).substr(0,n.lastIndexOf(")"))).substr(0,n.indexOf(",")),l=(n=n.substr(a.length+1)).substr(0,n.indexOf(",")),c=(n=n.substr(l.length+1)).substr(0,n.lastIndexOf("]")+1),u=n=n.substr(c.length+1);return new i(t.tilemapLiteralToTilemap(a),{tiles:s(c),tileWidth:t.tileScaleToTileWidth(u)},t.imageLiteralToBitmap(l).data())},n.tileToBlocklyVariable=function(e){return`${e.projectId};${e.data.width};${e.data.height};${pxtc.Util.toHex(e.data.data)}`},n.blocklyVariableToTile=function(e){const t=e.split(";");return 4!==t.length?null:{projectId:parseInt(t[0]),data:{width:parseInt(t[1]),height:parseInt(t[2]),data:new Uint8ClampedArray(pxtc.Util.fromHex(t[3])),x0:0,y0:0}}}}(t.legacy||(t.legacy={}))}(e.sprite||(e.sprite={}))}(pxt||(pxt={})),function(e){!function(t){class n{constructor(){this.items={}}removeItem(e){delete this.items[e]}getItem(e){return this.items[e]}setItem(e,t){this.items[e]=t}clear(){this.items={}}}class r{constructor(e){this.storageId=e,this.type="localstorage"}targetKey(e){return this.storageId+"/"+e}removeItem(e){window.localStorage.removeItem(this.targetKey(e))}getItem(e){return window.localStorage[this.targetKey(e)]}setItem(e,t){window.localStorage[this.targetKey(e)]=t}clear(){let e=this.targetKey(""),t=[];for(let n=0;n<window.localStorage.length;++n){let r=window.localStorage.key(n);0==r.indexOf(e)&&t.push(r)}t.forEach((e=>window.localStorage.removeItem(e)))}}function i(){if(e.appTarget)return e.appTarget.id;const t=window.pxtConfig;if(t)return t.targetId;const n=window.pxtTargetBundle;return n?n.id:""}let s;function o(){if(s)return;const t=i();let o=!1;if(!e.shell.isSandboxMode())try{const n=e.Util.guidGen();window.localStorage[t]=n;o=window.localStorage[t]===n}catch(e){}o?(s=new r(t),e.debug(`storage: local under ${t}`)):(s=new n,e.debug("storage: in memory"))}t.storageId=i,t.setLocal=function(e,t){o(),s.setItem(e,t)},t.getLocal=function(e){return o(),s.getItem(e)},t.removeLocal=function(e){o(),s.removeItem(e)},t.clearLocal=function(){o(),s.clear()}}(e.storage||(e.storage={}))}(pxt||(pxt={})),function(e){!function(t){!function(t){const n="http://localhost:3232/api/store/";function r(){return e.BrowserUtils.isLocalHostDev()&&!e.BrowserUtils.noSharedLocalStorage()}function i(){return e.BrowserUtils.isChromiumEdge()?"chromium-edge":e.BrowserUtils.browser()}t.getAsync=async function(t,s){if(r()){t+="-"+i();const r=await e.Util.requestAsync({url:`${n}${encodeURIComponent(t)}/${encodeURIComponent(s)}`,method:"GET",allowHttpErrors:!0});if(204===r.statusCode)throw new Error(`Missing ${s} not available in ${t}`);return r.json?r.json:r.text?r.text:void 0}{const n=e.storage.getLocal(`${t}:${s}`),r=e.Util.jsonTryParse(n);return r||n}},t.setAsync=async function(t,s,o){if(void 0===o)return void await e.storage.shared.delAsync(t,s);let a="";if(a="object"==typeof o?JSON.stringify(o):o.toString(),r()){t+="-"+i();const r={type:"object"==typeof o?"json":"text",val:a},l=JSON.stringify(r);await e.Util.requestAsync({url:`${n}${encodeURIComponent(t)}/${encodeURIComponent(s)}`,method:"POST",data:l})}else e.storage.setLocal(`${t}:${s}`,a)},t.delAsync=async function(t,s){r()?(t+="-"+i(),await e.Util.requestAsync({url:`${n}${encodeURIComponent(t)}/${encodeURIComponent(s)}`,method:"DELETE",allowHttpErrors:!0})):e.storage.removeLocal(`${t}:${s}`)}}(t.shared||(t.shared={}))}(e.storage||(e.storage={}))}(pxt||(pxt={})),function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)if(" "===e.charAt(n))t++;else{if("\t"!==e.charAt(n))return t;t+=4}return 0}e.getSectionsFromMarkdownMetadata=function(e){const n=e.split(/\r?\n/);let r=[],i=null,s=null,o=null,a=[],l=0;for(const e of n)if(e.trim()){if(e.startsWith("#")){const t=/^(#+)\s*(.+)$/.exec(e);if(t){c(),i={headerKind:1===t[1].length?"single":2===t[1].length?"double":"triple",header:t[2],attributes:{}},s=null,o=null,l=0;continue}}if(i){const n=t(e),r=e.trim(),c=/^[*-]\s+(?:([^:]+):)?(.*)$/.exec(r);if(!c)continue;if(Math.abs(n-l)>1&&s){if(n>l){const e={key:s,items:[]};a.length?a[a.length-1].items.push(e):(i.listAttributes||(i.listAttributes={}),i.listAttributes[s]=e),s=null,a.push(e)}else{const e=a.pop();s&&o&&(null==e||e.items.push((s+":"+o).trim()),o=null)}l=n}c&&(c[1]?(s&&o&&(a.length?a[a.length-1].items.push((s+":"+o).trim()):i.attributes[s]=o.trim()),s=c[1].toLowerCase(),o=c[2]):s&&(o+=c[2]))}}else o&&(o+="\n");return c(),r;function c(){i&&(s&&o&&(a.length?a[a.length-1].items.push((s+":"+o).trim()):i.attributes[s]=o.trim()),r.push(i)),a=[]}}}(pxt||(pxt={})),function(e){!function(t){let n;!function(e){e[e.PROD=0]="PROD",e[e.STAGING=1]="STAGING",e[e.LOCAL=2]="LOCAL"}(n||(n={}));let r=n.STAGING;t.ABSOLUTE_LINKS={PROD_BETA:"https://arcade.makecode.com/beta--multiplayer",STAGING_BETA:"https://arcade.staging.pxt.io/beta--multiplayer",LOCAL:"http://localhost:3000"},t.RELATIVE_LINKS={PROD:"/--multiplayer",BETA:"/beta--multiplayer"},t.SHORT_LINKS={PROD:"https://aka.ms/a9",PROD_BETA:"https://aka.ms/a9b",STAGING:"https://aka.ms/a9s",STAGING_BETA:"https://aka.ms/a9sb"},t.RELATIVE_LINK=()=>{if(e.BrowserUtils.isLocalHostDev())switch(r){case n.PROD:return t.ABSOLUTE_LINKS.PROD_BETA;case n.STAGING:return t.ABSOLUTE_LINKS.STAGING_BETA;case n.LOCAL:return t.ABSOLUTE_LINKS.LOCAL}return window.location.pathname.startsWith("/beta")?t.RELATIVE_LINKS.BETA:t.RELATIVE_LINKS.PROD},t.SHORT_LINK=()=>{if(e.BrowserUtils.isLocalHostDev())switch(r){case n.PROD:return t.SHORT_LINKS.PROD_BETA;case n.STAGING:return t.SHORT_LINKS.STAGING_BETA;case n.LOCAL:return t.ABSOLUTE_LINKS.LOCAL}return window.location.host.endsWith(".staging.pxt.io")?window.location.pathname.startsWith("/beta")?t.SHORT_LINKS.STAGING_BETA:t.SHORT_LINKS.STAGING:window.location.pathname.startsWith("/beta")?t.SHORT_LINKS.PROD_BETA:t.SHORT_LINKS.PROD},t.makeHostLink=function(e,n){return`${n?t.SHORT_LINK():t.RELATIVE_LINK()}?host=${encodeURIComponent(e)}`},t.makeJoinLink=function(e,n){return`${n?t.SHORT_LINK():t.RELATIVE_LINK()}?join=${encodeURIComponent(e)}`}}(e.multiplayer||(e.multiplayer={}))}(pxt||(pxt={})),function(e){!function(t){!function(t){function n(e,t,n){const r=new Uint8Array(2);new Uint16Array(r.buffer)[0]=0|n,e[t]=r[0],e[t+1]=r[1]}function r(e,t){const n=new Uint8Array(2);return n[0]=e[t],n[1]=e[t+1],new Uint16Array(n.buffer)[0]}function i(e){const t=new Uint8Array(5+7*e.steps.length);t[0]=e.steps.length,n(t,1,e.startFrequency),n(t,3,e.startVolume);for(let r=0;r<e.steps.length;r++){const i=5+7*r;t[i]=e.steps[r].waveform,n(t,i+1,e.steps[r].frequency),n(t,i+3,e.steps[r].volume),n(t,i+5,e.steps[r].duration)}return t}function s(e,t,r){const i=new Uint8Array(5+e.notes.length);n(i,0,e.startTick),n(i,2,e.endTick),i[4]=e.notes.length;for(let n=0;n<e.notes.length;n++)i[5+n]=o(e.notes[n],t,r);return i}function o(e,t,n){if(n)return e.note;let r=0;return"flat"===e.enharmonicSpelling?r=1:"sharp"===e.enharmonicSpelling&&(r=2),e.note-12*(t-2)|r<<6}function a(e){return e.drums?function(e){const t=e.drums.map(i),r=t.reduce(((e,t)=>t.length+e),0),o=e.notes.map((e=>s(e,0,!0))),a=o.reduce(((e,t)=>t.length+e),0),l=new Uint8Array(6+r+a);l[0]=e.id,l[1]=1,n(l,2,r);let c=4;for(const e of t)l.set(e,c),c+=e.length;n(l,c,a),c+=2;for(const e of o)l.set(e,c),c+=e.length;return l}(e):function(e){const t=function(e){var t,r,i,s,o,a,l,c,u;const d=new Uint8Array(28);return d[0]=e.waveform,n(d,1,e.ampEnvelope.attack),n(d,3,e.ampEnvelope.decay),n(d,5,e.ampEnvelope.sustain),n(d,7,e.ampEnvelope.release),n(d,9,e.ampEnvelope.amplitude),n(d,11,(null===(t=e.pitchEnvelope)||void 0===t?void 0:t.attack)||0),n(d,13,(null===(r=e.pitchEnvelope)||void 0===r?void 0:r.decay)||0),n(d,15,(null===(i=e.pitchEnvelope)||void 0===i?void 0:i.sustain)||0),n(d,17,(null===(s=e.pitchEnvelope)||void 0===s?void 0:s.release)||0),n(d,19,(null===(o=e.pitchEnvelope)||void 0===o?void 0:o.amplitude)||0),d[21]=(null===(a=e.ampLFO)||void 0===a?void 0:a.frequency)||0,n(d,22,(null===(l=e.ampLFO)||void 0===l?void 0:l.amplitude)||0),d[24]=(null===(c=e.pitchLFO)||void 0===c?void 0:c.frequency)||0,n(d,25,(null===(u=e.pitchLFO)||void 0===u?void 0:u.amplitude)||0),d[27]=e.octave,d}(e.instrument),r=e.notes.map((t=>s(t,e.instrument.octave,!1))),i=r.reduce(((e,t)=>t.length+e),0),o=new Uint8Array(6+t.length+i);o[0]=e.id,o[1]=0,n(o,2,t.length);let a=4;o.set(t,a),a+=t.length,n(o,a,i),a+=2;for(const e of r)o.set(e,a),a+=e.length;return o}(e)}function l(e,t){return{waveform:e[t],ampEnvelope:{attack:r(e,t+1),decay:r(e,t+3),sustain:r(e,t+5),release:r(e,t+7),amplitude:r(e,t+9)},pitchEnvelope:{attack:r(e,t+11),decay:r(e,t+13),sustain:r(e,t+15),release:r(e,t+17),amplitude:r(e,t+19)},ampLFO:{frequency:e[t+21],amplitude:r(e,22)},pitchLFO:{frequency:e[t+24],amplitude:r(e,25)},octave:e[t+27]}}function c(e,t){return e[t+1]?function(e,t){const n={id:e[t],instrument:{ampEnvelope:{attack:0,decay:0,sustain:0,release:0,amplitude:0},waveform:0},notes:[],drums:[]},i=r(e,t+2);let s=t+4;for(;s<t+4+i;)n.drums.push(u(e,s)),s+=5+7*n.drums[n.drums.length-1].steps.length;const o=r(e,s);s+=2;for(;s<t+4+i+o;)n.notes.push(d(e,s,0,!0)),s+=5+n.notes[n.notes.length-1].notes.length;return[n,s]}(e,t):function(e,t){const n={id:e[t],instrument:l(e,t+4),notes:[]},i=t+4+r(e,t+2),s=r(e,i);let o=i+2;for(;o<i+2+s;)n.notes.push(d(e,o,n.instrument.octave,!1)),o+=5+n.notes[n.notes.length-1].notes.length;return[n,o]}(e,t)}function u(e,t){const n={startFrequency:r(e,t+1),startVolume:r(e,t+3),steps:[]};for(let i=0;i<e[t];i++){const s=t+5+7*i;n.steps.push({waveform:e[s],frequency:r(e,s+1),volume:r(e,s+3),duration:r(e,s+5)})}return n}function d(e,t,n,i){const s={startTick:r(e,t),endTick:r(e,t+2),notes:[]};for(let r=0;r<e[t+4];r++)s.notes.push(p(e[t+5+r],n,i));return s}function p(e,t,n){const r=e>>6,i={note:n?e:(63&e)+12*(t-2),enharmonicSpelling:"normal"};return 1===r?i.enharmonicSpelling="flat":2===r&&(i.enharmonicSpelling="sharp"),i}function h(e,t){if(typeof e!=typeof t)return!1;if("object"!=typeof e)return e===t;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!h(e[n],t[n]))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n){if(-1===r.indexOf(i))return!1;if(!h(e[i],t[i]))return!1}return!0}function f(e){return{ticksPerBeat:8,beatsPerMeasure:4,beatsPerMinute:120,measures:e,tracks:[{id:0,name:lf("Dog"),notes:[],iconURI:"music-editor/dog.png",instrument:{waveform:1,octave:4,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024},pitchLFO:{frequency:5,amplitude:0}}},{id:1,name:lf("Duck"),notes:[],iconURI:"music-editor/duck.png",instrument:{waveform:15,octave:4,ampEnvelope:{attack:5,decay:530,sustain:705,release:450,amplitude:1024},pitchEnvelope:{attack:5,decay:40,sustain:0,release:100,amplitude:40},ampLFO:{frequency:3,amplitude:20},pitchLFO:{frequency:6,amplitude:2}}},{id:2,name:lf("Cat"),notes:[],iconURI:"music-editor/cat.png",instrument:{waveform:12,octave:5,ampEnvelope:{attack:150,decay:100,sustain:365,release:400,amplitude:1024},pitchEnvelope:{attack:120,decay:300,sustain:0,release:100,amplitude:50},pitchLFO:{frequency:10,amplitude:6}}},{id:3,name:lf("Fish"),notes:[],iconURI:"music-editor/fish.png",instrument:{waveform:1,octave:3,ampEnvelope:{attack:220,decay:105,sustain:1024,release:350,amplitude:1024},ampLFO:{frequency:5,amplitude:100},pitchLFO:{frequency:1,amplitude:4}}},{id:4,name:lf("Car"),notes:[],iconURI:"music-editor/car.png",instrument:{waveform:16,octave:4,ampEnvelope:{attack:5,decay:100,sustain:1024,release:30,amplitude:1024},pitchLFO:{frequency:10,amplitude:4}}},{id:5,name:lf("Computer"),notes:[],iconURI:"music-editor/computer.png",instrument:{waveform:15,octave:2,ampEnvelope:{attack:10,decay:100,sustain:500,release:10,amplitude:1024}}},{id:6,name:lf("Burger"),notes:[],iconURI:"music-editor/burger.png",instrument:{waveform:1,octave:2,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}}},{id:7,name:lf("Cherry"),notes:[],iconURI:"music-editor/cherry.png",instrument:{waveform:2,octave:3,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}}},{id:8,name:lf("Lemon"),notes:[],iconURI:"music-editor/lemon.png",instrument:{waveform:14,octave:2,ampEnvelope:{attack:5,decay:70,sustain:870,release:50,amplitude:1024},pitchEnvelope:{attack:10,decay:45,sustain:0,release:100,amplitude:20},ampLFO:{frequency:1,amplitude:50},pitchLFO:{frequency:2,amplitude:1}}},{id:9,name:lf("Drums"),notes:[],iconURI:"music-editor/explosion.png",instrument:{waveform:11,octave:4,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}},drums:[{startFrequency:100,startVolume:1024,steps:[{waveform:3,frequency:120,duration:10,volume:1024},{waveform:3,frequency:1,duration:100,volume:0}]},{startFrequency:200,startVolume:1024,steps:[{frequency:0,volume:0,duration:100,waveform:1}]},{startFrequency:100,startVolume:1024,steps:[{frequency:0,volume:0,duration:250,waveform:1}]},{startFrequency:175,startVolume:1024,steps:[{waveform:1,frequency:200,duration:10,volume:1024},{waveform:1,frequency:150,duration:20,volume:1024},{waveform:5,frequency:1,duration:20,volume:100},{waveform:5,frequency:1,duration:300,volume:0}]},{startFrequency:220,startVolume:1024,steps:[{waveform:1,frequency:250,duration:10,volume:1024},{waveform:1,frequency:200,duration:20,volume:1024},{waveform:5,frequency:2e3,duration:20,volume:100},{waveform:5,frequency:2e3,duration:200,volume:0}]},{startFrequency:400,startVolume:500,steps:[{frequency:450,volume:500,duration:10,waveform:5},{frequency:400,volume:20,duration:20,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:5,duration:50,waveform:5},{frequency:900,volume:0,duration:250,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:200,duration:50,waveform:5},{frequency:900,volume:5,duration:100,waveform:5},{frequency:900,volume:0,duration:400,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:200,duration:100,waveform:5},{frequency:900,volume:5,duration:200,waveform:5},{frequency:900,volume:0,duration:500,waveform:5}]},{startFrequency:3500,startVolume:1024,steps:[{frequency:4e3,volume:0,duration:10,waveform:4},{frequency:3500,volume:800,duration:1,waveform:4},{frequency:4e3,volume:0,duration:40,waveform:4},{frequency:3500,volume:400,duration:1,waveform:4},{frequency:4e3,volume:0,duration:40,waveform:4}]},{startFrequency:2e3,startVolume:1024,steps:[{frequency:1800,volume:15,duration:100,waveform:4},{frequency:1800,volume:0,duration:200,waveform:4}]},{startFrequency:200,startVolume:200,steps:[{frequency:125,volume:200,duration:25,waveform:14},{frequency:100,volume:15,duration:50,waveform:14},{frequency:120,volume:0,duration:250,waveform:14}]},{startFrequency:300,startVolume:200,steps:[{frequency:225,volume:200,duration:25,waveform:14},{frequency:200,volume:15,duration:50,waveform:14},{frequency:220,volume:0,duration:250,waveform:14}]},{startFrequency:500,startVolume:200,steps:[{frequency:425,volume:200,duration:25,waveform:14},{frequency:400,volume:15,duration:50,waveform:14},{frequency:420,volume:0,duration:250,waveform:14}]},{startFrequency:200,startVolume:1024,steps:[{frequency:75,volume:0,duration:200,waveform:1}]},{startFrequency:300,startVolume:1024,steps:[{frequency:200,volume:0,duration:200,waveform:1}]},{startFrequency:400,startVolume:1024,steps:[{frequency:300,volume:0,duration:200,waveform:1}]},{startFrequency:200,startVolume:1024,steps:[{frequency:200,volume:15,duration:100,waveform:4},{frequency:150,volume:0,duration:200,waveform:4}]},{startFrequency:450,startVolume:1024,steps:[{frequency:350,volume:15,duration:100,waveform:4},{frequency:300,volume:0,duration:100,waveform:4}]},{startFrequency:2500,startVolume:1024,steps:[{frequency:2500,volume:100,duration:150,waveform:4},{frequency:2550,volume:0,duration:500,waveform:4}]},{startFrequency:3e3,startVolume:1024,steps:[{frequency:3e3,volume:100,duration:300,waveform:4},{frequency:3060,volume:0,duration:500,waveform:4}]},{startFrequency:800,startVolume:0,steps:[{frequency:800,volume:1024,duration:10,waveform:4},{frequency:800,volume:0,duration:490,waveform:4}]},{startFrequency:400,startVolume:0,steps:[{frequency:400,volume:1024,duration:10,waveform:4},{frequency:400,volume:0,duration:400,waveform:4}]},{startFrequency:2e3,startVolume:1024,steps:[{frequency:2e3,volume:100,duration:150,waveform:16},{frequency:2e3,volume:0,duration:200,waveform:16}]}]}]}}t.encodeSongToHex=function(t){const r=function(e){const t=e.tracks.filter((e=>e.notes.length>0)).map(a),r=t.reduce(((e,t)=>t.length+e),0),i=new Uint8Array(7+r);i[0]=0,n(i,1,e.beatsPerMinute),i[3]=e.beatsPerMeasure,i[4]=e.ticksPerBeat,i[5]=e.measures,i[6]=t.length;let s=7;for(const e of t)i.set(e,s),s+=e.length;return i}(t);return e.U.toHex(r)},t.decodeSongFromHex=function(t){return function(e){const t={beatsPerMinute:r(e,1),beatsPerMeasure:e[3],ticksPerBeat:e[4],measures:e[5],tracks:[]};let n=7;for(;n<e.length;){const[r,i]=c(e,n);n=i,t.tracks.push(r)}return t}(e.U.fromHex(t))},t.cloneSong=function(e){return Object.assign(Object.assign({},e),{tracks:e.tracks.map((e=>Object.assign(Object.assign({},e),{instrument:e.instrument&&Object.assign(Object.assign({},e.instrument),{ampEnvelope:Object.assign({},e.instrument.ampEnvelope),pitchEnvelope:e.instrument.pitchEnvelope&&Object.assign({},e.instrument.pitchEnvelope),ampLFO:e.instrument.ampLFO&&Object.assign({},e.instrument.ampLFO),pitchLFO:e.instrument.pitchLFO&&Object.assign({},e.instrument.pitchLFO)}),drums:e.drums&&e.drums.map((e=>Object.assign(Object.assign({},e),{steps:e.steps.map((e=>Object.assign({},e)))}))),notes:e.notes.map((e=>Object.assign(Object.assign({},e),{notes:e.notes.slice()})))})))})},t.songEquals=function(e,t){return h(e,t)},t.inflateSong=function(e){const t=f(1);e.tracks=t.tracks.map(((t,n)=>{const r=e.tracks.find((e=>e.id===n));return r&&(t.notes=r.notes),t}))},t.getSongInfo=function(e){return{ticksPerBeat:e.ticksPerBeat,beatsPerMeasure:e.beatsPerMeasure,beatsPerMinute:e.beatsPerMinute,measures:e.measures}},t.getEmptySong=f}(t.music||(t.music={}))}(e.assets||(e.assets={}))}(pxt||(pxt={})),function(e){const t=["name","version","description","license","dependencies","files","testFiles","testDependencies","fileDependencies","public","targetVersions","supportedTargets","preferredEditor","languageRestriction","additionalFilePath","additionalFilePaths"];class n{constructor(e,t,n,r,i){this.id=e,this._verspec=t,this.parent=n,this.depName=i,this.level=-1,this.isLoaded=!1,this.ignoreTests=!1,this.cppOnly=!1,r&&(this.level=r.level+1),this.addedBy=[r]}static stringifyConfig(e){const n=e,r={};for(const e of t)n.hasOwnProperty(e)&&(r[e]=n[e]);for(const e of Object.keys(n))r.hasOwnProperty(e)||(r[e]=n[e]);return JSON.stringify(r,null,4)+"\n"}static parseAndValidConfig(t){const n=e.Util.jsonTryParse(t);return n&&void 0!==n.name&&"string"==typeof n.name&&n.files&&Array.isArray(n.files)&&n.files.every((e=>"string"==typeof e))&&n.dependencies&&Object.keys(n.dependencies).every((e=>"string"==typeof n.dependencies[e]))&&n}static async getConfigAsync(t,n,r){if(e.github.isGithubId(r)){const t=e.github.parseRepoId(r),n=await e.packagesConfigAsync();return await e.github.repoAsync(t.fullName,n)?await e.github.pkgConfigAsync(t.fullName,t.tag,n):null}if(r.startsWith("workspace:")){r.slice("workspace:".length);return null}if(!r.startsWith("pub:")){const i=e.patching.upgradePackageReference(t,n,r),s=e.appTarget.bundledpkgs[i];return JSON.parse(s[e.CONFIG_NAME])}{const t=r.slice("pub:".length);try{const n=await e.Cloud.downloadScriptFilesAsync(t);return JSON.parse(n[e.CONFIG_NAME])}catch(t){return e.log(`Unable to fetch files for published script '${r}'`),null}}}static corePackages(){const t=e.appTarget.bundledpkgs;return Object.keys(t).map((n=>JSON.parse(t[n][e.CONFIG_NAME]))).filter((e=>!!e))}disablesVariant(e){return this.config&&this.config.disablesVariants&&this.config.disablesVariants.indexOf(e)>=0}invalid(){return/^invalid:/.test(this.version())}version(){return this.resolvedVersion||this._verspec}verProtocol(){let e=this.version().split(":");return e.length>1?e[0]:""}verArgument(){let e=this.verProtocol();return e?this.version().slice(e.length+1):this.version()}targetVersion(){return this.parent&&this.parent!=this?this.parent.targetVersion():this.config.targetVersions?this.config.targetVersions.target:void 0}async commonDownloadAsync(){const t=this.verProtocol();let n;if("pub"==t)n=await e.Cloud.downloadScriptFilesAsync(this.verArgument());else if("github"==t){const t=await e.packagesConfigAsync();n=(await e.github.downloadPackageAsync(this.verArgument(),t)).files}else if("embed"==t)n=e.getEmbeddedScript(this.verArgument());else if("pkg"==t){const t=(this.parent||this).readFile(this.verArgument()),r=e.U.jsonTryParse(t);r||e.log(`unable to find ${this.verArgument()}`),n=r}return n}writeAssetPackFiles(){const t=JSON.parse(JSON.stringify(this.config));t.files=t.files.filter((e=>e.endsWith(".jres"))),t.files.push("gallery.ts"),t.dependencies={},t.assetPack=!0,this.config=t,this.saveConfig();let n="";for(const r of t.files){const t=this.readFile(r),i=e.U.jsonTryParse(t);if(i){const[t,s]=e.emitGalleryDeclarations(i,this.getNamespaceName());this.writeFile(r,JSON.stringify(t,null,4)),n+=s}}this.writeFile("gallery.ts",n)}getNamespaceName(){let e=this,t=e.addedBy[0];const n=[];for(;t&&t!==e;)e.depName&&n.push(e.depName),e=t,t=e.addedBy[0];return n.reverse().map((e=>ts.pxtc.escapeIdentifier(e))).join(".")}host(){return this.parent._host}readFile(e){return this.host().readFile(this,e)}writeFile(e,t){this.host().writeFile(this,e,t,!0)}readGitJson(){const t=this.readFile(e.github.GIT_JSON);return e.Util.jsonTryParse(t)}resolveDep(e){return this.parent.deps.hasOwnProperty(e)?this.parent.deps[e]:null}saveConfig(){const t=e.U.clone(this.config);delete t.additionalFilePaths;const n=e.Package.stringifyConfig(t);this.host().writeFile(this,e.CONFIG_NAME,n)}setPreferredEditor(e){this.config.preferredEditor!=e&&(this.config.preferredEditor=e,this.saveConfig())}getPreferredEditor(){let t=this.config.preferredEditor;if(!t){if(!(this.getFiles().indexOf(e.MAIN_BLOCKS)>=0))return e.JAVASCRIPT_PROJECT_NAME;const t=this.readFile(e.MAIN_BLOCKS),n=this.readFile(e.MAIN_TS);return!t&&n?e.JAVASCRIPT_PROJECT_NAME:e.BLOCKS_PROJECT_NAME}return t}parseJRes(t={}){for(const n of this.getFiles())e.U.endsWith(n,".jres")&&r(JSON.parse(this.readFile(n)),t);return t}isAssetPack(){var e;return this.level>0&&!!(null===(e=this.config)||void 0===e?void 0:e.assetPack)}resolveVersionAsync(){var t;let n=this._verspec;if(e.getEmbeddedScript(this.id))this.resolvedVersion=n="embed:"+this.id;else if(n&&"*"!=n){if("github"==this.verProtocol()){const r=e.github.parseRepoId(this._verspec);if(r&&!r.tag&&this.parent){e.debug("dep: unbound github extensions, trying to resolve tag");const i=e.semver.sortLatestTags(e.Util.values((null===(t=this.parent)||void 0===t?void 0:t.deps)||{}).map((t=>e.github.parseRepoId(t.version()))).filter((e=>(null==e?void 0:e.slug)===r.slug)).map((e=>e.tag)))[0];i&&(r.tag=i,this.resolvedVersion=n=e.github.stringifyRepo(r),e.debug(`dep: github patched ${this._verspec} to ${n}`))}}}else this.configureAsInvalidPackage(lf("version not specified for {0}",this.id)),n=this._verspec;return Promise.resolve(n)}downloadAsync(){return this.resolveVersionAsync().then((t=>{if(this.invalid())e.debug(`skip download of invalid package ${this.id}`);else if(/^embed:/.test(t)||this.installedVersion!=t)return e.debug("downloading "+t),this.host().downloadPackageAsync(this).then((()=>{this.loadConfig(),this.isAssetPack()&&this.writeAssetPackFiles(),e.debug(`installed ${this.id} /${t}`)}))}))}loadConfig(){if(0!=this.level&&this.invalid())return;const t=this.readFile(e.CONFIG_NAME);t||e.U.userError(`extension ${this.id} is missing ${e.CONFIG_NAME}`),this.parseConfig(t),0!=this.level&&(this.installedVersion=this.version()),this.saveConfig()}validateConfig(){this.config.dependencies||e.U.userError("Missing dependencies in config of: "+this.id),Array.isArray(this.config.files)||e.U.userError("Missing files in config of: "+this.id),"string"==typeof this.config.name&&this.config.name||(this.config.name=lf("Untitled")),this.config.targetVersions&&this.config.targetVersions.target&&this.config.targetVersions.targetId===e.appTarget.id&&e.appTarget.versions&&e.semver.majorCmp(this.config.targetVersions.target,e.appTarget.versions.target)>0&&e.U.userError(lf("{0} requires target version {1} (you are running {2})",this.config.name,this.config.targetVersions.target,e.appTarget.versions.target))}isPackageInUse(t,n=this.readFile(e.MAIN_TS)){let r=null;const i=e.patching.computePatches(this.targetVersion(),"missingPackage");return i&&i.forEach((e=>{Object.keys(e.map).forEach((n=>{e.map[n]===t&&(r=new RegExp(n,"g"))}))})),r||(r=new RegExp(t+"\\.","g")),r.test(n)}upgradePackagesAsync(){return this.config||this.loadConfig(),e.packagesConfigAsync().then((t=>{let n=0,r={};return e.U.iterMap(this.config.dependencies,((i,s)=>{if(e.github.isGithubId(s)){const o=e.github.upgradedPackageReference(t,s);o&&o!=s&&(e.log(`upgrading dep ${i}: ${s} -> ${o}`),r[s]=o,this.config.dependencies[i]=o,n++)}})),n&&this.saveConfig(),n&&r}))}getMissingPackages(t,n){const r=e.patching.computePatches(this.targetVersion(),"missingPackage"),i={};return n&&r&&r.forEach((e=>{Object.keys(e.map).forEach((r=>{const s=new RegExp(r,"g"),o=e.map[r];n.replace(s,(e=>(t.dependencies[o]||(i[o]="*"),"")))}))})),i}findConflictsAsync(t,r){let i,s=[];return Promise.resolve().then((()=>"string"==typeof t?n.getConfigAsync(this.targetVersion(),t,r):Promise.resolve(t))).then((t=>{var n;if(i=t,i){const t=i.yotta?e.U.jsonFlatten(i.yotta.config):null;this.parent.sortedDeps().forEach((n=>{if(i.core&&n.config.core&&i.name!=n.config.name){const t=new e.cpp.PkgConflictError(lf("conflict between core extensions {0} and {1}",i.name,n.id));return t.pkg0=n,void s.push(t)}let o=!1;if(t){const r=n.config||JSON.parse(n.readFile(e.CONFIG_NAME));if(!!r&&!!r.yotta&&!!n.config.yotta.config){const a=e.U.jsonFlatten(r.yotta.config);for(const l of Object.keys(t)){const c=a[l],u=i.yotta.configIsJustDefaults||r.yotta.configIsJustDefaults;if(a.hasOwnProperty(l)&&c!==t[l]&&!u&&(!n.parent.config.yotta||!n.parent.config.yotta.ignoreConflicts)){const t=new e.cpp.PkgConflictError(lf("conflict on yotta setting {0} between extensions {1} and {2}",l,i.name,n.id));t.pkg0=n,t.settingName=l,s.push(t),o=!0}}}}if(!o&&i.name===n.id&&n._verspec!==r&&!/^file:/.test(n._verspec)&&!/^file:/.test(r)){const t=/^github:/.test(n._verspec)&&e.github.parseRepoId(n._verspec),i=/^github:/.test(r)&&e.github.parseRepoId(r);if(!t||!i||t.fullName!==i.fullName||i.tag&&e.semver.strcmp(t.tag,i.tag)<0){const t=new e.cpp.PkgConflictError(lf("version mismatch for extension {0} (added: {1}, adding: {2})",n.id,n._verspec,r));t.pkg0=n,t.isVersionConflict=!0,s.push(t)}}}))}return Object.keys(null!==(n=null==i?void 0:i.dependencies)&&void 0!==n?n:{}).reduce(((e,t)=>e.then((()=>this.findConflictsAsync(t,i.dependencies[t]))).then((e=>s.push.apply(s,e)))),Promise.resolve())})).then((()=>{const t=e=>{const n=[];return e.addedBy.forEach((e=>{e.id!==this.id&&(n.push.apply(t(e)),n.push(e))})),n},n=[];return s.forEach((s=>{n.push.apply(n,t(s.pkg0).map((t=>{const n=new e.cpp.PkgConflictError(s.isVersionConflict?lf("a dependency of {0} has a version mismatch with extension {1} (added: {1}, adding: {2})",t.id,i.name,s.pkg0._verspec,r):lf("conflict on yotta setting {0} between extensions {1} and {2}",s.settingName,i.name,s.pkg0.id));return n.pkg0=t,n})))})),s.push.apply(s,n),s=s.filter(((e,t)=>{for(let n=0;n<t;++n)if(e.pkg0.id===s[n].pkg0.id)return!1;return!0})),s}))}configureAsInvalidPackage(t){e.log(`invalid package ${this.id}: ${t}`),this._verspec="invalid:"+this.id,this.config={name:this.id,description:t,dependencies:{},files:[]}}parseConfig(t,n){try{const e=JSON.parse(t);this.config=e}catch(t){this.configureAsInvalidPackage(lf("Syntax error in pxt.json")),e.tickEvent("package.invalidConfigEncountered")}const r=JSON.stringify(this.config);for(const t in this.config.dependencies){const n=e.patching.upgradePackageReference(this.targetVersion(),t,this.config.dependencies[t]);n!=t&&(delete this.config.dependencies[t],n&&(this.config.dependencies[n]="*"))}n&&(this.config.targetVersions={target:n}),JSON.stringify(this.config)!=r&&this.saveConfig(),this.validateConfig()}patchCorePackage(){e.Util.assert(e.appTarget.simulator&&e.appTarget.simulator.dynamicBoardDefinition),e.Util.assert(0==this.level);const t=Object.keys(this.config.dependencies).filter((t=>!!t&&(t==e.BLOCKS_PROJECT_NAME||t==e.JAVASCRIPT_PROJECT_NAME||JSON.parse((e.appTarget.bundledpkgs[t]||{})[e.CONFIG_NAME]||"{}").core)));if(0==t.length){const t=e.Package.corePackages();t.length&&this.config.dependencies[t[0].name]}else t.length>1&&(t.pop(),t.forEach((t=>{e.log(`removing core package ${t}`),delete this.config.dependencies[t]})))}resolvedDependencies(){return Object.keys(this.dependencies()).map((e=>this.resolveDep(e)))}dependencies(t=!1){if(!this.config)return{};const n=e.Util.clone(this.config.dependencies||{});return 0==this.level&&this.config.testDependencies&&e.Util.iterMap(this.config.testDependencies,((t,r)=>{("*"!=r||e.appTarget.bundledpkgs[t])&&(n[t]=r)})),t&&this.config.cppDependencies&&e.Util.jsonMergeFrom(n,this.config.cppDependencies),n}async loadAsync(t=!1,r){var i;if(this.isLoaded)return;0!=this.level||e.appTarget.multiVariants||e.setAppTargetVariant(null),this.isLoaded=!0;const s=this.readFile(e.CONFIG_NAME);if(null==s?t||e.U.userError("Package not installed: "+this.id+", did you forget to run `pxt install`?"):this.parseConfig(s),0!=this.level||t||await this.upgradePackagesAsync(),t&&(await this.downloadAsync(),0!==this.level&&!this.isAssetPack()))for(const e of this.addedBy)if(null===(i=e.config.assetPacks)||void 0===i?void 0:i[this.id]){this.writeAssetPackFiles();break}if(0==this.level&&t){const t=await this.upgradePackagesAsync();t&&(Object.keys(t).forEach((t=>e.tickEvent("package.doubleload",{extension:t}))),e.log("upgraded, downloading again"),e.debug(t),await this.downloadAsync())}if(e.appTarget.simulator&&e.appTarget.simulator.dynamicBoardDefinition&&(0==this.level&&this.patchCorePackage(),this.config.compileServiceVariant&&e.setAppTargetVariant(this.config.compileServiceVariant),this.config.files.indexOf("board.json")>=0)){const t=e.appTarget.simulator.boardDefinition=JSON.parse(this.readFile("board.json"));t.id=this.config.name,e.appTarget.appTheme.boardName=t.boardName||lf("board"),e.appTarget.appTheme.driveDisplayName=t.driveDisplayName||lf("DRIVE");let n=t=>{let n=/^pkg:\/\/(.*)/.exec(t);if(n){let t=n[1],r=this.readFile(t);return e.U.toDataUri(r,e.U.getMime(t))}return t},r=e.appTarget.simulator.boardDefinition;if("object"==typeof r.visual){let e=r.visual;e.image=n(e.image),e.outlineImage=n(e.outlineImage)}}const o=(t,n)=>{var r;if(e.debug(`version spec mismatch: ${t._verspec} != ${n}`),/^github:/.test(t._verspec)&&/^github:/.test(n)){const i=e.github.parseRepoId(t._verspec),s=e.github.parseRepoId(n);if((null==i?void 0:i.slug)&&(null==i?void 0:i.slug)===(null==s?void 0:s.slug)){const o=(null==i?void 0:i.tag)||(null===(r=t.config)||void 0===r?void 0:r.version),a=s.tag;if(o&&!a)return void e.debug(`unversioned ${n}, using ${o}`);const l=e.semver.strcmp(o,s.tag);if(0==l)return void e.debug(`resolved version are ${o}`);if(l>0)return void e.debug(`auto-upgraded ${n} to ${o}`)}}/^file:/.test(t._verspec)||/^file:/.test(n)?e.debug("ignore file: mismatch issues"):t.configureAsInvalidPackage(lf("version mismatch"))},a=async(r,i,s=!1)=>{r||(r=i.dependencies(s)),e.debug(`deps: ${i.id}->${Object.keys(r).join(", ")}`),r=e.github.resolveMonoRepoVersions(r),e.debug(`deps: resolved ${i.id}->${Object.keys(r).join(", ")}`);for(let a of Object.keys(r)){let l=r[a]||"*";e.debug(`dep: load ${i.id}.${a}${s?"++":""}: ${l}`),"hw"==a&&e.hwVariant&&(a="hw---"+e.hwVariant);const c=e.github.parseRepoId(l);if(null==c?void 0:c.slug){const t=Object.values(i.parent.deps).map((t=>e.github.parseRepoId(t._verspec))).filter((e=>(null==e?void 0:e.slug)===c.slug)).map((e=>e.tag)).reduce(((t,n)=>e.semver.strcmp(t,n)>0?t:n),"0.0.0");e.debug(`dep: common repo ${c.slug} version found ${t}`),e.semver.strcmp(t,"0.0.0")>0&&(!c.tag||e.semver.strcmp(t,c.tag)>0)&&(e.debug(`dep: upgrade from ${c.tag} to ${t}`),c.tag=t,l=e.github.stringifyRepo(c,!0))}let u=i.resolveDep(a);if(u){if(u.invalid()||u._verspec===l||o(u,l),u.invalid()){u.level=Math.min(u.level,i.level+1),u.addedBy.push(i);continue}s||(u.level=Math.min(u.level,i.level+1),u.addedBy.push(i))}else u=new n(a,l,i.parent,i,a),s&&(u.cppOnly=!0),i.parent.deps[a]=u,i.parent.deps[a.replace(/---.*/,"")]=u,await u.loadAsync(t)}};if(await a(null,this),this.patchAppTargetPalette(),this.config.screenSize&&e.appTarget.runtime&&(e.appTarget.runtime.screenSize=e.U.clone(this.config.screenSize)),0===this.level){const t=this.readFile(e.MAIN_TS);if(t){const n=this.getMissingPackages(this.config,t);let r=!1;for(const t of Object.keys(n)){const i=await this.findConflictsAsync(t,n[t]);if(i.length){const n=i.map((e=>e.pkg0.id)).join(", "),r=i.map((e=>e.settingName)).filter((e=>!!e)).join(", ");e.log(`skipping missing package ${t} because it conflicts with the following packages: ${n} (conflicting settings: ${r})`)}else{e.log(`adding missing package ${t}`),r=!0,this.config.dependencies[t]="*";const i={};i[t]=n[t],await a(i,this)}}r&&(this.saveConfig(),this.validateConfig())}await Promise.all(e.U.values(this.parent.deps).map((e=>a(null,e,!0))))}e.debug(`  installed ${this.id}`)}getFiles(){let t;t=0!=this.level||this.ignoreTests?this.config.files.slice(0):this.config.files.concat(this.config.testFiles||[]);const r=this.config.fileDependencies;return this.config.fileDependencies&&(t=t.filter((t=>{const i=r=>{if("!"==(r=r.trim())[0])return!i(r.slice(1));if(/^[\w-]+$/.test(r)){const e=this.parent.resolveDep(r);return!(!e||e.cppOnly)}const s=/^target:(\w+)$/.exec(r);return s?s[1]==e.appTarget.id||s[1]==e.appTarget.platformid:(n.depWarnings[r]||(n.depWarnings[r]=!0,e.log(`invalid dependency expression: ${r} in ${this.id}/${t}`)),!1)},s=e.U.lookup(r,t);return!s||!s.trim()||s.split("||").some((e=>e.split("&&").every(i)))}))),t}addSnapshot(t,n=[""]){for(let r of this.getFiles())n.some((t=>e.U.endsWith(r,t)))&&(t[this.id+"/"+r]=this.readFile(r));t[this.id+"/"+e.CONFIG_NAME]=this.readFile(e.CONFIG_NAME)}packageLocalizationStringsAsync(t){const n=e.appTarget.id,r=[this.config.name+"-jsdoc",this.config.name],i={};e.appTarget.appTheme;return this.config.skipLocalization?Promise.resolve(i):e.Util.liveLocalizationEnabled()&&"this"!=this.id&&e.appTarget.bundledpkgs[this.id]?(e.debug(`loading live translations for ${this.id}`),Promise.all(r.map((r=>e.Util.downloadLiveTranslationsAsync(t,`${n}/${r}-strings.json`).then((n=>{n&&Object.keys(n).length?e.Util.jsonMergeFrom(i,n):(e.tickEvent("translations.livetranslationsfailed",{filename:r}),e.Util.jsonMergeFrom(i,this.bundledStringsForFile(t,r)))})).catch((s=>{e.tickEvent("translations.livetranslationsfailed",{filename:r}),e.log(`error while downloading ${n}/${r}-strings.json`),e.Util.jsonMergeFrom(i,this.bundledStringsForFile(t,r))}))))).then((()=>i))):(r.map((e=>this.bundledStringsForFile(t,e))).filter((e=>!!e)).forEach((t=>e.Util.jsonMergeFrom(i,t))),Promise.resolve(i))}bundledStringsForFile(t,n){let r={},[i,s,o]=e.Util.normalizeLanguageCode(t);const a=this.config.files;let l=`_locales/${i}/${n}-strings.json`;if(o&&-1===a.indexOf(l)&&(l=`_locales/${o}/${n}-strings.json`),s&&-1===a.indexOf(l)&&(l=`_locales/${s}/${n}-strings.json`),a.indexOf(l)>-1)try{r=JSON.parse(this.readFile(l))}catch(n){e.reportError("extension","Extension localization JSON failed to parse",{fileName:l,lang:t,extension:this.verArgument()});"github"===this.verProtocol()&&e.tickEvent("loc.errors.json",{repo:this.verArgument(),file:l})}return r}patchAppTargetPalette(){this.config.palette&&e.appTarget.runtime&&(e.appTarget.runtime.palette=e.U.clone(this.config.palette),this.config.paletteNames&&(e.appTarget.runtime.paletteNames=this.config.paletteNames))}}n.depWarnings={},e.Package=n;function r(e,t={}){let n=e["*"]||{};for(let r of Object.keys(e)){if("*"==r)continue;let i=e[r];"string"==typeof i&&(i={data:i});let s=i.namespace||n.namespace||"";s&&!s.endsWith(".")&&(s+=".");let o=i.id||s+r,a=i.icon,l=i.mimeType||n.mimeType,c=i.dataEncoding||n.dataEncoding||"base64";a||"base64"!=c||"image/png"!=l&&"image/jpeg"!=l||(a="data:"+l+";base64,"+i.data),t[o]={id:o,data:i.data,dataEncoding:c,icon:a,namespace:s,mimeType:l,tilemapTile:i.tilemapTile,displayName:i.displayName,tileset:i.tileset,tags:i.tags}}return t}e.MainPackage=class extends n{constructor(e){super("this","file:.",null,null,null),this._host=e,this.deps={},this.parent=this,this.addedBy=[this],this.level=0,this.deps[this.id]=this}installAllAsync(e){return this.loadAsync(!0,e)}sortedDeps(t=!1){let n={},r=[];const i=e=>e.config?Object.keys(e.config.cppDependencies||{}).length:0,s=o=>{if(!o||e.U.lookup(n,o.id))return;n[o.id]=!0;const a=Object.keys(o.dependencies(t)).map((e=>this.resolveDep(e)));a.sort(((t,n)=>i(n)-i(t)||e.U.strcmp(t.id,n.id))),a.forEach(s),r.push(o.id)};return s(this),r.map((e=>this.resolveDep(e)))}localizationStringsAsync(t){const n={};return Promise.all(e.Util.values(this.deps).map((e=>e.packageLocalizationStringsAsync(t).then((e=>{e&&Object.keys(e).forEach((t=>{n[t]||(n[t]=e[t])}))}))))).then((()=>{const t=e.U.getLocalizedStrings();return Object.keys(n).forEach((r=>{(e.U.startsWith(r,"{id:subcategory}")||e.U.startsWith(r,"{id:group}"))&&(t[r]||(t[r]=n[r]))})),e.U.setLocalizedStrings(t),Promise.resolve(n)}))}getTargetOptions(){let t=e.U.clone(e.appTarget.compile);return e.U.assert(!!t),t.utf8||this.sortedDeps(!0).forEach((n=>{n.config&&n.config.utf8&&(e.debug("forcing utf8 mode: pkg="+n.id),t.utf8=!0)})),t}getJRes(){if(!this._jres){this._jres={};for(const e of this.sortedDeps())e.parseJRes(this._jres);const t=(e.appTarget.runtime&&e.appTarget.runtime.palette?e.appTarget.runtime.palette:["#000000","#ffffff"]).map((e=>("000000"+parseInt(e.replace(/#/,""),16).toString(16)).slice(-6))).join("");this._jres.__palette={id:"__palette",data:t,dataEncoding:"hex",mimeType:"application/x-palette"}}return this._jres}updateJRes(){this._jres&&this.parseJRes(this._jres)}resolveBannedCategories(){if(void 0!==this._resolvedBannedCategories)return this._resolvedBannedCategories;let t=[];return e.appTarget&&e.appTarget.runtime&&e.appTarget.runtime.bannedCategories&&e.appTarget.runtime.bannedCategories.length&&(t=e.appTarget.runtime.bannedCategories.slice(),Object.keys(this.deps).map((e=>this.deps[e])).filter((e=>!!e)).map((t=>e.Util.jsonTryParse(t.readFile(e.CONFIG_NAME)))).filter((e=>e&&e.requiredCategories)).forEach((e=>e.requiredCategories.forEach((e=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)})))),this._resolvedBannedCategories=t),this._resolvedBannedCategories=t,this._resolvedBannedCategories.length||(this._resolvedBannedCategories=null),this._resolvedBannedCategories}async getCompileOptionsAsync(t=this.getTargetOptions()){let n={sourceFiles:[],fileSystem:{},target:t,name:this.config?this.config.name:""};const r=(t,n)=>{this.config.files.indexOf(t)<0&&e.U.userError(lf("please add '{0}' to \"files\" in {1}",t,e.CONFIG_NAME)),n="// Auto-generated. Do not edit.\n"+n+"\n// Auto-generated. Do not edit. Really.\n",this.host().readFile(this,t,!0)!==n&&(e.debug(`updating ${t} (size=${n.length})...`),this.host().writeFile(this,t,n,!0))};let i=!1;const s=async n=>{const s={extinfo:null,target:null},o=e.appTargetVariant;n&&e.setAppTargetVariant(n,{temporary:!0});try{let a=e.cpp.getExtensionInfo(this);i||!a.shimsDTS&&!a.enumsDTS||(i=!0,a.shimsDTS&&r("shims.d.ts",a.shimsDTS),a.enumsDTS&&r("enums.d.ts",a.enumsDTS));const l=t.isNative?await this.host().getHexInfoAsync(a):null;a=e.U.flatClone(a),t.keepCppFiles||(delete a.compileData,delete a.generatedFiles,delete a.extensionFiles),a.hexinfo=l,s.extinfo=a,s.target=e.appTarget.compile}finally{n&&e.setAppTargetVariant(o,{temporary:!0})}return s};let o;await this.loadAsync(),n.bannedCategories=this.resolveBannedCategories(),e.debug(`building: ${this.sortedDeps().map((e=>e.config.name)).join(", ")}`),o=e.appTarget.multiVariants?e.appTargetVariant?[e.appTargetVariant]:e.appTarget.alwaysMultiVariant||e.appTarget.compile.switches.multiVariant?e.appTarget.multiVariants:[e.appTarget.multiVariants[0]]:[null];let a=null;for(let t of o){a&&e.debug(`building for ${t}`);const r=await s(t),i=r.extinfo;i.appVariant=t,i.outputPrefix=1!=o.length&&t?t+"-":"",a?n.otherMultiVariants.push(r):(r.target.isNative=n.target.isNative,n.target=r.target,a=i,n.otherMultiVariants=[])}n.extinfo=a,n.target.preferredEditor=this.getPreferredEditor();if(!(e.appTarget.compile.shortPointers||"vm"==e.appTarget.compile.nativeType||this.config.binaryonly||!n.target.isNative)){const t=await this.filesToBePublishedAsync(!0),r=JSON.stringify({name:this.config.name,comment:this.config.description,status:"unpublished",scriptId:this.installedVersion,cloudId:e.CLOUD_ID+e.appTarget.id,editor:this.getPreferredEditor(),targetVersions:e.appTarget.versions}),i=JSON.stringify(t),s=await e.lzmaCompressAsync(r+i);s&&(n.embedMeta=JSON.stringify({compression:"LZMA",headerSize:r.length,textSize:i.length,name:this.config.name,eURL:e.appTarget.appTheme.embedUrl,eVER:e.appTarget.versions?e.appTarget.versions.target:"",pxtTarget:e.appTarget.id}),n.embedBlob=ts.pxtc.encodeBase64(e.U.uint8ArrayToString(s)))}for(const e of this.sortedDeps())for(const t of e.getFiles())if(/\.(ts|asm|py)$/.test(t)){let r=t;e.level>0&&(r="pxt_modules/"+e.id+"/"+t),n.sourceFiles.push(r),n.fileSystem[r]=e.readFile(t)}n.jres=this.getJRes();const l=e.appTarget.runtime&&e.appTarget.runtime.functionsOptions;n.allowedArgumentTypes=l&&l.extraFunctionEditorTypes&&l.extraFunctionEditorTypes.map((e=>e.typeName)).concat("number","boolean","string");for(const e of this.sortedDeps())e.patchAppTargetPalette();return this.patchAppTargetPalette(),n}prepareConfigToBePublished(){const t=e.U.clone(this.config);return delete t.installedVersion,delete t.additionalFilePath,delete t.additionalFilePaths,t.targetVersions||(t.targetVersions=e.Util.clone(e.appTarget.versions)),e.U.iterMap(t.dependencies,((n,r)=>{if(!r||/^(file|workspace):/.test(r)){r="*";try{const t=this.resolveDep(n).readGitJson();if(t&&t.repo){let n=e.github.parseRepoId(t.repo);n.tag=t.commit.tag||t.commit.sha,r=e.github.stringifyRepo(n)}}catch(e){}t.dependencies[n]=r}})),t}filesToBePublishedAsync(t=!1){const n={};return this.loadAsync().then((()=>{t||this.config.public||e.U.userError('Only packages with "public":true can be published');const r=this.prepareConfigToBePublished();n[e.CONFIG_NAME]=e.Package.stringifyConfig(r);for(let t of this.getFiles()){if(t==e.CONFIG_NAME)continue;let r=this.readFile(t);null==r&&e.U.userError("referenced file missing: "+t),n[t]=r}return e.U.sortObjectFields(n)}))}saveToJsonAsync(){return this.filesToBePublishedAsync(!0).then((t=>({meta:{cloudId:e.CLOUD_ID+e.appTarget.id,targetVersions:e.appTarget.versions,editor:this.getPreferredEditor(),name:this.config.name},source:JSON.stringify(t,null,2)})))}compressToFileAsync(){return this.saveToJsonAsync().then((t=>e.lzmaCompressAsync(JSON.stringify(t,null,2))))}computePartDefinitions(t){if(!t||!t.length)return{};let n={};return this.sortedDeps().forEach((r=>{let i=r.readFile("pxtparts.json");if(i)try{let s=JSON.parse(i);Object.keys(s).forEach((i=>{if(t.indexOf(i)>=0){let t=n[i]=s[i];if("string"==typeof t.visual.image&&/\.svg$/i.test(t.visual.image)){let n=r.readFile(t.visual.image);n||e.reportError("parts","invalid part definition",{error:`missing visual ${t.visual.image}`}),/^data:image\/svg\+xml/.test(n)||(n="data:image/svg+xml,"+encodeURIComponent(n)),t.visual.image=n}}}))}catch(t){e.reportError("parts","invalid pxtparts.json file")}})),n}},e.inflateJRes=r,e.allPkgFiles=function(t){return[e.CONFIG_NAME].concat(t.files||[]).concat(t.testFiles||[])},e.isPkgBeta=function(e){return e&&/\bbeta\b/.test(e.description)}}(pxt||(pxt={})),function(e){!function(t){let n,r,i,s,o,a=()=>{};function l(){if(o)return o;let t=Promise.resolve();if(n){e.debug("packetio: disconnect");const i=n;t=t.then((()=>i.disconnectAsync())).then((()=>i.io.disposeAsync())).catch((t=>{e.reportException(t)})).finally((()=>{r=void 0,n=void 0,o=void 0})),a&&(t=t.then((()=>a()))),o=t}return t}t.isActive=function(){return!!n},t.isConnected=function(){return!!(null==n?void 0:n.isConnected())},t.isConnecting=function(){return!!(null==n?void 0:n.isConnecting())},t.icon=function(){var t;return!!n&&(n.icon||(null===(t=e.appTarget.appTheme.downloadDialogTheme)||void 0===t?void 0:t.deviceIcon)||"usb")},t.unsupportedParts=function(){return(null==n?void 0:n.unsupportedParts)?n.unsupportedParts():[]},t.deviceVariant=function(){return null==n?void 0:n.devVariant},t.disconnectAsync=l,t.configureEvents=function(e,t,r){a=e,i=t,s=r,n&&(n.io.onConnectionChanged=a,n.onSerial=i,n.onCustomEvent=r)},t.sendCustomEventAsync=function(e,t){return n?n.sendCustomEventAsync(e,t):Promise.resolve()},t.initAsync=function(o=!1){if(e.debug("packetio: init "+(o?"(force)":"")),!r){let c=Promise.resolve();o&&(c=c.then((()=>l()))),r=c.then((()=>n?Promise.resolve(n):t.mkPacketIOAsync?(e.debug("packetio: new wrapper"),t.mkPacketIOAsync().then((e=>(e.onConnectionChanged=a,n=t.mkPacketIOWrapper(e),i&&(n.onSerial=i),s&&(n.onCustomEvent=s),a&&a(),n)))):(e.debug("packetio: not defined, skipping"),Promise.resolve(void 0)))).finally((()=>{r=void 0}))}return r}}(e.packetio||(e.packetio={}))}(pxt||(pxt={})),function(e){!function(t){function n(t,n,r){const i=e.semver.tryParse(t||"0.0.0")||e.semver.tryParse("0.0.0");let s=[];return Object.keys(n).filter((t=>e.semver.inRange(t,i))).forEach((e=>s=s.concat(n[e]))),r&&(s=s.filter((e=>e.type==r))),s.length?s:void 0}function r(e,t,n){let r=t;return n&&(n.filter((e=>"api"===e.type)).forEach((e=>{Object.keys(e.map).forEach((t=>{const n=new RegExp(t,"g");r=r.replace(n,e.map[t])}))})),n.filter((e=>"userenum"===e.type)).forEach((e=>{Object.keys(e.map).forEach((t=>{const n=new RegExp("enum\\s+"+t+"\\s*{","gm");r=r.replace(n,`enum ${e.map[t]} {`);const i=new RegExp(`(^|[^_a-zA-Z0-9])${t}(\\s*\\.)`,"g");r=r.replace(i,`$1${e.map[t]}$2`)}))}))),r}t.computePatches=function(t,r){const i=e.appTarget.compile?e.appTarget.compile.patches:void 0;if(i)return n(t,i,r)},t.computePyPatches=function(t,r){const i=e.appTarget.compile?e.appTarget.compile.pyPatches:void 0;if(i)return n(t,i,r)},t.upgradePackageReference=function(t,n,r){if("*"!=r)return n;const i=e.patching.computePatches(t,"package");let s=n;return i&&i.forEach((e=>{Object.keys(e.map).forEach((t=>{s==t&&(s=e.map[t])}))})),s},t.patchJavaScript=function(t,n){return r(t,n,e.patching.computePatches(t))},t.patchPython=function(t,n){return r(t,n,e.patching.computePyPatches(t))}}(e.patching||(e.patching={}))}(pxt||(pxt={})),function(e){e.react||(e.react={})}(pxt||(pxt={})),function(e){!function(t){function n(t,n){if(t){if(n){let r=t.major-n.major||t.minor-n.minor||t.patch-n.patch;if(r)return r;if(0==t.pre.length&&n.pre.length>0)return 1;if(t.pre.length>0&&0==n.pre.length)return-1;for(let i=0;i<t.pre.length+1;++i){let s=t.pre[i],o=n.pre[i];if(!s)return o?-1:0;if(!o)return 1;if(/^\d+$/.test(s)){if(!/^\d+$/.test(o))return-1;if(r=parseInt(s)-parseInt(o),r)return r}else{if(/^\d+$/.test(o))return 1;if(r=e.U.strcmp(s,o),r)return r}}return 0}return-1}return n?1:0}function r(t,n){let r=i(t)||i(n);return r||e.U.userError(e.U.lf("'{0}' doesn't look like a semantic version number",t)),r}function i(e){if(!e)return null;if("*"===e)return{major:Number.MAX_SAFE_INTEGER,minor:Number.MAX_SAFE_INTEGER,patch:Number.MAX_SAFE_INTEGER,pre:[],build:[]};/^v\d/i.test(e)&&(e=e.slice(1));let t=/^(\d+)\.(\d+)\.(\d+)(-([0-9a-zA-Z\-\.]+))?(\+([0-9a-zA-Z\-\.]+))?$/.exec(e);return t?{major:parseInt(t[1]),minor:parseInt(t[2]),patch:parseInt(t[3]),pre:t[5]?t[5].split("."):[],build:t[7]?t[7].split("."):[]}:null}function s(e){let t=e.major+"."+e.minor+"."+e.patch;return e.pre.length&&(t+="-"+e.pre.join(".")),e.build.length&&(t+="+"+e.build.join(".")),t}function o(t,r){let s=i(t),o=i(r);return s||o?n(s,o):e.U.strcmp(t,r)}function a(e,t){let r=e.split(" - ");if(2!=r.length)return!1;let s=i(r[0]),o=i(r[1]);if(!s||!o)return!1;if(!t)return!0;const a=n(s,t),l=n(t,o);return a<=0&&l<0}t.cmp=n,t.parse=r,t.tryParse=i,t.normalize=function(e){return s(r(e))},t.stringify=s,t.majorCmp=function(e,t){let n=i(e),r=i(t);return n.major-r.major},t.strcmp=o,t.inRange=a,t.sortLatestTags=function(e){const n=e.filter((e=>!!t.tryParse(e)));return n.sort(o),n.reverse(),n},t.test=function(){console.log("Test semver");let t=["0.9.0","1.0.0-0.3.7","1.0.0-alpha","1.0.0-alpha.1","1.0.0-alpha.beta","1.0.0-beta","1.0.0-beta.2","1.0.0-beta.11","1.0.0-rc.1","1.0.0-x.7.z.92","1.0.0","1.0.1","1.9.0","1.10.0","1.11.0"];for(let i=0;i<t.length;++i){let o=r(t[i]);console.log(t[i],o),e.U.assert(s(o)==t[i]);for(let s=0;s<t.length;++s){let a=n(o,r(t[s]));console.log(t[i],t[s],a),i<s?e.U.assert(a<0):i>s?e.U.assert(a>0):e.U.assert(0==a)}}const o=i("1.2.3");e.U.assert(a("0.1.2 - 2.2.3",o)),e.U.assert(a("1.2.3 - 2.2.3",o)),e.U.assert(!a("0.0.0 - 1.2.3",o)),e.U.assert(!a("1.2.4 - 4.2.3",o)),e.U.assert(!a("0.0.0 - 0.0.1",o))}}(e.semver||(e.semver={}))}(pxt||(pxt={})),function(e){!function(e){function t(t){return e.Util.values(t.byQName).filter((e=>e.attributes.block&&/^{[^:]+:[^}]+}/.test(e.attributes.block))).forEach((e=>{e.attributes.block=e.attributes.block.replace(/^{[^:]+:[^}]+}/,"")})),t}e.assert=e.Util.assert,e.oops=e.Util.oops,e.U=e.Util,e.ON_START_TYPE="pxt-on-start",e.ON_START_COMMENT="on start",e.HANDLER_COMMENT="code goes here",e.TS_STATEMENT_TYPE="typescript_statement",e.TS_DEBUGGER_TYPE="debugger_keyword",e.TS_BREAK_TYPE="break_keyword",e.TS_CONTINUE_TYPE="continue_keyword",e.TS_OUTPUT_TYPE="typescript_expression",e.TS_RETURN_STATEMENT_TYPE="function_return",e.PAUSE_UNTIL_TYPE="pxt_pause_until",e.COLLAPSED_BLOCK="pxt_collapsed_block",e.FUNCTION_DEFINITION_TYPE="function_definition",e.BINARY_JS="binary.js",e.BINARY_ASM="binary.asm",e.BINARY_HEX="binary.hex",e.BINARY_UF2="binary.uf2",e.BINARY_ELF="binary.elf",e.BINARY_PXT64="binary.pxt64",e.BINARY_ESP="binary.bin",e.BINARY_SRCMAP="binary.srcmap",e.NATIVE_TYPE_THUMB="thumb",e.NATIVE_TYPE_VM="vm",e.BuildSourceMapHelpers=function(e,t,n){const r=e=>{const t=e.split("\n").map((e=>e.length)),n=t.reduce((({lens:e,sum:t},n)=>({lens:[...e,t+n+1],sum:t+n+1})),{lens:[],sum:0}).lens;return{posToLineCol:e=>{const r=n.reduce(((t,n,r)=>e<n?t:r+1),0);return[r,t[r]-(n[r]-e)+1]},lineColToPos:(e,t)=>(n[e-1]||0)+t}},i={ts:r(t),py:r(n)},s=e=>e.endPos-e.startPos,o=(t,n)=>{const{startPos:r,endPos:i}=t;return e.filter((e=>e[n].startPos<=r&&i<=e[n].endPos))},a=(e,t)=>{const n=o(e,t);return n.reduce(((e,n)=>s(n[t])<s(e[t])?n:e),n[0])},l={ts:{allOverlaps:e=>o(e,"ts"),smallestOverlap:e=>a(e,"ts")},py:{allOverlaps:e=>o(e,"py"),smallestOverlap:e=>a(e,"py")}},c=(e,t)=>n=>{const[r,o]=(t=>[i[e].lineColToPos(t.line,t.column),t.length])(n),l=a({startPos:r,endPos:r+o},e);if(!l)return;const[c,u]=i[t].posToLineCol(l[t].startPos);return{fileName:`main.${t}`,start:l[t].startPos,length:s(l[t]),line:c,column:u}},u=c("ts","py"),d=c("py","ts");return{ts:Object.assign(Object.assign(Object.assign({},i.ts),l.ts),{locToLoc:u,getText:e=>t.substring(e.startPos,e.endPos)}),py:Object.assign(Object.assign(Object.assign({},i.py),l.py),{locToLoc:d,getText:e=>n.substring(e.startPos,e.endPos)})}},e.computeUsedParts=function(e,t,n=!1){if(!e.usedSymbols||!pxt.appTarget.simulator||!n&&!pxt.appTarget.simulator.parts)return[];const r=(e,t)=>{if(e){const n=e.split(/[ ,]+/g);t.push(...n.filter((e=>!!e&&t.indexOf(e)<0)))}};let i=[],s=[];if(Object.keys(e.usedSymbols).forEach((t=>{const n=e.usedSymbols[t];r(null==n?void 0:n.attributes.parts,i),r(null==n?void 0:n.attributes.hiddenParts,s)})),t){const e=pxt.appTarget.simulator.boardDefinition.onboardComponents;e&&("ignorebuiltin"===t?i=i.filter((t=>-1===e.indexOf(t))):"onlybuiltin"===t&&(i=i.filter((t=>e.indexOf(t)>=0))))}return i=i.filter((e=>s.indexOf(e)<0)),i.sort(),i=i.reverse(),i},e.buildSimJsInfo=function(t){var n;return{js:t.outfiles[e.BINARY_JS],targetVersion:pxt.appTarget.versions.target,fnArgs:t.usedArguments,parts:e.computeUsedParts(t,"ignorebuiltin"),usedBuiltinParts:e.computeUsedParts(t,"onlybuiltin"),allParts:e.computeUsedParts(t,void 0,!0),breakpoints:null===(n=t.breakpoints)||void 0===n?void 0:n.map((e=>e.id))}},e.blocksCategory=function(t){const n=t?t.attributes.blockNamespace||t.namespace:void 0;return n?e.Util.capitalize(n.split(".")[0]):void 0},e.getBlocksInfo=function(t,n){var r,o;let a=[];const l={},c={},u={},d={},p={};function h(t,n){const r="get"==t,i="set"==t,o="number"==n.retType,d=r?c:i?l:u,p=`${n.namespace}.${n.retType}`;let h=e.U.lookup(d,p);if(!h){const l=`@${t}@`;let c,u;if(n.attributes.blockCombineShadow){const t=n.attributes.blockCombineShadow,r=t.match(/^([^,.]*),?([^,.]*)$/);r&&3==r.length&&(c=r[1].trim(),u=r[2].trim(),0!=u.length||e.Util.endsWith(t,",")||(u=c,c=""))}const f=`${n.attributes.blockSetVariable||n.namespace.toLocaleLowerCase()}=${c||""}`,m=`value=${u||""}`;h=d[p]={attributes:{blockId:`${o?n.namespace:p}_blockCombine_${t}`,callingConvention:0,group:n.attributes.group,paramDefl:{},jsDoc:r?e.U.lf("Read value of a property on an object"):e.U.lf("Update value of property on an object")},name:l,namespace:n.namespace,fileName:n.fileName,qName:`${p}.${l}`,pkg:n.pkg,kind:2,parameters:[{name:"property",description:r?e.U.lf("the name of the property to read"):e.U.lf("the name of the property to change"),isEnum:!0,type:"@combined@"},{name:"value",description:i?e.U.lf("the new value of the property"):e.U.lf("the amount by which to change the property"),type:n.retType}].slice(0,r?1:2),retType:r?n.retType:"void",combinedProperties:[]},h.attributes.block=r?e.U.lf("%{0} %property",f):i?e.U.lf("set %{0} %property to %{1}",f,m):e.U.lf("change %{0} %property by %{1}",f,m),s(h.attributes),pxt.Util.isTranslationMode()&&(h.attributes.translationId=h.attributes.block,h.attributes.block=r?`%${f} %property`:i?`set %${f} %property to %${m}`:`change %${f} %property by %${m}`,s(h.attributes),pxt.crowdin.inContextLoadAsync(h.attributes.translationId).then((e=>{h.attributes.block=e,s(h.attributes)}))),a.push(h)}h.combinedProperties.push(n.qName)}for(let n of e.Util.values(t.byQName)){if("ENUM_GET"===n.attributes.shim&&n.attributes.enumName&&n.attributes.blockId){let e=!1;if(d[n.attributes.enumName]&&(console.warn(`Enum block ${n.attributes.blockId} trying to overwrite enum ${n.attributes.enumName}`),e=!0),n.attributes.enumMemberName||(console.warn(`Enum block ${n.attributes.blockId} should specify enumMemberName`),e=!0),n.attributes.enumPromptHint||(console.warn(`Enum block ${n.attributes.blockId} should specify enumPromptHint`),e=!0),n.attributes.enumInitialMembers&&n.attributes.enumInitialMembers.length||(console.warn(`Enum block ${n.attributes.blockId} should specify enumInitialMembers`),e=!0),e)continue;const t=parseInt(n.attributes.enumStartValue);d[n.attributes.enumName]={blockId:n.attributes.blockId,name:n.attributes.enumName,memberName:n.attributes.enumMemberName,firstValue:isNaN(t)?void 0:t,isBitMask:n.attributes.enumIsBitMask,isHash:n.attributes.enumIsHash,initialMembers:n.attributes.enumInitialMembers,promptHint:n.attributes.enumPromptHint}}if("KIND_GET"===n.attributes.shim&&n.attributes.blockId){const r=n.attributes.kindNamespace||n.attributes.blockNamespace||n.namespace;if(p[r]){console.warn(`More than one block defined for kind ${r}`);continue}const i=[];if(t.byQName[r])for(const n of e.Util.values(t.byQName))n.namespace===r&&n.attributes.isKind&&i.push(n.name);p[r]={blockId:n.attributes.blockId,name:r,memberName:n.attributes.kindMemberName||r,initialMembers:i,promptHint:n.attributes.enumPromptHint||e.Util.lf("Create a new kind..."),createFunctionName:n.attributes.kindCreateFunction||"create"}}if(n.attributes.blockCombine)/@set/.test(n.name)||h("get",n),n.isReadOnly||("number"==n.retType&&h("change",n),h("set",n));else if(n.attributes.block&&!n.attributes.fixedInstance&&7!=n.kind&&5!=n.kind&&9!=n.kind&&8!=n.kind){if(n.attributes.blockId||(n.attributes.blockId=n.qName.replace(/\./g,"_")),"true"==n.attributes.block){let t=e.U.uncapitalize(n.name);1!=n.kind&&2!=n.kind||(t+=" %"+n.namespace.toLowerCase());const a=null!==(o=null===(r=n.parameters)||void 0===r?void 0:r.filter((e=>!i(e))))&&void 0!==o?o:[];for(let e of a)t+=" %"+e.name;n.attributes.block=t,s(n.attributes)}a.push(n)}}for(let n of a){let r=e.U.lookup(t.byQName,n.namespace);if(!r)continue;let i=r.attributes,s=n.attributes;for(let e of["blockNamespace","color","blockGap"])void 0===s[e]&&i[e]&&(s[e]=i[e])}var f;return n&&((f=n).length&&(a=a.filter((e=>{let t=(e.attributes.blockNamespace||e.namespace).split(".")[0];return-1===f.indexOf(t)})))),{apis:t,blocks:a,blocksById:pxt.Util.toDictionary(a,(e=>e.attributes.blockId)),enumsByName:d,kindsByName:p}},e.tsSnippetToPySnippet=function(t,n){const r={true:"True",false:"False",null:"None"}[t];if(r)return r;if(n&&6==n.kind||!n&&t.includes(".")){const n=t.lastIndexOf("."),r=t.substr(0,n);let i=t.substr(n+1);return i=e.U.snakify(i).toUpperCase(),r?`${r}.${i}`:i}return t},e.apiLocalizationStrings={},e.localizeApisAsync=async function(n,r){const i=e.Util.userLanguage();if("en"==i)return Promise.resolve(t(n));const o=i.toLowerCase(),a=o+"|jsdoc",l=o+"|block",c=await r.localizationStringsAsync(i);e.apiLocalizationStrings&&e.Util.jsonMergeFrom(c,e.apiLocalizationStrings);const u=e.Util.values(n.byQName).filter((e=>e.attributes._translatedLanguageCode!==i));return await e.Util.promiseMapAll(u,(async t=>{var r,u,d;const p=t.attributes.useLoc||t.attributes.blockAliasFor,h=p&&n.byQName[p];t.attributes._untranslatedJsDoc&&(t.attributes.jsDoc=t.attributes._untranslatedJsDoc),t.attributes._untranslatedBlock&&(t.attributes.jsDoc=t.attributes._untranslatedBlock);const f=(e,n)=>{var r,i;return c[t.qName+e]||(null===(r=t.attributes.locs)||void 0===r?void 0:r[n])||h&&(c[h.qName+e]||(null===(i=h.attributes.locs)||void 0===i?void 0:i[n]))},m=f("",a);m&&(t.attributes._untranslatedJsDoc||(t.attributes._untranslatedJsDoc=t.attributes.jsDoc),t.attributes.jsDoc=m),null===(r=t.parameters)||void 0===r||r.forEach((e=>{const t=`|param|${e.name}`,n=f(t,o+t);n&&(e.description=n)}));const _=c["{id:category}"+e.Util.capitalize(t.qName)];let g=c[`${t.qName}|block`]||(null===(u=t.attributes.locs)||void 0===u?void 0:u[l]);if(!g&&h){const e=c[`${h.qName}|block`]||(null===(d=h.attributes.locs)||void 0===d?void 0:d[l]);t.attributes.block===(h.attributes._untranslatedBlock||h.attributes.block)&&e&&(g=e)}if(g&&pxt.Util.isTranslationMode()&&(t.attributes.translationId=g,g=await pxt.crowdin.inContextLoadAsync(g)),_)t.attributes.block?t.attributes.block=g||t.attributes.block:t.attributes.block=_,s(t.attributes);else if(t.attributes.block&&g){const e=pxt.blocks.compileInfo(t),n=t.attributes.block;if(t.attributes.block=pxt.blocks.normalizeBlock(g,(e=>{pxt.tickEvent("loc.normalized",{block:t.attributes.block,lang:i,error:e})})),t.attributes._untranslatedBlock||(t.attributes._untranslatedBlock=n),n!=t.attributes.block){s(t.attributes);(function(e,t){if(e.parameters.length!=t.parameters.length)return pxt.debug("Localized block has extra or missing parameters"),!1;for(const n of e.parameters){const e=t.actualNameToParam[n.actualName];if(!e||n.type!=e.type||n.shadowBlockId!=e.shadowBlockId||n.definitionName!=e.definitionName)return pxt.debug(`Parameter ${n.actualName} type, shadow block, or definition name does not match after localization`),!1}return!0})(e,pxt.blocks.compileInfo(t))||(pxt.reportError("loc.errors","block has non matching arguments",{block:t.attributes.blockId,lang:i,originalDefinition:n,translatedBlock:t.attributes.block}),pxt.tickEvent("loc.errors",{block:t.attributes.blockId,lang:i}),t.attributes.block=n,s(t.attributes))}}else s(t.attributes);t.attributes._translatedLanguageCode=i})),t(n)},e.emptyExtInfo=function(){let e=pxt.appTarget.compileService;e||(e={});const t=!!e.platformioIni,n="dockermake"==e.buildEngine||"dockercross"==e.buildEngine||"dockerespidf"==e.buildEngine,r={functions:[],generatedFiles:{},extensionFiles:{},sha:"",compileData:"",shimsDTS:"",enumsDTS:"",onlyPublic:!0};return t?r.platformio={dependencies:{}}:n?r.npmDependencies={}:r.yotta={config:{},dependencies:{}},r};const n=["weight","imageLiteral","topblockWeight","inlineInputModeLimit"],r=["advanced","handlerStatement","afterOnStart","optionalVariableArgs","blockHidden","constantShim","blockCombine","enumIsBitMask","enumIsHash","decompileIndirectFixedInstances","topblock","callInDebugger","duplicateShadowOnDrag","argsNullable","compileHiddenArguments"];function i(e){return"Action"===e.type||/^\([^\)]*\)\s*=>/.test(e.type)}function s(e){if(e.block){const n=e.block.split("||");e._def=t(o(n[0])),e._def||pxt.debug("Unable to parse block def for id: "+e.blockId),n[1]&&(e._expandedDef=t(o(n[1]))),n[1]&&!e._expandedDef&&pxt.debug("Unable to parse expanded block def for id: "+e.blockId)}function t(t){return e._shadowOverrides&&t.parameters.forEach((t=>{const n=e._shadowOverrides[t.name];"unset"===n?delete t.shadowBlockId:null!=n&&(t.shadowBlockId=n)})),t}}function o(e){const t=[];let n,r=0;for(;r<e.length;r++){const i=e[r],s=r;let o;switch(i){case"*":case"_":const t=d((e=>e==i)),n="_"===i?2:0;1===t.length?o={kind:1<<n,content:t}:2===t.length?o={kind:2<<n,content:t}:3===t.length?o={kind:3<<n,content:t}:r=s;break;case"`":const a=p("`");if(void 0===a){r=s;break}o={kind:256,content:a};break;case"|":o={kind:32};break;case"\\":r<e.length-1&&(o={kind:16,content:e[1+r++]});break;case"[":const l=p("]");if(void 0!==l&&"("===e[1+r++]){const e=p(")");if(void 0!==e){o={kind:512,content:l,type:e};break}}r=s;break;case"$":case"%":const c=d((e=>/[a-zA-Z0-9_=]/.test(e)),!0).split("=");if(c.length>2){r=s;break}let u;if("("===e[r+1]){const e=r;++r,u=p(")"),u||(r=e)}o={kind:"$"===i?1024:64,content:c[0],type:c[1],name:u}}o?(n&&t.push({kind:128,content:n}),n=void 0,t.push(o)):n?n+=i:n=i}n&&t.push({kind:128,content:n});const i=[],s=[];let o=[],l=0,c="",u=[];for(let e=0;e<t.length;e++){const n=t[e].kind,r=o[o.length-1];if(15&n)if(m(t[e].content),n&l)if(r&n){o.pop(),l^=n;const e=r&l|n&l;e&&o.push(e)}else h();else l|=n,o.push(n);else 144&n?c+=t[e].content:1120&n&&f();if(64==n){const n={kind:"param",name:t[e].content,shadowBlockId:t[e].type,ref:!1};t[e].name&&(n.varName=t[e].name),i.push(n),s.push(n)}else if(1024==n){const n={kind:"param",name:t[e].content,shadowBlockId:t[e].type,ref:!0};t[e].name&&(n.varName=t[e].name),i.push(n),s.push(n)}else 256==n?(m(),u.push({kind:"image",uri:t[e].content})):512==n?(m(),u.push({kind:"label",text:t[e].content,cssClass:t[e].type})):32==n&&i.push({kind:"break"})}return f(),{parts:i,parameters:s};function d(t,n=!1){let i="";for(n&&r++;r<e.length&&t(e[r]);)i+=e[r],++r;return i&&r--,i}function p(t){const n=d((e=>e!==t),!0);if(e[r+1]===t)return++r,n}function h(){let e="",t=[];for(const n of u)a(n)?(t.push({content:e,styles:0}),t.push(n),e=""):(e+=n.content,n.endingToken&&(e+=n.endingToken));u=t,e&&u.push({content:e,styles:0}),o=[],l=0}function f(){for(m(),l&&h();u.length;){const e=u.shift();if(a(e))i.push(e);else{if(!e.content)continue;const t=[];10&e.styles&&t.push("bold"),5&e.styles&&t.push("italics"),i.push({kind:"label",text:e.content,style:t})}}}function m(e){u.push({content:c,styles:l,endingToken:e}),c=""}}function a(e){return!!e.kind}let l;e.parseCommentString=function(t){let i={paramDefl:{},callingConvention:0,_source:t},o=!0;for(;o;)o=!1,t=t.replace(/\/\/%[ \t]*([\w\.-]+)(=(("[^"\n]*")|'([^'\n]*)'|([^\s]*)))?/,((t,n,r,s,a,l,c)=>{let u=a?JSON.parse(a):r?a||l||c:"true";if(u||(u=""),e.U.startsWith(n,"block.loc."))i.locs||(i.locs={}),i.locs[n.slice("block.loc.".length).toLowerCase()+"|block"]=u;else if(e.U.startsWith(n,"jsdoc.loc."))i.locs||(i.locs={}),i.locs[n.slice("jsdoc.loc.".length).toLowerCase()+"|jsdoc"]=u;else if(e.U.contains(n,".loc.")){i.locs||(i.locs={});const e=n.slice(0,n.indexOf(".loc.")),t=n.slice(n.indexOf(".loc.")+".loc.".length);i.locs[t+"|param|"+e]=u}else if(e.U.endsWith(n,".defl"))u.indexOf(" ")>-1?i.paramDefl[n.slice(0,n.length-5)]=`"${u}"`:i.paramDefl[n.slice(0,n.length-5)]=u,i.explicitDefaults||(i.explicitDefaults=[]),i.explicitDefaults.push(n.slice(0,n.length-5));else if(e.U.endsWith(n,".shadow"))i._shadowOverrides||(i._shadowOverrides={}),i._shadowOverrides[n.slice(0,n.length-7)]=u;else if(e.U.endsWith(n,".snippet")){i.paramSnippets||(i.paramSnippets={});const e=n.slice(0,n.length-8);i.paramSnippets[e]||(i.paramSnippets[e]={}),i.paramSnippets[e].ts=u}else if(e.U.endsWith(n,".pySnippet")){i.paramSnippets||(i.paramSnippets={});const e=n.slice(0,n.length-10);i.paramSnippets[e]||(i.paramSnippets[e]={}),i.paramSnippets[e].python=u}else if(e.U.endsWith(n,".fieldEditor"))i.paramFieldEditor||(i.paramFieldEditor={}),i.paramFieldEditor[n.slice(0,n.length-12)]=u;else if(e.U.contains(n,".fieldOptions.")){i.paramFieldEditorOptions||(i.paramFieldEditorOptions={});const e=n.slice(0,n.indexOf(".fieldOptions.")),t=n.slice(n.indexOf(".fieldOptions.")+14,n.length);i.paramFieldEditorOptions[e]||(i.paramFieldEditorOptions[e]={}),i.paramFieldEditorOptions[e][t]=u}else if(e.U.contains(n,".shadowOptions.")){i.paramShadowOptions||(i.paramShadowOptions={});const e=n.slice(0,n.indexOf(".shadowOptions.")),t=n.slice(n.indexOf(".shadowOptions.")+15,n.length);i.paramShadowOptions[e]||(i.paramShadowOptions[e]={}),i.paramShadowOptions[e][t]=u}else e.U.endsWith(n,".min")?(i.paramMin||(i.paramMin={}),i.paramMin[n.slice(0,n.length-4)]=u):e.U.endsWith(n,".max")?(i.paramMax||(i.paramMax={}),i.paramMax[n.slice(0,n.length-4)]=u):i[n]=u;return o=!0,"//% "}));for(let e of n)"string"==typeof i[e]&&(i[e]=parseInt(i[e]));for(let e of r)"string"==typeof i[e]&&(i[e]="true"==i[e]||"1"==i[e]);if(i.trackArgs&&(i.trackArgs=i.trackArgs.split(/[ ,]+/).map((e=>parseInt(e)||0))),i.enumInitialMembers&&(i.enumInitialMembers=i.enumInitialMembers.split(/[ ,]+/)),i.blockExternalInputs&&!i.inlineInputMode&&(i.inlineInputMode="external"),i.paramHelp={},i.jsDoc="",t=t.replace(/\/\*\*([^]*?)\*\//g,((e,t)=>(t=(t=t.replace(/\n\s*(\*\s*)?/g,"\n")).replace(/^\s*@param\s+(\w+)\s+(.*)$/gm,((e,t,n)=>{if(i.paramHelp[t]=n,!i.paramDefl[t]){let e=/\beg\.?:\s*(.+)/.exec(n);if(e&&e[1]){let n=/(?:"([^"]*)")|(?:'([^']*)')|(?:([^\s,]+))/g.exec(e[1]);if(n){let e=n[1]||n[2]||n[3];e||(e=""),e.indexOf(" ")>-1?i.paramDefl[t]=`"${e}"`:i.paramDefl[t]=e}}}return""})),i.jsDoc+=t,""))),i.jsDoc=i.jsDoc.trim(),i.async&&(i.callingConvention=1),i.promise&&(i.callingConvention=2),i.jres&&(i.whenUsed=!0),i.subcategories)try{i.subcategories=JSON.parse(i.subcategories)}catch(e){i.subcategories=void 0}if(i.groups)try{i.groups=JSON.parse(i.groups)}catch(e){i.groups=void 0}if(i.groupIcons)try{i.groupIcons=JSON.parse(i.groupIcons)}catch(e){i.groupIcons=void 0}if(i.groupHelp)try{i.groupHelp=JSON.parse(i.groupHelp)}catch(e){i.groupHelp=void 0}return s(i),i},e.parameterTypeIsArrowFunction=i,e.updateBlockDef=s,e.parseBlockDefinition=o,e.parseChecksumBlock=function(e,t=0){let n=pxt.HF2.read32(e,t);if(133083260!=(2147483647&n))return pxt.log("no checksum block magic"),null;let r=pxt.HF2.read32(e,t+4),i=pxt.HF2.read32(e,t+8);if(3&r)return pxt.log("invalid end marker position"),null;let s=1<<(255&i);if(s!=pxt.appTarget.compile.flashCodeAlign)return pxt.log("invalid page size: "+s),null;let o={magic:n,endMarkerPos:r,endMarker:i,regions:[]};for(let n=t+12;n<e.length-7;n+=8){let t={start:s*pxt.HF2.read16(e,n),length:s*pxt.HF2.read16(e,n+2),checksum:pxt.HF2.read32(e,n+4)};if(!t.length||!t.checksum)break;o.regions.push(t)}return o},function(t){function n(n){let r=e=>n[e]+(n[e+1]<<8)+(n[e+2]<<16)+(n[e+3]<<24)>>>0;if(!n||512!=n.length||r(0)!=t.UF2_MAGIC_START0||r(4)!=t.UF2_MAGIC_START1||r(n.length-4)!=t.UF2_MAGIC_END)return null;let i=r(8),s=r(16);s>476&&(s=256);let o=null,a=0,l=0;if(i&t.UF2_FLAG_FILE){let t=n.slice(32+s),i=t.indexOf(0);i>=0&&(t=t.slice(0,i)),o=e.U.fromUTF8Array(t),l=r(28)}return i&t.UF2_FLAG_FAMILY_ID_PRESENT&&(a=r(28)),{flags:i,targetAddr:r(12),payloadSize:s,blockNo:r(20),numBlocks:r(24),fileSize:l,familyId:a,data:n.slice(32,32+s),filename:o}}function r(e,t){return!!e&&(e.targetAddr<=t&&t<e.targetAddr+e.payloadSize)}function i(e,t,n){e[t]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255}function s(e){return"string"==typeof e&&(e=parseInt(e)),{currBlock:null,currPtr:-1,blocks:[],ptrs:[],filesize:0,familyId:e||0}}function o(e){for(let t=0;t<e.blocks.length;++t)i(e.blocks[t],20,t),i(e.blocks[t],24,e.blocks.length),e.filename&&i(e.blocks[t],28,e.filesize)}function a(n,r,s,o=0){let l=n.currBlock,c=r>>8,u=256-(255&r);if(s.length>u){let e=new Uint8Array(s);for(a(n,r,e.slice(0,u));u<s.length;){let t=Math.min(u+256,s.length);a(n,r+u,e.slice(u,t)),u=t}return}if(c!=n.currPtr){l=null;for(let e=0;e<n.ptrs.length;++e)if(n.ptrs[e]==c){l=n.blocks[e];break}if(!l){l=new Uint8Array(512),n.filename?o|=t.UF2_FLAG_FILE:n.familyId&&(o|=t.UF2_FLAG_FAMILY_ID_PRESENT),i(l,0,t.UF2_MAGIC_START0),i(l,4,t.UF2_MAGIC_START1),i(l,8,o),i(l,12,c<<8),i(l,16,256),i(l,20,n.blocks.length),i(l,28,n.familyId),i(l,508,t.UF2_MAGIC_END);for(let e=32;e<288;++e)l[e]=255;n.filename&&e.U.memcpy(l,288,e.U.toUTF8Array(n.filename)),n.blocks.push(l),n.ptrs.push(c)}n.currPtr=c,n.currBlock=l}let d=32+(255&r);for(let e=0;e<s.length;++e)l[d+e]=s[e];n.filesize=Math.max(n.filesize,s.length+r)}t.UF2_MAGIC_START0=171066965,t.UF2_MAGIC_START1=2656915799,t.UF2_MAGIC_END=179400496,t.UF2_FLAG_NONE=0,t.UF2_FLAG_NOFLASH=1,t.UF2_FLAG_FILE=4096,t.UF2_FLAG_FAMILY_ID_PRESENT=8192,t.parseBlock=n,t.parseFile=function(e){let t=[];for(let r=0;r<e.length;r+=512){let i=n(e.slice(r,r+512));i&&t.push(i)}return t},t.toBin=function(e,t){if(e.length<512)return null;let r=-1,i=-1,s=[];for(let o=0;o<e.length;++o){let a=512*o,l=n(e.slice(a,a+512));if(!l)continue;if(t&&l.targetAddr+256>t)break;-1==r&&(r=l.targetAddr,i=r);let c=l.targetAddr-r;c<0||c%4||c>1048576||(c>0&&s.push(new Uint8Array(c)),s.push(e.slice(a+32,a+32+l.payloadSize)),r=l.targetAddr+l.payloadSize)}let o=0;for(let e of s)o+=e.length;if(0==o)return null;let a=new Uint8Array(o),l=0;for(let e of s)for(let t=0;t<e.length;++t)a[l++]=e[t];return{buf:a,start:i}},t.readBytes=function(e,t,n){let i,s=new Uint8Array(n);for(let o=0;o<n;++o,++t)r(i,t)||(i=e.filter((e=>r(e,t)))[0]),i&&(s[o]=i.data[t-i.targetAddr]);return s},t.newBlockFile=s,t.finalizeFile=o,t.concatFiles=function(t){for(let e of t)o(e),e.filename=null;let n=s();n.blocks=e.U.concat(t.map((e=>e.blocks)));for(let e of t)e.blocks=[];return n},t.serializeFile=function(t){o(t);let n="";for(let r of t.blocks)n+=e.Util.uint8ArrayToString(r);return n},t.readBytesFromFile=function t(n,r,i){let s,o=r>>8;if(o==n.currPtr)s=n.currBlock;else{for(let e=0;e<n.ptrs.length;++e)if(n.ptrs[e]==o){s=n.blocks[e];break}s&&(n.currPtr=o,n.currBlock=s)}if(!s)return null;let a=new Uint8Array(i),l=Math.min(i,256-(255&r));e.U.memcpy(a,0,s,32+(255&r),l);let c=i-l;if(c>0){let i=t(n,r+l,c);e.U.memcpy(a,l,i)}return a},t.writeBytes=a,t.writeHex=function(e,t){let n="0000";for(let r=0;r<t.length;++r){let i=/:02000004(....)/.exec(t[r]);if(i&&(n=i[1]),i=/^:..(....)00(.*)[0-9A-F][0-9A-F]$/.exec(t[r]),i){let t=parseInt(n+i[1],16),r=i[2],s=[];for(let e=0;e<r.length;e+=2)s.push(parseInt(r[e]+r[e+1],16));a(e,t,s)}}}}(l=e.UF2||(e.UF2={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(e){let t;!function(e){e[e.Bundled=1]="Bundled",e[e.Github=2]="Github",e[e.ShareScript=3]="ShareScript"}(t=e.ExtensionType||(e.ExtensionType={}))}(e.service||(e.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n,r;!function(e){e[e.IDE=0]="IDE",e[e.Sandbox=1]="Sandbox",e[e.Widget=2]="Widget",e[e.Controller=3]="Controller"}(n=t.EditorLayoutType||(t.EditorLayoutType={}));let i=!1,s=!1;function o(){if(void 0===r){if(e.BrowserUtils.hasWindow()){const t=/sandbox=1|#sandbox|#sandboxproject/i.test(window.location.href)||e.BrowserUtils.isIFrame(),o=/nosandbox=1/i.test(window.location.href),a=/controller=1/i.test(window.location.href)&&e.BrowserUtils.isIFrame(),l=/readonly=1/i.test(window.location.href),c=/editorlayout=(widget|sandbox|ide)/i.exec(window.location.href),u=/noproject=1/i.test(window.location.href);if(r=n.IDE,o?r=n.Widget:a?r=n.Controller:t&&(r=n.Sandbox),a&&l&&(i=!0),a&&u&&(s=!0),c)switch(c[1].toLowerCase()){case"widget":r=n.Widget;break;case"sandbox":r=n.Sandbox;break;case"ide":r=n.IDE}}else r=n.Sandbox;e.debug(`shell: layout type ${n[r]}, readonly ${c()}`)}}function a(){return o(),r==n.Sandbox}function l(){return/[?&]timeMachine=1/i.test(window.location.href)}function c(){return!e.BrowserUtils.hasWindow()||l()||a()&&!/[?&]edit=1/i.test(window.location.href)||u()&&i}function u(){return o(),r==n.Controller}t.layoutTypeClass=function(){return o(),e.shell.EditorLayoutType[r].toLowerCase()},t.isSandboxMode=a,t.isTimeMachineEmbed=l,t.isReadOnly=c,t.isNoProject=function(){return s},t.isControllerMode=u,t.isPyLangPref=function(){return"py"==e.storage.getLocal("editorlangpref")},t.getEditorLanguagePref=function(){return e.storage.getLocal("editorlangpref")},t.setEditorLanguagePref=function(t){t.match(/prj$/)&&(t=t.replace(/prj$/,"")),e.storage.setLocal("editorlangpref",t)},t.getToolboxAnimation=function(){return e.storage.getLocal("toolboxanimation")},t.setToolboxAnimation=function(){e.storage.setLocal("toolboxanimation","1")}}(e.shell||(e.shell={}))}(pxt||(pxt={})),function(e){!function(t){t.USER_VERSION="0.0.1";class n{constructor(){this.db=new e.BrowserUtils.IDBWrapper(n.databaseName,n.version,((e,t)=>{const r=t.result;e.oldVersion<1&&(r.createObjectStore(n.projectTable,{keyPath:n.projectKey}),r.createObjectStore(n.userTable,{keyPath:n.userKey}))}))}initAsync(){return this.db.openAsync()}getAllProjectsAsync(){return this.db.getAllAsync(n.projectTable).then((e=>e.map((e=>e.project)).filter((e=>!e.deleted))))}deleteProjectAsync(e){return this.getProjectAsync(e).then((e=>{e.deleted=!0,this.saveProjectAsync(e)}))}getProjectAsync(e){return this.db.getAsync(n.projectTable,e).then((e=>null==e?void 0:e.project))}saveProjectAsync(e){return this.db.setAsync(n.projectTable,{id:e.header.id,project:e})}getUserStateAsync(){return this.db.getAsync(n.userTable,"local-user").then((e=>null==e?void 0:e.user))}saveUserStateAsync(e){return this.db.setAsync(n.userTable,{id:"local-user",user:e})}}n.version=6,n.databaseName="local-skill-map",n.projectTable="projects",n.projectKey="id",n.userTable="users",n.userKey="id",t.IndexedDBWorkspace=n}(e.skillmap||(e.skillmap={}))}(pxt||(pxt={})),function(e){!function(e){e.MAX_FREQUENCY=5e3,e.MAX_VOLUME=255,e.renderSoundPath=function(r,i,s){let{startFrequency:o,endFrequency:a,startVolume:l,endVolume:c,wave:u,interpolation:d}=r;o=Math.max(Math.min(o,e.MAX_FREQUENCY),1),a=Math.max(Math.min(a,e.MAX_FREQUENCY),1),l=Math.max(Math.min(l,e.MAX_VOLUME),0),c=Math.max(Math.min(c,e.MAX_VOLUME),0);const p=new t(o+a+1);let h;switch(d){case"linear":h=e=>o+e*(a-o)/i;break;case"curve":h=e=>o+(a-o)*Math.sin(e/i*(Math.PI/2));break;case"logarithmic":h=e=>o+Math.log10(1+e/i*9)*(a-o)}"noise"===u&&(h=()=>p.randomRange(500,5e3));const f=t=>Math.max(Math.min((c-l)/i*t+l,e.MAX_VOLUME),0),m=i/2,_=t=>t/e.MAX_VOLUME*(s-2)/2,g=t=>(1-t/e.MAX_FREQUENCY)*(m-10)+10,y=["M 2 "+s/2];let b=0;for(;b<i;)y.push(n(_(f(b)),g(h(b))/2,u,!1,p)),b+=g(h(b))/2,y.push(n(_(f(b)),g(h(b))/2,u,!0,p)),b+=g(h(b))/2;return y.join(" ")},e.renderWaveSnapshot=function(r,i,s,o,a,l){const c=new t(r);"noise"===s&&(r=c.randomRange(500,5e3)),r=Math.max(Math.min(r,e.MAX_FREQUENCY),1);const u=i/e.MAX_VOLUME*(a-2)/2,d=o/(r*l/1e3)/2;let p=Math.ceil(o/(2*d));p%2==1&&p++;const h=[`M ${o/2-p*d} ${a/2}`];let f=0;for(let e=0;e<p;e++)h.push(n(u,d,s,!1,c)),f+=d,h.push(n(u,d,s,!0,c)),f+=d;return h.join(" ")};class t{constructor(e){this.seed=e,this.lfsr=e}next(){return(this.lfsr=this.lfsr>>1^46080&-(1&this.lfsr))/65535}randomRange(e,t){return e+(t-e)*this.next()}}function n(e,t,n,r,i){switch(n){case"triangle":return`l ${t/2} ${r?e:-e} l ${t/2} ${r?-e:e}`;case"square":return`v ${r?e:-e} h ${t} v ${r?-e:e}`;case"sawtooth":return r?`l ${t} ${e} v ${-e}`:`v ${-e} l ${t} ${e}`;case"sine":return`q ${t/2} ${1.9*(r?e:-e)} ${t} 0`;case"noise":const n=[],s=[],o=Math.min(4,t/4);let a=r;for(let n=0;n<t;n+=o)s.push(i.randomRange(0,e)*(a?1:-1)),a=!a;s[0]=r?e:-e,s[s.length-1]=0;let l=0,c=0;for(const e of s){let r=Math.min(o,t-c);if(n.push(`v ${e-l} h ${r}`),l=e,c+=r,c>=t)break}return n.join(" ")}}function r(e){switch(e){case"square":return 15;case"sine":return 3;case"triangle":return 1;case"noise":return 18;case"sawtooth":return 2}}function i(e,t,n){const r=new Uint8Array(2);new Uint16Array(r.buffer)[0]=0|n,e[t]=r[0],e[t+1]=r[1]}e.soundToInstructionBuffer=function(t,n,s){const{startFrequency:o,endFrequency:a,startVolume:l,endVolume:c,interpolation:u,duration:d}=t,p=[];if("linear"===t.interpolation&&"none"===t.effect)p.push({frequency:o,volume:l/e.MAX_VOLUME*1024}),p.push({frequency:a,volume:c/e.MAX_VOLUME*1024});else{n=Math.min(n,Math.floor(d/5));const r=t=>(l+t*(c-l)/d)/e.MAX_VOLUME*1024;let i;switch(u){case"linear":i=e=>o+e*(a-o)/d;break;case"curve":i=e=>o+(a-o)*Math.sin(e/d*(Math.PI/2));break;case"logarithmic":i=e=>o+Math.log10(1+e/d*9)*(a-o)}const h=d/n;for(let e=0;e<n;e++){const n={frequency:Math.max(i(e*h),1),volume:r(e*h)};"tremolo"===t.effect?n.volume=e%2==0?Math.max(n.volume-500*s,0):Math.min(n.volume+500*s,1023):"vibrato"===t.effect?n.frequency=e%2==0?Math.max(n.frequency-100*s,1):n.frequency+100*s:"warble"===t.effect&&(n.frequency=e%2==0?Math.max(n.frequency-1e3*s,1):n.frequency+1e3*s),p.push(n)}}const h=new Uint8Array(12*(p.length-1)),f=Math.floor(d/(p.length-1));for(let e=0;e<p.length-1;e++){const n=12*e;h[n]=r(t.wave),i(h,n+2,p[e].frequency),i(h,n+4,f),i(h,n+6,p[e].volume),i(h,n+8,p[e+1].volume),i(h,n+10,p[e+1].frequency)}return h}}(e.assets||(e.assets={}))}(pxt||(pxt={})),function(e){!function(t){t.createStreamAsync=function(t,n){return e.Cloud.privatePostAsync("streams",{target:t,name:n||"data"}).then((e=>e))},t.postPayloadAsync=function(t,n){return e.Util.assert(!!t.privatekey),e.Cloud.privatePostAsync(`${t.id}/data?privatekey=${t.privatekey}`,n)}}(e.streams||(e.streams={}))}(pxt||(pxt={})),function(e){!function(t){let n,r;!function(e){e[e.userSpaceOnUse=0]="userSpaceOnUse",e[e.objectBoundingBox=1]="objectBoundingBox"}(n=t.PatternUnits||(t.PatternUnits={})),function(e){e[e.em=0]="em",e[e.ex=1]="ex",e[e.px=2]="px",e[e.in=3]="in",e[e.cm=4]="cm",e[e.mm=5]="mm",e[e.pt=6]="pt",e[e.pc=7]="pc",e[e.percent=8]="percent"}(r=t.LengthUnit||(t.LengthUnit={}));class i{constructor(e){this.el=E(e)}attr(e){return Object.keys(e).forEach((t=>{this.setAttribute(t,e[t])})),this}setAttribute(e,t){return this.el.setAttribute(e,t.toString()),this}setAttributeNS(e,t,n){return this.el.setAttributeNS(e,t,n.toString()),this}id(e){return this.setAttribute("id",e)}setClass(...e){return this.setAttribute("class",e.join(" "))}appendClass(t){return e.BrowserUtils.addClass(this.el,t),this}removeClass(t){e.BrowserUtils.removeClass(this.el,t)}title(e){this.titleElement||(this.titleElement=E("title"),this.el.firstChild?this.el.insertBefore(this.titleElement,this.el.firstChild):this.el.appendChild(this.titleElement)),this.titleElement.textContent=e}setVisible(e){return this.setAttribute("visibility",e?"visible":"hidden")}}t.BaseElement=i;class s extends i{draw(e){const t=function(e){switch(e){case"text":return new d;case"circle":return new h;case"rect":return new p;case"line":return new f;case"polygon":return new g;case"polyline":return new _;case"path":return new y;default:return new u(e)}}(e);return this.el.appendChild(t.el),t}element(e,t){return t(this.draw(e)),this}group(){const e=new o;return this.el.appendChild(e.el),e}appendChild(e){this.el.appendChild(e.el)}onDown(e){return t.events.down(this.el,e),this}onUp(e){return t.events.up(this.el,e),this}onMove(e){return t.events.move(this.el,e),this}onEnter(e){return t.events.enter(this.el,e),this}onLeave(e){return t.events.leave(this.el,e),this}onClick(e){return t.events.click(this.el,e),this}}t.DrawContext=s;t.SVG=class extends s{constructor(e){super("svg"),e&&e.appendChild(this.el)}define(e){return this.defs||(this.defs=new l(this.el)),e(this.defs),this}};class o extends s{constructor(e){super("g"),e&&e.appendChild(this.el)}translate(e,t){return this.left=e,this.top=t,this.updateTransform()}scale(e){return this.scaleFactor=e,this.updateTransform()}def(){return new l(this.el)}style(){return new c(this.el)}updateTransform(){let e="";return null!=this.left&&(e+=`translate(${this.left} ${this.top})`),null!=this.scaleFactor&&(e+=` scale(${this.scaleFactor})`),this.setAttribute("transform",e),this}}t.Group=o;class a extends s{constructor(){super("pattern")}units(e){return this.setAttribute("patternUnits",e===n.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}contentUnits(e){return this.setAttribute("patternContentUnits",e===n.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}size(e,t){return this.setAttribute("width",e),this.setAttribute("height",t),this}}t.Pattern=a;class l extends i{constructor(e){super("defs"),e.appendChild(this.el)}create(e,t){let n;switch(e){case"path":n=new y;break;case"pattern":n=new a;break;case"radialGradient":n=new T;break;case"linearGradient":n=new v;break;case"clipPath":n=new k;break;default:n=new i(e)}return n.id(t),this.el.appendChild(n.el),n}}t.DefsElement=l;class c extends i{constructor(e){super("style"),e.appendChild(this.el)}content(e){this.el.textContent=e}}t.StyleElement=c;class u extends s{at(e,t){return this.setAttribute("x",e),this.setAttribute("y",t),this}moveTo(e,t){return this.at(e,t)}fill(e,t){return this.setAttribute("fill",e),null!=t&&this.opacity(t),this}opacity(e){return this.setAttribute("fill-opacity",e)}stroke(e,t){return this.setAttribute("stroke",e),null!=t&&this.strokeWidth(t),this}strokeWidth(e){return this.setAttribute("stroke-width",e)}strokeOpacity(e){return this.setAttribute("stroke-opacity",e)}clipPath(e){return this.setAttribute("clip-path",e)}}t.Drawable=u;class d extends u{constructor(e){super("text"),null!=e&&this.text(e)}text(e){return this.el.textContent=e,this}fontFamily(e){return this.setAttribute("font-family",e)}fontSize(e,t){return this.setAttribute("font-size",S(e,t))}offset(e,t,n){return 0!==e&&this.setAttribute("dx",S(e,n)),0!==t&&this.setAttribute("dy",S(t,n)),this}anchor(e){return this.setAttribute("text-anchor",e)}}t.Text=d;class p extends u{constructor(){super("rect")}width(e,t=r.px){return this.setAttribute("width",S(e,t))}height(e,t=r.px){return this.setAttribute("height",S(e,t))}corner(e){return this.corners(e,e)}corners(e,t){return this.setAttribute("rx",e),this.setAttribute("ry",t),this}size(e,t,n=r.px){return this.width(e,n),this.height(t,n),this}}t.Rect=p;class h extends u{constructor(){super("circle")}at(e,t){return this.setAttribute("cx",e),this.setAttribute("cy",t),this}radius(e){return this.setAttribute("r",e)}}t.Circle=h;class f extends u{constructor(){super("line")}at(e,t,n,r){return this.from(e,t),null!=n&&null!=r&&this.to(n,r),this}from(e,t){return this.setAttribute("x1",e),this.setAttribute("y1",t),this}to(e,t){return this.setAttribute("x2",e),this.setAttribute("y2",t),this}}t.Line=f;class m extends u{points(e){return this.setAttribute("points",e)}with(e){return this.points(e.map((({x:e,y:t})=>e+" "+t)).join(","))}}t.PolyElement=m;class _ extends m{constructor(){super("polyline")}}t.Polyline=_;class g extends m{constructor(){super("polygon")}}t.Polygon=g;class y extends u{constructor(){super("path"),this.d=new x}update(){return this.setAttribute("d",this.d.toAttribute())}path(e){return e(this.d),this.update()}setD(e){return this.setAttribute("d",e),this}}t.Path=y;t.Image=class extends u{constructor(){super("image")}src(e){return this.setAttributeNS("http://www.w3.org/1999/xlink","href",e)}width(e,t=r.px){return this.setAttribute("width",S(e,t))}height(e,t=r.px){return this.setAttribute("height",S(e,t))}size(e,t,n=r.px){return this.width(e,n),this.height(t,n),this}};class b extends i{units(e){return this.setAttribute("gradientUnits",e===n.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}stop(e,t,n){const r=E("stop");return r.setAttribute("offset",e+"%"),null!=t&&r.setAttribute("stop-color",t),null!=n&&r.setAttribute("stop-opacity",n),this.el.appendChild(r),this}}t.Gradient=b;class v extends b{constructor(){super("linearGradient")}start(e,t){return this.setAttribute("x1",e),this.setAttribute("y1",t),this}end(e,t){return this.setAttribute("x2",e),this.setAttribute("y2",t),this}}t.LinearGradient=v;class T extends b{constructor(){super("radialGradient")}center(e,t){return this.setAttribute("cx",e),this.setAttribute("cy",t),this}focus(e,t,n){return this.setAttribute("fx",e),this.setAttribute("fy",t),this.setAttribute("fr",n),this}radius(e){return this.setAttribute("r",e)}}t.RadialGradient=T;class k extends s{constructor(){super("clipPath")}clipPathUnits(e){return e?this.setAttribute("clipPathUnits","objectBoundingBox"):this.setAttribute("clipPathUnits","userSpaceOnUse")}}function E(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}t.ClipPath=k;class x{constructor(){this.ops=[]}clear(){this.ops=[]}moveTo(e,t){return this.op("M",e,t)}moveBy(e,t){return this.op("m",e,t)}lineTo(e,t){return this.op("L",e,t)}lineBy(e,t){return this.op("l",e,t)}cCurveTo(e,t,n,r,i,s){return this.op("C",e,t,n,r,i,s)}cCurveBy(e,t,n,r,i,s){return this.op("c",e,t,n,r,i,s)}qCurveTo(e,t,n,r){return this.op("Q",e,t,n,r)}qCurveBy(e,t,n,r){return this.op("q",e,t,n,r)}sCurveTo(e,t,n,r){return this.op("S",e,t,n,r)}sCurveBy(e,t,n,r){return this.op("s",e,t,n,r)}tCurveTo(e,t){return this.op("T",e,t)}tCurveBy(e,t){return this.op("t",e,t)}arcTo(e,t,n,r,i,s,o){return this.op("A",e,t,n,r?1:0,i?1:0,s,o)}arcBy(e,t,n,r,i,s,o){return this.op("a",e,t,n,r?1:0,i?1:0,s,o)}close(){return this.op("z")}toAttribute(){return this.ops.map((e=>e.op+" "+e.args.join(" "))).join(" ")}op(e,...t){return this.ops.push({op:e,args:t}),this}}function S(e,t){switch(t){case r.em:return e+"em";case r.ex:return e+"ex";case r.px:return e+"px";case r.in:return e+"in";case r.cm:return e+"cm";case r.mm:return e+"mm";case r.pt:return e+"pt";case r.pc:return e+"pc";case r.percent:return e+"%";default:return e.toString()}}t.PathContext=x}(e.svgUtil||(e.svgUtil={}))}(pxt||(pxt={})),function(e){!function(e){!function(e){function t(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&navigator.maxTouchPoints>0)}function n(){return"undefined"!=typeof window&&!!window.PointerEvent}e.isTouchEnabled=t,e.hasPointerEvents=n,e.down=function(e,r){n()?e.addEventListener("pointerdown",r):t()?(e.addEventListener("mousedown",r),e.addEventListener("touchstart",r)):e.addEventListener("mousedown",r)},e.up=function(e,r){n()?e.addEventListener("pointerup",r):(t(),e.addEventListener("mouseup",r))},e.enter=function(e,r){n()?e.addEventListener("pointerover",(e=>{r(!!(1&e.buttons))})):t()?e.addEventListener("touchstart",(e=>{r(!0)})):e.addEventListener("mouseover",(e=>{r(!!(1&e.buttons))}))},e.leave=function(e,r){n()?e.addEventListener("pointerleave",r):t()?e.addEventListener("touchend",r):e.addEventListener("mouseleave",r)},e.move=function(e,r){n()?e.addEventListener("pointermove",r):t()?e.addEventListener("touchmove",r):e.addEventListener("mousemove",r)},e.click=function(e,t){e.addEventListener("click",t)}}(e.events||(e.events={}))}(e.svgUtil||(e.svgUtil={}))}(pxt||(pxt={})),function(e){!function(e){!function(t){class n extends e.Text{at(e,t){return this.cx=e,this.cy=t,this.rePosition(),this}text(e,t=12){return super.text(e),this.fontSizePixels=t,this.setAttribute("font-size",t+"px"),this.rePosition(),this}rePosition(){null!=this.cx&&null!=this.cy&&null!=this.fontSizePixels&&(this.setAttribute("x",this.cx),this.setAttribute("y",this.cy),this.setAttribute("text-anchor","middle"),this.setAttribute("alignment-baseline","middle"))}}t.CenteredText=n}(e.helpers||(e.helpers={}))}(e.svgUtil||(e.svgUtil={}))}(pxt||(pxt={})),function(e){!function(e){e.initExtensionsAsync=e=>Promise.resolve({}),e.initFieldExtensionsAsync=e=>Promise.resolve({})}(e.editor||(e.editor={}))}(pxt||(pxt={})),function(e){e.IMAGE_MIME_TYPE="image/x-mkcd-f4",e.TILEMAP_MIME_TYPE="application/mkcd-tilemap",e.ANIMATION_MIME_TYPE="application/mkcd-animation",e.SONG_MIME_TYPE="application/mkcd-song";class t{constructor(){this.assets=[],this.takenNames={},this.listeners=[]}add(e){if(this.takenNames[e.id])return this.update(e.id,e);{const t=a(e);return this.takenNames[t.id]=!0,this.takenNames[f(t)]=!0,t.meta.displayName&&t.meta.displayName!==t.id&&(this.takenNames[t.meta.displayName]&&(t.meta.displayName=this.generateNewDisplayName(t.meta.displayName)),this.takenNames[t.meta.displayName]=!0),this.assets.push(t),a(t)}}getSnapshot(e){return e?this.assets.filter((t=>e(t))).map(a):this.assets.map(a)}update(e,t){let n;if(this.takenNames[e]){p(this.lookupByID(e),t)?n=t:(this.removeByID(e),n=this.add(t),this.notifyListener(t.internalID))}else n=this.add(t);return n}removeByID(e){const t=this.lookupByID(e);this.assets=this.assets.filter((t=>t.id!==e)),delete this.takenNames[e],t&&delete this.takenNames[f(t)],(null==t?void 0:t.meta.displayName)&&delete this.takenNames[null==t?void 0:t.meta.displayName]}getByID(e){const t=this.lookupByID(e);return t&&a(t)}getByDisplayName(e){if(this.takenNames[e])for(const t of this.assets)if(t.meta.displayName===e||f(t)===e)return a(t)}isIDTaken(e){return!!this.takenNames[e]}clone(){const e=new t;return e.assets=this.getSnapshot(),e.takenNames=Object.assign({},this.takenNames),e}serializeToJRes(e={}){for(const t of this.assets)d(t,e);return e}addListener(e,t){this.listeners.push({internalID:e,callback:t})}removeListener(e){this.listeners=this.listeners.filter((t=>t.callback!==e))}diff(e){let t={before:[],after:[]},n={};for(const r of e.assets){n[r.internalID]=!0;const e=this.lookupByInternalID(r.internalID);e&&p(r,e)||(t.before.push(r),t.after.push(e))}for(const e of this.assets.filter((e=>!n[e.internalID])))t.before.push(null),t.after.push(e);return t}applyDiff(t,n=!1){const r=n?t.after:t.before,i=n?t.before:t.after;e.Util.assert(r.length===i.length);for(let e=0;e<r.length;e++)r[e]?(this.removeByInternalID(r[e].internalID),i[e]&&this.assets.push(i[e]),this.notifyListener(r[e].internalID)):(this.assets.push(i[e]),this.notifyListener(i[e].internalID));this.takenNames={};for(const t of this.assets)e.Util.assert(!this.takenNames[t.id]),this.takenNames[t.id]=!0,this.takenNames[f(t)]=!0,t.meta.displayName&&(t.meta.displayName!==t.id&&e.Util.assert(!this.takenNames[t.meta.displayName]),this.takenNames[t.meta.displayName]=!0)}lookupByID(e){for(const t of this.assets)if(t.id===e)return t;return null}lookupByInternalID(e){for(const t of this.assets)if(t.internalID===e)return t;return null}removeByInternalID(e){this.assets=this.assets.filter((t=>t.internalID!==e))}notifyListener(e){for(const t of this.listeners)t.internalID===e&&t.callback()}generateNewDisplayName(e){e=e.replace(/\d+$/,"");let t=0;for(;this.takenNames[e+t];)++t;return e+t}}class n{constructor(){this.needsRebuild=!0,this.nextID=0,this.nextInternalID=0,this.committedState={revision:0,tilemaps:new t,tiles:new t,animations:new t,images:new t,songs:new t},this.state={revision:this.nextID++,tilemaps:new t,tiles:new t,animations:new t,images:new t,songs:new t},this.gallery={revision:0,tilemaps:new t,tiles:new t,animations:new t,images:new t,songs:new t},this.undoStack=[],this.redoStack=[]}getNewInternalId(){return this.nextInternalID++}createNewImage(t=16,n=16){this.onChange();const r=this.generateNewID("image"),i=new e.sprite.Bitmap(t,n).data(),s={internalID:this.getNewInternalId(),id:r,type:"image",bitmap:i,meta:{},jresData:e.sprite.base64EncodeBitmap(i)};return this.state.images.add(s)}createNewAnimation(t=16,n=16){this.onChange();const r=this.generateNewID("animation"),i=new e.sprite.Bitmap(t,n).data(),s={internalID:this.getNewInternalId(),id:r,type:"animation",frames:[i],interval:500,meta:{}};return this.state.animations.add(s)}createNewAnimationFromData(e,t=500,n){this.onChange();const r=this.generateNewID("animation"),i={internalID:this.getNewInternalId(),id:r,type:"animation",frames:e,interval:t,meta:{displayName:n}};return this.state.animations.add(i)}getGalleryTiles(e){return this.extensionTileSets?this.extensionTileSets.map((t=>t.tileSets.find((t=>t.tileWidth===e)))).filter((e=>null==e?void 0:e.tiles.length)):null}getProjectImages(){return this.state.images.getSnapshot()}getProjectTiles(t,n){const r=this.state.tiles.getSnapshot((e=>e.bitmap.width===t));return 0===r.length?n?(this.createNewTile(new e.sprite.Bitmap(t,t).data()),this.getProjectTiles(t,!1)):null:{tileWidth:t,tiles:r}}createNewTile(t,n,r){this.onChange(),n&&!this.isNameTaken("tile",n)||(n=this.generateNewID("tile"));const i={internalID:this.getNewInternalId(),id:n,type:"tile",jresData:e.sprite.base64EncodeBitmap(t),bitmap:t,meta:{displayName:r},isProjectTile:!0};return this.state.tiles.add(i)}createNewProjectImage(t,n){this.onChange();const r={internalID:this.getNewInternalId(),id:this.generateNewID("image"),type:"image",jresData:e.sprite.base64EncodeBitmap(t),meta:{displayName:n},bitmap:t};return this.state.images.add(r)}createNewSong(t,n){this.onChange();const r={internalID:this.getNewInternalId(),id:this.generateNewID("song"),type:"song",song:e.assets.music.cloneSong(t),meta:{displayName:n}};return this.state.songs.add(r)}updateTile(t){this.onChange();const n=this.resolveProjectTileByInternalID(t.internalID);if(n){if(this.state.tiles.update(n.id,t),n.id!==t.id||!e.sprite.bitmapEquals(n.bitmap,t.bitmap))for(const e of this.getAssets("tilemap"))e.data.tileset.tiles.some((e=>e.internalID===t.internalID))&&(e.data.tileset.tiles=e.data.tileset.tiles.map((e=>e.internalID===t.internalID?t:e)),this.updateTilemap(e.id,e.data));return t}return null}deleteTile(e){this.onChange(),this.state.tiles.removeByID(e)}getProjectTilesetJRes(){const t={};return this.state.tiles.serializeToJRes(t),this.state.tilemaps.serializeToJRes(t),t["*"]={mimeType:"image/x-mkcd-f4",dataEncoding:"base64",namespace:e.sprite.TILE_NAMESPACE},t}getProjectAssetsJRes(){const t={};return this.state.images.serializeToJRes(t),this.state.animations.serializeToJRes(t),this.state.songs.serializeToJRes(t),t["*"]={mimeType:"image/x-mkcd-f4",dataEncoding:"base64",namespace:e.sprite.IMAGES_NAMESPACE},t}getTilemap(e){return this.state.tilemaps.getByID(e)}updateTilemap(e,t){const n=this.state.tilemaps.getByID(e);if(n){this.onChange();const r=Object.assign(Object.assign({},n),{data:t});return this.state.tilemaps.update(e,r),r}return null}createNewTilemap(e,t,n=16,r=16){return this.createNewTilemapFromData(this.blankTilemap(t,n,r),e)}blankTilemap(t,n=16,r=16){const i=new e.sprite.Tilemap(n,r),s=new e.sprite.Bitmap(n,r),o={tileWidth:t,tiles:[this.getTransparency(t)]};return new e.sprite.TilemapData(i,o,s.data())}resolveTile(e){return this.lookupAsset("tile",e)}resolveProjectTileByInternalID(e){return this.state.tiles.getSnapshot((t=>t.internalID===e))[0]}resolveTileByBitmap(t){const n=e.sprite.base64EncodeBitmap(t);return this.state.tiles.getSnapshot((e=>e.jresData===n))[0]}getTransparency(t){const n=e.sprite.TILE_NAMESPACE+".transparency"+t;let r=this.state.tiles.getByID(n);if(!r){const i=new e.sprite.Bitmap(t,t).data();return r={internalID:this.getNewInternalId(),id:n,type:"tile",bitmap:i,jresData:e.sprite.base64EncodeBitmap(i),meta:{},isProjectTile:!0},this.state.tiles.add(r)}return r}createNewTilemapFromData(e,t){this.onChange();const n=this.generateNewIDInternal("tilemap",t||lf("level"));return this.state.tilemaps.add({internalID:this.getNewInternalId(),id:n,type:"tilemap",meta:{displayName:t||n},data:e}),[n,e]}cloneState(){return{revision:this.state.revision,images:this.state.images.clone(),tilemaps:this.state.tilemaps.clone(),animations:this.state.animations.clone(),tiles:this.state.tiles.clone(),songs:this.state.songs.clone()}}undo(){if(this.state.revision!==this.committedState.revision&&this.pushUndo(),this.undoStack.length){const e=this.undoStack.pop();this.state.tiles.applyDiff(e.tiles,!0),this.state.images.applyDiff(e.images,!0),this.state.tilemaps.applyDiff(e.tilemaps,!0),this.state.animations.applyDiff(e.animations,!0),this.state.songs.applyDiff(e.songs,!0),this.state.revision=e.beforeRevision,this.redoStack.push(e),this.committedState=this.cloneState(),this.needsRebuild=!0}}redo(){if(this.redoStack.length){const e=this.redoStack.pop();this.state.tiles.applyDiff(e.tiles),this.state.images.applyDiff(e.images),this.state.tilemaps.applyDiff(e.tilemaps),this.state.animations.applyDiff(e.animations),this.state.songs.applyDiff(e.songs),this.state.revision=e.afterRevision,this.undoStack.push(e),this.committedState=this.cloneState(),this.needsRebuild=!0}}pushUndo(){this.undoStack.length&&this.committedState.revision===this.state.revision||(this.redoStack=[],this.undoStack.push({beforeRevision:this.committedState.revision,afterRevision:this.state.revision,tiles:this.state.tiles.diff(this.committedState.tiles),images:this.state.images.diff(this.committedState.images),tilemaps:this.state.tilemaps.diff(this.committedState.tilemaps),animations:this.state.animations.diff(this.committedState.animations),songs:this.state.songs.diff(this.committedState.songs)}),this.committedState=this.cloneState(),this.cleanupTemporaryAssets())}revision(){return this.state.revision}encodeTilemap(t,n){const r=t.tilemap.data(),i=new Uint8ClampedArray(5+r.data.length+t.layers.data.length);return i[0]=t.tileset.tileWidth,i[1]=255&r.width,i[2]=r.width>>8&255,i[3]=255&r.height,i[4]=r.height>>8&255,i.set(r.data,5),i.set(t.layers.data,5+r.data.length),{id:n,mimeType:e.TILEMAP_MIME_TYPE,data:btoa(e.sprite.uint8ArrayToHex(i)),tileset:t.tileset.tiles.map((e=>e.id))}}forceUpdate(){this.onChange()}isNameTaken(e,t){const n=t=>y(this.state,e).isIDTaken(t)||y(this.gallery,e).isIDTaken(t),r=m(e,t),i=r&&r!==t;return n(t)||i&&n(r)}isAssetUsed(t,n,r){var i,s,o;if(((null===(s=null===(i=t.meta)||void 0===i?void 0:i.blockIDs)||void 0===s?void 0:s.filter((e=>!r||(null==r?void 0:r.indexOf(e))<0)))||[]).length>0)return!0;if("tile"==t.type)for(const e of this.getAssets("tilemap"))if(!((null==r?void 0:r.indexOf(e.id))>=0)&&e.data.tileset.tiles.some((e=>e.id===t.id)))return!0;if(n){const i=e.Util.escapeForRegex(f(t)),s=e.Util.escapeForRegex(null===(o=t.meta)||void 0===o?void 0:o.displayName)||"";let a;switch(t.type){case"tile":a=`myTiles.${i}|assets.tile\`${i}\``,s&&(a+=`|assets.tile\`${s}\``);break;case"tilemap":a=`tilemap\`${i}\``;break;case"animation":a=`assets.animation\`${i}\``,s&&(a+=`|assets.animation\`${s}\``);break;case"song":a=`assets.song\`${i}\``,s&&(a+=`|assets.song\`${s}\``);break;default:a=`assets.image\`${i}\``,s&&(a+=`|assets.image\`${s}\``)}const l=new RegExp(a,"gm");let c;switch(t.type){case"tile":c=`myTiles.${i}|assets.tile("""${i}""")`,s&&(c+=`|assets.tile("""${s}""")`);break;case"tilemap":c=`assets.tilemap("""${i}""")`;break;case"animation":c=`assets.animation("""${i}""")`,s&&(c+=`|assets.animation("""${s}""")`);break;case"song":c=`assets.song("""${i}""")`,s&&(c+=`|assets.song("""${s}""")`);break;default:c=`assets.image("""${i}""")`,s&&(c+=`|assets.image("""${s}""")`)}const u=new RegExp(c,"gm");for(let e of Object.keys(n)){if((null==r?void 0:r.indexOf(e))>=0)continue;const t=n[e];if(e.match(/((?!\.g).{2}|^.{0,1})\.ts$/i)){if(t.content.match(l))return!0}else if(e.endsWith(".py")&&t.content.match(u))return!0}}return!1}lookupAsset(e,t){return y(this.state,e).getByID(t)||y(this.gallery,e).getByID(t)}lookupAssetByName(e,t){return y(this.state,e).getByDisplayName(t)}getAssets(e){return y(this.state,e).getSnapshot()}getGalleryAssets(e){return y(this.gallery,e).getSnapshot()}lookupBlockAsset(e,t){return y(this.state,e).getSnapshot((e=>{var n,r;return-1!==(null===(r=null===(n=e.meta)||void 0===n?void 0:n.blockIDs)||void 0===r?void 0:r.indexOf(t))}))[0]}updateAsset(e){switch(this.onChange(),e.type){case"tile":return this.updateTile(e);default:return y(this.state,e.type).update(e.id,e)}}duplicateAsset(e,t){var n;this.onChange();const r=a(e),i=t||(null===(n=r.meta)||void 0===n?void 0:n.displayName);let s;switch(e.type){case"image":s=this.createNewProjectImage(r.bitmap,i);break;case"tile":s=this.createNewTile(r.bitmap,null,i);break;case"tilemap":const[t,n]=this.createNewTilemapFromData(r.data,i);s=this.getTilemap(t);break;case"animation":s=this.createNewAnimationFromData(r.frames,r.interval,i);break;case"song":s=this.createNewSong(e.song,i)}return s}removeAsset(e){this.onChange(),y(this.state,e.type).removeByID(e.id)}addChangeListener(e,t){y(this.state,e.type).addListener(e.internalID,t)}removeChangeListener(e,t){y(this.state,e).removeListener(t)}loadPackage(e){const t=e.sortedDeps();this.extensionTileSets=[];for(const e of t){const t="this"===e.id,n=this.readImages(e.parseJRes(),t);for(const r of n)r.meta.package=e.id,"tile"===r.type?t?this.state.tiles.add(r):this.gallery.tiles.add(r):"image"===r.type?t?this.state.images.add(r):this.gallery.images.add(r):"animation"===r.type?t?this.state.animations.add(r):this.gallery.animations.add(r):t?this.state.songs.add(r):this.gallery.songs.add(r)}for(const n of t){const t="this"===n.id;for(const i of r(n.parseJRes()))t?this.state.tilemaps.add({internalID:this.getNewInternalId(),type:"tilemap",id:i.id,meta:{displayName:i.displayName||i.id,package:e.id},data:o(i,(e=>this.resolveTile(e)))}):this.gallery.tilemaps.add({internalID:this.getNewInternalId(),type:"tilemap",id:i.id,meta:{displayName:i.displayName||i.id,package:e.id},data:o(i,(e=>this.gallery.tiles.getByID(e)))})}this.committedState=this.cloneState(),this.undoStack=[],this.redoStack=[]}loadTilemapJRes(t,n=!1,i=!1){t=e.inflateJRes(t);const s=this.readImages(t,!i).filter((e=>"tile"===e.type));let a={};if(i)for(const e of s)this.gallery.tiles.add(e);else for(const e of s){if(n){const t=this.resolveTileByBitmap(e.bitmap);if(t){a[e.id]=t.id;continue}}const t=this.createNewTile(e.bitmap,e.id,e.meta.displayName);t.id!==e.id&&(a[e.id]=t.id)}const l=i?this.gallery:this.state;for(const e of r(t))l.tilemaps.add({internalID:this.getNewInternalId(),type:"tilemap",id:e.id,meta:{displayName:e.displayName||e.id},data:o(e,(e=>(a[e]&&(e=a[e]),this.resolveTile(e))))})}loadAssetsJRes(t,n=!1){t=e.inflateJRes(t);const r=[],i=n?this.gallery:this.state;for(const n of Object.keys(t)){const s=t[n];if(s.tilemapTile)i.tiles.add(this.generateImage(s,"tile"));else if(s.mimeType===e.IMAGE_MIME_TYPE)i.images.add(this.generateImage(s,"image"));else if(s.mimeType===e.ANIMATION_MIME_TYPE){const[e,t]=this.generateAnimation(s);t?r.push(e):i.animations.add(e)}else s.mimeType===e.SONG_MIME_TYPE&&i.songs.add(this.generateSong(s))}for(const e of r)i.animations.add(this.inflateAnimation(e,i.images.getSnapshot()))}removeInactiveBlockAssets(e){function t(t){const n=t.getSnapshot((t=>{var n;return!t.meta.displayName&&(null===(n=t.meta.blockIDs)||void 0===n?void 0:n.some((t=>-1===e.indexOf(t))))})),r=[];for(const t of n)1===t.meta.blockIDs.length?r.push(t):(t.meta.blockIDs=t.meta.blockIDs.filter((t=>-1!==e.indexOf(t))),0===t.meta.blockIDs.length&&r.push(t));for(const e of r)t.removeByID(e.id)}t(this.state.images),t(this.state.tiles),t(this.state.tilemaps),t(this.state.animations),t(this.state.songs)}clone(){var e;const t=new n;return t.committedState=l(this.committedState),t.state=l(this.state),t.gallery=l(this.gallery),t.extensionTileSets=null===(e=this.extensionTileSets)||void 0===e?void 0:e.map((e=>Object.assign(Object.assign({},e),{tileSets:e.tileSets.map((e=>Object.assign(Object.assign({},e),{tiles:e.tiles.map((e=>a(e)))})))}))),t.needsRebuild=this.needsRebuild,t.nextID=this.nextID,t.nextInternalID=this.nextInternalID,t.undoStack=this.undoStack.map((e=>c(e))),t.redoStack=this.undoStack.map((e=>c(e))),t}generateImage(t,n){return{internalID:this.getNewInternalId(),type:n,id:t.id,meta:{displayName:t.displayName,tags:t.tags},jresData:t.data,bitmap:e.sprite.getBitmapFromJResURL(`data:${e.IMAGE_MIME_TYPE};base64,${t.data}`).data()}}generateSong(t){return{internalID:this.getNewInternalId(),type:"song",id:t.id,meta:{displayName:t.displayName,tags:t.tags},song:e.assets.music.decodeSongFromHex(t.data)}}generateAnimation(e){if("json"===e.dataEncoding){let t;try{t=JSON.parse(e.data)}catch(t){console.warn("could not parse json data of '"+e.id+"'")}return[{internalID:this.getNewInternalId(),type:"animation",meta:{displayName:e.displayName,tags:e.tags},id:e.id,frames:[],frameIds:t.frames,interval:100,flippedHorizontal:t.flippedHorizontal},!0]}return[Object.assign(Object.assign({},_(e)),{internalID:this.getNewInternalId()}),!1]}inflateAnimation(t,n){return t.frames=t.frameIds.map((e=>n.find((t=>t.id===e)).bitmap)),t.flippedHorizontal&&(t.frames=t.frames.map((t=>{const n=e.sprite.Bitmap.fromData(t),r=new e.sprite.Bitmap(t.width,t.height);for(let e=0;e<r.width;e++)for(let t=0;t<r.height;t++)r.set(e,t,n.get(n.width-e-1,t));return r.data()}))),t}generateNewID(t){switch(t){case"animation":return this.generateNewIDInternal("animation",e.sprite.ANIMATION_PREFIX,e.sprite.ANIMATION_NAMESPACE);case"image":return this.generateNewIDInternal("image",e.sprite.IMAGE_PREFIX,e.sprite.IMAGES_NAMESPACE);case"tile":return this.generateNewIDInternal("tile",e.sprite.TILE_PREFIX,e.sprite.TILE_NAMESPACE);case"tilemap":return this.generateNewIDInternal("tilemap",lf("level"));case"song":return this.generateNewIDInternal("song",e.sprite.SONG_PREFIX,e.sprite.SONG_NAMESPACE)}}generateNewIDInternal(e,t,n){t=t.replace(/\d+$/,"");const r=n?n+"."+t:t;let i=1;for(;this.isNameTaken(e,r+i);)++i;return r+i}onChange(){this.needsRebuild=!0,this.state.revision=this.nextID++}readImages(t,n=!1){const r=[],i=[];for(const s of Object.keys(t)){const o=t[s];if(o.tilemapTile){const e=this.generateImage(o,"tile");e.isProjectTile=n,r.push(e)}else if(o.mimeType===e.IMAGE_MIME_TYPE)r.push(this.generateImage(o,"image"));else if(o.mimeType===e.ANIMATION_MIME_TYPE){const[e,t]=this.generateAnimation(o);t?i.push(e):r.push(e)}else o.mimeType===e.SONG_MIME_TYPE&&r.push(this.generateSong(o))}for(const e of i)r.push(this.inflateAnimation(e,r));return r}cleanupTemporaryAssets(){const e=this.state.images.getSnapshot((e=>{var t;return!e.meta.displayName&&!(null===(t=e.meta.blockIDs)||void 0===t?void 0:t.length)}));for(const t of e)this.state.images.removeByID(t.id)}}function r(t){const n=[];for(const r of Object.keys(t)){const i=t[r];i.mimeType===e.TILEMAP_MIME_TYPE&&n.push(i)}return n}function i(e,t){return`\n    helpers._registerFactory("${e}", function(name: string) {\n        switch(helpers.stringTrim(name)) {\n`+t.map((e=>e.keys.filter((e=>!!e)).map((e=>`            case "${e}":`)).join("\n")+`return ${e.expression};`)).join("\n")+"\n        }\n        return null;\n    })\n"}function s(t){return e.sprite.Bitmap.fromData(t).copy().data()}function o(t,n){const r=atob(t.data),i=e.U.fromHex(r),s=i[1]|i[2]<<8,o=i[3]|i[4]<<8,a={tileWidth:i[0],tiles:t.tileset.map((e=>n&&n(e)||{id:e}))},l=i.slice(5,5+s*o),c=new e.sprite.Tilemap(s,o,0,0,new Uint8ClampedArray(l)),u=i.slice(5+l.length),d=new e.sprite.Bitmap(s,o,0,0,new Uint8ClampedArray(u)).data();return new e.sprite.TilemapData(c,a,d)}function a(t){switch(t.meta=Object.assign({},t.meta),t.type){case"tile":case"image":return Object.assign(Object.assign({},t),{bitmap:s(t.bitmap)});case"animation":return Object.assign(Object.assign({},t),{frames:t.frames.map((e=>s(e)))});case"tilemap":return Object.assign(Object.assign({},t),{data:t.data.cloneData()});case"song":return Object.assign(Object.assign({},t),{song:e.assets.music.cloneSong(t.song)})}}function l(e){return{revision:e.revision,tilemaps:e.tilemaps.clone(),images:e.images.clone(),animations:e.animations.clone(),songs:e.songs.clone(),tiles:e.tiles.clone()}}function c(e){return Object.assign(Object.assign({},e),{animations:u(e.animations),tiles:u(e.tiles),images:u(e.images),tilemaps:u(e.tilemaps),songs:u(e.songs)})}function u(e){return Object.assign(Object.assign({},e),{before:e.before.map((e=>a(e))),after:e.after.map((e=>a(e)))})}function d(t,n){const r=t.id.substr(t.id.lastIndexOf(".")+1),i=t.meta.tags;switch(t.type){case"image":if(n[r]=t.jresData,t.meta.displayName||(null==i?void 0:i.length)){const s={data:t.jresData,mimeType:e.IMAGE_MIME_TYPE};t.meta.displayName&&(s.displayName=t.meta.displayName),(null==i?void 0:i.length)&&(s.tags=i),n[r]=s}break;case"tile":const s={data:t.jresData,mimeType:e.IMAGE_MIME_TYPE,tilemapTile:!0,displayName:t.meta.displayName};(null==i?void 0:i.length)&&(s.tags=i),n[r]=s;break;case"tilemap":const o=function(t,n,r){const i=t.tilemap.data(),s=new Uint8ClampedArray(5+i.data.length+t.layers.data.length);return s[0]=t.tileset.tileWidth,s[1]=255&i.width,s[2]=i.width>>8&255,s[3]=255&i.height,s[4]=i.height>>8&255,s.set(i.data,5),s.set(t.layers.data,5+i.data.length),{id:n,mimeType:e.TILEMAP_MIME_TYPE,data:btoa(e.sprite.uint8ArrayToHex(s)),tileset:t.tileset.tiles.map((e=>e.id)),displayName:r}}(t.data,t.id,t.meta.displayName);n[o.id]=o;break;case"animation":n[r]=function(t){var n;const r={namespace:t.id.substr(0,t.id.lastIndexOf(".")),id:t.id.substr(t.id.lastIndexOf(".")+1),mimeType:e.ANIMATION_MIME_TYPE,data:e.sprite.encodeAnimationString(t.frames,t.interval),displayName:t.meta.displayName};(null===(n=t.meta.tags)||void 0===n?void 0:n.length)&&(r.tags=t.meta.tags);return r}(t);break;case"song":const a={data:e.assets.music.encodeSongToHex(t.song),mimeType:e.SONG_MIME_TYPE,displayName:t.meta.displayName,namespace:e.sprite.SONG_NAMESPACE+"."};(null==i?void 0:i.length)&&(a.tags=i),n[r]=a}}function p(t,n){if(t==n)return!0;if(t.id!==n.id||t.type!==n.type||!e.U.arrayEquals(t.meta.tags,n.meta.tags)||!e.U.arrayEquals(t.meta.blockIDs,n.meta.blockIDs)||t.meta.displayName!==n.meta.displayName)return!1;switch(t.type){case"image":case"tile":return e.sprite.bitmapEquals(t.bitmap,n.bitmap);case"animation":const r=n;return t.interval===r.interval&&e.U.arrayEquals(t.frames,r.frames,e.sprite.bitmapEquals);case"tilemap":return t.data.equals(n.data);case"song":return e.assets.music.songEquals(t.song,n.song)}}function h(e){const t=/^\s*(?:(?:assets\s*\.\s*(image|tile|animation|tilemap|song))|(tilemap))\s*(?:`|\(""")([^`"]+)(?:`|"""\))\s*$/m.exec(e);if(t){return{type:t[1]||t[2],name:t[3].trim()}}}function f(e){return m(e.type,e.id)}function m(t,n,r=!1){let i;switch(t){case"image":i=e.sprite.IMAGES_NAMESPACE+".";break;case"tile":i=e.sprite.TILE_NAMESPACE+".";break;case"tilemap":i="";break;case"animation":i=e.sprite.ANIMATION_NAMESPACE+".";break;case"song":i=e.sprite.SONG_NAMESPACE+"."}if(i)if(n.startsWith(i)){const e=n.substr(i.length);if(-1===e.indexOf("."))return e}else if(!r)return null;return n}function _(t){const n=atob(t.data),r=new Uint8ClampedArray(e.U.fromHex(n)),i=g(r,0),s=g(r,2),o=g(r,4),a=g(r,6),l=Math.ceil(s*o/2);let c=8;const u=[];for(let e=0;e<a;e++){const e=r.slice(c,c+l);u.push({x0:0,y0:0,width:s,height:o,data:e}),c+=l}let d=t.id;return d.startsWith(t.namespace)||(d=t.namespace+"."+d,d=d.replace(/\.\./g,".")),{type:"animation",internalID:0,id:d,interval:i,frames:u,meta:{displayName:t.displayName,tags:t.tags}}}function g(e,t){return e[t]|e[t+1]<<8}function y(e,t){switch(t){case"animation":return e.animations;case"image":return e.images;case"tile":return e.tiles;case"tilemap":return e.tilemaps;case"song":return e.songs}}e.TilemapProject=n,e.emitGalleryDeclarations=function(t,n){var r;const i=Object.keys(t);let s="";const a={},l={},c={},u=e=>{let n=t[e].namespace||t["*"].namespace;const r=t[e].id||e;return n&&(n.endsWith(".")&&(n=n.slice(0,n.length-1)),!r.startsWith(n+"."))?n+"."+r:r};t["*"]&&(c["*"]=Object.assign(Object.assign({},t["*"]),{namespace:n}));for(const e of i){if("*"===e)continue;const r=t[e],i=u(e);let s=ts.pxtc.escapeIdentifier(r.displayName||i.split(".").pop());if(a[s]){const e=s;let t=2;for(;a[s];)s=e+t,t++}a[s]=!0,l[i]=n+"."+s}for(const a of i){if("*"===a)continue;const i=t[a];let d,p,h=i.mimeType||(null===(r=t["*"])||void 0===r?void 0:r.mimeType);const f=l[u(a)].split(".").pop();let m=i.tags;if(m||(m=[],-1!==f.toLowerCase().indexOf("background")&&m.push("background"),-1!==f.toLowerCase().indexOf("dialog")&&m.push("dialog"),i.tilemapTile&&m.push("tile")),h===e.IMAGE_MIME_TYPE)p="image.ofBuffer(hex``)",d=i.tilemapTile?"images._tile":"images._image";else if(h===e.ANIMATION_MIME_TYPE){p=`[${_(i).frames.map((t=>e.sprite.bitmapToImageLiteral(e.sprite.Bitmap.fromData(t),"typescript"))).join(",")}]`}else if(h===e.TILEMAP_MIME_TYPE){const t=o(i);p=e.sprite.encodeTilemap(t,"typescript",l)}else h===e.SONG_MIME_TYPE&&(p=`hex\`${i.data}\``);s+="    //% fixedInstance jres whenUsed\n",d&&(s+=`    //% blockIdentity=${d}\n`),m.length&&(s+=`    //% tags="${m.join(" ")}"\n`),s+=`    export const ${f} = ${p};\n`,"string"==typeof i?c[f]=i:(c[f]=Object.assign(Object.assign({},i),{id:l[u(a)],tags:m}),i.namespace&&(c[f].namespace=n,i.namespace.endsWith(".")&&(c[f].namespace+=".")),c[f].tileset&&(c[f].tileset=i.tileset.map((e=>l[e]||e))))}const d=lf("Auto-generated code. Do not edit.");return[c,`// ${d}\nnamespace ${n} {\n${s}\n}\n// ${d}\n`]},e.emitTilemapsFromJRes=function(t){const n=Object.keys(t);let r="";const s=[],a=[];for(const i of n){if("*"===i)continue;const n=t[i];if(n.tilemapTile){let e=i;-1!==e.indexOf(".")&&(e=e.split(".").slice(-1)[0]),r+="    //% fixedInstance jres blockIdentity=images._tile\n",r+=`    export const ${e} = image.ofBuffer(hex\`\`);\n`,a.push({keys:[n.displayName,m("tile",i,!0)],expression:i})}if(n.mimeType===e.TILEMAP_MIME_TYPE){const t=o(n);s.push({keys:[n.displayName,m("tilemap",n.id)],expression:e.sprite.encodeTilemap(t,"typescript")})}}s.length&&(r+=i("tilemap",s)),a.length&&(r+=i("tile",a));const l=lf("Auto-generated code. Do not edit.");return`// ${l}\nnamespace ${e.sprite.TILE_NAMESPACE} {\n${r}\n}\n// ${l}\n`},e.emitProjectImages=function(t){const n=Object.keys(t);let r="";const s=[],o=[],a=[];for(const r of n){if("*"===r)continue;const n=t[r];if("string"==typeof n||n.mimeType===e.IMAGE_MIME_TYPE){let t,i=[m("image",r,!0)];"string"==typeof n?t=e.sprite.bitmapToImageLiteral(e.sprite.getBitmapFromJResURL(n),"typescript"):(t=e.sprite.bitmapToImageLiteral(e.sprite.getBitmapFromJResURL(n.data),"typescript"),i.push(n.displayName)),s.push({keys:i,expression:t})}else if(n.mimeType===e.ANIMATION_MIME_TYPE){const t=_(n);o.push({keys:[n.displayName,m("animation",r,!0)],expression:`[${t.frames.map((t=>e.sprite.bitmapToImageLiteral(e.sprite.Bitmap.fromData(t),"typescript"))).join(", ")}]`})}else n.mimeType===e.SONG_MIME_TYPE&&a.push({keys:[m("song",r,!0),n.displayName],expression:`hex\`${n.data}\``})}const l=lf("Auto-generated code. Do not edit.");return r+=i("image",s),r+=i("animation",o),r+=i("song",a),`// ${l}\nnamespace ${e.sprite.IMAGES_NAMESPACE} {\n${r}\n}\n// ${l}\n`},e.cloneAsset=a,e.assetEquals=p,e.validateAssetName=function(e){return!!e&&!/[\u0000-\u001f\u0021-\u002c\u002e\u002f\u003a-\u0040\u005b-\u005e\u0060\u007b-\u007f]/.test(e)},e.getTSReferenceForAsset=function(e,t=!1){var n;let r;if(r=(null===(n=e.meta)||void 0===n?void 0:n.displayName)?e.meta.displayName:f(e),!r)return"image"===e.type||"tile"===e.type?e.id:void 0;const i=t?'("""':"`",s=t?'""")':"`";switch(e.type){case"tile":return`assets.tile${i}${r}${s}`;case"image":return`assets.image${i}${r}${s}`;case"animation":return`assets.animation${i}${r}${s}`;case"tilemap":return`tilemap${i}${r}${s}`;case"song":return`assets.song${i}${r}${s}`}},e.parseAssetTSReference=h,e.lookupProjectAssetByTSReference=function(e,t){const n=h(e);if(n){const{type:e,name:r}=n;switch(e){case"tile":return t.lookupAssetByName("tile",r);case"image":return t.lookupAssetByName("image",r);case"tilemap":return t.lookupAssetByName("tilemap",r)||t.lookupAsset("tilemap",r);case"animation":return t.lookupAssetByName("animation",r);case"song":return t.lookupAssetByName("song",r)}}},e.getDefaultAssetDisplayName=function(e){switch(e){case"image":return lf("myImage");case"tile":return lf("myTile");case"tilemap":return lf("level");case"animation":return lf("myAnim");case"song":return lf("mySong");default:return lf("asset")}},e.getShortIDForAsset=f}(pxt||(pxt={})),function(e){!function(t){t.blockColors={loops:"#107c10",logic:"#006970",math:"#712672",variables:"#A80000",functions:"#005a9e",text:"#996600",arrays:"#A94400",advanced:"#3c3c3c",addpackage:"#717171",search:"#000",debug:"#e03030",default:"#dddddd",topblocks:"#aa8f00",recipes:"#717171"},t.blockIcons={loops:"",logic:"",math:"",variables:"",functions:"",text:"",arrays:"",advancedcollapsed:"",advancedexpanded:"",more:"",addpackage:"",search:"",debug:"",default:"",topblocks:"",recipes:""};let n="";function r(e){const t=function(e,t,n){let r=0,i=0,s=0;if(0==t)r=n,i=n,s=n;else{let o=Math.floor(e/60),a=e/60-o,l=n*(1-t),c=n*(1-t*a),u=n*(1-t*(1-a));switch(o){case 1:r=c,i=n,s=l;break;case 2:r=l,i=n,s=u;break;case 3:r=l,i=c,s=n;break;case 4:r=u,i=l,s=n;break;case 5:r=n,i=l,s=c;break;case 6:case 0:r=n,i=u,s=l}}return[Math.floor(r),Math.floor(i),Math.floor(s)]}(e,.45,165.75);return`#${i(t[0])}${i(t[1])}${i(t[2])}`}function i(e){const t=e.toString(16);return 1==t.length?"0"+t:t}t.appendToolboxIconCss=function(t,r){if(!(n.indexOf(t)>-1))if(1===r.length){const i=e.Util.unicodeToChar(r);n+=`\n                .blocklyTreeIcon.${t}::before {\n                    content: "${i}";\n                }\n            `}else n+=`\n                .blocklyTreeIcon.${t} {\n                    background-image: url("${e.Util.pathJoin(e.webConfig.commitCdnUrl,encodeURI(r))}")!important;\n                    width: 30px;\n                    height: 100%;\n                    background-size: 20px !important;\n                    background-repeat: no-repeat !important;\n                    background-position: 50% 50% !important;\n                }\n            `},t.getNamespaceColor=function(t){return t=t.toLowerCase(),e.appTarget.appTheme.blockColors&&e.appTarget.appTheme.blockColors[t]?e.appTarget.appTheme.blockColors[t]:e.toolbox.blockColors[t]?e.toolbox.blockColors[t]:""},t.getNamespaceIcon=function(t){return t=t.toLowerCase(),e.appTarget.appTheme.blockIcons&&e.appTarget.appTheme.blockIcons[t]?e.appTarget.appTheme.blockIcons[t]:e.toolbox.blockIcons[t]?e.toolbox.blockIcons[t]:""},t.advancedTitle=function(){return e.Util.lf("{id:category}Advanced")},t.addPackageTitle=function(){return e.Util.lf("{id:category}Extensions")},t.recipesTitle=function(){return e.Util.lf("{id:category}Tutorials")},t.convertColor=function(e){var t;e=(t=e)?"0x"==t.substring(0,2)?"#"+t.substring(2):t:"#000000";const n=parseInt(e);return isNaN(n)?e:r(n)},t.hueToRgb=r,t.fadeColor=function(e,t,n){(e=e.replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);let r="#";for(let i=0;i<3;i++){let s=parseInt(e.substr(2*i,2),16);s=Math.round(Math.min(Math.max(0,n?s+s*t:s-s*t),255));let o=s.toString(16);r+=("00"+o).substr(o.length)}return r}}(e.toolbox||(e.toolbox={}))}(pxt||(pxt={})),function(e){!function(t){const n=/^##[^#](.*)$([\s\S]*?)(?=^##[^#]|$(?![\r\n]))/gim,r=/^###[^#](.*)$([\s\S]*?)(?=^###[^#]|$(?![\r\n]))/gim;function i(){return/``` *(sim|block|blocks|filterblocks|spy|ghost|typescript|ts|js|javascript|template|python|jres|assetjson|customts|simtheme)\s*\n([\s\S]*?)\n```/gim}function s(t,r,i){let s=r||n,c=[];if(t.replace(s,(function(e,t,n){n=n.trim();let{header:r,hint:s}=function(e,t){let n,r=e=l(e);if(t){const t=/#+ ~ tutorialhint([\s\S]*)/i;r=e.replace(t,(function(e,t){return n=t,""}))}else{const t=/(^[\s\S]*?\S)\s*((```|\[?\!\[[\s\S]+?\]\(\S+?\)\]?)[\s\S]*)/im;let i=e.match(t);i&&i.length>2&&(r=i[1].trim(),n=i[2].trim())}return{header:r,hint:n}}(n,i&&i.explicitHints);const u=o("local",n),d=a("local",n);let p={title:t.match(/^\{.*\}$/)?void 0:t.replace(/@(fullscreen|unplugged|showdialog|showhint|tutorialCompleted|resetDiff)/gi,"").trim(),contentMd:n,headerContentMd:r,localBlockConfig:u,localValidationConfig:d};return/@(fullscreen|unplugged|showdialog|showhint)/i.test(t)&&(p.showHint=!0),/@(unplugged|showdialog)/i.test(t)&&(p.showDialog=!0),/@tutorialCompleted/.test(t)&&(p.tutorialCompleted=!0),/@resetDiff/.test(t)&&(p.resetDiff=!0),s&&(p.hintContentMd=s),c.push(p),""})),0!=t.indexOf("# Not found"))return c;e.debug("tutorial not found")}function o(e,t){let n={md:"",blocks:[]};const r=new RegExp(`\`\`\`\\s*blockconfig\\.${e}\\s*\\n([\\s\\S]*?)\\n\`\`\``,"gmi");return t.replace(r,((e,t)=>(n.md+=`${t}\n`,""))),n}function a(t,n){let r;const i=new RegExp(`\`\`\`\\s*validation\\.${t}\\s*\\n([\\s\\S]*?)\\n\`\`\``,"gmi");if(n.replace(i,((e,t)=>(r=t,""))),!r||""==r)return null;return{validatorsMetadata:e.getSectionsFromMarkdownMetadata(r).map((e=>({validatorType:e.header,properties:e.attributes})))}}function l(e){if(!e)return e;return e.replace(/```(filterblocks|package|ghost|config|template|jres|assetjson|simtheme|customts|blockconfig\.local|blockconfig\.global|validation\.local|validation\.global)\s*\n([\s\S]*?)\n```/gim,"").trim()}function c(t){if(!t)return;const n=JSON.parse(t);return{[e.TILEMAP_JRES]:n[e.TILEMAP_JRES],[e.TILEMAP_CODE]:n[e.TILEMAP_CODE],[e.IMAGES_JRES]:n[e.IMAGES_JRES],[e.IMAGES_CODE]:n[e.IMAGES_CODE]}}function u(t){const n=e.Util.jsonTryParse(t);if(!n)return;const r={};return n.theme&&(r.theme=n.theme),n.palette&&(r.palette=n.palette),r}t.parseTutorial=function(t){const{metadata:i,body:d}=function(t){const n=/### @(\S+) ([ \S]+)/gi,r={},i=t.replace(n,(function(e,t,n){try{r[t]=JSON.parse(n)}catch(e){r[t]=n}return""})),s=r;void 0!==s.explicitHints&&e.appTarget.appTheme&&e.appTarget.appTheme.tutorialExplicitHints&&(s.explicitHints=!0);return{metadata:s,body:i}}(t),{steps:p,activities:h}=function(e,t){if(t&&t.activities)return function(e,t){let i=[],o=[];return e.replace(n,(function(e,n,a){let l=o.length;o.push({name:n||lf("Activity {0}",l),step:i.length});let c=s(a,r,t);return c=c.map((e=>(e.activity=l,e))),i=i.concat(c),""})),{steps:i,activities:o}}(e,t);{let n=s(e,null,t);return(!n||n.length<1)&&(n=s(e,r,t)),{steps:n,activities:null}}}(d,i),f=function(e){let t=e.match(/^#[^#](.*)$/im);return t&&t.length>1?t[1].trim():null}(d);if(!p)return;const{code:m,templateCode:_,editor:g,language:y,jres:b,assetJson:v,customTs:T,simThemeJson:k}=function(t){let n;const r=/``` *(sim|block|blocks|filterblocks|spy|ghost|typescript|ts|js|javascript|template|python|jres|assetjson|customts|simtheme)\s*\n([\s\S]*?)\n```/gim;let i,s,o,a,l,c,u=[];return t.replace(/((?!.)\s)+/g,"\n").replace(r,(function(t,n,r){switch(n){case"block":case"blocks":case"blockconfig.local":case"blockconfig.global":case"filterblocks":if(!d(e.BLOCKS_PROJECT_NAME))return;break;case"spy":case"python":if(!d(e.PYTHON_PROJECT_NAME))return;"python"==n&&(o=n);break;case"typescript":case"ts":case"javascript":case"js":if(!d(e.JAVASCRIPT_PROJECT_NAME))return;break;case"template":s=r;break;case"jres":i=r;break;case"assetjson":a=r;break;case"simtheme":c=r;break;case"customts":l=r,r=""}return u.push("python"==n?`\n${r}\n`:`{\n${r}\n}`),""})),n=n||e.BLOCKS_PROJECT_NAME,{code:u,templateCode:s,editor:n,language:o,jres:i,assetJson:a,customTs:l,simThemeJson:c};function d(t){return n&&n!=t?(e.debug("tutorial ambiguous: contains snippets of different types"),!1):(n=t,!0)}}(d);(!0===i.diffs||!1!==i.diffs&&!0!==i.noDiffs&&(g==e.BLOCKS_PROJECT_NAME&&e.appTarget.appTheme.tutorialBlocksDiff||g!=e.BLOCKS_PROJECT_NAME&&e.appTarget.appTheme.tutorialTextDiff))&&function(e,t){let n;function r(e){const t={typescript:"diff",spy:"diffspy",blocks:"diffblocks",python:"diff"},r=/\s*(\/\/|#)\s*@highlight/gm;return e?e.replace(/```(typescript|spy|python|blocks|ghost|template)((?:.|[\r\n])+)```/,(function(e,i,s){const o=n,a=/^(template|ghost)$/.test(i),l=r.test(s);return s=s.replace(/^\n+/,"").replace(/\n+$/,""),l&&(s=s.replace(r,"")),n=s,!o||l||a?e:`\`\`\`${t[i]}\n${o}\n----------\n${s}\n\`\`\``})):e}e.forEach(((e,i)=>{if((e.resetDiff||t&&t.find((e=>e.step==i)))&&(n=void 0),e.hintContentMd){const t=r(e.hintContentMd);if(t&&t!=e.hintContentMd)return void(e.hintContentMd=t)}if(e.headerContentMd){const t=r(e.headerContentMd);if(t&&t!=e.headerContentMd)return void(e.headerContentMd=t)}}))}(p,h);const E=c(v),x=u(k),S=o("global",t),C=a("global",t);return p.forEach((e=>{e.contentMd=l(e.contentMd),e.headerContentMd=l(e.headerContentMd),e.hintContentMd=l(e.hintContentMd)})),{editor:g,title:f,steps:p,activities:h,code:m,templateCode:_,metadata:i,language:y,jres:b,assetFiles:E,customTs:T,globalBlockConfig:S,globalValidationConfig:C,simTheme:x}},t.getMetadataRegex=i,t.highlight=function(e){let t=e.textContent;if(t=t.replace(/img\s*\(\s*"{3}[\s\da-f.#tngrpoyw]*"{3}\s*\)/g,'img(""" """)'),t=t.replace(/img\s*`[\s\da-f.#tngrpoyw]*`\s*/g,"img` `"),!/@highlight/.test(t))return void(e.textContent=t);e.textContent="";const n=t.split("\n");for(let t=0;t<n.length;++t){t>0&&t<n.length&&e.appendChild(document.createTextNode("\n"));let r=n[t];if(/@highlight/.test(r)){if(r=n[++t],void 0!==r){const t=document.createElement("span");t.className="highlight-line",t.textContent=r,e.appendChild(t)}}else e.appendChild(document.createTextNode(r))}},t.getTutorialOptions=function(t,n,r,i,s){var o;const a=e.tutorial.parseTutorial(t);if(!a)throw new Error(lf("Invalid tutorial format"));return{options:{tutorial:n,tutorialName:a.title||r,tutorialReportId:i,tutorialStep:0,tutorialReady:!0,tutorialHintCounter:0,tutorialStepInfo:a.steps,tutorialActivityInfo:a.activities,tutorialMd:t,tutorialCode:a.code,tutorialRecipe:!!s,templateCode:a.templateCode,autoexpandStep:!(null===(o=a.metadata)||void 0===o?void 0:o.autoexpandOff),metadata:a.metadata,language:a.language,jres:a.jres,assetFiles:a.assetFiles,customTs:a.customTs,globalBlockConfig:a.globalBlockConfig,globalValidationConfig:a.globalValidationConfig,simTheme:a.simTheme},editor:a.editor}},t.parseCachedTutorialInfo=function(t,n){let r=e.Util.jsonTryParse(t);return r?e.BrowserUtils.tutorialInfoDbAsync().then((e=>{if(n&&r[n]){const t=r[n];t.usedBlocks&&t.hash&&e.setWithHashAsync(n,t.snippetBlocks,t.hash,t.highlightBlocks,t.validateBlocks)}else for(let t of Object.keys(r)){const n=r[t];n.usedBlocks&&n.hash&&e.setWithHashAsync(t,n.snippetBlocks,n.hash,n.highlightBlocks,n.validateBlocks)}})).catch((e=>{})):Promise.resolve()},t.resolveLocalizedMarkdown=function(t,n,r){const i=(r||t.fileName||"README")+".md";let s;const[o,a,l]=e.Util.normalizeLanguageCode(e.Util.userLanguage());return s=o&&a&&l?n[`_locales/${o}/${i}`]||n[`_locales/${l}/${i}`]||n[`_locales/${a}/${i}`]:n[`_locales/${o}/${i}`],s=s||n[i],s},t.parseAssetJson=c,t.parseSimThemeJson=u,t.getTutorialHighlightedBlocks=async function(t){const n=await e.BrowserUtils.tutorialInfoDbAsync(),r=await n.getAsync(t.tutorial,t.tutorialCode);return null==r?void 0:r.highlightBlocks},t.getTutorialValidateBlocks=async function(t){const n=await e.BrowserUtils.tutorialInfoDbAsync(),r=await n.getAsync(t.tutorial,t.tutorialCode);return null==r?void 0:r.validateBlocks},t.getRequiredBlockCounts=function(e){if(!e)return;const t={},n=e["validate-exists"];return n&&n.forEach((e=>{t[e]=(t[e]||0)+1})),t},t.getTutorialStepHash=function(t){const{tutorialStepInfo:n,tutorialStep:r}=t,i=function(e){let t=[];return null==e||e.replace(/((?!.)\s)+/g,"\n").replace(/``` *(block|blocks)\s*\n([\s\S]*?)\n```/gim,(function(e,n,r){return t.push(`{\n${r}\n}`),""})),t}(n[r].hintContentMd);return e.BrowserUtils.getTutorialCodeHash(i)}}(e.tutorial||(e.tutorial={}))}(pxt||(pxt={})),function(e){!function(t){let n;t.flattenDiagnosticMessageText=function(e,t){if("string"==typeof e)return e;{let n=e,r="",i=0;for(;n;){if(i){r+=t;for(let e=0;e<i;e++)r+="  "}r+=n.messageText,i++,n=n.next}return r}},function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES6=2]="ES6",e[e.ES2015=2]="ES2015",e[e.Latest=2]="Latest"}(n=t.ScriptTarget||(t.ScriptTarget={})),t.isIdentifierStart=function(e,t){return e>=65&&e<=90||e>=97&&e<=122||36===e||95===e||e>127&&a(e,t)},t.isIdentifierPart=function(e,t){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||36===e||95===e||e>127&&function(e,t){return t>=n.ES5?l(e,i):l(e,o)}(e,t)},t.reservedWords=["abstract","any","as","break","case","catch","class","continue","const","constructor","debugger","declare","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","implements","import","in","instanceof","interface","is","let","module","namespace","new","null","package","private","protected","public","require","global","return","set","static","super","switch","symbol","this","throw","true","try","type","typeof","var","void","while","with","yield","async","await","of","Math"],t.keywordTypes=["boolean","number","string"],t.escapeIdentifier=function(n){if(!n)return"_";let r=n.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_$]/g,(t=>e.pxtc.isIdentifierPart(t.charCodeAt(0),e.pxtc.ScriptTarget.ES5)?t:""));return r&&e.pxtc.isIdentifierStart(r.charCodeAt(0),e.pxtc.ScriptTarget.ES5)&&-1===t.reservedWords.indexOf(r)||(r="_"+r),r};const r=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],i=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],s=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1569,1594,1600,1610,1649,1747,1749,1749,1765,1766,1786,1788,1808,1808,1810,1836,1920,1957,2309,2361,2365,2365,2384,2384,2392,2401,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2784,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2877,2877,2908,2909,2911,2913,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3294,3294,3296,3297,3333,3340,3342,3344,3346,3368,3370,3385,3424,3425,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3946,3976,3979,4096,4129,4131,4135,4137,4138,4176,4181,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6067,6176,6263,6272,6312,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8319,8319,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12329,12337,12341,12344,12346,12353,12436,12445,12446,12449,12538,12540,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65138,65140,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],o=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,768,846,864,866,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1155,1158,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1425,1441,1443,1465,1467,1469,1471,1471,1473,1474,1476,1476,1488,1514,1520,1522,1569,1594,1600,1621,1632,1641,1648,1747,1749,1756,1759,1768,1770,1773,1776,1788,1808,1836,1840,1866,1920,1968,2305,2307,2309,2361,2364,2381,2384,2388,2392,2403,2406,2415,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2492,2494,2500,2503,2504,2507,2509,2519,2519,2524,2525,2527,2531,2534,2545,2562,2562,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2649,2652,2654,2654,2662,2676,2689,2691,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2784,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2876,2883,2887,2888,2891,2893,2902,2903,2908,2909,2911,2913,2918,2927,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3006,3010,3014,3016,3018,3021,3031,3031,3047,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3134,3140,3142,3144,3146,3149,3157,3158,3168,3169,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3262,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3297,3302,3311,3330,3331,3333,3340,3342,3344,3346,3368,3370,3385,3390,3395,3398,3400,3402,3405,3415,3415,3424,3425,3430,3439,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3805,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3946,3953,3972,3974,3979,3984,3991,3993,4028,4038,4038,4096,4129,4131,4135,4137,4138,4140,4146,4150,4153,4160,4169,4176,4185,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,4969,4977,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6099,6112,6121,6160,6169,6176,6263,6272,6313,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8255,8256,8319,8319,8400,8412,8417,8417,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12335,12337,12341,12344,12346,12353,12436,12441,12442,12445,12446,12449,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65056,65059,65075,65076,65101,65103,65136,65138,65140,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65381,65470,65474,65479,65482,65487,65490,65495,65498,65500];function a(e,t){return t>=n.ES5?l(e,r):l(e,s)}function l(e,t){if(e<t[0])return!1;let n,r=0,i=t.length;for(;r+1<i;){if(n=r+(i-r)/2,n-=n%2,t[n]<=e&&e<=t[n+1])return!0;e<t[n]?i=n:r=n+2}return!1}let c;t.isUnicodeIdentifierStart=a,function(e){e[e.Warning=0]="Warning",e[e.Error=1]="Error",e[e.Message=2]="Message"}(c=t.DiagnosticCategory||(t.DiagnosticCategory={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){function n(){return!!navigator&&!!navigator.bluetooth&&"TextDecoder"in window&&e.appTarget.appTheme.bluetoothUartConsole&&e.appTarget.appTheme.bluetoothUartFilters&&e.appTarget.appTheme.bluetoothUartFilters.length>0}function r(){return!!navigator&&!!navigator.bluetooth&&!!e.appTarget.appTheme.bluetoothPartialFlashing}t.isAvailable=function(){return n()||r()},t.hasConsole=n,t.hasPartialFlash=r,t.isValidUUID=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/.test(e)};class i{constructor(e,t){this.connectionTimeout=2e4,this.connectPromise=void 0,this.id=e,this.aliveToken=t}debug(t){e.debug(`${this.id}: ${t}`)}alivePromise(e){return new Promise(((t,n)=>{this.aliveToken.isCancelled()&&n(new Error),e.then((e=>t(e)),(e=>n(e)))}))}cancelConnect(){this.connectPromise=void 0}createConnectPromise(){return Promise.resolve()}connectAsync(){return this.connectPromise||(this.connectPromise=this.alivePromise(this.createConnectPromise())),e.Util.promiseTimeout(this.connectionTimeout,this.connectPromise,"connection timeout").then((()=>this.aliveToken.throwIfCancelled())).catch((e=>{throw this.connectPromise=void 0,e}))}disconnect(){this.cancelConnect()}kill(){this.disconnect(),this.aliveToken.cancel()}}t.BLERemote=i;class s extends i{constructor(e,t,n){super(e,t.aliveToken),this.device=t,this.autoReconnect=n,this.autoReconnectDelay=1e3,this.disconnectOnAutoReconnect=!1,this.reconnectPromise=void 0,this.failedConnectionServicesVersion=-1,this.handleDisconnected=this.handleDisconnected.bind(this),this.device.device.addEventListener("gattserverdisconnected",this.handleDisconnected)}handleDisconnected(t){this.aliveToken.isCancelled()||(this.disconnect(),this.autoReconnect&&!this.reconnectPromise&&(this.reconnectPromise=e.U.delay(this.autoReconnectDelay).then((()=>this.exponentialBackoffConnectAsync(8,500))).finally((()=>this.reconnectPromise=void 0))))}exponentialBackoffConnectAsync(t,n){return this.debug("retry connect"),this.aliveToken.throwIfCancelled(),this.connectAsync().then((()=>{this.aliveToken.throwIfCancelled(),this.debug("reconnect success"),this.reconnectPromise=void 0})).catch((r=>(this.debug(`reconnect error ${r.message}`),this.aliveToken.throwIfCancelled(),this.device.isPaired?this.autoReconnect?0==t?(this.debug("give up, max tries"),void(this.reconnectPromise=void 0)):this.failedConnectionServicesVersion==this.device.servicesVersion?(this.debug("services haven't changed, giving up"),void(this.reconnectPromise=void 0)):(this.debug(`retry connect ${n}ms... (${t} tries left)`),this.device.connected&&(this.failedConnectionServicesVersion=this.device.servicesVersion),this.disconnectOnAutoReconnect&&this.device.disconnect(),e.U.delay(n).then((()=>this.exponentialBackoffConnectAsync(--t,1.8*n)))):(this.debug("autoreconnect disabled"),void(this.reconnectPromise=void 0)):(this.debug("give up, device unpaired"),void(this.reconnectPromise=void 0)))))}}t.BLEService=s;class o extends s{constructor(e,t,n,r){super(e,t,!0),this.device=t,this.serviceUUID=n,this.txCharacteristicUUID=r,this.handleValueChanged=this.handleValueChanged.bind(this)}createConnectPromise(){return this.debug("connecting"),this.device.connectAsync().then((()=>this.alivePromise(this.device.gatt.getPrimaryService(this.serviceUUID)))).then((e=>(this.debug("service connected"),this.service=e,this.alivePromise(this.service.getCharacteristic(this.txCharacteristicUUID))))).then((e=>(this.debug("tx characteristic connected"),this.txCharacteristic=e,this.txCharacteristic.addEventListener("characteristicvaluechanged",this.handleValueChanged),this.txCharacteristic.startNotifications()))).then((()=>{e.tickEvent("webble.connected",{id:this.id})}))}handlePacket(e){}handleValueChanged(e){const t=e.target.value;this.handlePacket(t)}disconnect(){if(super.disconnect(),this.txCharacteristic&&this.device&&this.device.connected)try{this.txCharacteristic.stopNotifications(),this.txCharacteristic.removeEventListener("characteristicvaluechanged",this.handleValueChanged)}catch(t){e.log(`${this.id}: error ${t.message}`)}this.service=void 0,this.txCharacteristic=void 0}}t.BLETXService=o;class a extends o{constructor(e){super("hf2",e,a.SERVICE_UUID,a.CHARACTERISTIC_TX_UUID),this.device=e}handlePacket(e){const t=e.getUint8(0);switch(192&t){case a.BLEHF2_FLAG_SERIAL_OUT:case a.BLEHF2_FLAG_SERIAL_ERR:const n=Math.min(e.byteLength-1,-193&t);let r="";for(let t=0;t<n;++t)r+=String.fromCharCode(e.getUint8(t+1));r&&window.postMessage({type:"serial",id:this.device.name||"hf2",data:r},"*")}}}a.SERVICE_UUID="b112f5e6-2679-30da-a26e-0273b6043849",a.CHARACTERISTIC_TX_UUID="b112f5e6-2679-30da-a26e-0273b604384a",a.BLEHF2_FLAG_SERIAL_OUT=128,a.BLEHF2_FLAG_SERIAL_ERR=192,t.HF2Service=a;class l extends o{constructor(e){super("uart",e,l.SERVICE_UUID,l.CHARACTERISTIC_TX_UUID),this.device=e}handlePacket(e){const t=(new window.TextDecoder).decode(e);t&&window.postMessage({type:"serial",id:this.device.name||"uart",data:t},"*")}}let c;l.SERVICE_UUID="6e400001-b5a3-f393-e0a9-e50e24dcca9e",l.CHARACTERISTIC_TX_UUID="6e400002-b5a3-f393-e0a9-e50e24dcca9e",t.UARTService=l,function(e){e[e.Idle=1]="Idle",e[e.StatusRequested=2]="StatusRequested",e[e.PairingModeRequested=4]="PairingModeRequested",e[e.RegionDALRequested=8]="RegionDALRequested",e[e.RegionMakeCodeRequested=16]="RegionMakeCodeRequested",e[e.Flash=32]="Flash",e[e.EndOfTransmision=64]="EndOfTransmision",e[e.USBFlashRequired=128]="USBFlashRequired"}(c||(c={}));class u extends s{constructor(e){super("partial flashing",e,!1),this.device=e,this.state=c.Idle,this.disconnectOnAutoReconnect=!0,this.handleCharacteristic=this.handleCharacteristic.bind(this)}clearFlashData(){this.version=0,this.mode=0,this.regions=[],this.chunkDelay=u.CHUNK_MIN_DELAY,this.hex=void 0,this.bin=void 0,this.magicOffset=void 0,this.dalHash=void 0,this.makeCodeHash=void 0,this.flashReject=void 0,this.flashResolve=void 0,this.flashOffset=void 0}createConnectPromise(){return this.debug("connecting to partial flash service"),this.device.connectAsync().then((()=>this.alivePromise(this.device.gatt.getPrimaryService(u.SERVICE_UUID)))).then((e=>(this.debug("connecting to characteristic"),this.alivePromise(e.getCharacteristic(u.CHARACTERISTIC_UUID))))).then((e=>(this.debug("starting notifications"),this.pfCharacteristic=e,this.pfCharacteristic.startNotifications(),this.pfCharacteristic.addEventListener("characteristicvaluechanged",this.handleCharacteristic),this.state==c.PairingModeRequested?(this.debug("checking pairing mode"),this.autoReconnect=!1,this.pfCharacteristic.writeValue(new Uint8Array([u.STATUS]))):Promise.resolve())))}disconnect(){if(super.disconnect(),this.flashPacketToken&&this.flashPacketToken.cancel(),this.pfCharacteristic&&this.device.connected)try{this.pfCharacteristic.stopNotifications(),this.pfCharacteristic.removeEventListener("characteristicvaluechanged",this.handleCharacteristic)}catch(t){e.log(`ble: partial flash disconnect error ${t.message}`)}this.pfCharacteristic=void 0}findMarker(e,t){if(!this.bin)return-1;for(;e+t.length<this.bin.length;e+=16){let n=!0;for(let r=0;r<t.length;++r)if(t[r]!=this.bin[e+r]){n=!1;break}if(n)return e}return-1}flashAsync(e){return this.hex?(this.debug("flashing already in progress"),Promise.resolve()):(this.device.pauseLog(),this.createFlashPromise(e).finally((()=>this.device.resumeLogOnDisconnection())))}createFlashPromise(t){if(this.hex)return this.debug("flashing already in progress"),Promise.resolve();this.clearFlashData(),this.hex=t;const n=ts.pxtc.UF2.newBlockFile();ts.pxtc.UF2.writeHex(n,this.hex.split(/\r?\n/));const r=e.appTarget.compile.flashUsableEnd;this.bin=ts.pxtc.UF2.toBin(e.U.stringToUint8Array(ts.pxtc.UF2.serializeFile(n)),r).buf,this.debug(`bin bytes ${this.bin.length}`),this.magicOffset=this.findMarker(0,u.MAGIC_MARKER),this.debug(`magic block ${this.magicOffset.toString(16)}`),this.magicOffset<0&&(this.debug("magic block not found, not a valid HEX file"),e.U.userError(lf("Invalid file"))),this.debug("bytes to flash "+(this.bin.length-this.magicOffset));const i=this.magicOffset+u.MAGIC_MARKER.length;return this.dalHash=e.Util.toHex(this.bin.slice(i,i+8)),this.makeCodeHash=e.Util.toHex(this.bin.slice(i+8,i+16)),this.debug(`DAL hash ${this.dalHash}`),this.debug(`MakeCode hash ${this.makeCodeHash}`),this.connectAsync().then((()=>new Promise(((e,t)=>(this.flashResolve=e,this.flashReject=t,this.debug("check service version"),this.state=c.StatusRequested,this.pfCharacteristic.writeValue(new Uint8Array([u.STATUS]))))))).then((()=>{}),(t=>{e.log(`pf: error ${t.message}`),this.clearFlashData()}))}checkStateTransition(e,t){return!!(this.state&t)||(this.debug(`flash cmd ${e} in state ${this.state.toString(16)} `),this.flashReject(new Error),this.clearFlashData(),!1)}handleCharacteristic(t){this.aliveToken.isCancelled()&&(this.flashReject(new Error),this.clearFlashData());const n=event.target.value,r=new Uint8Array(n.buffer),i=r[0];if(this.state!=c.Idle)switch(i){case u.STATUS:if(!this.checkStateTransition(i,c.StatusRequested|c.PairingModeRequested))return;this.version=r[1],this.mode=r[2],this.debug(`flash service version ${this.version} mode ${this.mode}`),this.debug("reading DAL region"),this.state=c.RegionDALRequested,this.pfCharacteristic.writeValue(new Uint8Array([u.REGION_INFO,u.REGION_DAL])).then((()=>{}));break;case u.REGION_INFO:if(!this.checkStateTransition(i,c.RegionDALRequested|c.RegionMakeCodeRequested))return;const t=this.regions[r[1]]={start:r[2]<<24|r[3]<<16|r[4]<<8|r[5],end:r[6]<<24|r[7]<<16|r[8]<<8|r[9],hash:e.Util.toHex(r.slice(10))};if(this.debug(`read region ${r[1]} start ${t.start.toString(16)} end ${t.end.toString(16)} hash ${t.hash}`),r[1]==u.REGION_DAL){if(t.hash!=this.dalHash)return e.tickEvent("webble.flash.DALrequired"),this.debug("DAL hash does not match, partial flashing not possible"),this.state=c.USBFlashRequired,this.flashReject(new Error("USB flashing required")),void this.clearFlashData();this.debug("DAL hash match, reading makecode region"),this.state=c.RegionMakeCodeRequested,this.pfCharacteristic.writeValue(new Uint8Array([u.REGION_INFO,u.REGION_MAKECODE])).then((()=>{}))}else if(r[1]==u.REGION_MAKECODE)if(t.start!=this.magicOffset&&(this.debug("magic offset and MakeCode region.start not matching"),e.U.userError(lf("Invalid file"))),t.hash==this.makeCodeHash)e.tickEvent("webble.flash.noop"),this.debug("MakeCode hash matches, same code!"),this.debug("restart application mode"),this.pfCharacteristic.writeValue(new Uint8Array([u.RESET,u.MODE_APPLICATION])).then((()=>{this.state=c.Idle,this.flashResolve(),this.clearFlashData()}));else{if(this.mode!=u.MODE_PAIRING)return this.debug("application mode, reset into pairing mode"),this.state=c.PairingModeRequested,this.autoReconnect=!0,void this.pfCharacteristic.writeValue(new Uint8Array([u.RESET,u.MODE_PAIRING])).then((()=>{}));this.flashOffset=t.start,this.flashPacketNumber=0,this.debug(`starting to flash from address ${this.flashOffset.toString(16)}`),this.flashNextPacket()}break;case u.FLASH_DATA:if(!this.checkStateTransition(i,c.Flash))return;switch(r[1]){case u.PACKET_OUT_OF_ORDER:this.debug("packet out of order"),this.flashPacketToken.cancel(),this.flashPacketNumber+=4,this.chunkDelay=Math.min(this.chunkDelay+10,u.CHUNK_MAX_DELAY),this.flashNextPacket();break;case u.PACKET_WRITTEN:this.chunkDelay=Math.max(this.chunkDelay-1,u.CHUNK_MIN_DELAY),this.flashOffset+=64,this.flashPacketNumber+=4,this.flashOffset>=this.bin.length?(this.debug("end transmission"),this.state=c.EndOfTransmision,this.pfCharacteristic.writeValue(new Uint8Array([u.END_OF_TRANSMISSION])).finally((()=>{this.flashResolve&&this.flashResolve(),this.clearFlashData()}))):this.flashNextPacket()}break;default:this.debug(`unknown message ${e.Util.toHex(r)}`),this.disconnect()}}flashNextPacket(){this.state=c.Flash,this.flashPacketToken=new e.Util.CancellationToken,this.flashPacketToken.startOperation();const t=this.bin.slice(this.flashOffset,this.flashOffset+64);this.debug(`flashing ${this.flashOffset.toString(16)} / ${this.bin.length.toString(16)} ${(this.flashOffset-this.magicOffset)/(this.bin.length-this.magicOffset)*100>>0}%`);let n=new Uint8Array(20);e.U.delay(this.chunkDelay).then((()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=this.flashOffset>>8&255,n[2]=this.flashOffset>>0&255,n[3]=this.flashPacketNumber;for(let e=0;e<16;e++)n[4+e]=t[e];return this.pfCharacteristic.writeValue(n)})).then((()=>e.U.delay(this.chunkDelay))).then((()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=this.flashOffset>>24&255,n[2]=this.flashOffset>>16&255,n[3]=this.flashPacketNumber+1;for(let e=0;e<16;e++)n[4+e]=t[16+e]||0;return this.pfCharacteristic.writeValue(n)})).then((()=>e.U.delay(this.chunkDelay))).then((()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=0,n[2]=0,n[3]=this.flashPacketNumber+2;for(let e=0;e<16;e++)n[4+e]=t[32+e]||0;return this.pfCharacteristic.writeValue(n)})).then((()=>e.U.delay(this.chunkDelay))).then((()=>{this.flashPacketToken.throwIfCancelled(),n[0]=u.FLASH_DATA,n[1]=0,n[2]=0,n[3]=this.flashPacketNumber+3;for(let e=0;e<16;e++)n[4+e]=t[48+e]||0;return this.pfCharacteristic.writeValue(n)})).then((()=>{const t=this.flashOffset,r=()=>e.U.delay(500).then((()=>{if(t!=this.flashOffset||this.flashPacketToken.isCancelled()||this.aliveToken.isCancelled()||this.state!=c.Flash)return Promise.resolve();this.debug("packet transfer deadlock, force restart"),n[0]=u.FLASH_DATA,n[1]=0,n[2]=0,n[3]=-1;for(let e=0;e<16;e++)n[4+e]=0;return this.pfCharacteristic.writeValue(n).then((()=>r()))}));r().catch((e=>{this.flashReject&&(this.flashReject(new Error("failed packet transfer")),this.clearFlashData())}))})).catch((()=>{this.flashPacketToken.resolveCancel()}))}}u.SERVICE_UUID="e97dd91d-251d-470a-a062-fa1922dfa9a8",u.CHARACTERISTIC_UUID="e97d3b10-251d-470a-a062-fa1922dfa9a8",u.REGION_INFO=0,u.FLASH_DATA=1,u.PACKET_OUT_OF_ORDER=170,u.PACKET_WRITTEN=255,u.END_OF_TRANSMISSION=2,u.STATUS=238,u.RESET=255,u.MODE_PAIRING=0,u.MODE_APPLICATION=1,u.REGION_SOFTDEVICE=0,u.REGION_DAL=1,u.REGION_MAKECODE=2,u.MAGIC_MARKER=e.Util.fromHex("708E3B92C615A841C49866C975EE5197"),u.CHUNK_MIN_DELAY=0,u.CHUNK_MAX_DELAY=75,t.PartialFlashingService=u;class d extends i{constructor(t){super("ble",new e.Util.CancellationToken),this.device=void 0,this.services=[],this.pendingResumeLogOnDisconnection=!1,this.servicesVersion=0,this.device=t,this.handleDisconnected=this.handleDisconnected.bind(this),this.handleServiceAdded=this.handleServiceAdded.bind(this),this.handleServiceChanged=this.handleServiceChanged.bind(this),this.handleServiceRemoved=this.handleServiceRemoved.bind(this),this.device.addEventListener("gattserverdisconnected",this.handleDisconnected),this.device.addEventListener("serviceadded",this.handleServiceAdded),this.device.addEventListener("servicechanged",this.handleServiceChanged),this.device.addEventListener("serviceremoved",this.handleServiceRemoved),n()&&(this.services.push(this.uartService=new l(this)),this.services.push(this.hf2Service=new a(this))),r()&&this.services.push(this.partialFlashingService=new u(this)),this.aliveToken.startOperation()}startServices(){this.services.filter((e=>e.autoReconnect)).forEach((e=>e.connectAsync().catch((()=>{}))))}pauseLog(){this.uartService&&(this.uartService.autoReconnect=!1,this.uartService.disconnect()),this.hf2Service&&(this.hf2Service.autoReconnect=!1,this.hf2Service.disconnect())}resumeLogOnDisconnection(){this.pendingResumeLogOnDisconnection=!0}resumeLog(){this.uartService&&(this.uartService.autoReconnect=!0,this.uartService.connectAsync().catch((()=>{}))),this.hf2Service&&(this.hf2Service.autoReconnect=!0,this.hf2Service.connectAsync().catch((()=>{})))}get isPaired(){return this===t.bleDevice}get name(){return this.device.name||"?"}get connected(){return this.device&&this.device.gatt&&this.device.gatt.connected}get gatt(){return this.device.gatt}createConnectPromise(){return this.debug("connecting gatt server"),this.alivePromise(this.device.gatt.connect().then((()=>this.debug("gatt server connected"))))}handleServiceAdded(e){this.debug("service added"),this.servicesVersion++}handleServiceRemoved(e){this.debug("service removed"),this.servicesVersion++}handleServiceChanged(e){this.debug("service changed"),this.servicesVersion++}handleDisconnected(t){this.debug("disconnected"),this.disconnect(),this.pendingResumeLogOnDisconnection&&(this.pendingResumeLogOnDisconnection=!1,e.U.delay(500).then((()=>this.resumeLog())))}disconnect(){if(super.disconnect(),this.services.forEach((e=>e.disconnect())),this.connected){this.debug("disconnect");try{this.device.gatt&&this.device.gatt.connected&&this.device.gatt.disconnect()}catch(e){this.debug(`gatt disconnect error ${e.message}`)}}}}function p(){if(t.bleDevice)return Promise.resolve();e.log("ble: requesting device");const i=[];return n()&&(i.push(l.SERVICE_UUID),i.push(a.SERVICE_UUID)),r()&&i.push(u.SERVICE_UUID),navigator.bluetooth.requestDevice({filters:e.appTarget.appTheme.bluetoothUartFilters,optionalServices:i}).then((n=>(e.log(`ble: received device ${n.name}`),t.bleDevice=new d(n),t.bleDevice.startServices(),t.bleDevice.connectAsync())))}t.BLEDevice=d,t.bleDevice=void 0,t.isPaired=function(){return!!t.bleDevice},t.pairAsync=function(){return t.bleDevice&&(t.bleDevice.kill(),t.bleDevice=void 0),p().catch((n=>{t.bleDevice&&t.bleDevice.aliveToken&&t.bleDevice.aliveToken.resolveCancel(),e.log(`ble: error ${n.message}`)}))},t.flashAsync=function(n,r){e.tickEvent("webble.flash");const i=n.outfiles[ts.pxtc.BINARY_HEX];return p().then((()=>t.bleDevice.partialFlashingService.flashAsync(i))).then((()=>e.tickEvent("webble.flash.success"))).catch((t=>{throw e.tickEvent("webble.fail.fail",{message:t.message}),t}))}}(e.webBluetooth||(e.webBluetooth={}))}(pxt||(pxt={})),function(e){!function(t){class n extends Error{constructor(e){super(e),this.message=e}}t.USBError=n;t.filters=[{classCode:255,subclassCode:42}];let r,i,s=!0;t.setFilters=function(e){s=!1,t.filters=e};class o{constructor(){this.ready=!1,this.connecting=!1,this.readLoopStarted=!1,this.onDeviceConnectionChanged=e=>{},this.onConnectionChanged=()=>{},this.onData=e=>{},this.onError=e=>{},this.onEvent=e=>{},this.enabled=!1,this.handleUSBConnected=this.handleUSBConnected.bind(this),this.handleUSBDisconnected=this.handleUSBDisconnected.bind(this)}enable(){this.enabled||(this.enabled=!0,this.log("registering webusb events"),navigator.usb.addEventListener("disconnect",this.handleUSBDisconnected,!1),navigator.usb.addEventListener("connect",this.handleUSBConnected,!1))}disable(){this.enabled&&(this.enabled=!1,this.log("unregistering webusb events"),navigator.usb.removeEventListener("disconnect",this.handleUSBDisconnected),navigator.usb.removeEventListener("connect",this.handleUSBConnected))}disposeAsync(){return this.disable(),Promise.resolve()}handleUSBDisconnected(e){this.log("device disconnected"),e.device==this.dev&&(this.log("clear device"),this.clearDev(),this.onDeviceConnectionChanged&&this.onDeviceConnectionChanged(!1))}handleUSBConnected(e){const t=e.device;this.log(`device connected ${t.serialNumber}`),this.dev||this.connecting||(this.log("attach device"),this.onDeviceConnectionChanged&&this.onDeviceConnectionChanged(!0))}clearDev(){this.dev&&(this.dev=null,this.epIn=null,this.epOut=null,this.onConnectionChanged&&this.onConnectionChanged())}error(t){throw new n(e.U.lf("USB error on device {0} ({1})",this.dev.productName,t))}log(t){e.debug("webusb: "+t)}disconnectAsync(){return this.ready=!1,this.dev?(this.log("close device"),this.dev.close().catch((e=>{})).then((()=>(this.clearDev(),e.U.delay(500))))):Promise.resolve()}async forgetAsync(){var e;if(!(null===(e=this.dev)||void 0===e?void 0:e.forget))return!1;try{return await this.dev.forget(),!0}catch(e){return!1}}reconnectAsync(){return this.log("reconnect"),this.setConnecting(!0),this.disconnectAsync().then(a).then((e=>this.connectAsync(e))).finally((()=>this.setConnecting(!1)))}setConnecting(e){e!=this.connecting&&(this.connecting=e,this.onConnectionChanged&&this.onConnectionChanged())}isConnecting(){return this.connecting}isConnected(){return!!this.dev&&this.ready}async connectAsync(t){if(this.log(`trying to connect (${t.length} devices)`),0==t.length){const e=new Error("Device not found.");throw e.type="devicenotfound",e}this.setConnecting(!0);try{if(this.lastKnownDeviceSerialNumber){const n=t.find((e=>e.serialNumber===this.lastKnownDeviceSerialNumber));n?(this.log("last known device spotted"),t.splice(t.indexOf(n),1),t.unshift(n)):(this.log("delay for last known device"),await e.U.delay(2e3))}for(let e=0;e<t.length;++e){const n=t[e];this.dev=n,this.log(`connect device: ${n.manufacturerName} ${n.productName}`),this.log(`serial number: ${n.serialNumber} ${this.lastKnownDeviceSerialNumber===n.serialNumber?"(last known device)":""} `);try{return void await this.initAsync()}catch(e){this.dev=void 0,this.log(`connection failed, ${e.message}`)}}const n=new Error(e.U.lf("Device in use or not found."));throw n.type="devicelocked",n}finally{this.setConnecting(!1)}}sendPacketAsync(t){return this.dev?(e.Util.assert(t.length<=64),this.epOut?this.dev.transferOut(this.epOut.endpointNumber,t).then((e=>{"ok"!=e.status&&this.error("USB OUT transfer failed")})):this.dev.controlTransferOut({requestType:"class",recipient:"interface",request:9,value:512,index:this.iface.interfaceNumber},t).then((e=>{"ok"!=e.status&&this.error("USB CTRL OUT transfer failed")}))):Promise.reject(new Error("Disconnected"))}readLoop(){if(this.readLoopStarted)return;this.readLoopStarted=!0,this.log("start read loop");let t=()=>{this.ready?this.recvPacketAsync().then((n=>{n[0]?(this.onData(n),t()):e.U.delay(500).then(t)}),(n=>{this.dev&&this.onError(n),e.U.delay(300).then(t)})):e.U.delay(300).then(t)};t()}recvPacketAsync(){let e=e=>{"ok"!=e.status&&this.error("USB IN transfer failed");let t=new Uint8Array(e.data.buffer);return 0==t.length?this.recvPacketAsync():t};return this.dev?this.epIn?this.dev.transferIn(this.epIn.endpointNumber,64).then(e):this.dev.controlTransferIn({requestType:"class",recipient:"interface",request:1,value:256,index:this.iface.interfaceNumber},64).then(e):Promise.reject(new Error("Disconnected"))}initAsync(){if(!this.dev)return Promise.reject(new Error("Disconnected"));let n=this.dev;return this.log("open device"),n.open().then((()=>(this.log("select configuration"),n.selectConfiguration(1)))).then((()=>{this.log("got "+n.configurations[0].interfaces.length+" interfaces");const r=n.configurations[0].interfaces.filter((e=>{let n=e.alternates[0];for(let e of t.filters)if((null==e.classCode||n.interfaceClass===e.classCode)&&!(null!=e.subclassCode&&n.interfaceSubclass!==e.subclassCode||null!=e.protocolCode&&n.interfaceProtocol!==e.protocolCode)){if(0==n.endpoints.length)return!0;if(2==n.endpoints.length&&n.endpoints.every((e=>64==e.packetSize)))return!0}return!1}));let i=r[r.length-1];return this.log(`${r.length} matching interfaces; picking ${i?"#"+i.interfaceNumber:"n/a"}`),i||this.error("cannot find supported USB interface"),this.altIface=i.alternates[0],this.iface=i,this.altIface.endpoints.length?(this.log("using dedicated endpoints"),this.epIn=this.altIface.endpoints.filter((e=>"in"==e.direction))[0],this.epOut=this.altIface.endpoints.filter((e=>"out"==e.direction))[0],e.Util.assert(64==this.epIn.packetSize),e.Util.assert(64==this.epOut.packetSize)):this.log("using ctrl pipe"),this.log("claim interface"),n.claimInterface(i.interfaceNumber)})).then((()=>{this.log("device ready"),this.lastKnownDeviceSerialNumber=this.dev.serialNumber,this.ready=!0,s&&this.readLoop(),this.onConnectionChanged&&this.onConnectionChanged()}))}}async function a(){e.log("webusb: get devices");try{return await navigator.usb.getDevices()||[]}catch(t){return e.reportException(t),[]}}async function l(){var t,n;if(void 0!==i)return;if(e.debug("webusb: checking availability"),!(null===(n=null===(t=e.appTarget)||void 0===t?void 0:t.compile)||void 0===n?void 0:n.webUSB))return void(i=!1);const r=await c();if(r)switch(i=!1,e.tickEvent("webusb.off",{reason:r}),r){case"electron":e.debug("webusb: off, electron");break;case"notimpl":e.debug("webusb: off, not implemented by browser");break;case"oldwindows":e.debug("webusb: off, older windows version");break;case"security":e.debug("webusb: off, security exception")}else i=!0}async function c(){if(e.BrowserUtils.isElectron())return"electron";const t=navigator.usb;if(!t)return"notimpl";let n=/Windows NT (\d+\.\d+)/.exec(navigator.userAgent);if(n&&parseFloat(n[1])<6.3)return"oldwindows";try{await t.getDevices()}catch(e){return"security"}}function u(){return void 0===i&&(console.error("checkAvailableAsync not called"),l()),!!i}t.pairAsync=function(){return navigator.usb.requestDevice({filters:t.filters}).then((e=>!!e)).catch((e=>{if("NotFoundError"!=e.name)throw e}))},t.tryGetDevicesAsync=a,t.mkWebUSBHIDPacketIOAsync=function(){return e.debug("packetio: mk webusb io"),r||(r=new o),r.enable(),Promise.resolve(r)},t.forgetDeviceAsync=async function(){return e.debug("packetio: forget webusb io"),!!r&&r.forgetAsync()},t.isEnabled=!1,t.setEnabled=function(e){u()||(e=!1),t.isEnabled=e},t.checkAvailableAsync=l,t.getReasonUnavailable=c,t.isAvailable=u}(e.usb||(e.usb={}))}(pxt||(pxt={})),function(e){!function(t){var n=e.Util;let r={};function i(e){let t={},r=0,i=new n.PromiseQueue,s=new Promise(((e,n)=>{t.ready=e}));i.enqueue("main",(()=>s));return{opAsync:function(n,s){return i.enqueue("main",(()=>new Promise(((i,o)=>{let a=""+r++;t[a]=e=>{e?e.errorMessage?o(new Error(e.errorMessage)):i(e):o(new Error("no response"))},e({id:a,op:n,arg:s})}))))},recvHandler:e=>{if(t.hasOwnProperty(e.id)){let n=t[e.id];delete t[e.id],n(e.result)}}}}function s(t){let n=new Worker(t),r=i((e=>n.postMessage(e)));return n.onmessage=t=>{e.perf.measureStart("webworker recvHandler"),r.recvHandler(t.data),e.perf.measureEnd("webworker recvHandler")},r}t.getWorker=function(e){let t=r[e];return t||(t=r[e]=s(e)),t},t.wrap=i,t.makeWebWorker=s,t.makeWebSocket=function(t,n=null){let r=new WebSocket(t),s=[],o=i((e=>{let t=JSON.stringify(e);s?s.push(t):r.send(t)}));return r.onmessage=e=>{let t=JSON.parse(e.data);n&&null==t.id?n(t):o.recvHandler(t)},r.onopen=t=>{e.debug("socket opened");for(let e of s)r.send(e);s=null},r.onclose=t=>{e.debug("socket closed")},r.onerror=t=>{e.debug("socket errored")},o}}(e.worker||(e.worker={}))}(pxt||(pxt={})),function(e){!function(t){function n(){t.apiKey||e.U.userError("YouTube API key missing")}function r(e){if(!e)return"";const t=e.medium||e.high||e.standard||e.default;return(null==t?void 0:t.url)||""}t.apiKey=void 0,t.playlistItemToCodeCard=function(e){return{name:e.snippet.title.replace(/[^-]*-/,"").trim(),description:(t=e.snippet.description,t.split(/\n\s+/,1)[0].trim()),youTubeId:e.snippet.resourceId.videoId,youTubePlaylistId:e.snippet.playlistId,imageUrl:r(e.snippet.thumbnails)};var t},t.playlistInfoAsync=function(r){n();const i=`https://www.googleapis.com/youtube/v3/playlists?part=snippet&id=${r}&key=${t.apiKey}`;return e.Util.httpGetJsonAsync(i).then((e=>e.items[0]))},t.listPlaylistVideosAsync=async function(r){n();let i,s=[];do{let n=`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${r}&key=${t.apiKey}`;i&&(n+=`&pageToken=${i}`);const o=await e.Util.httpGetJsonAsync(n);s=s.concat(o.items),i=o.nextPageToken}while(i);return e.options.debug&&e.debug(JSON.stringify(s,null,2)),s},t.watchUrl=function(e,t){let n;return e?(n=`https://www.youtube.com/watch?v=${e}`,t&&(n+=`&list=${t}`)):t&&(n=`https://www.youtube.com/playlist?list=${t}`),n}}(e.youtube||(e.youtube={}))}(pxt||(pxt={})),function(e){!function(e){!function(t){function n(e,...t){return e.replace(/{(\d+)}/g,((e,n)=>t[+n]))}t.debug=!1,t.lf=n;let r=u("opcode name doesn't match","<name>");class i{constructor(t,n,r,i,s){this.opcode=r,this.mask=i,this.is32bit=s,this.canBeShared=!1,e.assert((r&i)==r),this.ei=t,this.code=n.replace(/\s+/g," "),this.friendlyFmt=n.replace(/\$\w+/g,(e=>this.ei.encoders[e]?this.ei.encoders[e].pretty:e));let o=l(n);this.name=o[0],this.args=o.slice(1)}emit(t){let n=t.words;if(n[0]!=this.name)return r;let i=this.opcode,s=1,o=0,a=[],l=null,c=null,d=null;for(let r=0;r<this.args.length;++r){let p=this.args[r],h=n[s++];if("$"==p[0]){let r=this.ei.encoders[p],f=null;if(r.isRegister){if(f=this.ei.registerNo(h),null==f)return u("expecting register name",h);this.ei.isPush(this.opcode)?o++:this.ei.isPop(this.opcode)&&o--}else if(r.isImmediate){if(h=h.replace(/^#/,""),f=t.bin.parseOneInt(h),null==f)return u("expecting number",h);this.ei.isAddSP(this.opcode)?o=-f/this.ei.wordSize():this.ei.isSubSP(this.opcode)&&(o=f/this.ei.wordSize())}else if(r.isRegList){if("{"!=h)return u("expecting {",h);for(f=0;"}"!=n[s];){if(h=n[s++],!h)return u("expecting }",n[s-2]);let e=this.ei.registerNo(h);if(null==e)return u("expecting register name",h);if(f&1<<e)return u("duplicate register name",h);f|=1<<e,this.ei.isPush(this.opcode)?o++:this.ei.isPop(this.opcode)&&o--,","==n[s]&&s++}h=n[s++]}else if(r.isLabel){if(h=h.replace(/^#/,""),/^[+-]?\d+$/.test(h))f=parseInt(h,10),l="rel"+f;else if(/^0x[0-9a-fA-F]+$/.test(h))f=parseInt(h,16),l="abs"+f;else if(l=h,f=this.ei.getAddressFromLabel(t.bin,this,h,r.isWordAligned),null==f){if(t.bin.finalEmit)return u("unknown label",h);f=8}if(this.ei.is32bit(this)){c=f,d=h;continue}}else e.oops();if(null==f)return u("didn't understand it",h);if(a.push(f),f=r.encode(f),null==f)return u("argument out of range or mis-aligned",h);e.assert(0==(i&f)),i|=f}else if(p!=h)return u("expecting "+p,h)}return n[s]?u("trailing tokens",n[s]):this.ei.is32bit(this)?this.ei.emit32(i,c,t.bin.normalizeExternalLabel(d)):{stack:o,opcode:i,numArgs:a,labelName:t.bin.normalizeExternalLabel(l)}}toString(){return this.friendlyFmt}}t.Instruction=i;class s{constructor(e,t){this.bin=e,this.text=t}getOpExt(){return this.instruction?this.instruction.code:""}getOp(){return this.instruction?this.instruction.name:""}update(e){this.bin.peepOps++,(e=e.replace(/^\s*/,""))||this.bin.peepDel++,e&&(e+="      "),e="    "+e,this.text=e+"; WAS: "+this.text.trim(),this.instruction=null,this.numArgs=null,this.words=l(e)||[],0==this.words.length?this.type="empty":"@"==this.words[0][0]&&(this.type="directive")}}t.Line=s;class o{constructor(e,t){this.id=e,this.description=t,this.sizeAdj=0,this.users=[]}get size(){return this.endLocation-this.startLocation-this.sizeAdj}}class a{constructor(e){this.baseOffset=0,this.checkStack=!0,this.inlineMode=!1,this.normalizeExternalLabel=e=>e,this.currLineNo=0,this.scope="",this.scopeId=0,this.errors=[],this.labels={},this.equs={},this.stackpointers={},this.stack=0,this.commPtr=0,this.peepOps=0,this.peepDel=0,this.peepCounts={},this.stats="",this.throwOnError=!1,this.disablePeepHole=!1,this.stackAtLabel={},this.codeSizeStats=!1,this.labelToObject={},this.idToObject={},this.objSuspendStart=0,this.labelsToObjectDone=!1,this.currLine=new s(this,"<start>"),this.currLine.lineNo=0,this.ei=e,this.ei.file=this}emitShort(t){e.assert(0<=t&&t<=65535),this.buf.push(t)}emitOpCode(e){this.emitShort(e)}location(){return 2*this.buf.length}pc(){return this.location()+this.baseOffset}useLabel(t){if(!this.currObject||"."==t[0]||this.objSuspendStart)return;const n=e.U.lookup(this.labelToObject,t);n&&n!=this.currObject&&n.users.length<5&&n.users.indexOf(this.currObject)<0&&n.users.push(this.currObject)}parseOneInt(t){if(!t)return null;if(/^\d+$/.test(t))return parseInt(t,10);const r=t.indexOf("-");if(r>0)return this.parseOneInt(t.slice(0,r))-this.parseOneInt(t.slice(r+1));let i=1;if(t.indexOf("*")>=0){let e=null;for(;null!=(e=/^([^\*]*)\*(.*)$/.exec(t));){let n=this.parseOneInt(e[1]);if(null==n)return null;i*=n,t=e[2]}}if("-"==t[0]?(i*=-1,t=t.slice(1)):"+"==t[0]&&(t=t.slice(1)),/^\d+$/.test(t))return i*parseInt(t,10);if(e.U.endsWith(t,"|1"))return 1|this.parseOneInt(t.slice(0,t.length-2));if(e.U.endsWith(t,"-1"))return this.parseOneInt(t.slice(0,t.length-2))-1;if(e.U.endsWith(t,"+1"))return this.parseOneInt(t.slice(0,t.length-2))+1;let s=/(.*)>>(\d+)$/.exec(t);if(s){let e=this.parseOneInt(s[1]);return e&=~(-16777216&this.baseOffset),e>>parseInt(s[2])}let o=null;if("0"==t[0])if("x"==t[1]||"X"==t[1]){let e=/^0x([a-f0-9]+)$/i.exec(t);e&&(o=parseInt(e[1],16))}else if("b"==t[1]||"B"==t[1]){let e=/^0b([01]+)$/i.exec(t);e&&(o=parseInt(e[1],2))}if(t.indexOf("@")>=0){let r=/^(\w+)@(-?\d+)$/.exec(t);r&&(1!=i&&this.directiveError(n("multiplication not supported with saved stacks")),this.stackpointers.hasOwnProperty(r[1])?o=this.ei.wordSize()*this.ei.computeStackOffset(r[1],this.stack-this.stackpointers[r[1]]+parseInt(r[2])):this.directiveError(n("saved stack not found"))),r=/^(.*)@(hi|lo|fn)$/.exec(t),r&&this.looksLikeLabel(r[1])&&(o=this.lookupLabel(r[1],!0),null!=o&&("fn"==r[2]?o=this.ei.toFnPtr(o,this.baseOffset,r[1]):(o>>=1,0<=o&&o<=65535?"hi"==r[2]?o=o>>8&255:"lo"==r[2]?o&=255:e.oops():(this.directiveError(n("@hi/lo out of range")),o=null))))}return null==o&&this.looksLikeLabel(t)&&(o=this.lookupLabel(t,!0),null!=o&&1==this.ei.postProcessRelAddress(this,1)&&(o+=this.baseOffset)),null==o||isNaN(o)?null:o*i}looksLikeLabel(e){return!/^(r\d|pc|sp|lr)$/i.test(e)&&/^[\.a-zA-Z_][\.:\w+]*$/.test(e)}scopedName(e){return"."==e[0]&&this.scope?this.scope+"$"+e:e}lookupLabel(e,t=!1){this.useLabel(e);let r=null,i=this.scopedName(e);return this.labels.hasOwnProperty(i)?(r=this.labels[i],r=this.ei.postProcessRelAddress(this,r)):this.lookupExternalLabel&&(r=this.lookupExternalLabel(e),null!=r&&(r=this.ei.postProcessAbsAddress(this,r))),null==r&&this.equs.hasOwnProperty(i)&&(r=this.equs[i]),null==r&&t&&(this.finalEmit?this.directiveError(n("unknown label: {0}",e)):r=11111),r}align(t){for(e.assert(2==t||4==t||8==t||16==t);this.location()%t!=0;)this.emitOpCode(0)}pushError(e,t=""){let r={scope:this.scope,message:n("  -> Line {2} ('{1}'), error: {0}\n{3}",e,this.currLine.text,this.currLine.lineNo,t),lineNo:this.currLine.lineNo,line:this.currLine.text,coremsg:e,hints:t};if(this.errors.push(r),this.throwOnError)throw new Error(r.message)}directiveError(e){this.pushError(e)}emitString(e,t=!1){function r(e,t){return 255&(e.charCodeAt(t)||0)}let i,s=/^\s*([\w\.]+\s*:\s*)?.\w+\s+(".*")\s*$/.exec(e);if(s&&null!=(i=c(s[2])))if(this.align(2),t)for(let e=0;e<i.length;e++)this.emitShort(i.charCodeAt(e));else for(let e=0;e<i.length+1;e+=2)this.emitShort(r(i,e+1)<<8|r(i,e));else this.directiveError(n("expecting string"))}parseNumber(e){let t=this.parseOneInt(e.shift());return null==t?null:t}parseNumbers(e){e=e.slice(1);let t=[];for(;;){let r=this.parseNumber(e);if(null==r){this.directiveError(n("cannot parse number at '{0}'",e[0]));break}if(t.push(r),","!=e[0]){if(null==e[0])break;this.directiveError(n("expecting number, got '{0}'",e[0]));break}if(e.shift(),null==e[0])break}return t}emitSpace(e){let t=this.parseNumbers(e);if(1==t.length&&t.push(0),2!=t.length)this.directiveError(n("expecting one or two numbers"));else if(t[0]%2!=0)this.directiveError(n("only even space supported"));else{let e=255&t[1];e|=e<<8;for(let n=0;n<t[0];n+=2)this.emitShort(e)}}emitBytes(e){let t=this.parseNumbers(e);t.length%2!=0&&(this.directiveError(".bytes needs an even number of arguments"),t.push(0));for(let e=0;e<t.length;e+=2){let r=t[e],i=t[e+1];0<=r&&i<=255&&0<=i&&r<=255?this.emitShort(255&r|(255&i)<<8):this.directiveError(n("expecting uint8"))}}emitHex(e){e.slice(1).forEach((e=>{if(","!=e)if(e.length%4!=0)this.directiveError(".hex needs an even number of bytes");else if(/^[a-f0-9]+$/i.test(e))for(let t=0;t<e.length;t+=4){let n=parseInt(e.slice(t,t+4),16);n=(255&n)<<8|n>>8&255,this.emitShort(n)}else this.directiveError(".hex needs a hex number")}))}handleDirective(t){let r,i=t.words,s=()=>{2!=i.length&&this.directiveError(n("expecting one argument"))};switch(i[0]){case".object":if(this.codeSizeStats)if("PUSH"==i[1])this.objSuspendStart=this.location();else if("POP"==i[1])this.objSuspendStart&&(this.currObject.sizeAdj+=this.location()-this.objSuspendStart),this.objSuspendStart=0;else{if(this.currObject&&(this.currObject.endLocation=this.location()),this.currObject=e.U.lookup(this.idToObject,i[1]),!this.currObject){const e=t.text.replace(/^[^"]*/,"");let r=i[1];i.length>2&&(r=c(e.trim()),null==r&&this.directiveError(n("expecting string in .object"))),this.currObject=new o(i[1],r),this.idToObject[i[1]]=this.currObject}this.currObject.sizeAdj=0,this.currObject.startLocation=this.location()}else;break;case".ascii":case".asciz":case".string":this.emitString(t.text);break;case".utf16":this.emitString(t.text,!0);break;case".align":if(s(),r=this.parseOneInt(i[1]),null!=r){if(0==r)return;r<=4?this.align(1<<r):this.directiveError(n("expecting 1, 2, 3 or 4 (for 2, 4, 8, or 16 byte alignment)"))}else this.directiveError(n("expecting number"));break;case".balign":if(s(),r=this.parseOneInt(i[1]),null!=r){if(1==r)return;2==r||4==r||8==r||16==r?this.align(r):this.directiveError(n("expecting 2, 4, 8, or 16"))}else this.directiveError(n("expecting number"));break;case".p2align":s(),r=this.parseOneInt(i[1]),null!=r?this.align(1<<r):this.directiveError(n("expecting number"));break;case".byte":this.emitBytes(i);break;case".hex":this.emitHex(i);break;case".hword":case".short":case".2bytes":this.parseNumbers(i).forEach((e=>{-32768<=e&&e<=65535?this.emitShort(65535&e):this.directiveError(n("expecting int16"))}));break;case".word":case".4bytes":case".long":this.parseNumbers(i).forEach((e=>{-2147483648<=e&&e<=4294967295?(this.emitShort(65535&e),this.emitShort(e>>16&65535)):this.directiveError(n("expecting int32"))}));break;case".skip":case".space":this.emitSpace(i);break;case".set":case".equ":/^\w+$/.test(i[1])||this.directiveError(n("expecting name"));const a=this.parseNumbers(i.slice(","==i[2]||"="==i[2]?2:1));1!=a.length&&this.directiveError(n("expecting one value")),void 0!==this.equs[i[1]]&&this.equs[i[1]]!=a[0]&&this.directiveError(n("redefinition of {0}",i[1])),this.equs[i[1]]=a[0];break;case".startaddr":this.location()&&this.directiveError(n(".startaddr can be only be specified at the beginning of the file")),s(),this.baseOffset=this.parseOneInt(i[1]);break;case"@stackmark":s(),this.stackpointers[i[1]]=this.stack;break;case"@stackempty":this.checkStack&&(null==this.stackpointers[i[1]]?this.directiveError(n("no such saved stack")):this.stackpointers[i[1]]!=this.stack&&this.directiveError(n("stack mismatch")));break;case"@scope":this.scope=i[1]||"",this.currLineNo=this.scope?0:this.realCurrLineNo;break;case".syntax":case"@nostackcheck":this.checkStack=!1;break;case"@dummystack":s(),this.stack+=this.parseOneInt(i[1]);break;case".section":case".global":this.stackpointers={},this.stack=0,this.scope="$S"+this.scopeId++;break;case".comm":{i=i.filter((e=>","!=e)),i.shift();let e=this.parseOneInt(i[1]),t=0;if(t=i[2]?this.parseOneInt(i[2]):4,null==this.lookupLabel(i[0])){for(this.commPtr||(this.commPtr=this.lookupExternalLabel("_pxt_comm_base")||0,this.commPtr||this.directiveError(n("PXT_COMM_BASE not defined")));this.commPtr&t-1;)this.commPtr++;this.labels[this.scopedName(i[0])]=this.commPtr-this.baseOffset,this.commPtr+=e}break}case".file":case".text":case".cpu":case".fpu":case".eabi_attribute":case".code":case".thumb_func":case".type":case".fnstart":case".save":case".size":case".fnend":case".pad":case".globl":case".local":case"@":break;default:/^\.cfi_/.test(i[0])||this.directiveError(n("unknown directive"))}}handleOneInstruction(e,t){this.codeSizeStats&&e.ldlitLabel&&this.useLabel(e.ldlitLabel);let r=t.emit(e);return!r.error&&(this.stack+=r.stack,this.checkStack&&this.stack<0&&this.pushError(n("stack underflow")),e.location=this.location(),e.opcode=r.opcode,e.stack=r.stack,this.emitOpCode(r.opcode),null!=r.opcode2&&this.emitOpCode(r.opcode2),null!=r.opcode3&&this.emitOpCode(r.opcode3),e.instruction=t,e.numArgs=r.numArgs,!0)}handleInstruction(e){if(e.instruction&&this.handleOneInstruction(e,e.instruction))return;let t=e=>this.ei.instructions.hasOwnProperty(e)?this.ei.instructions[e]:[];if(!e.instruction){let n=t(e.words[0]);for(let t=0;t<n.length;++t)if(this.handleOneInstruction(e,n[t]))return}let r=e.words[0].toLowerCase().replace(/s$/,"").replace(/[^a-z]/g,""),i="",s=t(r).concat(t(r+"s"));s.length>0&&s.forEach((t=>{let r=t.emit(e);i+=n("   Maybe: {0} ({1} at '{2}')\n",t.toString(),r.error,r.errorAt)})),this.pushError(n("assembly error"),i)}buildLine(e,t){let n=e=>{let n=new s(this,e);return n.scope=this.scope,n.lineNo=this.currLineNo,t.push(n),n},r=n(e),i=l(r.text)||[];r.words=i;let o=i[0]||"";if(":"==o.charAt(o.length-1)){let t=/^([\.\w]+):$/.exec(i[0]);if(t){if(r.type="label",r.text=t[1]+":",r.words=[t[1]],!(i.length>1))return;i.shift(),r=n(e.replace(/^[^:]*:/,"")),r.words=i,o=i[0]||""}}let a=o.charAt(0);"."==a||"@"==a?(r.type="directive","@scope"==r.words[0]&&this.handleDirective(r)):0==r.words.length?r.type="empty":r.type="instruction"}prepLines(e){this.currLineNo=0,this.realCurrLineNo=0,this.lines=[],e.split(/\r?\n/).forEach((e=>{this.errors.length>10||(this.currLineNo++,this.realCurrLineNo++,this.buildLine(e,this.lines))}))}iterLines(){this.stack=0,this.buf=[],this.scopeId=0,this.lines.forEach((t=>{if(!(this.errors.length>10)&&(this.currLine=t,0!=t.words.length))if("label"==t.type){this.currObject&&!this.labelsToObjectDone&&"."!=t.words[0][0]&&(this.labelToObject[t.words[0]]=this.currObject);let r=this.scopedName(t.words[0]);if(this.prevLabel=r,this.finalEmit){null!=this.equs[r]&&this.directiveError(n(".equ redefined as label"));let t=this.labels[r];null==t&&e.oops(),0==this.errors.length&&t!=this.location()&&e.oops(`invalid location: ${this.location()} != ${t} at ${r}`),e.assert(this.errors.length>0||t==this.location()),this.reallyFinalEmit&&(this.stackAtLabel[r]=this.stack)}else this.labels.hasOwnProperty(r)?this.directiveError(n("label redefinition")):this.inlineMode&&/^_/.test(r)?this.directiveError(n("labels starting with '_' are reserved for the compiler")):this.labels[r]=this.location();t.location=this.location()}else"directive"==t.type?this.handleDirective(t):"instruction"==t.type?this.handleInstruction(t):"empty"==t.type||e.oops()})),this.labelsToObjectDone=!0,this.currObject=null}getSourceMap(){const e={};let t="",n=0,r=0,i=0;function s(){t&&r&&(e[t]||(e[t]=[]),e[t].push(n,r,i-r)),r=0,i=0}return this.lines.forEach(((e,o)=>{const a=/^; ([\w\/\.-]+)\(([\d]+),\d+\):/.exec(e.text);a&&(s(),t=a[1],n=parseInt(a[2])),"instruction"==e.type&&(r||(r=e.location),i=e.location)})),s(),e}getCodeSizeStats(){if(!this.codeSizeStats)return"";const t=e.U.values(this.idToObject);t.sort(((e,t)=>t.size-e.size));let n=";\n; Code size:\n;\n";for(const e of t)if(n+=`; ${("         "+e.size).slice(-6)} ${e.description} [${e.id}]\n`,e.users.length>=5)n+=`;        by many, including ${e.users[0].description}\n`;else for(const t of e.users)n+=`;        by ${t.description} [${t.id}]\n`;return n}getSource(e,r=1,i=0){let s=0,o=e=>{let t=this.labels[e]||s,n=t-s;return s=t,n},a=this.buf?this.location():0,l=o("_code_end"),c=o("_helpers_end"),u=o("_vtables_end"),d=o("_literals_end"),p=s,h=a+this.baseOffset&16777215;if(i&&h>i){const e=new Error(n("program too big by {0} bytes!",h-i));throw e.ksErrorCode=9283,e}let f=n("; total bytes: {0} ({1}% of {2}k flash with {3} free)",h,(100*h/(i=i||131072)).toFixed(1),(i/1024).toFixed(1),i-h),m=n("; generated code sizes (bytes): {0} (incl. {1} user, {2} helpers, {3} vtables, {4} lits); src size {5}\n",p,l,c,u,d,a-p)+n("; assembly: {0} lines; density: {1} bytes/stmt; ({2} stmts)\n",this.lines.length,Math.round(100*l/r)/100,r)+f+"\n"+this.stats+this.getCodeSizeStats()+"\n\n",_=!1;return this.lines.forEach(((n,r)=>{if("_stored_program"==n.words[0])return m+='_stored_program: .string "..."\n',void(_=!0);if(_)return void(_=!1);let i=n.text;if(e){if("@stackempty"==n.words[0]&&this.lines[r-1].text==n.text)return;if(i=i.replace(/; WAS: .*/,""),!i.trim())return}t.debug&&("label"!=n.type&&"instruction"!=n.type||(i+=` \t; 0x${(n.location+this.baseOffset).toString(16)}`)),m+=i+"\n"})),m}peepHole(){let e=this.lines.filter((e=>"empty"!=e.type));for(let t=0;t<e.length;++t){let n=e[t];if(/^user/.test(n.scope))continue;let r=e[t+1];if(!r)continue;let i=e[t+2];"instruction"==n.type&&this.ei.peephole(n,r,i)}}clearLabels(){this.labels={},this.commPtr=0}peepPass(t){this.disablePeepHole||(this.peepOps=0,this.peepDel=0,this.peepCounts={},this.peepHole(),this.throwOnError=!0,this.finalEmit=!1,this.clearLabels(),this.iterLines(),e.assert(!this.checkStack||0==this.stack),this.finalEmit=!0,this.reallyFinalEmit=t||0==this.peepOps,this.iterLines(),this.stats+=n("; peep hole pass: {0} instructions removed and {1} updated\n",this.peepDel,this.peepOps-this.peepDel))}getLabels(){return this.userLabelsCache||(this.userLabelsCache=e.U.mapMap(this.labels,((e,t)=>t+this.baseOffset))),this.userLabelsCache}emit(t){if(e.assert(null==this.buf),this.prepLines(t),this.errors.length>0)return;if(this.clearLabels(),this.iterLines(),this.checkStack&&0!=this.stack&&this.directiveError(n("stack misaligned at the end of the file")),this.errors.length>0)return;if(this.ei.expandLdlit(this),this.clearLabels(),this.iterLines(),this.finalEmit=!0,this.reallyFinalEmit=this.disablePeepHole,this.iterLines(),this.errors.length>0)return;for(let e=0;e<5&&(pxt.debug(`Peephole OPT, pass ${e}`),this.peepPass(5==e),0!=this.peepOps);++e);pxt.debug("emit done")}}t.File=a;t.VMFile=class extends a{constructor(e){super(e)}};function l(e){let t=[],n="";e:for(let r=0;r<e.length;++r)switch(e[r]){case"[":case"]":case"!":case"{":case"}":case",":n&&(t.push(n),n=""),t.push(e[r]);break;case" ":case"\t":case"\r":case"\n":n&&(t.push(n),n="");break;case";":break e;default:n+=e[r]}return n&&(t.push(n),n=""),t[0]?t:null}function c(e){e=e.replace(/\\\\/g,"\\B").replace(/\\(['\?])/g,((e,t)=>t)).replace(/\\[z0]/g,"\0").replace(/\\x([0-9a-f][0-9a-f])/gi,((e,t)=>"\\u00"+t)).replace(/\\B/g,"\\\\");try{return JSON.parse(e)}catch(e){return null}}function u(e,t){return{stack:null,opcode:null,error:e,errorAt:t}}function d(e){return e<0||e>65535?("0x"+e.toString(16)).toLowerCase():("0x"+("000"+e.toString(16)).slice(-4)).toLowerCase()}t.AbstractProcessor=class{constructor(){this.file=null,this.addEnc=(e,t,n)=>{let r={name:e,pretty:t,encode:n,isRegister:/^\$r\d/.test(e),isImmediate:/^\$i\d/.test(e),isRegList:/^\$rl\d/.test(e),isLabel:/^\$l[a-z]/.test(e)};return this.encoders[e]=r,r},this.inrange=(e,t,n)=>Math.floor(t)!=t||t<0||t>e?null:n,this.inminmax=(e,t,n,r)=>Math.floor(n)!=n||n<e||n>t?null:r,this.inseq=(e,t)=>{let n=e.indexOf(t);return n<0?null:n},this.inrangeSigned=(e,t,n)=>{if(Math.floor(t)!=t)return null;if(t<-(e+1))return null;if(t>e)return null;return n&(e<<1|1)},this.addInst=(e,t,n,r)=>{let s=new i(this,e,t,n,r);return this.instructions.hasOwnProperty(s.name)||(this.instructions[s.name]=[]),this.instructions[s.name].push(s),s},this.encoders={},this.instructions={}}toFnPtr(e,t,n){return e}wordSize(){return-1}computeStackOffset(e,t){return t}is32bit(e){return!1}emit32(e,t,n){return null}postProcessRelAddress(e,t){return t}postProcessAbsAddress(e,t){return t}peephole(e,t,n){}registerNo(e){return null}getAddressFromLabel(e,t,n,r=!1){return null}isPop(e){return!1}isPush(e){return!1}isAddSP(e){return!1}isSubSP(e){return!1}testAssembler(){e.assert(!1)}expandLdlit(e){}},t.emitErr=u,t.expectError=function(t,n){let r=new a(t);r.emit(n),0==r.errors.length&&e.oops("ASMTEST: expecting error for: "+n)},t.tohex=d,t.expect=function(t,n){let r=[],i=n.replace(/^([0-9a-fA-F]{4,8})\s/gm,((e,t)=>(r.push(parseInt(t.slice(0,4),16)),8==t.length&&r.push(parseInt(t.slice(4,8),16)),""))),s=new a(t);s.throwOnError=!0,s.disablePeepHole=!0,s.emit(i),s.errors.length>0&&(console.debug(s.errors[0].message),e.oops("ASMTEST: not expecting errors")),s.buf.length!=r.length&&e.oops("ASMTEST: wrong buf len");for(let t=0;t<r.length;++t)s.buf[t]!=r[t]&&e.oops("ASMTEST: wrong buf content at "+t+" , exp:"+d(r[t])+", got: "+d(s.buf[t]))}}(e.assembler||(e.assembler={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){var n=pxtc.Util;t.apiRoot=e.BrowserUtils.isLocalHost()||n.isNodeJS?"https://www.makecode.com/api/":"/api/",t.accessToken="",t.localToken="";let r=!0;function i(t){let r=new Error(n.lf("Cannot access {0} while offline",t));return r.isOffline=!0,e.U.delay(1e3).then((()=>Promise.reject(r)))}function s(n,r){return e.U.requestAsync({url:"/api/"+n,headers:{Authorization:t.localToken},method:r?"POST":"GET",data:r||void 0,allowHttpErrors:!0})}function o(){return e.webConfig&&!e.webConfig.isStatic&&!e.BrowserUtils.isLocalHost()&&!!e.webConfig.cdnUrl}function a(n){if(n=n.replace(/^\//,""),!o())return t.apiRoot+n;const r=new Date,i=r.getUTCFullYear()+("0"+(r.getUTCMonth()+1)).slice(-2)+("0"+r.getUTCDate()).slice(-2);return n.indexOf("?")<0?n+="?":n+="&",n+="cdn="+i,e.webConfig.cdnUrl+"/api/"+n}function l(e){return o()?(e.url=a(e.url),n.requestAsync(e).catch((t=>c(e,t)))):u(e)}function c(e,n){return 0==n.statusCode?(r&&(r=!1,t.onOffline()),i(e.url)):Promise.reject(n)}function u(r){var s;return r.url=(null===(s=e.webConfig)||void 0===s?void 0:s.isStatic)&&!r.forceLiveEndpoint?e.webConfig.relprefix+r.url:t.apiRoot+r.url,r.allowGzipPost=!0,t.isOnline()||e.BrowserUtils.isPxtElectron()?(r.headers||(r.headers={}),e.BrowserUtils.isLocalHost()?t.localToken&&(r.headers.Authorization=t.localToken):t.accessToken&&(r.headers["x-td-access-token"]=t.accessToken),n.requestAsync(r).catch((e=>c(r,e)))):i(r.url)}function d(){return navigator&&navigator.onLine}t.onOffline=()=>{},t.hasAccessToken=function(){return!!t.accessToken},t.localRequestAsync=s,t.useCdnApi=o,t.cdnApiUrl=a,t.apiRequestWithCdnAsync=l,t.privateRequestAsync=u,t.privateGetTextAsync=function(e,t){return u({url:e,headers:t}).then((e=>e.text))},t.privateGetAsync=function(e,t=!1){return u({url:e,forceLiveEndpoint:t}).then((e=>e.json))},t.downloadTargetConfigAsync=function(){if(!t.isOnline())return Promise.resolve(void 0);const n=e.appTarget.versions&&e.appTarget.versions.target,r=e.webConfig&&e.webConfig.isStatic?"targetconfig.json":`config/${e.appTarget.id}/targetconfig${n?`/v${n}`:""}`;return e.BrowserUtils.isLocalHost()?s(r).then((e=>e?e.json:void 0)):l({url:r}).then((e=>e.json))},t.downloadScriptFilesAsync=function(e){return u({url:e+"/text"+(e.startsWith("S")?`?time=${Date.now()}`:""),forceLiveEndpoint:!0}).then((e=>JSON.parse(e.text)))},t.downloadScriptMetaAsync=function(e){return u({url:e+(e.startsWith("S")?`?time=${Date.now()}`:""),forceLiveEndpoint:!0}).then((e=>JSON.parse(e.text).meta))},t.downloadBuiltSimJsInfoAsync=async function(t){const n=e.appTarget.versions&&e.appTarget.versions.target||"",r=e.U.stringifyQueryString(t+"/js",{v:"v"+n})+(t.startsWith("S")?`&time=${Date.now()}`:"");return(await u({url:r,forceLiveEndpoint:!0})).json},t.markdownAsync=async function(t,n,r){const i=e.BrowserUtils.isLocalHostDev()?0:36e5,a=24*i*7;n=n||e.Util.userLanguage();const c=await e.BrowserUtils.translationDbAsync(),d=await c.getAsync(n,t),p=async()=>{try{const r=await function(t,n,r){var i;const a=null===(i=e.webConfig)||void 0===i?void 0:i.isStatic,c=e.appTarget.versions&&e.appTarget.versions.target||"?";let d;if(a){d=t;const e=/\/?docs\//.test(d),n=/\.\w+$/.test(d);if(!e){const e="/"===d[0];d=`docs${e?"":"/"}${d}`}n||(d=`${d}.md`)}else d=`md/${e.appTarget.id}/${t.replace(/^\//,"")}?targetVersion=${encodeURIComponent(c)}`;"en"!=n&&(d+=`${a?"?":"&"}lang=${encodeURIComponent(n)}`);if(e.BrowserUtils.isLocalHost()&&!e.Util.liveLocalizationEnabled())return s(d).then((e=>404==e.statusCode?u({url:d,method:"GET"}).then((e=>({md:e.text,etag:e.headers.etag}))):{md:e.text,etag:void 0}));{const e=r&&!o()?{"If-None-Match":r}:void 0;return l({url:d,method:"GET",headers:e}).then((e=>({md:e.text,etag:e.headers.etag})))}}(t,n,null==d?void 0:d.etag);return!d||r.md&&d.md!==r.md?(await c.setAsync(n,t,r.etag,void 0,r.md),r.md):d.md}catch(e){if(r)throw e;return""}};if(d){const t=Date.now()-d.time,n=t>i;if(t>a)e.tickEvent("markdown.update.wait");else if(n&&(e.tickEvent("markdown.update.background"),p()),d.md)return d.md}return p()},t.privateDeleteAsync=function(e){return u({url:e,method:"DELETE"}).then((e=>e.json))},t.privatePostAsync=function(e,t,n=!1){return u({url:e,data:t||{},forceLiveEndpoint:n}).then((e=>e.json))},t.isLoggedIn=function(){return!!t.accessToken},t.isNavigatorOnline=d,t.isOnline=function(){return"undefined"!=typeof navigator&&d()&&(r=!0),r},t.getServiceUrl=function(){return t.apiRoot.replace(/\/api\/$/,"")},t.getUserId=function(){let e=/^0(\w+)\./.exec(t.accessToken);return e?e[1]:null},t.parseScriptId=function(t){var r;const i=e.appTarget;if(!t||!i.appTheme||!(null===(r=i.cloud)||void 0===r?void 0:r.sharing))return;let s=["makecode.com"];i.appTheme.embedUrl&&s.push(i.appTheme.embedUrl),i.appTheme.shareUrl&&s.push(i.appTheme.shareUrl),s=n.unique(s,(e=>e)).map((e=>n.escapeForRegex(n.stripUrlProtocol(e).replace(/\/$/,"")).toLowerCase()));const o=`(?:(?:https://)?(?:${s.join("|")})/)`,a=new RegExp(`^${o}?(?:v[0-9]+/)?(?:(?:api/oembed\\?url=.*%2F([^&#]*)&.*)|(?:/?([a-z0-9\\-_]+)(?:[#?&].*)?))$`,"i").exec(t.trim()),l=(null==a?void 0:a[1])||(null==a?void 0:a[2]);return/^(_.{12}|S?[0-9\-]{23})$/.test(l)?l:void 0}}(e.Cloud||(e.Cloud={}))}(pxt||(pxt={})),function(e){!function(e){e.f4EncodeImg=function(e,t,n,r){let i=[135,n,255&e,e>>8,255&t,t>>8,0,0].map(c).join(""),s=4,o=0,a=0,l=e=>{o|=e<<a,a==8-n?(i+=c(o),s++,o=0,a=0):a+=n};for(let i=0;i<e;++i){for(let e=0;e<t;++e)l(r(i,e));for(;0!=a;)l(0);if(n>1)for(;3&s;)l(0)}return i;function c(e){return("0"+e.toString(16)).slice(-2)}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){function t(e){let t="";switch(e){case 0:t="C5";break;case 1:t="B";break;case 2:t="A";break;case 3:t="G";break;case 4:t="F";break;case 5:t="E";break;case 6:t="D";break;case 7:t="C"}return t}function n(e){let t=-1;switch(e){case"C5":t=0;break;case"B":t=1;break;case"A":t=2;break;case"G":t=3;break;case"F":t=4;break;case"E":t=5;break;case"D":t=6;break;case"C":t=7}return t}e.MelodyArray=class{constructor(e){this.numCols=8,this.numRows=8,this.polyphonic=!1,e&&(this.tempo=e),this.resetMelody()}setTempo(e){this.tempo=e}getArray(){return this.melody}setArray(e){this.melody=e}getColor(e){return 0}getValue(e,t){return this.melody[e][t]}getWidth(){return this.numCols}getHeight(){return this.numRows}updateMelody(e,t){const n=!this.melody[e][t];if(n&&!this.polyphonic)for(let e=0;e<this.numRows;e++)this.melody[e][t]=!1;this.melody[e][t]=n}getStringRepresentation(){let e="",n=new Array(this.numCols),r=0;for(let e=0;e<this.numRows;e++){let i=0;n[e]=[];for(let r=0;r<this.numCols;r++)this.melody[r][e]&&(n[e].push(t(r)),i++);i>r&&(r=i)}if(0==r)return"- - - - - - - - ";for(let t=0;t<r;t++)for(let t=0;t<this.numCols;t++)n[t]&&n[t].length>0?e+=n[t].shift()+" ":e+="- ";return e}parseNotes(e){let t=(e=e.trim()).split(" ");for(let e=0;e<t.length;e++){for(let t=0;t<this.numRows;t++)this.melody[t][e]=!1;"-"!=t[e]&&(this.melody[n(t[e])][e]=!0)}}setPolyphonic(e){this.polyphonic=e}isPolyphonic(){return this.polyphonic}resetMelody(){this.melody=new Array(this.numCols);for(let e=0;e<this.numCols;e++)this.melody[e]=new Array(this.numRows).fill(!1)}},e.rowToNote=t,e.noteToRow=n,e.getColorClass=function(e){let t="melody-default";switch(e){case 0:t="melody-red";break;case 1:t="melody-orange";break;case 2:t="melody-yellow";break;case 3:t="melody-green";break;case 4:t="melody-teal";break;case 5:t="melody-blue";break;case 6:t="melody-purple";break;case 7:t="melody-violet"}return t}}(pxtmelody||(pxtmelody={})),function(e){function t(e,t,n){return function(e,t,n){if(t)for(const n of Object.keys(t))"className"===n?e.setAttribute("class",t[n]+""):e.setAttribute(n,t[n]+"");n&&e.addEventListener("click",n);return e}(document.createElement(e),t,n)}e.MelodyGallery=class{constructor(){this.value=null,this.visible=!1,this.timeouts=[],this.numSamples=e.SampleMelodies.length,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("id","melody-editor-gallery-outer"),this.contentDiv=document.createElement("div"),this.contentDiv.setAttribute("id","melody-editor-gallery"),this.itemBackgroundColor="#DCDCDC",this.itemBorderColor="white",this.initStyles(),this.containerDiv.appendChild(this.contentDiv),this.containerDiv.style.display="none",this.contentDiv.addEventListener("animationend",(()=>{this.visible||(this.containerDiv.style.display="none")})),this.contentDiv.addEventListener("wheel",(e=>{e.stopPropagation()}),!0)}getElement(){return this.containerDiv}getValue(){return this.value}show(e){this.pending=e,this.containerDiv.style.display="block",this.buildDom(),this.visible=!0,pxt.BrowserUtils.removeClass(this.contentDiv,"hidden-above"),pxt.BrowserUtils.addClass(this.contentDiv,"shown")}hide(){this.visible=!1,pxt.BrowserUtils.removeClass(this.contentDiv,"shown"),pxt.BrowserUtils.addClass(this.contentDiv,"hidden-above"),this.value=null,this.stopMelody()}clearDomReferences(){this.contentDiv=null,this.containerDiv=null}layout(e,t,n){this.containerDiv.style.left=e+"px",this.containerDiv.style.top=t+"px",this.containerDiv.style.height=n+"px"}buildDom(){for(;this.contentDiv.firstChild;)this.contentDiv.removeChild(this.contentDiv.firstChild);const t=e.SampleMelodies;this.buttons=[];for(let e=0;e<t.length;e++)this.mkButton(t[e],e,"255px","45px")}initStyles(){const e=document.createElement("style");e.textContent="\n            #melody-editor-gallery {\n                margin-top: -100%;\n            }\n\n            #melody-editor-gallery.hidden-above {\n                margin-top: -100%;\n                animation: slide-up 0.2s 0s ease;\n            }\n\n            #melody-editor-gallery.shown {\n                margin-top: 0px;\n                animation: slide-down 0.2s 0s ease;\n            }\n\n            @keyframes slide-down {\n                0% {\n                    margin-top: -100%;\n                }\n                100% {\n                    margin-top: 0px;\n                }\n            }\n\n            @keyframes slide-up {\n                0% {\n                    margin-top: 0px;\n                }\n                100% {\n                    margin-top: -100%;\n                }\n            }\n            ",this.containerDiv.appendChild(e)}mkButton(e,n,r,i){const s=t("div",{className:"melody-gallery-button melody-editor-card",role:"menuitem",id:`:${n}`}),o=t("i",{className:"music icon melody-icon"}),a=t("div",{className:"melody-editor-text"});a.innerText=e.name;const l=this.createColorBlock(e),c=t("div",{className:"melody-editor-button left-button",role:"button",title:e.name},(()=>this.handleSelection(e)));c.appendChild(o),c.appendChild(a),c.appendChild(l),s.appendChild(c);const u=t("div",{className:"melody-editor-button right-button",role:"button",title:lf("Preview {0}",e.name)},(()=>this.togglePlay(e,n))),d=t("i",{className:"play icon"});this.buttons[n]=d,u.appendChild(d),s.appendChild(u),this.contentDiv.appendChild(s)}handleSelection(e){if(this.pending){const t=this.pending;this.pending=void 0,t(e.notes)}}playNote(e,t,n){let r=0;switch(e){case"C5":r=523;break;case"B":r=494;break;case"A":r=440;break;case"G":r=392;break;case"F":r=349;break;case"E":r=330;break;case"D":r=294;break;case"C":r=262}this.timeouts.push(setTimeout((()=>{pxt.AudioContextManager.tone(r)}),t*this.getDuration(n))),this.timeouts.push(setTimeout((()=>{pxt.AudioContextManager.stop()}),(t+1)*this.getDuration(n)))}getDuration(e){return 6e4/e}previewMelody(e){this.stopMelody();let t=e.notes.split(" ");for(let n=0;n<t.length;n++)this.playNote(t[n],n,e.tempo)}togglePlay(e,t){let n=this.buttons[t];pxt.BrowserUtils.containsClass(n,"play icon")?(this.resetPlayIcons(),pxt.BrowserUtils.removeClass(n,"play icon"),pxt.BrowserUtils.addClass(n,"stop icon"),this.previewMelody(e),this.timeouts.push(setTimeout((()=>{pxt.BrowserUtils.removeClass(n,"stop icon"),pxt.BrowserUtils.addClass(n,"play icon")}),e.notes.split(" ").length*this.getDuration(e.tempo)))):(pxt.BrowserUtils.removeClass(n,"stop icon"),pxt.BrowserUtils.addClass(n,"play icon"),this.stopMelody())}stopMelody(){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop()}resetPlayIcons(){for(let e=0;e<this.numSamples;e++){let t=this.buttons[e];if(pxt.BrowserUtils.containsClass(t,"stop icon")){pxt.BrowserUtils.removeClass(t,"stop icon"),pxt.BrowserUtils.addClass(t,"play icon");break}}}createColorBlock(t){let n=document.createElement("div");pxt.BrowserUtils.addClass(n,"melody-color-block");let r=t.notes.split(" ");for(let t=0;t<r.length;t++){let i=e.getColorClass(e.noteToRow(r[t])),s=document.createElement("div");0==t?pxt.BrowserUtils.addClass(s,"left-edge sliver "+i):t==r.length-1?pxt.BrowserUtils.addClass(s,"right-edge sliver "+i):pxt.BrowserUtils.addClass(s,"sliver "+i),n.appendChild(s)}return n}}}(pxtmelody||(pxtmelody={})),function(e){class t{constructor(e,t,n){this.name=e,this.notes=t,this.tempo=n}}e.MelodyInfo=t,e.SampleMelodies=[new t(lf("Scale"),"C5 B A G F E D C",120),new t(lf("Reverse"),"C D E F G A B C5",120),new t(lf("Mystery"),"E B C5 A B G A F",120),new t(lf("Gilroy"),"A F E F D G E F",120),new t(lf("Falling"),"C5 A B G A F G E",120),new t(lf("Hopeful"),"G B A G C5 B A B",120),new t(lf("Tokyo"),"B A G A G F A C5",120),new t(lf("Paris"),"G F G A - F E D",120),new t(lf("Rising"),"E D G F B A C5 B",120),new t(lf("Sitka"),"C5 G B A F A C5 B",120)]}(pxtmelody||(pxtmelody={})),function(e){let t,n=!1;class r{constructor(e){this.db=e}loadAsync(n,r,i,s){if(!/^v\d+\.\d+\.\d+$/.test(r))return s(n,r);const o=`gh-${i}-${n}#${r}`;return t.cacheGet(o).then((i=>{if(i){const t=e.Util.jsonTryParse(i);if(t)return e.debug(`cache hit ${o}`),Promise.resolve(t)}return s(n,r).then((n=>n?(e.debug(`cached ${o}`),t.cacheSet(o,JSON.stringify(n)).then((()=>n))):n))}))}latestVersionAsync(e,t){return this.db.latestVersionAsync(e,t)}loadConfigAsync(e,t){return this.loadAsync(e,t,"pxt",((e,t)=>this.db.loadConfigAsync(e,t)))}loadPackageAsync(e,t){return this.loadAsync(e,t,"pkg",((e,t)=>this.db.loadPackageAsync(e,t)))}}class i{constructor(e){this.packageFiles=e}resolve(e,t){return""}readFile(t,n){const r="this"==t.id?n:"pxt_modules/"+t.id+"/"+n;return void 0!==this.packageFiles[r]?this.packageFiles[r]:e.appTarget.bundledpkgs[t.id]?e.appTarget.bundledpkgs[t.id][n]:null}writeFile(t,n,r){const i="this"==t.id?"":"pxt_modules/"+t.id+"/";e.debug(`write file ${i+n}`),this.packageFiles[i+n]=r}getHexInfoAsync(e){return Promise.resolve({hex:["SKIP"]})}cacheStoreAsync(e,n){return(null==t?void 0:t.cacheSet)?t.cacheSet(e,n):Promise.resolve()}cacheGetAsync(e){return(null==t?void 0:t.cacheGet)?t.cacheGet(e):Promise.resolve("")}downloadPackageAsync(r){return n?function(e){const n=null==t?void 0:t.pkgOverrideAsync;return(n?n(e.id):Promise.resolve(void 0)).then((t=>t||e.commonDownloadAsync()))}(r).then((t=>{t&&e.U.iterMap(t,((e,t)=>{this.writeFile(r,e,t)}))})):Promise.resolve()}resolveVersionAsync(e){return Promise.resolve("*")}}function s(t){if(t.target.preferredEditor==e.PYTHON_PROJECT_NAME){const n=e.U.clone(t);n.ast=!0,n.target.preferredEditor=e.JAVASCRIPT_PROJECT_NAME;for(let t of n.sourceFiles)e.U.endsWith(t,".py")&&(n.fileSystem[t.slice(0,-3)+".ts"]=" ");const r=pxtc.compile(n);t.apisInfo=pxtc.getApiInfo(r.ast,n.jres)}}function o(t,n){const r=new i(t),o=new e.MainPackage(r);return o.loadAsync().then((()=>{let e=o.getTargetOptions();return e.hasHex&&(e.isNative=n.native),o.getCompileOptionsAsync(e)})).then((t=>(a(o.targetVersion(),t),o.getPreferredEditor()===e.PYTHON_PROJECT_NAME&&l(o.targetVersion(),t),s(t),t)))}function a(t,n){if(t){e.debug(`applying TS patches relative to ${t}`);for(let r of Object.keys(n.fileSystem))if(-1==r.indexOf("/")&&e.U.endsWith(r,".ts")){const i=n.fileSystem[r],s=e.patching.patchJavaScript(t,i);i!=s&&(e.debug(`applying TS patch to ${r}`),n.fileSystem[r]=s)}}}function l(t,n){if(t){e.debug(`applying PY patches relative to ${t}`);for(let r of Object.keys(n.fileSystem))if(-1==r.indexOf("/")&&e.U.endsWith(r,".py")){const i=n.fileSystem[r],s=e.patching.patchPython(t,i);i!=s&&(e.debug(`applying PY patch to ${r}`),n.fileSystem[r]=s)}}}e.SimpleHost=i,e.prepPythonOptions=s,e.simpleInstallPackagesAsync=function(t){const n=new i(t);return new e.MainPackage(n).loadAsync(!0)},e.simpleGetCompileOptionsAsync=o,e.simpleCompileAsync=function(e,t){return o(e,"boolean"==typeof t?{native:t}:t||{}).then((e=>pxtc.compile(e))).then((e=>(e.success||(e.errors=e.diagnostics.map(ts.pxtc.getDiagnosticString).join("")||"Unknown error."),e)))},e.patchTS=a,e.patchPY=l,e.setupSimpleCompile=function(i){"undefined"==typeof global||global.btoa||(global.btoa=function(e){return Buffer.from(e,"binary").toString("base64")},global.atob=function(e){return Buffer.from(e,"base64").toString("binary")}),"undefined"!=typeof pxtTargetBundle&&(e.debug("setup app bundle"),e.setAppTarget(pxtTargetBundle)),i&&(t=i,n=!0,i.httpRequestAsync&&(e.Util.httpRequestCoreAsync=i.httpRequestAsync),e.github.forceProxy=!0,e.github.db=new r(new e.github.MemoryGithubDb)),e.debug("simple setup done")}}(pxt||(pxt={})),function(e){e.simshim=function(t,n){let r,i=ts.SyntaxKind,s=t.getTypeChecker(),o=e.cpp.nsWriter("declare namespace"),a="";for(let s of t.getSourceFiles()){if(n){let t=n(s.fileName);if(e.debug("SimShim[1]: "+t.dir),!e.U.endsWith(t.dir,"/sim")&&!e.U.startsWith(s.fileName,"sim/"))continue}else if(!e.U.startsWith(s.fileName,"sim/"))continue;e.debug("SimShim[2]: "+s.fileName);for(let e of s.statements){let t=e;e.kind==i.ModuleDeclaration&&"pxsim"==t.name.text&&(r=t,m(t.body))}}let l={};return l[e.appTarget.corepkg]=o.finish(),l;function c(e){let t;return ts.isExpression(e)&&(t=s.getContextualType(e)),t||(t=s.getTypeAtLocation(e)),t}function u(e){let t=s.typeToString(e,r,ts.TypeFormatFlags.UseFullyQualifiedType);switch(t=t.replace(/^pxsim\./,""),t){case"RefAction":return"() => void";case"RefBuffer":return"Buffer";default:return t}}function d(e){let t=pxtc.getComments(e);return/^\s*\/\/%/m.test(t)?t:null}function p(e){let t=d(e);if(!t)return;let n=e.name.getText(),r="//% shim=."+n,i=s.getTypeAtLocation(e);o.write(t),o.write(r),o.write(`public ${n}: ${u(i)};`),o.write("")}function h(e){let t=d(e);if(!t)return;s.getTypeAtLocation(e);let n=e.parameters.map((e=>e.name.getText()+": "+u(c(e))));o.write(t),o.write(`//% shim="new ${a}"`),o.write(`constructor(${n.join(", ")});`),o.write("")}function f(t,n=!1){let r=d(t);if(!r)return;let l=t.name.getText(),p=t.kind==i.MethodDeclaration||t.kind==i.GetAccessor||t.kind==i.SetAccessor,h="//% shim="+(p?"."+l:a+"::"+l),f=s.getSignatureFromDeclaration(t),m=s.getReturnTypeOfSignature(f),_=/Async$/.test(l),g=(y=m,pxtc.isObjectType(y)&&y.objectFlags&ts.ObjectFlags.Reference&&"Promise"==y.symbol.name?y.typeArguments[0]:null);var y;g?(h+=" promise",m=g,_||e.U.userError(`${a}::${l} should be called ${l}Async`)):_&&e.U.userError(`${a}::${l} doesn't return a promise`),e.debug("emitFun: "+l);let b=t.parameters.map((e=>`${e.name.getText()}${e.questionToken?"?":""}: ${u(c(e))}`)),v=l.replace(/Async$/,""),T=p?"public":"function",k=`(${b.join(", ")})`;t.kind==i.GetAccessor&&(T=n?"public":"readonly",k="",h+=" property"),p||o.setNs(a),o.write(r),o.write(h),o.write(`${T} ${v}${k}: ${u(m)};`),o.write("")}function m(e){switch(e.kind){case i.ModuleDeclaration:return function(e){let t=a;a&&(a+="."),a+=e.name.text,m(e.body),a=t}(e);case i.ModuleBlock:return e.statements.forEach(m);case i.FunctionDeclaration:return f(e);case i.ClassDeclaration:return function(e){let t=d(e);if(!t)return;o.setNs(a),o.write(t);let n=a;a&&(a+="."),a+=e.name.text;let r=n?"":"declare",s="";if(e.heritageClauses)for(let t of e.heritageClauses)t.token==i.ExtendsKeyword&&(s=" extends "+u(c(t.types[0])));o.write(`${r} class ${e.name.text}${s} {`),o.incrIndent();for(let t of e.members)switch(t.kind){case i.MethodDeclaration:f(t);break;case i.PropertyDeclaration:p(t);break;case i.Constructor:h(t);break;case i.GetAccessor:let n=e.members.some((e=>e.kind==i.SetAccessor&&e.name.getText()==t.name.getText()));f(t,n)}a=n,o.decrIndent(),o.write("}")}(e)}}}}(pxt||(pxt={})),function(e){!function(t){t.annotate=function(n,r,i){const s=t.target;t.target=i;let o=n.getSourceFiles().filter((e=>e.fileName===r))[0],a=n.getTypeChecker();function l(n,r,i=!1,s=null){let o=i||!(u(n).flags&e.TypeFlags.Void),l=s||c(n);if(n.expression&&l){let e=!1;switch(l.kind){case t.SK.PropertySignature:case t.SK.PropertyAssignment:case t.SK.PropertyDeclaration:t.isStatic(l)||(e=!0);break;case t.SK.Parameter:t.isCtorField(l)&&(e=!0);break;case t.SK.GetAccessor:case t.SK.SetAccessor:case t.SK.MethodDeclaration:case t.SK.MethodSignature:e=!0}if(e){const e=n.expression;e.kind===t.SK.PropertyAccessExpression?r.unshift(e.expression):r.unshift(n.expression)}}let d={decl:l,qName:l?t.getNodeFullName(a,l):"?",args:r,isExpression:o};t.pxtInfo(n).callInfo=d}function c(n){if(!n)return null;let r,i=a.getSymbolAtLocation(n);if(i&&(r=i.valueDeclaration,!r&&i.declarations)){let t=i.declarations[0];t&&t.kind==e.SyntaxKind.ImportEqualsDeclaration&&(i=a.getSymbolAtLocation(t.moduleReference),i&&(r=i.valueDeclaration))}if(!r&&n.kind==t.SK.PropertyAccessExpression){const e=n;r={kind:t.SK.PropertySignature,symbol:{isBogusSymbol:!0,name:e.name.getText()},name:e.name},t.pxtInfo(r).flags|=2}return r}function u(n){let r;const i=t.pxtInfo(n);return i.typeCache?i.typeCache:(e.isExpression(n)&&(r=a.getContextualType(n)),r||(r=a.getTypeAtLocation(n)),r?e.isStringLiteral(n)?r:t.checkType(r):r)}!function n(r){e.forEachChild(r,(r=>{switch(r.kind){case e.SyntaxKind.CallExpression:l(r,r.arguments.slice(0),null,c(r.expression));break;case e.SyntaxKind.PropertyAccessExpression:l(r,[]);break;case e.SyntaxKind.TaggedTemplateExpression:l(r,[r.template],!0,c(r.tag));break;case e.SyntaxKind.BinaryExpression:!function(n){const r=n.left,i=n.right;let s=u(n.left),o=u(n.right);n.operatorToken.kind!=t.SK.PlusToken&&n.operatorToken.kind!=t.SK.PlusEqualsToken||(t.isStringType(s)||t.isStringType(o)&&n.operatorToken.kind==t.SK.PlusToken)&&(t.pxtInfo(n).exprInfo={leftType:a.typeToString(s),rightType:a.typeToString(o)});switch(n.operatorToken.kind){case e.SyntaxKind.EqualsToken:case e.SyntaxKind.PlusEqualsToken:case e.SyntaxKind.MinusEqualsToken:if(r.kind==t.SK.PropertyAccessExpression){let n=c(r);n&&n.kind==t.SK.GetAccessor?(n=e.getDeclarationOfKind(n.symbol,t.SK.SetAccessor),l(r,[i],!1,n)):n&&(n.kind==t.SK.PropertySignature||n.kind==t.SK.PropertyAssignment||t.target&&t.target.switches.slowFields)&&l(r,[i])}}}(r);break;case e.SyntaxKind.Identifier:const n=c(r);if(n&&n.getSourceFile().fileName!==pxt.MAIN_TS&&n.kind==e.SyntaxKind.VariableDeclaration){const e=t.pxtInfo(r);e.flags|=4,e.commentAttrs||(e.commentAttrs=t.parseComments(n))}}n(r)}))}(o),t.target=s}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){function t(e){let t='"';for(let n=0;n<e.length;++n){let r=255&e.charCodeAt(n),i=String.fromCharCode(r);t+="\\"==i||'"'==i?"\\"+i:"\n"==i?"\\n":r<=15?"\\x0"+r.toString(16):r<32||r>127?"\\x"+r.toString(16):i}return t+'"'}e.asmStringLiteral=t;function n(n){let r="pxt::string_inline_ascii_vt",i=e.target.utf8?e.U.toUTF8(n,!0):n,s="";if(i!==n)if(n.length>16){r="pxt::string_skiplist16_packed_vt";let o=[],a=0;for(let t=0;t+16<=n.length;t+=16)a+=e.U.toUTF8(n.slice(t,t+16),!0).length,o.push(a);s=`\n    .short ${i.length}, ${n.length}\n    .short ${o.map((e=>e.toString())).join(", ")}\n    .string ${t(i)}\n`}else r="pxt::string_inline_utf8_vt";return s||(s=`\n    .short ${i.length}\n    .string ${t(i)}\n`),{vt:r,asm:s}}function r(e,t=""){return`\n                .word ${e.length>>1}${t}\n                .hex ${e}${e.length%4==0?"":"00"}\n        `}e.AssemblerSnippets=class{nop(){return"TBD(nop)"}reg_gets_imm(e,t){return"TBD(reg_gets_imm)"}proc_setup(e,t){return"TBD(proc_setup)"}push_fixed(e){return"TBD(push_fixed)"}push_local(e){return"TBD(push_local)"}push_locals(e){return"TBD(push_locals)"}pop_fixed(e){return"TBD(pop_fixed)"}pop_locals(e){return"TBD(pop_locals)"}proc_return(){return"TBD(proc_return)"}debugger_stmt(e){return""}debugger_bkpt(e){return""}debugger_proc(e){return""}unconditional_branch(e){return"TBD(unconditional_branch)"}beq(e){return"TBD(beq)"}bne(e){return"TBD(bne)"}cmp(e,t){return"TBD(cmp)"}cmp_zero(e){return"TBD(cmp_zero)"}arithmetic(){return""}load_reg_src_off(e,t,n,r,i,s){return"TBD(load_reg_src_off)"}rt_call(e,t,n){return"TBD(rt_call)"}call_lbl(e,t){return"TBD(call_lbl)"}call_reg(e){return"TBD(call_reg)"}helper_prologue(){return"TBD(lambda_prologue)"}helper_epilogue(){return"TBD(lambda_epilogue)"}pop_clean(e){return"TBD"}load_ptr_full(e,t){return"TBD(load_ptr_full)"}emit_int(e,t){return"TBD(emit_int)"}obj_header(e){return`.word ${e}`}string_literal(e,t){const r=n(t);return`\n            .balign 4\n            .object ${e}\n            ${e}: ${this.obj_header(r.vt)}\n            ${r.asm}\n`}hex_literal(e,t){return`\n.balign ${/f{16}/i.test(t)?8:4}\n.object ${e}\n${e}: ${this.obj_header("pxt::buffer_vt")}\n${r(t)}\n`}},e.utf8AsmStringLiteral=n,e.hexLiteralAsm=r,e.numBytes=function(e){let t=0;for(let n=e;n>0;n>>>=8)t++;return t||1};e.ProctoAssembler=class{constructor(t,n,r){this.resText="",this.exprStack=[],this.calls=[],this.proc=null,this.baseStackSize=0,this.labelledHelpers={},this.write=t=>{this.resText+=e.asmline(t)},this.t=t,this.bin=n,this.proc=r,this.proc&&this.work()}emitHelpers(){this.emitLambdaTrampoline(),this.emitArrayMethods(),this.emitFieldMethods(),this.emitBindHelper()}redirectOutput(t){let n=this.write,r="";this.write=t=>r+=e.asmline(t);try{t()}finally{this.write=n}return r}stackSize(){return this.baseStackSize+this.exprStack.length}stackAlignmentNeeded(t=0){if(!e.target.stackAlign)return 0;let n=e.target.stackAlign-(this.stackSize()+t&e.target.stackAlign-1);return n==e.target.stackAlign?0:n}getAssembly(){return this.resText}work(){this.write(`\n;\n; Function ${this.proc.getFullName()}\n;\n`);let t=this.proc.label();this.write(`.object ${t} ${JSON.stringify(this.proc.getFullName())}`);let n=t+"_pre",r=t+"_bkpt",i=t+"_locals",s=t+"_end";this.write(`${n}:`),this.emitLambdaWrapper(this.proc.isRoot),this.write(".section code"),this.write(`${t}:`),this.proc.classInfo&&this.proc.info.thisParameter&&!e.target.switches.skipClassCheck&&!e.target.switches.noThisCheckOpt&&(this.write("mov r7, lr"),this.write("ldr r0, [sp, #0]"),this.emitInstanceOf(this.proc.classInfo,"validate"),this.write("mov lr, r7")),this.write(`\n${t}_nochk:\n    @stackmark func\n    @stackmark args\n`),this.proc.fillDebugInfo=t=>{let o=t.getLabels();this.proc.debugInfo={locals:(1==this.proc.seqNo?this.bin.globals:this.proc.locals).map((e=>e.getDebugInfo())),args:this.proc.args.map((e=>e.getDebugInfo())),name:this.proc.getName(),codeStartLoc:e.U.lookup(o,i),codeEndLoc:e.U.lookup(o,s),bkptLoc:e.U.lookup(o,r),localsMark:e.U.lookup(t.stackAtLabel,i),idx:this.proc.seqNo,calls:this.calls,size:e.U.lookup(o,s)+2-e.U.lookup(o,n)};for(let n of this.calls)n.addr=e.U.lookup(o,n.callLabel),n.stack=e.U.lookup(t.stackAtLabel,n.callLabel),n.callLabel=void 0;for(let n=0;n<this.proc.body.length;++n){let r=this.proc.body[n].breakpointInfo;if(r){let n=e.U.lookup(t.stackAtLabel,`__brkp_${r.id}`);n!==this.proc.debugInfo.localsMark&&(console.log(r),console.log(t.stackAtLabel),e.U.oops(`offset doesn't match: ${n} != ${this.proc.debugInfo.localsMark}`))}}},this.bin.breakpoints&&this.write(this.t.debugger_proc(r)),this.baseStackSize=1;let o=this.proc.locals.length;this.write("push {lr}"),this.write(".locals:\n"),this.proc.perfCounterNo&&(this.write(this.t.emit_int(this.proc.perfCounterNo,"r0")),this.write("bl pxt::startPerfCounter")),this.write(this.t.proc_setup(o)),this.baseStackSize+=o,this.write("@stackmark locals"),this.write(`${i}:`);for(let t=0;t<this.proc.body.length;++t){let n=this.proc.body[t];switch(n.stmtKind){case e.ir.SK.Expr:this.emitExpr(n.expr);break;case e.ir.SK.StackEmpty:if(this.exprStack.length>0){for(let e of this.proc.body.slice(t-4,t+1))console.log(`PREVSTMT ${e.toString().trim()}`);for(let e of this.exprStack)console.log(`EXPRSTACK ${e.currUses}/${e.totalUses} E: ${e.toString()}`);e.oops("stack should be empty")}this.write("@stackempty locals");break;case e.ir.SK.Jmp:this.emitJmp(n);break;case e.ir.SK.Label:this.write(n.lblName+":"),this.validateJmpStack(n);break;case e.ir.SK.Comment:this.write(`; ${n.expr.data}`);break;case e.ir.SK.Breakpoint:if(this.bin.breakpoints){let e=`__brkp_${n.breakpointInfo.id}`;n.breakpointInfo.isDebuggerStmt?this.write(this.t.debugger_stmt(e)):this.write(this.t.debugger_bkpt(e))}break;default:e.oops()}}e.assert(0<=o&&o<127),o>0&&this.write(this.t.pop_locals(o)),this.proc.perfCounterNo&&(this.write("mov r4, r0"),this.write(this.t.emit_int(this.proc.perfCounterNo,"r0")),this.write("bl pxt::stopPerfCounter"),this.write("mov r0, r4")),this.write(`${s}:`),this.write(this.t.proc_return()),this.write("@stackempty func"),this.write("@stackempty args"),this.write("; endfun")}mkLbl(e){let t=e+this.bin.lblNo++;return"_"!=t[0]&&(t="."+t),t}dumpStack(){let e="[";for(let t of this.exprStack)e+=t.sharingInfo()+": "+t.toString()+"; ";return e+="]",e}terminate(t){e.assert(t.exprKind==e.ir.EK.SharedRef);let n=t.args[0];e.U.assert(n.currUses!=n.totalUses),e.U.assert(this.exprStack[0]===n,"term at top");let r=1;for(;r<this.exprStack.length;){let e=this.exprStack[r];if(e.currUses!=e.totalUses)break;r++}return this.write(`@dummystack ${r}`),this.write(this.t.pop_locals(r)),r}validateJmpStack(t,n=0){let r=this.exprStack.length-n;null==t.lblStackSize?t.lblStackSize=r:t.lblStackSize!=r&&(console.log(t.lblStackSize,r),console.log(this.dumpStack()),e.U.oops("stack misaligned at: "+t.lblName))}emitJmp(t){let n=0;if(t.jmpMode==e.ir.JmpMode.Always)t.expr&&this.emitExpr(t.expr),t.terminateExpr&&(n=this.terminate(t.terminateExpr)),this.write(this.t.unconditional_branch(t.lblName)+" ; with expression");else{let r=this.mkLbl("jmpz");this.emitExpr(t.expr),(t.expr.exprKind!=e.ir.EK.RuntimeCall||"thumb::subs"!==t.expr.data&&!e.U.startsWith(t.expr.data,"_cmp_"))&&this.write(this.t.cmp_zero("r0")),t.jmpMode==e.ir.JmpMode.IfNotZero?this.write(this.t.beq(r)):this.write(this.t.bne(r)),t.terminateExpr&&(n=this.terminate(t.terminateExpr)),this.write(this.t.unconditional_branch(t.lblName)),this.write(r+":")}this.validateJmpStack(t.lbl,n)}clearStack(e=!1){let t=0;for(;this.exprStack.length>0&&this.exprStack[0].currUses==this.exprStack[0].totalUses;)t++,this.exprStack.shift();if(t&&this.write(this.t.pop_locals(t)),!e){let e=this.exprStack.filter((e=>e.currUses==e.totalUses&&-1!=e.irCurrUses));if(e.length>0){this.write(this.t.reg_gets_imm("r7",0));for(let t of e)t.irCurrUses=-1,this.write(this.loadFromExprStack("r7",t,0,!0))}}}emitExprInto(t,n){switch(t.exprKind){case e.ir.EK.NumberLiteral:"number"==typeof t.data?this.write(this.t.emit_int(t.data,n)):e.oops();break;case e.ir.EK.PointerLiteral:this.write(this.t.load_ptr_full(t.data,n));break;case e.ir.EK.SharedRef:let r=t.args[0];e.U.assert(!!r.currUses),e.U.assert(r.currUses<r.totalUses),r.currUses++;let i=this.exprStack.indexOf(r);if(e.U.assert(i>=0),0==i&&r.totalUses==r.currUses)this.write(this.t.pop_fixed([n])+` ; tmpref @${this.exprStack.length}`),this.exprStack.shift(),this.clearStack();else{let e=i.toString()+":"+this.exprStack.length;this.write(this.t.load_reg_src_off(n,"sp",e,!0)+" ; tmpref @"+(this.exprStack.length-i))}break;case e.ir.EK.CellRef:let s=t.data;if(s.isGlobal()){let e=this.bitSizeInfo(s.bitSize),t="#"+s.index;(e.needsSignExt||s.index>=e.immLimit)&&(this.write(this.t.emit_int(s.index,n)),t=n),this.write(this.t.load_reg_src_off("r7","r6","#0")),this.write(this.t.load_reg_src_off(n,"r7",t,!1,!1,e))}else{let[e,t,r]=this.cellref(s);this.write(this.t.load_reg_src_off(n,e,t,r))}break;default:e.oops()}}bitSizeInfo(t){let n={size:e.sizeOfBitSize(t),immLimit:128};return 1==n.size?n.immLimit=32:2==n.size&&(n.immLimit=64),1!=t&&3!=t||(n.needsSignExt=!0),n}emitExpr(t){switch(t.exprKind){case e.ir.EK.JmpValue:this.write("; jmp value (already in r0)");break;case e.ir.EK.Nop:this.write(this.t.nop());break;case e.ir.EK.FieldAccess:return this.emitExpr(t.args[0]),this.emitFieldAccess(t);case e.ir.EK.Store:return this.emitStore(t.args[0],t.args[1]);case e.ir.EK.RuntimeCall:return this.emitRtCall(t);case e.ir.EK.ProcCall:return this.emitProcCall(t);case e.ir.EK.SharedDef:return this.emitSharedDef(t);case e.ir.EK.Sequence:return t.args.forEach((e=>this.emitExpr(e))),this.clearStack();case e.ir.EK.InstanceOf:return this.emitExpr(t.args[0]),this.emitInstanceOf(t.data,t.jsInfo);default:return this.emitExprInto(t,"r0")}}emitFieldAccess(t,n=!1){let r=t.data,i=(n?"st":"ld")+"fld_"+r.classInfo.id+"_"+r.name;r.needsCheck&&!e.target.switches.skipClassCheck&&(this.emitInstanceOf(r.classInfo,"validate"),i+="_chk");let s=4*r.idx+4,o="#"+s;s>124&&(this.write(this.t.emit_int(s,"r3")),o="r3"),n?this.write(`str r1, [r0, ${o}]`):this.write(`ldr r0, [r0, ${o}]`)}writeFailBranch(){this.write(".fail:"),this.write("mov r1, lr"),this.write(this.t.callCPP("pxt::failedCast"))}emitClassCall(t){let n=t.virtualIndex+e.firstMethodOffset();this.write(this.t.emit_int(4*n,"r1"));let r=t.classInfo,i="";t.isThis&&(i+="_this"),this.emitLabelledHelper("classCall_"+r.id+i,(()=>{this.write("ldr r0, [sp, #0] ; ld-this"),this.loadVTable(),e.target.switches.skipClassCheck||t.isThis||this.checkSubtype(r),this.write("ldr r1, [r3, r1] ; ld-method"),this.write("bx r1 ; keep lr from caller"),this.writeFailBranch()}))}helperObject(e){return`.object _pxt_helper_${e.replace(/[^\w]+/g,"_")} "helper: ${e}"`}emitBindHelper(){this.write(`\n                ${this.helperObject("bind")}\n                .section code\n                _pxt_bind_helper:\n                    push {r0, r2}\n                    movs r0, #2\n                    ldlit r1, _pxt_bind_lit\n                    ${this.t.callCPP("pxt::mkAction")}\n                    pop {r1, r2}\n                    str r1, [r0, #12]\n                    str r2, [r0, #16]\n                    bx r4 ; return\n\n                _pxt_bind_lit:\n                    ${this.t.obj_header("pxt::RefAction_vtable")}\n                    .short 0, 0 ; no captured vars\n                    .word .bindCode@fn\n                .bindCode:\n                    ; r0-bind object, r4-#args\n                    cmp r4, #12\n                    bge .fail\n                    lsls r3, r4, #2\n                    ldlit r2, _pxt_copy_list\n                    ldr r1, [r2, r3]\n\n                    ldr r3, [r0, #12]\n                    ldr r2, [r0, #16]\n                    adds r4, r4, #1\n                    bx r1\n            `),this.writeFailBranch(),this.write("_pxt_copy_list:"),this.write(e.U.range(12).map((e=>`.word _pxt_bind_${e}@fn`)).join("\n"));for(let e=0;e<12;e++){this.write(`\n                _pxt_bind_${e}:\n                    sub sp, #4\n                `);for(let t=0;t<e;++t)this.write(`ldr r1, [sp, #4*${t+1}]`),this.write(`str r1, [sp, #4*${t}]`);this.write(`\n                    push {r3} ; this-ptr\n                    mov r1, lr\n                    str r1, [sp, #4*${e+1}] ; store LR\n                    blx r2\n                    ldr r1, [sp, #4*${e+1}]\n                    add sp, #8\n                    bx r1\n                `)}}ifaceCallCore(t,n,r=!1){this.write("\n                ldr r2, [r3, #12] ; load mult\n                movs r7, r2\n                beq .objlit ; built-in types have mult=0\n                muls r7, r1\n                lsrs r7, r2\n                lsls r7, r7, #1 ; r7 - hash offset\n                ldr r3, [r3, #4] ; iface table\n                adds r3, r3, r7\n                ; r0-this, r1-method idx, r2-free, r3-hash entry, r4-num args, r7-free\n                ");for(let t=0;t<e.vtLookups;++t)t>0&&this.write("    adds r3, #2"),this.write("\n                ldrh r2, [r3, #0] ; r2-offset of descriptor\n                ldrh r7, [r2, r3] ; r7-method idx\n                cmp r7, r1\n                beq .hit\n                ");"get"==n?(this.write("movs r0, #0 ; undefined"),this.write("bx lr")):this.write("b .fail2"),this.write("\n            .hit:\n                adds r3, r3, r2 ; r3-descriptor\n                ldr r2, [r3, #4]\n                lsls r7, r2, #31\n                beq .field\n            ");const i=this.t.emit_int(t,"r4")+"\n     bx r2";if("set"==n?this.write(`\n                    ; check for next descriptor\n                    ldrh r7, [r3, #8]\n                    cmp r7, r1\n                    bne .fail2 ; no setter!\n                    ldr r2, [r3, #12]\n                    ${i}\n                `):(this.write("\n                    ; check if it's getter\n                    ldrh r7, [r3, #2]\n                    cmp r7, #1\n                "),"get"==n?this.write(`\n                        bne .bind\n                        ${i}\n                    .bind:\n                        mov r4, lr\n                        bl _pxt_bind_helper\n                    `):this.write(`\n                        beq .doublecall\n                        ${i}\n                    .doublecall:\n                        ; call getter\n                        movs r4, #1\n                        push {r0, lr}\n                        blx r2\n                        pop {r1, r2}\n                        mov lr, r2\n                        b .moveArgs\n                    `)),r||(this.write(`\n                .objlit:\n                    ldrh r2, [r3, #8]\n                    cmp r2, #${pxt.BuiltInType.RefMap}\n                    bne .fail\n                    mov r4, lr\n                `),"set"==n&&this.write("ldr r2, [sp, #4] ; ld-val"),this.write(this.t.callCPP("set"==n?"pxtrt::mapSet":"pxtrt::mapGet")),n?this.write("bx r4"):(this.write("mov lr, r4"),this.write("b .moveArgs"))),this.write(".field:"),"set"==n?this.write("\n                        ldr r3, [sp, #4] ; ld-val\n                        str r3, [r0, r2] ; store field\n                        bx lr\n                    "):"get"==n?this.write("\n                        ldr r0, [r0, r2] ; load field\n                        bx lr\n                    "):this.write("\n                        ldr r0, [r0, r2] ; load field\n                    "),!n){this.write(".moveArgs:");for(let e=0;e<t;++e)e==t-1?this.write("movs r1, r0"):this.write(`ldr r1, [sp, #4*${e+1}]`),this.write(`str r1, [sp, #4*${e}]`);this.lambdaCall(t-1)}r&&this.write(".objlit:"),this.writeFailBranch(),this.write(`\n            .fail2:\n                ${this.t.callCPP("pxt::missingProperty")}\n            `)}emitIfaceCall(t,n,r=""){e.U.assert(t.ifaceIndex>0),this.write(this.t.emit_int(t.ifaceIndex,"r1")),this.emitLabelledHelper("ifacecall"+n+"_"+r,(()=>{this.write("ldr r0, [sp, #0] ; ld-this"),this.loadVTable(),this.ifaceCallCore(n,r)}))}checkSubtype(e,t=".fail",n="r2"){e.classNo?(this.write(`ldrh ${n}, [r3, #8]`),this.write(`cmp ${n}, #${e.classNo}`),e.classNo==e.lastSubtypeNo?this.write(`bne ${t}`):(this.write(`blt ${t}`),this.write(`cmp ${n}, #${e.lastSubtypeNo}`),this.write(`bgt ${t}`))):this.write(`b ${t} ; always fails; class never instantiated`)}loadVTable(e="r2",t=".fail",n=".fail"){this.write(`lsls ${e}, r0, #30`),this.write(`bne ${t}`),this.write("cmp r0, #0"),this.write(`beq ${n}`),this.write("ldr r3, [r0, #0]"),this.write("; vtable in R3")}emitInstanceOf(t,n){let r="inst_"+t.id+"_"+n;this.emitLabelledHelper(r,(()=>{"validateNullable"==n?this.loadVTable("r2",".tagged",".undefined"):this.loadVTable("r2",".fail",".fail"),this.checkSubtype(t),"bool"==n?(this.write(`movs r0, #${e.taggedTrue}`),this.write("bx lr"),this.write(".fail:"),this.write(`movs r0, #${e.taggedFalse}`),this.write("bx lr")):"validate"==n?(this.write("bx lr"),this.writeFailBranch()):"validateNullable"==n?(this.write(".undefined:"),this.write("bx lr"),this.write(".tagged:"),this.write(`cmp r0, #${e.taggedNull} ; check for null`),this.write("bne .fail"),this.write("movs r0, #0"),this.write("bx lr"),this.writeFailBranch()):e.U.oops()}))}emitSharedDef(t){let n=t.args[0];if(e.U.assert(n.totalUses>=1),e.U.assert(0===n.currUses),n.currUses=1,1==n.totalUses)return this.emitExpr(n);this.emitExpr(n),this.exprStack.unshift(n),this.write(this.t.push_local("r0")+"; tmpstore @"+this.exprStack.length)}clearArgs(t,n){t.length,n.length;let r=t.concat(n);for(let t of r)0==t.currUses&&1==t.totalUses||(console.log(t.toString()),console.log(r.map((e=>e.toString()))),e.U.oops(`wrong uses: ${t.currUses} ${t.totalUses}`)),t.currUses=1;this.clearStack()}builtInClassNo(e){return{id:"builtin"+e,classNo:e,lastSubtypeNo:e}}emitBeginTry(e){this.emitExprInto(e.args[0],"r0"),this.write("bl _pxt_save_exception_state")}emitRtCall(t,n=null){let r=t.data;if("pxt::beginTry"==r)return this.emitBeginTry(t);let i=t.mask||{refMask:0},s=i.conversions||[],o=t.args.map(((e,t)=>({idx:t,expr:e,isSimple:e.isLiteral(),isRef:0!=(i.refMask&1<<t),conv:s.find((e=>e.argIdx==t))})));e.U.assert(o.length<=4);let a=!1;for(let t of e.U.reversed(o))t.expr.isPure()?t.isSimple||t.isRef||a&&!t.expr.isStateless()||(t.isSimple=!0):a=!0;for(let e of o)e.conv&&(e.isSimple=!1);let l=o.filter((e=>!e.isSimple));if(l.every((e=>e.expr.isPure()&&!e.isRef&&!e.conv))){for(let e of l)e.isSimple=!0;l=[]}let c=l[0],u=!0;if(1!=l.length||c.conv||c.isRef){for(let e of l)this.pushArg(e.expr);this.alignExprStack(0);let t=l.filter((e=>!!e.conv));if(t.length){const n=this.redirectOutput((()=>{let n=0;e.target.switches.inlineConversions||(this.t.stackAligned()?n+=2:n+=1);for(let r of t){if(e.isThumb()&&"pxt::toInt"==r.conv.method){this.write(this.loadFromExprStack("r0",r.expr,n)),this.write("asrs r0, r0, #1");let t=e.target.switches.inlineConversions?r.expr.getId():n;this.write("bcs .isint"+t),this.write("lsls r0, r0, #1"),this.alignedCall(r.conv.method,"",n),this.write(".isint"+t+":"),this.write(this.t.push_fixed(["r0"]))}else this.write(this.loadFromExprStack("r0",r.expr,n)),r.conv.refTag?e.target.switches.skipClassCheck||this.emitInstanceOf(this.builtInClassNo(r.conv.refTag),r.conv.refTagNullable?"validateNullable":"validate"):(this.alignedCall(r.conv.method,"",n),r.conv.returnsRef&&this.write(this.loadFromExprStack("r0",r.expr,n,!0))),this.write(this.t.push_fixed(["r0"]));n++}for(let r of e.U.reversed(t))n--,this.write(this.t.pop_fixed(["r"+r.idx]));for(let e of l)e.conv||this.write(this.loadFromExprStack("r"+e.idx,e.expr,n))}));e.target.switches.inlineConversions?this.write(n):this.emitHelper(this.t.helper_prologue()+n+this.t.helper_epilogue(),"conv")}else for(let e of l)this.write(this.loadFromExprStack("r"+e.idx,e.expr))}else this.emitExpr(c.expr),0!=c.idx&&this.write(this.t.mov("r"+c.idx,"r0")),u=!1;for(let e of o)e.isSimple&&this.emitExprInto(e.expr,"r"+e.idx);n?n():"langsupp::ignore"!=r&&this.alignedCall(r,"",0,!0),u&&this.clearArgs(l.filter((e=>!e.isRef)).map((e=>e.expr)),l.filter((e=>e.isRef)).map((e=>e.expr)))}alignedCall(t,n="",r=0,i=!1){(e.U.startsWith(t,"_cmp_")||e.U.startsWith(t,"_pxt_"))&&(i=!1),this.write(this.t.call_lbl(t,i,this.stackAlignmentNeeded(r))+n)}emitLabelledHelper(e,t){if(this.labelledHelpers[e])this.write(this.t.call_lbl(this.labelledHelpers[e]));else{let n=this.redirectOutput(t);this.emitHelper(n,e),this.labelledHelpers[e]=this.bin.codeHelpers[n]}}emitHelper(e,t="hlp"){if(!this.bin.codeHelpers[e]){let n=Object.keys(this.bin.codeHelpers).length;this.bin.codeHelpers[e]=`_${t}_${n}`}this.write(this.t.call_lbl(this.bin.codeHelpers[e]))}pushToExprStack(e){e.totalUses=1,e.currUses=0,this.exprStack.unshift(e)}pushArg(e){this.clearStack(!0);this.exprStack.length;this.emitExpr(e),this.clearStack(!0),this.write(this.t.push_local("r0")+" ; proc-arg"),this.pushToExprStack(e)}loadFromExprStack(t,n,r=0,i=!1){let s=this.exprStack.indexOf(n);return e.assert(s>=0),this.t.load_reg_src_off(t,"sp",(s+r).toString(),!0,i)+" ; estack\n"}pushDummy(){let t=e.ir.numlit(0);t.totalUses=1,t.currUses=1,this.exprStack.unshift(t)}alignExprStack(e){let t=this.stackAlignmentNeeded(e);if(t)for(let e=0;e<t;++e)this.write("push {r5} ; align"),this.pushDummy()}emitFieldMethods(){for(let t of["get","set"]){this.write(`\n                ${this.helperObject(t)}\n                .section code\n                _pxt_map_${t}:\n                `),this.loadVTable("r4"),this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.RefMap),".notmap","r4"),this.write(this.t.callCPPPush("set"==t?"pxtrt::mapSetByString":"pxtrt::mapGetByString")),this.write(".notmap:");let n="set"==t?2:1,r=!1;this.write("mov r4, r3 ; save VT"),"set"==t?(e.target.stackAlign&&(r=!0,this.write("push {lr} ; align")),this.write("\n                            push {r0, r2, lr}\n                            mov r0, r1\n                        ")):this.write("\n                            push {r0, lr}\n                            mov r0, r1\n                        "),this.write("\n                    bl pxtrt::lookupMapKey\n                    mov r1, r0 ; put key index in r1\n                    ldr r0, [sp, #0] ; restore obj pointer\n                    mov r3, r4 ; restore vt\n                    bl .dowork\n                "),this.write(this.t.pop_locals(n+(r?1:0))),this.write("pop {pc}"),this.write(".dowork:"),this.ifaceCallCore(n,t,!0)}}emitArrayMethod(t,n){this.write(`\n            ${this.helperObject(t+" "+(n?"buffer":"array"))}\n            .section code\n            _pxt_${n?"buffer":"array"}_${t}:\n            `),this.loadVTable("r4");let r=this.builtInClassNo(n?pxt.BuiltInType.BoxedBuffer:pxt.BuiltInType.RefCollection);e.target.switches.skipClassCheck||this.checkSubtype(r,".fail","r4");const i=e.isStackMachine()||e.target.runtimeIsARM||n?"ldr":"ldrh";this.write(`\n                asrs r1, r1, #1\n                bcc .notint\n                ${i} r4, [r0, #${n?4:8}]\n                cmp r1, r4\n                bhs .oob\n            `);let s="r1";n?(s="#8",this.write("\n                    adds r4, r0, r1\n                ")):this.write("\n                    lsls r1, r1, #2\n                    ldr r4, [r0, #4]\n                ");let o=n?"b":"",a=n&&"get"==t?"lsls r0, r0, #1\nadds r0, #1":"";"set"==t?this.write(`\n                        str${o} r2, [r4, ${s}]\n                        bx lr\n                    `):this.write(`\n                        ldr${o} r0, [r4, ${s}]\n                        ${a}\n                        bx lr\n                    `),this.write(`\n            .notint:\n                lsls r1, r1, #1\n                ${this.t.pushLR()}\n                push {r0, r2}\n                mov r0, r1\n                ${this.t.callCPP("pxt::toInt")}\n                mov r1, r0\n                pop {r0, r2}\n            .doop:\n                ${this.t.callCPP(`Array_::${t}At`)}\n                ${a}\n                ${this.t.popPC()}\n            `),this.writeFailBranch(),"get"==t?this.write(`\n                    .oob:\n                        movs r0, #${n?1:0} ; 0 or undefined\n                        bx lr\n                `):this.write(`\n                    .oob:\n                        ${this.t.pushLR()}\n                        b .doop\n                `)}emitArrayMethods(){for(let e of["get","set"])this.emitArrayMethod(e,!0),this.emitArrayMethod(e,!1)}emitLambdaTrampoline(){let t=e.target.stackAlign?"r3,":"";this.write(`\n            ${this.helperObject("trampoline")}\n            .section code\n            _pxt_lambda_trampoline:\n                push {${t} r4, r5, r6, r7, lr}\n                mov r4, r8\n                mov r5, r9\n                mov r6, r10\n                mov r7, r11\n                push {r4, r5, r6, r7} ; save high registers\n                mov r4, r1\n                mov r5, r2\n                mov r6, r3\n                mov r7, r0\n                `),this.emitInstanceOf(this.builtInClassNo(pxt.BuiltInType.RefAction),"validate"),this.write(`\n                mov r0, sp\n                push {r4, r5, r6, r7} ; push args and the lambda\n                mov r1, sp\n                bl pxt::pushThreadContext\n                mov r6, r0          ; save ctx or globals\n                mov r5, r7          ; save lambda for closure\n                mov r0, r5          ; also save lambda pointer in r0 - needed by pxt::bindMethod\n                ldr r1, [r5, #8]    ; ld fnptr\n                movs r4, #3         ; 3 args\n                blx r1              ; execute the actual lambda\n                mov r7, r0          ; save result\n                @dummystack 4\n                add sp, #4*4        ; remove arguments and lambda\n                mov r0, r6   ; or pop the thread context\n                bl pxt::popThreadContext\n                mov r0, r7 ; restore result\n                pop {r4, r5, r6, r7} ; restore high registers\n                mov r8, r4\n                mov r9, r5\n                mov r10, r6\n                mov r11, r7\n                pop {${t} r4, r5, r6, r7, pc}`),this.write(`\n            ${this.helperObject("exn")}\n            .section code\n            ; r0 - try frame\n            ; r1 - handler PC\n            _pxt_save_exception_state:\n                push {r0, lr}\n                ${this.t.callCPP("pxt::beginTry")}\n                pop {r1, r4}\n                str r1, [r0, #1*4] ; PC\n                mov r1, sp\n                str r1, [r0, #2*4] ; SP\n                str r5, [r0, #3*4] ; lambda ptr\n                bx r4\n                `),this.write("\n            .section code\n            ; r0 - try frame\n            ; r1 - thread context\n            _pxt_restore_exception_state:\n                mov r6, r1\n                ldr r1, [r0, #2*4] ; SP\n                mov sp, r1\n                ldr r5, [r0, #3*4] ; lambda ptr\n                ldr r1, [r0, #1*4] ; PC\n                movs r0, #1\n                orrs r1, r0\n                bx r1\n                "),this.write(`\n            ${this.helperObject("stringconv")}\n            .section code\n            _pxt_stringConv:\n            `),this.loadVTable(),this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.BoxedString),".notstring"),this.write(`\n                bx lr\n\n            .notstring: ; no string, but vtable in r3\n                ldr r7, [r3, #4*${e.firstMethodOffset()-1}]\n                cmp r7, #0\n                beq .fail\n                push {r0, lr}\n                movs r4, #1\n                blx r7\n                str r0, [sp, #0]\n                b .numops\n\n            .fail: ; not an object or no toString\n                push {r0, lr}\n            .numops:\n                ${this.t.callCPP("numops::toString")}\n                pop {r1}\n                pop {pc}\n            `)}emitProcCall(t){let n=[],r=null,i="",s=t.data;if(s.proc&&s.proc.inlineBody)return this.emitExpr(s.proc.inlineSelf(t.args));let o=-1==s.virtualIndex,a=!1;for(let r of e.U.reversed(t.args)){if(r.isPure()){if(!a||r.isStateless())continue}else a=!0;n.push(r)}if(n.reverse(),n.length<=1){let e=n[0];e&&(r=e,this.clearStack(!0),this.emitExpr(e),e==t.args[t.args.length-1]?i="r0":(i="r3",this.write(this.t.mov("r3","r0")))),n=[]}else for(let e of n)this.pushArg(e);this.alignExprStack(t.args.length);let l=["r1","r2","r3","r4"],c=[];if(n.length){let e=-1;for(let t of n)e=Math.max(this.exprStack.indexOf(t),e);if(e++,e<=l.length){l=l.slice(0,e),this.write(this.t.pop_fixed(l)),c=this.exprStack.splice(0,e);let t=[];for(let r=e-1;r>=0;--r)n.indexOf(c[r])<0&&(t.push(l[r]),this.exprStack.unshift(c[r]));t.length&&this.write(this.t.push_fixed(t))}else l=null,this.write(this.t.reg_gets_imm("r7",0))}let u=e.U.reversed(t.args);o&&u.unshift(u.pop());for(let t of u)if(n.indexOf(t)>=0){if(l)this.write(this.t.push_fixed([l[c.indexOf(t)]]));else{this.write(this.loadFromExprStack("r0",t)),this.write(this.t.push_local("r0")+" ; re-push"),this.write(this.loadFromExprStack("r7",t,1,!0));let n=this.exprStack.indexOf(t),r=e.ir.numlit(0);r.currUses=1,r.totalUses=1,this.exprStack[n]=r}this.exprStack.unshift(t)}else t===r?(this.write(this.t.push_local(i)+" ; the one arg"),this.pushToExprStack(t)):this.pushArg(t);let d=this.mkLbl("_proccall"),p=-1;if(o){let e=t.args.length-1;this.write(this.loadFromExprStack("r0",t.args[0])),this.emitLabelledHelper("lambda_call"+e,(()=>{this.lambdaCall(e),this.writeFailBranch()}))}else if(null!=s.virtualIndex||null!=s.ifaceIndex)null!=s.ifaceIndex?s.isSet?(e.assert(2==t.args.length),this.emitIfaceCall(s,t.args.length,"set")):this.emitIfaceCall(s,t.args.length,s.noArgs?"get":""):this.emitClassCall(s),this.write(d+":");else{let e=s.proc;p=e.seqNo,this.write(this.t.call_lbl(e.label()+(s.isThis?"_nochk":""))),this.write(d+":")}this.calls.push({procIndex:p,stack:0,addr:0,callLabel:d}),o&&t.args[0].isStateless()?this.clearArgs([t.args[0]],t.args.slice(1)):this.clearArgs([],t.args)}lambdaCall(t){this.write("; lambda call"),this.loadVTable(),e.target.switches.skipClassCheck||this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.RefAction)),this.write(`\n                movs r4, #${t}\n                ldrh r1, [r0, #4]\n                cmp r1, #0\n                bne .pushR5\n                ldr r1, [r0, #8]\n                bx r1 ; keep lr from the caller\n            .pushR5:\n                sub sp, #8\n            `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e+2}]`),this.write(`str r1, [sp, #4*${e}]`);this.write(`\n                str r5, [sp, #4*${t}]\n                mov r1, lr\n                str r1, [sp, #4*${t+1}]\n                mov r5, r0\n                ldr r7, [r5, #8]\n                blx r7 ; exec actual lambda\n                ldr r4, [sp, #4*${t+1}] ; restore what was in LR\n                ldr r5, [sp, #4*${t}] ; restore lambda ctx\n            `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e}]`),this.write(`str r1, [sp, #4*${e+2}]`);this.write("\n                add sp, #8\n                bx r4\n            "),this.write("; end lambda call")}emitStore(t,n){switch(t.exprKind){case e.ir.EK.CellRef:let r=t.data;if(this.emitExpr(n),r.isGlobal()){let e=this.bitSizeInfo(r.bitSize),t="#"+r.index;r.index>=e.immLimit&&(this.write(this.t.emit_int(r.index,"r1")),t="r1"),this.write(this.t.load_reg_src_off("r7","r6","#0")),this.write(this.t.load_reg_src_off("r0","r7",t,!1,!0,e))}else{let[e,t,n]=this.cellref(r);this.write(this.t.load_reg_src_off("r0",e,t,n,!0))}break;case e.ir.EK.FieldAccess:this.emitRtCall(e.ir.rtcall("dummy",[t.args[0],n]),(()=>this.emitFieldAccess(t,!0)));break;default:e.oops()}}cellref(t){if(t.isGlobal())throw e.oops();if(t.iscap){let n=t.index+3;return e.assert(0<=n&&n<32),["r5",n.toString(),!0]}if(t.isarg){return["sp","args@"+t.index.toString()+":"+this.baseStackSize,!1]}return["sp","locals@"+t.index,!1]}emitLambdaWrapper(e){if(this.write(""),this.write(".section code"),this.write(".balign 4"),e&&(this.proc.info.usedAsValue=!0),!this.proc.info.usedAsValue&&!this.proc.info.usedAsIface)return;this.proc.info.usedAsValue&&(this.write(this.proc.label()+"_Lit:"),this.write(this.t.obj_header("pxt::RefAction_vtable")),this.write(".short 0, 0 ; no captured vars"),this.write(`.word ${this.proc.label()}_args@fn`)),this.write(`${this.proc.label()}_args:`);let t=this.proc.args.length;if(0==t)return;this.write(`cmp r4, #${t}`),this.write(`bge ${this.proc.label()}_nochk`);let n=this.stackAlignmentNeeded(t+1),r=n?t+2:t+1;this.write("push {lr}"),this.emitLabelledHelper(`expand_args_${t}`,(()=>{this.write("movs r0, #0"),this.write("movs r1, #0"),n&&this.write("push {r0}");for(let e=t;e>0;e--)e!=t&&(this.write(`cmp r4, #${e}`),this.write(`blt .zero${e}`),this.write(`ldr r0, [sp, #${r-1}*4]`),this.write(`str r1, [sp, #${r-1}*4] ; clear existing`),this.write(`.zero${e}:`)),this.write("push {r0}");this.write("bx lr")})),this.write(`bl ${this.proc.label()}_nochk`);let i=t+(n?1:0);this.write(`@dummystack ${i}`),this.write(`add sp, #4*${i}`),this.write("pop {pc}")}emitCallRaw(t){let n=e.hexfile.lookupFunc(t);e.assert(!!n,"unimplemented raw function: "+t),this.alignedCall(t)}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){const t={"numops::adds":"+","numops::subs":"-","numops::div":"/","numops::mod":"%","numops::muls":"*","numops::ands":"&","numops::orrs":"|","numops::eors":"^","numops::bnot":"~","numops::lsls":"<<","numops::asrs":">>","numops::lsrs":">>>","numops::le":"<=","numops::lt":"<","numops::lt_bool":"<","numops::ge":">=","numops::gt":">","numops::eq":"==","pxt::eq_bool":"==","pxt::eqq_bool":"===","numops::eqq":"===","numops::neqq":"!==","numops::neq":"!="},n={"pxsim.Boolean_":"","pxsim.pxtcore":"","pxsim.String_":"","pxsim.ImageMethods":"","pxsim.Array_":"","pxsim.pxtrt":"","pxsim.numops":""},r={"pxsim.Array_.getAt":"","pxsim.Array_.length":"","pxsim.Array_.mk":"","pxsim.Array_.push":"","pxsim.Boolean_.bang":"","pxsim.String_.concat":"","pxsim.String_.stringConv":"","pxsim.numops.toBool":"","pxsim.numops.toBoolDecr":"","pxsim.pxtcore.mkAction":"","pxsim.pxtcore.mkClassInstance":"","pxsim.pxtrt.ldlocRef":"","pxsim.pxtrt.mapGetByString":"","pxsim.pxtrt.stclo":"","pxsim.pxtrt.stlocRef":""};function i(e){let t="";for(let n of Object.keys(e)){const r=n.replace(/\./g,"_");e[n]=r,t+=`const ${r} = ${n};\n`}return t}function s(e){"pxt."==(e=e.replace(/::/g,".")).slice(0,4)&&(e="pxtcore."+e.slice(4));const t="pxsim."+e;if(r.hasOwnProperty(t))return r[t];const i=t.lastIndexOf(".");if(i>0){const e=t.slice(0,i);if(n.hasOwnProperty(e))return n[e]+t.slice(i)}return t}e.isBuiltinSimOp=function(n){return!!e.U.lookup(t,n.replace(/\./g,"::"))},e.shimToJs=s;const o=["runtime","oops","doNothing","pxsim","globals","maybeYield","setupDebugger","isBreakFrame","breakpoint","trace","checkStack","leave","checkResumeConsumed","setupResume","setupLambda","checkSubtype","failedCast","buildResume","mkVTable","bind","leaveAccessor"];e.jsEmit=function(a,l){let c="(function (ectx) {\n'use strict';\n";for(let e of o)c+=`const ${e} = ectx.${e};\n`;c+="const __this = runtime;\n",c+="const pxtrt = pxsim.pxtrt;\n",c+="let yieldSteps = 1;\n",c+="ectx.setupYield(function() { yieldSteps = 100; })\n",c+="pxsim.setTitle("+JSON.stringify(a.getTitle())+");\n";let u={},d={};for(let e of l.configData||[])u[e.key+""]=e.value,d[e.name]=e.key;c+="pxsim.setConfigData("+JSON.stringify(u,null,1)+", "+JSON.stringify(d,null,1)+");\n",c+="pxtrt.mapKeyNames = "+JSON.stringify(a.ifaceMembers,null,1)+";\n";const p=a.setPerfCounters(["SysScreen"]);c+="__this.setupPerfCounters("+JSON.stringify(p,null,1)+");\n",c+=i(r),c+=i(n);let h=0,f=0;a.procs.forEach((n=>{let r;n.cachedJS?(r=n.cachedJS,h+=r.length):(r=function(n,r){if(r.cachedJS)return r.cachedJS;let i="",o=e=>{i+=e+"\n"},a=e=>{i+="    "+e+"\n"},l=e.ir.EK,c=[],u=0,d={},p="";o(`\nfunction ${r.label()}(s) {\nlet r0 = s.r0, step = s.pc;\ns.pc = -1;\n`),r.perfCounterNo&&o(`if (step == 0) __this.startPerfCounter(${r.perfCounterNo});\n`);o("\nwhile (true) {\nif (yieldSteps-- < 0 && maybeYield(s, step, r0) || runtime !== pxsim.runtime) return null;\nswitch (step) {\n  case 0:\n"),r.locals.forEach((e=>{a(`${b(e)} = undefined;`)})),r.args.length&&(a("if (s.lambdaArgs) {"),r.args.forEach(((e,t)=>{a(`  ${b(e)} = (s.lambdaArgs[${t}]);`)})),a("  s.lambdaArgs = null;"),a("}"));r.classInfo&&r.info.thisParameter&&(a("r0 = s.arg0;"),C(r.classInfo,"validate"));let h=0,f=[];for(let t of r.body)t.stmtKind==e.ir.SK.Label&&t.lblNumUses>0&&(t.lblId=++h);let m=0;for(let t of r.body){switch(t.stmtKind){case e.ir.SK.Expr:x(t.expr);break;case e.ir.SK.StackEmpty:O();break;case e.ir.SK.Jmp:let n=!1;for(let i=m+1;i<r.body.length&&r.body[i].stmtKind==e.ir.SK.Label;++i)if(t.lbl==r.body[i]){n=!0;break}v(t,n);break;case e.ir.SK.Label:t.lblNumUses>0&&o(`  case ${t.lblId}:`);break;case e.ir.SK.Comment:o(`// ${t.expr.data}`);break;case e.ir.SK.Breakpoint:y(t);break;default:e.oops()}m++}O(),r.perfCounterNo&&o(`__this.stopPerfCounter(${r.perfCounterNo});\n`);r.isGetter()?a("return leaveAccessor(s, r0)"):a("return leave(s, r0)");o("  default: oops()"),o("} } }");let _=e.nodeLocationInfo(r.action);_.functionName=r.getName(),_.argumentNames=r.args&&r.args.map((e=>e.getName())),o(`${r.label()}.info = ${JSON.stringify(_)}`),r.isGetter()&&o(`${r.label()}.isGetter = true;`);r.isRoot&&o(`${r.label()}.continuations = [ ${f.join(",")} ]`);return o(g(r.label()+"_mk",r.label(),u,Object.keys(d))),o(p),r.cachedJS=i,i;function g(e,t,n,r){let i="";i+=`\nfunction ${e}(s) {\n    checkStack(s.depth);\n    return {\n        parent: s, fn: ${t}, depth: s.depth + 1,\n        pc: 0, retval: undefined, r0: undefined, overwrittenPC: false, lambdaArgs: null,\n`;for(let e=0;e<n;++e)i+=`  tmp_${e}: undefined,\n`;for(let e of r)i+=`  ${e}: undefined,\n`;return i+="} }\n",i}function y(e){let t,i=e.breakpointInfo.id;if(a(`s.lastBrkId = ${i};`),n.breakpoints){t=++h;let s=`return breakpoint(s, ${t}, ${i}, r0);`;e.breakpointInfo.isDebuggerStmt?a(s):(a(`if ((breakpoints[0] && isBreakFrame(s)) || breakpoints[${i}]) ${s}`),n.trace&&a(`else return trace(${i}, s, ${t}, ${r.label()}.info);`))}else{if(!n.trace)return;t=++h,a(`return trace(${i}, s, ${t}, ${r.label()}.info);`)}o(`  case ${t}:`)}function b(e){if(e.isGlobal())return"globals."+e.uniqueName();if(e.iscap)return`s.caps[${e.index}]`;const t=e.uniqueName();return d[t]=!0,"s."+t}function v(t,n){if(t.lbl.lblNumUses==e.ir.lblNumUsesJmpNext||n)return e.assert(t.jmpMode==e.ir.JmpMode.Always),void(t.expr&&x(t.expr));e.assert(t.lbl.lblNumUses>0);let r=`{ step = ${t.lbl.lblId}; continue; }`;t.jmpMode==e.ir.JmpMode.Always?(t.expr&&x(t.expr),a(r)):(x(t.expr),t.jmpMode==e.ir.JmpMode.IfNotZero?a(`if (r0) ${r}`):a(`if (!r0) ${r}`))}function T(e){switch(e.exprKind){case l.NumberLiteral:case l.PointerLiteral:case l.SharedRef:case l.CellRef:return!0;default:return!1}}function k(e){return T(e)?E(e):(x(e),"r0")}function E(t){switch(t.exprKind){case l.NumberLiteral:if(!0===t.data)return"true";if(!1===t.data)return"false";if(null===t.data)return"null";if(void 0===t.data)return"undefined";if("number"==typeof t.data)return t.data+"";throw e.oops("invalid data: "+typeof t.data);case l.PointerLiteral:if(t.ptrlabel())return t.ptrlabel().lblId+"";if(null!=t.hexlit())return p+=`const ${t.data} = pxsim.BufferMethods.createBufferFromHex("${t.hexlit()}")\n`,t.data;if("string"==typeof t.jsInfo)return t.jsInfo;e.U.oops();case l.SharedRef:let n=t.args[0];e.U.assert(!!n.currUses),e.U.assert(n.currUses<n.totalUses),n.currUses++;let r=c.indexOf(n);return e.U.assert(r>=0),"s.tmp_"+r;case l.CellRef:return b(t.data);default:throw e.oops()}}function x(e){switch(e.exprKind){case l.JmpValue:a("// jmp value (already in r0)");break;case l.Nop:a("// nop");break;case l.FieldAccess:let t=e.data,n=t.shimName,r=k(e.args[0]);return n?void a(`r0 = ${r}${n};`):void a(`r0 = ${r}.fields["${t.name}"];`);case l.Store:return D(e.args[0],e.args[1]);case l.RuntimeCall:return A(e);case l.ProcCall:return w(e);case l.SharedDef:return I(e);case l.Sequence:return e.args.forEach(x);case l.InstanceOf:return x(e.args[0]),void C(e.data,e.jsInfo);default:a(`r0 = ${E(e)};`)}}function S(e,t="r0"){return`checkSubtype(${t}, ${`${e.id}_VT`})`}function C(t,n,r="r0"){"bool"==n?a(`r0 = ${S(t)};`):"validate"==n?a(`if (!${S(t,r)}) failedCast(${r});`):e.U.oops()}function I(t){let n=t.args[0];if(e.U.assert(n.totalUses>=1),e.U.assert(0===n.currUses),n.currUses=1,1==n.totalUses)return x(n);{const e=c.length;c.push(n);let t=k(n);"r0"!=t&&(t="r0 = "+t),a(`s.tmp_${e} = ${t};`)}}function A(n){let r=e.ir.flattenArgs(n.args);r.precomp.forEach(x);let i=n.data,l=r.flattened.map(E);if("langsupp::ignore"==i)return;let c="";if(c="."==i[0]?`${l[0]}${i}(${l.slice(1).join(", ")})`:"="==i[0]?`(${l[0]})${i.slice(1)} = (${l[1]})`:e.U.startsWith(i,"new ")?`new ${s(i.slice(4))}(${l.join(", ")})`:e.U.lookup(t,i)?2==l.length?`(${l[0]} ${e.U.lookup(t,i)} ${l[1]})`:`(${e.U.lookup(t,i)} ${l[0]})`:`${s(i)}(${l.join(", ")})`,0==n.callingConvention)a(`r0 = ${c};`);else{let e=++h;f.push(e),"String_::stringConv"==i&&a(`if ((${l[0]}) && (${l[0]}).vtable) {`),2==n.callingConvention?a(`(function(cb) { ${c}.then(cb) })(buildResume(s, ${e}));`):(a(`setupResume(s, ${e});`),a(`${c};`)),a("checkResumeConsumed();"),a("return;"),"String_::stringConv"==i&&a(`} else { s.retval = (${l[0]}) + ""; }`),o(`  case ${e}:`),a("r0 = s.retval;")}}function w(t){const i=t.data,s=i.proc;if(s&&s.inlineBody)return x(s.inlineSelf(t.args));const l=e.ir.rtcall("<frame>",[]);l.totalUses=1,l.currUses=0;const u=c.length;c.push(l);const d=`s.tmp_${u}`,p=++h,f=-1==i.virtualIndex;if(s)a(`${d} = ${s.label()}_mk(s);`);else{let s="generic";null!=i.ifaceIndex?s="if_"+n.ifaceMembers[i.ifaceIndex]:f?s="lambda":null!=i.virtualIndex?s=i.classInfo.id+"_v"+i.virtualIndex:e.U.oops();const o=t.args.length;s+="_"+o+"_mk",n.recordHelper(r.usingCtx,s,(()=>{const t=e.U.range(o).map((e=>"arg"+e));return g(s,"null",5,t)})),a(`${d} = ${s}(s);`)}t.args.forEach(((e,t)=>{let n=`arg${t}`;f&&(n=0==t?"argL":"arg"+(t-1)),a(`${d}.${n} = ${k(e)};`)}));let m=`s.pc = ${p}; return ${d};`;if(null!=i.callLocationIndex&&(m=`s.callLocIdx = ${i.callLocationIndex}; ${m}`),null!=i.ifaceIndex){e.U.assert(null==s);const r=n.ifaceMembers[i.ifaceIndex];e.U.assert(!!r,`no name for ${i.ifaceIndex}`),a(`if (!${d}.arg0.vtable.iface) {`);let o=t.args.map(((e,t)=>`${d}.arg${t}`));o.splice(1,0,JSON.stringify(r));const l=`pxsim_pxtrt.map${i.isSet?"Set":"Get"}ByString`;i.noArgs?a(`  s.retval = ${l}(${o.join(", ")});`):(e.U.assert(!i.isSet),a(`  setupLambda(${d}, ${l}(${o.slice(0,2).join(", ")}), ${t.args.length});`),a(`  ${m}`)),a("} else {"),a(`  ${d}.fn = ${d}.arg0.vtable.iface["${i.isSet?"set/":""}${r}"];`);let c=`${d}.arg0.fields["${r}"]`;i.isSet?(a(`  if (${d}.fn === null) { ${c} = ${d}.arg1; }`),a(`  else if (${d}.fn === undefined) { failedCast(${d}.arg0) } `)):i.noArgs?(a(`  if (${d}.fn == null) { s.retval = ${c}; }`),a(`  else if (!${d}.fn.isGetter) { s.retval = bind(${d}); }`)):(a(`  if (${d}.fn == null) { setupLambda(${d}, ${c}, ${t.args.length}); ${m} }`),a(`  else if (${d}.fn.isGetter) { ${d}.stage2Call = true; ${m}; }`)),a(` else { ${m} }`),a("}"),m=""}else if(-1==i.virtualIndex)e.U.assert(null==s),a(`setupLambda(${d}, ${d}.argL);`);else if(null!=i.virtualIndex){e.U.assert(null==s),e.assert(i.virtualIndex>=0),C(i.classInfo,"validate",d+".arg0");const t=i.classInfo.vtable[i.virtualIndex];a(`${d}.fn = ${d}.arg0.vtable.methods.${t.getName()};`)}else e.U.assert(null!=s);m&&a(m),o(`  case ${p}:`),a("r0 = s.retval;"),l.currUses=1}function N(t){switch(t){case 0:return"";case 1:return"pxtrt.toInt8";case 3:return"pxtrt.toInt16";case 5:return"pxtrt.toInt32";case 2:return"pxtrt.toUInt8";case 4:return"pxtrt.toUInt16";case 6:return"pxtrt.toUInt32";default:throw e.oops()}}function D(t,n){switch(t.exprKind){case l.CellRef:let r=t.data,i=k(n);a(`${b(r)} = ${N(r.bitSize)}(${i});`);break;case l.FieldAccess:let s=t.data,o=s.shimName;o||(o=`.fields["${s.name}"]`),x(e.ir.rtcall("="+o,[t.args[0],n]));break;default:e.oops()}}function O(){for(let t of c)t.totalUses!==t.currUses&&e.oops();u=Math.max(c.length,u),c=[]}}(a,n),f+=r.length),c+="\n"+r+"\n"})),c+=e.U.values(a.codeHelpers).join("\n")+"\n",a.usedClassInfos.forEach((t=>{c+=function(t){e.U.assert(void 0!==t.classNo),e.U.assert(void 0!==t.lastSubtypeNo);let n=parseInt(t.attrs.maxBgInstances);n||(n=null);let r=`const ${t.id}_VT = mkVTable({\n  name: ${JSON.stringify(e.getName(t.decl))},\n  numFields: ${t.allfields.length},\n  classNo: ${t.classNo},\n  lastSubtypeNo: ${t.lastSubtypeNo},\n  maxBgInstances: ${n},\n  methods: {\n`;for(let e of t.vtable)r+=`    "${e.getName()}": ${e.label()},\n`;r+="  },\n",r+="  iface: {\n";for(let e of t.itable)r+=`    "${e.name}": ${e.proc?e.proc.label():"null"},\n`,e.setProc?r+=`    "set/${e.name}": ${e.setProc.label()},\n`:e.proc||(r+=`    "set/${e.name}": null,\n`);return r+="  },\n",t.toStringMethod&&(r+="  toStringMethod: "+t.toStringMethod.label()+",\n"),r+="});\n",r}(t)})),l.breakpoints&&(c+=`\nconst breakpoints = setupDebugger(${l.breakpoints.length}, [${a.globals.filter((e=>e.isUserVariable)).map((e=>`"${e.uniqueName()}"`)).join(",")}])\n`),c+=`\nreturn ${a.procs[0]?a.procs[0].label():"null"}\n})\n`;const m=c.length,_=e=>(100*e/m).toFixed(2)+"%",g=`// total=${c.length} new=${_(f)} cached=${_(h)} other=${_(m-f-h)}\n`;a.writeFile(e.BINARY_JS,g+c)}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){e.thumbCmpMap={"numops::lt":"_cmp_lt","numops::gt":"_cmp_gt","numops::le":"_cmp_le","numops::ge":"_cmp_ge","numops::eq":"_cmp_eq","numops::eqq":"_cmp_eqq","numops::neq":"_cmp_neq","numops::neqq":"_cmp_neqq"};const t={"numops::adds":"_numops_adds","numops::subs":"_numops_subs","numops::orrs":"_numops_orrs","numops::eors":"_numops_eors","numops::ands":"_numops_ands","numops::lsls":"_numops_lsls","numops::asrs":"_numops_asrs","numops::lsrs":"_numops_lsrs","pxt::toInt":"_numops_toInt","pxt::fromInt":"_numops_fromInt"};class n extends e.AssemblerSnippets{stackAligned(){return e.target.stackAlign&&e.target.stackAlign>1}pushLR(){return this.stackAligned()?"push {lr, r5}  ; r5 for align":"push {lr}"}popPC(){return this.stackAligned()?"pop {pc, r5}  ; r5 for align":"pop {pc}"}nop(){return"nop"}mov(e,t){return`mov ${e}, ${t}`}helper_ret(){return"bx r4"}reg_gets_imm(e,t){return`movs ${e}, #${t}`}push_fixed(e){return"push {"+e.join(", ")+"}"}pop_fixed(e){return"pop {"+e.join(", ")+"}"}proc_setup(e,t){let n="";if(e>0){n+="    movs r0, #0\n";for(let t=0;t<e;++t)n+="    push {r0} ;loc\n"}return n}proc_return(){return"pop {pc}"}debugger_stmt(t){return e.oops(),`\n    @stackempty locals\n    ldr r0, [r6, #0] ; debugger\n    subs r0, r0, #4  ; debugger\n${t}:\n    ldr r0, [r0, #0] ; debugger\n`}debugger_bkpt(t){return e.oops(),`\n    @stackempty locals\n    ldr r0, [r6, #0] ; brk\n${t}:\n    ldr r0, [r0, #0] ; brk\n`}debugger_proc(t){return e.oops(),`\n    ldr r0, [r6, #0]  ; brk-entry\n    ldr r0, [r0, #4]  ; brk-entry\n${t}:`}push_local(e){return`push {${e}}`}push_locals(e){return`sub sp, #4*${e} ; push locals ${e} (align)`}pop_locals(e){return`add sp, #4*${e} ; pop locals ${e}`}unconditional_branch(e){return"bb "+e}beq(e){return"beq "+e}bne(e){return"bne "+e}cmp(e,t){return"cmp "+e+", "+t}cmp_zero(e){return"cmp "+e+", #0"}load_reg_src_off(e,t,n,r,i,s){n=n.replace(/:\d+$/,""),r&&(n=`#4*${n}`);let o="str",a="ldr";return s&&(32==s.immLimit?o="strb":64==s.immLimit&&(o="strh"),a=s.needsSignExt?o.replace("str","ldrs"):o.replace("str","ldr")),i?`${o} ${e}, [${t}, ${n}]`:`${a} ${e}, [${t}, ${n}]`}rt_call(e,t,n){return e+" "+t+", "+n}alignedCall(e,t){return t?`${this.push_locals(t)}\nbl ${e}\n${this.pop_locals(t)}`:"bl "+e}call_lbl(n,r,i){let s=e.U.lookup(t,n);return s&&(n=s,r=!1),!r&&n.indexOf("::")>0&&(r=!0),r?this.callCPP(n,i):this.alignedCall(n,i)}call_reg(e){return"blx "+e}helper_prologue(){return`\n    @stackmark args\n    ${this.pushLR()}\n`}helper_epilogue(){return`\n    ${this.popPC()}\n    @stackempty args\n`}load_ptr_full(t,n){return e.assert(!!t),`\n    ldlit ${n}, ${t}\n`}load_vtable(e,t){return`ldr ${e}, [${t}, #0]`}lambda_init(){return"\n    mov r5, r0\n    mov r4, lr\n    bl pxtrt::getGlobalsPtr\n    mov r6, r0\n    bx r4\n"}saveThreadStack(){return"mov r7, sp\n    str r7, [r6, #4]\n"}restoreThreadStack(){return e.target.switches.gcDebug?"movs r7, #0\n    str r7, [r6, #4]\n":""}callCPPPush(e){return this.pushLR()+"\n"+this.callCPP(e)+"\n"+this.popPC()+"\n"}callCPP(e,t){return this.saveThreadStack()+this.alignedCall(e,t)+"\n"+this.restoreThreadStack()}inline_decr(e){return`\n    lsls r1, r0, #30\n    bne .tag${e}\n    bl _pxt_decr\n.tag${e}:\n`}arithmetic(){let t="";const n=e=>{let t=".boxed:\n";return t+=`\n                    ${this.pushLR()}\n                    push {r0, r1}\n                    ${this.saveThreadStack()}\n                    ${e}\n                    ${this.restoreThreadStack()}\n                    add sp, #8\n                    ${this.popPC()}\n                `,t},r=e=>{t+=`\n_numops_${e}:\n    @scope _numops_${e}\n    lsls r2, r0, #31\n    beq .boxed\n    lsls r2, r1, #31\n    beq .boxed\n`},i=e=>{t+="    blx lr\n",t+=n(`bl numops::${e}`)};for(let e of["adds","subs"])r(e),t+=`\n    subs r2, r1, #1\n    ${e} r2, r0, r2\n    bvs .boxed\n    movs r0, r2\n`,i(e);for(let e of["ands","orrs","eors"])r(e),t+=`    ${e} r0, r1\n`,"eors"==e&&(t+="    adds r0, r0, #1\n"),i(e);for(let e of["lsls","lsrs","asrs"])r(e),t+="\n    ; r3 := (r1 >> 1) & 0x1f\n    lsls r3, r1, #26\n    lsrs r3, r3, #27\n","asrs"==e?t+="\n    asrs r0, r3\n    movs r2, #1\n    orrs r0, r2\n":(t+="lsrs"==e?"\n    asrs r2, r0, #1\n    lsrs r2, r3\n    lsrs r3, r2, #30\n    bne .boxed\n":"\n    asrs r2, r0, #1\n    lsls r2, r3\n    lsrs r3, r2, #30\n    beq .ok\n    cmp r3, #3\n    bne .boxed\n.ok:\n",t+="\n    lsls r0, r2, #1\n    adds r0, r0, #1\n"),i(e);t+=`\n@scope _numops_toInt\n_numops_toInt:\n    asrs r0, r0, #1\n    bcc .over\n    blx lr\n.over:\n    lsls r0, r0, #1\n    ${this.callCPPPush("pxt::toInt")}\n\n_numops_fromInt:\n    lsls r2, r0, #1\n    asrs r1, r2, #1\n    cmp r0, r1\n    bne .over2\n    adds r0, r2, #1\n    blx lr\n.over2:\n    ${this.callCPPPush("pxt::fromInt")}\n`;for(let r of Object.keys(e.thumbCmpMap))r=r.replace(/.*::/,""),t+=`\n.section code\n.object _pxt_helper_cmp_${r}\n_cmp_${r}:\n    lsls r2, r0, #31\n    beq .boxed\n    lsls r2, r1, #31\n    beq .boxed\n    subs r0, r1\n    b${r.replace("qq","q").replace("neq","ne")} .true\n.false:\n    movs r0, #0\n    bx lr\n.true:\n    movs r0, #1\n    bx lr\n`,t+=n(`\n                        bl numops::${r}\n                        bl numops::toBoolDecr\n                        cmp r0, #0`);return t}emit_int(t,n){let r=!1;function i(t){e.assert(0<=t&&t<=255);let i="";return r?t&&(i=`adds ${n}, #${t}\n`):i=`movs ${n}, #${t}\n`,r=!0,i}function s(e=8){return`lsls ${n}, ${n}, #${e}\n`}e.assert(null!=t);let o=Math.floor(t),a=!1;o<0&&(a=!0,o=-o);let l=0;if(o>255){let t=o;for(;0==(1&t);)t>>>=1,l++;e.numBytes(t)<e.numBytes(o)?o=t:l=0}let c="";switch(e.numBytes(o)){case 4:c+=i(o>>>24&255),c+=s();case 3:c+=i(o>>>16&255),c+=s();case 2:c+=i(o>>>8&255),c+=s();case 1:c+=i(255&o);break;default:e.oops()}return l&&(c+=s(l)),a&&(c+=`negs ${n}, ${n}\n`),c.split("\n").length>4?`ldlit ${n}, ${Math.floor(t)}\n`:c}}e.ThumbSnippets=n}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){const n={"pxtrt::mapSetGeneric":"mapset","pxtrt::mapGetGeneric":"mapget"},r={};function i(e,n,r){const i=t.computeHashMultiplier(e.itable.map((e=>e.idx))),s=t.U.toArray(i.mapping);for(;3&s.length;)s.push(0);let o=`\n${l(e)}_start:\n        .short ${8*e.allfields.length+8}  ; size in bytes\n        .byte ${pxt.ValTypeObject}, ${pxt.VTABLE_MAGIC} ; magic\n        .short ${s.length} ; entries in iface hashmap\n        .short ${e.lastSubtypeNo||e.classNo} ; last sub class-id\n        .short ${e.classNo} ; class-id\n        .short 0 ; reserved\n        .word ${i.mult} ; hash-mult\n`;c()?o+="\n            .word pxt::RefRecord_destroy\n            .word pxt::RefRecord_print\n            .word pxt::RefRecord_scan\n            .word pxt::RefRecord_gcsize\n            .word 0,0,0,0 ; keep in sync with VM_NUM_CPP_METHODS\n":o+="\n            .word 0,0, 0,0, 0,0, 0,0 ; space for 4 (VM_NUM_CPP_METHODS) native methods\n",o+=`\n        .balign 4\n${e.id}_IfaceVT:\n`;const a=s.length>>2;let u="",d=a,p={};for(let t of e.itable){p[t.idx+""]=d;const e=t.proc?t.proc.isGetter()?1:2:0;u+=`  .short ${t.idx}, ${e} ; ${t.name}\n`,u+=`  .word ${t.proc?t.proc.vtLabel()+"@fn":t.info}\n`,d+=1,t.setProc&&(u+=`  .short ${t.idx}, 2 ; set ${t.name}\n`,u+=`  .word ${t.setProc.vtLabel()}@fn\n`,d+=1)}u+="  .word 0, 0, 0, 0 ; the end\n",d+=1;for(let e=0;e<s.length;++e)r.itEntries++,s[e]&&r.itFullEntries++;return o+="  .short "+t.U.toArray(s).map(((e,t)=>p[e+""]||a)).join(", ")+"\n",o+=u,o+="\n",o}let s;function o(e){const t=e.getTime()/1e3;return`${t>>>0}, ${t/4294967296|0}`}!function(e){e[e.Invalid=0]="Invalid",e[e.InfoHeader=1]="InfoHeader",e[e.OpCodeMap=2]="OpCodeMap",e[e.NumberLiterals=3]="NumberLiterals",e[e.ConfigData=4]="ConfigData",e[e.IfaceMemberNames=5]="IfaceMemberNames",e[e.NumberBoxes=6]="NumberBoxes",e[e.Function=32]="Function",e[e.Literal=33]="Literal",e[e.VTable=34]="VTable"}(s||(s={}));let a={};function l(e){return e.classNo||(a[e.id]=e),e.id+"_VT"}function c(){return t.target.useESP}function u(e){return c()?`0xffffffff, ${e}`:`0xffffffff, 0xffffffff ; -> ${e}`}t.vmEmit=function(d,p,h){let f=`; VM start\n_img_start:\n${t.hexfile.hexPrelude()}\n`;a={};const m={dblText:[],dblBoxText:[],dbls:{},opcodeMap:{},opcodes:t.vm.opcodes.map((e=>"pxt::op_"+e.replace(/ .*/,"")))};for(m.opcodes.unshift(null);m.opcodes.length<128;)m.opcodes.push(null);let _=0;function g(e,t,n,r,i=0){if(f+=`\n; --- ${e}\n.section code\n    .set ${e} = ${_}\n`,r)for(let e of r)f+=`    .set ${e} = ${_}\n`;f+=`\n_start_${e}:\n    .byte ${t}, 0x00\n    .short ${i}\n    .word _end_${e}-_start_${e}\n`,f+=n(),f+=`\n.balign 8\n_end_${e}:\n`,_++}const y=new Date(0);let b=t.U.toUTF8(p.name,!0);b.length>100&&(b=b.slice(0,100));let v=b.length+1;1&v&&v++;const T=128-v;g("_info",s.InfoHeader,(()=>`\n                ; magic - \\0 added by assembler\n                .string "\\nPXT64\\n"\n                .hex 5471fe2b5e213768 ; magic\n                .hex ${t.hexfile.hexTemplateHash()} ; hex template hash\n                .hex 0000000000000000 ; @SRCHASH@\n                .word ${d.globalsWords}   ; num. globals\n                .word ${d.nonPtrGlobals} ; non-ptr globals\n                .word 0, 0 ; last usage time\n                .word ${o(y)} ; installation time\n                .word ${o(y)} ; publication time - TODO\n                .word _img_end-_img_start ; total image size\n                .space 60 ; reserved\n                .string ${JSON.stringify(b)}\n                .space ${T} ; pad to 128 bytes\n`)),d.procs.forEach((e=>{g(e.label(),s.Function,(()=>function(e,i,s){let o="";const a=e=>{o+=e+"\n"},d=e=>{o+="    "+e+"\n"},p=t.ir.EK;let h=[],f=[],m=!1,_=0,g=0;const y=8388607;pxt.options.debug&&console.log("EMIT",s.toString());b(),o="";for(let e of h)e.reset();return m=!0,t.U.assert(0==g),b(),o;function b(){a(`;\n; ${s.getFullName()}\n;`),d(".section code"),i.procs[0]==s&&a("; main"),d(`.word ${u("pxt::RefAction_vtable")}`),d(`.short 0, ${s.args.length} ; #args`),d(`.short ${s.captured.length}, 0 ; #cap`),d(".word .fnstart-_img_start, 0  ; func+possible padding"),_=s.locals.length+f.length,d(".fnstart:"),d(`pushmany ${_} ; incl. ${f.length} tmps`);for(let e of s.body)switch(e.stmtKind){case t.ir.SK.Expr:S(e.expr);break;case t.ir.SK.StackEmpty:w();for(let e of f)e&&t.oops(`uses: ${e.currUses}/${e.totalUses} ${e.toString()}`);break;case t.ir.SK.Jmp:v(e);break;case t.ir.SK.Label:a(`${e.lblName}:`);break;case t.ir.SK.Comment:a(`; ${e.expr.data}`);break;case t.ir.SK.Breakpoint:break;default:t.oops()}d(`ret ${s.args.length}, ${_}`)}function v(e){let n=e.lbl.lblName;e.jmpMode==t.ir.JmpMode.Always?(e.expr&&S(e.expr),d(`jmp ${n}`)):(S(e.expr),e.jmpMode==t.ir.JmpMode.IfNotZero?d(`jmpnz ${n}`):e.jmpMode==t.ir.JmpMode.IfZero?d(`jmpz ${n}`):t.oops())}function T(e){if(e.isGlobal())return t.U.assert(0==(3&e.index)),"glb "+(e.index>>2)+` ; ${e.getName()}`;if(e.iscap)return"cap "+e.index+` ; ${e.getName()}`;if(e.isarg){let n=s.args.length-e.index-1;return t.assert(n>=0,"arg#"+n),`loc ${g+_+2+n} ; ${e.getName()}`}{let n=e.index+f.length;return t.assert(!m||n<_,"cell#"+n),t.assert(n>=0,"cell#"+n),`loc ${g+n}`}}function k(n){const r=t.hexfile.lookupFunc(n);r||t.U.oops("missing function: "+n);let i=e.opcodeMap[r.name];null==i&&(i=e.opcodes.length,e.opcodes.push(r.name),e.opcodeMap[r.name]=i,r.value=i),d(`callrt ${n}`)}function E(e,n){"bool"==n?d(`checkinst ${l(e)}`):t.U.oops()}function x(n){switch(n.exprKind){case p.NumberLiteral:const r=t.taggedSpecial(n.data);if(null!=r)d(`ldspecial ${r} ; ${n.data}`);else{let r=n.data,i=0,s=0;const o=r<<1>>1!=r;if((0|r)==r){if(Math.abs(r)<=y)return void d(r<0?"ldintneg "+-r:`ldint ${r}`);i=(r<<1|1)>>>0,s=r<0?1:0}else{let e=new Float64Array(1);e[0]=r;let t=new Uint32Array(e.buffer);t[1]+=65536,i=t[0],s=t[1]}let a=i+","+s,l=t.U.lookup(e.dbls,a);if(null==l){if(l=e.dblText.length,e.dblText.push(`.word ${i}, ${s}  ; ${l}: ${n.data}`),o){const t="pxt::number_vt";e.dblBoxText.push(`.word ${c()?t:`0xffffffff ; ${t}`}\n`);let n=new Float64Array(1);n[0]=r;let i=new Uint32Array(n.buffer);e.dblBoxText.push(`.word ${i[0]}, ${i[1]} ; ${r}\n`)}e.dbls[a]=l}d(`ldnumber ${l} ; ${n.data}`)}return;case p.PointerLiteral:return void d(`ldlit ${n.data}`);case p.SharedRef:let i=n.args[0];(!i.currUses||i.currUses>=i.totalUses)&&(console.log(i.sharingInfo()),t.U.assert(!1)),i.currUses++;let s=f.indexOf(i);return s<0&&(console.log(f,i),t.assert(!1)),d(`ldloc ${s+g}`+(i.currUses==i.totalUses?" ; LAST":"")),void w();case p.CellRef:return void d("ld"+T(n.data));case p.InstanceOf:S(n.args[0]),E(n.data,n.jsInfo);break;default:throw t.oops("kind: "+n.exprKind)}}function S(e){switch(e.exprKind){case p.JmpValue:d("; jmp value (already in r0)");break;case p.Nop:d("; nop");break;case p.FieldAccess:let t=e.data;S(e.args[0]),d(`ldfld ${t.idx}, ${l(t.classInfo)}`);break;case p.Store:return D(e.args[0],e.args[1]);case p.RuntimeCall:return A(e);case p.ProcCall:return N(e);case p.SharedDef:return C(e);case p.Sequence:return e.args.forEach(S);default:return x(e)}}function C(e){let n=e.args[0];if(t.U.assert(n.totalUses>=1),t.U.assert(0===n.currUses),n.currUses=1,h.push(n),1==n.totalUses)return S(n);{S(n);let e=-1;for(let t=0;t<f.length;++t)if(null==f[t]){e=t;break}e<0?(m&&(console.log(n,f),t.assert(!1,"missed tmp")),e=f.length,f.push(n)):f[e]=n,d(`stloc ${e+g}`)}}function I(){d("push"),g++}function A(e){let i=e.data;if("pxt::beginTry"==i)return void d(`try ${e.args[0].data}`);i=t.U.lookup(r,i)||i,w();let s=t.U.lookup(n,i),o=e.args,a=0;if("pxt::mkClassInstance"!=i){for(let e=0;e<o.length;++e)S(o[e]),e<o.length-1&&(I(),a++);"langsupp::ignore"==i?a&&d(`popmany ${a} ; ignore`):s?d(s):k(i),g-=a}else d(`newobj ${o[0].data}`)}function w(){for(let e=0;e<f.length;++e){let t=f[e];t&&t.currUses==t.totalUses&&(m||h.push(t),f[e]=null)}}function N(e){let n=e.data,r=n.proc;if(r&&r.inlineBody){const t=r.inlineSelf(e.args);return pxt.options.debug&&console.log("INLINE",e.toString(),"->",t.toString()),S(t)}let s=0;const o=e.args.slice(),a=-1==n.virtualIndex?o.shift():null;for(let e of o)S(e),I(),s++;let l=o.length;if(a)S(a),d(`callind ${l}`);else if(null!=n.ifaceIndex){let e=n.ifaceIndex+" ; ."+i.ifaceMembers[n.ifaceIndex];n.isSet?(d(`callset ${e}`),t.U.assert(2==l)):n.noArgs?(d(`callget ${e}`),t.U.assert(1==l)):d(`calliface ${l}, ${e}`)}else null!=n.virtualIndex?t.U.oops():d(`callproc ${r.label()}`);g-=s}function D(e,n){switch(e.exprKind){case p.CellRef:S(n);let r=e.data,i="st"+T(r);if(r.isGlobal()&&0!=r.bitSize){const e=t.sizeOfBitSize(r.bitSize)|(t.isBitSizeSigned(r.bitSize)?16:0);d("bitconv "+e)}d(i);break;case p.FieldAccess:let s=e.data;S(e.args[0]),I(),S(n),d(`stfld ${s.idx}, ${l(s.classInfo)}`),g--;break;default:t.oops()}}}(m,d,e)),[e.label()+"_Lit"])})),f+="_code_end:\n\n",f+="_helpers_end:\n\n",d.usedClassInfos.forEach((e=>{g(l(e),s.VTable,(()=>i(e,0,d)))})),t.U.values(a).forEach((e=>{e.itable=[],e.classNo=65520,g(l(e),s.VTable,(()=>i(e,0,d)))})),a={};let k=0;g("ifaceMemberNames",s.IfaceMemberNames,(()=>`    .word ${d.ifaceMembers.length} ; num. entries\n`+d.ifaceMembers.map((e=>`    .word ${d.emitString(e)}  ; ${k++} .${e}`)).join("\n"))),f+="_vtables_end:\n\n",t.U.iterMap(d.hexlits,((e,n)=>{g(n,s.Literal,(()=>`.word ${u("pxt::buffer_vt")}\n`+t.hexLiteralAsm(e)),[],pxt.BuiltInType.BoxedBuffer)})),t.U.unique(d.ifaceMembers.concat(Object.keys(d.strings)),(e=>e)).forEach((e=>{const n=t.utf8AsmStringLiteral(e);let r=pxt.BuiltInType.BoxedString;"pxt::string_inline_ascii_vt"==n.vt?r=pxt.BuiltInType.BoxedString_ASCII:"pxt::string_skiplist16_packed_vt"==n.vt?r=pxt.BuiltInType.BoxedString_SkipList:"pxt::string_inline_utf8_vt"==n.vt?r=pxt.BuiltInType.BoxedString:t.oops("invalid vt");const i=`.word ${u(n.vt)}\n`+n.asm;g(d.strings[e],s.Literal,(()=>i),[],r)})),g("numberBoxes",s.NumberBoxes,(()=>m.dblBoxText.join("\n")+"\n.word 0, 0, 0 ; dummy entry to make sure not empty")),g("numberLiterals",s.NumberLiterals,(()=>m.dblText.join("\n")+"\n.word 0, 0 ; dummy entry to make sure not empty"));const E=h.configData||[];g("configData",s.ConfigData,(()=>E.map((e=>`    .word ${e.key}, ${e.value}  ; ${e.name}=${e.value}`)).join("\n")+"\n    .word 0, 0"));let x=m.opcodes.map((e=>null==e?"":e)).join("\0")+"\0",S="";for(;x;){let e=x.slice(0,64);x=x.slice(64),1&e.length&&(e+="\0"),S+=".hex "+t.U.toHex(t.U.stringToUint8Array(e))+"\n"}g("opcodeMap",s.OpCodeMap,(()=>S)),f+="_literals_end:\n",f+="_img_end:\n",f+="\n; The end.\n",d.writeFile(t.BINARY_ASM,f);let C=t.assemble(p.target,d,f);const I=C.thumbFile.getSourceMap(),A=function(e){const n=[83,82,67,77,136,21,78,45,170,134,153,113,0,0,0,0];for(const r of Object.keys(e)){for(const e of t.U.stringToUint8Array(r))n.push(e);n.push(0);const s=e[r];let o=0,a=0;for(let e=0;e<s.length;e+=3)i(s[e]-o),i(s[e+1]-a>>1),i(s[e+2]>>1),o=s[e],a=s[e+1];n.push(255)}n.push(0),1&n.length&&n.push(0);const r=[];for(let e=0;e<n.length;e+=2)r.push(n[e]|n[e+1]<<8);return r;function i(e){if(0<=e&&e<240)n.push(e);else{let t=240;e<0&&(e=-e,t|=8);const r=n.length;n.push(null);let i=0;for(;0!=e;)n.push(255&e),e>>>=8,i++;n[r]=t|i}}}(I);C.src&&d.writeFile(t.BINARY_ASM,`; srcmap size: ${A.length<<1} bytes\n`+C.src);{let e="";for(let t of C.buf)e+=String.fromCharCode(255&t,t>>8);const n=t.U.sha256(e);for(let e=0;e<4;++e)C.buf[16+e]=parseInt(n.slice(4*e,4*e+4),16);I.__meta={name:p.name,programHash:C.buf[16]|C.buf[17]<<16}}if(d.writeFile(t.BINARY_SRCMAP,JSON.stringify(I)),pxt.options.debug){let e=C.thumbFile.peepCounts,t=Object.keys(e);t.sort(((t,n)=>e[n]-e[t]));for(let n of t.slice(0,50))console.log(`${n}  ${e[n]}`)}if(C.buf){let n="";const r=C.buf;for(;15&r.length;)r.push(0);t.U.pushRange(r,A);for(let e of r)n+=String.fromCharCode(255&e,e>>8);if(n=e.pxtc.encodeBase64(n),c()){d.writeFile(t.BINARY_PXT64,n);const i=t.hexfile.patchHex(d,r,!1,!!t.target.useUF2)[0];d.writeFile(pxt.outputName(t.target),e.pxtc.encodeBase64(i))}else d.writeFile(pxt.outputName(t.target),n)}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){let r,i;!function(e){e.DecompileLiterals="decompileLiterals",e.TaggedTemplate="taggedTemplate",e.DecompileIndirectFixedInstances="decompileIndirectFixedInstances",e.DecompileArgumentAsString="decompileArgumentAsString"}(r=n.DecompileParamKeys||(n.DecompileParamKeys={})),function(e){e[e.SingleLine=0]="SingleLine",e[e.MultiLine=1]="MultiLine"}(i=n.CommentKind||(n.CommentKind={})),n.FILE_TOO_LARGE_CODE=9266,n.DECOMPILER_ERROR=9267;const s=e.SyntaxKind,o=/^[^\f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]*$/,a=/^(?:Array<(.+)>)|(?:(.+)\[\])$/,l="math_number",c="math_number_minmax",u="math_integer",d="math_whole_number",p="text",h="logic_boolean",f={"+":{type:"math_arithmetic",op:"ADD"},"-":{type:"math_arithmetic",op:"MINUS"},"/":{type:"math_arithmetic",op:"DIVIDE"},"*":{type:"math_arithmetic",op:"MULTIPLY"},"**":{type:"math_arithmetic",op:"POWER"},"%":{type:"math_modulo",leftName:"DIVIDEND",rightName:"DIVISOR"},"<":{type:"logic_compare",op:"LT"},"<=":{type:"logic_compare",op:"LTE"},">":{type:"logic_compare",op:"GT"},">=":{type:"logic_compare",op:"GTE"},"==":{type:"logic_compare",op:"EQ"},"===":{type:"logic_compare",op:"EQ"},"!=":{type:"logic_compare",op:"NEQ"},"!==":{type:"logic_compare",op:"NEQ"},"&&":{type:"logic_operation",op:"AND"},"||":{type:"logic_operation",op:"OR"}},m=/^\s*\/\/\s*(.*)$/,_=/^\s*(?:(?:(?:\/\*\*?)|(?:\*))(?!\/))?\s*(.*?)(?:\*?\*\/)?$/;class g{constructor(e){this.renames=e,this.renames.sort(((e,t)=>e.span.start-t.span.start))}getRenamesInSpan(e,t){const n=[];for(const r of this.renames){if(r.span.start>t)break;r.span.start>=e&&n.push(r)}return n}getRenameForPosition(e){for(const t of this.renames){if(t.span.start>e)return;if(t.span.start===e)return t}}}function y(e,t,n=!0){if(1===e.length&&"x"!==e&&"y"!==e&&"z"!==e){const r=e.charCodeAt(0);if(r>=97&&r<=122){const e=r-97;for(let r=1;r<26;r++){const i=String.fromCharCode(97+(e+r)%26);if("x"!==i&&"y"!==i&&"z"!==i&&!t[i])return n&&(t[i]=!0),i}}}for(let r=2;;r++){const i=e+r;if(!t[i])return n&&(t[i]=!0),i}}let b;function v(n,i,o=!1,a=!1){switch(n.kind){case s.WhileStatement:case s.IfStatement:case s.Block:return;case s.ExpressionStatement:return v(n.expression,i,o,a);case s.VariableStatement:return function(e,t){for(const n of e.declarationList.declarations){const e=l(n,t);if(e)return e}return}(n,i);case s.CallExpression:return function(n,i,o=!1,a=!1){const l=t.pxtInfo(n).callInfo;if(!l)return t.Util.lf("Function call not supported in the blocks");const c=i.attrs(l);let u;e.isIdentifier(n.expression)&&(u=i.declaredFunctions[n.expression.text]);if(!o&&l.isExpression&&!u){if(i.aliasBlocks[l.qName])l.decompilerBlockAlias=i.aliasBlocks[l.qName];else if(!i.opts.snippetMode)return t.Util.lf("No output expressions as statements")}if("Math.pow"==l.qName)return;if(pxt.Util.startsWith(l.qName,"Math.")){if(M(l.qName.substring(5)))return}if(c.blockId===t.PAUSE_UNTIL_TYPE){const e=n.arguments[0];if(1===n.arguments.length&&y(e))return;return t.Util.lf("Predicates must be inline expressions that return a value")}const d=N(l,c);if(d&&!c.handlerStatement&&!a)return t.Util.lf("Events must be top level");if(!c.blockId||!c.block){const e=pxt.blocks.builtinFunctionInfo[l.qName];if(!e)return u?u.parameters.length!==l.args.length?t.Util.lf("Function calls in blocks must have the same number of arguments as the function definition"):void 0:t.Util.lf("Call statements must have a valid declared function");c.blockId=e.blockId}const p=R(l,i.blocks),h=i.blocks.apis.byQName[l.qName],f=pxt.blocks.compileInfo(h),m=f.parameters.length+(f.thisParameter?1:0);if(c.imageLiteral||c.gridLiteral){if(l.args.length-m>1)return t.Util.lf("Function call has more arguments than are supported by its block");let e=n.arguments[0];if(e.kind!=s.StringLiteral&&e.kind!=s.NoSubstitutionTemplateLiteral)return t.Util.lf("Only string literals supported for image literals");const r=(e.text||"").replace(/\s+/g,""),i=c.imageLiteralRows||5,o=(c.imageLiteralColumns||5)*(c.imageLiteral||c.gridLiteral),a=o*i;return o*i!=r.length?t.Util.lf("Invalid image pattern ({0} expected vs {1} actual)",a,r.length):void 0}const _=l.args.length-m;if(_>0&&!g()){let e=_;if(d&&e--,c.defaultInstance&&e--,e>0)return t.Util.lf("Function call has more arguments than are supported by its block")}if(f.parameters.length||d){let e;const t=c.defaultInstance||!!f.thisParameter;if(p.forEach(((n,r)=>{e||t&&0===r||(t&&r--,e=b(n))})),e)return e}if(h){const e=i.blocks.apis.byQName[h.namespace];if(e&&e.attributes.fixedInstances&&!e.attributes.decompileIndirectFixedInstances&&l.args.length){const e=t.pxtInfo(l.args[0]).callInfo;if(!e||!i.attrs(e).fixedInstance)return t.Util.lf("Fixed instance APIs can only be called directly from the fixed instance")}}return;function g(){if(c.mutatePropertyEnum&&2===_&&l.args.length>=2){const e=l.args[l.args.length-2],t=l.args[l.args.length-1];if(e.kind===s.ArrayLiteralExpression&&O(t)){const n=[];if(!e.elements.some((e=>e.kind!==s.PropertyAccessExpression||e.expression.kind!==s.Identifier||(n.push(e.name.text),e.expression.text!==c.mutatePropertyEnum)))){const e=x(t);if(e){const t=e[0];return t.length===n.length&&!n.some((e=>-1===t.indexOf(e)))}}}}return!1}function y(e){if(e.kind!==s.FunctionExpression&&e.kind!==s.ArrowFunction)return!1;const n=e;if(function(e){switch(e.kind){case s.BinaryExpression:{const t=e.operatorToken.kind;return t!=s.PlusEqualsToken&&t!=s.MinusEqualsToken&&t!=s.EqualsToken}case s.PrefixUnaryExpression:{const t=e.operator;return t!=s.PlusPlusToken&&t!=s.MinusMinusToken}case s.PostfixUnaryExpression:{const t=e.operator;return t!=s.PlusPlusToken&&t!=s.MinusMinusToken}case s.CallExpression:{const n=t.pxtInfo(e).callInfo;return t.assert(!!n),n.isExpression}case s.Identifier:case s.ParenthesizedExpression:case s.NumericLiteral:case s.StringLiteral:case s.NoSubstitutionTemplateLiteral:case s.TrueKeyword:case s.FalseKeyword:case s.NullKeyword:case s.TaggedTemplateExpression:return!0;default:return!1}}(n.body))return!0;const r=n.body;if(1===r.statements.length){if(I(r.statements[0]).kind===s.ReturnStatement)return!0}return!1}function b(e){const n=I(e.value),o=e.info,a=e.param;if(o.isEnum){if(l(n))return;if(n.kind===s.CallExpression){const e=t.pxtInfo(n).callInfo,r=i.attrs(e);if(e&&"TD_ID"===r.shim&&e.args&&1===e.args.length){if(l(I(e.args[0])))return}}else if(n.kind===s.Identifier){const e=t.pxtInfo(n).commentAttrs;if(e&&e.enumIdentity)return}return t.Util.lf("Enum arguments may only be literal property access expressions")}if(D(n)&&(a.fieldEditor||a.shadowBlockId)){let e=!(!a.fieldOptions||!a.fieldOptions[r.DecompileLiterals]);if(!e&&a.shadowBlockId){const t=i.blocks.blocksById[a.shadowBlockId];if(t&&t.parameters&&t.parameters.length){const n=t.parameters[0].name;e=!t.attributes.paramFieldEditorOptions||!t.attributes.paramFieldEditorOptions[n]||!!t.attributes.paramFieldEditorOptions[n][r.DecompileLiterals]}else e=!0}if(!e)return t.Util.lf("Field editor does not support literal arguments")}else if(n.kind===s.TaggedTemplateExpression&&a.fieldEditor){let e=a.fieldOptions&&a.fieldOptions[r.TaggedTemplate];if(!e)return t.Util.lf("Tagged templates only supported in custom fields with param.fieldOptions.taggedTemplate set");const i=I(n.tag).getText(),o=e.split(";").map((e=>e.trim()));if(-1===o.indexOf(i))return t.Util.lf("Function only supports template literals with tag '{0}'",o.join(", "));if(n.template.kind!==s.NoSubstitutionTemplateLiteral)return t.Util.lf("Tagged template literals cannot have substitutions")}else if(n.kind===s.ArrowFunction){const e=n;if(e.parameters.length)if("objectdestructuring"===c.mutate){const n=I(e.parameters[0]);if(n.kind===s.Parameter&&n.name.kind!==s.ObjectBindingPattern)return t.Util.lf("Object destructuring mutation callbacks can only have destructuring patters as arguments")}else for(const n of e.parameters)if(n.name.kind!==s.Identifier)return t.Util.lf("Only identifiers allowed as function arguments")}else if(i.blocks.apis.byQName[o.type]){if(i.blocks.apis.byQName[o.type].attributes.fixedInstances){if(P(a))return;if(a.shadowBlockId){const e=i.blocks.blocksById[a.shadowBlockId];if(e){const t=pxt.blocks.compileInfo(e);if(t.parameters&&P(t.parameters[0]))return}}const e=t.pxtInfo(n).callInfo;if(e&&i.attrs(e).fixedInstance)return;return t.Util.lf("Arguments of a fixed instance type must be a reference to a fixed instance declaration")}}return;function l(e){const t=o.type.split("."),n=[];for(;e.kind===s.PropertyAccessExpression;)n.unshift(e.name.text),e=e.expression;if(e.kind!==s.Identifier)return!1;n.unshift(e.text);for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}}}(n,i,o,a);case s.VariableDeclaration:return l(n,i);case s.PostfixUnaryExpression:case s.PrefixUnaryExpression:return function(e){if(e.operand.kind!=s.Identifier)return t.Util.lf("-- and ++ may only be used on an identifier");if(e.operator!==s.PlusPlusToken&&e.operator!==s.MinusMinusToken)return t.Util.lf("Only ++ and -- supported as prefix or postfix unary operators in a statement");return}(n);case s.FunctionExpression:case s.ArrowFunction:return function(e,n){let r=!1;if(e.parameters.length){let i=C(e)[0];if(i&&t.pxtInfo(i).callInfo){let o=t.pxtInfo(i).callInfo;r="objectdestructuring"===n.attrs(o).mutate?e.parameters[0].name.kind!==s.ObjectBindingPattern:e.parameters.some((e=>e.name.kind!==s.Identifier))}}if(r)return t.Util.lf("Unsupported parameters in error function");return}(n,i);case s.BinaryExpression:return function(e,n){if(e.left.kind===s.ElementAccessExpression){if(e.operatorToken.kind!==s.EqualsToken)return t.Util.lf("Element access expressions may only be assigned to using the equals operator")}else{if(e.left.kind===s.PropertyAccessExpression)return e.operatorToken.kind!==s.EqualsToken&&e.operatorToken.kind!==s.PlusEqualsToken?t.Util.lf("Property access expressions may only be assigned to using the = and += operators"):S(e.left,n);if(e.left.kind!==s.Identifier)return t.Util.lf("This expression cannot be assigned to");switch(e.operatorToken.kind){case s.EqualsToken:return S(e.right,n);case s.PlusEqualsToken:case s.MinusEqualsToken:return;default:return t.Util.lf("Unsupported operator token in statement {0}",s[e.operatorToken.kind])}}return}(n,i);case s.ForStatement:return function(e){if(!e.initializer||!e.incrementor||!e.condition)return t.Util.lf("for loops must have an initializer, incrementor, and condition");if(e.initializer.kind!==s.VariableDeclarationList)return t.Util.lf("only variable declarations are permitted in for loop initializers");const n=e.initializer;if(!n.declarations)return t.Util.lf("for loop with out-of-scope variables not supported");if(1!=n.declarations.length)return t.Util.lf("for loop with multiple variables not supported");const r=n.declarations[0];if(r.initializer.kind!==s.NumericLiteral||"0"!==r.initializer.text)return t.Util.lf("for loop initializers must be initialized to 0");const i=r.name.text;if(!a(i))return t.Util.lf("for loop incrementors may only increment the variable declared in the initializer");if(e.condition.kind!==s.BinaryExpression)return t.Util.lf("for loop conditionals must be binary comparison operations");const o=e.condition;if(o.left.kind!==s.Identifier||o.left.text!==i)return t.Util.lf("left side of for loop conditional must be the variable declared in the initializer");if(o.operatorToken.kind!==s.LessThanToken&&o.operatorToken.kind!==s.LessThanEqualsToken)return t.Util.lf("for loop conditional operator must be either < or <=");return;function a(t){if(e.incrementor.kind===s.PostfixUnaryExpression||e.incrementor.kind===s.PrefixUnaryExpression){const n=e.incrementor;if(n.operator===s.PlusPlusToken&&n.operand.kind===s.Identifier)return n.operand.text===t}return!1}}(n);case s.ForOfStatement:return function(e){if(e.initializer.kind!==s.VariableDeclarationList)return t.Util.lf("only variable declarations are permitted in for of loop initializers");return}(n);case s.FunctionDeclaration:return function(e,n){if(!n)return t.Util.lf("Function declarations must be top level");if(e.parameters.length>0&&i.opts.allowedArgumentTypes)for(const n of e.parameters){if(n.initializer||n.questionToken)return t.Util.lf("Function parameters cannot be optional");const e=n.type?n.type.getText():void 0;if(!e)return t.Util.lf("Function parameters must declare a type");const r=U(e);if(-1===i.opts.allowedArgumentTypes.indexOf(r)&&!t.U.endsWith(r,"[]"))return t.Util.lf("Only types that can be added in blocks can be used for function arguments")}return}(n,a);case s.EnumDeclaration:return function(e,n){if(!n)return t.Util.lf("Enum declarations must be top level");const r=e.name.text;if(!i.blocks.enumsByName[r])return t.Util.lf("Enum declarations in user code must have a block");let o=!1;if(e.members.forEach((e=>{if(e.name.kind!==s.Identifier&&(o=!0),!o&&e.initializer){if(e.initializer.kind===s.NumericLiteral)return;if(e.initializer.kind===s.BinaryExpression){const t=e.initializer;if(t.operatorToken.kind===s.LessThanLessThanToken&&t.left.kind===s.NumericLiteral&&t.right.kind===s.NumericLiteral&&"1"==t.left.text)return}o=!0}})),o)return t.Util.lf("Invalid initializer for enum member");return}(n,a);case s.ModuleDeclaration:return function(e){const t=T(e,i);if(!t)return;return k(e)?t:void 0}(n);case s.ReturnStatement:return function(n){if(r(n))return;return t.Util.lf("Return statements can only be used within top-level function declarations");function r(t){const n=e.getEnclosingBlockScopeContainer(t);if(n)switch(n.kind){case s.SourceFile:case s.ArrowFunction:case s.FunctionExpression:return!1;case s.FunctionDeclaration:return n.parent&&n.parent.kind===s.SourceFile&&!v(n,i,!1,!0);default:return r(n)}return!1}}(n);case s.BreakStatement:case s.ContinueStatement:case s.DebuggerStatement:case s.EmptyStatement:return}return t.Util.lf("Unsupported statement in block: {0}",s[n.kind]);function l(e,n){let r;return e.name.kind!==s.Identifier?r=t.Util.lf("Variable declarations may not use binding patterns"):e.initializer?E(e)||(r=S(e.initializer,n)):r=t.Util.lf("Variable declarations must have an initializer"),r}}function T(n,r){if(!e.isModuleBlock(n.body))return t.Util.lf("Namespaces cannot be nested.");const i=r.blocks.kindsByName[n.name.text];if(!i)return t.Util.lf("Only namespaces with 'kind' blocks can be decompiled");const o=t.Util.lf("Namespaces may only contain valid 'kind' exports");for(const t of n.body.statements){if(V(t))return o;if(!e.isVariableStatement(t)||!t.declarationList.declarations)return o;{const n=1===t.declarationList.declarations.length,r=t.modifiers&&1===t.modifiers.length&&t.modifiers[0].kind===s.ExportKeyword,a=t.declarationList.flags&e.NodeFlags.Const;if(!(n&&r&&a))return o;{const n=t.declarationList.declarations[0];if(!n.initializer||!e.isCallExpression(n.initializer)||!e.isIdentifier(n.name))return o;const r=n.initializer;if(r.arguments.length)return o;if(e.isPropertyAccessExpression(r.expression)&&e.isIdentifier(r.expression.expression)){if(r.expression.expression.text!==i.name||r.expression.name.text!==i.createFunctionName)return o}else{if(!e.isIdentifier(r.expression))return o;if(r.expression.text!==i.createFunctionName)return o}}}}}function k(n){if(!e.isModuleBlock(n.body))return t.Util.lf("Namespaces cannot be nested.");if(n.name.text!==pxt.sprite.TILE_NAMESPACE)return t.Util.lf("Tileset namespace must be named myTiles");const r=t.Util.lf("The myTiles namespace can only export tile variables with image literal initializers and no duplicate ids"),i=t.Util.lf("Tileset members must have a blockIdentity comment and no other annotations"),o=new RegExp(`${pxt.sprite.TILE_PREFIX}(\\d+)`),a=[],l=/^\s*\/\/%\s*blockIdentity=[^\s]+\s*$/;for(const t of n.body.statements){const n=e.getLeadingCommentRangesOfNode(t,t.getSourceFile());if(!n||!n.length)return i;{const e=n.map((e=>t.getSourceFile().text.substr(e.pos,e.end-e.pos))).filter((e=>!!e));if(1!==e.length||!l.test(e[0]))return i}if(!e.isVariableStatement(t)||!t.declarationList.declarations)return r;{const n=1===t.declarationList.declarations.length,i=t.modifiers&&1===t.modifiers.length&&t.modifiers[0].kind===s.ExportKeyword,l=t.declarationList.flags&e.NodeFlags.Const;if(!(n&&i&&l))return r;{const n=t.declarationList.declarations[0];if(!n.initializer||!e.isTaggedTemplateExpression(n.initializer)||!e.isIdentifier(n.name))return r;const i=n.initializer;if(!e.isIdentifier(i.tag)||"img"!==i.tag.text)return r;const s=o.exec(n.name.text);if(!s||-1!==a.indexOf(s[1]))return r;a.push(s[1])}}}}function E(n){if(n.initializer){if(n.initializer.kind===e.SyntaxKind.NullKeyword||n.initializer.kind===e.SyntaxKind.FalseKeyword||function(e){return e.kind===s.ArrayLiteralExpression&&0===e.elements.length}(n.initializer))return!0;if(e.isStringOrNumericLiteral(n.initializer)){const e=n.initializer.getText();return"0"===e||A(e)}{const e=t.pxtInfo(n.initializer).callInfo;if(e&&e.isAutoCreate)return!0}}return!1}function x(e){if(1===e.parameters.length&&e.parameters[0].name.kind===s.ObjectBindingPattern){const n=e.parameters[0].name.elements,r={};return[n.map((e=>{if(t(e.propertyName)&&t(e.name)){const t=e.name.text;if(e.propertyName){const n=e.propertyName.text;return r[n]=t,n}return t}return""})),r]}return;function t(e){return!e||e.kind===s.Identifier}}function S(n,r){switch(n.kind){case s.NumericLiteral:case s.TrueKeyword:case s.FalseKeyword:case s.ExpressionStatement:case s.ArrayLiteralExpression:case s.ElementAccessExpression:return;case s.ParenthesizedExpression:return S(n.expression,r);case s.StringLiteral:case s.FirstTemplateToken:case s.NoSubstitutionTemplateLiteral:return function(e){const n=e.text;return o.test(n)?void 0:t.Util.lf("Only whitespace character allowed in string literals is space")}(n);case s.Identifier:const a=t.pxtInfo(n);return(i=n)&&i.kind===s.Identifier&&"undefined"===i.text?t.Util.lf("Undefined is not supported in blocks"):!w(n)||a.commentAttrs&&a.commentAttrs.blockIdentity&&a.commentAttrs.enumIdentity?void 0:t.Util.lf("Variable is declared in another file");case s.BinaryExpression:const l=n.operatorToken.getText();return f[l]?void 0:t.Util.lf("Could not find operator {0}",l);case s.PrefixUnaryExpression:const c=n.operator;return c===s.MinusToken||c===s.PlusToken||c===s.ExclamationToken?void 0:t.Util.lf("Unsupported prefix unary operator{0}",c);case s.PropertyAccessExpression:return function(n,r){const i=t.pxtInfo(n).callInfo;if(i){const o=r.attrs(i),a=r.compInfo(i);if(o.blockIdentity||"lists_length"===o.blockId||"text_length"===o.blockId)return;if(i.decl.kind===s.EnumMember){if(n.expression.kind===s.Identifier){const e=n.expression.text;if(r.declaredEnums[e])return}const[e,i]=C(n);let o=!0;if(e){const n=t.pxtInfo(e).callInfo;if(n&&n.args){const e=r.blocks.apis.byQName[n.qName],t=1==e.kind||2==e.kind;e&&n.args.forEach(((n,r)=>{if(n===i){e.parameters[t?r-1:r].isEnum&&(o=!1)}}))}}return o?t.Util.lf("Enum value without a corresponding block"):void 0}if(o.fixedInstance&&n.parent){if(n.parent.parent&&n.parent.kind===s.PropertyAccessExpression&&n.parent.parent.kind===s.CallExpression){if(n.parent.parent.expression===n.parent)return}else if(n.parent.kind===s.CallExpression&&n.parent.expression!==n)return}else{if(o.blockCombine||o.blockId&&a&&a.thisParameter)return S(n.expression,r);if(e.isIdentifier(n.expression)&&r.declaredKinds[n.expression.text]){const e=n.name.text,t=r.declaredKinds[n.expression.text];if(t&&(-1!==t.kindInfo.initialMembers.indexOf(e)||-1!==t.declaredNames.indexOf(e)))return}}}return t.Util.lf("No call info found")}(n,r);case s.CallExpression:return v(n,r,!0,void 0);case s.TaggedTemplateExpression:return function(e,n){const r=t.pxtInfo(e).callInfo;if(!r)return t.Util.lf("Invalid tagged template");const i=n.attrs(r);if(!i.blockIdentity)return t.Util.lf("Tagged template does not have blockIdentity set");const s=n.blocks.apis.byQName[i.blockIdentity];if(!s)return t.Util.lf("Could not find blockIdentity for tagged template");if(1!==pxt.blocks.compileInfo(s).parameters.length)return t.Util.lf("Tagged template functions must have 1 argument");return}(n,r);case s.AsExpression:return function(n){if("any"===n.type.getText().trim()&&(e.isStringOrNumericLiteral(n.expression)||n.expression.kind===s.TrueKeyword||n.expression.kind===s.FalseKeyword)){const[e]=C(n);if(e.kind===s.BinaryExpression)switch(e.operatorToken.kind){case s.EqualsEqualsToken:case s.EqualsEqualsEqualsToken:case s.ExclamationEqualsToken:case s.ExclamationEqualsEqualsToken:case s.LessThanToken:case s.LessThanEqualsToken:case s.GreaterThanToken:case s.GreaterThanEqualsToken:return}}return t.Util.lf("Casting not supported in blocks")}(n)}var i;return t.Util.lf("Unsupported syntax kind for output expression block: {0}",s[n.kind])}function C(e){return e.parent?e.parent.kind===s.ParenthesizedExpression?C(e.parent):[e.parent,e]:[void 0,e]}function I(e){for(;e.kind===s.ParenthesizedExpression;)e=e.expression;return e}function A(e){return'""'===e||"''"===e||"``"===e}function w(e){return!!(4&t.pxtInfo(e).flags)}function N(e,n){if(n.blockId===t.PAUSE_UNTIL_TYPE)return!1;e.decl.parameters;return e.args.some(((e,t)=>e&&O(e)))}function D(e){if(!e)return!1;switch(e.kind){case s.ParenthesizedExpression:return D(e.expression);case s.ArrayLiteralExpression:const t=e;for(const e of t.elements)if(!D(e)&&e.kind!==s.TaggedTemplateExpression)return!1;return!0;case s.NumericLiteral:case s.StringLiteral:case s.NoSubstitutionTemplateLiteral:case s.TrueKeyword:case s.FalseKeyword:return!0;case s.PrefixUnaryExpression:const n=e;return(n.operator===s.PlusToken||n.operator===s.MinusToken)&&D(n.operand);default:return!1}}function O(e){return e.kind===s.ArrowFunction||e.kind===s.FunctionExpression}function R(e,t){const n=[],r=t.apis.byQName[e.qName];if(r){const i=t.apis.byQName[e.qName].attributes,s=pxt.blocks.compileInfo(r);pxt.blocks.builtinFunctionInfo[e.qName];let o=i.imageLiteral?1:0;s.thisParameter?n.push({value:I(e.args[0]),info:null,param:s.thisParameter}):i.defaultInstance&&n.push({value:I(e.args[0]),info:r.parameters[0],param:{definitionName:"__instance__",actualName:"this"}});const a=!(!s.thisParameter&&!i.defaultInstance);a&&o++;for(let t=o;t<e.args.length;t++)n.push({value:I(e.args[t]),info:r.parameters[a?t-1:t],param:s.parameters[t-o]})}return n}function L(e){return e.body.statements.map((e=>{const t=e.declarationList.declarations[0];return{name:t.name.text,initializer:t.initializer.getText()}}))}function P(e){return e&&e.fieldOptions&&e.fieldOptions[r.DecompileIndirectFixedInstances]}function M(e){return F(e)||$(e)||B(e)||-1!==pxt.blocks.MATH_FUNCTIONS.binary.indexOf(e)}function F(e){return-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e)}function $(e){return-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e)}function B(e){return-1!==pxt.blocks.ROUNDING_FUNCTIONS.indexOf(e)}function U(e){const t=a.exec(e);return t?`${t[1]||t[2]}[]`:e}function V(t){const n=e.getLeadingCommentRangesOfNode(t,t.getSourceFile());return!(!n||!n.length)}function H(t,n,r=!1){const s=[],o=t.getFullText();if(n&&n.length)for(const a of n){const n=e.getLineOfLocalPosition(t,a.end),l=e.getStartPositionOfLine(n+1,t)||o.length,c=e.getStartPositionOfLine(n+2,t)||o.length,u=!r&&!o.substr(l,c-l).trim();let d=o.substr(a.pos,a.end-a.pos);if(d&&(d=d.replace(/\r\n/g,"\n")),a.kind===e.SyntaxKind.SingleLineCommentTrivia){const e=m.exec(d);e?s.push({kind:i.SingleLine,text:e[1],start:a.pos,end:a.end,hasTrailingNewline:!!a.hasTrailingNewLine,followedByEmptyLine:u,isTrailingComment:r}):s.push({kind:i.SingleLine,text:"",start:a.pos,end:a.end,hasTrailingNewline:!!a.hasTrailingNewLine,followedByEmptyLine:u,isTrailingComment:r})}else{const e=d.split("\n").map((e=>{const t=_.exec(e);return t?t[1]:""}));s.push({kind:i.MultiLine,lines:e,start:a.pos,end:a.end,hasTrailingNewline:!!a.hasTrailingNewLine,followedByEmptyLine:u,isTrailingComment:r})}}return s}function G(e){let n="";for(const r of e)if(r.kind===i.SingleLine){if(r.text===t.ON_START_COMMENT||r.text===t.HANDLER_COMMENT)continue;n+=r.text.trim()+"\n"}else for(const e of r.lines)n+=e.trim()+"\n";return n.trim()}function j(e){const[t]=C(e);return!t||t.kind==s.SourceFile||(t.kind==s.ExpressionStatement?j(t):t.kind==s.VariableDeclarationList&&j(t.parent))}function K(t){const n=t.getFullText(),r=e.createScanner(t.languageVersion,!1,t.languageVariant,n,void 0,t.getFullStart());let i,o,a=[];for(;r.getTextPos()<t.end;){const l=r.scan();if(l===s.SingleLineCommentTrivia||l===s.MultiLineCommentTrivia){i=e.getLeadingCommentRanges(n,r.getTokenPos())||[],o=e.getTrailingCommentRanges(n,r.getTokenPos())||[],o=o.filter((e=>!i.some((t=>t.pos===e.pos)))),a.push(...H(t,i,!1)),a.push(...H(t,o,!0));for(const e of a)e.end>r.getTextPos()&&r.setTextPos(e.end)}}return a.sort(((e,t)=>e.start-t.start)),a}function W(e,t){let n;for(let r=0;r<t.length;r++)n=t[r],!n.owner&&n.start>=e.pos&&n.end<=e.end&&(n.owner=e)}function z(e){let t=!1;if("expr"===e.value.kind){const n=e.value;if(n.type===l&&e.shadowType===c&&(n.type=c,n.fields[0].name="SLIDER",n.mutation=e.shadowMutation),t=n.type===e.shadowType,!t)switch(n.type){case"math_number":case"math_number_minmax":case"math_integer":case"math_whole_number":case"logic_boolean":case"text":t=!e.shadowType}}return t}n.RenameMap=g,n.buildRenameMap=function(n,r,{declarations:i,takenNames:s}={declarations:"variables",takenNames:{}}){let o=e.createLanguageService(new t.LSHost(n));const a=[];let l=(function t(n){e.forEachChild(n,(n=>{if(e.isDeclarationName(n)&&("all"===i||e.isVariableDeclaration(n.parent))){const e=n.getText();if(s[e]){const t=y(e,s),i=o.findRenameLocations(r.fileName,n.pos+1,!1,!1);i&&i.forEach((n=>{a.push({name:t,diff:t.length-e.length,span:n.textSpan})}))}else s[e]=!0}t(n)}))}(r),s);return[new g(a),l]},n.getNewName=y,function(e){e[e.None=0]="None",e[e.InBlocksOnly=1]="InBlocksOnly",e[e.InTextBlocks=2]="InTextBlocks"}(b||(b={})),n.decompileToBlocks=function(o,a,m,_){let g=0,y=a.statements;const P={blocksInfo:o,outfiles:{},diagnostics:[],success:!0,times:{}};m.generateSourceMap&&(P.blockSourceMap=[]);const V={blocks:o,declaredFunctions:{},declaredEnums:{},declaredKinds:{},functionParamIds:{},attrs:oe,compInfo:function(e){const t=o.apis.byQName[e.qName];if(t)return pxt.blocks.compileInfo(t);return},localReporters:[],tileset:[],opts:m||{},aliasBlocks:{}};a.getFullText();let H="";const q=[],J={},Y=[],X=[],Q=(()=>{let e=0;return()=>""+e++})(),Z=o.apis.byQName;Object.keys(Z).forEach((e=>{const t=Z[e];t.attributes.blockAliasFor&&Z[t.attributes.blockAliasFor]&&(V.aliasBlocks[t.attributes.blockAliasFor]=t.qName)}));const ee=K(a),te=n=>{if(n.kind!==s.FunctionDeclaration||v(n,V,!1,!0))if(n.kind!==s.EnumDeclaration||v(n,V,!1,!0))if(e.isModuleDeclaration(n))if(T(n,V))k(n)||(V.tileset=L(n).map((({name:e,initializer:t})=>({projectId:parseInt(e.substr(pxt.sprite.TILE_PREFIX.length)),data:pxt.sprite.imageLiteralToBitmap(t).data()}))));else{const e=n.name.text,t=L(n);V.declaredKinds[e]&&V.declaredKinds[e].declaredNames.push(...t.map((({name:e})=>e)))}else n.kind===s.Block&&e.forEachChild(n,te);else{const e=n.name.text;V.declaredEnums[e]=!0,function(e){const n=[];return e.members.forEach((e=>{t.U.assert(e.name.kind===s.Identifier);const r=e.name.text;let i;if(e.initializer)if(e.initializer.kind===s.NumericLiteral)i=parseInt(e.initializer.text);else{const n=e.initializer;t.U.assert(n.left.kind===s.NumericLiteral),t.U.assert("1"===n.left.text),t.U.assert(n.operatorToken.kind===s.LessThanLessThanToken),t.U.assert(n.right.kind===s.NumericLiteral);i=1<<parseInt(n.right.text)}else i=0===n.length?0:n[n.length-1][1]+1;n.push([r,i])})),n}(n).forEach((([t,n])=>{q.push({name:n+t,type:e})}))}else V.declaredFunctions[et(n.name)]=n};Object.keys(o.kindsByName).forEach((e=>{const t=o.kindsByName[e];V.declaredKinds[e]={kindInfo:t,declaredNames:[]}})),e.forEachChild(a,te);const ne=()=>(Math.PI*Math.random()).toString(36).slice(2);let re;Object.keys(V.declaredFunctions).forEach((e=>{V.functionParamIds[e]={},V.declaredFunctions[e].parameters.forEach((t=>{V.functionParamIds[e][t.name.getText()]=ne()+ne()}))})),Object.keys(V.declaredKinds).forEach((e=>{const t="KIND_"+e;V.declaredKinds[e].declaredNames.forEach((e=>q.push({name:e,type:t})))})),(q.length||V.tileset.length)&&(ie("<variables>"),q.forEach((e=>{ie(`<variable type="${t.U.htmlEscape(e.type)}">${t.U.htmlEscape(e.name)}</variable>`)})),V.tileset.forEach((e=>{ie(`<variable type="${pxt.sprite.BLOCKLY_TILESET_TYPE}">${pxt.sprite.legacy.tileToBlocklyVariable(e)}</variable>`)})),ie("</variables>"));try{re=Ye(y,void 0,!0,void 0,!m.snippetMode);for(const e of ee)e.owner||Y.push({refId:Q(),comment:[e]})}catch(r){if(!r.programTooLarge)return pxt.reportException(r),P.success=!1,P.diagnostics=t.patchUpDiagnostics([{file:a,start:a.getFullStart(),length:a.getFullWidth(),messageText:r.message,category:e.DiagnosticCategory.Error,code:n.DECOMPILER_ERROR}]),P;P.success=!1,P.diagnostics=t.patchUpDiagnostics([{file:a,start:a.getFullStart(),length:a.getFullWidth(),messageText:r.message,category:e.DiagnosticCategory.Error,code:n.FILE_TOO_LARGE_CODE}])}return re?me(re):m.snippetMode||y.length||(ke(e.pxtc.ON_START_TYPE,de(e.pxtc.ON_START_TYPE,y[0])),Ee()),Y.forEach((e=>{!function(e){let n=0;const r=G(e.comment);if(r.trim()){const i=r.split("\n");i.forEach((e=>n=Math.max(n,e.length)));const s=Math.max(Math.min(10*n,480),160);ie(`<comment h="${Math.max(Math.min(40*i.length,360),120)}" w="${s}" data="${t.U.htmlEscape(e.refId)}">`),ie(t.U.htmlEscape(r)),ie("</comment>")}}(e)})),P.outfiles[a.fileName.replace(/(\.blocks)?\.\w*$/i,"")+".blocks"]=`<xml xmlns="http://www.w3.org/1999/xhtml">\n${H}</xml>`,P;function ie(e,t="\n"){H+=e+t}function se(n,r){const i=r||`Language feature "${n.getFullText().trim()}"" not supported in blocks`,s=t.patchUpDiagnostics([{file:a,start:n.getFullStart(),length:n.getFullWidth(),messageText:i,category:e.DiagnosticCategory.Error,code:1001}]);pxt.debug(`decompilation error: ${i}`),t.U.pushRange(P.diagnostics,s),P.success=!1}function oe(e){const n=o.apis.byQName[e.decompilerBlockAlias||e.qName];if(n){const e=n.attributes;if(!e.blockId||o.blocksById[e.blockId]||e.blockId===t.PAUSE_UNTIL_TYPE)return n.attributes}else if(e.decl){const n=t.parseComments(e.decl);if(n)return n}return{paramDefl:{},callingConvention:0}}function ae(n){const r=n.expression,i=t.pxtInfo(r).callInfo,s=oe(i);if(s.blockAllowMultiple)return;if(s.blockHandlerKey)return s.blockHandlerKey;const o=i.args.filter((t=>!e.isArrowFunction(t)&&!O(t))).map((e=>le(e))).join("$$");return s.blockId+"-"+o}function le(e){if(!e)return"";switch(e.kind){case s.ParenthesizedExpression:case s.AsExpression:return le(e.expression);case s.Identifier:return e.text;case s.StringLiteral:case s.FirstTemplateToken:case s.NoSubstitutionTemplateLiteral:return`"${e.text}"`;case s.NumericLiteral:return e.text;case s.TrueKeyword:return"true";case s.FalseKeyword:return"false";case s.BinaryExpression:return`{${le(e.left)}${e.operatorToken.getText()}${le(e.right)}}`;case s.PrefixUnaryExpression:return e.operator+le(e.operand);case s.PropertyAccessExpression:return le(e.expression)+"."+le(e.name);case s.ArrayLiteralExpression:return`[${e.elements.map((e=>le(e)))}]`;case s.ElementAccessExpression:return`${e.expression}[${e.argumentExpression}]`;case s.TaggedTemplateExpression:return`${le(e.tag)}\`${e.template.getText()}\``;case s.CallExpression:return`${le(e.expression)}(${e.arguments.map(le).join(",")})`;default:return e.getText()}}function ce(){if(g++,g>1500){let e=new Error(t.Util.lf("Could not decompile because the script is too large"));throw e.programTooLarge=!0,e}}function ue(t,n){if(t==e.pxtc.ON_START_TYPE)return"xRRgvHNlG#rZ^u`HECiY";const r=function(){const e="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=e.length,n=[];for(let r=0;r<20;r++)n[r]=e.charAt(Math.random()*t);return n.join("")}();if(n){const e=n.getFullStart();P.blockSourceMap.push({id:r,startPos:e,endPos:e+n.getFullWidth()})}return r}function de(e,t){const n={kind:"statement",type:e};return P.blockSourceMap&&(n.id=ue(e,t)),n}function pe(e,t){return{kind:"expr",type:e}}function he(e,t,n,r){return(!n||n===l)&&r&&r.min&&r.max&&(n=c),{kind:"value",name:e,value:t,shadowType:n,shadowMutation:r}}function fe(e){if(e.expression.kind==s.CallExpression){const n=e.expression,r=t.pxtInfo(n).callInfo;if(!r)return se(e),!1;const i=oe(r);return i.blockId&&!i.handlerStatement&&!r.isExpression&&N(r,i)}return!1}function me(e){e&&(ke(e.type,e),ge(e),void 0!==e.data&&ie(`<data>${t.U.htmlEscape(e.data)}</data>`),e.handlers&&e.handlers.forEach(ve),e.next&&(ie("<next>"),me(e.next),ie("</next>")),void 0!==e.comment&&ie(`<comment pinned="false">${t.U.htmlEscape(G(e.comment))}</comment>`),Ee())}function _e(e,t){ie("<mutation ",""),Object.keys(e).forEach((t=>{void 0!==e[t]&&ie(`${t}="${e[t]}" `,"")})),t?(ie(">"),t.forEach((e=>{ie(`<${e.nodeName} `,""),Object.keys(e.attributes).forEach((t=>{ie(`${t}="${e.attributes[t]}" `,"")})),ie("/>")})),ie("</mutation>")):ie("/>")}function ge(e){e.mutation&&_e(e.mutation,e.mutationChildren),e.fields&&e.fields.forEach(be),e.inputs&&e.inputs.forEach(ye)}function ye(e){if(ie(`<value name="${e.name}">`),z(e))Te(e.value,!0);else{if(void 0!==e.shadowType)switch(e.shadowType){case l:case u:case d:ie(`<shadow type="${e.shadowType}"><field name="NUM">0</field></shadow>`);break;case c:ie('<shadow type="math_number_minmax">'),e.shadowMutation&&_e(e.shadowMutation),ie('<field name="SLIDER">0</field></shadow>');break;case h:ie('<shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow>');break;case p:ie('<shadow type="text"><field name="TEXT"></field></shadow>');break;default:ie(`<shadow type="${e.shadowType}"/>`)}Te(e.value)}ie("</value>")}function be(e){ie(`<field name="${t.U.htmlEscape(e.name)}">${t.U.htmlEscape(e.value.toString())}</field>`)}function ve(e){ie(`<statement name="${t.U.htmlEscape(e.name)}">`),me(e.statement),ie("</statement>")}function Te(e,n=!1){if("text"===e.kind){ie(e.value)}else{const r=e,i=n||r.isShadow,s=i?"shadow":"block";i||ce(),ie(`<${s} ${r.id?`id="${r.id}" `:""}type="${t.U.htmlEscape(r.type)}">`),ge(r),ie(`</${s}>`)}}function ke(e,n){ce();ie(`<block ${n&&n.id?`id="${n.id}" `:""}type="${t.U.htmlEscape(e)}">`)}function Ee(){ie("</block>")}function xe(e){if(S(e,V))return Ce(e);switch(e.kind){case s.ExpressionStatement:case s.ParenthesizedExpression:return xe(e.expression);case s.Identifier:return function(e){if(w(e)){const n=t.pxtInfo(e);return Ue(o.apis.byQName[n.commentAttrs.blockIdentity],n.commentAttrs.enumIdentity)}const n=et(e),r=e.text;let i=null;return V.localReporters.some((e=>{for(let t=0;t<e.length;++t)if(e[t].name===r)return i=e[t],!0;return!1})),i?Me(n,i.type,!1):(Qe(n,b.InBlocksOnly),Le("variables_get","VAR",n))}(e);case s.StringLiteral:case s.FirstTemplateToken:case s.NoSubstitutionTemplateLiteral:return Oe(e.text);case s.NumericLiteral:return De(e.text);case s.TrueKeyword:return Re(!0);case s.FalseKeyword:return Re(!1);case s.BinaryExpression:return function(e){const t=e.operatorToken.getText(),n=f[t];if(Ie(e))return we(e);const r=n.leftName||"A",i=n.rightName||"B";let s,o;"&&"===t||"||"===t?(s=je(r,e.left),o=je(i,e.right)):(s=Ne(r,e.left,l),o=Ne(i,e.right,l));const a=pe(n.type);a.fields=[],n.op&&a.fields.push(Fe("OP",n.op));return a.inputs=[s,o],a}(e);case s.PrefixUnaryExpression:return function(e){switch(e.operator){case s.ExclamationToken:const t=pe("logic_negate");return t.inputs=[je("BOOL",e.operand)],t;case s.PlusToken:return xe(e.operand);case s.MinusToken:return e.operand.kind==s.NumericLiteral?De("-"+e.operand.text):$e(e.operand);default:se(e)}return}(e);case s.PropertyAccessExpression:return Be(e);case s.ArrayLiteralExpression:return function(e){const t=pe("lists_create_with");return t.inputs=e.elements.map(((e,t)=>Ne("ADD"+t,e))),t.mutation={items:e.elements.length.toString()},t}(e);case s.ElementAccessExpression:return function(e){const t=pe("lists_index_get");return t.inputs=[Ne("LIST",e.expression),Ne("INDEX",e.argumentExpression,l)],t}(e);case s.TaggedTemplateExpression:return function(e){const n=t.pxtInfo(e).callInfo;let i;const a=function(e){if(e.parent&&e.parent.kind===s.CallExpression){const n=e.parent,r=t.pxtInfo(n).callInfo,i=n.arguments.indexOf(e);if(r&&-1!==i){const e=o.apis.byQName[r.qName];if(e){const t=pxt.blocks.compileInfo(e);return t&&t.parameters[i]}}}return}(e);if(a&&a.shadowBlockId){const e=V.blocks.blocksById[a.shadowBlockId];e&&"TD_ID"===e.attributes.shim&&(i=e)}i||(i=V.blocks.apis.byQName[oe(n).blockIdentity]);const l=pxt.blocks.compileInfo(i),c=pe(i.attributes.blockId);let u;const d=l.parameters[0];u=d.fieldOptions&&d.fieldOptions[r.DecompileArgumentAsString]?e.getText():e.template.text;return c.fields=[Fe(d.actualName,u)],c}(e);case s.CallExpression:return He(e,void 0,void 0,!0);case s.AsExpression:return xe(e.expression);default:se(e,t.Util.lf("Unsupported syntax kind for output expression block: {0}",s[e.kind]))}}function Se(e,t,n){if(_){const r=_.getRenamesInSpan(t,n);if(r.length){let n=0;r.forEach((r=>{const i=r.span.start+n-t,s=i+r.span.length;n+=r.diff,e=e.slice(0,i)+r.name+e.slice(s)}))}}return e}function Ce(e){const n=Se(e.getFullText(),e.getFullStart(),e.getEnd()).trim();return Ze(e),W(e,ee),Le(t.TS_OUTPUT_TYPE,"EXPRESSION",n)}function Ie(e){if(e.kind===s.BinaryExpression){const n=e;if("+"===n.operatorToken.getText()||n.operatorToken.kind==s.PlusEqualsToken){return!!t.pxtInfo(e).exprInfo}}return!1}function Ae(e,t){Ie(e)?(Ae(e.left,t),Ae(e.right,t)):t.push(e)}function we(e){const t=[];Ae(e,t);const n=[];for(let e=0;e<t.length;e++)(e>0||!A(t[e].getText()))&&n.push(Ne("ADD"+n.length,t[e],p));const r=pe("text_join");return r.inputs=n,r.mutation={items:n.length.toString()},r}function Ne(e,t,n,r){let i;if(i="number"==typeof t?De(t.toString()):"boolean"==typeof t?Re(t):"string"==typeof t?Oe(t):xe(t),"expr"==i.kind&&"math_number"==i.type){const e=i.fields[0].value;"math_integer"==n&&e%1==0&&(i.type="math_integer"),"math_whole_number"==n&&e%1==0&&e>0&&(i.type="math_whole_number")}return he(e,i,n,r)}function De(e){return Le("math_number","NUM",e)}function Oe(e){return Le("text","TEXT",e)}function Re(e){return Le("logic_boolean","BOOL",e?"TRUE":"FALSE")}function Le(e,t,n,r){const i=pe(e);return i.fields=[Fe(t,n)],i.isShadow=r,i}function Pe(e,t){const n=Le("variables_get_reporter","VAR",t);return n.mutation={duplicateondrag:"true"},he(e,n,void 0,n.mutation)}function Me(e,t,n){const r=pxt.blocks.reporterTypeForArgType(t),i=Le(r,"VALUE",e);return"argument_reporter_custom"===r&&(i.mutation={typename:t}),n&&(i.mutation||(i.mutation={}),i.mutation.duplicateondrag="true"),i}function Fe(e,t){return{kind:"field",name:e,value:t}}function $e(e){const t=pe("math_arithmetic");return t.inputs=[Ne("A",0,l),Ne("B",e,l)],t.fields=[Fe("OP","MINUS")],t}function Be(e,n=!1,r){let i=t.pxtInfo(e).callInfo;if(!i)return void se(e);if(e.expression.kind===s.Identifier){const t=e.expression.text;if(V.declaredEnums[t]){const n=o.enumsByName[t];if(n&&n.blockId)return Le(n.blockId,"MEMBER",e.name.text)}else if(V.declaredKinds[t]){return Le(V.declaredKinds[t].kindInfo.blockId,"MEMBER",e.name.text)}}const a=oe(i);if(r=a.blockId||r,a.blockCombine)return function(e,t){return ze(e,t,null,"@get@")}(e,e);if("lists_length"===a.blockId||"text_length"===a.blockId){const n=pe(t.U.htmlEscape(a.blockId));return n.inputs=[Ne("VALUE",e.expression)],n}let l=t.U.htmlEscape(a.blockId||i.qName);const[c]=C(e),u=c&&t.pxtInfo(c).callInfo;if(n||!r&&!a.blockIdentity||u&&u.qName===a.blockIdentity)return{kind:"text",value:l};a.enumval&&u&&a.useEnumVal&&(l=a.enumval);const d=V.compInfo(i);if(r&&d&&d.thisParameter){const n=pe(r);return n.inputs=[Ne(t.U.htmlEscape(d.thisParameter.definitionName),e.expression,d.thisParameter.shadowBlockId)],n}return Ue(a.blockIdentity?o.apis.byQName[a.blockIdentity]:o.blocksById[r],l)}function Ue(e,n){let r=/(?:%|\$)([a-zA-Z0-9_]+)/.exec(e.attributes.block);const i=pe(t.U.htmlEscape(e.attributes.blockId));return i.fields=[{kind:"field",name:t.U.htmlEscape(r[1]),value:n}],i}function Ve(t,n){let r,s=[];for(let e=0;e<ee.length&&(r=ee[e],!r.owner&&r.start>=t.pos&&r.end<=t.end&&(r.owner=t,r.ownerStatement=n,s.push(r)),!(r.start>t.end));e++);if(r&&r.isTrailingComment){const i=e.getLineAndCharacterOfPosition(a,t.end),o=e.getLineAndCharacterOfPosition(a,r.start);if(i.line===o.line){if(r.ownerStatement){r.ownerStatement.comment.splice(r.ownerStatement.comment.indexOf(r),1);for(const e of Y)e.comment.splice(e.comment.indexOf(r),1)}r.owner=t,r.ownerStatement=n,s.push(r)}}if(s.length){const e=[];if(j(t)){let t=[];const n=[];s.forEach(((e,r)=>{let o=e.owner&&e.start<e.owner.getStart();e.kind===i.MultiLine&&o&&(t.length&&(n.push(t),t=[]),r!=s.length-1)?n.push([e]):(t.push(e),e.followedByEmptyLine&&o&&(n.push(t),t=[]))})),s=t,n.forEach((t=>{const n=Q();e.push(n),Y.push({comment:t,refId:n})}))}n&&(e.length&&(n.data?n.data+=";"+e.join(";"):n.data=e.join(";")),s&&s.length&&(n.comment?n.comment=n.comment.concat(s):n.comment=s))}}function He(n,i,a,f=!1,m=!1){const _=n;let g,y=!1;const T=v(_,V,f,m);if(T)g=Ge(_,void 0,T);else switch(_.kind){case s.Block:return Ye(_.statements,i,m);case s.ExpressionStatement:return He(_.expression,i,a||_,f,m);case s.VariableStatement:if(g=Ye(_.declarationList.declarations,void 0,!1,a||_),!g)return k();y=!0;break;case s.FunctionExpression:case s.ArrowFunction:return function(e,t){return He(e.body,t)}(_,i);case s.BinaryExpression:g=function(e){e.left.text;switch(e.operatorToken.kind){case s.EqualsToken:return e.left.kind===s.Identifier?Ke(e,e.left,e.right):e.left.kind==s.PropertyAccessExpression?We(e,e.left,e.right,"@set@"):function(e,t,n){const r=de("lists_index_set",e);return r.inputs=[Ne("LIST",t.expression),Ne("INDEX",t.argumentExpression,l),Ne("VALUE",n)],r}(e,e.left,e.right);case s.PlusEqualsToken:if(Ie(e)){const t=de("variables_set",e),n=et(e.left);return Qe(n,b.InBlocksOnly),t.inputs=[he("VALUE",we(e),l)],t.fields=[Fe("VAR",n)],t}return e.left.kind==s.PropertyAccessExpression?We(e,e.left,e.right,"@change@"):Ke(e,e.left,e.right,!0);case s.MinusEqualsToken:const n=de("variables_change",e);return n.inputs=[he("VALUE",$e(e.right),l)],n.fields=[Fe("VAR",et(e.left))],n;default:return void se(e,t.Util.lf("Unsupported operator token in statement {0}",s[e.operatorToken.kind]))}}(_);break;case s.PostfixUnaryExpression:case s.PrefixUnaryExpression:g=function(e){const t=e.operator===s.PlusPlusToken;if(!t&&e.operator!==s.MinusMinusToken)return void se(e);return Ke(e,e.operand,t?1:-1,!0)}(_);break;case s.VariableDeclaration:const n=_;if(E(n))return function(e){X.push([et(e.name),e])}(n),k();g=function(e){if(function(e){if(e.name.kind!==s.Identifier)return se(e,t.Util.lf("Variable declarations may not use binding patterns")),!1;if(!e.initializer)return se(e,t.Util.lf("Variable declarations must have an initializer")),!1;return!0}(e))return Ke(e,e.name,e.initializer);return}(_);break;case s.WhileStatement:g=function(e){const t=de("device_while",e);return t.inputs=[je("COND",e.expression)],t.handlers=[{name:"DO",statement:He(e.statement)}],t}(_);break;case s.IfStatement:g=function(e){let t=Je(e);const n=de("controls_if",e);if(n.mutation={elseif:(t.ifStatements.length-1).toString(),else:t.elseStatement?"1":"0"},n.inputs=[],n.handlers=[],t.ifStatements.forEach(((e,t)=>{let r=He(e.thenStatement);n.inputs.push(je("IF"+t,e.expression)),n.handlers.push({name:"DO"+t,statement:r})})),t.elseStatement){let e=He(t.elseStatement);n.handlers.push({name:"ELSE",statement:e})}return n}(_);break;case s.ForStatement:g=function(t){const n=t.initializer,r=(n.declarations[0].name.text,t.condition),i=et(n.declarations[0].name);let o;if(r.operatorToken.kind!==s.LessThanToken||c(t.statement))if(o=de("pxt_controls_for",t),o.fields=[],o.inputs=[],o.handlers=[],o.inputs=[Pe("VAR",i)],r.operatorToken.kind===s.LessThanToken){const e=I(r.right);if(e.kind===s.NumericLiteral){const t=De(parseFloat(e.text)-1+"");o.inputs.push(he("TO",t,d))}else{const t=pe("math_arithmetic");t.fields=[Fe("OP","MINUS")],t.inputs=[Ne("A",e,l),Ne("B",1,l)],o.inputs.push(he("TO",t,d))}}else r.operatorToken.kind===s.LessThanEqualsToken&&o.inputs.push(Ne("TO",r.right,d));else o=de("controls_repeat_ext",t),o.fields=[],o.inputs=[Ne("TIMES",r.right,d)],o.handlers=[];const a=He(t.statement);return o.handlers=[{name:"DO",statement:a}],o;function c(t){return t.kind===s.Identifier&&et(t)===i||e.forEachChild(t,c)}}(_);break;case s.ForOfStatement:g=function(e){const t=et(e.initializer.declarations[0].name),n=de("pxt_controls_for_of",e);n.inputs=[Ne("LIST",e.expression),Pe("VAR",t)];const r=He(e.statement);return n.handlers=[{name:"DO",statement:r}],n}(_);break;case s.FunctionDeclaration:g=function(e){const t=et(e.name);V.localReporters.push(e.parameters.map((e=>({name:e.name.getText(),type:e.type.getText()}))));const n=He(e.body);let r;V.localReporters.pop(),r=de("function_definition",e),r.mutation={name:t},e.parameters&&(r.mutationChildren=[],e.parameters.forEach((e=>{const n=e.name.getText();let i=U(e.type.getText());pxt.U.endsWith(i,"[]")&&(i="Array"),r.mutationChildren.push({nodeName:"arg",attributes:{name:n,type:i,id:V.functionParamIds[t][n]}})})));return r.handlers=[{name:"STACK",statement:n}],r}(_);break;case s.CallExpression:g=function(n,i){const a=t.pxtInfo(n).callInfo,f=oe(a);if("Math.pow"==a.qName){const e=pe("math_arithmetic");return e.inputs=[he("A",xe(n.arguments[0]),l),he("B",xe(n.arguments[1]),l)],e.fields=[Fe("OP","POWER")],e}if(pxt.Util.startsWith(a.qName,"Math.")){const e=a.qName.substring(5);if(M(e)){let t;if(B(e))t=pe("math_js_round");else{let n;t=pe("math_js_op"),n=F(e)?"unary":$(e)?"infix":"binary",t.mutation={"op-type":n}}return t.inputs=a.args.map(((e,t)=>he("ARG"+t,xe(e),"math_number"))),t.fields=[Fe("OP",e)],t}}if(f.blockId===t.PAUSE_UNTIL_TYPE){const e=de(t.PAUSE_UNTIL_TYPE,n),r=n.arguments[0];let i;return i=r.body.kind===s.Block?r.body.statements[0].expression:r.body,e.inputs=[he("PREDICATE",xe(i),"logic_boolean")],e}if(!f.blockId||!f.block){const e=pxt.blocks.builtinFunctionInfo[a.qName];if(!e){const e=et(n.expression);if(V.declaredFunctions[e]){let t,r=!0;if(a.isExpression){const[e]=C(n);r=e&&e.kind===s.ExpressionStatement}return t=de(r?"function_call":"function_call_output",n),a.args.length&&(t.mutationChildren=[],t.inputs=[],V.declaredFunctions[e].parameters.forEach(((n,r)=>{const i=n.name.getText(),s=V.functionParamIds[e][i];let o=U(n.type.getText());pxt.U.endsWith(o,"[]")&&(o="Array"),t.mutationChildren.push({nodeName:"arg",attributes:{name:i,type:o,id:s}});const l=he(s,xe(a.args[r]));t.inputs.push(l)}))),t.mutation={name:e},t}return Ge(n)}f.blockId=e.blockId}if(f.imageLiteral||f.gridLiteral)return function(e,n){let r=e.arguments[0];if(r.kind!=s.StringLiteral&&r.kind!=s.NoSubstitutionTemplateLiteral)return void se(e);const i=oe(n),o=de(i.blockId,e);o.fields=[];const a=(r.text||"").replace(/\s+/g,""),l=(i.imageLiteralColumns||5)*(i.imageLiteral||i.gridLiteral),c=i.imageLiteralRows||5,u=l*c;if(u!=a.length)return void se(e,t.Util.lf("Invalid image pattern ({0} expected vs {1} actual)",u,a.length));let d="";for(let e=0;e<c;++e){for(let t=0;t<l;++t)d+=/[#*1]/.test(a[e*l+t])?"#":".";d+="\n"}return o.fields.push(Fe("LEDS",`\`${d}\``)),o}(n,a);e.isFunctionLike(a.decl);const m=R(a,V.blocks),_=V.blocks.apis.byQName[a.decompilerBlockAlias||a.qName],g=pxt.blocks.compileInfo(_),y=i?pe(f.blockId):de(f.blockId,n),b=e=>(y.inputs||(y.inputs=[])).push(e),v=e=>(y.fields||(y.fields=[])).push(e);"Math.max"==a.qName&&v({kind:"field",name:"op",value:"max"});let T=0;if(m.forEach(((e,n)=>{let i,m=e.value;const _=e.param,k=e.info,E=g.parameters[g.thisParameter?n-1:n],S=E&&E.range;if(S){const e=S.min,t=S.max;i={min:e.toString(),max:t.toString()}}if(0===n&&f.defaultInstance){if(m.getText()===f.defaultInstance)return;y.mutation={showing:"true"}}if(f.mutatePropertyEnum&&n===a.args.length-2)return;let C;if(_&&_.isOptional&&++T,_&&_.shadowBlockId&&(C=o.blocksById[_.shadowBlockId]),m.kind===s.CallExpression){const e=t.pxtInfo(m).callInfo,n=e&&oe(e);n&&"TD_ID"===n.shim&&k.isEnum&&(m=I(e.args[0]))}if(_&&k&&k.isEnum&&m.kind===s.Identifier)v(Fe(t.U.htmlEscape(_.definitionName),t.pxtInfo(m).commentAttrs.enumIdentity));else if(_&&_.fieldOptions&&_.fieldOptions[r.DecompileArgumentAsString])v(Fe(t.U.htmlEscape(_.definitionName),t.Util.htmlEscape(m.getText())));else switch(m.kind){case s.FunctionExpression:case s.ArrowFunction:const e=function(e){const n=x(e);if(n)return{callbackproperties:n[0].join(","),renamemap:t.Util.htmlEscape(JSON.stringify(n[1]))};return}(m);let T=!1;if(e)y.mutation=e;else{let e=m;const t=o.blocksById[f.blockId].parameters[g.thisParameter?n-1:n],r=(e,t)=>{"reporter"===f.draggableParameters?b(function(e,t,n){return he(e,Me(t,n,!0),void 0)}("HANDLER_DRAG_PARAM_"+e.name,t,e.type)):b(Pe("HANDLER_DRAG_PARAM_"+e.name,t))};if(e.parameters.length&&(f.optionalVariableArgs?(y.mutation={numargs:e.parameters.length.toString()},e.parameters.forEach(((e,t)=>{y.mutation["arg"+t]=e.name.text}))):e.parameters.forEach(((e,n)=>{const i=t.handlerParameters[n];f.draggableParameters?r(i,e.name.text):v(Fe("HANDLER_"+i.name,e.name.text))}))),f.draggableParameters){if(e.parameters.length<t.handlerParameters.length)for(let n=e.parameters.length;n<t.handlerParameters.length;n++){const e=t.handlerParameters[n];r(e,e.name)}"reporter"===f.draggableParameters&&(V.localReporters.push(t.handlerParameters),T=!0)}}const E=He(m);(y.handlers||(y.handlers=[])).push({name:"HANDLER",statement:E}),T&&V.localReporters.pop();break;case s.PropertyAccessExpression:const S=t.pxtInfo(m).callInfo,I=t.U.htmlEscape(_.definitionName),A=oe(S);C&&"TD_ID"===C.attributes.shim?b(he(I,Be(m,!1,_.shadowBlockId),_.shadowBlockId,i)):k&&k.isEnum||S&&(A.fixedInstance||A.blockIdentity===a.qName)?v(Fe(I,Be(m,!0).value)):b(Ne(I,m,_.shadowBlockId,i));break;case s.BinaryExpression:if(_&&_.shadowOptions&&_.shadowOptions.toString){const e=m;if(e.operatorToken.kind===s.PlusToken&&function(e){if(e.kind===s.StringLiteral||e.kind===s.NoSubstitutionTemplateLiteral)return""===e.text;return!1}(e.left)){b(Ne(t.U.htmlEscape(_.definitionName),e.right,_.shadowBlockId||"text"));break}}b(Ne(t.U.htmlEscape(_.definitionName),m,_.shadowBlockId,i));break;default:let w;const N=t.U.htmlEscape(_.definitionName);let O=!0;if("Math.random"==a.qName)w=he(N,function(e){switch(e.kind){case s.NumericLiteral:return De((parseInt(e.text)-1).toString());case s.BinaryExpression:const t=e;if(t.operatorToken.kind==s.PlusToken&&"1"==t.right.text)return xe(t.left);default:return xe(e)}}(m),l,i),O=!1;else if(D(m)){const e="text"==_.fieldEditor?m.text:m.getText(),n=_.shadowBlockId&&!function(e){switch(e){case l:case c:case u:case d:case p:case h:return!0;default:return!1}}(_.shadowBlockId);if(qe(_)&&_.fieldOptions.onParentBlock)return void v(Fe(N,e));if(n){const n=function(e){if(o.blocksById[e]){const t=pxt.blocks.compileInfo(o.blocksById[e]);if(!t.thisParameter&&1===t.parameters.length)return t.parameters[0]}return}(_.shadowBlockId);if(n&&qe(n)){const r=Le(_.shadowBlockId,n.definitionName,e,!0);_.shadowOptions&&(r.mutation={customfield:t.Util.htmlEscape(JSON.stringify(_.shadowOptions))}),w=he(N,r,_.shadowBlockId,i),O=!1}}}else if(m.kind===s.TaggedTemplateExpression&&_.fieldOptions&&_.fieldOptions[r.TaggedTemplate])return void v(Fe(N,t.Util.htmlEscape(m.getText())));O&&(w=Ne(N,m,_.shadowBlockId,i)),b(w)}})),T)if(y.mutation||(y.mutation={}),f.compileHiddenArguments){let e=0,n=0;for(const r of m){const i=t.U.htmlEscape(r.param.definitionName),s=y.inputs.find((e=>e.name===i));r.param.isOptional?s&&!z(s)&&(n=Math.max(r.param.definitionIndex-e+1,n)):e++}y.mutation._expanded=n.toString()}else y.mutation._expanded=T.toString();return y}(_,f);break;case s.DebuggerStatement:g=function(e){return de(t.TS_DEBUGGER_TYPE,e)}(_);break;case s.BreakStatement:g=function(e){return de(t.TS_BREAK_TYPE,e)}(_);break;case s.ContinueStatement:g=function(e){return de(t.TS_CONTINUE_TYPE,e)}(_);break;case s.EmptyStatement:g=void 0;break;case s.EnumDeclaration:case s.ModuleDeclaration:return W(_,ee),k();case s.ReturnStatement:g=function(e){const n=de(t.TS_RETURN_STATEMENT_TYPE,e);e.expression?n.inputs=[he("RETURN_VALUE",xe(e.expression),l)]:n.mutation={no_return_value:"true"};return n}(_);break;default:return void se(_,i?t.Util.lf("Unsupported statement in block: {0}",s[_.kind]):t.Util.lf("Statement kind unsupported in blocks: {0}",s[_.kind]))}if(g){let e=g;for(;e.next;)e=e.next;e.next=k(),e.next&&(e.next.prev=e)}return y||Ve(a||_,g),g;function k(){if(i&&i.length)return He(i.shift(),i,void 0,!1,m)}}function Ge(e,n,r){m.errorOnGreyBlocks&&se(e);const i=de(t.TS_STATEMENT_TYPE,e);i.mutation={},Ze(e);let o=e.getText();o=Se(o,e.getStart(),e.getEnd()),W(e,ee),n&&(o=n+o);const a=[];if(e.kind===s.VariableStatement)for(const t of e.declarationList.declarations)a.push(et(t.name));else e.kind===s.VariableDeclaration&&a.push(et(e.name));a.length&&(i.mutation.declaredvars=a.join(","));const l=o.split("\n");return i.mutation.numlines=l.length.toString(),r&&m.includeGreyBlockMessages&&(i.mutation.error=t.U.htmlEscape(r)),l.forEach(((e,n)=>{i.mutation[`line${n}`]=t.U.htmlEscape(e)})),i}function je(n,r){if(function(n){const r=I(n);switch(r.kind){case s.TrueKeyword:case s.FalseKeyword:case s.Identifier:case s.ElementAccessExpression:return;case s.BinaryExpression:return i(r);case s.CallExpression:return o(r);case s.PrefixUnaryExpression:if(r.operator===s.ExclamationToken)return;default:return t.Util.lf("Conditions must evaluate to booleans or identifiers")}function i(e){switch(e.operatorToken.kind){case s.EqualsEqualsToken:case s.EqualsEqualsEqualsToken:case s.ExclamationEqualsToken:case s.ExclamationEqualsEqualsToken:case s.LessThanToken:case s.LessThanEqualsToken:case s.GreaterThanToken:case s.GreaterThanEqualsToken:case s.AmpersandAmpersandToken:case s.BarBarToken:return;default:return t.Util.lf("Binary expressions in conditionals must evaluate to booleans")}}function o(n){const r=t.pxtInfo(n).callInfo;if(r){const t=V.blocks.apis.byQName[r.qName];if(t&&"boolean"==t.retType)return;if(e.isIdentifier(n.expression)&&V.declaredFunctions[n.expression.text])return}return t.Util.lf("Only functions that return booleans are allowed as conditions")}}(r)){return he(n,Ce(r),h)}return Ne(n,r,h)}function Ke(e,t,n,r=!1,i=!1){const s=et(t);Qe(s,b.InBlocksOnly);const o=de(r?"variables_change":"variables_set",e.parent||e);return o.inputs=[Ne("VALUE",n,l)],o.fields=[Fe("VAR",s)],o}function We(e,t,n,r){return ze(e,t,n,r)}function ze(e,n,r,i){const s=t.pxtInfo(n).callInfo,o=V.blocks.apis.byQName[s?s.qName:""];if(!o||!o.attributes.blockCombine)return void se(n);const a=`${o.namespace}.${o.retType}.${i}`,l=V.blocks.blocks.find((e=>e.qName==a)),c=r?de(l.attributes.blockId,e):pe(l.attributes.blockId),u=l.attributes._def.parameters;let d=s.qName;return l.combinedProperties&&l.combinedProperties.forEach((e=>{0===e.indexOf(s.qName)&&"@"===e.charAt(s.qName.length)&&(d=e)})),c.inputs=[Ne(u[0].name,n.expression)],c.fields=[Fe(u[1].name,d)],r&&c.inputs.push(Ne(u[2].name,r)),c}function qe(e){return e&&e.fieldOptions&&e.fieldOptions[r.DecompileLiterals]}function Je(e){let t={ifStatements:[{expression:e.expression,thenStatement:e.thenStatement}],elseStatement:e.elseStatement};if(e.elseStatement&&e.elseStatement.kind==s.IfStatement){let n=Je(e.elseStatement);t.ifStatements=t.ifStatements.concat(n.ifStatements),t.elseStatement=n.elseStatement}return t}function Ye(t,n,r=!1,i,o=!1){const a=[],l=n||[];for(let e=t.length-1;e>=0;e--){const n=t[e];(n.kind===s.FunctionDeclaration||n.kind==s.ExpressionStatement&&fe(n))&&!v(n,V,!1,r)?a.unshift(n):l.unshift(n)}const c=[],u={};for(const e of a){const t=e.kind===s.FunctionDeclaration?void 0:ae(e);t&&u[t]?c.push(He(e,void 0,void 0,!1,!1)):(u[t]=!0,c.push(He(e,void 0,void 0,!1,r)))}if(c.forEach(me),l.length){const t=l.shift(),n=He(t,l,i,!1,r);if(o){let r=n,i=t;if(X.forEach((([e,n])=>{if(J[e]===b.InBlocksOnly)return;let s;n.initializer;s=J[e]===b.InTextBlocks?Ge(n,"let "):Ke(t,n.name,n.initializer,!1,!0),s.next=r,r=s,i=n,Ve(i.parent,r)})),r){const t=de(e.pxtc.ON_START_TYPE,i);return t.handlers=[{name:"HANDLER",statement:r}],t}Xe(n)}return n}o&&Xe(void 0)}function Xe(t){m.alwaysEmitOnStart&&(ke(e.pxtc.ON_START_TYPE,t),Ee())}function Qe(e,t){J[e]!==b.InTextBlocks&&(J[e]=t)}function Ze(t){e.forEachChild(t,(e=>{e.kind===s.Identifier&&Qe(et(e),b.InTextBlocks),Ze(e)}))}function et(e){if(_){const t=_.getRenameForPosition(e.getStart());if(t)return t.name}return e.text}},n.getLeadingComments=function(t,n,r){return H(n,r||e.getLeadingCommentRangesOfNode(t,n))},n.getTrailingComments=function(t,n){return H(n,e.getTrailingCommentRanges(n.getFullText(),t.end))},n.getCommentsForStatement=function(e,t){let n,r=[];for(let i=0;i<t.length&&(n=t[i],!n.owner&&n.start>=e.pos&&n.end<=e.end&&(n.owner=e,r.push(n)),!(n.start>e.end));i++);return r},n.buildCommentMap=K}(t.decompiler||(t.decompiler={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(e){function t(e,n){var r;switch(e){case"void":return"None";case"boolean":return"bool";case"string":return"str"}if(null===(r=n.byQName[e])||void 0===r?void 0:r.pyQName)return n.byQName[e].pyQName;const i=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e);return i?`List[${t(i[1]||i[2],n)}]`:e}function n(e,t){return`\`\`\`${t?"python":"ts"}\n${e}\n\`\`\``}e.displayStringForSymbol=function(e,r,i){if(e){switch(e.kind){case 3:case 1:return function(e,r,i){let s="";3===e.kind?s+=r?"def ":"function ":s+="(method) ";s+=r?e.pyQName:e.qName;let o="";e.parameters&&e.parameters.length&&(o=e.parameters.map((e=>`${e.name}: ${r?e.pyTypeString:e.type}`)).join(", "));let a=e.retType||"void";r&&(a=t(a,i));return n(`${s}(${o}): ${a}`,r)}(e,r,i);case 6:case 7:return function(e,t){const r=t?e.pyQName:e.qName;if(6===e.kind)return n(`enum ${r}`,t);let i=`(enum member) ${r}`;e.attributes.enumval&&(i+=` = ${e.attributes.enumval}`);return n(i,!1)}(e,r);case 5:return function(e,t){return n(`namespace ${t?e.pyQName:e.qName}`,!1)}(e,r);case 9:return function(e,t){return n(`interface ${t?e.pyQName:e.qName}`,!1)}(e,r);case 8:return function(e,t){return n(`class ${t?e.pyQName:e.qName}`,t)}(e,r);case 4:return function(e,r,i){let s=r?e.pyQName:`let ${e.qName}`;if(e.retType){let o=e.retType;return r&&(o=t(o,i)),n(`${s}: ${o}`,r)}return n(s,r)}(e,r,i);case 2:return function(e,r,i){const s=`(property) ${r?e.pyQName:e.qName}`;if(e.retType){let o=e.retType;return r&&(o=t(o,i)),n(`${s}: ${o}`,!1)}return n(s,!1)}(e,r,i)}return`**${e.qName}**`}},e.displayStringForKeyword=function(e,t){return`\`\`\`${t?"py":"ts"}\n(keyword) ${e}\n\`\`\``}}(e.service||(e.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){const n={r0:0,r1:1,r2:2,r3:3,r4:4,r5:5,r6:6,r7:7,r8:8,r9:9,r10:10,r11:10,r12:12,sp:13,r13:13,lr:14,r14:14,pc:15,r15:15};class r extends e.assembler.AbstractProcessor{constructor(){super(),this.addEnc("$r0","R0-7",(e=>this.inrange(7,e,e))),this.addEnc("$r1","R0-7",(e=>this.inrange(7,e,e<<3))),this.addEnc("$r2","R0-15",(e=>this.inrange(15,e,7&e|(8&e)<<4))),this.addEnc("$r3","R0-15",(e=>this.inrange(15,e,e<<3))),this.addEnc("$r4","R0-7",(e=>this.inrange(7,e,e<<6))),this.addEnc("$r5","R0-7",(e=>this.inrange(7,e,e<<8))),this.addEnc("$r01","R0-7",(e=>this.inrange(7,e,e|e<<3))),this.addEnc("$i0","#0-255",(e=>this.inrange(255,e,e))),this.addEnc("$i1","#0-1020",(e=>this.inrange(255,e/4,e>>2))),this.addEnc("$i2","#0-510",(e=>this.inrange(127,e/4,e>>2))),this.addEnc("$i3","#0-7",(e=>this.inrange(7,e,e<<6))),this.addEnc("$i4","#0-31",(e=>this.inrange(31,e,e<<6))),this.addEnc("$i5","#0-124",(e=>this.inrange(31,e/4,e>>2<<6))),this.addEnc("$i6","#1-32",(e=>0==e?null:32==e?0:this.inrange(31,e,e<<6))),this.addEnc("$i7","#0-62",(e=>this.inrange(31,e/2,e>>1<<6))),this.addEnc("$i32","#0-2^32",(e=>1)),this.addEnc("$rl0","{R0-7,...}",(e=>this.inrange(255,e,e))),this.addEnc("$rl1","{LR,R0-7,...}",(e=>16384&e?this.inrange(255,-16385&e,256|255&e):this.inrange(255,e,e))),this.addEnc("$rl2","{PC,R0-7,...}",(e=>32768&e?this.inrange(255,-32769&e,256|255&e):this.inrange(255,e,e))),this.addEnc("$la","LABEL",(e=>this.inrange(255,e/4,e>>2))).isWordAligned=!0,this.addEnc("$lb","LABEL",(e=>this.inrangeSigned(127,e/2,e>>1))),this.addEnc("$lb11","LABEL",(e=>this.inrangeSigned(1023,e/2,e>>1))),this.addInst("adcs  $r0, $r1",16704,65472),this.addInst("add   $r2, $r3",17408,65280),this.addInst("add   $r5, pc, $i1",40960,63488),this.addInst("add   $r5, sp, $i1",43008,63488),this.addInst("add   sp, $i2",45056,65408).canBeShared=!0,this.addInst("adds  $r0, $r1, $i3",7168,65024),this.addInst("adds  $r0, $r1, $r4",6144,65024),this.addInst("adds  $r01, $r4",6144,65024),this.addInst("adds  $r5, $i0",12288,63488),this.addInst("adr   $r5, $la",40960,63488),this.addInst("ands  $r0, $r1",16384,65472),this.addInst("asrs  $r0, $r1",16640,65472),this.addInst("asrs  $r0, $r1, $i6",4096,63488),this.addInst("bics  $r0, $r1",17280,65472),this.addInst("bkpt  $i0",48640,65280),this.addInst("blx   $r3",18304,65415),this.addInst("bx    $r3",18176,65408),this.addInst("cmn   $r0, $r1",17088,65472),this.addInst("cmp   $r0, $r1",17024,65472),this.addInst("cmp   $r2, $r3",17664,65280),this.addInst("cmp   $r5, $i0",10240,63488),this.addInst("eors  $r0, $r1",16448,65472),this.addInst("ldmia $r5!, $rl0",51200,63488),this.addInst("ldmia $r5, $rl0",51200,63488),this.addInst("ldr   $r0, [$r1, $i5]",26624,63488),this.addInst("ldr   $r0, [$r1, $r4]",22528,65024),this.addInst("ldr   $r5, [pc, $i1]",18432,63488),this.addInst("ldr   $r5, $la",18432,63488),this.addInst("ldr   $r5, [sp, $i1]",38912,63488).canBeShared=!0,this.addInst("ldr   $r5, [sp]",38912,63488).canBeShared=!0,this.addInst("ldrb  $r0, [$r1, $i4]",30720,63488),this.addInst("ldrb  $r0, [$r1, $r4]",23552,65024),this.addInst("ldrh  $r0, [$r1, $i7]",34816,63488),this.addInst("ldrh  $r0, [$r1, $r4]",23040,65024),this.addInst("ldrsb $r0, [$r1, $r4]",22016,65024),this.addInst("ldrsh $r0, [$r1, $r4]",24064,65024),this.addInst("lsls  $r0, $r1",16512,65472),this.addInst("lsls  $r0, $r1, $i4",0,63488),this.addInst("lsrs  $r0, $r1",16576,65472),this.addInst("lsrs  $r0, $r1, $i6",2048,63488),this.addInst("mov   $r2, $r3",17920,65280),this.addInst("movs  $r0, $r1",0,65472),this.addInst("movs  $r5, $i0",8192,63488),this.addInst("muls  $r0, $r1",17216,65472),this.addInst("mvns  $r0, $r1",17344,65472),this.addInst("negs  $r0, $r1",16960,65472),this.addInst("nop",18112,65535),this.addInst("orrs  $r0, $r1",17152,65472),this.addInst("pop   $rl2",48128,65024),this.addInst("push  $rl1",46080,65024),this.addInst("rev   $r0, $r1",47616,65472),this.addInst("rev16 $r0, $r1",47680,65472),this.addInst("revsh $r0, $r1",47808,65472),this.addInst("rors  $r0, $r1",16832,65472),this.addInst("sbcs  $r0, $r1",16768,65472),this.addInst("sev",48960,65535),this.addInst("stm   $r5!, $rl0",49152,63488),this.addInst("stmia $r5!, $rl0",49152,63488),this.addInst("stmea $r5!, $rl0",49152,63488),this.addInst("str   $r0, [$r1, $i5]",24576,63488).canBeShared=!0,this.addInst("str   $r0, [$r1]",24576,63488).canBeShared=!0,this.addInst("str   $r0, [$r1, $r4]",20480,65024),this.addInst("str   $r5, [sp, $i1]",36864,63488).canBeShared=!0,this.addInst("str   $r5, [sp]",36864,63488).canBeShared=!0,this.addInst("strb  $r0, [$r1, $i4]",28672,63488),this.addInst("strb  $r0, [$r1, $r4]",21504,65024),this.addInst("strh  $r0, [$r1, $i7]",32768,63488),this.addInst("strh  $r0, [$r1, $r4]",20992,65024),this.addInst("sub   sp, $i2",45184,65408),this.addInst("subs  $r0, $r1, $i3",7680,65024),this.addInst("subs  $r0, $r1, $r4",6656,65024),this.addInst("subs  $r01, $r4",6656,65024),this.addInst("subs  $r5, $i0",14336,63488),this.addInst("svc   $i0",57088,65280),this.addInst("sxtb  $r0, $r1",45632,65472),this.addInst("sxth  $r0, $r1",45568,65472),this.addInst("tst   $r0, $r1",16896,65472),this.addInst("udf   $i0",56832,65280),this.addInst("uxtb  $r0, $r1",45760,65472),this.addInst("uxth  $r0, $r1",45696,65472),this.addInst("wfe",48928,65535),this.addInst("wfi",48944,65535),this.addInst("yield",48912,65535),this.addInst("cpsid i",46706,65535),this.addInst("cpsie i",46690,65535),this.addInst("beq   $lb",53248,65280),this.addInst("bne   $lb",53504,65280),this.addInst("bcs   $lb",53760,65280),this.addInst("bcc   $lb",54016,65280),this.addInst("bmi   $lb",54272,65280),this.addInst("bpl   $lb",54528,65280),this.addInst("bvs   $lb",54784,65280),this.addInst("bvc   $lb",55040,65280),this.addInst("bhi   $lb",55296,65280),this.addInst("bls   $lb",55552,65280),this.addInst("bge   $lb",55808,65280),this.addInst("blt   $lb",56064,65280),this.addInst("bgt   $lb",56320,65280),this.addInst("ble   $lb",56576,65280),this.addInst("bhs   $lb",53760,65280),this.addInst("blo   $lb",54016,65280),this.addInst("b     $lb11",57344,63488),this.addInst("bal   $lb11",57344,63488),this.addInst("bl    $lb",61440,63488,!0),this.addInst("bb    $lb",57344,63488,!0),this.addInst("ldlit   $r5, $i32",18432,63488)}toFnPtr(t,n,r){return e.target.runtimeIsARM&&/::/.test(r)?t+n&-2:t+n|1}wordSize(){return 4}is32bit(e){return"bl"==e.name||"bb"==e.name}postProcessAbsAddress(e,t){return t^=1,t-=e.baseOffset}emit32(t,n,r){let i=!!(n%2);i&&(n=n+1&-4);let s=n>>1;if(e.assert(null!=s),(0|s)!=s||!(-2097152<s&&s<2097152))return e.assembler.emitErr("jump out of range",r);let o=2047&s,a=s>>11&1023;return{opcode:4026531840&s?62464|a:61440|a,opcode2:i?59392|o:63488|o,stack:0,numArgs:[n],labelName:r}}expandLdlit(t){let n,r=!1,i=[],s={},o=1;for(let a=0;a<t.lines.length;++a){let l=t.lines[a];if(i.push(l),"instruction"==l.type&&l.instruction&&"ldlit"==l.instruction.name){if(!n){let e=l.location+900,i=a+1;for(;i<t.lines.length&&!(t.lines[i].location>e);++i){let e=t.lines[i].getOp();("b"==e||"bb"==e||"pop"==e&&"pc"==t.lines[i].words[2])&&(n=t.lines[i])}if(n)r=!1;else for(r=!0;--i>a;)if("instruction"==t.lines[i].type){n=t.lines[i];break}}let i=l.words[1],c="#"+l.words[3],u=e.U.lookup(s,c);u||(u="_ldlit_"+ ++o,s[c]=u),l.ldlitLabel=l.words[3],l.update(`ldr ${i}, ${u} ; ${l.ldlitLabel}`)}if(l===n){n=null;let e=[],a="_jmpwords_"+ ++o;r&&e.push("bb "+a),e.push(".object PUSH"),e.push(".balign 4");for(let t of Object.keys(s)){let n=s[t];e.push(n+": .word "+t.slice(1))}r&&e.push(a+":"),e.push(".object POP");for(let n of e){t.buildLine(n,i);let e=i[i.length-1];e.scope=l.scope,e.lineNo=l.lineNo}s={}}}t.lines=i}getAddressFromLabel(e,t,n,r=!1){let i=e.lookupLabel(n);if(null==i)return null;let s=e.location()+4;return r&&(s&=4294967292),i-s}isPop(e){return 48128==e}isPush(e){return 46080==e}isAddSP(e){return 45056==e}isSubSP(e){return 45184==e}peephole(t,n,r){let s=this.encoders.$lb11,o=this.encoders.$lb;function a(e,t){return null!=e.encode(t.numArgs[0]+8)&&null!=e.encode(t.numArgs[0]-8)&&null!=e.encode(t.numArgs[0])}let l=t.getOp(),c=!1;"bne"!=l&&"beq"!=l||("b"==n.getOp()&&0==t.numArgs[0]&&(c=!0),"bb"==n.getOp()&&2==t.numArgs[0]&&(c=!0)),"bb"==l&&a(s,t)?t.update("b "+t.words[1]):"b"==l&&-2==t.numArgs[0]?t.update(""):"bne"==l&&c&&a(o,n)?(t.update("beq "+n.words[1]),n.update("")):"beq"==l&&c&&a(o,n)?(t.update("bne "+n.words[1]),n.update("")):"push"!=l||16384!=t.numArgs[0]||"push"!=n.getOp()||16384&n.numArgs[0]?"pop"==l&&"pop"==n.getOp()&&32768==n.numArgs[0]?(t.update(t.text.replace("}",", pc}")),n.update("")):"push"==l&&"pop"==n.getOp()&&t.numArgs[0]==n.numArgs[0]?(e.assert(t.numArgs[0]>0),t.update(""),n.update("")):"push"==l&&"pop"==n.getOp()&&4==t.words.length&&4==n.words.length?(e.assert("{"==t.words[1]),t.update("mov "+n.words[2]+", "+t.words[2]),n.update("")):r&&"movs $r5, $i0"==t.getOpExt()&&"mov $r0, $r1"==n.getOpExt()&&t.numArgs[0]==n.numArgs[1]&&function(e,t){return!!("pop"==e.getOp()&&e.numArgs[0]&1<<t)}(r,t.numArgs[0])?(t.update("movs r"+n.numArgs[0]+", #"+t.numArgs[1]),n.update("")):"pop"==l&&i(t)>=0&&"push"==n.getOp()&&i(t)==i(n)?(t.update("ldr r"+i(t)+", [sp, #0]"),n.update("")):"push"==l&&"ldr $r5, [sp, $i1]"==n.getOpExt()&&i(t)==n.numArgs[0]&&0==n.numArgs[1]?n.update(""):r&&"push"==l&&i(t)>=0&&function(e,t){return"movs $r5, $i0"==e.getOpExt()&&e.numArgs[0]!=t}(n,i(t))&&"pop"==r.getOp()&&i(t)==i(r)&&(t.update(""),r.update("")):(t.update(n.text.replace("{","{lr, ")),n.update(""))}registerNo(e){if(!e)return null;e=e.toLowerCase();const t=n[e];return void 0===t?null:t}testAssembler(){e.assembler.expectError(this,"lsl r0, r0, #8"),e.assembler.expectError(this,"push {pc,lr}"),e.assembler.expectError(this,"push {r17}"),e.assembler.expectError(this,"mov r0, r1 foo"),e.assembler.expectError(this,"movs r14, #100"),e.assembler.expectError(this,"push {r0"),e.assembler.expectError(this,"push lr,r0}"),e.assembler.expectError(this,"pop {lr,r0}"),e.assembler.expectError(this,"b #+11"),e.assembler.expectError(this,"b #+102400"),e.assembler.expectError(this,"bne undefined_label"),e.assembler.expectError(this,".foobar"),e.assembler.expect(this,"0200      lsls    r0, r0, #8\nb500      push    {lr}\n2064      movs    r0, #100        ; 0x64\nb401      push    {r0}\nbc08      pop     {r3}\nb501      push    {r0, lr}\nbd20      pop {r5, pc}\nbc01      pop {r0}\n4770      bx      lr\n0000      .balign 4\ne6c0      .word   -72000\nfffe\n"),e.assembler.expect(this,"4291      cmp     r1, r2\nd100      bne     l6\ne000      b       l8\n1840  l6: adds    r0, r0, r1\n4718  l8: bx      r3\n"),e.assembler.expect(this,"          @stackmark base\nb403      push    {r0, r1}\n          @stackmark locals\n9801      ldr     r0, [sp, locals@1]\nb401      push    {r0}\n9802      ldr     r0, [sp, locals@1]\nbc01      pop     {r0}\n          @stackempty locals\n9901      ldr     r1, [sp, locals@1]\n9102      str     r1, [sp, base@0]\n          @stackempty locals\nb002      add     sp, #8\n          @stackempty base\n"),e.assembler.expect(this,"b090      sub sp, #4*16\nb010      add sp, #4*16\n"),e.assembler.expect(this,'6261      .string "abc"\n0063      \n'),e.assembler.expect(this,'6261      .string "abcde"\n6463      \n0065      \n'),e.assembler.expect(this,"3042      adds r0, 0x42\n1c0d      adds r5, r1, #0\nd100      bne #0\n2800      cmp r0, #0\n6b28      ldr r0, [r5, #48]\n0200      lsls r0, r0, #8\n2063      movs r0, 0x63\n4240      negs r0, r0\n46c0      nop\nb500      push {lr}\nb401      push {r0}\nb402      push {r1}\nb404      push {r2}\nb408      push {r3}\nb520      push {r5, lr}\nbd00      pop {pc}\nbc01      pop {r0}\nbc02      pop {r1}\nbc04      pop {r2}\nbc08      pop {r3}\nbd20      pop {r5, pc}\n9003      str r0, [sp, #4*3]\n")}}function i(t){e.assert("push"==t.getOp()||"pop"==t.getOp());let n=0,r=-1,i=t.numArgs[0];for(;i>0;)1&i&&(r=-1==r?n:-2),i>>=1,n++;return r>=0?r:-1}t.ThumbProcessor=r}(e.thumb||(e.thumb={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){let r,i=t.Util;i.assert;!function(e){e[e.None=0]="None",e[e.NumberLiteral=1]="NumberLiteral",e[e.PointerLiteral=2]="PointerLiteral",e[e.RuntimeCall=3]="RuntimeCall",e[e.ProcCall=4]="ProcCall",e[e.SharedRef=5]="SharedRef",e[e.SharedDef=6]="SharedDef",e[e.FieldAccess=7]="FieldAccess",e[e.Store=8]="Store",e[e.CellRef=9]="CellRef",e[e.Sequence=10]="Sequence",e[e.JmpValue=11]="JmpValue",e[e.Nop=12]="Nop",e[e.InstanceOf=13]="InstanceOf"}(r=n.EK||(n.EK={}));let s,o,a=0;class l{isExpr(){return!1}isStmt(){return!1}getId(){return this._id||(this._id=++a),this._id}}n.Node=l;class c extends l{constructor(e,t,n){super(),this.exprKind=e,this.args=t,this.data=n,this.callingConvention=0}static clone(e){let t=new c(e.exprKind,e.args?e.args.slice(0):null,e.data);return e.jsInfo&&(t.jsInfo=e.jsInfo),e.totalUses&&(t.totalUses=e.totalUses,t.currUses=e.currUses),t.callingConvention=e.callingConvention,t.mask=e.mask,t.isStringLiteral=e.isStringLiteral,t}reset(){this.currUses=0,this.prevTotalUses&&(this.totalUses=this.prevTotalUses)}ptrlabel(){return this.jsInfo instanceof u?this.jsInfo:null}hexlit(){const e=this.jsInfo;return null!=e.hexlit?e.hexlit:null}isExpr(){return!0}isPure(){return this.isStateless()||this.exprKind==r.CellRef}isLiteral(){switch(this.exprKind){case r.NumberLiteral:case r.PointerLiteral:return!0;default:return!1}}isStateless(){switch(this.exprKind){case r.NumberLiteral:case r.PointerLiteral:case r.SharedRef:return!0;default:return!1}}sharingInfo(){let e=this,t=this.getId();return this.exprKind!=r.SharedRef&&this.exprKind!=r.SharedDef||(e=this.args[0],e?t=e.getId():e={currUses:"",totalUses:""}),`${e.currUses}/${e.totalUses} #${t}`}toString(){return d(this)}canUpdateCells(){switch(this.exprKind){case r.NumberLiteral:case r.PointerLiteral:case r.CellRef:case r.JmpValue:case r.SharedRef:case r.Nop:return!1;case r.SharedDef:case r.FieldAccess:case r.InstanceOf:return this.args[0].canUpdateCells();case r.RuntimeCall:case r.ProcCall:case r.Sequence:case r.Store:return!0;default:throw t.oops()}}}n.Expr=c,function(e){e[e.None=0]="None",e[e.Expr=1]="Expr",e[e.Label=2]="Label",e[e.Jmp=3]="Jmp",e[e.StackEmpty=4]="StackEmpty",e[e.Breakpoint=5]="Breakpoint",e[e.Comment=6]="Comment"}(s=n.SK||(n.SK={})),function(e){e[e.Always=1]="Always",e[e.IfZero=2]="IfZero",e[e.IfNotZero=3]="IfNotZero"}(o=n.JmpMode||(n.JmpMode={})),n.lblNumUsesJmpNext=-101;class u extends l{constructor(e,t){super(),this.stmtKind=e,this.expr=t}isStmt(){return!0}toString(){return d(this)}}function d(e){return function e(i){if(i.isExpr()){let n=i,s=n.args?n.args[0]:null;switch(n.exprKind){case r.NumberLiteral:case r.PointerLiteral:return n.data+"";case r.CellRef:return n.data.toString();case r.JmpValue:return"JMPVALUE";case r.Nop:return"NOP";case r.SharedRef:return`SHARED_REF(#${s.getId()})`;case r.SharedDef:return`SHARED_DEF(#${s.getId()} u(${s.totalUses}): ${e(s)})`;case r.FieldAccess:return`${e(s)}.${n.data.name}`;case r.RuntimeCall:return n.data+"("+n.args.map(e).join(", ")+")";case r.ProcCall:let i=n.data,o="";return o=null!=i.ifaceIndex?`IFACE@${i.ifaceIndex}`:null!=i.virtualIndex?`VTABLE@${i.virtualIndex}`:t.getDeclName(i.proc.action),o+"("+n.args.map(e).join(", ")+")";case r.Sequence:return"("+n.args.map(e).join("; ")+")";case r.InstanceOf:return"("+e(n.args[0])+" instanceof "+n.data.id+")";case r.Store:return`{ ${e(n.args[0])} := ${e(n.args[1])} }`;default:throw t.oops()}}else{let r=i,s=r.expr?e(r.expr):"{null}";switch(r.stmtKind){case n.SK.Expr:return"    "+s+"\n";case n.SK.Jmp:let e=`goto ${r.lblName}\n`;switch(r.jmpMode){case o.Always:return r.expr?`    { JMPVALUE := ${s} } ${e}`:"    "+e;case o.IfZero:return`    if (! ${s}) ${e}`;case o.IfNotZero:return`    if (${s}) ${e}`;default:throw t.oops()}case n.SK.StackEmpty:return"    ;\n";case n.SK.Breakpoint:return"    // brk "+r.breakpointInfo.id+"\n";case n.SK.Comment:return"    // "+r.expr.data+"\n";case n.SK.Label:return r.lblName+":\n";default:throw t.oops()}}}(e)}n.Stmt=u;class p{constructor(e,n,r){this.index=e,this.def=n,this.info=r,this.isarg=!1,this.iscap=!1,this._isLocal=!1,this._isGlobal=!1,this._debugType="?",this.isUserVariable=!1,this.bitSize=0,n&&(t.isInPxtModules(n)||(this.isUserVariable=!0),r&&t.setCellProps(this))}getName(){return t.getDeclName(this.def)}getDebugInfo(){return{name:this.getName(),type:this._debugType,index:this.index}}toString(){let e="";return this.def&&(e+=this.getName()||"?"),this.isarg&&(e="ARG "+e),"["+e+"]"}uniqueName(){return this.isarg?"arg"+this.index:this.getName().replace(/[^\w]/g,"_")+"___"+t.getNodeId(this.def)}isLocal(){return this._isLocal}isGlobal(){return this._isGlobal}loadCore(){return g(r.CellRef,null,this)}load(){let e=this.loadCore();return t.target.isNative&&!t.isStackMachine()&&0!=this.bitSize?6==this.bitSize?b("pxt::fromUInt",[e]):b("pxt::fromInt",[e]):this.isByRefLocal()?b("pxtrt::ldlocRef",[e]):e}isByRefLocal(){return this.isLocal()&&this.info.captured&&this.info.written}storeDirect(e){return g(r.Store,[this.loadCore(),e])}storeByRef(e){if(this.isByRefLocal())return b("pxtrt::stlocRef",[this.loadCore(),e]);if(t.target.isNative&&!t.isStackMachine()&&0!=this.bitSize){let t=6==this.bitSize?"pxt::toUInt":"pxt::toInt";return this.storeDirect(b(t,[e],1))}return this.storeDirect(e)}get isTemporary(){return!1}}n.Cell=p;class h extends p{constructor(e,t){super(e,null,null),this.index=e,this.owningProc=t,this.uid=h.unnamedCellCounter++}getName(){return"unnamed"+this.uid}uniqueName(){return this.getName()+"___U"+this.index}isByRefLocal(){return!1}get isTemporary(){return!0}}function f(e){const t=()=>{if(!e.args)return 0;let t=0;for(let n of e.args)t+=f(n);return e.mask&&e.mask.conversions&&(t+=4*e.mask.conversions.length),t};switch(e.exprKind){case r.NumberLiteral:return 2;case r.PointerLiteral:return 6;case r.RuntimeCall:return t()+2+2+4;case r.CellRef:return 2;case r.FieldAccess:return t()+(e.data.needsCheck?4:0)+2;case r.ProcCall:case r.SharedRef:case r.SharedDef:case r.Store:case r.Sequence:case r.JmpValue:case r.Nop:case r.InstanceOf:return 1e6;default:throw i.oops()}}function m(e){switch((e=c.clone(e)).exprKind){case r.PointerLiteral:case r.NumberLiteral:return e;case r.RuntimeCall:for(let t=0;t<e.args.length;++t)e.args[t]=m(e.args[t]);return e;case r.CellRef:const t=e.data;return t.repl?(t.replUses++,t.repl):e;case r.FieldAccess:return e.args[0]=m(e.args[0]),e;default:throw i.oops()}}h.unnamedCellCounter=0,n.UnnamedCell=h;function _(e,t){return new u(e,t)}function g(e,t,n){return new c(e,t,n)}function y(e,t){let n=g(r.PointerLiteral,null,e);return n.jsInfo=t,n}function b(e,t,n=0){let i=g(r.RuntimeCall,t,e);return n&&(i.mask={refMask:n}),i}function v(e,s=!1,o=!1){let a=!!s&&e.some((e=>e.canUpdateCells())),l=[];for(let t of i.reversed(e))t.isStateless()||(t.exprKind!=r.CellRef||a)&&(t.canUpdateCells()&&(a=!0),l.push(t));l.reverse(),t.isStackMachine()&&!o&&(l=[]);let c=[],u=e.map((e=>{if(l.indexOf(e)>=0){let t=e,i=e;return e.exprKind==r.SharedDef?(e.args[0].totalUses++,t=n.op(r.SharedRef,[e.args[0]])):(t=n.op(r.SharedRef,[e]),i=n.op(r.SharedDef,[e]),e.totalUses=2,e.currUses=0),c.push(i),t}return e}));return{precomp:c,flattened:u}}n.Procedure=class extends l{constructor(){super(...arguments),this.numArgs=0,this.info=null,this.seqNo=-1,this.isRoot=!1,this.locals=[],this.captured=[],this.args=[],this.parent=null,this.debugInfo=null,this.fillDebugInfo=null,this.classInfo=null,this.perfCounterName=null,this.perfCounterNo=0,this.body=[],this.lblNo=0,this.action=null,this.cachedJS=null,this.usingCtx=null}reset(){this.body=[],this.lblNo=0,this.locals=[],this.captured=[],this.args=[]}isGetter(){return this.action&&this.action.kind==e.SyntaxKind.GetAccessor}vtLabel(){return this.label()+(t.isStackMachine()?"":"_args")}label(){return t.getFunctionLabel(this.action)}toString(){return`\nPROC ${t.getDeclName(this.action)}\n${this.body.map((e=>e.toString())).join("")}\n`}emit(e){this.body.push(e)}emitExpr(e){this.emit(_(s.Expr,e))}mkLabel(e){let t=_(s.Label,null);return t.lblName="."+e+"_"+this.lblNo+++"_"+this.seqNo,t.lbl=t,t}emitLbl(e){this.emit(e)}emitLblDirect(e){let t=_(s.Label,null);t.lblName=e,t.lbl=t,this.emit(t)}getFullName(){let n=t.getDeclName(this.action);if(this.action){let t=e.pxtc.nodeLocationInfo(this.action);n=t.fileName.replace("pxt_modules/","")+"("+(t.line+1)+","+(t.column+1)+"): "+n}return n}getName(){return(this.action&&this.action.name?this.action.name.text:null)||"inline"}mkLocal(e,t){let n=new p(this.locals.length,e,t);return this.locals.push(n),n}mkLocalUnnamed(){let e=new h(this.locals.length,this);return this.locals.push(e),e}localIndex(e,t=!1){return this.captured.filter((t=>t.def==e))[0]||this.locals.filter((t=>t.def==e))[0]||(t?null:this.args.filter((t=>t.def==e))[0])}stackEmpty(){this.emit(_(s.StackEmpty,null))}emitJmpZ(e,t){this.emitJmp(e,t,o.IfZero)}emitJmp(e,t,n=o.Always,i=null){let a=_(s.Jmp,t);a.jmpMode=n,i&&i.exprKind==r.NumberLiteral&&(i=null),a.terminateExpr=i,"string"==typeof e?a.lblName=e:(a.lbl=e,a.lblName=a.lbl.lblName),this.emit(a)}inlineSelf(e){const{precomp:t,flattened:n}=v(e,!1,!0);i.assert(n.length==this.args.length),this.args.map(((e,t)=>{e.repl=n[t],e.replUses=0}));const s=m(this.inlineBody);return this.args.forEach(((e,t)=>{e.repl.exprKind==r.SharedRef&&(e.repl.args[0].prevTotalUses||(e.repl.args[0].prevTotalUses=e.repl.args[0].totalUses),e.repl.args[0].totalUses+=e.replUses-1),e.repl=null,e.replUses=0})),t.length?(t.push(s),g(r.Sequence,t)):s}resolve(){let e=(e,t)=>{if(e.args)for(let n=0;n<e.args.length;++n)e.args[n]=t(e.args[n])},s=t=>{switch(t.exprKind){case r.SharedDef:throw i.oops();case r.SharedRef:let e=t.args[0];if(e.totalUses)return e.totalUses--,t;{e.totalUses=-1,e.currUses=0,e.irCurrUses=0;let n=c.clone(t);return n.exprKind=r.SharedDef,n.args[0]=s(n.args[0]),n}}return e(t,s),t},o=t=>{if(t.exprKind==r.SharedRef)return t;switch(e(t,o),t.exprKind){case r.Sequence:t.args=t.args.filter(((e,n)=>n==t.args.length-1||!e.isPure()||(e.exprKind==r.SharedRef&&e.args[0].totalUses>0&&e.args[0].totalUses--,!1)))}return t},a=t=>{switch(t.exprKind){case r.SharedDef:let e=t.args[0];if(i.assert(e.totalUses<0,"arg.totalUses < 0"),i.assert(0===e.currUses,"arg.currUses === 0"),-1==e.totalUses)return a(e);e.totalUses=1;break;case r.SharedRef:return i.assert(t.args[0].totalUses>0,"e.args[0].totalUses > 0"),t.args[0].totalUses++,t;case r.PointerLiteral:const n=t.ptrlabel();n&&(n.lblNumUses||(n.lblNumUses=0),n.lblNumUses++)}return e(t,a),t},l=t=>{switch(t.exprKind){case r.SharedDef:e(t,l);case r.SharedRef:let n=t.args[0];return i.assert(n.totalUses>0,"arg.totalUses > 0"),1==n.totalUses?(i.assert(t.exprKind==r.SharedDef),n):(n.irCurrUses++,t);default:return e(t,l),t}};this.body=this.body.filter((e=>!e.expr||(e.expr=o(s(e.expr)),e.stmtKind!=n.SK.Expr||!e.expr.isPure())));let u=i.toDictionary(this.body.filter((e=>e.stmtKind==n.SK.Label)),(e=>e.lblName));for(let e=0;e<this.body.length;++e)this.body[e].stmtNo=e;for(let e of this.body)switch(e.expr&&(e.expr=a(e.expr)),e.stmtKind){case n.SK.Expr:break;case n.SK.Jmp:e.lbl=i.lookup(u,e.lblName),e.lbl||t.oops("missing label: "+e.lblName),e.lbl.lblNumUses?e.lbl.lblNumUses++:e.lbl.lblNumUses=1;break;case n.SK.StackEmpty:case n.SK.Label:case n.SK.Breakpoint:case n.SK.Comment:break;default:t.oops()}let d=[],p=null,h=!t.target.debugMode,m=null;for(let e of this.body)e.expr&&(e.expr=o(l(e.expr))),p&&p.lbl==e&&p.stmtKind==n.SK.Jmp&&e.stmtKind==n.SK.Label&&p.jmpMode==n.JmpMode.Always&&1==e.lblNumUses&&(e.lblNumUses=n.lblNumUsesJmpNext),p=e,e.stmtKind==n.SK.Breakpoint?d[e.breakpointInfo.id]=e.breakpointInfo:h&&(e.stmtKind==n.SK.Jmp?e.expr&&(m?h=!1:m=e.expr):e.stmtKind==n.SK.StackEmpty||(e.stmtKind==n.SK.Label?e.lblNumUses!=n.lblNumUsesJmpNext&&(h=!1):h=!1));if(h&&m){f(m)<=4*this.args.length+4+2+(t.target.isNative?4:30)&&(this.inlineBody=m)}pxt.options.debug&&pxt.debug(this.toString())}},n.iterExpr=function e(t,n){if(n(t),t.args)for(let r of t.args)e(r,n)},n.stmt=_,n.comment=function(e){return _(s.Comment,y(e,e))},n.op=g,n.numlit=function(e){return g(r.NumberLiteral,null,e)},n.shared=function(e){switch(e.exprKind){case r.SharedRef:e=e.args[0];break;case r.NumberLiteral:return e}return g(r.SharedRef,[e])},n.ptrlit=y,n.rtcall=b,n.rtcallMask=function(e,t,n,r){i.startsWith(e,"@nomask@")&&(e=e.slice(8),t=0);let s=b(e,r,t);return s.callingConvention=n,s},n.flattenArgs=v}(t.ir||(t.ir={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){class n{constructor(e,t){this.wave=e,this.id=t,this.flags=0,this.resetAll()}refresh(){this.flags&=-9,!this.proc||this.usedActions||w(this.proc.action)?this.proc&&!this.proc.cachedJS?this.resetEmit():this.usedNodes&&(this.flags|=32):this.resetEmit(),this.classInfo&&this.classInfo.reset()}resetEmit(){this.flags&=-41,this.proc&&this.proc.classInfo&&this.proc.classInfo.ctor==this.proc&&(this.proc.classInfo.ctor=null),this.functionInfo=null,this.variableInfo=null,this.classInfo=null,this.callInfo=null,this.proc=null,this.cell=null,this.exprInfo=null,this.usedNodes=null,this.usedActions=null}resetTSC(){this.flags&=16,this.typeCache=null,this.symbolCache=null,this.commentAttrs=null,this.valueOverride=null,this.declCache=void 0,this.fullName=null,this.constantFolded=void 0}resetAll(){this.resetTSC(),this.resetEmit()}}let r;function i(e){return e<<2|2}t.PxtNode=n,function(e){e[e.Enum=0]="Enum",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Unsupported=4]="Unsupported"}(r||(r={})),t.taggedUndefined=0,t.taggedNull=i(1),t.taggedFalse=i(2),t.taggedNaN=i(3),t.taggedTrue=i(16),t.thumbArithmeticInstr={adds:!0,subs:!0,muls:!0,ands:!0,orrs:!0,eors:!0,lsls:!0,asrs:!0,lsrs:!0},t.numberArithmeticInstr={div:!0,mod:!0,le:!0,lt:!0,ge:!0,gt:!0,eq:!0,neq:!0};const s={"Array_::getAt":{name:"_pxt_array_get",argsFmt:["T","T","T"],value:0},"Array_::setAt":{name:"_pxt_array_set",argsFmt:["T","T","T","T"],value:0},"BufferMethods::getByte":{name:"_pxt_buffer_get",argsFmt:["T","T","T"],value:0},"BufferMethods::setByte":{name:"_pxt_buffer_set",argsFmt:["T","T","T","I"],value:0},"pxtrt::mapGetGeneric":{name:"_pxt_map_get",argsFmt:["T","T","S"],value:0},"pxtrt::mapSetGeneric":{name:"_pxt_map_set",argsFmt:["T","T","S","T"],value:0}};let o=t.ir.EK;t.SK=e.SyntaxKind,t.numReservedGlobals=1;let a=0,l=1;function c(n){if(n.pxt)return!!(16&n.pxt.flags);const r=e.getSourceFileOfNode(n);return!!r&&t.isPxtModulesFilename(r.fileName)}function u(e){if(e.pxt){const n=e.pxt;return n.wave!=l&&(n.wave=l,t.compileOptions&&t.compileOptions.skipPxtModulesTSC&&16&n.flags?t.compileOptions.skipPxtModulesEmit?n.refresh():n.resetEmit():n.resetAll()),n}{const t=new n(l,++a);return c(e)&&(t.flags|=16),e.pxt=t,t}}function d(e){return u(e).id}function p(t){return t?e.SyntaxKind[t.kind]:"<null>"}function h(e,t,n=!1){let r=new Error(t);if(r.ksEmitterUserError=!0,r.ksErrorCode=e,n&&U)return F||(F=t,B=e),r;throw r}function f(){return t.target.isNative&&t.target.nativeType==t.NATIVE_TYPE_VM}function m(){return t.target.isNative&&t.target.nativeType!=t.NATIVE_TYPE_VM}function _(){return t.target.isNative&&t.target.nativeType==t.NATIVE_TYPE_THUMB}function g(e){return m()?t.ir.rtcall("pxt::fromInt",[e]):e}function y(e){return m()?t.ir.rtcall("pxt::fromBool",[e]):e}function b(e){switch(e){case 0:return t.target.shortPointers?2:4;case 1:return 1;case 3:return 2;case 5:return 4;case 2:return 1;case 4:return 2;case 6:return 4;default:throw t.oops()}}function v(e){switch(e){case 1:case 3:case 5:return!0;case 2:case 4:case 6:return!1;default:throw t.oops()}}function T(e){switch(e.kind){case t.SK.TemplateHead:case t.SK.TemplateMiddle:case t.SK.TemplateTail:case t.SK.StringLiteral:case t.SK.NoSubstitutionTemplateLiteral:return!0;default:return!1}}function k(e){return e&&e.modifiers&&e.modifiers.some((e=>e.kind==t.SK.StaticKeyword))}function E(e){return e.modifiers&&e.modifiers.some((e=>e.kind==t.SK.ReadonlyKeyword))}function x(e,t){return e.explicitDefaults?e.explicitDefaults.indexOf(t)<0?null:e.paramDefl[t]:null}function S(e){if(!e)return null;switch(e.kind){case t.SK.MethodDeclaration:return"";case t.SK.Constructor:return"new/";case t.SK.GetAccessor:return"get/";case t.SK.SetAccessor:return"set/";default:return null}}function C(e){return S(e)+K(e)}function I(e){return null!=S(e)}function A(e){return e?I(e)?e:A(e.parent):null}function w(e){let n=e,r=!1;for(;;)switch(n=n.parent,n||h(9229,$("cannot determine parent of {0}",p(e))),n.kind){case t.SK.MethodDeclaration:case t.SK.Constructor:case t.SK.GetAccessor:case t.SK.SetAccessor:case t.SK.FunctionDeclaration:case t.SK.ArrowFunction:case t.SK.FunctionExpression:return n;case t.SK.WhileStatement:case t.SK.DoStatement:case t.SK.ForInStatement:case t.SK.ForOfStatement:case t.SK.ForStatement:r=!0;break;case t.SK.SourceFile:return r?M:null}}function N(e){return"objectFlags"in e}function D(e){return!!e&&(e.kind==t.SK.VariableDeclaration||e.kind==t.SK.BindingElement&&D(e.parent.parent))}function O(e){return!!e&&(D(e)&&!w(e)||e.kind==t.SK.PropertyDeclaration&&k(e))}function R(e){return!!e&&(e.kind==t.SK.Parameter||e.kind==t.SK.BindingElement&&R(e.parent.parent))}t.isInPxtModules=c,t.pxtInfo=u,t.getNodeId=d,t.stringKind=p,t.isStackMachine=f,t.needsNumberConversions=m,t.isThumb=_,t.sizeOfBitSize=b,t.isBitSizeSigned=v,t.setCellProps=function(n){var r;if(n._isLocal=D(r=n.def)&&!O(r)||R(n.def),n._isGlobal=O(n.def),!n.def.isThisParameter){let r=ee(n.def);r.flags&e.TypeFlags.Void&&t.oops("void-typed variable, "+n.toString()),n.bitSize=function(e){if(!e||!e.type)return 0;if(!de(ee(e)))return 0;if(e.type.kind!=t.SK.TypeReference)return 0;switch(e.type.typeName.getText()){case"int8":return 1;case"int16":return 3;case"int32":return 5;case"uint8":return 2;case"uint16":return 4;case"uint32":return 6;default:return 0}}(n.def),0!=n.bitSize?n._debugType=(v(n.bitSize)?"int":"uint")+8*b(n.bitSize):ue(r)?n._debugType="string":r.flags&e.TypeFlags.NumberLike&&(n._debugType="number")}n.isLocal()&&0!=n.bitSize&&(n.bitSize=0,h(9256,$("bit sizes are not supported for locals and parameters")))},t.isStatic=k,t.isReadOnly=E,t.getExplicitDefault=x,t.isObjectType=N;class L{constructor(e,t){this.id=e,this.decl=t,this.baseClassInfo=null,this.allfields=[],this.methods={},this.attrs=j(t),this.reset()}reset(){this.vtable=null,this.itable=null}get isUsed(){return!!(8&u(this.decl).flags)}allMethods(){const e=[];for(let t of Object.keys(this.methods))for(let n of this.methods[t])e.push(n);return e}usedMethods(){const e=[];for(let t of Object.keys(this.methods))for(let n of this.methods[t]){8&u(n).flags&&e.push(n)}return e}}t.ClassInfo=L;let P,M,F,$=t.assembler.lf,B=0,U=0;function V(e,n){const r=u(n);return null==r.fullName&&(r.fullName=t.getFullName(e,n.symbol)),r.fullName}function H(n){n.kind==t.SK.VariableDeclaration&&(n=n.parent.parent);let r=t=>{const n=e.getSourceFileOfNode(t);if(!n)return"";const r=e.getLeadingCommentRangesOfNode(t,n);if(!r)return"";return r.map((e=>n.text.slice(e.pos,e.end))).join("\n")};return n.symbol&&n.symbol.declarations&&n.symbol.declarations.length>1?n.symbol.declarations.map(r).join("\n"):r(n)}function G(e){let n="";for(let t of e.declarations)n+=H(t);return t.parseCommentString(n)}function j(e){const n=e?u(e):null;if(!n||2&n.flags)return t.parseCommentString("");if(n.commentAttrs)return n.commentAttrs;let r=t.parseCommentString(H(e));return r._name=K(e),n.commentAttrs=r,r}function K(e){return e.name&&e.name.kind==t.SK.Identifier?e.name.text:"???"}function W(t){if(N(t)&&t.objectFlags&e.ObjectFlags.Reference){let e=t;if(e.typeArguments&&e.typeArguments.length)return e.target}return null}function z(t){return!!N(t)&&(t.objectFlags&e.ObjectFlags.Reference&&t.symbol&&"Array"==t.symbol.name)}function q(t){return!!N(t)&&(!!(t.objectFlags&e.ObjectFlags.Interface)||!!(t.objectFlags&e.ObjectFlags.Anonymous))}function J(t){return!!t.isThisType||!!N(t)&&!!(t.objectFlags&e.ObjectFlags.Class||t.symbol&&t.symbol.flags&e.SymbolFlags.Class)}function Y(e){let t=W(e);return J(t||e)}function X(t,n=-1){return z(t)?t.typeArguments[0]:P.getIndexTypeOfType(t,e.IndexKind.Number)}function Q(e){return e}function Z(e){return null===e?t.taggedNull:void 0===e?t.taggedUndefined:!1===e?t.taggedFalse:!0===e?t.taggedTrue:isNaN(e)?t.taggedNaN:null}function ee(t){let n;const r=u(t);if(r.typeCache)return r.typeCache;if(e.isExpression(t)&&(n=P.getContextualType(t)),!n)try{n=P.getTypeAtLocation(t)}catch(e){h(9203,$("Unknown type for expression"))}return n?(r.typeCache=n,n):n}function te(t){if(!(t.flags&e.TypeFlags.Union))return r.Unsupported;let n,i=!0;return t.types.forEach((t=>{if(void 0===n)t.flags&e.TypeFlags.NumberLike?n=r.Number:t.flags&e.TypeFlags.BooleanLike?n=r.Boolean:t.flags&e.TypeFlags.StringLike?n=r.String:t.flags&e.TypeFlags.EnumLike&&(n=r.Enum);else switch(n){case r.Number:i=i&&!!(t.flags&e.TypeFlags.NumberLike);break;case r.Boolean:i=i&&!!(t.flags&e.TypeFlags.BooleanLike);break;case r.String:i=i&&!!(t.flags&e.TypeFlags.StringLike);break;case r.Enum:i=i&&!!(t.flags&e.TypeFlags.EnumLike)}})),i?n:r.Unsupported}function ne(t){let n=P.getSignatureFromDeclaration(t);return!(P.getReturnTypeOfSignature(n).flags&e.TypeFlags.Void)}function re(e){return!(!e||!e.name)}function ie(e){if(!e)return"";switch(e.kind){case t.SK.ModuleBlock:return ie(e.parent);case t.SK.ClassDeclaration:case t.SK.ModuleDeclaration:return ie(e.parent)+e.name.text+".";default:return""}}function se(e){let n=re(e)?e.name.text:null;if(!n){if(e.kind!=t.SK.Constructor){for(let t=e.parent;t;t=t.parent)if(re(t))return se(t)+".inline";return"inline"}n="constructor"}return ie(e.parent)+n}function oe(e){return se(e).replace(/[^\w]+/g,"_")}function ae(e){return oe(e)+"__P"+d(e)}t.getNodeFullName=V,t.getComments=H,t.parseCommentsOnSymbol=G,t.parseComments=j,t.getName=K,t.checkType=Q,t.taggedSpecial=Z,t.getDeclName=se,t.getFunctionLabel=ae;class le{constructor(e){this.decl=e,this.capturedVars=[]}get isUsed(){return!!(8&u(this.decl).flags)}}function ce(e,t,n){return!!(e.flags&t)||te(e)===n}function ue(t){return ce(t,e.TypeFlags.String|e.TypeFlags.StringLiteral,r.String)}function de(t){return ce(t,e.TypeFlags.Number|e.TypeFlags.NumberLiteral,r.Number)}t.FunctionAddInfo=le,t.compileBinary=function(n,r,i,a){t.compilerHooks.preBinary&&t.compilerHooks.preBinary(n,r,i),t.target=r.target,t.compileOptions=r,t.target.debugMode=!!r.breakpoints;const v=e.createDiagnosticCollection();P=n.getTypeChecker();let S=t.U.cpuUs(),N=[],H=[],W={},Q={},te=null,re=null,ie=!1,ce=[];if(l++,r.target.isNative){if(!r.extinfo||!r.extinfo.hexinfo)return{diagnostics:[{file:n.getSourceFiles()[0],start:0,length:0,category:t.DiagnosticCategory.Error,code:9043,messageText:$("The hex file is not available, please connect to internet and try again.")}],emittedFiles:[],emitSkipped:!0};let e=r.extinfo,i=r.target;if(e&&e.disabledDeps){const t=(r.otherMultiVariants||[]).find((e=>e.extinfo&&!e.extinfo.disabledDeps));t&&(pxt.debug(`using alternative extinfo (due to ${e.disabledDeps})`),e=t.extinfo,i=t.target)}t.hexfile.setupFor(i,e||t.emptyExtInfo()),t.hexfile.setupInlineAssembly(r)}let _e,ge=new pe;function ye(){ge.reset(),_e=null,i.breakpoints=[{id:0,isDebuggerStmt:!1,fileName:"bogus",start:0,length:0,line:0,column:0}],i.procCallLocations=[]}ge.trace=r.trace,ge.breakpoints=r.breakpoints,ge.name=r.name,ge.target=r.target,r.computeUsedSymbols&&(i.usedSymbols={},i.usedArguments={}),r.computeUsedParts&&(i.usedParts=[]);let be=[];if(!r.forceEmit||0==i.diagnostics.length){let e=n.getSourceFiles().slice();const t=e.find((e=>e.fileName===pxt.MAIN_TS));t&&(e=e.filter((e=>e.fileName!==pxt.MAIN_TS)),e.push(t));const r=e.find((e=>e.fileName===pxt.TUTORIAL_CODE_STOP));r&&(e=e.filter((e=>e.fileName!==pxt.TUTORIAL_CODE_STOP)),e.push(r)),e.forEach((e=>{e.statements.forEach((e=>{be.push(e)}))}))}let ve=n.getSourceFiles().filter((e=>t.Util.endsWith(e.fileName,a)))[0],Te={kind:t.SK.FunctionDeclaration,parameters:[],name:{text:"<main>",pos:0,end:0},body:{kind:t.SK.Block,statements:be},parent:ve,pos:0,end:0};M=Te;const ke=u(Te);for(ke.flags|=3,rt(Te),N=[],ye(),ie=!0,kn(Te);Et(),!$e(););!function(){let e=ge.globals.slice(0);e.forEach(((e,t)=>e.index=t));const n=e=>0==e?10:b(e);e.sort(((e,t)=>n(e.bitSize)-n(t.bitSize)||e.index-t.index));let r=4*t.numReservedGlobals,i=0;for(let t of e){const e=f()?0:t.bitSize;let n=b(e);for(;r&n-1;)r++;i||0!=e||(i=r),t.index=r,r+=n}ge.globalsWords=r+3>>2,ge.nonPtrGlobals=i?i>>2:ge.globalsWords}(),ie=!1,function(){for(let e of ge.usedClassInfos)Be(e);let e=Object.keys(ge.ifaceMemberMap);e.sort(t.U.strcmp),e.unshift(""),ge.emitString(""),ge.ifaceMembers=e,ge.ifaceMemberMap={};let n=0;for(let t of e)ge.ifaceMemberMap[t]=n++;for(let e of ge.usedClassInfos)for(let t of e.itable)t.idx=Re(t.name);for(let e of ge.usedClassInfos)e.lastSubtypeNo=void 0,e.classNo=void 0;let r=pxt.BuiltInType.User0;const i=e=>{t.U.assert(!e.classNo),e.classNo=r++;for(let t of e.derivedClasses)t.isUsed&&i(t);e.lastSubtypeNo=r-1};for(let e of ge.usedClassInfos){let t=e;for(;t.baseClassInfo;)t=t.baseClassInfo;t.classNo||i(t)}}();let Ee=t.U.cpuUs();i.times.pass0=Ee-S;let xe=v.getDiagnostics();ye(),ie=!1,ge.finalPass=!0,En(Te),t.U.assert(0==N.length),i.configData=[];for(let e of Object.keys(Q))Q["!"+e]||i.configData.push({name:e.replace(/^\!/,""),key:Q[e].key,value:Q[e].value});i.configData.sort(((e,t)=>e.key-t.key));let Se=t.U.cpuUs();if(i.times.pass1=Se-Ee,bn(Te,(function(){if(r.noEmit)return;ge.writeFile=(e,t)=>{i.outfiles[e]=t};for(let e of ge.procs)e.cachedJS&&!e.inlineBody||e.resolve();t.target.isNative&&(ge.procs=ge.procs.filter((e=>!(e.inlineBody&&!e.info.usedAsIface&&!e.info.usedAsValue))));r.target.isNative?([...r.otherMultiVariants||[],r].forEach((({extinfo:e})=>{e.yotta&&ge.writeFile("yotta.json",JSON.stringify(e.yotta,null,2)),e.codal&&ge.writeFile("codal.json",JSON.stringify(e.codal,null,2)),e.platformio&&ge.writeFile("platformio.json",JSON.stringify(e.platformio,null,2))})),r.target.nativeType==t.NATIVE_TYPE_VM?t.vmEmit(ge,r,i):t.processorEmit(ge,r,i)):t.jsEmit(ge,i);ge.writeFile=void 0})),i.times.passFinal=t.U.cpuUs()-Se,r.ast){let e=t.U.cpuUs();t.annotate(n,a,t.target),i.times.passAnnotate=t.U.cpuUs()-e}return t.compileOptions=null,0==xe.length&&(xe=v.getDiagnostics()),t.compilerHooks.postBinary&&t.compilerHooks.postBinary(n,r,i),{diagnostics:xe,emittedFiles:void 0,emitSkipped:!!r.noEmit};function Ce(t,n,r,i,s,o,a){v.add(e.createDiagnosticForNode(n,{code:r,message:i,key:i.replace(/^[a-zA-Z]+/g,"_"),category:t},s,o,a))}function Ie(e,n,r,i,s,o){Ce(t.DiagnosticCategory.Error,e,n,r,i,s,o)}function Ae(t,n,r=9202){if(n)return h(r,n);t||h(r,$("Sorry, this language feature is not supported"));let i=p(t),s=!1,o=null;switch(t.kind){case e.SyntaxKind.ForInStatement:i=$("for in loops");break;case e.SyntaxKind.ForOfStatement:i=$("for of loops"),s=!0;break;case e.SyntaxKind.PropertyAccessExpression:i=$("property access");break;case e.SyntaxKind.DeleteExpression:i=$("delete");break;case e.SyntaxKind.GetAccessor:i=$("get accessor method"),s=!0;break;case e.SyntaxKind.SetAccessor:i=$("set accessor method"),s=!0;break;case e.SyntaxKind.TaggedTemplateExpression:i=$("tagged templates");break;case e.SyntaxKind.SpreadElement:i=$("spread");break;case e.SyntaxKind.TryStatement:case e.SyntaxKind.CatchClause:case e.SyntaxKind.FinallyKeyword:case e.SyntaxKind.ThrowStatement:i=$("throwing and catching exceptions");break;case e.SyntaxKind.ClassExpression:i=$("class expressions"),o=$("declare a class as class C {} not let C = class {}")}let a="";return a=s?$("{0} not currently supported",i):$("{0} not supported",e.SyntaxKind[t.kind]),o&&(a+=" - "+o),h(r,a)}function we(e){return d(e)+""}function Ne(e){const t=u(e);return t.functionInfo||(t.functionInfo=new le(e)),t.functionInfo}function De(e){const t=u(e);return t.variableInfo||(t.variableInfo={}),t.variableInfo}function Oe(e,t=!1){let n=De(e);t&&(n.written=!0);let r=w(e);if(null==r||r==_e.action);else{let t=_e.action;for(;t&&t!=r;){let n=Ne(t);n.capturedVars.indexOf(e)<0&&n.capturedVars.push(e),t=w(t)}n.captured=!0}}function Re(e,n=!1){return function(e,n,r,i,s){return me(e,i,s,(e=>{r&&(t.U.lookup(e.explicitlyUsedIfaceMembers,n)||(t.U.assert(!e.finalPass),e.explicitlyUsedIfaceMembers[n]=!0));let i=t.U.lookup(e.ifaceMemberMap,n);return null!=i||(t.U.assert(!e.finalPass),i=e.ifaceMemberMap[n]=-1,e.emitString(n)),i}))}(ge,e,n,ie,re)}function Le(t){t.flags&e.TypeFlags.Void&&h(9203,$("void-typed variables not supported"))}function Pe(e){const n=u(e);Le(ee(e)),n.cell||(n.cell=new t.ir.Cell(null,e,De(e))),ge.globals.indexOf(n.cell)<0&&ge.globals.push(n.cell)}function Me(e){if(O(e)){rt(e);const t=u(e);return t.cell||Pe(e),t.cell}{let t=_e.localIndex(e);return t||(ge.finalPass?h(9204,$("cannot locate identifer")):t=_e.mkLocal(e,De(e))),t}}function Fe(e){return e.kind==t.SK.MethodDeclaration&&0==e.parameters.length&&"toString"==K(e)}function $e(){ie=!1;const e=ge.usedClassInfos.length;for(let e of ge.usedClassInfos){for(let t of e.allMethods()){const e=u(t),n=Ne(t);8&e.flags?n.virtualParent&&it(n.virtualParent.decl):(n.virtualParent&&n.virtualParent.isUsed||Fe(t)||yt(K(t)))&&it(t)}const t=gt(e.decl);t&&it(t)}return ie=!0,0==N.length&&e==ge.usedClassInfos.length}function Be(e){if(t.assert(e.isUsed,"inf.isUsed"),e.vtable)return e.vtable;let n=e.baseClassInfo?Be(e.baseClassInfo).slice(0):[];e.derivedClasses=[],e.baseClassInfo&&e.baseClassInfo.derivedClasses.push(e);for(let r of e.usedMethods()){ge.numMethods++;let i=Ne(r);const s=j(r);if(Fe(r)&&!s.shim&&(e.toStringMethod=mt(r),e.toStringMethod.info.usedAsIface=!0),i.virtualParent){ge.numVirtMethods++;let e=C(r),s=!1,o=mt(r);t.U.assert(!!o);for(let t=0;t<n.length;++t)C(n[t].action)==e&&(n[t]=o,i.virtualIndex=t,s=!0);s||(i.virtualIndex=n.length,n.push(o))}}e.vtable=n,e.itable=[];const r={};for(let t of e.allfields){let n=K(t),i=Mt(e,t,!1);r[n]=!0,e.itable.push({name:n,info:(i.idx+1)*(f()?1:4),idx:Re(n),proc:null})}for(let n=e;n;n=n.baseClassInfo)for(let r of n.usedMethods()){const n=K(r);if(j(r).shim)continue;const i=mt(r),s=e.itable.find((e=>e.name==n)),o=r.kind==t.SK.SetAccessor,a=r.kind==t.SK.GetAccessor;s?(o&&!s.setProc?s.setProc=i:a&&!s.proc&&(s.proc=i),s.info=0):e.itable.push({name:n,info:0,idx:Re(n),proc:o?null:i,setProc:o?i:null}),i.info.usedAsIface=!0}return e.vtable}function Ue(e){if(32&e.flags||16&e.flags&&t.compileOptions.skipPxtModulesEmit)throw i.needsFullRecompile=!0,h(9200,$("full recompile required"))}function Ve(e,n=null){n||(n=e.symbol.valueDeclaration);const r=u(n);if(!r.classInfo){const e=oe(n)+"__C"+d(n),i=new L(e,n);r.classInfo=i,i.attrs.autoCreate&&(W[i.attrs.autoCreate]=!0),i.baseClassInfo=function(e){if(e.heritageClauses)for(let n of e.heritageClauses)switch(n.token){case t.SK.ExtendsKeyword:if(!n.types||1!=n.types.length)throw h(9228,$("invalid extends clause"));let r=ee(n.types[0]);if(r&&J(r))return P.getTypeAtLocation(e),Ve(r);throw h(9228,$("cannot inherit from this type"));case t.SK.ImplementsKeyword:break;default:throw h(9228,$("invalid heritage clause"))}return null}(n);const s=i.baseClassInfo?t.U.toDictionary(i.baseClassInfo.allfields,(e=>K(e))):{},o=(e,t=i.baseClassInfo)=>t?t.methods[e]||o(e,t.baseClassInfo):null;for(let e of n.members)if(e.kind==t.SK.PropertyDeclaration){let n=e;k(n)||i.allfields.push(n);const r=K(n);(o(r)||t.U.lookup(s,r))&&Ie(n,9279,$("redefinition of '{0}' as field",r))}else if(e.kind==t.SK.Constructor)for(let t of e.parameters)he(t)&&i.allfields.push(t);else if(I(e)){let n=Ne(e);n.parentClassInfo=i,n.isUsed&&bt(i);const r=K(e);i.methods.hasOwnProperty(r)||(i.methods[r]=[]),i.methods[r].push(e);const o=t.U.lookup(s,r);if(o){const e=u(o);64&e.flags||(e.flags|=64,8&e.flags&&Re(r,!0),Ue(e))}}i.baseClassInfo&&(i.allfields=i.baseClassInfo.allfields.concat(i.allfields),function(e){for(let n of e.allMethods()){let r=null;const i=C(n),s=K(n);for(let t=e.baseClassInfo;t;t=t.baseClassInfo)if(t.methods.hasOwnProperty(s))for(let e of t.methods[s])C(e)==i&&(r=e);if(r){let e=Ne(n),i=Ne(r);r.parameters.length!=n.parameters.length&&Ie(n,9255,$("the overriding method is currently required to have the same number of arguments as the base one")),e.virtualParent=i,i.virtualParent||(Ue(u(r)),i.virtualParent=i),t.assert(i.virtualParent==i,"pinf.virtualParent == pinf")}}}(i))}return r.classInfo}function He(e){if(!e)return!1;if(T(e))return!1;switch(e.kind){case t.SK.ArrayLiteralExpression:return e.elements.some(He);default:return null==jt(e)}}function Ge(e){const t=Gt(e);if(t)return Yt(t.val);if(O(e)){if(j(e).shim)return ut(e,e,[])}let n=Me(e);return Oe(e),n.load()}function je(e){j(e).shim&&h(9207,$("built-in functions cannot be yet used as values; did you forget ()?"));let n=Ne(e);return Ke(n),n.location?n.location.load():(t.assert(!ge.finalPass||0==n.capturedVars.length,"!bin.finalPass || info.capturedVars.length == 0"),n.usedAsValue=!0,it(e),kt(e))}function Ke(e){void 0===e.usedBeforeDecl?e.usedBeforeDecl=!0:ge.finalPass&&e.usedBeforeDecl&&e.capturedVars.length&&w(e.decl)&&!e.alreadyEmitted&&h(9278,$("function referenced before all variables it uses are defined"))}function We(e){const n=at(e),r=Gt(n);if(r)return Yt(r.val);if(n&&(D(n)||R(n)))return Ge(n);if(n&&n.kind==t.SK.FunctionDeclaration)return je(n);if("undefined"==e.text)return Yt(void 0);throw Ae(e,$("Unknown or undeclared identifier"),9235)}function ze(e){let n=A(e);n||h(9208,$("'this' used outside of a method"));let r=Ne(n);return r.thisParameter||t.oops("no this"),Ge(r.thisParameter)}function qe(e){let n;if(""==e)n=t.ir.rtcall("String_::mkEmpty",[]);else{let r=function(e){return function(e,t,n,r){return me(e,n,r,(e=>e.emitString(t)))}(ge,e,ie,re)}(e);n=t.ir.ptrlit(r,JSON.stringify(e))}return n.isStringLiteral=!0,n}function Je(e){let n=lt(e),r=vn(e);return t.target.isNative||T(e)?Lt(r,n):(r=t.ir.rtcallMask("String_::stringConv",1,1,[r]),Lt(r,!0))}function Ye(e){let n=0,r=(e,t)=>function(e){return T(e)&&""==e.text}(t)?e:(n++,Zt("String_::concat",[Lt(e,!0),Je(t)],null)),i=u(Je(e.head)).valueOverride;for(let t of e.templateSpans)i=r(i,t.expression),i=r(i,t.literal);return 0==n?Zt("String_::concat",[Lt(i,!0),Lt(t.ir.rtcall("String_::mkEmpty",[]),!1)],null):i}function Xe(e){let n=at(e);const r=Gt(n);if(r)return Yt(r.val);if(n.kind==t.SK.SetAccessor&&(n=Qe(n)),n.kind==t.SK.GetAccessor)return pt(e,e,[],null,n);if(n.kind==t.SK.EnumMember)throw h(9210,$("Cannot compute enum value"));if(n.kind==t.SK.PropertySignature||n.kind==t.SK.PropertyAssignment)return pt(e,e,[],null,n,e.expression);if(n.kind==t.SK.PropertyDeclaration||n.kind==t.SK.Parameter){if(k(n))return Ge(n);if(Ze(n))return pt(e,e,[],null,n,e.expression);{let n=function(e){const n=ee(e.expression);if(Y(n)){const r=Ve(n);let i=e.expression.kind==t.SK.ThisKeyword;return t.target.switches.noThisCheckOpt&&(i=!1),Mt(r,Ft(r,e.name.text),!i)}throw Ae(e,$("bad field access"),9247)}(e);return t.ir.op(o.FieldAccess,[vn(e.expression)],n)}}if(I(n)||n.kind==t.SK.MethodSignature)throw h(9211,$("cannot use method as lambda; did you forget '()' ?"));if(n.kind==t.SK.FunctionDeclaration)return je(n);if(D(n))return Ge(n);throw Ae(e,$("Unknown property access for {0}",p(n)),9237)}function Qe(n){const r=e.getDeclarationOfKind(n.symbol,t.SK.GetAccessor);if(null==r)throw h(9281,$("setter currently requires a corresponding getter"));return r}function Ze(e){if(e.kind==t.SK.Parameter||e.kind==t.SK.PropertyDeclaration){const n=u(e);return!!t.target.switches.slowFields||!!(64&n.flags)}return!1}function et(t,n=null){let r=ee(t.expression),i={callingConvention:0,paramDefl:{}},s=null,o=!1;if(!n&&ue(r)?s="String_::charAt":z(r)?s=n?"Array_::setAt":"Array_::getAt":q(r)&&(i=G(r.symbol),s=n?i.indexerSet:i.indexerGet),!s&&r.flags&(e.TypeFlags.Any|e.TypeFlags.StructuredOrTypeVariable)&&(s=n?"pxtrt::mapSetGeneric":"pxtrt::mapGetGeneric",o=!0),s){if(o||Xt(t.argumentExpression)){return Zt(s,[t.expression,t.argumentExpression],i,n?[n]:[])}throw Ae(t,$("non-numeric indexer on {0}",s),9238)}throw Ae(t,$("unsupported indexer"),9239)}function tt(n){let i=function(e){return!!O(e)&&(!He(e.initializer)||!!j(e).whenUsed)}(n)||function(e){return e.kind==t.SK.FunctionDeclaration&&!w(e)||I(e)}(n)||e.isClassDeclaration(n);return!t.target.switches.noTreeShake&&(!(r.testMode&&i&&!c(n))&&i)}function nt(e){if(!tt(e))return!0;const t=u(e);return ge.finalPass?!!(8&t.flags):t==re}function rt(e){var t;if(!e)return;const n=u(e);if(n.classInfo)bt(n.classInfo);else{if(r.computeUsedSymbols&&e.symbol&&(i.usedSymbols[V(P,e)]=null),r.computeUsedParts&&(null===(t=n.commentAttrs)||void 0===t?void 0:t.parts)){const e=n.commentAttrs.parts.split(/[ ,]+/g);for(const t of e)-1===i.usedParts.indexOf(t)&&i.usedParts.push(t)}f()&&I(e)&&Re(K(e),!0),st(e),8&n.flags||(n.flags|=8,tt(e)&&N.push(e))}}function it(e){rt(e)}function st(e){ie&&(re?re.usedNodes[we(e)]=e:t.U.oops("no using ctx for: "+K(e)))}function ot(t){if(!t)return null;const n=u(t);if(void 0!==n.declCache)return n.declCache;let r,i=P.getSymbolAtLocation(t);if(i&&(r=i.valueDeclaration,!r&&i.declarations)){let t=i.declarations[0];t&&t.kind==e.SyntaxKind.ImportEqualsDeclaration&&(i=P.getSymbolAtLocation(t.moduleReference),i&&(r=i.valueDeclaration))}return r}function at(e){let n=ot(e);if(rt(n),!n&&e&&e.kind==t.SK.PropertyAccessExpression){const r=e;n={kind:t.SK.PropertySignature,symbol:{isBogusSymbol:!0,name:r.name.getText()},name:r.name},u(n).flags|=2}return ke.declCache=n||null,n}function lt(e){return e.kind==t.SK.NullKeyword||e.kind==t.SK.NumericLiteral?!!e.isRefOverride:!T(e)}function ct(e){t.assert(e.length<=8,"args.length <= 8");let n=0;return e.forEach(((e,t)=>{lt(e)&&(n|=1<<t)})),n}function ut(n,i,s){let o=j(n),a=!(ee(i).flags&e.TypeFlags.Void),l=o.shim;if(l.indexOf("(")>=0){let e=/(.*)\((.*)\)$/.exec(l);if(e){s.length&&t.U.userError("no arguments expected");let a=[];if(e[2].replace(/\s/g,"")){for(let n of e[2].split(/,/)){let e=parseInt(n);isNaN(e)&&(e=qt(i,n),null==e&&(e=Wt(i,n)),null==e&&t.U.userError("invalid argument: "+n+" in "+l)),a.push(t.ir.numlit(e))}a.length>4&&t.U.userError("too many args")}return l=e[1],r.target.isNative&&t.hexfile.validateShim(se(n),l,o,!0,a.map((e=>!0))),t.ir.rtcallMask(l,0,o.callingConvention,a)}}return"TD_NOOP"==l?(t.assert(!a,"!hasRet"),t.target.switches.profile&&"perfCounter"==o.shimArgument&&(s[0]&&s[0].kind==t.SK.StringLiteral&&(_e.perfCounterName=s[0].text),_e.perfCounterName||(_e.perfCounterName=_e.getFullName())),Yt(void 0)):"TD_ID"==l||"ENUM_GET"===l?(t.assert(1==s.length,"args.length == 1"),vn(s[0])):(r.target.shimRenames&&t.U.lookup(r.target.shimRenames,l)&&(l=r.target.shimRenames[l]),r.target.isNative&&t.hexfile.validateShim(se(n),l,o,a,s.map(Xt)),Zt(l,s,o))}function dt(e,n,r){if(!e)return;let i=e.getParameters(),s=n.length;i.length>n.length&&i.slice(n.length).forEach((e=>{if(e.valueDeclaration&&e.valueDeclaration.kind==t.SK.Parameter){let i=e.valueDeclaration;if(i.initializer)(function(e){switch(e.kind){case t.SK.UndefinedKeyword:case t.SK.NullKeyword:case t.SK.TrueKeyword:case t.SK.FalseKeyword:case t.SK.NumericLiteral:return!0;case t.SK.PropertyAccessExpression:return vn(e).exprKind==o.NumberLiteral;default:return!1}})(i.initializer)||h(9212,$("only numbers, null, true and false supported as default arguments")),n.push(i.initializer);else{let e=x(r,K(i)),t=e?Yt(parseInt(e)):null;null==t&&(t=Yt(void 0)),n.push(Lt(t))}}else h(9213,$("unsupported default argument (shouldn't happen)"))}));for(let e=0;e<s;e++){let r=i[e];r&&r.valueDeclaration&&r.valueDeclaration.kind==t.SK.Parameter&&(n[e],r.valueDeclaration)}r.imageLiteral&&(T(n[0])||h(9214,$("Only image literals (string literals) supported here; {0}",p(n[0]))),n[0]=function(e){e||(e="0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n");let n=0,r=0,i=0,s="",o=0;e+="\n";for(let t=0;t<e.length;++t)switch(e[t]){case".":case"_":case"0":s+="0,",n++,o++;break;case"#":case"*":case"1":s+="255,",n++,o++;break;case"\t":case"\r":case" ":break;case"\n":n&&(0==r?r=n:n!=r&&h(9205,$("lines in image literal have to have the same width (got {0} and then {1} pixels)",r,n)),n=0,i++);break;default:h(9206,$("Only 0 . _ (off) and 1 # * (on) are allowed in image literals"))}let a="_img"+ge.lblNo++;o%2!=0&&(s+="0"),ge.otherLiterals.push(`\n.balign 4\n${a}: .short 0xffff\n        .short ${r}, ${i}\n        .byte ${s}\n`);let l="new pxsim.Image("+r+", ["+s+"])";return{kind:t.SK.NumericLiteral,imageLiteral:a,jsLit:l}}(n[0].text))}function pt(n,r,s,o,a=null,l=null){var c;a||(a=at(r));let u=!1,d=!1,p=!1;const m=n===r;if(a)switch(a.kind){case t.SK.PropertySignature:case t.SK.PropertyAssignment:case t.SK.PropertyDeclaration:case t.SK.MethodSignature:u=!0;break;case t.SK.Parameter:he(a)&&(u=!0);break;case t.SK.GetAccessor:case t.SK.SetAccessor:case t.SK.MethodDeclaration:u=!0,d=!0,p=k(a);break;case t.SK.FunctionDeclaration:p=!0;break;case t.SK.ModuleDeclaration:break;default:a=null}else r.kind==t.SK.PropertyAccessExpression&&(u=!0);t.target.switches.slowMethods&&(d=!1);const _=j(a);let g=s.slice(0);if(u&&k(a)&&(u=!1),u&&!l&&r.kind==t.SK.PropertyAccessExpression&&(l=r.expression),i.usedArguments&&_.trackArgs){let e=l?[l].concat(g):g,n=_.trackArgs.map((t=>e[t])).map((e=>{let n=at(e);return!n||n.kind!=t.SK.EnumMember&&n.kind!=t.SK.VariableDeclaration?e&&e.kind==t.SK.StringLiteral?e.text:"*":V(P,n)})).join(","),r=V(P,a),s=i.usedArguments[r];s||(s=i.usedArguments[r]=[]),s.indexOf(n)<0&&s.push(n)}function y(){let e=_t(a,n,g.map((e=>vn(e)))),r=e.data;return g[0]&&r.proc&&r.proc.classInfo&&(r.isThis=g[0].kind==t.SK.ThisKeyword),e}if(dt(o,g,_),p){if(!Ne(a).location)return _.shim&&!wt(a)?ut(a,n,g):(it(a),y())}if(r.kind==t.SK.SuperKeyword){let e=_e.classInfo.baseClassInfo.ctor;for(let t=_e.classInfo.baseClassInfo;t&&!e;t=t.baseClassInfo)e=t.ctor;if(!e&&ge.finalPass)throw h(9280,$("super() call requires an explicit constructor in base class"));let t=g.map((e=>vn(e)));return t.unshift(ze(r)),ht(e,n,t)}if(u){if(t.U.assert(!k(a)),l?g.unshift(l):Ae(n,$("strange method call"),9241),!a){t.U.assert(r.kind==t.SK.PropertyAccessExpression);const e=r.name.text;return ft(g.map((e=>vn(e))),{ifaceIndex:Re(e,!0),callLocationIndex:Sn(n),noArgs:m})}let i=Ne(a);if(i.parentClassInfo&&bt(i.parentClassInfo),it(a),l.kind==t.SK.SuperKeyword)return y();const s=!!i.virtualParent,o=!!f()||!!t.target.switches.slowMethods;if(s&&!o)return a.kind==t.SK.MethodDeclaration?t.U.assert(!m):a.kind==t.SK.GetAccessor||a.kind==t.SK.SetAccessor?t.U.assert(m):t.U.assert(!1),t.U.assert(!ge.finalPass||null!=i.virtualIndex,"!bin.finalPass || info.virtualIndex != null"),ft(g.map((e=>vn(e))),{classInfo:i.parentClassInfo,virtualIndex:i.virtualIndex,noArgs:m,isThis:g[0].kind==t.SK.ThisKeyword});if(_.shim&&!wt(a))return ut(a,n,g);if(_.helper){let r,i=P.getSymbolsInScope(n,e.SymbolFlags.Module);for(let e of i)if("helpers"==e.name)for(let n of e.declarations||[e.valueDeclaration])if(n.kind==t.SK.ModuleDeclaration)for(let e of n.body.statements)(null===(c=e.symbol)||void 0===c?void 0:c.name)==_.helper&&(r=e);return r||h(9215,$("helpers.{0} not found",_.helper)),r.kind!=t.SK.FunctionDeclaration&&h(9216,$("helpers.{0} isn't a function",_.helper)),it(a=r),y()}return s||t.target.switches.slowMethods||!d?ft(g.map((e=>vn(e))),{ifaceIndex:Re(K(a),!0),isSet:m&&2==g.length,callLocationIndex:Sn(n),noArgs:m}):(t.U.assert(a.kind!=t.SK.MethodSignature),y())}return a&&a.kind==t.SK.ModuleDeclaration&&("String"==K(a)?h(9219,$('to convert X to string use: X + ""')):h(9220,$("namespaces cannot be called directly"))),g.unshift(r),t.U.assert(!m),ft(g.map((e=>vn(e))),{virtualIndex:-1,callLocationIndex:Sn(n),noArgs:m})}function ht(e,n,r){t.U.assert(!ge.finalPass||!!e);let i={proc:e,callLocationIndex:Sn(n),virtualIndex:null,ifaceIndex:null};return t.ir.op(o.ProcCall,r,i)}function ft(e,n){return t.ir.op(o.ProcCall,e,n)}function mt(e){return u(e).proc}function _t(e,n,r){const i=mt(e);if(e.kind==t.SK.FunctionDeclaration){Ke(Ne(e))}return t.assert(!!i||!ge.finalPass,"!!proc || !bin.finalPass"),ht(i,n,r)}function gt(e){return e.members.filter((e=>e.kind==t.SK.Constructor))[0]}function yt(e){return null!=t.U.lookup(ge.explicitlyUsedIfaceMembers,e)}function bt(e){if(st(e.decl),e.isUsed)return;u(e.decl).flags|=8,e.baseClassInfo&&bt(e.baseClassInfo),ge.usedClassInfos.push(e)}function vt(n){function i(e){return/^[0-9a-f]$/i.test(e)}let s=at(n.tag);if(!s)throw Ae(n,$("invalid tagged template"),9265);let o,a=j(s),l={decl:s,qName:s?V(P,s):"?",args:[n.template],isExpression:!0};function c(s){o=function(n,s){let o=te;if("_"==s[0]&&"_"==s[1]&&r.jres[s]&&(o=r.jres[s],s=""),""==s&&o){let n=/font\/x-mkcd-b(\d+)/.exec(o.mimeType);if(n)if(ge.finalPass){let e=parseInt(n[1]),r=atob(o.data),i=ge.usedChars,a="",l="";for(let t=0;t<r.length;t+=e){let n=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8);(n<128||i[n>>5]&1<<(31&n))&&(a+=r.slice(t,t+e),l+=n+", ")}s=t.U.toHex(t.U.stringToUint8Array(a))}else s="aabbccdd";else o.dataEncoding&&"base64"!=o.dataEncoding?"hex"==o.dataEncoding?s=o.data:h(9271,$("invalid jres encoding '{0}' on '{1}'",o.dataEncoding,o.id)):s=t.U.toHex(t.U.stringToUint8Array(e.pxtc.decodeBase64(o.data)))}if(/^e[14]/i.test(s)&&n.parent&&n.parent.kind==t.SK.CallExpression&&"image.ofBuffer"==n.parent.expression.getText()){const e=/^e([14])(..)(..)..(.*)/i.exec(s);s=`870${e[1]}${e[2]}00${e[3]}000000${e[4]}`}let a="";for(let e=0;e<s.length;++e){let t=s[e];if(!i(t)){if(/^[\s\.]$/.test(t))continue;throw Ae(n,$("invalid character in hex literal '{0}'",t),9265)}i(s[e+1])&&(a+=t+s[e+1],e++)}if(t.target.isNative){const e=ge.emitHexLiteral(a.toLowerCase());return t.ir.ptrlit(e,e)}{const e="_hex"+we(n);return t.ir.ptrlit(e,{hexlit:a.toLowerCase()})}}(n,s(n.template.text))}if(u(n).callInfo=l,n.template.kind!=t.SK.NoSubstitutionTemplateLiteral)throw Ae(n,$("substitution not supported in hex literal",a.shim),9265);switch(a.shim){case"@hex":c((e=>e));break;case"@f4":c((function(e){if(!Array.isArray(a.groups))throw Ae(n,$("missing groups in @f4 literal"),9272);let r=[],i=[],s={},o=0;a.groups.forEach(((e,t)=>{for(let n of e)s[n]=t})),e+="\n";for(let l=0;l<e.length;++l){let c=e[l];switch(c){case" ":case"\t":break;case"\n":i.length>0&&(r.push(i),o=Math.max(i.length,o),i=[]);break;default:let e=t.U.lookup(s,c);if(null==e){if(2!=a.groups.length)throw Ae(n,$("invalid character in image literal: '{0}'",e),9273);e=1}i.push(e)}}let l=8;return a.groups.length<=2?l=1:a.groups.length<=16&&(l=4),t.f4EncodeImg(o,r.length,l,((e,t)=>r[t][e]||0))}));break;default:if(void 0===a.shim&&a.helper)return function(n,r){var i;let s,o=P.getSymbolsInScope(n,e.SymbolFlags.Module);for(let e of o)if("helpers"==e.name)for(let n of e.declarations||[e.valueDeclaration])if(n.kind==t.SK.ModuleDeclaration)for(let e of n.body.statements)(null===(i=e.symbol)||void 0===i?void 0:i.name)==r.helper&&(s=e);s||h(9215,$("helpers.{0} not found",r.helper));s.kind!=t.SK.FunctionDeclaration&&h(9216,$("helpers.{0} isn't a function",r.helper));const a=s;return it(a),_t(a,n,[qe(n.text)])}(n.template,a);throw Ae(n,$("invalid shim '{0}' on tagged template",a.shim),9265)}return a.helper&&(o=t.ir.rtcall(a.helper,[o])),o}function Tt(e){let n=e.parameters.slice(0);if(!k(e)&&I(e)){let r=Ne(e);r.thisParameter||(r.thisParameter={kind:t.SK.Parameter,name:{text:"this"},isThisParameter:!0,parent:e}),n.unshift(r.thisParameter)}return n}function kt(e,n=!1){let r=ae(e);return t.ir.ptrlit(r+"_Lit",r)}function Et(){for(_e=mt(Te);N.length>0;){kn(N.pop())}}function xt(){const e=ce;if(e.length>0){ce=[];for(let t of e){const e=_e;try{Ct(t)}finally{_e=e}}}}function St(e){ge.finalPass&&e.functionsToDefine&&t.U.pushRange(ce,e.functionsToDefine)}function Ct(e){const n=Ne(e);let r=null;if(ge.finalPass){if(n.alreadyEmitted)return t.U.assert(n.usedBeforeDecl),null;n.alreadyEmitted=!0}let i=e.kind==t.SK.ArrowFunction||e.kind==t.SK.FunctionExpression,s=n.capturedVars.slice(0),a=s.map(((e,n)=>{let r=new t.ir.Cell(n,e,De(e));return r.iscap=!0,r}));void 0===n.usedBeforeDecl&&(n.usedBeforeDecl=!1),s.length>0?(t.assert(null!=w(e),"getEnclosingFunction(node) != null)"),r=t.ir.shared(t.ir.rtcall("pxt::mkAction",[t.ir.numlit(s.length),kt(e,!0)])),n.usedAsValue=!0,s.forEach(((e,n)=>{let i=_e.localIndex(e);i||h(9223,$("cannot find captured value: {0}",P.symbolToString(e.symbol)));let s=i.loadCore();_e.emitExpr(t.ir.rtcall("pxtrt::stclo",[r,t.ir.numlit(n),s]))})),e.kind==t.SK.FunctionDeclaration&&(n.location=_e.mkLocal(e,De(e)),_e.emitExpr(n.location.storeDirect(r)),r=null)):i&&(r=kt(e),n.usedAsValue=!0),t.assert(!!r==i,"!!lit == isExpression");let l=mt(e);if(l)_e=l,_e.reset();else{t.assert(!ge.finalPass,"!bin.finalPass");const r=u(e),i=new t.ir.Procedure;i.isRoot=!!(1&r.flags),i.action=e,i.info=n,r.proc=i,i.usingCtx=re,_e=i,function(e,t,n,r){me(e,n,r,(e=>e.addProc(t)))}(ge,i,ie,re)}_e.captured=a;const c=[];if(e.parent.kind==t.SK.ClassDeclaration){let n=Ve(null,e.parent);if(_e.classInfo?t.assert(_e.classInfo==n,"proc.classInfo == classInfo"):_e.classInfo=n,e.kind==t.SK.Constructor){if(n.baseClassInfo)for(let e of n.baseClassInfo.decl.members)e.kind==t.SK.Constructor&&it(e);n.ctor?t.assert(n.ctor==_e,"classInfo.ctor == proc"):n.ctor=_e;for(let e of n.allfields)if(e.kind==t.SK.PropertyDeclaration&&!k(e)){let t=e;t.initializer&&c.push(t)}}}const d=[],p=[];_e.args=Tt(e).map(((n,r)=>{n.name.kind===t.SK.ObjectBindingPattern&&d.push(n),e.kind==t.SK.Constructor&&he(n)&&p.push(n);let i=new t.ir.Cell(r,n,De(n));return St(i.info),i.isarg=!0,i})),_e.args.forEach((e=>{if(e.isByRefLocal()){let n=t.ir.shared(t.ir.rtcall("pxtrt::mklocRef",[]));_e.emitExpr(t.ir.rtcall("pxtrt::stlocRef",[n,e.loadCore()],1)),_e.emitExpr(e.storeDirect(n))}})),d.forEach((e=>_n(e)));for(let e of p){let r=Mt(_e.classInfo,Ft(_e.classInfo,K(e)),!1),i=t.ir.op(o.FieldAccess,[Ge(n.thisParameter)],r);_e.emitExpr(t.ir.op(o.Store,[i,Ge(e)]))}for(let e of c){let r=Mt(_e.classInfo,Ft(_e.classInfo,K(e)),!1),i=t.ir.op(o.FieldAccess,[Ge(n.thisParameter)],r);_e.emitExpr(t.ir.op(o.Store,[i,vn(e.initializer)]))}if(xt(),e.body.kind==t.SK.Block){if(En(e.body),ne(_e.action)){const n=_e.body[_e.body.length-1];n&&n.stmtKind==t.ir.SK.Jmp&&n.jmpMode==t.ir.JmpMode.Always||_e.emitJmp(an(e).ret,Yt(void 0),t.ir.JmpMode.Always)}}else{let n=vn(e.body);_e.emitJmp(an(e).ret,n,t.ir.JmpMode.Always)}_e.emitLblDirect(an(e).ret),_e.stackEmpty();let f=_e.mkLabel("final");if(ne(_e.action)?_e.emitJmp(f):_e.emitJmp(f,Yt(void 0)),_e.emitLbl(f),n.capturedVars.length&&n.usedBeforeDecl&&e.kind==t.SK.FunctionDeclaration&&!ge.finalPass){n.capturedVars.sort(((e,t)=>t.pos-e.pos));const t=De(n.capturedVars[0]);t.functionsToDefine||(t.functionsToDefine=[]),t.functionsToDefine.push(e)}return t.assert(!ge.finalPass||0==N.length,"!bin.finalPass || usedWorkList.length == 0"),r}function It(e){let n=t.ir.shared(e);return _e.emitExpr(n),n}function At(){return It(t.ir.op(o.JmpValue,[]))}function wt(e){if(r.target.isNative)return!1;let n=e;return n.body&&(n.body.kind!=t.SK.Block||n.body.statements.length>0)}function Nt(n){if(!nt(n))return;if(32&u(n).flags)return;let i=j(n);if(null!=i.shim){if("@"==i.shim[0])return;if(r.target.isNative&&t.hexfile.validateShim(se(n),i.shim,i,ne(n),Tt(n).map((e=>fe(ee(e))))),!wt(n))return}if(e.isInAmbientContext(n))return;if(!n.body)return;let s=null,o=_e;try{s=Ct(n)}finally{_e=o}return s}function Dt(){}function Ot(e){let t=e;t.needsIRCache=!0,H.push(t)}function Rt(e,n=null){let r=H.length;return e.kind!=t.SK.PropertyAccessExpression&&e.kind!=t.SK.ElementAccessExpression||Ot(e.expression),n&&Ot(n),H.length==r?Dt:()=>{for(let e=r;e<H.length;++e)H[e].cachedIR=null,H[e].needsIRCache=!1;H.splice(r,H.length-r)}}function Lt(e,n=!1){let r={kind:t.SK.NullKeyword,isRefOverride:n};return u(r).valueOverride=e,r}function Pt(e,n,r,i=null){let s=Rt(e),o=i?vn(i):Yt(1),a=t.ir.shared(vn(e)),l=t.ir.shared(Ut(n,a,o));return $t(e,Lt(l,!0)),s(),r?a:l}function Mt(e,n,r=!0){k(n)&&t.U.oops("fieldIndex on static field: "+K(n));let i=j(n),s=e.allfields.indexOf(n);return s<0&&ge.finalPass&&t.U.oops("missing field"),{idx:s,name:K(n),isRef:!0,shimName:i.shim,classInfo:e,needsCheck:r}}function Ft(e,t){const n=e.allfields.filter((e=>e.name.text==t))[0];return n||h(9224,$("field {0} not found",t)),n}function $t(n,r,i=!1){let s=at(n),a=O(s);if(n.kind==t.SK.Identifier||a)if(s&&(a||D(s)||R(s))){let e=Me(s);Oe(s,!0),_e.emitExpr(e.storeByRef(vn(r)))}else Ae(n,$("bad target identifier"),9248);else if(n.kind==t.SK.PropertyAccessExpression){let i=at(n);if(!i||i.kind!=t.SK.GetAccessor&&i.kind!=t.SK.SetAccessor)if(i&&(i.kind==t.SK.PropertySignature||i.kind==t.SK.PropertyAssignment||Ze(i)))_e.emitExpr(pt(n,n,[r],null,i));else{let e=vn(n);_e.emitExpr(t.ir.op(o.Store,[e,vn(r)]))}else Qe(i),i=e.getDeclarationOfKind(i.symbol,t.SK.SetAccessor),i||Ae(n,$("setter not available"),9253),_e.emitExpr(pt(n,n,[r],null,i))}else if(n.kind==t.SK.ElementAccessExpression)_e.emitExpr(et(n,r));else if(n.kind==t.SK.ArrayLiteralExpression)if(r.kind==t.SK.ArrayLiteralExpression){const e=r.elements.map((e=>{const n=t.ir.shared(vn(e));return _e.emitExpr(n),n}));n.elements.forEach(((t,n)=>{$t(t,Lt(e[n]))}))}else{const e=t.ir.shared(vn(r));n.elements.forEach(((n,r)=>{$t(n,Lt(Qt("Array_::getAt",[e,t.ir.numlit(r)])))}))}else Ae(n,$("bad assignment target"),9249)}function Bt(e){if(_())switch(e){case"numops::adds":case"numops::subs":case"numops::eors":case"numops::ands":case"numops::orrs":return"@nomask@"+e}if(f())switch(e){case"pxt::switch_eq":return"numops::eq"}return e}function Ut(e,t,n){return Qt(Bt(e),[t,n])}function Vt(e){if(e.kind==t.SK.Identifier)return e.text;if(e.kind==t.SK.PropertyAccessExpression){const t=e,n=Vt(t.expression);if(n)return n+"."+t.name.text}return null}function Ht(e,t){if(!t)return null;const n=t.val;switch(Vt(e)){case"Math.floor":return{val:Math.floor(n)};case"Math.ceil":return{val:Math.ceil(n)};case"Math.round":return{val:Math.round(n)}}return null}function Gt(n){if(!n)return null;const r=u(n);if(void 0!==r.constantFolded)return r.constantFolded;if(D(n)&&n.parent.flags&e.NodeFlags.Const){const e=n;e.initializer&&(r.constantFolded=jt(e.initializer))}else if(n.kind==t.SK.EnumMember){const e=n,i=function(e){let n=j(e).enumval;if(!n){let t=P.getConstantValue(e);if(null==t)return null;n=t+""}return/^[+-]?\d+$/.test(n)||/^0x[A-Fa-f\d]{2,8}$/.test(n)?n:(t.U.userError("enumval only support number literals"),"0")}(e);if(null==i)r.constantFolded=jt(e.initializer);else{const e=parseInt(i);isNaN(e)||(r.constantFolded={val:e})}}else if(n.kind==t.SK.PropertyDeclaration&&k(n)&&E(n)){const e=n;r.constantFolded=jt(e.initializer)}return r.constantFolded}function jt(e){if(!e)return null;const n=u(e);if(void 0===n.constantFolded){n.constantFolded=null;const r=function(e){if(!e)return null;switch(e.kind){case t.SK.PrefixUnaryExpression:{const n=e,r=jt(n.operand);return function(e,n){if(!n)return null;const r=n.val;switch(e){case t.SK.PlusToken:return{val:+r};case t.SK.MinusToken:return{val:-r};case t.SK.TildeToken:return{val:~r};case t.SK.ExclamationToken:return{val:!r};default:return null}}(n.operator,r)}case t.SK.BinaryExpression:{const n=e,r=jt(n.left);if(!r)return null;const i=jt(n.right);return i?function(e,n,r){if(!n||!r)return null;const i=n.val,s=r.val;switch(e){case t.SK.PlusToken:return{val:i+s};case t.SK.MinusToken:return{val:i-s};case t.SK.SlashToken:return{val:i/s};case t.SK.PercentToken:return{val:i%s};case t.SK.AsteriskToken:return{val:i*s};case t.SK.AsteriskAsteriskToken:return{val:i**s};case t.SK.AmpersandToken:return{val:i&s};case t.SK.BarToken:return{val:i|s};case t.SK.CaretToken:return{val:i^s};case t.SK.LessThanLessThanToken:return{val:i<<s};case t.SK.GreaterThanGreaterThanToken:return{val:i>>s};case t.SK.GreaterThanGreaterThanGreaterThanToken:return{val:i>>>s};case t.SK.LessThanEqualsToken:return{val:i<=s};case t.SK.LessThanToken:return{val:i<s};case t.SK.GreaterThanEqualsToken:return{val:i>=s};case t.SK.GreaterThanToken:return{val:i>s};case t.SK.EqualsEqualsToken:return{val:i==s};case t.SK.EqualsEqualsEqualsToken:return{val:i===s};case t.SK.ExclamationEqualsEqualsToken:return{val:i!==s};case t.SK.ExclamationEqualsToken:return{val:i!=s};case t.SK.BarBarToken:return{val:i||s};case t.SK.AmpersandAmpersandToken:return{val:i&&s};default:return null}}(n.operatorToken.kind,r,i):null}case t.SK.NumericLiteral:{const t=parseFloat(e.text);return isNaN(t)?null:{val:t}}case t.SK.NullKeyword:return{val:null};case t.SK.TrueKeyword:return{val:!0};case t.SK.FalseKeyword:return{val:!1};case t.SK.UndefinedKeyword:return{val:void 0};case t.SK.CallExpression:{const t=e;return 1==t.arguments.length?Ht(t.expression,jt(t.arguments[0])):null}case t.SK.PropertyAccessExpression:case t.SK.Identifier:return Gt(ot(e));case t.SK.AsExpression:return jt(e.expression);default:return null}}(e);n.constantFolded=r}return n.constantFolded}function Kt(e){let n=t.target.switches.boxDebug,r=null;if(n)try{t.target.switches.boxDebug=!1,r=vn(e)}finally{t.target.switches.boxDebug=n}else r=vn(e);let i=Jt(r);if(void 0===i)throw h(9267,$("a constant number-like expression is required here"));return i}function Wt(e,t){let n=zt(e,t,"userconfig");return null==n&&(n=zt(e,t,"config")),n}function zt(n,r,i){let s=P.getSymbolsInScope(n,e.SymbolFlags.Module).filter((e=>e.name==i&&!!e.valueDeclaration))[0];if(!s)return null;for(let e of s.valueDeclaration.body.statements)if(e.kind==t.SK.VariableStatement){let t=e;for(let e of t.declarationList.declarations)if(e.symbol.name==r)return Kt(e.initializer)}return null}function qt(t,n){let r=P.getSymbolsInScope(t,e.SymbolFlags.Enum).filter((e=>"DAL"==e.name&&!!e.valueDeclaration))[0];if(!r)return null;let i=r.valueDeclaration.members.filter((e=>e.symbol.name==n))[0];return i?P.getConstantValue(i):null}function Jt(e){if(e.exprKind==t.ir.EK.NumberLiteral){let n=e.data;if(r.target.isNative&&!f()){if(n==t.taggedNull||n==t.taggedUndefined||n==t.taggedFalse)return 0;if(n==t.taggedTrue)return 1;if("number"==typeof n)return n>>1}else if("number"==typeof n)return n}else if(e.exprKind==t.ir.EK.RuntimeCall&&2==e.args.length){let t=Jt(e.args[0]),n=Jt(e.args[1]);if(void 0===t||void 0===n)return;switch(e.data){case"numops::orrs":return t|n;case"numops::adds":return t+n;default:return void console.log(e)}}}function Yt(e){if(r.target.isNative&&!f()){const r=Z(e);if(null!=r)return t.ir.numlit(r);if("number"==typeof e){if(n=e,!t.target.switches.boxDebug&&(0|n)==n&&-1073741824<=n&&n<=1073741823)return t.ir.numlit(e<<1|1);{let n=ge.emitDouble(e);return t.ir.ptrlit(n,JSON.stringify(e))}}throw t.U.oops("bad literal: "+e)}return t.ir.numlit(e);var n}function Xt(e){if(e.kind==t.SK.NullKeyword){let t=u(e).valueOverride;if(null!=t)return t.exprKind==o.NumberLiteral?!r.target.isNative||!!(1&t.data):t.exprKind==o.RuntimeCall&&"pxt::ptrOfLiteral"==t.data?t.args[0].exprKind==o.PointerLiteral&&!isNaN(parseFloat(t.args[0].jsInfo)):t.exprKind==o.PointerLiteral&&!isNaN(parseFloat(t.jsInfo))}return e.kind==t.SK.NumericLiteral||fe(ee(e))}function Qt(e,n){return t.ir.rtcallMask(e,(1<<n.length)-1,0,n)}function Zt(e,n,i,a=null){let l=[],c=t.hexfile.lookupFunc(e);if(_()){let n=t.U.lookup(s,e);n&&(c=n,e=n.name)}c&&(l=c.argsFmt),a&&(n=n.concat(a));let u=ct(n),d=[],p=n.map(((n,r)=>{let s=vn(n);if(!m())return s;let a=l[r+1],c=Xt(n);if(!a&&e.indexOf("::")<0&&(a=c?"I":"_"),a){if("_"==a[0]||"T"==a||"N"==a){let e=function(e){switch(e){case"_Buffer":return pxt.BuiltInType.BoxedBuffer;case"_Image":return t.target.imageRefTag||pxt.BuiltInType.RefImage;case"_Action":return pxt.BuiltInType.RefAction;case"_RefCollection":return pxt.BuiltInType.RefCollection;default:return null}}(a);return e&&d.push({argIdx:r,method:"_validate",refTag:e,refTagNullable:!!i.argsNullable}),s}if("I"==a)return s.exprKind==o.NumberLiteral&&"number"==typeof s.data?t.ir.numlit(s.data>>1):(d.push({argIdx:r,method:"pxt::toInt"}),s);if("B"==a)return u&=~(1<<r),on(n,s);if("S"==a)return s.isStringLiteral||(d.push({argIdx:r,method:"_pxt_stringConv",returnsRef:!0}),u|=1<<r),s;if("F"==a||"D"==a)return"D"==a&&t.U.oops("double arguments not yet supported"),c||t.U.userError("argsFmt=...F/D... but argument not a number in "+e),d.push({argIdx:r,method:"D"==a?"pxt::toDouble":"pxt::toFloat"}),s;throw t.U.oops("invalid format specifier: "+a)}throw t.U.userError("not enough args for "+e)})),h=t.ir.rtcallMask(e,u,i?i.callingConvention:0,p);if(h.mask||(h.mask={refMask:0}),h.mask.conversions=d,r.target.isNative){let e=l[0];"I"==e?h=g(h):"B"==e?h=y(h):"F"==e?h=function(e){return m()?t.ir.rtcall("pxt::fromFloat",[e]):e}(h):"D"==e&&(t.U.oops("double returns not yet supported"),h=function(e){return m()?t.ir.rtcall("pxt::fromDouble",[e]):e}(h))}return h}function en(n){ge.numStmts++;const s=t.assembler.debug||t.target.switches.size||t.target.sourceMap;let o=!!r.breakpoints;if(!s&&!o)return;const a=e.getSourceFileOfNode(n);if(r.justMyCode&&c(a)&&(o=!1),!s&&!o)return;let l=n.pos;for(;/^\s$/.exec(a.text[l]);)l++;for(;"/"==a.text[l]&&"/"==a.text[l+1];){for(;a.text[l]&&"\n"!=a.text[l];)l++;l++}const u=e.getLineAndCharacterOfPosition(a,l);if(s){let e=n.end;e-l>80&&(e=l+80);const r=a.text.slice(l,e).trim().replace(/\n[^]*/,"...");_e.emit(t.ir.comment(`${a.fileName.replace(/pxt_modules\//,"")}(${u.line+1},${u.character+1}): ${r}`))}if(!o)return;const d=e.getLineAndCharacterOfPosition(a,n.end),p={id:i.breakpoints.length,isDebuggerStmt:n.kind==t.SK.DebuggerStatement,fileName:a.fileName,start:l,length:n.end-l,line:u.line,endLine:d.line,column:u.character,endColumn:d.character};i.breakpoints.push(p);const h=t.ir.stmt(t.ir.SK.Breakpoint,null);h.breakpointInfo=p,_e.emit(h)}function tn(e,n){switch(n){case t.SK.PlusToken:return"numops::adds";case t.SK.MinusToken:return"numops::subs";case t.SK.SlashToken:return"numops::div";case t.SK.PercentToken:return"numops::mod";case t.SK.AsteriskToken:return"numops::muls";case t.SK.AsteriskAsteriskToken:return"Math_::pow";case t.SK.AmpersandToken:return"numops::ands";case t.SK.BarToken:return"numops::orrs";case t.SK.CaretToken:return"numops::eors";case t.SK.LessThanLessThanToken:return"numops::lsls";case t.SK.GreaterThanGreaterThanToken:return"numops::asrs";case t.SK.GreaterThanGreaterThanGreaterThanToken:return"numops::lsrs";case t.SK.LessThanEqualsToken:return"numops::le";case t.SK.LessThanToken:return"numops::lt";case t.SK.GreaterThanEqualsToken:return"numops::ge";case t.SK.GreaterThanToken:return"numops::gt";case t.SK.EqualsEqualsToken:return"numops::eq";case t.SK.EqualsEqualsEqualsToken:return"numops::eqq";case t.SK.ExclamationEqualsEqualsToken:return"numops::neqq";case t.SK.ExclamationEqualsToken:return"numops::neq";default:return null}}function nn(e){if(e.operatorToken.kind==t.SK.EqualsToken)return function(e){let n=e.right;e.parent.kind==t.SK.ExpressionStatement&&(n=null);let r=Rt(e.left,n);$t(e.left,e.right,!0);let i=n?vn(n):Yt(void 0);return r(),i}(e);const n=jt(e);if(n)return Yt(n.val);let r=null,i=null;e.operatorToken.kind!=t.SK.PlusToken&&e.operatorToken.kind!=t.SK.PlusEqualsToken||(r=ee(e.left),i=ee(e.right),(ue(r)||ue(i)&&e.operatorToken.kind==t.SK.PlusToken)&&(u(e).exprInfo={leftType:P.typeToString(r),rightType:P.typeToString(i)}));if(e.operatorToken.kind==t.SK.CommaToken){if(ln(e.left))return vn(e.right);{let n=cn(e.left);return t.ir.op(o.Sequence,[n,vn(e.right)])}}switch(e.operatorToken.kind){case t.SK.BarBarToken:case t.SK.AmpersandAmpersandToken:return function(e){let n=vn(e.left),r=(ue(ee(e.left)),_e.mkLabel("lazy"));n=t.ir.shared(n);let i=t.ir.rtcall("numops::toBool",[n]),s=_e.mkLabel("lazySkip"),o=e.operatorToken.kind==t.SK.BarBarToken?t.ir.JmpMode.IfZero:e.operatorToken.kind==t.SK.AmpersandAmpersandToken?t.ir.JmpMode.IfNotZero:t.U.oops();return _e.emitJmp(s,i,o),_e.emitJmp(r,n,t.ir.JmpMode.Always,n),_e.emitLbl(s),_e.emitExpr(Qt("langsupp::ignore",[n])),_e.emitJmp(r,vn(e.right),t.ir.JmpMode.Always),_e.emitLbl(r),At()}(e);case t.SK.InstanceOfKeyword:return function(e){let n=ee(e.right),r=Y(n)?at(e.right):null;r&&r.kind==t.SK.ClassDeclaration||h(9275,$("unsupported instanceof expression"));let i=Ve(n,r);bt(i);let s=t.ir.op(t.ir.EK.InstanceOf,[vn(e.left)],i);return s.jsInfo="bool",s}(e)}if(e.operatorToken.kind==t.SK.PlusToken&&(ue(r)||ue(i)))return Zt("String_::concat",[Je(e.left),Je(e.right)],null);if(e.operatorToken.kind==t.SK.PlusEqualsToken&&ue(r)){let n=Rt(e.left),r=t.ir.shared(Zt("String_::concat",[Je(e.left),Je(e.right)],null));return $t(e.left,Lt(r)),n(),r}let s=function(e){switch(e){case t.SK.PlusEqualsToken:return t.SK.PlusToken;case t.SK.MinusEqualsToken:return t.SK.MinusToken;case t.SK.AsteriskEqualsToken:return t.SK.AsteriskToken;case t.SK.AsteriskAsteriskEqualsToken:return t.SK.AsteriskAsteriskToken;case t.SK.SlashEqualsToken:return t.SK.SlashToken;case t.SK.PercentEqualsToken:return t.SK.PercentToken;case t.SK.LessThanLessThanEqualsToken:return t.SK.LessThanLessThanToken;case t.SK.GreaterThanGreaterThanEqualsToken:return t.SK.GreaterThanGreaterThanToken;case t.SK.GreaterThanGreaterThanGreaterThanEqualsToken:return t.SK.GreaterThanGreaterThanGreaterThanToken;case t.SK.AmpersandEqualsToken:return t.SK.AmpersandToken;case t.SK.BarEqualsToken:return t.SK.BarToken;case t.SK.CaretEqualsToken:return t.SK.CaretToken;default:return t.SK.Unknown}}(e.operatorToken.kind),a=tn(0,s||e.operatorToken.kind);return a||Ae(e.operatorToken,$("unsupported operator"),9250),s?Pt(e.left,a,!1,e.right):(n=>{n=Bt(n);let r=[e.left,e.right];return t.ir.rtcallMask(n,ct(r),0,r.map((e=>vn(e))))})(a)}function rn(e){e.statements.forEach(En)}function sn(t){if(t.flags&e.NodeFlags.Let||t.flags&e.NodeFlags.Const)return!0;throw h(9260,$("variable needs to be defined using 'let' instead of 'var'"))}function on(e,n=null){if(!n&&_()&&e.kind==t.SK.BinaryExpression){let n=e,r=t.U.lookup(t.thumbCmpMap,tn(0,n.operatorToken.kind));if(r)return t.ir.rtcall(r,[vn(n.left),vn(n.right)])}return n||(n=vn(e)),f()?n:t.ir.rtcall("numops::toBoolDecr",[n])}function an(e){let t=d(e);return{fortop:".fortop."+t,cont:".cont."+t,brk:".brk."+t,ret:".ret."+t}}function ln(e){if(!e)return!0;switch(e.kind){case t.SK.Identifier:case t.SK.StringLiteral:case t.SK.NumericLiteral:case t.SK.NullKeyword:return!0}return!1}function cn(e){return vn(e)}function un(e){if(ln(e))return;en(e);let t=cn(e);_e.emitExpr(t),_e.stackEmpty()}function dn(e=1){for(;e--;)_e.emitExpr(Qt("pxt::endTry",[]))}function pn(){h(9282,$("jumps (return, break, continue) through finally blocks not supported yet"))}function hn(t){let n=0;if(t.kind==e.SyntaxKind.Block&&t.parent)if(t.parent.kind==e.SyntaxKind.CatchClause){t.parent.parent.finallyBlock&&(n++,pn())}else if(t.parent.kind==e.SyntaxKind.TryStatement){const e=t.parent;e.tryBlock==t&&(e.catchClause&&n++,e.finallyBlock&&(n++,pn()))}return n}function fn(e){switch(e.kind){case t.SK.WhileStatement:case t.SK.ForInStatement:case t.SK.ForOfStatement:case t.SK.ForStatement:case t.SK.DoStatement:return!0;default:return!1}}function mn(e,n,i){if(e.name.kind===t.SK.ObjectBindingPattern||e.name.kind==t.SK.ArrayBindingPattern)return n||(n=e.initializer?t.ir.shared(vn(e.initializer)):Ge(e),i=e.initializer?ee(e.initializer):ee(e)),e.name.elements.forEach((e=>mn(e,n,i))),_e.stackEmpty(),null;if(!nt(e))return null;if(Gt(e))return null;let s;if(O(e)?(Pe(e),s=Me(e)):s=_e.mkLocal(e,De(e)),St(s.info),s.isByRefLocal()&&_e.emitExpr(s.storeDirect(t.ir.rtcall("pxtrt::mklocRef",[]))),Le(ee(e)),e.kind===t.SK.BindingElement){en(e);let[t,r]=gn(e,n,i);_e.emitExpr(s.storeByRef(t))}else if(e.initializer){if(en(e),O(e)){let n=j(e).jres;if(n){"true"==n&&(n=V(P,e));let i=t.U.lookup(r.jres||{},n);i?te=i:h(9270,$("resource '{0}' not found in any .jres file",n))}}e.initializer,_e.emitExpr(s.storeByRef(vn(e.initializer))),te=null,_e.stackEmpty()}else(function(e){for(;e;){if(fn(e))return!0;e=e.parent}return!1})(e)&&(en(e),_e.emitExpr(s.storeByRef(Yt(void 0))),_e.stackEmpty());return s}function _n(e){return mn(e,null,null)}function gn(e,n,r){const i=e.parent.parent;if(i.kind===t.SK.BindingElement){const e=gn(i,n,r);n=e[0],r=e[1]}if(e.parent.kind==t.SK.ArrayBindingPattern){const i=e.parent.elements.indexOf(e);e.dotDotDotToken&&h(9203,$("spread operator not supported yet"));const s=X(r,i);return[Qt("Array_::getAt",[n,t.ir.numlit(i)]),s]}return function(e,n,r,i){const s=P.getPropertyOfType(r,i);t.U.assert(!!s,"field sym");const a=P.getTypeOfSymbolAtLocation(s,e);let l;if(Y(r)){const e=Ve(r);l=t.ir.op(o.FieldAccess,[n],Mt(e,Ft(e,i)))}else l=ft([n],{ifaceIndex:Re(i,!0),callLocationIndex:Sn(e),noArgs:!0});return[l,a]}(e,n,r,(e.propertyName||e.name).text)}function yn(e){!function(e,n){const r=e=>{e&&e.kind==t.SK.ClassDeclaration&&h(9261,$("Interface with same name as a class not supported"))};if(r(n.symbol.valueDeclaration),n.symbol.declarations&&n.symbol.declarations.forEach(r),n.heritageClauses)for(let e of n.heritageClauses)switch(e.token){case t.SK.ExtendsKeyword:J(ee(e.types[0]))&&h(9262,$("Extending a class by an interface not supported."))}}(0,e);let n=j(e);n.autoCreate&&(W[n.autoCreate]=!0)}function bn(e,t){let n=F;U++;try{F=null;let r=t(e);return F&&h(B,F),F=n,U--,r}catch(t){return U--,F=null,Ie(e,t.ksErrorCode||9200,t.message),pxt.debug(t.stack),null}}function vn(e,n=!0){let r=e;if(n&&r.cachedIR)return r.cachedIR;let i=bn(r,Tn)||Yt(void 0);return n&&r.needsIRCache?(r.cachedIR=t.ir.shared(i),r.cachedIR):i}function Tn(n){let r=function(n){switch(n.kind){case t.SK.NullKeyword:let r=u(n).valueOverride;return r||Yt(null);case t.SK.TrueKeyword:return Yt(!0);case t.SK.FalseKeyword:return Yt(!1);case t.SK.TemplateHead:case t.SK.TemplateMiddle:case t.SK.TemplateTail:case t.SK.NumericLiteral:case t.SK.StringLiteral:case t.SK.NoSubstitutionTemplateLiteral:return function(e){if(e.kind==t.SK.NumericLiteral)return e.imageLiteral?t.ir.ptrlit(e.imageLiteral,e.jsLit):Yt(parseFloat(e.text));if(T(e))return qe(e.text);throw t.oops()}(n);case t.SK.TaggedTemplateExpression:return vt(n);case t.SK.PropertyAccessExpression:return Xe(n);case t.SK.BinaryExpression:return nn(n);case t.SK.PrefixUnaryExpression:return function(e){const n=jt(e);if(n)return Yt(n.val);switch(e.operator){case t.SK.ExclamationToken:return y(t.ir.rtcall("Boolean_::bang",[on(e.operand)]));case t.SK.PlusPlusToken:return Pt(e.operand,"numops::adds",!1);case t.SK.MinusMinusToken:return Pt(e.operand,"numops::subs",!1);case t.SK.PlusToken:case t.SK.MinusToken:{let n=vn(e.operand),r=Jt(n);return null!=r?Yt(-r):e.operator==t.SK.MinusToken?Ut("numops::subs",Yt(0),n):Ut("numops::subs",n,Yt(0))}case t.SK.TildeToken:{let t=vn(e.operand),n=Jt(t);return null!=n?Yt(~n):Qt(Bt("numops::bnot"),[t])}default:throw Ae(e,$("unsupported prefix unary operation"),9245)}}(n);case t.SK.PostfixUnaryExpression:return function(e){if(de(ee(e.operand)))switch(e.operator){case t.SK.PlusPlusToken:return Pt(e.operand,"numops::adds",!0);case t.SK.MinusMinusToken:return Pt(e.operand,"numops::subs",!0)}throw Ae(e,$("unsupported postfix unary operation"),9246)}(n);case t.SK.ElementAccessExpression:return et(n);case t.SK.ParenthesizedExpression:return function(e){return vn(e.expression)}(n);case t.SK.TypeAssertionExpression:return function(e){return e.expression,vn(e.expression)}(n);case t.SK.ArrayLiteralExpression:return function(e){X(ee(e));let n=t.ir.shared(t.ir.rtcall("Array_::mk",[]));for(let r of e.elements){let e=lt(r)?2:0;_e.emitExpr(t.ir.rtcall("Array_::push",[n,vn(r)],e))}return n}(n);case t.SK.NewExpression:return function(e){let n=P.getTypeAtLocation(e);if(n&&z(n))throw t.oops();if(n&&Y(n)){let n,r=at(e.expression);r.kind!=t.SK.ClassDeclaration&&h(9221,$("new expression only supported on class types"));let i=Ve(ee(e),r);for(let e=i;e&&(n=gt(e.decl),!n);e=e.baseClassInfo);bt(i);let s=i.id+"_VT",o=t.ir.rtcall("pxt::mkClassInstance",[t.ir.ptrlit(s,s)]);if(n){o=It(o),rt(n);let r=(e.arguments||[]).slice(0),i=j(n);dt(P.getResolvedSignature(e),r,i);let s=r.map((e=>vn(e)));return i.shim?t.ir.rtcall(i.shim,s):(s.unshift(o),_e.emitExpr(_t(n,e,s)),o)}return e.arguments&&e.arguments.length&&h(9222,$("constructor with arguments not found")),o}throw Ae(e,$("unknown type for new"),9243)}(n);case t.SK.SuperKeyword:case t.SK.ThisKeyword:return ze(n);case t.SK.CallExpression:return function(e){const t=P.getResolvedSignature(e);return pt(e,e.expression,e.arguments,t)}(n);case t.SK.FunctionExpression:case t.SK.ArrowFunction:return Nt(n);case t.SK.Identifier:return We(n);case t.SK.ConditionalExpression:return function(e){let n=_e.mkLabel("condexprz"),r=_e.mkLabel("condexprfin");return _e.emitJmp(n,on(e.condition),t.ir.JmpMode.IfZero),_e.emitJmp(r,vn(e.whenTrue),t.ir.JmpMode.Always),_e.emitLbl(n),_e.emitJmp(r,vn(e.whenFalse),t.ir.JmpMode.Always),_e.emitLbl(r),At()}(n);case t.SK.AsExpression:return function(e){return e.expression,vn(e.expression)}(n);case t.SK.TemplateExpression:return Ye(n);case t.SK.ObjectLiteralExpression:return function(e){let n=t.ir.shared(t.ir.rtcall("pxtrt::mkMap",[]));return e.properties.forEach((e=>{let r,i;if(t.assert(!e.questionToken),e.kind==t.SK.ShorthandPropertyAssignment){const n=e;t.assert(!n.equalsToken&&!n.objectAssignmentInitializer),r=e.name.text;const s=P.getShorthandAssignmentValueSymbol(e),o=s&&s.valueDeclaration&&s.valueDeclaration.name;if(!o||o.kind!=t.SK.Identifier)throw Ae(e);i=We(o)}else{if(e.name.kind==t.SK.ComputedPropertyName){const t=e.name.expression;return void _e.emitExpr(Zt("pxtrt::mapSetByString",[Lt(n,!0),t,e.initializer],null))}r=e.name.kind==t.SK.StringLiteral?e.name.text:e.name.getText(),i=vn(e.initializer)}const s=t.target.isNative?t.ir.numlit(Re(r)):t.ir.ptrlit(null,JSON.stringify(r)),o=[n,s,i];_e.emitExpr(t.ir.rtcall(t.target.isNative?"pxtrt::mapSet":"pxtrt::mapSetByString",o))})),n}(n);case t.SK.TypeOfExpression:return function(e){return Zt("pxt::typeOf",[e.expression],null)}(n);case e.SyntaxKind.DeleteExpression:return function(e){let n,r;if(e.expression.kind==t.SK.PropertyAccessExpression){const t=e.expression;n=t.expression,r=Lt(qe(t.name.text))}else{if(e.expression.kind!=t.SK.ElementAccessExpression)throw h(9276,$("expression not supported as argument to 'delete'"));{const t=e.expression;n=t.expression,r=t.argumentExpression}}const i=ee(n);if(J(i))throw h(9277,$("'delete' not supported on class types"));if(z(i))throw h(9277,$("'delete' not supported on array"));return Zt("pxtrt::mapDeleteByString",[n,r],null)}(n);default:return Ae(n),null}}(n);if(r.isExpr())return r;throw new Error("expecting expression")}function kn(n){const r=u(n);if(r.usedNodes){ie=!1;for(let e of t.U.values(r.usedNodes))rt(e);for(let e of r.usedActions)e(ge);ie=!0}else O(n)||e.isClassDeclaration(n)?(ie=!1,re=r,re.usedNodes=null,re.usedActions=null,O(n)&&!Gt(n)&&Pe(n),En(n),ie=!0):(re=r,re.usedNodes={},re.usedActions=[],En(n),re=null)}function En(e){bn(e,xn)}function xn(n){switch(n.kind){case t.SK.SourceFile:return function(e){e.statements.forEach(En)}(n);case t.SK.InterfaceDeclaration:return yn(n);case t.SK.VariableStatement:return function(n){function r(e){let n=t.U.lookup(Q,e.name);if(n||(n=e,Q[e.name]=n),n.value!=e.value)throw h(9269,$("conflicting values for config.{0}",e.name))}if(n.declarationList.flags&e.NodeFlags.Const){let e=n.parent&&n.parent.kind==t.SK.ModuleBlock?K(n.parent.parent):"?";if("config"==e||"userconfig"==e)for(let t of n.declarationList.declarations){let i=se(t);if(!t.initializer)continue;let s=Kt(t.initializer),o=qt(n,"CFG_"+i);if(null==o||0==o)throw h(9268,$("can't find DAL.CFG_{0}",i));"userconfig"==e&&(i="!"+i),r({name:i,key:o,value:s})}}e.isInAmbientContext(n)||(sn(n.declarationList),n.declarationList.declarations.forEach(En))}(n);case t.SK.ModuleDeclaration:return function(e){En(e.body)}(n);case t.SK.EnumDeclaration:return;case t.SK.FunctionDeclaration:case t.SK.Constructor:case t.SK.MethodDeclaration:return void Nt(n);case t.SK.ExpressionStatement:return function(e){un(e.expression)}(n);case t.SK.Block:case t.SK.ModuleBlock:return rn(n);case t.SK.VariableDeclaration:return _n(n),void xt();case t.SK.IfStatement:return function(e){en(e);let t=_e.mkLabel("else");_e.emitJmpZ(t,on(e.expression)),En(e.thenStatement);let n=_e.mkLabel("afterif");_e.emitJmp(n),_e.emitLbl(t),e.elseStatement&&En(e.elseStatement),_e.emitLbl(n)}(n);case t.SK.WhileStatement:return function(e){en(e);let t=an(e);_e.emitLblDirect(t.cont),en(e.expression),_e.emitJmpZ(t.brk,on(e.expression)),En(e.statement),_e.emitJmp(t.cont),_e.emitLblDirect(t.brk)}(n);case t.SK.DoStatement:return function(e){en(e);let t=an(e);_e.emitLblDirect(t.cont),En(e.statement),en(e.expression),_e.emitJmpZ(t.brk,on(e.expression)),_e.emitJmp(t.cont),_e.emitLblDirect(t.brk)}(n);case t.SK.ForStatement:return function(e){e.initializer&&e.initializer.kind==t.SK.VariableDeclarationList?(sn(e.initializer),e.initializer.declarations.forEach(En)):un(e.initializer),en(e);let n=an(e);_e.emitLblDirect(n.fortop),e.condition&&(en(e.condition),_e.emitJmpZ(n.brk,on(e.condition))),En(e.statement),_e.emitLblDirect(n.cont),un(e.incrementor),_e.emitJmp(n.fortop),_e.emitLblDirect(n.brk)}(n);case t.SK.ForOfStatement:return function(e){if(!e.initializer||e.initializer.kind!=t.SK.VariableDeclarationList)return void Ae(e,"only a single variable may be used to iterate a collection");let n=e.initializer;if(1!=n.declarations.length)return void Ae(e,"only a single variable may be used to iterate a collection");sn(n);let r=ee(e.expression),i="",s="";if(ue(r))i="String_::charAt",s="String_::length";else{if(!z(r))return void Ae(e.expression,"cannot use for...of with this expression");i="Array_::getAt",s="Array_::length"}rt(n.declarations[0]);const o=_n(n.declarations[0]);t.U.assert(!!o||!ge.finalPass),_e.stackEmpty();let a=_e.mkLocalUnnamed();_e.emitExpr(a.storeByRef(vn(e.expression)));let l=_e.mkLocalUnnamed();_e.emitExpr(l.storeByRef(Yt(0))),_e.stackEmpty(),en(e);let c=an(e);_e.emitLblDirect(c.fortop);let u=t.ir.rtcall(s,[a.loadCore()]),d=Ut("numops::lt_bool",l.load(),g(u));_e.emitJmpZ(c.brk,d);let p=e=>m()?t.ir.rtcall("pxt::toInt",[e]):e;o&&(_e.emitExpr(o.storeByRef(t.ir.rtcall(i,[a.loadCore(),p(l.loadCore())]))),en(e.initializer)),xt(),En(e.statement),_e.emitLblDirect(c.cont),_e.emitExpr(l.storeByRef(Ut("numops::adds",l.load(),Yt(1)))),_e.emitJmp(c.fortop),_e.emitLblDirect(c.brk),_e.emitExpr(a.storeByRef(Yt(void 0)))}(n);case t.SK.ContinueStatement:case t.SK.BreakStatement:return function(n){en(n);let r=n.label?n.label.text:null,i=n.kind==t.SK.BreakStatement,s=0,o=function n(o){return o?r&&o.kind==t.SK.LabeledStatement&&o.label.text==r?o.statement:o.kind==t.SK.SwitchStatement&&!r&&i||!r&&e.isIterationStatement(o,!1)?o:(s+=hn(o),n(o.parent)):null}(n);if(o){let r=an(o);dn(s),n.kind==t.SK.ContinueStatement?e.isIterationStatement(o,!1)?_e.emitJmp(r.cont):Ie(n,9231,$("continue on non-loop")):n.kind==t.SK.BreakStatement?_e.emitJmp(r.brk):t.oops()}else Ie(n,9230,$("cannot find outer loop"))}(n);case t.SK.LabeledStatement:return function(e){let t=an(e.statement);En(e.statement),_e.emitLblDirect(t.brk)}(n);case t.SK.ReturnStatement:return function(e){en(e);let n=null;e.expression?n=vn(e.expression):ne(_e.action)&&(n=Yt(void 0));let r=0;for(let t=e;t&&t!=_e.action;t=t.parent)r+=hn(t);dn(r),_e.emitJmp(an(_e.action).ret,n,t.ir.JmpMode.Always)}(n);case t.SK.ClassDeclaration:return function(e){const t=Ve(null,e);t.isUsed&&ge.usedClassInfos.indexOf(t)<0&&ge.usedClassInfos.push(t),e.members.forEach(En)}(n);case t.SK.PropertyDeclaration:case t.SK.PropertyAssignment:return function(e){if(k(e))_n(e);else if(e.initializer){let t=Ve(ee(e.parent));ge.finalPass&&t.isUsed&&!t.ctor&&h(9209,$("class field initializers currently require an explicit constructor"))}}(n);case t.SK.SwitchStatement:return function(e){en(e);let n,r=an(e),i=t.ir.shared(vn(e.expression)),s=e.caseBlock.clauses.map((e=>{let r=_e.mkLabel("switch");if(e.kind==t.SK.CaseClause){let n=e,s=vn(n.expression),o=lt(n.expression)?1:0,a=t.ir.rtcallMask(Bt("pxt::switch_eq"),o,0,[s,i]);_e.emitJmp(r,a,t.ir.JmpMode.IfNotZero,i)}else e.kind==t.SK.DefaultClause?(t.assert(!n,"!defaultLabel"),n=r):t.oops();return r}));n?_e.emitJmp(n,i):_e.emitJmp(r.brk,i),e.caseBlock.clauses.forEach(((e,t)=>{_e.emitLbl(s[t]),e.statements.forEach(En)})),_e.emitLblDirect(r.brk)}(n);case t.SK.TypeAliasDeclaration:return;case e.SyntaxKind.TryStatement:return function(e){const n=e=>Qt("pxt::beginTry",[t.ir.ptrlit(e.lblName,e)]);en(e);const r=_e.mkLabel("catch");r.lblName="_catch_"+d(e);const i=_e.mkLabel("finally");if(i.lblName="_finally_"+d(e),e.finallyBlock&&_e.emitExpr(n(i)),e.catchClause&&_e.emitExpr(n(r)),_e.stackEmpty(),rn(e.tryBlock),_e.stackEmpty(),e.catchClause){const t=_e.mkLabel("catchend");dn(),_e.emitJmp(t),_e.emitLbl(r);const n=e.catchClause.variableDeclaration;if(n){_n(n);const e=Me(n);_e.emitExpr(e.storeByRef(Qt("pxt::getThrownValue",[])))}xt(),rn(e.catchClause.block),_e.emitLbl(t)}e.finallyBlock&&(dn(),_e.emitLbl(i),rn(e.finallyBlock),_e.emitExpr(Qt("pxt::endFinally",[])))}(n);case e.SyntaxKind.ThrowStatement:return function(e){en(e),_e.emitExpr(Qt("pxt::throwValue",[vn(e.expression)]))}(n);case t.SK.DebuggerStatement:return function(e){en(e)}(n);case t.SK.GetAccessor:case t.SK.SetAccessor:return function(e){Nt(e)}(n);case t.SK.ImportEqualsDeclaration:case t.SK.EmptyStatement:case t.SK.SemicolonClassElement:return;default:Ae(n)}}function Sn(e){return i.procCallLocations.push(t.nodeLocationInfo(e))-1}},t.isStringType=ue;class pe{constructor(){this.procs=[],this.globals=[],this.finalPass=!1,this.writeFile=(e,t)=>{},this.usedClassInfos=[],this.numStmts=1,this.commSize=0,this.itEntries=0,this.itFullEntries=0,this.numMethods=0,this.numVirtMethods=0,this.usedChars=new Uint32Array(2048),this.explicitlyUsedIfaceMembers={},this.ifaceMemberMap={},this.strings={},this.hexlits={},this.doubles={},this.otherLiterals=[],this.codeHelpers={},this.lblNo=0}reset(){this.lblNo=0,this.otherLiterals=[],this.strings={},this.hexlits={},this.doubles={},this.numStmts=0}getTitle(){const e=this.name||t.U.lf("Untitled");return e.length>=90?e.slice(0,87)+"...":e}addProc(e){t.assert(!this.finalPass,"!this.finalPass"),this.procs.push(e),e.seqNo=this.procs.length}recordHelper(e,t,n){const r=e=>{e.codeHelpers[t]||(e.codeHelpers[t]=n(e))};r(this),this.recordAction(e,r)}recordAction(e,n){e?e.usedActions&&e.usedActions.push(n):t.U.oops("no using ctx!")}emitLabelled(e,n,r){let i=t.U.lookup(n,e);if(null!=i)return i;let s=r+this.lblNo++;return n[e]=s,s}emitDouble(e){return this.emitLabelled(t.target.switches.numFloat?function(e){let n=new Float32Array(1);return n[0]=e,t.U.toHex(new Uint8Array(n.buffer))}(e):function(e){let n=new Float64Array(1);return n[0]=e,t.U.toHex(new Uint8Array(n.buffer))}(e),this.doubles,"_dbl")}emitString(e){if(!this.finalPass)for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);n>=128&&(this.usedChars[n>>5]|=1<<(31&n))}return this.emitLabelled(e,this.strings,"_str")}emitHexLiteral(e){return this.emitLabelled(e,this.hexlits,"_hexlit")}setPerfCounters(e){if(!t.target.switches.profile)return[];const n=e.slice();return this.procs.forEach((e=>{e.perfCounterName&&(t.U.assert(t.target.switches.profile),e.perfCounterNo=n.length,n.push(e.perfCounterName))})),n}}function he(e){if(!e.modifiers)return!1;if(e.parent.kind!=t.SK.Constructor)return!1;for(let n of e.modifiers)if(n.kind==t.SK.PrivateKeyword||n.kind==t.SK.PublicKeyword||n.kind==t.SK.ProtectedKeyword)return!0;return!1}function fe(t){return t.flags&e.TypeFlags.Union?t.types.every((e=>fe(e))):!!(t.flags&(e.TypeFlags.NumberLike|e.TypeFlags.EnumLike|e.TypeFlags.BooleanLike))}function me(e,t,n,r){const i=r(e);return t&&e.recordAction(n,r),i}t.Binary=pe,t.isCtorField=he}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(ts){var pxtc;(function(pxtc){function getTsCompilerOptions(e){let t=ts.getDefaultCompilerOptions();return t.target=ts.ScriptTarget.ES5,t.module=ts.ModuleKind.None,t.noImplicitAny=!0,t.noImplicitReturns=!0,t.allowUnreachableCode=!0,t}function nodeLocationInfo(e){let t=ts.getSourceFileOfNode(e);const n=e.getStart?e.getStart():e.pos,{line:r,character:i}=ts.getLineAndCharacterOfPosition(t,n),{line:s,character:o}=ts.getLineAndCharacterOfPosition(t,e.end);return{start:n,length:e.end-n,line:r,column:i,endLine:s,endColumn:o,fileName:t.fileName}}function patchUpDiagnostics(e,t=!1){t&&(e=e.filter((e=>5012!==e.code)));let n=e.filter((e=>1148==e.code));return n.length>0&&(e=n),e.map((e=>{if(!e.file){return{code:e.code,start:e.start,length:e.length,line:0,column:0,messageText:ts.flattenDiagnosticMessageText(e.messageText,"\n"),category:e.category,fileName:"?"}}const t=ts.getLineAndCharacterOfPosition(e.file,e.start);let n={code:e.code,start:e.start,length:e.length,line:t.line,column:t.character,messageText:ts.flattenDiagnosticMessageText(e.messageText,"\n"),category:e.category,fileName:e.file.fileName};return 1148==n.code&&(n.messageText=pxtc.Util.lf("all symbols in top-level scope are always exported; please use a namespace if you want to export only some")),n}))}function py2tsIfNecessary(e){if(e.target.preferredEditor==pxt.PYTHON_PROJECT_NAME){return pxtc.transpile.pyToTs(e)}}function mkCompileResult(){return{outfiles:{},diagnostics:[],success:!1,times:{}}}function storeGeneratedFiles(e,t){for(let n of e.generatedFiles||[])t.outfiles[n]=e.fileSystem[n]}function runConversionsAndStoreResults(e,t){const n=pxtc.U.cpuUs();t||(t=mkCompileResult());const r=py2tsIfNecessary(e);r&&(t=Object.assign(Object.assign({},t),{diagnostics:r.diagnostics,sourceMap:r.sourceMap,globalNames:r.globalNames})),storeGeneratedFiles(e,t),e.sourceFiles||(e.sourceFiles=Object.keys(e.fileSystem));const i=e.sourceFiles.indexOf(pxt.MAIN_TS);i>=0&&(e.sourceFiles.splice(i,1),e.sourceFiles.push(pxt.MAIN_TS));const s=e.sourceFiles.indexOf(pxt.TUTORIAL_CODE_STOP);return s>=0&&(e.sourceFiles.splice(s,1),e.sourceFiles.push(pxt.TUTORIAL_CODE_STOP)),t.times.conversions=pxtc.U.cpuUs()-n,t}function timesToMs(e){for(let t of Object.keys(e.times))e.times[t]=Math.round(e.times[t])/1e3}function buildProgram(e,t){let n={};for(let t in e.fileSystem)n[normalizePath(t)]=e.fileSystem[t];let r=getTsCompilerOptions(e),i={getSourceFile:(e,t,r)=>{e=normalizePath(e);let i="";return n.hasOwnProperty(e)?i=n[e]:r&&r("File not found: "+e),null==i&&(r("File not found: "+e),i=""),ts.createSourceFile(e,i,t,true)},fileExists:e=>(e=normalizePath(e),n.hasOwnProperty(e)),getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"no-default-lib.d.ts",writeFile:(e,n,r,i)=>{t.outfiles[e]=n},getCurrentDirectory:()=>".",useCaseSensitiveFileNames:()=>!0,getNewLine:()=>"\n",readFile:e=>(e=normalizePath(e),n[e]||""),directoryExists:e=>!0,getDirectories:()=>[]},s=e.sourceFiles.filter((e=>pxtc.U.endsWith(e,".ts")));return ts.createProgram(s,r,i)}function isPxtModulesFilename(e){return pxtc.U.startsWith(e,"pxt_modules/")}function compile(opts,service){pxtc.compilerHooks||(pxtc.compilerHooks={},opts.target.compilerExtension&&eval(opts.target.compilerExtension)),pxtc.compilerHooks.init&&pxtc.compilerHooks.init(opts,service);let startTime=pxtc.U.cpuUs(),res=mkCompileResult(),program;if(service)storeGeneratedFiles(opts,res),program=service.getProgram();else{if(runConversionsAndStoreResults(opts,res),res.diagnostics.length>0)return res;program=buildProgram(opts,res)}const entryPoint=opts.sourceFiles.filter((e=>pxtc.U.endsWith(e,".ts"))).pop().replace(/.*\//,"");if(res.diagnostics=patchUpDiagnostics(program.getSyntacticDiagnostics(),opts.ignoreFileResolutionErrors),res.diagnostics.length>0)return opts.forceEmit&&(pxt.debug("syntactic errors, forcing emit"),pxtc.compileBinary(program,opts,res,entryPoint)),res;res.diagnostics=patchUpDiagnostics(program.getOptionsDiagnostics().concat(pxtc.Util.toArray(program.getGlobalDiagnostics())),opts.ignoreFileResolutionErrors);const semStart=pxtc.U.cpuUs();0==res.diagnostics.length&&(res.diagnostics=patchUpDiagnostics(program.getSemanticDiagnostics(),opts.ignoreFileResolutionErrors));const emitStart=pxtc.U.cpuUs();if(res.times["typescript-syn"]=semStart-startTime,res.times["typescript-sem"]=emitStart-semStart,res.times.typescript=emitStart-startTime,opts.ast&&(res.ast=program),opts.ast||opts.forceEmit||0==res.diagnostics.length){const e=pxtc.compileBinary(program,opts,res,entryPoint);res.times.compilebinary=pxtc.U.cpuUs()-emitStart,res.diagnostics=res.diagnostics.concat(patchUpDiagnostics(e.diagnostics))}0==res.diagnostics.length&&(res.success=!0);for(let e of opts.sourceFiles)pxtc.Util.startsWith(e,"built/")&&(res.outfiles[e.slice(6)]=opts.fileSystem[e]);return res.times.all=pxtc.U.cpuUs()-startTime,pxt.tickEvent("compile",res.times),res}function decompile(e,t,n,r=!1){let i=e.getSourceFile(n);pxtc.annotate(e,n,pxtc.target||pxt.appTarget&&pxt.appTarget.compile);const s=pxtc.getApiInfo(e,t.jres),o=pxtc.getBlocksInfo(s,t.bannedCategories),a={snippetMode:t.snippetMode||!1,alwaysEmitOnStart:t.alwaysDecompileOnStart,includeGreyBlockMessages:r,generateSourceMap:void 0!==t.generateSourceMap?t.generateSourceMap:!!t.ast,allowedArgumentTypes:t.allowedArgumentTypes||["number","boolean","string"],errorOnGreyBlocks:!!t.errorOnGreyBlocks},[l,c]=pxtc.decompiler.buildRenameMap(e,i,{declarations:"variables",takenNames:{}});return pxtc.decompiler.decompileToBlocks(o,i,a,l)}function decompileSnippets(e,t,n=!1){const r=pxtc.getApiInfo(e,t.jres),i=pxtc.getBlocksInfo(r,t.bannedCategories),s=new pxtc.decompiler.RenameMap([]),o={snippetMode:t.snippetMode||!1,alwaysEmitOnStart:t.alwaysDecompileOnStart,includeGreyBlockMessages:n,generateSourceMap:void 0!==t.generateSourceMap?t.generateSourceMap:!!t.ast,allowedArgumentTypes:t.allowedArgumentTypes||["number","boolean","string"],errorOnGreyBlocks:!!t.errorOnGreyBlocks};let a;const l=[];if(t.sourceTexts)for(let e=0;e<t.sourceTexts.length;e++){t.fileSystem[pxt.MAIN_TS]=t.sourceTexts[e],t.fileSystem[pxt.MAIN_BLOCKS]="";let n=getTSProgram(t,a);const r=n.getSourceFile(pxt.MAIN_TS),c=pxtc.decompiler.decompileToBlocks(i,r,o,s);l.push(c.outfiles[pxt.MAIN_BLOCKS]),a=n}return l}function getTSProgram(e,t){let n={},r={};for(let t in e.fileSystem)r[normalizePath(t)]=e.fileSystem[t];let i=getTsCompilerOptions(e),s={getSourceFile:(e,t,n)=>{e=normalizePath(e);let i="";return r.hasOwnProperty(e)?i=r[e]:n&&n("File not found: "+e),null==i&&(n("File not found: "+e),i=""),ts.createSourceFile(e,i,t,true)},fileExists:e=>(e=normalizePath(e),r.hasOwnProperty(e)),getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"no-default-lib.d.ts",writeFile:(e,t,r,i)=>{n[e]=t},getCurrentDirectory:()=>".",useCaseSensitiveFileNames:()=>!0,getNewLine:()=>"\n",readFile:e=>(e=normalizePath(e),r[e]||""),directoryExists:e=>!0,getDirectories:()=>[]};e.sourceFiles||(e.sourceFiles=Object.keys(e.fileSystem));let o=e.sourceFiles.filter((e=>pxtc.U.endsWith(e,".ts"))),a=o.filter((e=>e!=pxt.MAIN_TS)),l=!1;o.length>a.length&&(o=a,o.push(pxt.MAIN_TS),l=!0);const c=o.indexOf(pxt.TUTORIAL_CODE_STOP);c>=0&&(o.splice(c,1),o.push(pxt.TUTORIAL_CODE_STOP));const u=ts.createProgram(o,i,s,t);return pxtc.annotate(u,pxt.MAIN_TS,pxtc.target||pxt.appTarget&&pxt.appTarget.compile),u}function normalizePath(e){e=e.replace(/\\/g,"/");const t=[];return e.split("/").forEach((e=>{".."===e&&t.length?t.pop():"."!==e&&t.push(e)})),t.join("/")}pxtc.getTsCompilerOptions=getTsCompilerOptions,pxtc.nodeLocationInfo=nodeLocationInfo,pxtc.patchUpDiagnostics=patchUpDiagnostics,pxtc.py2tsIfNecessary=py2tsIfNecessary,pxtc.storeGeneratedFiles=storeGeneratedFiles,pxtc.runConversionsAndStoreResults=runConversionsAndStoreResults,pxtc.timesToMs=timesToMs,pxtc.isPxtModulesFilename=isPxtModulesFilename,pxtc.compile=compile,pxtc.decompile=decompile,pxtc.decompileSnippets=decompileSnippets,pxtc.getTSProgram=getTSProgram})(pxtc=ts.pxtc||(ts.pxtc={}))}(ts||(ts={})),function(e){!function(t){const n=["type","offset","vaddr","paddr","filesz","memsz","flags","align"],r=e.HF2.read32,i=e.HF2.read16,s=4096;t.parse=function(t){1179403647!=r(t,0)&&e.U.userError("no magic"),1!=t[4]&&e.U.userError("not 32 bit"),1!=t[5]&&e.U.userError("not little endian"),1!=t[6]&&e.U.userError("bad version"),2!=i(t,16)&&e.U.userError("wrong object type"),40!=i(t,18)&&e.U.userError("not ARM");let o=r(t,28);r(t,32),0==o&&e.U.userError("expecting program headers");let a=i(t,42),l=i(t,44),c=e.U.range(l).map((e=>function(e){let i={},s=e;for(let s of n)i[s]=r(t,e),e+=4;let o=i;return o._filepos=s,o}(o+e*a))),u=t.length+1;for(;15&u;)u++;let d=0;for(let e of c)1==e.type&&(d=Math.max(d,e.vaddr+e.memsz));let p=(d+s-1&-4096)+(4095&u),h=-1;for(let e of c)4==e.type&&(h=e._filepos);return{imageMemStart:p,imageFileStart:u,phOffset:h,template:t}},t.patch=function(t,r){let i=new Uint8Array(t.imageFileStart+r.length);return i.fill(0),e.U.memcpy(i,0,t.template),e.U.memcpy(i,t.imageFileStart,r),function(t,r){let i=r._filepos;for(let s of n)e.HF2.write32(t,i,r[s]||0),i+=4}(i,{_filepos:t.phOffset,type:1,offset:t.imageFileStart,vaddr:t.imageMemStart,paddr:t.imageMemStart,filesz:r.length,memsz:r.length,flags:5,align:s}),i}}(e.elf||(e.elf={}))}(pxt||(pxt={})),function(e){!function(t){const n=e.HF2.read32,r=e.HF2.read16,i=[{name:"esp32",chipId:0,memmap:[{from:0,to:65536,id:"PADDING"},{from:1061158912,to:1065353216,id:"DROM"},{from:1065353216,to:1069547520,id:"EXTRAM_DATA"},{from:1073217536,to:1073225728,id:"RTC_DRAM"},{from:1073283072,to:1073741824,id:"BYTE_ACCESSIBLE"},{from:1073405952,to:1073741824,id:"DRAM"},{from:1073610752,to:1073741820,id:"DIRAM_DRAM"},{from:1073741824,to:1074200576,id:"IROM"},{from:1074200576,to:1074233344,id:"CACHE_PRO"},{from:1074233344,to:1074266112,id:"CACHE_APP"},{from:1074266112,to:1074397184,id:"IRAM"},{from:1074397184,to:1074528252,id:"DIRAM_IRAM"},{from:1074528256,to:1074536448,id:"RTC_IRAM"},{from:1074593792,to:1077936128,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-s2",chipId:2,memmap:[{from:0,to:65536,id:"PADDING"},{from:1056964608,to:1073217536,id:"DROM"},{from:1062207488,to:1073217536,id:"EXTRAM_DATA"},{from:1073340416,to:1073348608,id:"RTC_DRAM"},{from:1073340416,to:1073741824,id:"BYTE_ACCESSIBLE"},{from:1073340416,to:1074208768,id:"MEM_INTERNAL"},{from:1073414144,to:1073741824,id:"DRAM"},{from:1073741824,to:1073848576,id:"IROM_MASK"},{from:1073872896,to:1074200576,id:"IRAM"},{from:1074200576,to:1074208768,id:"RTC_IRAM"},{from:1074266112,to:1082130432,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-s3",chipId:4,memmap:[{from:0,to:65536,id:"PADDING"},{from:1006632960,to:1023410176,id:"DROM"},{from:1023410176,to:1040187392,id:"EXTRAM_DATA"},{from:1611653120,to:1611661312,id:"RTC_DRAM"},{from:1070104576,to:1070596096,id:"BYTE_ACCESSIBLE"},{from:1070104576,to:1077813248,id:"MEM_INTERNAL"},{from:1070104576,to:1070596096,id:"DRAM"},{from:1073741824,to:1073848576,id:"IROM_MASK"},{from:1077346304,to:1077805056,id:"IRAM"},{from:1611653120,to:1611661312,id:"RTC_IRAM"},{from:1107296256,to:1115684864,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-c3",chipId:5,memmap:[{from:0,to:65536,id:"PADDING"},{from:1006632960,to:1015021568,id:"DROM"},{from:1070071808,to:1070465024,id:"DRAM"},{from:1070104576,to:1070596096,id:"BYTE_ACCESSIBLE"},{from:1072693248,to:1072824320,id:"DROM_MASK"},{from:1073741824,to:1074135040,id:"IROM_MASK"},{from:1107296256,to:1115684864,id:"IROM"},{from:1077395456,to:1077805056,id:"IRAM"},{from:1342177280,to:1342185472,id:"RTC_IRAM"},{from:1342177280,to:1342185472,id:"RTC_DRAM"},{from:1611653120,to:1611661312,id:"MEM_INTERNAL2"}]}];function s(t){return`0x${t.addr.toString(16)} 0x${t.data.length.toString(16)} bytes; ${t.isDROM?"drom ":""}${t.isMapped?"mapped ":""}${e.U.toHex(t.data.slice(0,20))}...`}function o(t){if(233!=t[0])throw new Error("ESP: invalid magic: "+t[0]);let s=24;const o=r(t,12),a=i.find((e=>e.chipId==o));if(!a)throw new Error("ESP: unknown chipid: "+o);const l={header:t.slice(0,s),chipName:a.name,segments:[]},c=t[1];for(let r=0;r<c;++r){const r=n(t,s),i=n(t,s+4);s+=8;const o=t.slice(s,s+i);if(o.length!=i)throw new Error("too short file");if(s+=i,u(r,"PADDING"))continue;const a=l.segments.filter((e=>e.addr+e.data.length==r))[0];a?a.data=e.U.uint8ArrayConcat([a.data,o]):l.segments.push({addr:r,isMapped:u(r,"DROM")||u(r,"IROM"),isDROM:u(r,"DROM"),data:o})}return l;function u(e,t){return a.memmap.some((n=>n.id==t&&n.from<=e&&e<=n.to))}}function a(t){const n=e.U.flatClone(t);return n.segments=n.segments.map(e.U.flatClone),n}t.toBuffer=function(t,n=!0){let r=(t=function(t){const n=65535;(t=a(t)).segments.sort(((e,t)=>e.addr-t.addr)),e.debug("esp padding:\n"+t.segments.map(s).join("\n")+"\n");const r=t.segments.filter((e=>e.isMapped)),i=t.segments.filter((e=>!e.isMapped));t.segments=[];let o=t.header.length;for(const t of r){const r=t.addr+t.data.length&n;if(r<36){const n=new Uint8Array(36-r);t.data=e.U.uint8ArrayConcat([t.data,n])}}for(;r.length>0;){let e=r[0];const i=l(e);if(i>0)e=c(i);else{if((o+8&n)!=(e.addr&n))throw new Error(`pad oops 0 ${o}+8 != ${e.addr} (mod mask)`);r.shift()}if(t.segments.push(e),o+=8+e.data.length,3&o)throw new Error("pad oops 1")}return t.segments=t.segments.concat(i),e.debug("esp padded:\n"+t.segments.map(s).join("\n")+"\n"),t;function l(e){let t=(e.addr-8&n)-o&n;return 0==t?0:(t-=8,t<0&&(t+=65536),t)}function c(e){if(!i.length||e<=8)return{addr:0,isMapped:!1,isDROM:!1,data:new Uint8Array(e)};const t=i[0],n={addr:t.addr,isMapped:t.isMapped,isDROM:t.isDROM,data:t.data.slice(0,e)};return t.data=t.data.slice(e),t.addr+=n.data.length,0==t.data.length&&i.shift(),n}}(t)).header.length;for(const e of t.segments)r+=8+e.data.length;r=r+16&-16;let i=new Uint8Array(r);i.set(t.header),i[1]=t.segments.length;let o=t.header.length,l=239;for(const n of t.segments){e.HF2.write32(i,o,n.addr),e.HF2.write32(i,o+4,n.data.length),i.set(n.data,o+8),o+=8+n.data.length;for(let e=0;e<n.data.length;++e)l^=n.data[e]}if(i[i.length-1]=l,n){i[23]=1;const t=ts.pxtc.BrowserImpl.sha256buffer(i);i=e.U.uint8ArrayConcat([i,e.U.fromHex(t)])}else i[23]=0;return i},t.parseBuffer=o,t.parseB64=function(t){return o(e.U.stringToUint8Array(atob(t.join(""))))},t.cloneStruct=a}(e.esp||(e.esp={}))}(pxt||(pxt={})),function(e){!function(t){let n;!function(e){e[e.None=0]="None",e[e.Whitespace=1]="Whitespace",e[e.Identifier=2]="Identifier",e[e.Keyword=3]="Keyword",e[e.Operator=4]="Operator",e[e.CommentLine=5]="CommentLine",e[e.CommentBlock=6]="CommentBlock",e[e.NewLine=7]="NewLine",e[e.Literal=8]="Literal",e[e.Tree=9]="Tree",e[e.Block=10]="Block",e[e.EOF=11]="EOF"}(n||(n={}));let r="";let i=e.SyntaxKind;function s(e){switch(e){case i.CommaToken:return 2;case i.EqualsToken:case i.PlusEqualsToken:case i.MinusEqualsToken:case i.AsteriskEqualsToken:case i.AsteriskAsteriskEqualsToken:case i.SlashEqualsToken:case i.PercentEqualsToken:case i.LessThanLessThanEqualsToken:case i.GreaterThanGreaterThanEqualsToken:case i.GreaterThanGreaterThanGreaterThanEqualsToken:case i.AmpersandEqualsToken:case i.BarEqualsToken:case i.CaretEqualsToken:return 5;case i.QuestionToken:case i.ColonToken:return 7;case i.BarBarToken:return 10;case i.AmpersandAmpersandToken:return 20;case i.BarToken:return 30;case i.CaretToken:return 40;case i.AmpersandToken:return 50;case i.EqualsEqualsToken:case i.ExclamationEqualsToken:case i.EqualsEqualsEqualsToken:case i.ExclamationEqualsEqualsToken:return 60;case i.LessThanToken:case i.GreaterThanToken:case i.LessThanEqualsToken:case i.GreaterThanEqualsToken:case i.InstanceOfKeyword:case i.InKeyword:case i.AsKeyword:return 70;case i.LessThanLessThanToken:case i.GreaterThanGreaterThanToken:case i.GreaterThanGreaterThanGreaterThanToken:return 80;case i.PlusToken:case i.MinusToken:return 90;case i.AsteriskToken:case i.SlashToken:case i.PercentToken:return 100;case i.AsteriskAsteriskToken:return 101;case i.DotToken:return 120;default:return 0}}function o(e){switch(e){case i.EndOfFileToken:return n.EOF;case i.SingleLineCommentTrivia:return n.CommentLine;case i.MultiLineCommentTrivia:return n.CommentBlock;case i.NewLineTrivia:return n.NewLine;case i.WhitespaceTrivia:return n.Whitespace;case i.ShebangTrivia:case i.ConflictMarkerTrivia:return n.CommentBlock;case i.NumericLiteral:case i.StringLiteral:case i.RegularExpressionLiteral:case i.NoSubstitutionTemplateLiteral:case i.TemplateHead:case i.TemplateMiddle:case i.TemplateTail:return n.Literal;case i.Identifier:return n.Identifier;default:return e<i.Identifier?n.Operator:n.Keyword}}function a(e,t){for(;e[t]&&e[t].kind==n.Whitespace;)t++;return t}function l(){return{kind:n.EOF,synKind:i.EndOfFileToken,pos:0,lineNo:0,text:""}}function c(e,t){return{kind:n.Whitespace,synKind:i.WhitespaceTrivia,pos:e.pos-t.length,lineNo:e.lineNo,text:t}}function u(e){return{kind:n.Block,synKind:i.OpenBraceToken,pos:e[0].pos,lineNo:e[0].lineNo,stmts:[{tokens:e}],text:"{",endToken:null}}function d(e){if(!e)return!1;switch(e.synKind){case i.IfKeyword:case i.ElseKeyword:case i.LetKeyword:case i.ConstKeyword:case i.VarKeyword:case i.DoKeyword:case i.WhileKeyword:case i.SwitchKeyword:case i.CaseKeyword:case i.DefaultKeyword:case i.ForKeyword:case i.ReturnKeyword:case i.BreakKeyword:case i.ContinueKeyword:case i.TryKeyword:case i.CatchKeyword:case i.FinallyKeyword:case i.DeleteKeyword:case i.FunctionKeyword:case i.ClassKeyword:case i.YieldKeyword:case i.DebuggerKeyword:return!0;default:return!1}}function p(e,r,o=null){let a,h=[],f=0,_=!1;for(e=e.concat([l()]);e[f].kind!=n.EOF;){let n=f;S(),t.Util.assert(f>n,`Error at ${e[f].text}`),g(e.slice(n,f))}return h;function g(e){if(r&&(e=m(e)),0==e.length)return;e.forEach(b),e=y(e);if(r&&h.length>0){let n=h[h.length-1].tokens[0].synKind,r=e[0].synKind;if(n==i.IfKeyword&&r==i.ElseKeyword||n==i.TryKeyword&&r==i.CatchKeyword||n==i.TryKeyword&&r==i.FinallyKeyword||n==i.CatchKeyword&&r==i.FinallyKeyword)return e.unshift(c(e[0]," ")),void t.Util.pushRange(h[h.length-1].tokens,e)}h.push({tokens:e})}function y(e){let t=[],r=0;for(;r<e.length;)if(e[r].blockSpanLength){let o=e.slice(r,r+e[r].blockSpanLength),a=!!o[0].blockSpanIsVirtual;delete o[0].blockSpanLength,delete o[0].blockSpanIsVirtual,r+=o.length,o=y(o),a?t.push((s=o,{kind:n.Tree,synKind:i.WhitespaceTrivia,pos:s[0].pos,lineNo:s[0].lineNo,children:s,endToken:null,text:""})):(t.push(c(o[0]," ")),t.push(u(m(o))))}else t.push(e[r++]);var s;return t}function b(e){if(e.kind==n.Tree){let n=e;n.children=t.Util.concat(p(n.children,!1,n).map((e=>e.tokens)))}}function v(t=!1){for(;;)switch(f++,e[f].kind){case n.Whitespace:case n.CommentBlock:case n.CommentLine:break;case n.NewLine:if(t)break;break;default:return}}function T(){for(;e[f].kind==n.Whitespace;)f++;e[f].kind==n.NewLine&&f++}function k(){for(;;)switch(f++,e[f].kind){case n.EOF:return;case n.Tree:if(e[f].synKind==i.OpenBraceToken)return f--,void x()}}function E(){t.Util.assert(e[f].synKind==i.OpenBraceToken);let r=e[f];t.Util.assert(r.kind==n.Tree);let s=e[f];s.stmts=p(r.children,!0,a),delete r.children,s.kind=n.Block,f++,_=!0}function x(){let t=f+1;v(),e[f].synKind==i.OpenBraceToken?(E(),T()):(S(),e[t].blockSpanLength=f-t)}function S(){for(;;){let l=e[f],c=f;if(a=l,_=!1,l.kind==n.EOF)return;if(r&&l.synKind==i.SemicolonToken)return f++,void T();if(l.synKind==i.EqualsGreaterThanToken){if(v(),e[f].synKind==i.OpenBraceToken){E();continue}{let t=f;S();let r=f;for(;e[r].kind==n.NewLine;)r--;return e[t].blockSpanLength=r-t,void(e[t].blockSpanIsVirtual=!0)}}if(r&&s(l.synKind)){let t=f;if(v(),!d(e[f]))continue;f=t}if(r&&l.kind==n.NewLine){if(v(),l=e[f],s(l.synKind)&&l.synKind!=i.PlusToken&&l.synKind!=i.MinusToken)continue;return void(f=c+1)}if(l.synKind==i.OpenBraceToken&&o&&o.synKind==i.ClassKeyword){let t=f-1;for(;t>=0&&e[t].kind==n.Whitespace;)t--;if(t<0||e[t].synKind!=i.EqualsToken)return f--,void x()}switch(t.Util.assert(c==f),l.synKind){case i.ForKeyword:case i.WhileKeyword:case i.IfKeyword:case i.CatchKeyword:if(v(),e[f].synKind!=i.OpenParenToken)continue;return void x();case i.DoKeyword:if(x(),f--,v(),e[f].synKind==i.WhileKeyword){f++;continue}return;case i.ElseKeyword:if(v(),e[f].synKind==i.IfKeyword)continue;return f=c,void x();case i.TryKeyword:case i.FinallyKeyword:return void x();case i.ClassKeyword:case i.NamespaceKeyword:case i.ModuleKeyword:case i.InterfaceKeyword:case i.FunctionKeyword:return void k()}t.Util.assert(!_,"forgot continue/return after expectBlock"),f++}}}function h(e){return e&&(e.kind==n.Whitespace||e.kind==n.NewLine)}function f(e){let t=[],r=!1;for(let i=0;i<e.length;++i)r&&(i=a(e,i)),e[i]&&(t.push(e[i]),r=e[i].kind==n.NewLine);return t}function m(e){for(e=e.slice(0);h(e[0]);)e.shift();for(;h(e[e.length-1]);)e.pop();return e}function _(e,t){if(t.synKind==i.NoSubstitutionTemplateLiteral&&/^`[\s\.#01]*`$/.test(t.text)){let n=t.text.slice(1,t.text.length-1).split("\n").map((e=>e.replace(/\s/g,""))).filter((e=>!!e));if(n.length<4||n.length>5)return;let r=Math.floor((Math.max(...n.map((e=>e.length)))+2)/5);r<=0&&(r=1);let i="`\n";for(let t=0;t<5;++t){let s=n[t]||"";for(;s.length<5*r;)s+=".";s=s.replace(/0/g,"."),s=s.replace(/1/g,"#"),s=s.replace(/...../g,(e=>"/"+e)),i+=e+s.replace(/./g,(e=>" "+e)).replace(/\//g," ").slice(3)+"\n"}i+=e+"`",t.text=i}}t.toStr=function e(t){return Array.isArray(t)?"[[ "+t.map(e).join("  ")+" ]]":"string"==typeof t.text?JSON.stringify(t.text):t+""},t.format=function(t,u){let d=function(t){r=t;let s=e.createScanner(e.ScriptTarget.Latest,!1,e.LanguageVariant.Standard,t,(e=>{let t=s.getTextPos();console.log("scanner error",t,e.message)})),a=[],l=0,c=-1;for(;;){let e=s.scan();if(e==i.CloseBraceToken&&l==c&&(c=-1,e=s.reScanTemplateToken()),e==i.SlashEqualsToken){let t=s.reScanSlashToken();t==i.RegularExpressionLiteral&&(e=t)}e==i.GreaterThanToken&&(e=s.reScanGreaterToken());let t={kind:o(e),synKind:e,lineNo:0,pos:s.getTokenPos(),text:s.getTokenText()};if(e==i.OpenBraceToken&&l++,e==i.CloseBraceToken&&--l<0&&(l=-1e7),a.push(t),e!=i.TemplateHead&&e!=i.TemplateMiddle||(c=l),t.kind==n.EOF)break}return{tokens:a,braceBalance:l}}(t).tokens;d=function(e,t){let r=[],s=!0,o=1;for(let l=0;l<e.length;++l){if(s){let s=l;if(l=a(e,l),e[l].kind==n.NewLine){let s=!1;t>=0&&e[l].pos>=t&&(t=-1,s=!0),r.push({text:"",kind:n.CommentLine,pos:e[l].pos,lineNo:o,synKind:i.SingleLineCommentTrivia,isCursor:s})}else l=s}r.push(e[l]),e[l].lineNo=o,e[l].kind==n.NewLine?(s=!0,o++):s=!1,t>=0&&e[l].pos>=t&&(t=-1)}return r}(d,u),d=function(e){let t=[];t.push({synKind:i.EndOfFileToken,token:{children:[]}});let r=(e,r)=>{let i=e;i.children=[],i.kind=n.Tree,t.push({synKind:r,token:i})};for(let s=0;s<e.length;++s){let o=e[s],a=t[t.length-1];switch(a.token.children.push(o),o.kind){case n.Operator:switch(o.synKind){case i.OpenBraceToken:case i.OpenParenToken:case i.OpenBracketToken:r(o,o.synKind+1);break;case i.CloseBraceToken:case i.CloseParenToken:case i.CloseBracketToken:for(a.token.children.pop();;){if(a=t.pop(),a.synKind==o.synKind){a.token.endToken=o;break}if(0==t.length||a.synKind==i.CloseBraceToken){t.push(a);break}}}}}return t[0].token.children}(d);let h=p(d,!0),m="",g="",y=-1,b=0;return h.forEach(k),h.forEach((e=>e.tokens.forEach(v))),-1==y&&(y=g.length),{formatted:g,pos:y};function v(e){if(e.kind==n.Tree){let t=e;e.synKind,i.OpenBraceToken,t.children.forEach(v)}else e.kind==n.Block&&e.stmts.forEach((e=>e.tokens.forEach(v)))}function T(e,t){if(b==e.lineNo)t();else{b=e.lineNo;let n=m;m+="    ",t(),m=n}}function k(e){let t=f(e.tokens);1!=t.length||t[0].isCursor||""!=t[0].text?(g+=m,T(t[0],(()=>{x(t)})),"\n"!=g[g.length-1]&&(g+="\n")):g+="\n"}function E(e){-1==y&&e.pos+e.text.length>=u&&(y=g.length+(u-e.pos)),g+=e.text}function x(e){e=function(e){let t=[],r=0,o=l();for(e=e.concat([l()]);r<e.length;){r=a(e,r);let l=e[r];if(l.kind==n.EOF)break;let d=a(e,r+1);if(l.kind==n.NewLine&&e[d].synKind==i.OpenBraceToken){r=d;continue}let p=!0,h=0==t.length?(u=l,{kind:n.NewLine,synKind:i.NewLineTrivia,pos:u.pos,lineNo:u.lineNo,text:"\n"}):t[t.length-1];switch(h.synKind){case i.ExclamationToken:case i.TildeToken:case i.DotToken:p=!1;break;case i.PlusToken:case i.MinusToken:case i.PlusPlusToken:case i.MinusMinusToken:h.isPrefix&&(p=!1)}switch(l.synKind){case i.DotToken:case i.CommaToken:case i.NewLineTrivia:case i.ColonToken:case i.SemicolonToken:case i.OpenBracketToken:p=!1;break;case i.PlusPlusToken:case i.MinusMinusToken:h.kind!=n.Tree&&h.kind!=n.Identifier&&h.kind!=n.Keyword||(p=!1);case i.PlusToken:case i.MinusToken:(o.kind==n.EOF||s(o.synKind)||o.synKind==i.SemicolonToken)&&(l.isPrefix=!0);break;case i.OpenParenToken:if(h.kind==n.Identifier&&(p=!1),h.kind==n.Keyword)switch(h.synKind){case i.IfKeyword:case i.ForKeyword:case i.WhileKeyword:case i.SwitchKeyword:case i.ReturnKeyword:case i.ThrowKeyword:case i.CatchKeyword:break;default:p=!1}}h.kind==n.NewLine&&(p=!1),p&&t.push(c(l," ")),t.push(l),l.kind!=n.NewLine&&(o=l),r++}var u;return t}(e);for(let t=0;t<e.length;++t){let r=e[t];switch(_(m,r),E(r),r.kind){case n.Tree:let i=r;T(r,(()=>{x(f(i.children))})),i.endToken&&E(i.endToken);break;case n.Block:let s=r;0==s.stmts.length?g+=" ":(g+="\n",s.stmts.forEach(k),g+=m.slice(4)),s.endToken?E(s.endToken):g+="}";break;case n.NewLine:if(e[t+1]&&e[t+1].kind==n.CommentLine&&""==e[t+1].text&&!e[t+1].isCursor)break;t==e.length-1?g+=m.slice(4):g+=m;break;case n.Whitespace:}}}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n;function r(e,n){if(!n.packedSource)return;let r=e.currPtr+4096&-256,i=new Uint8Array(256);for(let s=0;s<n.packedSource.length;s+=256){for(let e=0;e<256;++e)i[e]=n.packedSource.charCodeAt(s+e);t.UF2.writeBytes(e,r,i,t.UF2.UF2_FLAG_NOFLASH),r+=256}}!function(e){e.asmTotalSource="";let n={},i=[];let s={commBase:0,funcInfo:{},codeStartIdx:-1,codePaddingSize:0,sha:null,codeStartAddrPadded:void 0,hexlines:void 0,jmpStartAddr:void 0,jmpStartIdx:void 0,codeStartAddr:void 0,elfInfo:void 0,espInfo:void 0};function o(e){let n="",r=0;for(;r<e.length;r+=2)n=e[r]+e[r+1]+n;return t.assert(r==e.length),n}function a(e){if(!(e=e.replace(/^[\s:]/,"")))return[];let n=[];if(e.replace(/([a-f0-9][a-f0-9])/gi,(e=>(n.push(parseInt(e,16)),""))))throw t.oops("bad bytes "+e);return n}function l(e){return e.flashCodeAlign||1024}e.getCommBase=function(){return s.commBase},e.getStartAddress=function(){return s.codeStartAddrPadded},e.setupInlineAssembly=function(r){n={};let i=r.sourceFiles.filter((e=>t.U.endsWith(e,".asm")));e.asmTotalSource="";let s=0;for(let t of i){let i=r.fileSystem[t];i.replace(/^\s*(\w+):/gm,((e,t)=>(n[t]=!0,"")));let o=".object inlineasm\n.section code\n@stackmark func\n@scope user"+s+++"\n"+i+"\n@stackempty func\n@scope\n";e.asmTotalSource+=o}},e.parseHexBytes=a,e.parseHexRecord=function(e){let t=a(e);return{len:t[0],addr:t[1]<<8|t[2],type:t[3],data:t.slice(4,t.length-1),checksum:t[t.length-1]}},e.flashCodeAlign=l;const c="0108010842424242010801083ed8e98d";function u(e){return s.funcInfo[e]}function d(){let e=s.sha?s.sha.slice(0,16):"";for(;e.length<16;)e+="0";return e.toUpperCase()}function p(e){let t=0,n=":";return e.forEach((e=>t+=e)),e.push(255&-t),e.forEach((e=>n+=("0"+e.toString(16)).slice(-2))),n.toUpperCase()}e.setupFor=function(e,n){if(s=i.find((e=>e.sha==n.sha)),s)return;s={commBase:0,funcInfo:{},codeStartIdx:-1,codePaddingSize:0,sha:null,codeStartAddrPadded:void 0,hexlines:void 0,jmpStartAddr:void 0,jmpStartIdx:void 0,codeStartAddr:void 0,elfInfo:void 0,espInfo:void 0},i.length>10&&(i=[]),i.push(s);let r=n.functions;s.commBase=n.commBase||0,s.sha=n.sha;const u=n.hexinfo.hex;if(s.hexlines=u,t.target.nativeType==t.NATIVE_TYPE_VM){s.codeStartAddr=0,s.codeStartAddrPadded=0,s.jmpStartAddr=-1,s.jmpStartIdx=-1;for(let e of r)s.funcInfo[e.name]=e,e.value=16777215;if(t.target.useESP){const e=pxt.esp.parseB64(u),r=t.U.fromHex(c),i=(e,t)=>{for(let n=0;n<r.length;++n)if(e[t+n]!=r[n])return!1;return!0},o=e.segments.filter((e=>e.isDROM));t.U.assert(1==o.length);let a=!1;const l=o[0];s.codeStartAddr=l.addr+l.data.length,s.codeStartAddrPadded=s.codeStartAddr+255&-256,s.codePaddingSize=s.codeStartAddrPadded-s.codeStartAddr,pxt.debug(`user code start: 0x${s.codeStartAddrPadded.toString(16)}; dromlen=${l.data.length} pad=${s.codePaddingSize}`);for(let e=0;e<l.data.length;e+=32)if(i(l.data,e)){a=!0,e+=r.length;const t=e;for(let t of n.vmPointers||[])"0"!=t&&(t=t.replace(/^&/,""),s.funcInfo[t]={name:t,argsFmt:[],value:pxt.HF2.read32(l.data,e)},e+=4);pxt.HF2.write32(l.data,t,s.codeStartAddrPadded);break}t.U.assert(a||0==(n.vmPointers||[]).length),s.espInfo=e,s.codeStartAddrPadded=0}return}if(u.length<=2){const e=t.U.fromHex(u[0]);if(e[2]<=2&&96==e[3]){const t=1610612736,n=4096,r=e.length+n-1&~(n-1);s.elfInfo={template:e,imageMemStart:t+r,imageFileStart:r,phOffset:-1e3}}else s.elfInfo=pxt.elf.parse(e);s.codeStartAddr=s.elfInfo.imageMemStart,s.codeStartAddrPadded=s.elfInfo.imageMemStart;let n=u[0].indexOf(c);return n<0&&t.oops("no jmp table in elf"),s.jmpStartAddr=n/2,s.jmpStartIdx=-1,g(u[0].slice(n+32,n+32+8*r.length+16)),void y()}!function(e){for(let n=0;n<e.length;++n)if("2"==e[n][8]){let r=/^:02....02(....)..$/.exec(e[n]);t.U.assert(!!r);let i=16*parseInt(r[1],16);t.U.assert(0==(65535&i)),e[n]=p([2,0,0,4,0,i>>16])}}(u);let d=0,h="0000",f=0,m=0;s.codeStartAddr=0;let _=()=>{if(!s.codeStartAddr){let n=a(u[m]),r=16-(f+n[0]&15)&15;if(r)if(15&n[2]){let e=f+n[0],t=[r,e>>8,255&e,0];for(let e=0;e<r;++e)t.push(0);m++,u.splice(m,0,p(t)),s.codeStartAddr=e+r}else{if(16!=n[0]){for(n.pop(),n[0]=16;n.length<20;)n.push(0);u[m]=p(n)}s.codeStartAddr=f+16}else s.codeStartAddr=f+n[0];s.codeStartIdx=m+1;const i=l(e);s.codeStartAddrPadded=(s.codeStartAddr&~(i-1))+i;const o=s.codeStartAddrPadded-s.codeStartAddr;t.assert(0==(15&o)),s.codePaddingSize=o}};for(;d<u.length;++d){let t=/:02000004(....)/.exec(u[d]);if(t&&(h=t[1]),t=/^:..(....)00/.exec(u[d]),t){let n=parseInt(h+t[1],16);!e.flashUsableEnd&&f&&n-f>65536&&_(),e.flashUsableEnd&&n>=e.flashUsableEnd&&_(),m=d,f=n}/^:00000001/.test(u[d])&&_(),t=/^:10....000108010842424242010801083ED8E98D/.exec(u[d]),t&&(s.jmpStartAddr=f,s.jmpStartIdx=d)}pxt.debug(`code start: ${s.codeStartAddrPadded}, jmptbl: ${s.jmpStartAddr}`),s.jmpStartAddr||t.oops("No hex start"),s.codeStartAddr||t.oops("No hex end"),s.funcInfo={};for(let e=s.jmpStartIdx+1;e<u.length;++e){let t=/^:..(....)00(.{4,})/.exec(u[e]);if(t&&(g(t[2]),0==r.length))break}return void y();function g(n){let i=e.shortPointers?4:8;for(;n.length>=i;){let a=n.slice(0,i),l=parseInt(o(a),16);n=n.slice(i);let c=r.shift();if(!c)break;s.funcInfo[c.name]=c,l||t.U.oops("No value for "+c.name+" / "+a),0==c.argsFmt.length?l^=1:e.runtimeIsARM||e.nativeType!=t.NATIVE_TYPE_THUMB||1&l||t.U.oops("Non-thumb addr for "+c.name+" / "+a),c.value=l}}function y(){r.length&&t.oops("premature EOF in hex file; missing: "+r.map((e=>e.name)).join(", "))}},e.validateShim=function(e,r,i,s,o){if("TD_ID"==r||"TD_NOOP"==r||"ENUM_GET"==r)return;if(t.U.lookup(n,r))return;let a=`${e}(...) (shim=${r})`,l=u(r);if(l){s?"V"==l.argsFmt[0]&&t.U.userError("expecting function for "+a):"V"!=l.argsFmt[0]&&t.U.userError("expecting procedure for "+a);for(let e=0;e<o.length;++e){l.argsFmt[e+1]||t.U.userError("excessive parameters passed to "+a)}o.length!=l.argsFmt.length-1&&t.U.userError(`not enough arguments for ${a} (got ${o.length}; fmt=${l.argsFmt.join(",")})`)}else t.U.userError("function not found: "+a)},e.lookupFunc=u,e.lookupFunctionAddr=function(e){if("_pxt_comm_base"==e)return s.commBase;let t=u(e);return t?t.value:null},e.hexTemplateHash=d,e.hexPrelude=function(){return`    .startaddr 0x${s.codeStartAddrPadded.toString(16)}\n`},e.hexBytes=p,e.patchHex=function(e,n,i,a){let l=s.hexlines.slice(0,s.codeStartIdx);if(!e.target.useESP){let r=2*n.length+7>>3;t.assert(r<64e3,"program too large, bytes: "+2*n.length),n[17]=r,n[20]=e.commSize}let c=[];for(let e=0;e<s.codePaddingSize>>1;++e)c.push(0);n=c.concat(n);let u=0;function h(e,t){let n=[16,t>>8&255,255&t,0];for(let t=0;t<8;++t)n.push(255&(e[u]||0)),n.push((e[u]||0)>>>8),u++;return n}let f=[16912,0,65535&s.codeStartAddrPadded,s.codeStartAddrPadded>>>16],m=d();for(let e=0;e<4;++e)f.push(parseInt(o(m.slice(4*e,4*e+4)),16));let _=a?t.UF2.newBlockFile(t.target.uf2Family):null;if(s.elfInfo){let r=new Uint8Array(2*n.length);for(let e=0;e<n.length;++e)pxt.HF2.write16(r,2*e,n[e]);let i=pxt.elf.patch(s.elfInfo,r);for(let e=0;e<f.length;++e)pxt.HF2.write16(i,2*e+s.jmpStartAddr,f[e]);if(_&&!e.target.switches.rawELF){let n=e.name||"pxt";return n=n.replace(/[^a-zA-Z0-9\-\.]+/g,"_"),_.filename="Projects/"+n+".elf",t.UF2.writeBytes(_,0,i),[t.UF2.serializeFile(_)]}return[t.U.uint8ArrayToString(i)]}if(s.espInfo){const i=pxt.esp.cloneStruct(s.espInfo),o=i.segments.find((e=>e.isDROM));let a=o.data.length;const l=new Uint8Array(a+2*n.length+255&-256);l.set(o.data);for(let e=0;e<n.length;++e)pxt.HF2.write16(l,a,n[e]),a+=2;o.data=l;const c=pxt.esp.toBuffer(i);return _?(t.UF2.writeBytes(_,0,c),r(_,e),[t.UF2.serializeFile(_)]):[t.U.uint8ArrayToString(c)]}if(_){if(t.UF2.writeHex(_,l),t.UF2.writeBytes(_,s.jmpStartAddr,h(f,s.jmpStartIdx).slice(4)),e.checksumBlock){let n=[];for(let t of e.checksumBlock)n.push(255&t,t>>8);t.UF2.writeBytes(_,e.target.flashChecksumAddr,n)}}else l[s.jmpStartIdx]=p(h(f,s.jmpStartAddr)),e.checksumBlock&&t.U.oops("checksum block in HEX not implemented yet");u=0,i&&(l=[]);let g=s.codeStartAddr,y=g-16>>16;for(;u<n.length;)_?t.UF2.writeBytes(_,g,h(n,g).slice(4)):(g>>16!=y&&(y=g>>16,l.push(p([2,0,0,4,y>>8,255&y]))),l.push(p(h(n,g)))),g+=16;if(!i){let e=s.hexlines.slice(s.codeStartIdx);_?t.UF2.writeHex(_,e):t.Util.pushRange(l,e)}if(!_&&e.target.moveHexEof){for(;!l[l.length-1];)l.pop();":00000001FF"==l[l.length-1]&&l.pop()}if(e.packedSource)if(_)r(_,e);else{let t=0;for(let n=0;n<e.packedSource.length;n+=16){let r=[16,t>>8&255,255&t,14];for(let t=0;t<16;++t)r.push(255&(e.packedSource.charCodeAt(n+t)||0));l.push(p(r)),t+=16}}return!_&&e.target.moveHexEof&&l.push(":00000001FF"),_?[t.UF2.serializeFile(_)]:l}}(n=t.hexfile||(t.hexfile={})),t.hexDump=function(e,t=0){function n(e,t=8){let n=e.toString(16);for(;n.length<t;)n="0"+n;return n}let r="";for(let i=0;i<e.length;i+=16){r+=n(t+i)+": ";let s="";for(let t=0;t<16;t++){0==(3&t)&&(r+=" ");let o=e[i+t];null!=o?(r+=n(o,2)+" ",s+=32<=o&&o<127?String.fromCharCode(o):"."):r+="   "}r+=" "+s+"\n"}return r},t.asmline=function(e){return e.indexOf("\n")>=0?(e=e.replace(/^\s*/gm,"").replace(/^(.*)$/gm,((e,t)=>";"==t[0]&&" "==t[1]||/:\*$/.test(t)?t:"    "+t)))+"\n":(/(^[\s;])|(:$)/.test(e)||(e="    "+e),e+"\n")},t.firstMethodOffset=function(){return 9};const i=[21078089,22513679,15655169,18636881,19658081,21486649,21919277,20041213,20548751,16180187,18361627,19338023,19772677,16506547,23530697,22998697,21225203,19815283,23679599,19822889,21136133,19540043,21837031,18095489,23924267,23434627,22582379,21584111,22615171,23403001,19640683,19998031,18460439,20105387,17595791,16482043,23199959,18881641,21578371,22765747,20170273,16547639,16434589,21435019,20226751,19506731,21454393,23224541,23431973,23745511];function s(e){let n=32;t.U.assert(t.U.unique(e,(e=>""+e)).length==e.length,"non unique");for(let r=2;;r<<=1){if(n--,r<e.length)continue;let s,o=-1,a=-1;for(let l of i){let i=l<<8|n,c=new Uint16Array(r+t.vtLookups+1);t.U.assert(0==(1&c.length));let u=0,d=[];for(let r of e){t.U.assert(r>0);let e=Math.imul(r,i)>>>n;d.push(e);let s=!1;for(let n=0;n<t.vtLookups;n++){if(!c[e+n]){s=!0,c[e+n]=r;break}u++}if(!s){u=-1;break}}(-1==o||o>u)&&(o=u,a=i,s=c)}if(o>=0)return{mult:a,mapping:s,size:r}}}function o(e,n,r,i){const o=s(e.itable.map((e=>e.idx)));let a=t.target.shortPointers?".short":".word",l=`\n        .object ${e.id}_VT\n        .balign 4\n${e.id}_VT:\n        .short ${4*e.allfields.length+4}  ; size in bytes\n        .byte ${pxt.ValTypeObject}, ${pxt.VTABLE_MAGIC} ; magic\n        ${a} ${e.id}_IfaceVT\n        .short ${e.classNo} ; class-id\n        .short 0 ; reserved\n        .word ${o.mult} ; hash-mult\n`,c=e=>{"0"!=e&&(e+="@fn"),l+=`        ${a} ${e}\n`};c("pxt::RefRecord_destroy"),c("pxt::RefRecord_print"),c("pxt::RefRecord_scan"),c("pxt::RefRecord_gcsize");let u=e.toStringMethod;c(u?u.vtLabel():"0");for(let t of e.vtable)c(t.label()+"_nochk");l+=`\n        .balign ${t.target.shortPointers?2:4}\n${e.id}_IfaceVT:\n`;const d=2*o.mapping.length;let p="",h=d,f={};for(let t of e.itable){f[t.idx+""]=h;const e=t.proc?t.proc.isGetter()?1:2:0;p+=`  .short ${t.idx}, ${e} ; ${t.name}\n`,p+=`  .word ${t.proc?t.proc.vtLabel()+"@fn":t.info}\n`,h+=8,t.setProc&&(p+=`  .short ${t.idx}, 0 ; set ${t.name}\n`,p+=`  .word ${t.setProc.vtLabel()}@fn\n`,h+=8)}p+="  .word 0, 0 ; the end\n",h+=8;let m=o.mapping;for(let e=0;e<m.length;++e)r.itEntries++,m[e]&&r.itFullEntries++;return l+="  .short "+t.U.toArray(m).map(((e,t)=>(f[e+""]||d)-2*t)).join(", ")+"\n",l+=p,l+="\n",l}t.vtLookups=3,t.computeHashMultiplier=s,t.vtableToAsm=o;const a=["GC"];function l(e,r,i){let s=`\n    .short ${e.globalsWords}   ; num. globals\n    .short 0 ; patched with number of 64 bit words resulting from assembly\n    .word _pxt_config_data\n    .short 0 ; patched with comm section size\n    .short ${e.nonPtrGlobals} ; number of globals that are not pointers (they come first)\n    .word _pxt_iface_member_names\n    .word _pxt_lambda_trampoline@fn\n    .word _pxt_perf_counters\n    .word _pxt_restore_exception_state@fn\n    .word ${e.emitString(e.getTitle())} ; name\n`,l=null;l=new t.ThumbSnippets;const c=e.setPerfCounters(a);e.procs.forEach((n=>{let r=new t.ProctoAssembler(l,e,n);s+="\n"+r.getAssembly()+"\n"}));let u=new t.ProctoAssembler(l,e,null);u.emitHelpers(),s+="\n"+u.getAssembly()+"\n",s+=n.asmTotalSource,s+="_code_end:\n\n",t.U.iterMap(e.codeHelpers,((e,t)=>{s+=`    .section code\n    .object _code_helper_${t}\n${t}:\n${e}\n`})),s+=l.arithmetic(),s+="_helpers_end:\n\n",e.usedClassInfos.forEach((t=>{s+=o(t,0,e)})),s+="\n.balign 4\n.object _pxt_iface_member_names\n_pxt_iface_member_names:\n",s+=`    .word ${e.ifaceMembers.length}\n`;let d=0;for(let t of e.ifaceMembers){let n=e.emitString(t);s+=`    .word ${n}  ; ${d++} .${t}\n`}s+="    .word 0\n",s+="_vtables_end:\n\n",s+="\n.balign 4\n.object _pxt_config_data\n_pxt_config_data:\n";const p=i.configData||[];for(let e of p)s+=`    .word ${e.key}, ${e.value}  ; ${e.name}=${e.value}\n`;s+="    .word 0\n\n",function(e,n){const r=t.U.unique(n.ifaceMembers.concat(Object.keys(n.strings)),(e=>e));for(let t of r)n.otherLiterals.push(e.string_literal(n.strings[t],t));for(let t of Object.keys(n.doubles)){let r=n.doubles[t];n.otherLiterals.push(`\n.object ${r}\n.balign 4\n${r}: ${e.obj_header("pxt::number_vt")}\n        .hex ${t}\n`)}for(let t of Object.keys(n.hexlits))n.otherLiterals.push(e.hex_literal(n.hexlits[t],t)),n.otherLiterals.push()}(l,e),s+=e.otherLiterals.join(""),s+="\n.balign 4\n.section code\n.object _perf_counters\n_pxt_perf_counters:\n",s+=`    .word ${c.length}\n`;let h="";for(let e=0;e<c.length;++e){let t=".perf"+e;s+=`    .word ${t}\n`,h+=`${t}: .string ${JSON.stringify(c[e])}\n`}return s+=h,s+="_literals_end:\n",s}function c(e){let r;return r=e.nativeType==t.NATIVE_TYPE_VM?new t.assembler.VMFile(new t.vm.VmProcessor(e)):new t.assembler.File(new t.thumb.ThumbProcessor),r.ei.testAssembler(),e.switches.noPeepHole&&(r.disablePeepHole=!0),e.switches.size&&(r.codeSizeStats=!0),r.lookupExternalLabel=n.lookupFunctionAddr,r.normalizeExternalLabel=e=>{let t=n.lookupFunc(e);return t?t.name:e},r}function u(e){if(e.errors.length>0){let n="";throw e.errors.forEach((e=>{let r=/^user(\d+)/.exec(e.scope);if(r){parseInt(r[1]);n+=t.U.lf("At inline assembly:\n"),n+=e.message}})),n?(console.log(t.U.lf("errors in inline assembly")),console.log(n),new Error(e.errors[0].message)):new Error(e.errors[0].message)}}t.processorInlineAssemble=function(e,t){let n=c(e);n.disablePeepHole=!0,n.emit(t),u(n);let r=[];for(let e=0;e<n.buf.length;e+=2)r.push(((n.buf[e+1]||0)<<16|n.buf[e])>>>0);return r};function d(e,t,n){let r=c(e);return r.emit(n),n=`; Interface tables: ${t.itFullEntries}/${t.itEntries} (${Math.round(100*t.itFullEntries/t.itEntries)}%)\n; Virtual methods: ${t.numVirtMethods} / ${t.numMethods}\n`+r.getSource(!0,t.numStmts,e.flashEnd),u(r),{src:n,buf:r.buf,thumbFile:r}}function p(r,i,s,o){const a=s.extinfo.disabledDeps;r=a?`${n.hexPrelude()}\n; compilation disabled on this variant due to ${s.extinfo.disabledDeps}\n.hex 718E3B92C615A841C49866C975EE5197\n.string "${s.extinfo.disabledDeps}"`:`; start\n${n.hexPrelude()}\n    .hex 708E3B92C615A841C49866C975EE5197 ; magic number\n    .hex ${n.hexTemplateHash()} ; hex template hash\n    .hex 873266330af9dbdb ; replaced in binary by program hash\n`+r,s.embedBlob&&(i.packedSource=function(e,n){let r=t.Util.toUTF8(e),i=(r.length,n.length,"A//");return i+=t.U.uint8ArrayToString([255&r.length,r.length>>8,255&n.length,n.length>>8,0,0,0,0]),i+=r,i+=n,i.length%2&&(i+="\0"),i}(s.embedMeta,e.pxtc.decodeBase64(s.embedBlob)),!i.target.noSourceInFlash&&i.packedSource.length<4e4&&(r+=function(e){let t="";for(let n=0;n<e.length;++n){let r=255&e.charCodeAt(n);t+=r<=15?"0"+r.toString(16):r.toString(16)}return`\n    .balign 16\n    .object _stored_program\n_stored_program: .hex ${t}\n`}(i.packedSource),i.packedSource=null));const l=n.flashCodeAlign(s.target);if(!a&&s.target.flashChecksumAddr){let e=0;for(;l>1<<e;)e++;let t=parseInt(n.hexTemplateHash().slice(8,16),16);const i=n.getStartAddress()/l;t=4294967040&t|e;let o=0,a=i;s.target.flashChecksumAddr<n.getStartAddress()&&(o=Math.ceil((s.target.flashChecksumAddr+32)/l),a-=o),r+=`\n    .balign 4\n__end_marker:\n    .word ${t}\n\n; ------- this will get removed from the final binary ------\n__flash_checksums:\n    .word 0x87eeb07c ; magic\n    .word __end_marker ; end marker position\n    .word ${t} ; end marker\n    ; template region\n    .short ${o}, ${a}\n    .word 0x${n.hexTemplateHash().slice(0,8)}\n    ; user region\n    .short ${i}, 0xffff\n    .hex 87326633 ; replaced later\n    .word 0x0 ; terminator\n`}const c=s.extinfo.outputPrefix||"";i.writeFile(c+t.BINARY_ASM,r);const u=d(s.target,i,r);if(u.thumbFile.commPtr&&(i.commSize=u.thumbFile.commPtr-n.getCommBase()),u.src&&i.writeFile(c+t.BINARY_ASM,u.src),a)return void h();const p=o.configData||[];if(p.some((e=>"BOOTLOADER_BOARD_ID"==e.name))){let e="const uint32_t configData[] = {\n";e+="    0x1e9e10f1, 0x20227a79, // magic\n",e+=`    ${p.length}, 0, // num. entries; reserved\n`;for(let t of p)e+=`    ${t.key}, 0x${t.value.toString(16)}, // ${t.name}\n`;e+="    0, 0\n};\n",i.writeFile(c+"config.c",e)}if(u.buf){const e=u.buf;let n="";for(let t=0;t<e.length;++t)n+=String.fromCharCode(255&e[t],e[t]>>8);const r=t.U.sha256(n).slice(0,16),o=t.U.range(4).map((e=>parseInt(r.slice(2*e,2*e+2),16)));t.U.assert(12935==e[12]);for(let t=0;t<o.length;++t)e[12+t]=o[t];if(s.target.flashChecksumAddr){let n=u.thumbFile.lookupLabel("__flash_checksums")/2;t.U.assert(n==e.length-16);let r=e.slice(e.length-16);e.splice(e.length-16,16);let s=Math.ceil(2*e.length/l);t.U.assert(12935==r[r.length-4]),r[r.length-4]=o[0],r[r.length-3]=o[1],r[r.length-5]=s,i.checksumBlock=r}h()}if(!o.procDebugInfo){for(let e of o.breakpoints){let n=t.U.lookup(u.thumbFile.getLabels(),"__brkp_"+e.id);null!=n&&(e.binAddr=n)}for(let e of i.procs)e.fillDebugInfo(u.thumbFile);if(o.procDebugInfo=i.procs.map((e=>e.debugInfo)),i.target.switches.size){const n=[];for(const r of i.procs){const i=e.pxtc.nodeLocationInfo(r.action),s=[i.fileName.replace("pxt_modules/",""),t.getDeclName(r.action),r.debugInfo.size,"function",i.line+1];n.push(s.map((e=>`"${e}"`)).join(","))}n.sort(),n.unshift("filename,name,size,type,line"),i.writeFile(c+"size.csv",n.join("\n"))}}function h(){if(pxt.isOutputText(t.target)){const e=n.patchHex(i,u.buf,!1,!1).join("\r\n")+"\r\n";i.writeFile(c+pxt.outputName(t.target),e)}else{const r=e.pxtc.encodeBase64(n.patchHex(i,u.buf,!1,!!t.target.useUF2)[0]);i.writeFile(c+pxt.outputName(t.target),r)}}}t.assemble=d,t.processorEmit=function(e,r,i){var s,o;const a=l(e,0,i),c=t.U.flatClone(r);n.setupFor(r.target,r.extinfo||t.emptyExtInfo()),p(a,e,r,i),i.builtVariants||(i.builtVariants=[]),i.builtVariants.push(null===(s=r.extinfo)||void 0===s?void 0:s.appVariant);const u=c.otherMultiVariants||[];if(u.length)try{for(let r of u){const s=t.U.flatClone(c);s.extinfo=r.extinfo,r.target.isNative=!0,s.target=r.target,n.setupFor(s.target,s.extinfo),p(a,e,s,i),i.builtVariants.push(null===(o=r.extinfo)||void 0===o?void 0:o.appVariant)}}finally{n.setupFor(c.target,c.extinfo)}},t.validateShim=n.validateShim}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){e.getHelpForKeyword=function(e,t){const n={abstract:null,any:null,as:null,break:null,case:null,catch:null,class:null,continue:null,const:null,constructor:null,debugger:null,declare:null,delete:null,do:null,else:null,enum:null,export:null,extends:null,false:lf("Represents the negative outcome of a logical expression"),finally:null,for:null,from:null,function:null,get:null,if:null,implements:null,in:null,instanceof:null,interface:null,is:null,let:null,namespace:null,new:null,null:null,private:null,protected:null,public:null,return:null,set:null,static:null,super:null,switch:null,this:null,throw:null,true:lf("Represents the positive outcome of a logical expression"),try:null,type:null,typeof:null,undefined:null,void:null,while:null,with:null,of:null};if(t){return{True:n.true,False:n.false,None:null,abs:null,all:null,any:null,ascii:null,bin:null,bool:null,bytearray:null,bytes:null,callable:null,chr:null,classmethod:null,compile:null,complex:null,copyright:null,credits:null,delattr:null,dict:null,dir:null,divmod:null,enumerate:null,eval:null,exec:null,exit:null,filter:null,float:null,format:null,frozenset:null,getattr:null,globals:null,hasattr:null,hash:null,help:null,hex:null,id:null,input:null,int:null,isinstance:null,issubclass:null,iter:null,len:null,license:null,list:null,locals:null,map:null,max:null,memoryview:null,min:null,next:null,object:null,oct:null,open:null,ord:null,pow:null,print:null,property:null,quit:null,range:null,repr:null,reversed:null,round:null,set:null,setattr:null,slice:null,sorted:null,staticmethod:null,str:null,sum:null,super:null,tuple:null,type:null,vars:null}[e]}return n[e]}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){e.LSHost=class{constructor(e){this.p=e}getCompilationSettings(){const e=this.p.getCompilerOptions();return e.noLib=!0,e}getNewLine(){return"\n"}getScriptFileNames(){return this.p.getSourceFiles().map((e=>e.fileName))}getScriptVersion(e){return"0"}getScriptSnapshot(e){const t=this.p.getSourceFile(e);return{getLength:()=>t.getFullText().length,getText:()=>t.getFullText(),getChangeRange:()=>{}}}getCurrentDirectory(){return"."}getDefaultLibFileName(e){return""}useCaseSensitiveFileNames(){return!0}}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){function r(e){var t,r;const i=null===(r=null===(t=null==e?void 0:e.pxt)||void 0===t?void 0:t.callInfo)||void 0===r?void 0:r.qName;return n.lastApiInfo.apis.byQName[i]}function i(e,t,r){if(!e||t<0)return;let i=e.parameters[t];if(e.attributes._def){const s=e.attributes._def.parameters[t].shadowBlockId;if(s){const e=r.blocksById[s],t=n.lastApiInfo.apis.byQName[e.qName];"TD_ID"===t.attributes.shim&&1===t.parameters.length&&(i=t.parameters[0])}}return i}function s(r,i,s,o,a=!1){const l={};o.forEach((e=>{var t,n;let r=e.symbol.retType;if(a)if(7==e.symbol.kind)r=e.symbol.namespace;else if(4==e.symbol.kind){const i=null===(n=null===(t=e.symbol.attributes)||void 0===t?void 0:t.enumIdentity)||void 0===n?void 0:n.split(".");(null==i?void 0:i.length)>1&&(r=i[0])}l[r]=[...l[r]||[],e]}));const c=l[r]||[];let u=[];for(let r of c){const o=m(r.symbol,i,e.SymbolFlags.Enum);if(o){const e=s.getTypeOfSymbolAtLocation(o,i),r=t.getEnumMembers(s,e).map((e=>t.enumMemberToQName(s,e))).map((e=>n.lastApiInfo.apis.byQName[e]));u=[...u,...r]}}return[...c,...p(u,1)]}function o(t){return t.flags&e.SymbolFlags.Variable?4:t.flags&e.SymbolFlags.Class?8:t.flags&e.SymbolFlags.Enum?6:t.flags&e.SymbolFlags.EnumMember?7:t.flags&e.SymbolFlags.Method?1:t.flags&e.SymbolFlags.Module?5:t.flags&e.SymbolFlags.Property?2:0}function a(e){return{kind:0,name:e,pyName:e,qName:e,pyQName:e,namespace:"",attributes:{callingConvention:0,paramDefl:{}},fileName:pxt.MAIN_TS,parameters:[],retType:"any"}}function l(e,t){var n,r;let i=e.getName(),s=/(.*)\.(.*)/.exec(i),a=s?s[2]:i,l=s?s[1]:"",c=null!==(r=null===(n=t.getSymbol())||void 0===n?void 0:n.getName())&&void 0!==r?r:"any";return{kind:o(e),name:a,pyName:a,qName:i,pyQName:i,namespace:l,attributes:{callingConvention:0,paramDefl:{}},fileName:pxt.MAIN_TS,parameters:[],retType:c}}function c(e,t,n){if(e)return t.byQName[n.getFullyQualifiedName(e)]}function u(e,n){return e.weight!==n.weight?n.weight-e.weight:t.compareSymbols(e.symbol,n.symbol)}function d(e,t){return{symbol:e,weight:t}}function p(e,t){return e.map((e=>d(e,t)))}function h(t,n){var r;if(t.flags&e.TypeFlags.NumberLiteral)return"Number";if(t.flags&e.TypeFlags.StringLiteral)return"String";if(t.flags&e.TypeFlags.BooleanLiteral)return"Boolean";const i=n.typeToString(t);return null!==(r={number:"Number",string:"String",boolean:"Boolean"}[i])&&void 0!==r?r:i}function f(e,t){return"."===t.charAt(0)&&(t=t.substr(1)),e.substr(0,e.lastIndexOf(".")+1)+t}function m(e,t,r){const i=n.service&&n.service.getProgram().getTypeChecker();if(!i)return null;const s=i.getSymbolsInScope(t,r);for(let t of s)if(t.escapedName.toString()===e.qName)return t;return null}function _({symbol:e}){return!(/^__/.test(e.name)||/^__/.test(e.namespace)||e.attributes.hidden||e.attributes.deprecated||"TD_ID"==e.attributes.shim||e.attributes.blockAliasFor)}n.getCallSymbol=r,n.getParameter=i,n.getApisForTsType=s,n.getBasicKindDefault=function(e,n){switch(e){case t.SK.StringKeyword:return'""';case t.SK.NumberKeyword:return"0";case t.SK.BooleanKeyword:return n?"False":"false";case t.SK.ArrayType:return"[]";case t.SK.NullKeyword:return n?"None":"null";default:return}},n.tsSymbolToPxtSymbolKind=o,n.makePxtSymbolFromKeyword=a,n.makePxtSymbolFromTsSymbol=l,n.getPxtSymbolFromTsSymbol=c,n.compareCompletionSymbols=u,n.completionSymbol=d,n.completionSymbols=p,n.getNodeAndSymbolAtLocation=function(e,n,r,i){const s=e.getSourceFile(n),o=e.getTypeChecker(),a=t.findInnerMostNodeAtPosition(s,r);if(a){const e=o.getSymbolAtLocation(a);if(e){return[a,c(e,i,o)]}}return null},n.tsTypeToPxtTypeString=h,n.filenameWithExtension=f,n.getWordAtPosition=function(e,t){let n=t,r=t;for(;n>0&&i(n);)--n;for(;r<e.length-1&&i(r);)++r;return n!=r?{text:e.substring(n+1,r),start:n+1,end:r}:null;function i(t){const n=e.charCodeAt(t);return n>=65&&n<=90||n>=97&&n<=122}},n.getTsSymbolFromPxtSymbol=m,n.getDefaultEnumValue=function(e,r){const i=n.service&&n.service.getProgram().getTypeChecker(),s=t.getEnumMembers(i,e);for(const e of s)if(e.name.kind===t.SK.Identifier){const s=t.enumMemberToQName(i,e),o=n.lastApiInfo.apis.byQName[s];return o?o.attributes.alias?r&&o.attributes.pyAlias||o.attributes.alias:r?o.pyQName:o.qName:s}return"0"},n.getCompletions=function(o){var m,g;const{fileName:y,fileContent:b,position:v,wordStartPos:T,wordEndPos:k,runtime:E}=o;let x=b;b&&n.host.setFile(y,b);const S=f(y,"ts"),C={startPos:T,endPos:k},I=/\.py$/.test(y),A={entries:[],isMemberCompletion:!1,isNewIdentifierLocation:!0,isTypeLocation:!1,namespace:[]};let w=x.lastIndexOf("\n",v-1);w=Math.max(0,w);const N=x.substring(w+1,v),D=I?"#":"//";if(N.trim().startsWith(D))return A;let O=-1,R=-1;for(let e=v-1;e>=0;--e){if("."==x[e]){O=e;break}if(!/\w/.test(x[e]))break;-1==R&&(R=e)}O==v-1?x=x.slice(0,v)+"_"+x.slice(v):-1==R&&(x=x.slice(0,v)+"_"+x.slice(v),R=v);const L=-1!==O;A.isMemberCompletion=L;const P=L?x.slice(O+1,k):x.slice(T,k);L&&(R=O);const M={};let F=n.cloneCompileOpts(n.host.opts);F.fileSystem[y]=x,n.addApiInfo(F),F.syntaxInfo={position:R,type:A.isMemberCompletion?"memberCompletion":"identifierCompletion"};let $,B=[];if(I){const e=t.transpile.pyToTs(F);if(e.syntaxInfo&&e.syntaxInfo.symbols&&(B=p(e.syntaxInfo.symbols,1)),e.globalNames&&(n.lastGlobalNames=e.globalNames),!B.length&&e.globalNames&&(B=p(pxt.U.values(e.globalNames),1)),Object.keys(e.outfiles).forEach((t=>{t===S&&n.host.setFile(t,e.outfiles[t])})),e.sourceMap){const n=x,r=e.outfiles[S]||"",i=t.BuildSourceMapHelpers(e.sourceMap,r,n).py.smallestOverlap(C);i&&($=i.ts.startPos)}!L&&B.length>50&&(B=B.filter((e=>(I?e.symbol.pyQName:e.symbol.qName).toLowerCase().indexOf(P.toLowerCase())>=0))),F.ast=!0;t.compile(F,n.service)}else{$=v,F.ast=!0,n.host.setOpts(F);n.runConversionsAndCompileUsingService()}const U=n.service.getProgram(),V=U.getSourceFile(S),H=U.getTypeChecker();let G=t.findInnerMostNodeAtPosition(V,$);if(t.decompiler.buildCommentMap(V).some((e=>e.start<=v&&v<=e.end)))return A;if(G){if([t.SK.StringLiteral,t.SK.FirstTemplateToken,t.SK.NoSubstitutionTemplateLiteral].some((e=>G.kind===e)))return A}A.namespace=t.getCurrentNamespaces(G);let j=!1;if(L){const e=t.findInnerMostNodeAtPosition(V,I?$:O-1);if(e){let t;const r=H.getSymbolAtLocation(e);if(t=(null===(m=null==r?void 0:r.members)||void 0===m?void 0:m.size)>0?H.getDeclaredTypeOfSymbol(r):r?H.getTypeOfSymbolAtLocation(r,e):H.getTypeAtLocation(e),t){const e=t.symbol?H.getFullyQualifiedName(t.symbol):h(t,H);if(e){B=t.getApparentProperties().map((t=>e+"."+t.getName())).map((e=>n.lastApiInfo.apis.byQName[e])).filter((e=>!!e)).map((e=>d(e,1))),j=!0}}}}const K=pxt.U.values(n.lastApiInfo.apis.byQName);if(0===B.length){B=p(K.filter((e=>(I?e.pyQName:e.qName).toLowerCase().indexOf(P.toLowerCase())>=0)),1)}if(!I&&!j){G=t.findInnerMostNodeAtPosition(V,T),G||(G=V.getSourceFile());let r=e.SymbolFlags.Variable,i=H.getSymbolsInScope(G,r),s=G.getText();"_"!==s&&(i=i.filter((e=>e.name.indexOf(s)>=0)));let o=i.map((e=>{let t=c(e,n.lastApiInfo.apis,H);if(!t){t=l(e,H.getTypeOfSymbolAtLocation(e,G))}return t})).filter((e=>!!e)).map((e=>d(e,1)));o.forEach((e=>e.weight+=5)),B=[...B,...o]}const W=t.getParentCallExpression(G);if(W){let e=t.findCurrentCallArgIdx(W,G,$);if(e>=0){const t=n.blocksInfoOp(n.lastApiInfo.apis,E.bannedCategories),o=r(W);if(o){e>=o.parameters.length&&(e=o.parameters.length-1);const n=i(o,e,t);if(n){s(n.type,W,H,B,n.isEnum).forEach((e=>e.weight=10))}}}}if(!L){let e;if(I){let t=pxt.py.keywords;e=Object.keys(t)}else e=[...ts.pxtc.reservedWords,...ts.pxtc.keywordTypes];let t=e.filter((e=>e.indexOf(P)>=0)).map(a).map((e=>d(e,0)));B=[...B,...t]}let z={};z=I&&n.lastGlobalNames?n.lastGlobalNames:n.lastApiInfo.apis.byQName,B.map((e=>!e.symbol.attributes.alias||L&&7===e.symbol.kind?e:d(n.lastApiInfo.apis.byQName[e.symbol.attributes.alias],e.weight))).filter(_).forEach((e=>{M[e.symbol.qName]=e})),B=pxt.Util.values(M).filter((e=>!!e&&!!e.symbol)),B.sort(u),o.light&&B.length>100&&(B=B.splice(0,100));const{bannedCategories:q,screenSize:J}=o.runtime,Y={takenNames:z,blocksInfo:n.blocksInfoOp(n.lastApiInfo.apis,q),screenSize:J,apis:n.lastApiInfo.apis,checker:null===(g=null===n.service||void 0===n.service?void 0:n.service.getProgram())||void 0===g?void 0:g.getTypeChecker()};return B.forEach((t=>function(t,r,i){const s=n.lastApiInfo.decls[t.qName];if(e.isFunctionLike(s)&&(t.snippetAddsDefinitions||r&&!t.pySnippet||!r&&!t.snippet)){const e=n.getSnippet(i,t,s,r),o=n.snippetStringify(e),a=n.snippetStringify(e,!0),l=n.snippetAddsDefinitions(e);r?(t.pySnippet=o,t.pySnippetWithMarkers=a):(t.snippet=o,t.snippetWithMarkers=a),t.snippetAddsDefinitions=l}}(t.symbol,I,Y))),A.entries=B.map((e=>e.symbol)),A}}(t.service||(t.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n=function(t){let n=i(t);e.sys.write(n)};function r(e){for(const t of e)n(t)}function i(n){let r;if(void 0!==n.file){let t=n;const{line:i,character:s}=e.getLineAndCharacterOfPosition(t.file,t.start),o=t.file.fileName;r=Object.assign({fileName:o,line:i,column:s},t)}else r=Object.assign({fileName:void 0,line:void 0,column:void 0},n);return function(n){let r="";n.fileName&&(r+=`${n.fileName}(${n.line+1},${n.column+1}): `);let i=e.sys?e.sys.newLine:"\n";const s=t.DiagnosticCategory[n.category].toLowerCase();return r+=`${s} TS${n.code}: ${t.flattenDiagnosticMessageText(n.messageText,i)}${i}`,r}(r)}function s(t,n){const r=e.createCompilerHost(n);return r.getDefaultLibFileName=()=>"node_modules/pxt-core/pxtcompiler/ext-typescript/lib/lib.d.ts",e.createProgram(t,n,r)}function o(e){let n=e.getSyntacticDiagnostics();return 0===n.length&&(n=e.getOptionsDiagnostics().concat(t.Util.toArray(e.getGlobalDiagnostics())),0===n.length&&(n=e.getSemanticDiagnostics())),n.slice(0)}t.getDiagnosticString=i,t.plainTscCompileDir=function(t){const i=e.parseCommandLine([]);let a=e.findConfigFile(t,e.sys.fileExists);const l=function(){let n=e.sys.readFile(a);const s=e.parseConfigFileTextToJson(a,n),o=s.config;if(!o)return r([s.error]),void e.sys.exit(e.ExitStatus.DiagnosticsPresent_OutputsSkipped);const l=e.parseJsonConfigFileContent(o,e.sys,t,i.options,a);if(l.errors.length>0)return r(l.errors),void e.sys.exit(e.ExitStatus.DiagnosticsPresent_OutputsSkipped);return l}();let c=s(l.fileNames,l.options);return o(c).forEach(n),c},t.plainTscCompileFiles=s,t.getProgramDiagnostics=o}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){function n(t){if(!t||!t.kind)return null;switch(t.kind){case e.SyntaxKind.StringKeyword:return"str";case e.SyntaxKind.NumberKeyword:return"number";case e.SyntaxKind.BooleanKeyword:return"bool";case e.SyntaxKind.VoidKeyword:return"None";case e.SyntaxKind.FunctionType:return function(e){let t=n(e.type);return`(${e.parameters.map((e=>e.type)).map(n).join(", ")}) -> ${t}`}(t);case e.SyntaxKind.ArrayType:return`List[${n(t.elementType)}]`;case e.SyntaxKind.TypeReference:{let e=t;return e.typeName&&e.typeName.getText?e.typeName.getText():""}case e.SyntaxKind.AnyKeyword:return"any";default:return pxt.tickEvent("depython.todo.tstypenodetopytype",{kind:t.kind}),""}}function r(t){if(!t||!t.flags)return null;switch(t.flags){case e.TypeFlags.String:return"str";case e.TypeFlags.Number:return"number";case e.TypeFlags.Boolean:return"bool";case e.TypeFlags.Void:return"None";case e.TypeFlags.Any:return"any";default:return pxt.tickEvent("depython.todo.tstypetopytype",{kind:t.flags}),""}}function i(i,s,o){function a(t,n,r=!1){let s=i.getTypeAtLocation(n);if(!s)return"None";r&&(s=s.getCallSignatures()[0].getReturnType());const o=i.typeToString(s,void 0,e.TypeFormatFlags.UseFullyQualifiedType);return/^\d/.test(o)?"number":"this"==o?c(i,s.symbol):o}let l=function(e){switch(e.kind){case t.SK.MethodDeclaration:case t.SK.MethodSignature:return 1;case t.SK.PropertyDeclaration:case t.SK.PropertySignature:case t.SK.GetAccessor:case t.SK.SetAccessor:return 2;case t.SK.Constructor:case t.SK.FunctionDeclaration:return 3;case t.SK.VariableDeclaration:return 4;case t.SK.ModuleDeclaration:return 5;case t.SK.EnumDeclaration:return 6;case t.SK.EnumMember:return 7;case t.SK.ClassDeclaration:return 8;case t.SK.InterfaceDeclaration:return 9;default:return 0}}(o);if(0!=l){let c=o,u=t.parseComments(c);if(u.weight<0)return null;let d,p=/^(.*)\.(.*)/.exec(s),h=3==l||1==l,f=null,m=null,_=e.getSourceFileOfNode(o);if(_){let e=/^pxt_modules\/([^\/]+)/.exec(_.fileName);e&&(f=e[1])}if(8==l||9==l){let e=o;if(d=[],e.heritageClauses)for(let t of e.heritageClauses)if(t.types)for(let e of t.types)d.push(a(0,e))}6!=l&&7!==l||(d||(d=[])).push("Number");let g={kind:l,qName:s,namespace:p?p[1]:"",name:p?p[2]:s,fileName:o.getSourceFile().fileName,attributes:u,pkg:f,pkgs:m,extendsTypes:d,retType:o.kind==e.SyntaxKind.Constructor?"void":5==l?"":a(c.type,c,h),parameters:h?t.Util.toArray(c.parameters).map(((s,o)=>{let l,c,d=t.getName(s),p=u.paramHelp[d]||"",h=u.paramMin&&u.paramMin[d],f=u.paramMax&&u.paramMax[d];/\beg\.?:\s*(.+)/.exec(p);if(s.type&&s.type.kind===t.SK.FunctionType){const n=i.getSignatureFromDeclaration(s.type).getParameters();"objectdestructuring"===u.mutate?(t.assert(n.length>0),l=i.getTypeAtLocation(n[0].valueDeclaration).getProperties().map((e=>({name:e.getName(),type:i.typeToString(i.getTypeOfSymbolAtLocation(e,n[0].valueDeclaration))})))):c=n.map(((t,n)=>({name:t.getName(),type:i.typeToString(i.getTypeOfSymbolAtLocation(t,s),void 0,e.TypeFormatFlags.UseFullyQualifiedType)})))}let m={};const _=i.getTypeAtLocation(s);let g=_&&!!(_.flags&(e.TypeFlags.Enum|e.TypeFlags.EnumLiteral));if(u.block&&u.paramShadowOptions){const e=[];u.block.replace(/%(\w+)/g,((t,n)=>(e.push(n),""))),u.paramShadowOptions[e[o]]&&(m.fieldEditorOptions={value:u.paramShadowOptions[e[o]]})}h&&(m.min={value:h}),f&&(m.max={value:f});const y=s.type&&n(s.type)||_&&r(_)||"unknown",b=s.initializer?s.initializer.getText():t.getExplicitDefault(u,d)||(s.questionToken?"undefined":void 0);return{name:d,description:p,type:a(s.type,s),pyTypeString:y,initializer:b,default:u.paramDefl[d],properties:l,handlerParameters:c,options:m,isEnum:g}})):null,snippet:e.isFunctionLike(o)?null:void 0};switch(g.kind){case 7:g.pyName=t.U.snakify(g.name).toUpperCase();break;case 4:case 1:case 2:case 3:g.pyName=t.U.snakify(g.name);break;case 6:case 8:case 9:case 5:default:g.pyName=g.name}return(o.kind===t.SK.GetAccessor||(o.kind===t.SK.PropertyDeclaration||o.kind===t.SK.PropertySignature)&&t.isReadonly(o))&&(g.isReadOnly=!0),g}return null}function s(e){return!!e.attributes.block&&!!e.attributes.blockId}let o;function a(e,n){function r(t){return-t(e)+t(n)}let i=r((e=>s(e)?1:-1));return i||(i=r((e=>e.namespace?-1:1)),i||(o||(o={},o[4]=100,o[5]=101,o[3]=99,o[2]=98,o[1]=97,o[8]=89,o[6]=81,o[7]=80),i=r((e=>o[e.kind]||0)),i||(i=r((e=>e.attributes.weight||50)),i||t.U.strcmp(e.name,n.name))))}function l(e,n,r=!1){const s={byQName:{},jres:n},o={},a=e.getTypeChecker(),l=e=>{var n,r;if(e.kind!=t.SK.VariableStatement){if(t.isExported(e)){if(!e.symbol)return void console.warn("no symbol",e);let l=c(a,e.symbol);e.kind==t.SK.SetAccessor&&(l+="@set"),o[l]=e;let u=i(a,l,e);if(u){let i=t.U.lookup(s.byQName,l);if(i)if(9==i.kind&&9!=u.kind)s.byQName[l+"@type"]=i;else if(9!=i.kind&&9==u.kind)s.byQName[l+"@type"]=u,u=i;else{const e=null===(n=i.attributes._source)||void 0===n?void 0:n.trim(),s=null===(r=u.attributes._source)||void 0===r?void 0:r.trim();let o=e+"\n"+s;e&&(null==s?void 0:s.indexOf(e))>=0?o=s:s&&(null==e?void 0:e.indexOf(s))>=0&&(o=e),u.attributes=t.parseCommentString(o),5===i.kind&&(u.pkgs=i.pkgs||[],i.pkg!==u.pkg&&(u.pkgs.find((e=>e===i.pkg))||u.pkgs.push(i.pkg))),i.extendsTypes&&(u.extendsTypes=u.extendsTypes||[],i.extendsTypes.forEach((e=>{-1===u.extendsTypes.indexOf(e)&&u.extendsTypes.push(e)})))}!e.parent||e.parent.kind!=t.SK.ClassDeclaration&&e.parent.kind!=t.SK.InterfaceDeclaration||t.isStatic(e)||(u.isInstance=!0),s.byQName[l]=u}}if(e.kind==t.SK.ModuleDeclaration){let n=e;if(n.body.kind==t.SK.ModuleBlock){n.body.statements.forEach(l)}else n.body.kind==t.SK.ModuleDeclaration&&l(n.body)}else if(e.kind==t.SK.InterfaceDeclaration){e.members.forEach(l)}else if(e.kind==t.SK.ClassDeclaration){e.members.forEach(l)}else if(e.kind==t.SK.EnumDeclaration){e.members.forEach(l)}}else{e.declarationList.declarations.forEach(l)}};for(let t of e.getSourceFiles())t.statements.forEach(l);let u=[];for(let e in s.byQName){let r=s.byQName[e];r.qName=e,r.attributes._source=null,r.extendsTypes&&r.extendsTypes.length&&u.push(r);let i=r.attributes.jres;if(i){"true"==i&&(i=e);let s=t.U.lookup(n||{},i);s&&s.icon&&!r.attributes.iconURL&&(r.attributes.iconURL=s.icon),s&&s.data&&!r.attributes.jresURL&&(r.attributes.jresURL="data:"+s.mimeType+";base64,"+s.data)}if(r.pyName){let e=t.U.lookup(t.ts2PyFunNameMap,r.qName);if(e&&e.n)r.pyQName=e.n,r.pySnippet=e.snippet,r.pySnippetName=e.n,r.pySnippetWithMarkers=void 0;else if(r.namespace){let e=s.byQName[r.namespace];e?r.pyQName=e.pyQName+"."+r.pyName:(pxt.log("namespace missing: "+r.namespace),r.pyQName=r.namespace+"."+r.pyName)}else r.pyQName=r.pyName}}let d={},p=e=>{if(t.U.lookup(d,e.qName))return;d[e.qName]=!0;let n={};n[e.qName]=!0;for(let t of e.extendsTypes||[]){n[t]=!0;let e=s.byQName[t];if(e){p(e);for(let t of e.extendsTypes)n[t]=!0}}e.extendsTypes=Object.keys(n)};return u.forEach(p),r&&delete s.byQName["Array.map"],{apis:s,decls:o}}function c(e,t){return t.isBogusSymbol?t.name:e.getFullyQualifiedName(t)}t.placeholderChar="",t.ts2PyFunNameMap={"Math.trunc":{n:"int",t:e.SyntaxKind.NumberKeyword,snippet:"int(0)"},"Math.min":{n:"min",t:e.SyntaxKind.NumberKeyword,snippet:"min(0, 0)"},"Math.max":{n:"max",t:e.SyntaxKind.NumberKeyword,snippet:"max(0, 0)"},"Math.abs":{n:"abs",t:e.SyntaxKind.NumberKeyword,snippet:"abs(0)"},"console.log":{n:"print",t:e.SyntaxKind.VoidKeyword,snippet:'print(":)")'},".length":{n:"len",t:e.SyntaxKind.NumberKeyword},".toLowerCase()":{n:"string.lower",t:e.SyntaxKind.StringKeyword},".toUpperCase()":{n:"string.upper",t:e.SyntaxKind.StringKeyword},".charCodeAt(0)":{n:"ord",t:e.SyntaxKind.NumberKeyword},"pins.createBuffer":{n:"bytearray",t:e.SyntaxKind.Unknown},"pins.createBufferFromArray":{n:"bytes",t:e.SyntaxKind.Unknown},"control.createBuffer":{n:"bytearray",t:e.SyntaxKind.Unknown},"control.createBufferFromArray":{n:"bytes",t:e.SyntaxKind.Unknown},"!!":{n:"bool",t:e.SyntaxKind.BooleanKeyword},"Array.indexOf":{n:"Array.index",t:e.SyntaxKind.Unknown},"Array.push":{n:"Array.append",t:e.SyntaxKind.Unknown},parseInt:{n:"int",t:e.SyntaxKind.NumberKeyword,snippet:'int("0")'},"_py.range":{n:"range",t:e.SyntaxKind.Unknown,snippet:"range(4)"}},t.emitPyTypeFromTypeNode=n,t.emitPyTypeFromTsType=r,t.genDocs=function(n,r,i={}){pxt.debug(`generating docs for ${n}`),pxt.debug(JSON.stringify(Object.keys(r.byQName),null,2));const s={},o=t.Util.values(r.byQName),l=o.filter((e=>7==e.kind)).sort(a),c={},u={},d={},p=t=>{if(i.locs&&t.qName&&!/^__/.test(t.name)){if(pxt.debug(`loc: ${t.qName}`),7!=t.kind){const n=e.pxtc.blocksCategory(t);n&&(u[`{id:category}${n}`]=n)}t.attributes.jsDoc&&(d[t.qName]=t.attributes.jsDoc),t.attributes.block&&(u[`${t.qName}|block`]=t.attributes.block),t.attributes.group&&(u[`{id:group}${t.attributes.group}`]=t.attributes.group),t.attributes.subcategory&&(u[`{id:subcategory}${t.attributes.subcategory}`]=t.attributes.subcategory),t.parameters&&t.parameters.filter((e=>!!e.description)).forEach((e=>{d[`${t.qName}|param|${e.name}`]=e.description}))}},h=(e,t)=>{if(!i.locs)return;const r={};Object.keys(e).sort().forEach((t=>r[t]=e[t])),s[n+t+"-strings.json"]=JSON.stringify(r,null,2)};for(const e of o){if(5==e.kind){if(!o.filter((t=>t.namespace==e.name&&!!t.attributes.jsDoc))[0])continue;e.attributes.block||(e.attributes.block=e.name)}p(e)}return i.locs&&l.forEach((e=>{e.attributes.block&&(u[`${e.qName}|block`]=e.attributes.block),e.attributes.jsDoc&&(u[e.qName]=e.attributes.jsDoc)})),h(u,""),h(d,"-jsdoc"),i.pxtsnippet&&(i.pxtsnippet.forEach((e=>function(e,t){const n=["label","title","hint","errorMessage"];t[e.label]=e.label,e.questions.forEach((e=>{n.forEach((n=>{e[n]&&(t[e[n]]=e[n])}))}))}(e,c))),h(c,"-snippet")),s},t.hasBlock=s,t.compareSymbols=a,t.getApiInfo=function(e,t,n=!1){return l(e,t,n).apis},t.internalGetApiInfo=l,t.getFullName=c}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){let r,i,s={fileSystem:{},sourceFiles:[],target:{isNative:!1,hasHex:!1,switches:{}}};class o{constructor(){this.opts=s,this.fileVersions={},this.projectVer=0,this.pxtModulesOK=null}getProjectVersion(){return this.projectVer+""}setFile(e,t){this.opts.fileSystem[e]!=t&&(this.fileVersions[e]=(this.fileVersions[e]||0)+1,this.opts.fileSystem[e]=t,this.projectVer++)}reset(){this.setOpts(s),this.pxtModulesOK=null}setOpts(e){t.Util.iterMap(e.fileSystem,((e,t)=>{this.opts.fileSystem[e]!=t&&(this.fileVersions[e]=(this.fileVersions[e]||0)+1)})),this.opts=Object.assign(Object.assign({},e),{fileSystem:Object.assign({},e.fileSystem)}),this.projectVer++}getCompilationSettings(){return t.getTsCompilerOptions(this.opts)}getScriptFileNames(){return this.opts.sourceFiles.filter((e=>t.U.endsWith(e,".ts")))}getScriptVersion(e){return(this.fileVersions[e]||0).toString()}getScriptSnapshot(t){let n=this.opts.fileSystem[t];return null!=n?e.ScriptSnapshot.fromString(n):null}getNewLine(){return"\n"}getCurrentDirectory(){return"."}getDefaultLibFileName(e){return"no-default-lib.d.ts"}log(e){console.log("LOG",e)}trace(e){console.log("TRACE",e)}error(e){console.error("ERROR",e)}useCaseSensitiveFileNames(){return!0}}function a(e,r){return e?(n.lastLocBlocksInfo||(n.lastLocBlocksInfo=t.getBlocksInfo(e,r)),n.lastLocBlocksInfo):(n.lastBlocksInfo||(n.lastBlocksInfo=t.getBlocksInfo(n.lastApiInfo.apis,r)),n.lastBlocksInfo)}function l(e){return n.lastApiInfo||(n.lastApiInfo=t.internalGetApiInfo(n.service.getProgram(),e.jres)),n.lastApiInfo}function c(e){if(!e.apisInfo){const n=l(e);e.apisInfo=t.U.clone(n.apis)}}function u(e){let t=pxt.U.flatClone(e);return t.fileSystem=pxt.U.flatClone(t.fileSystem),t}n.blocksInfoOp=a,n.getLastApiInfo=l,n.addApiInfo=c,n.cloneCompileOpts=u,n.IsOpErr=function(e){return!!e.errorMessage};const d={reset:()=>{n.service=e.createLanguageService(n.host),n.lastApiInfo=void 0,n.lastGlobalNames=void 0,n.host.reset()},setOptions:e=>{n.host.setOpts(e.options)},syntaxInfo:e=>{var r,i,s;let o=e.fileContent;e.fileContent&&n.host.setFile(e.fileName,e.fileContent);let a=u(n.host.opts);a.fileSystem[e.fileName]=o,c(a),a.syntaxInfo={position:e.position,type:e.infoType};const d=e.fileName.endsWith(".py"),h="symbol"===a.syntaxInfo.type,f="signature"===a.syntaxInfo.type;if(d){let e=t.transpile.pyToTs(a);e.globalNames&&(n.lastGlobalNames=e.globalNames)}else{a.ast=!0,n.host.setOpts(a);p();const i=n.service.getProgram(),s=i.getSourceFile(e.fileName),o=i.getTypeChecker();if(h||f){let i=t.findInnerMostNodeAtPosition(s,e.position);if(i)if(h){const e=o.getSymbolAtLocation(i);if(e){let t=n.getPxtSymbolFromTsSymbol(e,a.apisInfo,o);a.syntaxInfo.symbols=[t],a.syntaxInfo.beginPos=i.getStart(),a.syntaxInfo.endPos=i.getEnd()}}else if(f){const n=null===(r=null==i?void 0:i.pxt)||void 0===r?void 0:r.callInfo;if(n){const r=a.apisInfo.byQName[n.qName];a.syntaxInfo.symbols=[r],a.syntaxInfo.beginPos=i.getStart(),a.syntaxInfo.endPos=i.getEnd();const s=t.getParentCallExpression(i);if(s){const n=t.findCurrentCallArgIdx(s,i,e.position);a.syntaxInfo.auxResult=n}}}}}if(h&&!(null===(i=a.syntaxInfo.symbols)||void 0===i?void 0:i.length)){const r=n.getWordAtPosition(e.fileContent,e.position);if(r)if(d&&"range"===r.text){const e=l(a).apis;e.byQName["_py.range"]&&(a.syntaxInfo.symbols=[e.byQName["_py.range"]],a.syntaxInfo.beginPos=r.start,a.syntaxInfo.endPos=r.end)}else{const e=t.getHelpForKeyword(r.text,d);e&&(a.syntaxInfo.auxResult={documentation:e,displayString:n.displayStringForKeyword(r.text,d)},a.syntaxInfo.beginPos=r.start,a.syntaxInfo.endPos=r.end)}}if(null===(s=a.syntaxInfo.symbols)||void 0===s?void 0:s.length){const e=l(a).apis;d&&(a.syntaxInfo.symbols=a.syntaxInfo.symbols.map((t=>e.byQName[t.qName]||t))),h&&(a.syntaxInfo.auxResult=a.syntaxInfo.symbols.map((t=>n.displayStringForSymbol(t,d,e))))}return a.syntaxInfo},getCompletions:e=>n.getCompletions(e),compile:e=>{n.host.setOpts(e.options);const r=p();return t.timesToMs(r),r},decompile:e=>(n.host.setOpts(e.options),t.decompile(n.service.getProgram(),e.options,e.fileName,!1)),pydecompile:e=>(n.host.setOpts(e.options),t.transpile.tsToPy(n.service.getProgram(),e.fileName)),decompileSnippets:e=>(n.host.setOpts(e.options),t.decompileSnippets(n.service.getProgram(),e.options,!1)),assemble:e=>({words:t.processorInlineAssemble(n.host.opts.target,e.fileContent)}),py2ts:e=>(c(e.options),t.transpile.pyToTs(e.options)),fileDiags:e=>t.patchUpDiagnostics(function(e){if(!/\.ts$/.test(e))return[];let t=n.service.getSyntacticDiagnostics(e);return t&&t.length||(t=n.service.getSemanticDiagnostics(e)),t||(t=[]),t}(e.fileName)),allDiags:()=>{let e=p();return t.timesToMs(e),n.host.opts.target.switches.time&&console.log("DIAG-TIME",e.times),e},format:e=>{const n=e.format;return t.format(n.input,n.pos)},apiInfo:()=>{if(n.lastBlocksInfo=void 0,r=void 0,n.host.opts!==s)return n.lastApiInfo=t.internalGetApiInfo(n.service.getProgram(),n.host.opts.jres),n.lastApiInfo.apis},snippet:t=>{const r=t.snippet;if(!n.lastApiInfo)return;const i=n.lastApiInfo.apis.byQName[r.qName],s=n.lastApiInfo.decls[r.qName];if(!i||!s||!e.isFunctionLike(s))return;const o=!!r.python;let l={};l=o&&n.lastGlobalNames?n.lastGlobalNames:n.lastApiInfo.apis.byQName;const{bannedCategories:c,screenSize:u}=t.runtime,{apis:d}=n.lastApiInfo,p={apis:d,blocksInfo:a(d,c),takenNames:l,bannedCategories:c,screenSize:u,checker:n.service&&n.service.getProgram().getTypeChecker()},h=n.getSnippet(p,i,s,o);return n.snippetStringify(h)},blocksInfo:e=>a(e,e.blocks&&e.blocks.bannedCategories),apiSearch:e=>{const t=e.search,i=a(t.localizedApis,e.blocks&&e.blocks.bannedCategories);t.localizedStrings&&pxt.Util.setLocalizedStrings(t.localizedStrings);const s=(e,t,n)=>{if(e)return"string"==typeof e?e:t?e[t]:Object.keys(e).map((t=>e[t])).join(" ")},o=e=>{var t;if(null===(t=e.attributes)||void 0===t?void 0:t._def){let t=[];const n=e.attributes._def,r=pxt.blocks.compileInfo(e);for(let e of n.parts)switch(e.kind){case"label":t.push(e.text);break;case"param":let n=r.definitionNameToParam[e.name];t.push((null==n?void 0:n.defaultValue)||e.varName||(null==n?void 0:n.actualName)||e.name)}return t.join(" ")}return e.attributes.block},l=e=>{var t;const n=null===(t=e.attributes)||void 0===t?void 0:t.paramHelp;return n&&Object.keys(n).map((e=>n[e])).join(" "),""};if(!n.builtinItems){n.builtinItems=[],n.blockDefinitions=pxt.blocks.blockDefinitions();for(const e in n.blockDefinitions){const t=n.blockDefinitions[e];if(t.operators)for(const r in t.operators){t.operators[r].forEach((i=>n.builtinItems.push({id:e,name:t.name,jsdoc:"string"==typeof t.tooltip?t.tooltip:t.tooltip[i],block:i,field:[r,i],builtinBlock:!0})))}else n.builtinItems.push({id:e,name:t.name,jsdoc:s(t.tooltip,t.tooltipSearch),block:s(t.block,t.blockTextSearch),builtinBlock:!0})}}let c;if(!r||t.subset){const e={};let s=[];t.subset&&(n.tbSubset=t.subset,s=n.builtinItems.filter((e=>!!n.tbSubset[e.id]))),n.tbSubset?c=i.blocks.filter((e=>!!n.tbSubset[e.attributes.blockId])):(c=i.blocks,s=n.builtinItems);let a=c.map((e=>({id:e.attributes.blockId,qName:e.qName,name:e.name,namespace:e.namespace,block:o(e),params:l(e),jsdoc:e.attributes.jsDoc,localizedCategory:n.tbSubset&&"string"==typeof n.tbSubset[e.attributes.blockId]?n.tbSubset[e.attributes.blockId]:void 0}))),u={};s.forEach((e=>u[e.id]=!0)),a=a.filter((e=>!(e.id in u)));let d=0;c.forEach((t=>{const n=e[t.qName]=(e=>{const t=e.attributes.weight||50,n=i.apis.byQName[e.namespace];return(1e3*(n&&n.attributes.weight||50)+t)*(n&&n.attributes.advanced||e.attributes.advanced?1:1e6)})(t);d=Math.max(d,n)})),a=a.concat(s);r=new Fuse(a,{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:16,minMatchCharLength:2,findAllMatches:!1,caseSensitive:!1,keys:[{name:"name",weight:.3},{name:"namespace",weight:.1},{name:"localizedCategory",weight:.1},{name:"block",weight:.4375},{name:"params",weight:.0625},{name:"jsdoc",weight:.0625}],sortFn:function(t,n){const r=t.qName?1-e[t.item.qName]/d:1,i=n.qName?1-e[n.item.qName]/d:1;return t.score*(1+r/10)-n.score*(1+i/10)}})}return r.search(t.term).slice(0,7)},projectSearch:e=>{const t=e.projectSearch,n=t.headers;if(!i){i=new Fuse(n,{shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:16,minMatchCharLength:2,findAllMatches:!1,caseSensitive:!1,keys:[{name:"name",weight:.3}]})}return i.search(t.term)},projectSearchClear:()=>{i=void 0}};function p(){c(n.host.opts);const e=t.U.flatClone(n.host.opts.fileSystem);let r=t.runConversionsAndStoreResults(n.host.opts);(null==r?void 0:r.globalNames)&&(n.lastGlobalNames=r.globalNames);const i=n.host.opts.fileSystem;n.host.opts.fileSystem=e;for(let e of Object.keys(i))n.host.setFile(e,i[e]);if(0==r.diagnostics.length){n.host.opts.skipPxtModulesEmit=!1,n.host.opts.skipPxtModulesTSC=!1;const e=n.host.opts.target.isNative?"native":"js";!n.host.opts.target.switches.noIncr&&n.host.pxtModulesOK&&(n.host.opts.skipPxtModulesTSC=!0,n.host.opts.noEmit?n.host.opts.skipPxtModulesEmit=!0:n.host.opts.target.isNative?n.host.opts.skipPxtModulesEmit=!1:"js"!=n.host.pxtModulesOK||n.host.opts.breakpoints&&!n.host.opts.justMyCode||(n.host.opts.skipPxtModulesEmit=!0));let i=t.compile(n.host.opts,n.service);if(r=Object.assign({sourceMap:r.sourceMap},i),(r.needsFullRecompile||(!r.success||r.diagnostics.length)&&n.host.opts.clearIncrBuildAndRetryOnError)&&(pxt.debug("triggering full recompile"),pxt.tickEvent("compile.fullrecompile"),n.host.opts.skipPxtModulesEmit=!1,i=t.compile(n.host.opts,n.service),r=Object.assign({sourceMap:r.sourceMap},i)),r.diagnostics.every((e=>!t.isPxtModulesFilename(e.fileName)))&&(n.host.pxtModulesOK=e),r.ast){let e=t.internalGetApiInfo(r.ast);e&&(n.lastApiInfo=e)}}return r}n.runConversionsAndCompileUsingService=p,n.performOperation=function(t,r){n.service||(n.host=new o,n.service=e.createLanguageService(n.host));let i=null;if(d.hasOwnProperty(t))try{i=(0,d[t])(r)||{}}catch(e){i={errorMessage:e.stack}}else i={errorMessage:"No such operation: "+t};return i}}(t.service||(t.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){!function(n){function r(e){return"object"==typeof e&&void 0!==e.default}function i(e){return"object"==typeof e&&"number"==typeof e.length}function s(e,t=!1){const n={};let a=1;return function e(l){if(r(l)){if(t){if(o(l.default))return e(l.default);const t=s(l.default,!1);let r=n[t];if(r&&!l.isLiteral||(r=a,a++,n[t]=r),t.indexOf(".")>=0&&t.indexOf(" ")<0){let e=t.split(".");return e[e.length-1]="${"+r+":"+e[e.length-1]+"}",e.join(".")}return"${"+r+":"+t+"}"}return e(l.default)}return i(l)?l.map((t=>e(t))).join(""):l}(e)}function o(e){return!!r(e)||!!i(e)&&e.map(o).reduce(((e,t)=>e||t),!1)}function a(e){return e.attributes.shim&&"@"==e.attributes.shim[0]||e.attributes.pyConvertToTaggedTemplate}n.snippetStringify=s,n.snippetHasReplacementPoints=o,n.snippetAddsDefinitions=function e(t){return r(t)?t.isDefinition||e(t.default):!!i(t)&&t.map(e).reduce(((e,t)=>e||t),!1)},n.getSnippet=function r(i,o,l,c,u=0){var d,p;let{apis:h,takenNames:f,blocksInfo:m,screenSize:_,checker:g}=i;const y=pxt.py.INDENT,b=c?"python":"typescript";let v=o.namespace,T=!1,k="",E=0,x=[];if(a(o))return c?`${o.name}(""" """)`:`${o.name}\`\``;let S="";S=l.kind==t.SK.Constructor?B(l.symbol)||l.parent.name.getText():B(l.symbol)||l.name.getText(),c&&(S=t.U.snakify(S));const C=o.attributes;if("TD_ID"===C.shim&&u&&l.parameters.length)return F(l.parameters[0]);const I=o,A=pxt.blocks.compileInfo(I),w=m.blocksById,N=(null===(d=C._def)||void 0===d?void 0:d.parameters.filter((e=>!!A.definitionNameToParam[e.name])).map((e=>A.definitionNameToParam[e.name].actualName)))||[],D=l.parameters?l.parameters.filter((e=>!e.initializer&&!e.questionToken||N.indexOf(e.name.getText())>=0)):[],O=D.map(F).map((e=>({default:e,isLiteral:!0})));if(I.attributes.block)if(I.attributes.defaultInstance)v=I.attributes.defaultInstance,c&&v&&(v=t.U.snakify(v));else if("variables_get"===(null===(p=A.thisParameter)||void 0===p?void 0:p.shadowBlockId))v=A.thisParameter.defaultValue||A.thisParameter.definitionName,c&&v&&(v=t.U.snakify(v));else if(I.namespace){const e=h.byQName[I.namespace];if(e.attributes.fixedInstances){let n,r=t.Util.values(h.byQName),i=function(e){return r.filter((e=>e.extendsTypes)).filter((t=>t.extendsTypes.reduce(((t,n)=>t||-1!=n.indexOf(e)),!1))).reduce(((e,t)=>e.concat(t.extendsTypes)),[])},s=r.filter((e=>4===e.kind&&e.attributes.fixedInstance));const o=s.filter((t=>t.retType==e.qName)).sort(((e,t)=>e.name.localeCompare(t.name)));if(o.length)n=o[0];else{n=s.filter((t=>-1!==i(e.qName).indexOf(t.retType))).sort(((e,t)=>e.name.localeCompare(t.name)))[0]}n?(v=`${U(n)}`,k=n.namespace):k=e.namespace,k&&(T=!0)}else if(1==I.kind||2==I.kind){if(A.thisParameter){let e;A.thisParameter.definitionName&&(e=A.thisParameter.definitionName,e=e[0].toUpperCase()+e.substring(1),e=`my${e}`),v=A.thisParameter.defaultValue||e,c&&v&&(v=t.U.snakify(v))}}else if(8===e.kind)return}const R=C&&(c?C.pySnippet:C.snippet);let L;if(R)L=[R],v=void 0;else if(L=[S],(null==O?void 0:O.length)||1==I.kind||3==I.kind||8==I.kind){const e=O.reduce(((e,t)=>[...e,e.length?", ":"",t]),[]);L=L.concat(["(",...e,")"])}let P=v?[v,".",...L]:L;if(P=T?[function(e){const t=e.indexOf(".");return t<0?e:e.substring(0,t)}(k),".",...P]:P,C&&C.blockSetVariable)if(c){P=[{default:M(t.U.snakify(C.blockSetVariable)),isDefinition:!0}," = ",...P]}else{P=["let ",{default:M(C.blockSetVariable),isDefinition:!0}," = ",...P]}return[x,P];function M(t){return f[t]?e.pxtc.decompiler.getNewName(t,f,!1):t}function F(s){var a,l;const d=s.type;if(!d)return c?"None":"null";const p=s.name.kind===t.SK.Identifier?s.name.text:void 0,f=null===(a=C.paramSnippets)||void 0===a?void 0:a[p];if(f)if(c){if(f.python)return f.python}else if(f.ts)return f.ts;const m=null===(l=null==C?void 0:C.paramDefl)||void 0===l?void 0:l[p];if(m){let e;if(d.kind==t.SK.AnyKeyword){const n=m.toUpperCase();e=Number.isNaN(+n)?"FALSE"==n||"TRUE"==n?t.SK.BooleanKeyword:n.includes(".")?t.SK.EnumKeyword:t.SK.StringKeyword:t.SK.NumberKeyword}if(d.kind===t.SK.StringKeyword||e===t.SK.StringKeyword)return 0!=m.indexOf('"')?`"${m}"`:m;const r=null==g?void 0:g.getTypeAtLocation(s),i=n.getPxtSymbolFromTsSymbol(null==r?void 0:r.symbol,h,g);return(null==i?void 0:i.attributes.fixedInstances)&&c?pxt.Util.snakify(m):c?t.tsSnippetToPySnippet(m,i):m}let y=function(e){var t,n;const r=pxt.blocks.compileInfo(o),i=null===(t=r.parameters)||void 0===t?void 0:t.find((t=>t.actualName===e));if(!(null==i?void 0:i.shadowBlockId))return null;let s=w[i.shadowBlockId];if(!s)return null;const a=null===(n=s.attributes)||void 0===n?void 0:n.paramFieldEditor;if(!a)return null;const l=a[e];if(!l)return null;const c=s.attributes.paramFieldEditorOptions||{};switch(l){case"sprite":return function(e){const t={initColor:0,initWidth:16,initHeight:16};if(null==e?void 0:e.sizes){const n=e.sizes.split(";"),r=[];for(let e=0;e<n.length;e++){const t=n[e].split(",");if(2!==t.length)continue;let i=parseInt(t[0]),s=parseInt(t[1]);isNaN(i)||isNaN(s)||(i<0&&_&&(i=_.width),s<0&&_&&(s=_.height),r.push([i,s]))}r.length>0&&(t.initWidth=r[0][0],t.initHeight=r[0][1])}return t.initColor=n(null==e?void 0:e.initColor,t.initColor),t.initWidth=n(null==e?void 0:e.initWidth,t.initWidth),t.initHeight=n(null==e?void 0:e.initHeight,t.initHeight),pxt.sprite.imageLiteralFromDimensions(t.initWidth,t.initHeight,t.initColor,b);function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(c[e])}return null}(p);if(y)return y;let v=function(e){let t=(C._shadowOverrides||{})[e];if(!t){const n=pxt.blocks.compileInfo(o);for(const r of n.parameters)if(r.actualName===e){t=r.shadowBlockId;break}}if(!t)return null;let n=w[t];if(!n)return null;if("TD_ID"===n.attributes.shim&&n.parameters.length){let e=n.parameters[0].type;n=h.byQName[e]||n}return n}(p);if(v){let a=n.getTsSymbolFromPxtSymbol(v,s,e.SymbolFlags.Enum);if(a){let e=g.getTypeOfSymbolAtLocation(a,s);if(e){let t=$(e);if(t)return t}}const l=v.attributes;if("KIND_GET"===l.shim&&l.blockId){const e=l.kindNamespace||o.namespace,n=t.Util.values(h.byQName).find((t=>t.namespace===e&&t.attributes.isKind));if(n)return c?n.pyQName:n.qName}if(u<3&&n.lastApiInfo.decls[v.qName]){let e=r(i,v,n.lastApiInfo.decls[v.qName],c,u+1);if(e)return e}}if(d.kind===t.SK.StringKeyword&&"leds"===p)return c?'"""\n. . . . .\n. . . . .\n. . # . .\n. . . . .\n. . . . .\n"""':"`\n. . . . .\n. . . . .\n. . # . .\n. . . . .\n. . . . .\n`";if(d.kind===t.SK.FunctionType){const e=d;let t=g?g.getSignatureFromDeclaration(e):void 0;return t?V(t,!0):H(p)}const T=n.getBasicKindDefault(d.kind,c);if(void 0!==T)return T;let k=g&&g.getTypeAtLocation(s);if(k){let e=$(k);if(e)return e}return c?"None":"null"}function $(r){if(r.symbol&&r.symbol.flags&e.SymbolFlags.Enum){return n.getDefaultEnumValue(r,c)}const i=n.getPxtSymbolFromTsSymbol(r.symbol,h,g);if(t.isObjectType(r)){const t=i&&i.attributes&&(c?i.attributes.pySnippet:i.attributes.snippet);if(t)return t;if(r.objectFlags&e.ObjectFlags.Anonymous){const t=g.getSignaturesOfType(r,e.SignatureKind.Call);return t&&t.length?V(t[0],!1):H()}}if(r.flags&e.TypeFlags.NumberLike)return"0";if(i&&i.attributes.fixedInstances){const e=function(e){return pxt.Util.values(h.byQName).filter((t=>4===t.kind&&t.attributes.fixedInstance&&function(e,t,n){if(t==n)return!0;let r=e.byQName[t];return!(!r||!r.extendsTypes)&&r.extendsTypes.indexOf(n)>=0}(h,t.retType,e.qName)))}(i);if(e.length){const t=e[0];return c?t.pyQName:t.qName}}}function B(e){if(g){const n=t.getFullName(g,e),r=h.byQName[n];if(r)return U(r)}}function U(e){return c?e.pyName:e.name}function V(n,r){let i="",o=g.getReturnTypeOfSignature(n);if(o.flags&e.TypeFlags.NumberLike?i="return 0":o.flags&e.TypeFlags.StringLike?i='return ""':o.flags&(e.TypeFlags.Boolean|e.TypeFlags.BooleanLiteral)&&(i=c?"return False":"return false"),c){let o;o=C.optionalVariableArgs?"()":`(${n.parameters.map((e=>e.name)).join(", ")})`;let a=S||"fn";E++>0&&(a+=E),r&&!/^on/i.test(a)&&(a="on"+pxt.Util.capitalize(a));const l=D.filter((t=>{const n=g&&g.getTypeAtLocation(t);return!!(n&&n.symbol&&n.symbol.flags&e.SymbolFlags.Enum)})).map((e=>{const t=s(F(e)).toLowerCase(),n=t.lastIndexOf(".");return-1!==n?t.substr(n+1):t})).join("_");return l&&(a+="_"+l),a=t.U.snakify(a),a=M(a),x=[...x,x.length?"\n":"","def ",{default:a,isDefinition:!0},o,`:\n${y}`,{default:i||"pass"},"\n"],{default:a}}{let t="()";if(!C.optionalVariableArgs){let r=e.mapToDisplayParts((t=>{g.getSymbolDisplayBuilder().buildSignatureDisplay(n,t,void 0,e.TypeFormatFlags.UseFullyQualifiedType)})),i=e.displayPartsToString(r);t=i.substr(0,i.lastIndexOf(":"))}return["function",t,` {\n${y}`,{default:i},"\n}"]}}function H(e){return c?(e=e||"fn",e=M(e=t.U.snakify(e)),x=[...x,x.length?"\n":"","def ",{default:e,isDefinition:!0},`():\n${y}`,{default:"pass"},"\n"],{default:e}):"function () {}"}},n.isTaggedTemplate=a}(t.service||(t.service={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(e){const t=e=>`main.${e}`;e.pyToTs=function(e,n=t("py")){return pxt.py.py2ts(e)},e.tsToPy=function(e,n=t("ts")){return pxt.py.decompileToPython(e,n)}}(e.transpile||(e.transpile={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(t){let n;function r(e,t){if(!e)return;const i=t(e);if(i===n.Continue)return r(e.parent,t);if(i===n.Abort)return;if(i===n.Found)return e;return i}function i(t){return r(t,(t=>e.isModuleDeclaration(t)?n.Found:n.Continue))}t.getParentCallExpression=function(t){return r(t,(t=>e.isCallExpression(t)?n.Found:e.isBlock(t)?n.Abort:n.Continue))},t.findCurrentCallArgIdx=function(e,t,n){let r=e.arguments.map((e=>e===t)).indexOf(!0);if(r>=0)return r;if(!(e.arguments.pos<=n&&n<e.end))return-1;if(0===e.arguments.length)return 0;r=0;for(let t of e.arguments){if(!(t.end<=n))break;r++}return e.arguments.hasTrailingComma||(r=Math.max(0,r-1)),r},function(e){e[e.Found=0]="Found",e[e.Continue=1]="Continue",e[e.Abort=2]="Abort"}(n=t.TraverseCheck||(t.TraverseCheck={})),t.traverseUp=r,t.enumMemberToQName=function(e,n){if(n.name.kind===t.SK.Identifier)return e.getFullyQualifiedName(e.getSymbolAtLocation(n.name))},t.findInnerMostNodeAtPosition=function n(r,i){for(let t of r.getChildren()){if(t.kind>=e.SyntaxKind.FirstPunctuation&&t.kind<=e.SyntaxKind.LastPunctuation)continue;let r=t.getStart(),s=t.getEnd();if(r<=i&&i<s)return n(t,i)}return r&&r.kind===t.SK.SourceFile?null:r},t.getParentNamespace=i,t.getCurrentNamespaces=function e(t){if(!t)return[];let n=i(t);if(!n)return[];let r=n.name.getText();return[...e(n.parent),r]},t.getEnumMembers=function(e,n){if(e&&n.symbol&&n.symbol.declarations&&n.symbol.declarations.length)for(let e=0;e<n.symbol.declarations.length;e++){const r=n.symbol.declarations[e];if(r.kind===t.SK.EnumDeclaration){return r.members}}},t.isExported=function(e){if(e.modifiers&&e.modifiers.some((e=>e.kind==t.SK.PrivateKeyword||e.kind==t.SK.ProtectedKeyword)))return!1;let n=e.symbol;if(!n)return!1;for(;;){let e=n.parent;if(!e)break;n=e}let r=n.valueDeclaration||n.declarations[0];return r.kind==t.SK.VariableDeclaration&&(r=r.parent.parent),!(!r.parent||r.parent.kind!=t.SK.SourceFile)},t.isReadonly=function(e){return e.modifiers&&e.modifiers.some((e=>e.kind==t.SK.ReadonlyKeyword))}}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){!function(t){const n=e.assembler.emitErr,r=n("opcode name doesn't match","<name>");class i extends e.assembler.Instruction{constructor(e,t,n){super(e,t,n,n,!1)}emit(t){let i=t.words;if(i[0]!=this.name)return r;let s=this.opcode,o=1,a=[],l=null,c=null;for(let r=0;r<this.args.length;++r){let u=this.args[r],d=i[o++];if("$"==u[0]){let r=this.ei.encoders[u],i=null;if(r.isImmediate||r.isLabel){if(!d)return n("expecting number",d);if(d=d.replace(/^#/,""),i=t.bin.parseOneInt(d),null==i)return n("expecting number",d)}else e.oops();if(null==i)return n("didn't understand it",d);e.U.assert(i>=0),11111!=i&&"$lbl"==u&&(i-=t.bin.location()+2,i>>=1),a.push(i);const o=i;if(i=r.encode(i),null==i)return n(`argument (${o}) out of range or mis-aligned`,d);"$i3"==u?i=c|i<<6:"$i5"==u&&(i=c|i<<8),"$i2"==u||"$i4"==u?c=i:"$rt"==u?(11111!=i&&i>4096&&e.U.oops("label: "+d+" v="+i),s=32768|i,"callrt.p"==this.name&&(s|=8192)):t.isLong||i<0||i>255?(t.isLong=!0,"$lbl"==u&&(i-=1),s=i>>9&65535|49152,l=this.opcode+(i<<7)&65535):s=this.opcode+(i<<7)&65535}else if(u!=d)return n("expecting "+u,d)}return i[o]?n("trailing tokens",i[o]):{stack:0,opcode:s,opcode2:l,numArgs:a,labelName:t.bin.normalizeExternalLabel(null)}}}t.VmInstruction=i,t.withPush={},t.opcodes=["stloc     $i1","ldloc     $i1","stfld     $i4, $i5","ldfld     $i4, $i5","newobj    $i1","ldcap     $i1","bitconv   $i1","stglb     $i1","ldglb     $i1","ldint     $i1","ldintneg  $i1","ldspecial $i1","ldnumber  $i1","ldlit     $i1","checkinst $i1","mapget","mapset","ret       $i2, $i3","popmany   $i1","pushmany  $i1","callind   $i1","callproc  $i1","calliface $i2, $i3","callget   $i1","callset   $i1","jmp       $lbl","jmpnz     $lbl","jmpz      $lbl","try       $lbl","push","pop"];class s extends e.assembler.AbstractProcessor{constructor(e){super(),this.addEnc("$i1","#0-8388607",(e=>this.inrange(8388607,e,e))),this.addEnc("$i2","#0-31",(e=>this.inrange(31,e,e))),this.addEnc("$i3","#0-262143",(e=>this.inrange(262143,e,e))),this.addEnc("$i4","#0-255",(e=>this.inrange(255,e,e))),this.addEnc("$i5","#0-32767",(e=>this.inrange(32767,e,e))),this.addEnc("$lbl","LABEL",(e=>this.inminmax(-4194304,4194303,e,e))).isLabel=!0,this.addEnc("$rt","SHIM",(e=>this.inrange(8388607,e,e))).isLabel=!0;let n=1,r=!0;for(let e of t.opcodes.concat(["callrt $rt"])){let s=new i(this,e,n);this.instructions[s.name]=[s],(r||"callrt"==s.name)&&(t.withPush[s.name]=!0,s=new i(this,e.replace(/\w+/,(e=>e+".p")),64|n),this.instructions[s.name]=[s]),"mapset.p"==s.name&&(r=!1),n++}}testAssembler(){}postProcessRelAddress(e,t){return t}postProcessAbsAddress(e,t){return t}getAddressFromLabel(e,t,n,r=!1){let i=e.lookupLabel(n);return null==i?null:t.is32bit?i:i-(e.pc()+2)}toFnPtr(e,t){return e}wordSize(){return 8}peephole(e,n,r){let i=e.getOp(),s="";if(n){s=n.getOp();let e=i+";"+s,t=this.file.peepCounts;t[e]=(t[e]||0)+1}"stloc"==i&&"ldloc"==s&&e.numArgs[0]==n.numArgs[0]?(/LAST/.test(n.text)&&e.update(""),n.update("")):t.withPush[i]&&"push"==s&&(e.update(e.text.replace(/\w+/,(e=>e+".p"))),n.update(""))}}t.VmProcessor=s}(e.vm||(e.vm={}))}(e.pxtc||(e.pxtc={}))}(ts||(ts={})),function(e){!function(e){let t;!function(e){e[e.NonLocal=0]="NonLocal",e[e.Global=1]="Global"}(t=e.VarModifier||(e.VarModifier={})),e.isIndex=function(e){return"Index"===e.kind},e.isSubscript=function(e){return"Subscript"===e.kind}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){var n=e.blocks;let r,i,s,o,a,l,c,u,d,p,h=0,f=0,m=0,_="???";function g(e){return null==e}function y(e){return null!=e}function b(t){return e.tickEvent("python.todo.statement",{kind:t.kind}),n.mkStmt(n.mkText("TODO: "+t.kind))}function v(t){return e.tickEvent("python.todo.expression",{kind:t.kind}),n.mkText(" {TODO: "+t.kind+"} ")}const T=L({primType:"string"}),k=L({primType:"number"}),E=L({primType:"boolean"}),x=L({primType:"void"}),S=L({primType:"any"});let C;const I={str:T,string:T,number:k,bool:E,void:x,any:S};function A(e){switch(e){case ts.SyntaxKind.StringKeyword:return T;case ts.SyntaxKind.NumberKeyword:return k;case ts.SyntaxKind.BooleanKeyword:return E;case ts.SyntaxKind.VoidKeyword:return x;case ts.SyntaxKind.AnyKeyword:return S;default:return C}}function w(t){let n=e.U.flatClone(t);return delete n.pyAST,delete n.pyInstanceType,delete n.pyRetType,delete n.pySymbolType,delete n.moduleTypeMarker,delete n.declared,n.parameters&&(n.parameters=n.parameters.map((t=>(delete(t=e.U.flatClone(t)).pyType,t)))),n}function N(t){if("("==t[0]&&e.U.endsWith(t,")"))return N(t.slice(1,-1));const n=t.indexOf(" => ");if(n>0){const e=t.slice(n+4);if(-1==e.indexOf(")[]")){const r=N(e),i=t.slice(1,n-1);return M(r,(i?i.split(/, /):[]).map((e=>N(e.replace(/\w+\??: /,"")))))}}if(e.U.endsWith(t,"[]"))return P(N(t.slice(0,-2)));if("_py.Array"===t)return P(S);const r=e.U.lookup(I,t);if(r)return r;if(!!t&&!isNaN(t))return k;if("T"==t||"U"==t)return L({primType:"'"+t});if(t.indexOf("|")>=0){return L({primType:"@union",typeArgs:t.split("|").map((e=>e.trim())).map(N)})}let i=O(t+"@type")||O(t);return i?7==i.kind?k:8==i.kind||9==i.kind?i.pyInstanceType||L({classType:i}):6==i.kind?k:(J(null,9502,e.U.lf("'{0}' is not a type near '{1}'",t,_||"???")),L({primType:t})):(J(null,9501,e.U.lf("unknown type '{0}' near '{1}'",t,_||"???")),L({primType:t}))}function D(t){var n;if(!t.pySymbolType){if(_=t.pyQName,t.parameters){pxtc.service.isTaggedTemplate(t)&&(t.parameters=[{name:"literal",description:"",type:"string",options:{}}]);for(let e of t.parameters)e.pyType||(e.pyType=N(e.type))}const r=t.pyRetType;if(ge(t))t.pyRetType=L({moduleType:t});else if(t.retType)if((null===(n=t.qName)||void 0===n?void 0:n.endsWith(".__constructor"))&&"void"===t.retType){const e=R(t.qName.substring(0,t.qName.lastIndexOf(".")));t.pyRetType=e?L({classType:e}):N(t.retType)}else t.pyRetType=N(t.retType);else t.pyRetType||(e.U.oops("no type for: "+t.pyQName),t.pyRetType=L({}));if(r&&ee(t.pyAST,r,t.pyRetType),3==t.kind||1==t.kind){let n=t.parameters.map((e=>e.pyType));if(n.some(g))return J(null,9526,e.U.lf("function symbol is missing parameter types near '{1}'",_||"???")),L({});t.pySymbolType=M(t.pyRetType,n.filter(y))}else t.pySymbolType=t.pyRetType;8!=t.kind&&9!=t.kind||(t.pyInstanceType=L({classType:t})),_=void 0}return t.pySymbolType}function O(t){return e.U.lookup(i,t)||e.U.lookup(r,t)}function R(e){var t;if(!e)return;let n=O(e);if(n)D(n);else if(e.indexOf(".")&&!e.endsWith(".__constructor")){const n=e.substring(0,e.lastIndexOf(".")),r=R(n);if(8===(null==r?void 0:r.kind)&&(null===(t=r.extendsTypes)||void 0===t?void 0:t.length))return R(r.extendsTypes[0]+e.substring(n.length))}return n}function L(t={}){let n=e.U.flatClone(t);return n.tid=++f,n}function P(e){return L({primType:"@array",typeArgs:[e]})}function M(e,t){return L({primType:"@fn"+t.length,typeArgs:[e].concat(t)})}function F(t){return!!e.U.startsWith(t.primType||"","@fn")}function $(t){return!!t.primType&&!e.U.startsWith(t.primType,"@")}function B(t){return!!e.U.startsWith(t.primType||"","@union")}function U(){return s.currFun||s.currClass||s.currModule}function V(){let e=U();for(;e&&e.parent;)e=e.parent;return e}function H(){return"main"==s.currModule.name&&!s.currFun&&!s.currClass}function G(t,n,r){const i=R(n);return i||J(t,9503,e.U.lf("No module named '{0}'",n)),i}function j(e,n,r,i){i||(i=U());let s=i.vars[e],o=null==s?void 0:s.symbol;if(!o){let n=W(i);n&&(n+=".");let a=n+e;o="ClassDef"===i.kind?oe(2,a):!ae(i)||r!==t.VarModifier.Global&&r!==t.VarModifier.NonLocal?ae(i)?se(4,e):oe(4,a):oe(4,e),s={symbol:o,modifier:r},i.vars[e]=s}for(let e of Object.keys(n))o[e]=n[e];return s}function K(e){return e.unifyWith?(e.unifyWith=K(e.unifyWith),e.unifyWith):e}function W(e){let t=e,n="";t.parent&&"FunctionDef"!==t.parent.kind&&"AsyncFunctionDef"!==t.parent.kind&&(n=W(t.parent),n?n+=".":n="");let r=e;return"Module"==e.kind&&"main"==r.name?"":r.name?n+r.name:n+"?"+e.kind}function z(t){let n=e.U.lookup(Ie,t);if(n)return n;for(let n of e.U.values(s.currModule.vars)){let r=n.symbol;if(r.isImport){if(r.expandsTo==t)return r.pyName||J(null,9553,lf("missing pyName")),r.pyName;if(r.isImport&&e.U.startsWith(t,(r.expandsTo||"")+"."))return r.pyName+t.slice(r.expandsTo.length)}}return t}function q(e){return(e=K(e)).primType?e.typeArgs&&"@array"==e.primType?q(e.typeArgs[0])+"[]":F(e)&&e.typeArgs?"("+e.typeArgs.slice(1).map((e=>"_: "+q(e))).join(", ")+") => "+q(e.typeArgs[0]):B(e)&&e.typeArgs?e.typeArgs.map(q).join(" | "):e.primType+"":e.classType&&e.classType.pyQName?z(e.classType.pyQName)+"":e.moduleType&&e.moduleType.pyQName?z(e.moduleType.pyQName)+"":"any"}function J(e,t,n){l.push(function(e,t,n,r){return e||(e=o),e&&s&&s.currModule?{fileName:a,start:e.startPos,length:e.endPos-e.startPos,line:void 0,column:void 0,code:n,category:t,messageText:r}:{fileName:a,start:0,length:0,line:void 0,column:void 0,code:n,category:t,messageText:r}}(e,pxtc.DiagnosticCategory.Error,t,n))}function Y(e){return e.primType?e.primType:e.classType?e.classType:e.moduleType?(e.moduleType.moduleTypeMarker||(e.moduleType.moduleTypeMarker={}),e.moduleType.moduleTypeMarker):null}function X(e){return!Y(K(e))}function Q(t,n,r){var i;(n=K(n)).classType!=r&&(X(n)?n.classType=r:ee(t,n,(D(i=r),i.pyInstanceType||J(null,9527,e.U.lf("Instance type symbol '{0}' is missing pyInstanceType",i)),i.pyInstanceType)))}function Z(e,t){ee(e,_e(e),t)}function ee(t,n,r){if(n===r)return;if((n=K(n))===(r=K(r))||ie(n)||ie(r))return;if("any"===n.primType)return void(n.unifyWith=r);const i=Y(n),s=Y(r);if(i&&s)if(i===s){if(n.unifyWith=r,n.typeArgs&&r.typeArgs)for(let e=0;e<Math.min(n.typeArgs.length,r.typeArgs.length);++e)ee(t,n.typeArgs[e],r.typeArgs[e]);n.unifyWith=r}else!function(t,n,r){J(t,9500,e.U.lf("types not compatible: {0} and {1}",q(n),q(r)))}(t,n,r);else i&&!s?ee(t,r,n):(m++,n.unifyWith=r)}function te(e,t){const n=K(e),r=K(t);if(n===r)return!0;const i=Y(n),s=Y(r);if(i===s)return!0;if(i&&s){if(re(i)&&re(s)&&i.extendsTypes&&i.extendsTypes.length&&i.extendsTypes.some((e=>e===s.qName)))return!0;if(B(r)){for(let e of r.typeArgs||[])if(te(n,e))return!0;return!1}}return!1}function ne(e,t){const n=K(_e(e)),r=K(t);te(n,r)||(F(n)||F(r)||$(n)||$(r))&&ee(e,n,r)}function re(e){return!!(null==e?void 0:e.name)}function ie(e){var t;return!!(null===(t=null==e?void 0:e.primType)||void 0===t?void 0:t.startsWith("'"))}function se(e,t){let n=/(.*)\.(.*)/.exec(t),r=n?n[2]:t;return{kind:e,name:r,pyName:r,qName:t,pyQName:t,namespace:n?n[1]:"",attributes:{},pyRetType:L()}}function oe(t,n){let r=i[n];return r?(r.kind=t,r):(r=se(t,n),r.pyQName||J(null,9527,e.U.lf("Symbol '{0}' is missing pyQName",n)),i[r.pyQName]=r,r)}function ae(e){let t=e;for(;t;){if("FunctionDef"==t.kind)return!0;t=t.parent}return!1}function le(t,n,r){if(!n.symInfo){let i=W(n);e.U.endsWith(i,".__init__")&&(i=i.slice(0,-9)+".__constructor"),ae(r=r||U())?n.symInfo=se(t,i):n.symInfo=oe(t,i);const s=n.symInfo;s.pyAST=n,s.pyName||J(null,9528,e.U.lf("Symbol '{0}' is missing pyName",s.qName||s.name)),r.vars[s.pyName]={symbol:s}}return n.symInfo}function ce(t){let n=t.symInfo.qName;return e.U.values(i).filter((e=>e.namespace==n&&2==e.kind))}function ue(t,n,r,i=!1,s=!1){let o;o="__init__"===n?t.pyQName+".__constructor":n.startsWith(t.pyQName+".")?n:t.pyQName+"."+n;let a=R(o);if(a)return a;if(!s)for(let i of t.extendsTypes||[]){let s=R(i);if(s){s==t&&e.U.userError("field lookup loop on: "+s.qName+" / "+n);let i=ue(s,n,r,!0);if(i)return i}}if(!i&&t.pyAST&&"ClassDef"==t.pyAST.kind){let e=oe(2,o);return e.isInstance=!r,e}return null}function de(t,n,r=!1){const i=_e(t),o=function(e){let t=K(e);return[t.classType,...pe(t.primType),t.moduleType].filter(y)}(i);for(let l of o){let o=!!i.moduleType,c=ue(l,n,o,r);if(c)return o?c.isInstance&&J(null,9505,e.U.lf("the field '{0}' of '{1}' is not static",n,l.pyQName)):Ke(t)?c.isProtected=!0:"Name"==(a=t).kind&&"self"==a.id&&(s.currClass||J(null,9529,e.U.lf("no class context found for {0}",c.pyQName)),c.namespace!=s.currClass.symInfo.qName&&(c.isProtected=!0)),c}var a;return null}function pe(e){let t=[];return"@array"==e?t=[O("_py.Array"),O("Array")]:"string"==e&&(t=[O("_py.String"),O("String")]),t.filter((e=>!!e))}function he(t){let n=U(),r=e.U.lookup(n.vars,t);if(r)return r;for(;n;){let r=e.U.lookup(n.vars,t);if(r)return r;do{n=n.parent}while(n&&"ClassDef"==n.kind)}return null}function fe(e){if(!e)return null;const t=e.indexOf(".");if(t>0){const n=he(e.slice(0,t)),r=null==n?void 0:n.symbol;r&&r.pyQName!=r.pyName&&(e=r.pyQName+e.slice(t))}else{const t=he(e);if(t)return t}let n=R(e);return n?{symbol:n}:void 0}function me(e){var t;return null===(t=fe(e))||void 0===t?void 0:t.symbol}function _e(e){return e.tsType?K(e.tsType):(e.tsType=L(),e.tsType)}function ge(e){if(!e)return!1;switch(e.kind){case 5:case 9:case 8:case 6:return!0;default:return!1}}function ye(t){const n=e.U.flatClone(s);let r;try{r=t()}finally{s=n}return r}function be(e,t){return 0==t.length?n.mkText(""):n.mkGroup([n.mkText("/* TODO: "+e+" "),n.mkGroup(t),n.mkText(" */"),n.mkNewLine()])}function ve(e){let t=tt(e.value);return e.arg?n.mkInfix(n.mkText(e.arg),"=",t):n.mkGroup([n.mkText("**"),t])}function Te(n){if(!n)return L();let r=$e(n);if(r){let t=O(r+"@type")||O(r);if(t){if(D(t),6==t.kind)return k;if(t.pyInstanceType)return t.pyInstanceType}else if(I[r])return I[r];J(n,9506,e.U.lf("cannot find type '{0}'",r))}else if(t.isSubscript(n)){if("List"===$e(n.value)&&t.isIndex(n.slice)){return P(Te(n.slice.value))}}return J(n,9507,e.U.lf("invalid type syntax")),L({})}function ke(e){return e.pyName&&"_"==e.pyName[0]?e.isProtected?n.mkText("protected "):n.mkText("private "):n.mkText("")}const Ee={Sub:1,Div:1,Pow:1,LShift:1,RShift:1,BitOr:1,BitXor:1,BitAnd:1,FloorDiv:1,Mult:1},xe={Eq:1,NotEq:1,Lt:1,LtE:1,Gt:1,GtE:1},Se={Add:"+",Sub:"-",Mult:"*",MatMult:"Math.matrixMult",Div:"/",Mod:"%",Pow:"**",LShift:"<<",RShift:">>",BitOr:"|",BitXor:"^",BitAnd:"&",FloorDiv:"Math.idiv",And:"&&",Or:"||",Eq:"==",NotEq:"!=",Lt:"<",LtE:"<=",Gt:">",GtE:">=",Is:"===",IsNot:"!==",In:"py.In",NotIn:"py.NotIn"},Ce={Invert:"~",Not:"!",UAdd:"P+",USub:"P-"},Ie={"adafruit_bus_device.i2c_device.I2CDevice":"pins.I2CDevice"};function Ae(e){s.blockDepth++;const t=n.mkBlock(e.map(nt));return s.blockDepth--,t}function we(e){e.vars||(e.vars={},e.parent=U(),e.blockDepth=s.blockDepth)}function Ne(e,t=!1){return"any"===q(e)?t?n.mkText(": any"):n.mkText(""):n.mkText(": "+q(e))}function De(e,t){try{return ye(t)}catch(t){return console.log(t),n.mkStmt(be(`conversion failed for ${e.name||e.kind}`,[]))}}function Oe(e){if(!e||!e.pyAST)return!1;if("FunctionDef"!=e.pyAST.kind)return!1;const t=e.pyAST;return!(!t.callers||1!=t.callers.length)&&!t.callers[0].inCalledPosition}function Re(t,r=!1){return De(t,(()=>{var i,o,a,l;const c=!!s.currClass&&!s.currFun,u=H(),d=!!s.currFun;we(t);const p=me(W(t)),f=le(c?1:3,t);if(!r&&(p&&p.declared===h&&J(t,9520,lf("Duplicate function declaration")),f.declared=h,Oe(f)))return n.mkText("");c&&(f.isInstance=!0),s.currFun=t;let m="",_=t.name;let g=[be("decorators",t.decorator_list.filter((e=>"property"==$e(e)?(m="get",!1):"Attribute"!=e.kind||"setter"!=e.attr||"Name"!=e.value.kind||(_=e.value.id,m="set",!1))).map(tt))];if(t.body.length>=1&&"Raise"==t.body[0].kind&&(t.alwaysThrows=!0),c)if(s.currClass||J(t,9531,lf("method '{0}' is missing current class context",f.pyQName)),f.pyRetType||J(t,9532,lf("method '{0}' is missing a return type",f.pyQName)),"__init__"==t.name)g.push(n.mkText("constructor")),Q(t,f.pyRetType,s.currClass.symInfo);else{if("__get__"==_||"__set__"==_){let e=t.vars.value,n=null==e?void 0:e.symbol;if("__set__"==_&&n){let e=ue(s.currClass.symInfo,"__get__",!1);e&&e.pyAST&&"FunctionDef"==e.pyAST.kind&&ee(t,n.pyRetType,e.pyRetType)}_=_.replace(/_/g,"")}m||(m="_"==_[0]?f.isProtected?"protected":"private":"public",t.symInfo.isStatic&&(m+=" static")),g.push(n.mkText(m+" "),Ue(_))}else e.U.assert(!m),"_"==t.name[0]||u||r||d?g.push(n.mkText("function "),Ue(_)):g.push(n.mkText("export function "),Ue(_));let y="__init__"==t.name?void 0:t.returns?Te(t.returns):f.pyRetType;g.push(function(t,r){var i;const s=t.args;s.kwonlyargs.length&&J(t,9517,e.U.lf("keyword-only arguments not supported yet"));let o=s.args.slice();if(r?"self"!==(null===(i=o[0])||void 0===i?void 0:i.arg)?t.symInfo.isStatic=!0:o.shift():o.some((e=>"self"==e.arg))&&J(t,9519,e.U.lf("non-methods cannot have an argument called 'self'")),!t.symInfo.parameters){let r=s.defaults.length-o.length;t.symInfo.parameters=o.map((i=>{i.annotation||J(t,9519,e.U.lf("Arg '{0}' missing annotation",i.arg));let o=Te(i.annotation),a="";return r>=0&&(a=n.flattenNode([tt(s.defaults[r])]).output,ee(i,o,_e(s.defaults[r]))),r++,{name:i.arg,description:"",type:"",initializer:a,default:a,pyType:o}}))}let a=t.symInfo.parameters.map((r=>{let i=j(r.name,{isParam:!0}),s=null==i?void 0:i.symbol;r.pyType||J(t,9530,e.U.lf("parameter '{0}' missing pyType",r.name)),ee(t,D(s),r.pyType);let o=[Ue(r.name),Ne(r.pyType,!0)];return r.default&&o.push(n.mkText(" = "+r.default)),n.mkGroup(o)}));return s.vararg&&a.push(n.mkText("TODO *"+s.vararg.arg)),s.kwarg&&a.push(n.mkText("TODO **"+s.kwarg.arg)),n.H.mkParenthesizedExpression(n.mkCommaSep(a))}(t,c),y&&K(y)!=x?Ne(y):n.mkText("")),D(f);let b=t.body.map(nt);if("__init__"==t.name){if(s.currClass||J(t,9533,lf("__init__ method '{0}' is missing current class context",f.pyQName)),null===(i=s.currClass)||void 0===i?void 0:i.baseClass){const e=t.body[0],n=s.currClass.baseClass.pyQName+".__constructor";(null===(l=null===(a=null===(o=e.value)||void 0===o?void 0:o.func)||void 0===a?void 0:a.symbolInfo)||void 0===l?void 0:l.pyQName)!==n&&J(t,9575,lf("Sub classes must call 'super().__init__' as the first statement inside an __init__ method"))}for(let e of ce(s.currClass)){let t=e.pyAST;t&&t.value&&b.push(n.mkStmt(n.mkText(`this.${Fe(e.pyName)} = `),tt(t.value)))}}const v=ot(t);g.push(n.mkBlock(v.concat(b)));let T=n.mkGroup(g);return r?g[g.length-1].noFinalNewline=!0:T=n.mkStmt(T),T}))}const Le={FunctionDef:e=>Re(e),ClassDef:t=>De(t,(()=>{we(t);const r=le(8,t);e.U.assert(!s.currClass);let i=H();s.currClass=t,t.isNamespace=t.decorator_list.some((e=>"Name"==e.kind&&"namespace"==e.id));let o=t.isNamespace?[n.mkText("namespace "),Ue(t.name)]:[be("keywords",t.keywords.map(ve)),be("decorators",t.decorator_list.map(tt)),n.mkText(i?"class ":"export class "),Ue(t.name)];if(!t.isNamespace&&t.bases.length>0)if("Enum"==$e(t.bases[0]))t.isEnum=!0;else{o.push(n.mkText(" extends ")),o.push(n.mkCommaSep(t.bases.map(tt)));let e=function(e){let t=me(Be(e));return t&&t.pyAST&&"ClassDef"==t.pyAST.kind?t.pyAST:null}(t.bases[0]);if(e)t.baseClass=e.symInfo,r.extendsTypes=[e.symInfo.pyQName];else{const e=$e(t.bases[0]);if(e){const n=me(e),i=R(e);t.baseClass=n||i,t.baseClass&&(r.extendsTypes=[t.baseClass.pyQName])}}}const a=t.body.filter((e=>t.isNamespace||"FunctionDef"===e.kind)),l=t.isNamespace?[]:t.body.filter((e=>-1===a.indexOf(e)&&"Pass"!==e.kind));let c=Ae(a);o.push(c);let u=!1;if(l.length){u=!0;const e=Ae(l),r=n.mkStmt(n.mkGroup([n.mkText(`public static __init${t.name}() `),e]));c.children.unshift(r)}if(!t.isNamespace){const e=ce(t).map((e=>(e.pyName&&e.pyRetType||J(t,9535,lf("field definition missing py name or return type",e.qName)),e))),r=e.filter((e=>!e.isInstance)),i=e.filter((e=>e.isInstance)).map((e=>n.mkStmt(ke(e),Ue(e.pyName),Ne(e.pyRetType)))),s=r.map((e=>n.mkGroup([n.mkStmt(ke(e),n.mkText("static "),Ue(e.pyName),Ne(e.pyRetType)),ht(Fe(t.name),Fe(e.pyName),q(e.pyRetType))])));c.children=s.concat(i).concat(c.children)}return u&&(o=[n.mkStmt(n.mkGroup(o)),n.mkStmt(n.mkText(`${t.name}.__init${t.name}()`))]),n.mkStmt(n.mkGroup(o))})),Return:e=>{if(e.value){let t=s.currFun;return t&&(t.symInfo.pyRetType||J(e,9536,lf("function '{0}' missing return type",t.symInfo.pyQName)),Z(e.value,t.symInfo.pyRetType)),n.mkStmt(n.mkText("return "),tt(e.value))}return n.mkStmt(n.mkText("return"))},AugAssign:e=>{let t=Se[e.op];return t.length>3?n.mkStmt(n.mkInfix(tt(e.target),"=",n.H.mkCall(t,[tt(e.target),tt(e.value)]))):n.mkStmt(tt(e.target),n.mkText(" "+t+"= "),tt(e.value))},Assign:e=>Pe(e),AnnAssign:e=>Pe(e),For:t=>{if(e.U.assert(0==t.orelse.length),t.target.forTargetEndPos=t.endPos,Ve(t.iter,"range")){let e=t.iter,r=tt(t.target),i=Ue(Be(t.target));Z(t.target,k);let s=1==e.args.length?n.mkText("0"):tt(e.args[0]),o=tt(e.args[1==e.args.length?0:1]);if(e.args.length<=2)return n.mkStmt(n.mkText("for ("),n.mkInfix(r,"=",s),n.mkText("; "),n.mkInfix(i,"<",o),n.mkText("; "),n.mkPostfix([i],"++"),n.mkText(")"),Ae(t.body));let a="Num"===e.args[2].kind?e.args[2].n:void 0;if(null==a&&"UnaryOp"===e.args[2].kind){const t=e.args[2];"Num"===t.operand.kind&&("UAdd"===t.op?a=t.operand.n:"USub"===t.op&&(a=-t.operand.n))}if(void 0!==a){const l=a>0?"<":">";return n.mkStmt(n.mkText("for ("),n.mkInfix(r,"=",s),n.mkText("; "),n.mkInfix(i,l,o),n.mkText("; "),n.mkInfix(i,"+=",tt(e.args[2])),n.mkText(")"),Ae(t.body))}}if(h>1){const e=_e(t.target);Z(t.iter,_e(t.iter)==T?e:P(e))}return n.mkStmt(n.mkText("for ("),tt(t.target),n.mkText(" of "),tt(t.iter),n.mkText(")"),Ae(t.body))},While:t=>(e.U.assert(0==t.orelse.length),n.mkStmt(n.mkText("while ("),tt(t.test),n.mkText(")"),Ae(t.body))),If:t=>{let r=t=>{let i=[n.mkText("if ("),tt(t.test),n.mkText(")"),Ae(t.body)];return t.orelse.length&&(i[i.length-1].noFinalNewline=!0,1==t.orelse.length&&"If"==t.orelse[0].kind?(i.push(n.mkText(" else ")),e.U.pushRange(i,r(t.orelse[0]))):i.push(n.mkText(" else"),Ae(t.orelse))),i};return n.mkStmt(n.mkGroup(r(t)))},With:t=>{if(1==t.items.length&&function(e,t){let n=_e(e);return!(!n.classType||n.classType.pyQName!=t)||q(n)==t}(t.items[0].context_expr,"pins.I2CDevice")){let r=t.items[0],i=[],s=tt(r.context_expr);if(r.optional_vars){let e=$e(r.optional_vars);if(e){let o=j(e,{isLocal:!0}),a=null==o?void 0:o.symbol;e=Fe(e),i.push(n.mkStmt(n.mkText("const "+e+" = "),s)),a.pyRetType||J(t,9537,lf("function '{0}' missing return type",a.pyQName)),Z(r.context_expr,a.pyRetType),s=n.mkText(e)}}return i.push(n.mkStmt(n.mkInfix(s,".",n.mkText("begin()")))),e.U.pushRange(i,t.body.map(nt)),i.push(n.mkStmt(n.mkInfix(s,".",n.mkText("end()")))),n.mkGroup(i)}let r=[],i=t.items.map(((e,t)=>{let i="with"+t;if(e.optional_vars){let t=Be(e.optional_vars);j(t,{isLocal:!0}),i=Fe(t)}return r.push(n.mkStmt(n.mkText(i+".end()"))),n.mkStmt(n.mkText("const "+i+" = "),n.mkInfix(tt(e.context_expr),".",n.mkText("begin()")))}));return e.U.pushRange(i,t.body.map(nt)),e.U.pushRange(i,r),n.mkBlock(i)},Raise:e=>{let t,r=e.exc||e.cause;if(!r)return n.mkStmt(n.mkText("throw"));if(r&&"Call"==r.kind){let e=r;1==e.args.length&&(t=tt(e.args[0]))}return t||(t=n.mkGroup([n.mkText("`"),tt(r),n.mkText("`")])),n.mkStmt(n.H.mkCall("control.fail",[t]))},Assert:e=>(e.msg||J(e,9537,lf("assert missing message")),n.mkStmt(n.H.mkCall("control.assert",[e.test,e.msg].filter((e=>!!e)).map(tt)))),Import:e=>{for(let t of e.names)t.asname&&j(t.asname,{expandsTo:t.name}),G(e,t.name);return n.mkText("")},ImportFrom:e=>{let t=[];for(let r of e.names)if("*"==r.name)e.module||J(e,9538,lf("import missing module name")),j(e.module,{isImportStar:!0});else{let i=e.module+"."+r.name,s=R(i),o=r.asname||r.name;ge(s)?(j(o,{isImport:s,expandsTo:i}),t.push(n.mkStmt(n.mkText(`import ${Fe(o)} = ${i}`)))):j(o,{expandsTo:i})}return n.mkGroup(t)},ExprStmt:e=>{return"Str"==e.value.kind?((t=e.value.s).trim().split(/\n/).length<=1?t=t.trim():t+="\n",n.mkStmt(n.mkText("/** "+t+" */"))):n.mkStmt(tt(e.value));var t},Pass:e=>n.mkStmt(n.mkText("")),Break:e=>n.mkStmt(n.mkText("break")),Continue:e=>n.mkStmt(n.mkText("continue")),Delete:t=>(J(t,9550,e.U.lf("delete statements are unsupported")),b(t)),Try:e=>{let t=[n.mkText("try"),Ae(e.body.concat(e.orelse))];for(let r of e.handlers)t.push(n.mkText("catch ("),r.name?Ue(r.name):n.mkText("_")),r.type&&t.push(n.mkText("/* instanceof "),tt(r.type),n.mkText(" */")),t.push(n.mkText(")"),Ae(r.body));return e.finalbody.length&&t.push(n.mkText("finally"),Ae(e.finalbody)),n.mkStmt(n.mkGroup(t))},AsyncFunctionDef:t=>(J(t,9551,e.U.lf("async function definitions are unsupported")),b(t)),AsyncFor:t=>(J(t,9552,e.U.lf("async for statements are unsupported")),b(t)),AsyncWith:t=>(J(t,9553,e.U.lf("async with statements are unsupported")),b(t)),Global:r=>{const i=V();U();for(const n of r.names){e.U.lookup(i.vars,n)||J(r,9521,e.U.lf("No binding found for global variable"));j(n,{},t.VarModifier.Global).firstRefPos<r.startPos&&J(r,9522,e.U.lf("Variable referenced before global declaration"))}return n.mkStmt(n.mkText(""))},Nonlocal:r=>{const i=V(),s=U();for(const n of r.names){const o=st(n,s);o&&o!==i&&o.vars[n].modifier!==t.VarModifier.Global||J(r,9523,e.U.lf("No binding found for nonlocal variable"));j(n,{},t.VarModifier.NonLocal).firstRefPos<r.startPos&&J(r,9524,e.U.lf("Variable referenced before nonlocal declaration"))}return n.mkStmt(n.mkText(""))}};function Pe(t){let r,i,o,a;if("Assign"===t.kind){if(1!=t.targets.length)return J(t,9553,e.U.lf("multi-target assignment statements are unsupported")),b(t);a=t.targets[0],o=t.value,r=null,i=null}else{if("AnnAssign"!==t.kind)return t;a=t.target,o=t.value||null,r=t.annotation,i=Te(r),Z(a,i)}let l,c="",u=!!o&&Ve(o,"const"),d=$e(a)||"";if(H()||s.currClass||s.currFun||"_"==d[0]||(c="export "),d&&s.currClass&&!s.currFun){u=!(!o||!s.currClass.isNamespace);let e=ue(s.currClass.symInfo,d,!0);if(e||J(t,9544,lf("cannot get class field")),0==h)return n.mkText("/* skip for now */");e.pyRetType||J(t,9539,lf("function '{0}' missing return type",e.pyQName)),Z(a,e.pyRetType),e.isInstance=!1,s.currClass.isNamespace&&(c=`export ${u?"const":"let"} `)}if(!o)return J(t,9555,e.U.lf("unable to determine value of assignment")),b(t);if(Z(a,_e(o)),u)return j(Be(a),{}),/^static /.test(c)||/const/.test(c)||(c+="const "),n.mkStmt(n.mkText(c),n.mkInfix(tt(a),"=",tt(o)));if(!c&&"Tuple"==a.kind)return function(t,r,i){if(r.elts.filter((e=>"Name"!==e.kind)).length)return J(t,9556,e.U.lf("non-trivial tuple assignment unsupported")),b(t);const s=r.elts.map($e).map((e=>e?U().vars[e]:void 0));if(s.some((e=>void 0!==(null==e?void 0:e.modifier)))){const e=function(){const e=U();return void 0===e.nextHelperVariableId&&(e.nextHelperVariableId=0),"___tempvar"+e.nextHelperVariableId++}(),t=[n.mkStmt(n.mkInfix(n.mkGroup([n.mkText("let "),n.mkText(e)]),"=",tt(i)))];for(let i=0;i<s.length;i++){const s=o(r.elts[i]);t.push(n.mkStmt(n.mkInfix(s,"=",n.mkGroup([n.mkText(e),n.mkText(`[${i}]`)]))))}return n.mkGroup(t)}{let e=[n.mkText("let "),n.mkText("[")],t=r.elts.map((e=>e)).map((e=>o(e,!0)));return e.push(n.mkCommaSep(t)),e.push(n.mkText("]")),n.mkStmt(n.mkInfix(n.mkGroup(e),"=",tt(i)))}function o(e,t=!1){qe(e,"identifierCompletion"),_e(e);Xe(e);return Me(e,t)}}(t,a,o);if("Name"===a.kind){const e=U().vars[d],t=null==e?void 0:e.symbol;t&&4===t.kind&&void 0===e.modifier&&(void 0===e.firstAssignPos||e.firstAssignPos>a.startPos)&&(e.firstAssignPos=a.startPos,e.firstAssignDepth=s.blockDepth)}if(r&&i&&("NameConstant"===o.kind&&null===o.value||"List"===o.kind&&0===o.elts.length)){const e=q(i);l=n.mkInfix(tt(a),":",n.mkText(e))}return l||(l=tt(a)),n.mkStmt(n.mkText(c),n.mkInfix(l,"=",tt(o)))}function Me(e,t=!1){var r,i;let o=e.id,a=fe(o),l=null==a?void 0:a.symbol,c=U().vars[o],u=null==c?void 0:c.symbol;return void 0===e.isdef&&(!l||4===l.kind&&l!==u?(s.currClass&&!s.currFun?(e.isdef=!1,a=j(o,{})):(e.isdef=!0,a=j(o,{isLocal:!0})),l=a.symbol):e.isdef=!1,e.symbolInfo=l,e.tsType||J(e,9540,lf("definition missing ts type")),l.pyRetType||J(e,9568,lf("missing py return type")),ee(e,e.tsType,l.pyRetType)),e.isdef&&at(a,U())&&(e.isdef=!1),Qe(a,e),e.isdef&&!t?n.mkGroup([n.mkText("let "),Ue(o)]):!(null==l?void 0:l.namespace)||!(null==l?void 0:l.qName)||(null===(r=s.currClass)||void 0===r?void 0:r.isNamespace)&&(null===(i=s.currClass)||void 0===i?void 0:i.name)===(null==l?void 0:l.namespace)?Ue(o):Ue(l.qName)}function Fe(e){return n.isReservedWord(e)?e+"_":e||e}function $e(e){var t;if("Name"==e.kind){let t=e.id,n=he(t),r=null==n?void 0:n.symbol;if(r){if(r.expandsTo)return r.expandsTo;if(s.currClass&&!s.currFun&&!(null==n?void 0:n.modifier)&&r.qName)return r.qName}return t}if("Attribute"==e.kind){let t=$e(e.value);if(t)return t+"."+e.attr}if(Ke(e)&&(null===(t=s.currClass)||void 0===t?void 0:t.baseClass))return s.currClass.baseClass.qName}function Be(e){let t=$e(e);return t||J(null,9542,lf("Cannot get name of unknown expression kind '{0}'",e.kind)),t}function Ue(e){return"self"==e?n.mkText("this"):n.mkText(Fe(e))}function Ve(e,t){if("Call"!=e.kind)return!1;return $e(e.func)===t}function He(t,r,i){let s=Se[r];return e.U.assert(!!s),s.length>3?n.H.mkCall(s,[t,i]):n.mkInfix(t,s,i)}const Ge={memoryview:{n:"",t:C},const:{n:"",t:k},"micropython.const":{n:"",t:k}};const je=function(){let e={};return Object.keys(pxtc.ts2PyFunNameMap).forEach((t=>{let n=pxtc.ts2PyFunNameMap[t];if(n&&n.n){let r={n:t,t:A(n.t),scale:n.scale};e[n.n]=r}})),Object.keys(Ge).forEach((t=>{e[t]=Ge[t]})),e}();function Ke(e){return Ve(e,"super")&&0==e.args.length}function We(e){return e.type==n.NT.Prefix&&'"'==e.op[0]?n.mkText(n.backtickLit(JSON.parse(e.op))):e}function ze(e){return u&&e.startPos<=u.position&&u.position<=e.endPos}function qe(e,t){h>100&&u&&null==d&&(u.type==t||"symbol"==u.type)&&ze(e)&&(d=e,p=U())}function Je(e,t){if(t&&t.pyAST&&"FunctionDef"==t.pyAST.kind){let n=t.pyAST;n.callers||(n.callers=[]),n.callers.indexOf(e)<0&&n.callers.push(e)}}const Ye={BoolOp:e=>{let t=tt(e.values[0]);for(let n=1;n<e.values.length;++n)t=He(t,e.op,tt(e.values[n]));return t},BinOp:e=>{let t=function(e){if("Mod"==e.op&&"Str"==e.left.kind&&("Tuple"==e.right.kind||"List"==e.right.kind)){let t=e.left.s,r=e.right.elts;r=r.slice();let i=[n.mkText("`")];return t.replace(/([^%]+)|(%[\d\.]*([a-zA-Z%]))/g,((e,t,s,o)=>{if(t)i.push(n.mkText(t.replace(/[`\\$]/g,(e=>"\\"+e))));else{let e=r.shift(),t=e?tt(e):n.mkText("???");i.push(n.mkText("${"),t,n.mkText("}"))}return""})),i.push(n.mkText("`")),n.mkGroup(i)}return null}(e);if(t)return t;const r=tt(e.left),i=tt(e.right);return ut(e.left)&&ut(e.right)&&"Add"===e.op?n.H.extensionCall("concat",[r,i],!1):(t=He(r,e.op,i),Ee[e.op]&&(Z(e.left,k),Z(e.right,k),e.tsType||J(e,9570,lf("binary op missing ts type")),ee(e,e.tsType,k)),t)},UnaryOp:t=>{let r=Ce[t.op];return e.U.assert(!!r),n.mkInfix(null,r,tt(t.operand))},Lambda:t=>(J(t,9574,e.U.lf("lambda expressions are not supported yet")),v(t)),IfExp:e=>n.mkInfix(n.mkInfix(tt(e.test),"?",tt(e.body)),":",tt(e.orelse)),Dict:e=>{s.blockDepth++;const t=e.keys.map(((t,r)=>{const i=e.values[r];return void 0===t?v(e):n.mkStmt(n.mkInfix(tt(t),":",tt(i)),n.mkText(","))})),r=n.mkBlock(t);return s.blockDepth--,r},Set:e=>v(e),ListComp:e=>v(e),SetComp:e=>v(e),DictComp:e=>v(e),GeneratorExp:e=>{if(1==e.generators.length&&"Comprehension"==e.generators[0].kind){let t=e.generators[0];if(0==t.ifs.length)return ye((()=>{let r=Be(t.target);return j(r,{isParam:!0}),n.mkInfix(tt(t.iter),".",n.H.mkCall("map",[n.mkGroup([Ue(r),n.mkText(" => "),tt(e.elt)])]))}))}return v(e)},Await:e=>v(e),Yield:e=>v(e),YieldFrom:e=>v(e),Compare:e=>{if(1==e.ops.length&&("In"==e.ops[0]||"NotIn"==e.ops[0])){K(_e(e.comparators[0]))==T&&Z(e.left,T);let t=n.mkInfix(tt(e.comparators[0]),".",n.H.mkCall("indexOf",[tt(e.left)]));return n.mkInfix(t,"In"==e.ops[0]?">=":"<",n.mkText("0"))}let t=tt(e.left),r=tt(e.comparators[0]);const i=(e,i,s)=>{xe[e]&&dt(i)&&dt(s)&&n.flattenNode([t])!==n.flattenNode([r])&&(t=n.H.mkParenthesizedExpression(n.mkGroup([t,n.mkText(" as any")])),r=n.H.mkParenthesizedExpression(n.mkGroup([r,n.mkText(" as any")])))};i(e.ops[0],e.left,e.comparators[0]);let s=He(t,e.ops[0],r);for(let n=1;n<e.ops.length;++n)t=tt(e.comparators[n-1]),r=tt(e.comparators[n]),i(e.ops[n],e.comparators[n-1],e.comparators[n]),s=He(s,"And",He(t,e.ops[n],r));return s},Call:t=>{var r,i,o,a,l;t.func.inCalledPosition=!0;let c,h,f=$e(t.func),m=me(f),_=m&&8==m.kind,g=m,y="";if(_)g=me(m.pyQName+".__constructor"),g||(g=le(3,pt(null==m?void 0:m.pyAST)));else if("Attribute"==t.func.kind){let e=t.func;h=e.value,c=_e(h),(c.classType||c.primType)&&(y=e.attr,g=de(h,y,!0),g&&(y=g.name))}let b=t.args.slice();if("super"==f&&0==b.length)return s.currClass&&s.currClass.baseClass&&(t.tsType||J(t,9543,lf("call expr missing ts type")),Q(t,t.tsType,s.currClass.baseClass)),n.mkText("super");if(Ve(t,"int")&&1===b.length&&b[0]){const e=b[0],t=tt(e),r=_e(e);if("string"===r.primType)return n.mkGroup([n.mkText("parseInt"),n.mkText("("),t,n.mkText(")")]);if("number"===r.primType)return n.mkGroup([n.mkInfix(n.mkText("Math"),".",n.mkText("trunc")),n.mkText("("),t,n.mkText(")")])}if(!g){let t=e.U.lookup(je,f);if(t&&(y=""),y&&(f=q(c)+"."+y,t=e.U.lookup(je,f),t||"@array"!=Y(K(c))||(f="Array."+y,t=e.U.lookup(je,f))),y="",t)if("."==t.n[0]&&b.length){if(h=b.shift(),c=_e(h),y=t.n.slice(1),g=de(h,y),g&&2==g.kind)return n.mkInfix(tt(h),".",n.mkText(y))}else g=R(t.n)}if(Ve(t,"str"))return ee(t,t.tsType,T),n.mkInfix(n.mkText('""'),"+",tt(t.args[0]));const v="Attribute"===t.func.kind&&Ke(t.func.value);!g&&v&&(g=R(f));const k="__init__"===(null===(r=s.currFun)||void 0===r?void 0:r.name)&&"__constructor"===(null==g?void 0:g.name)&&(null===(o=null===(i=s.currClass)||void 0===i?void 0:i.baseClass)||void 0===o?void 0:o.pyQName)===(null==g?void 0:g.namespace)&&v;k&&(g=me((null===(l=null===(a=s.currClass)||void 0===a?void 0:a.baseClass)||void 0===l?void 0:l.pyQName)+".__constructor")),g||J(t,9508,e.U.lf("can't find called function '{0}'",f));let E,x=g?g.parameters:null,C=[];if(x){for(b.length>x.length&&J(t,9510,e.U.lf("too many arguments in call to '{0}'",g.pyQName));b.length<x.length;)b.push(null);b=b.slice(0,x.length);for(let n of t.keywords){let t=x.findIndex((e=>e.name==n.arg));t<0?J(n,9511,e.U.lf("'{0}' doesn't have argument named '{1}'",g.pyQName,n.arg)):null!=b[t]?J(n,9512,e.U.lf("argument '{0} already specified in call to '{1}'",n.arg,g.pyQName)):b[t]=n.value}for(let e=b.length-1;e>=0&&(x[e].initializer&&null==b[e]);e--)b.pop();for(let r=0;r<b.length;++r){let i=b[r];if(null!=i||x[r].initializer)if(i){x[r].pyType||J(t,9545,lf("formal arg missing py type"));const e=x[r].pyType;"any"!==e.primType&&ne(i,e),"Name"==i.kind&&Oe(i.symbolInfo)?C.push(Re(i.symbolInfo.pyAST,!0)):C.push(tt(i))}else x[r].initializer||J(t,9547,lf("formal arg missing initializer")),C.push(n.mkText(x[r].initializer));else J(t,9513,e.U.lf("missing argument '{0}' in call to '{1}'",x[r].name,g.pyQName)),C.push(n.mkText("null"))}}else g&&J(t,9509,e.U.lf("calling non-function")),C=b.map(tt);if(!d&&u&&"signature"==u.type&&ze(t)){d=t,p=U(),u.auxResult=0;for(let e=0;e<b.length;++e){u.auxResult=e;let t=b[e];if(!t)break;if(t.startPos<=u.position&&u.position<=t.endPos)break}}if(g)if(g.pyRetType||J(t,9549,lf("function missing pyRetType")),h&&ut(h)&&c?function(e,t,n){switch(t.qName){case"Array.pop":case"Array.removeAt":case"Array.shift":case"Array.find":case"Array.get":case"Array._pickRandom":Z(e,n.typeArgs[0]);break;case"Array.concat":case"Array.slice":case"Array.filter":case"Array.fill":Z(e,n);break;case"Array.reduce":if("Call"===e.kind&&e.args.length>1){const t=_e(e.args[1]);t&&Z(e,t)}break;case"Array.map":Z(e,P(S));break;default:Z(e,t.pyRetType)}}(t,g,c):Z(t,g.pyRetType),t.symbolInfo=g,g.attributes.py2tsOverride){const e=function(e){const t=new RegExp(/([^\$]*\()?([^\$\(]*)\$(\d)(?:(?:(?:=(\d+|'[a-zA-Z0-9_]*'|false|true|null|undefined))|(\?)|))/,"y"),n=[];let r,i=0;do{i=t.lastIndex,r=t.exec(e),r&&(r[1]&&n.push({kind:"text",text:r[1]}),n.push({kind:"arg",prefix:r[2],index:parseInt(r[3]),default:r[4],isOptional:!!r[5]}))}while(r);null!=i?n.push({kind:"text",text:e.substr(i)}):n.push({kind:"text",text:e});return{parts:n}}(g.attributes.py2tsOverride);if(e){y&&!h&&J(t,9550,lf("missing recv"));let r=function(e,t,r){const i=[];for(const r of e.parts)if("text"===r.kind)i.push(n.mkText(r.text));else if(t[r.index]||r.default)r.prefix&&i.push(n.mkText(r.prefix)),t[r.index]?i.push(t[r.index]):i.push(n.mkText(r.default));else if(!r.isOptional)return;if(r)return n.mkInfix(r,".",n.mkGroup(i));return n.mkGroup(i)}(e,C,y?tt(h):void 0);return r||J(t,9555,lf("buildOverride failed unexpectedly")),r}}else if(g.attributes.pyHelper)return n.mkGroup([n.mkInfix(n.mkText("_py"),".",n.mkText(g.attributes.pyHelper)),n.mkText("("),n.mkCommaSep(h?[tt(h)].concat(C):C),n.mkText(")")]);k?E=n.mkText("super"):y?(E=n.mkInfix(tt(h),".",n.mkText(y)),qe(t.func,"memberCompletion")):E=tt(t.func);let I=[E,n.mkText("("),n.mkCommaSep(C),n.mkText(")")];return g&&1==C.length&&pxtc.service.isTaggedTemplate(g)&&(I=[E,We(C[0])]),_&&(m&&m.pyQName||J(t,9551,lf("missing namedSymbol or pyQName")),I[0]=n.mkText(z(m.pyQName)),I.unshift(n.mkText("new "))),n.mkGroup(I)},Num:e=>(e.tsType||J(e,9556,lf("tsType missing")),ee(e,e.tsType,k),n.mkText(e.ns)),Str:e=>(e.tsType||J(e,9557,lf("tsType missing")),ee(e,e.tsType,T),n.mkText(n.stringLit(e.s))),FormattedValue:e=>v(e),JoinedStr:e=>v(e),Bytes:t=>n.mkText(`hex\`${e.U.toHex(new Uint8Array(t.s))}\``),NameConstant:e=>(null!==e.value&&(e.tsType||J(e,9558,lf("tsType missing")),ee(e,e.tsType,E)),n.mkText(JSON.stringify(e.value))),Ellipsis:e=>v(e),Constant:e=>v(e),Attribute:t=>{let r=tt(t.value),i=_e(t.value),s=de(t.value,t.attr),o=t.attr;if(qe(t,"memberCompletion"),s)t.symbolInfo=s,Je(t,s),t.tsType&&s.pyRetType||J(t,9559,lf("tsType or pyRetType missing")),ee(t,t.tsType,s.pyRetType),o=s.name;else if(i.moduleType){let n=R(i.moduleType.pyQName+"."+t.attr);n?(t.symbolInfo=n,Je(t,n),Z(t,D(n)),o=n.name):J(t,9514,e.U.lf("module '{0}' has no attribute '{1}'",i.moduleType.pyQName,t.attr))}else h>2&&J(t,9515,e.U.lf("unknown object type; cannot lookup attribute '{0}'",t.attr));return n.mkInfix(r,".",n.mkText(Fe(o)))},Subscript:e=>{if("Index"==e.slice.kind){const t=K(_e(e.value));if(ut(e.value)){Z(e,t.typeArgs[0])}else"string"===t.primType?Z(e,t):h>2&&X(_e(e))&&Z(e,S);let r=e.slice.value;return h>2&&X(_e(r))&&Z(r,k),n.mkGroup([tt(e.value),n.mkText("["),tt(r),n.mkText("]")])}if("Slice"==e.slice.kind){const t=_e(e.value);Z(e,t);let r=e.slice;if(r.step){const i="string"===(null==t?void 0:t.primType);return n.H.mkCall(i?"_py.stringSlice":"_py.slice",[tt(e.value),r.lower?tt(r.lower):n.mkText("null"),r.upper?tt(r.upper):n.mkText("null"),tt(r.step)])}return n.mkInfix(tt(e.value),".",n.H.mkCall("slice",[r.lower?tt(r.lower):n.mkText("0"),r.upper?tt(r.upper):null].filter(y)))}return v(e)},Starred:e=>n.mkGroup([n.mkText("... "),tt(e.value)]),Name:e=>{if(qe(e,"identifierCompletion"),"self"==e.id&&s.currClass)return e.tsType||J(e,9560,lf("missing tsType")),Q(e,e.tsType,s.currClass.symInfo),n.mkText("this");let t=Xe(e),r=null==t?void 0:t.symbol;if(r&&r.isImport)return Ue(r.name);if(Qe(t,e),e.ctx.indexOf("Load")>=0){if(!r)return Ue(Be(e));if(!(null==r?void 0:r.qName))return J(e,9561,lf("missing qName")),Ue("unknown");return Ue(r.qName.replace("@type",""))}return Me(e)},List:Ze,Tuple:Ze};function Xe(t){let n=fe(t.id),r=null==n?void 0:n.symbol;if(!n){let r=e.U.lookup(je,t.id);r&&(n=fe(r.n))}if(n&&r){if(t.symbolInfo=r,t.tsType||J(t,9562,lf("missing tsType")),ee(t,t.tsType,D(r)),r.isImport)return n;Je(t,r),t.forTargetEndPos&&n.forVariableEndPos!==t.forTargetEndPos&&(n.forVariableEndPos?n.lastRefPos=n.forVariableEndPos+1:n.forVariableEndPos=t.forTargetEndPos)}else h>0&&J(t,9516,e.U.lf("name '{0}' is not defined",t.id));return n}function Qe(e,n){if(e){if(e.modifier===t.VarModifier.Global){const t=V();t&&t.vars[e.symbol.name]&&(e=t.vars[e.symbol.name])}else if(e.modifier===t.VarModifier.NonLocal){const t=st(e.symbol.name,U());t&&(e=t.vars[e.symbol.name])}(void 0===e.firstRefPos||e.firstRefPos>n.startPos)&&(e.firstRefPos=n.startPos),(void 0===e.lastRefPos||e.lastRefPos<n.startPos)&&(e.lastRefPos=n.startPos)}}function Ze(e){return e.tsType||J(e,9563,lf("missing tsType")),ee(e,e.tsType,P(e.elts[0]?_e(e.elts[0]):L())),n.mkGroup([n.mkText("["),n.mkCommaSep(e.elts.map(tt)),n.mkText("]")])}function et(e){return`${e.startPos}:${e.endPos}`}function tt(t){o=t;let n=Ye[t.kind];n||e.U.oops(t.kind+" - unknown expr"),_e(t);const r=n(t);return r.id=et(t),r}function nt(t){o=t;let r=Le[t.kind];r||e.U.oops(t.kind+" - unknown stmt");let i=(t._comments||[]).map((e=>e.value)),s=r(t);return i.length&&(s=n.mkGroup(i.map((e=>n.mkStmt(n.H.mkComment(e)))).concat(s))),s.id=et(t),s}function rt(e){return!e||(e.type==n.NT.Prefix&&""==e.op?e.children.every(rt):e.type==n.NT.NewLine)}function it(e){const t=Ue(e.name),r=q(D(e));return n.mkStmt(n.mkGroup([n.mkText("let "),t,n.mkText(": "+r+";")]))}function st(e,n){if(!n)return;const r=n.vars&&n.vars[e];return r&&r.modifier!=t.VarModifier.NonLocal?n:st(e,n.parent)}function ot(e){const t=[];let n;for(const r of Object.keys(e.vars))n=e.vars[r],at(n,e)&&t.push(it(null==n?void 0:n.symbol));return t}function at(e,t){return!!(4===e.symbol.kind&&!e.symbol.isParam&&void 0===e.modifier&&(e.lastRefPos>e.forVariableEndPos||e.firstRefPos<e.firstAssignPos||e.firstAssignDepth>t.blockDepth)&&!(function(e){return"Module"===e.kind&&"main"===e.name}(t)&&0===e.firstAssignDepth))}function lt(t){if(e.U.assert("Module"==t.kind),t.tsBody)return;var r;s={currClass:void 0,currFun:void 0,currModule:r=t,blockDepth:0},a=r.tsFilename.replace(/\.ts$/,".py"),t.vars||(t.vars={});let i=ot(t).concat(t.body.map(nt));return i.every(rt)?void 0:"main"==t.name?i:[n.mkText("namespace "+t.name+" "),n.mkBlock(i)]}function ct(e){h=e,l=[],m=0,o=void 0}function ut(e){const t=K(_e(e));return t&&"@array"===t.primType}function dt(e){switch(e.kind){case"Num":case"Str":return!0;case"NameConstant":return null!==e.value}return!1}function pt(e,t=e.symInfo){var n;const r=O(t.pyQName+".__constructor");if(!r&&(null===(n=t.extendsTypes)||void 0===n?void 0:n.length)){const n=me(t.extendsTypes[0])||R(t.extendsTypes[0]);if(n)return pt(e,n)}const i={kind:"FunctionDef",name:"__init__",startPos:e.startPos,endPos:e.endPos,parent:e,body:[],args:{kind:"Arguments",startPos:0,endPos:0,args:[{startPos:0,endPos:0,kind:"Arg",arg:"self"}],kw_defaults:[],kwonlyargs:[],defaults:[]},decorator_list:[],vars:{},symInfo:se(3,e.symInfo.qName+".__constructor")};return i.symInfo.parameters=[],i.symInfo.pyRetType=L({classType:e.symInfo}),r&&(i.args.args.push(...r.parameters.map((e=>({startPos:0,endPos:0,kind:"Arg",arg:e.name})))),i.symInfo.parameters.push(...r.parameters.map((e=>{if(e.pyType)return e;return Object.assign(Object.assign({},e),{pyType:N(e.type)})})))),i}function ht(e,t,r){const i=`___${t}_is_set`,s=`___${t}`;return n.mkStmt(n.mkStmt(n.mkText(`private ${i}: boolean`)),n.mkStmt(n.mkText(`private ${s}: ${r}`)),n.mkStmt(n.mkText(`get ${t}(): ${r}`),n.mkBlock([n.mkText(`return this.${i} ? this.${s} : ${e}.${t}`)])),n.mkStmt(n.mkText(`set ${t}(value: ${r})`),n.mkBlock([n.mkStmt(n.mkText(`this.${i} = true`)),n.mkStmt(n.mkText(`this.${s} = value`))])))}t.py2ts=function(s){let o=[];const h={};l=[],e.U.assert(!!s.sourceFiles,"missing sourceFiles! Cannot convert py to ts");let f=s.sourceFiles.filter((t=>e.U.endsWith(t,".py")));if(0==f.length)return{outfiles:h,diagnostics:l,success:0===l.length,sourceMap:[]};let _=(e,t)=>e.substr(0,e.length-t.length),g=e.U.toDictionary(f,(e=>_(e,".py"))),y=s.sourceFiles.filter((t=>e.U.endsWith(t,".ts"))).filter((e=>_(e,".ts")in g));e.U.assert(!!s.apisInfo,"missing apisInfo! Cannot convert py to ts"),a=f[0],function(t,n){i={},r={};let s=e.U.toDictionary(n,(e=>e));for(let n of e.U.values(t.byQName)){if(s.hasOwnProperty(n.fileName))continue;let t=n;t.extendsTypes&&(t.extendsTypes=t.extendsTypes.filter((e=>e!=t.qName))),t.pyQName&&t.qName||J(null,9526,e.U.lf("Symbol '{0}' is missing qName for '{1}'",t.name,t.pyQName?"ts":"py")),r[t.pyQName]=t,r[t.qName]=t}C=N("Buffer")}(s.apisInfo,y),c=s,u=void 0,s.generatedFiles||(s.generatedFiles=[]);for(const t of f){let n=t,r=t.replace(/\.py$/,"").replace(/.*\//,""),i=s.fileSystem[t];try{a=t;let s=e.py.lex(i),c=e.py.parse(i,n,s);e.U.pushRange(l,c.diagnostics),o.push({kind:"Module",body:c.stmts,blockDepth:0,name:r,source:i,tsFilename:n.replace(/\.py$/,".ts")})}catch(e){console.log("Parse error",e)}}const b=l;for(let e=0;e<5;++e){ct(e);for(let e of o)try{lt(e)}catch(e){console.log("Conv pass error",e)}if(0==m)break}ct(1e3),d=void 0,u=s.syntaxInfo||{position:0,type:"symbol"};let v=[];for(let e of o)try{let t=lt(e);if(!t)continue;let r=n.flattenNode(t);function T(e){let t=e.id.split(":");if(2!=t.length)return;let n=t.map((e=>parseInt(e)));return{py:{startPos:n[0],endPos:n[1]},ts:{startPos:e.startPos,endPos:e.endPos}}}s.sourceFiles.push(e.tsFilename),s.generatedFiles.push(e.tsFilename),s.fileSystem[e.tsFilename]=r.output,h[e.tsFilename]=r.output,v=r.sourceMap.map(T).filter((e=>!!e))}catch(e){console.log("Conv error",e)}l=b.concat(l);let k={};const E=e.U.values(r).concat(e.U.values(i));let x=[];const S=e=>{if((e=>{switch(e.kind){case 6:case 7:case 4:case 3:case 5:return!0;case 2:case 1:return!e.isInstance;default:return!1}})(e)&&x.indexOf(e)<0){let t=w(e);k[t.qName||t.name]=t}};for(let t=p;t;t=t.parent)t&&t.vars&&e.U.values(t.vars).map((e=>e.symbol)).forEach(S);if(E.forEach(S),u&&d){if(d=d,u.beginPos=d.startPos,u.endPos=d.endPos,u.symbols||(u.symbols=[]),x=u.symbols.slice(),"memberCompletion"==u.type&&"Attribute"==d.kind){const e=_e(d.value);if(e.moduleType)for(let t of E)t.isInstance||t.namespace!=e.moduleType.qName||u.symbols.push(t);else if(e.classType||e.primType){const t=e.classType||pe(e.primType).reduce(((e,t)=>e||t),null);if(t){t.extendsTypes&&t.qName||J(null,9567,lf("missing extendsTypes or qName"));let e=t.extendsTypes.concat(t.qName);for(let t of E)t.isInstance&&e.indexOf(t.namespace)>=0&&u.symbols.push(t)}}}else if("identifierCompletion"==u.type)u.symbols=e.U.values(k);else{let e=d.symbolInfo;e&&u.symbols.push(e)}u.symbols=u.symbols.map(w)}let I=function(){for(let e of l)t.patchPosition(e,s.fileSystem[e.fileName]);return l}();return{outfiles:h,success:0===I.length,diagnostics:I,syntaxInfo:u,globalNames:k,sourceMap:v}}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){let n;!function(e){e[e.Id=0]="Id",e[e.Op=1]="Op",e[e.Keyword=2]="Keyword",e[e.Number=3]="Number",e[e.String=4]="String",e[e.NewLine=5]="NewLine",e[e.Comment=6]="Comment",e[e.Indent=7]="Indent",e[e.Dedent=8]="Dedent",e[e.EOF=9]="EOF",e[e.Error=10]="Error"}(n=t.TokenType||(t.TokenType={})),t.keywords={False:!0,None:!0,True:!0,and:!0,as:!0,assert:!0,async:!0,await:!0,break:!0,class:!0,continue:!0,def:!0,del:!0,elif:!0,else:!0,except:!0,finally:!0,for:!0,from:!0,global:!0,if:!0,import:!0,in:!0,is:!0,lambda:!0,nonlocal:!0,not:!0,or:!0,pass:!0,raise:!0,return:!0,try:!0,while:!0,with:!0,yield:!0};let r,i,s=[];const o={"%":"Mod","&":"BitAnd","*":"Mult","**":"Pow","+":"Add","-":"Sub","/":"Div","//":"FloorDiv","<<":"LShift",">>":"RShift","@":"MatMult","^":"BitXor","|":"BitOr"},a={"!":"Bang","!=":"NotEq","(":"LParen",")":"RParen",",":"Comma","->":"Arrow",".":"Dot",":":"Colon",";":"Semicolon","<":"Lt","<=":"LtE","=":"Assign","==":"Eq",">":"Gt",">=":"GtE","[":"LSquare","]":"RSquare","{":"LBracket","}":"RBracket","~":"Invert"},l={b:/^[_0-1]$/,B:/^[_0-1]$/,o:/^[_0-7]$/,O:/^[_0-7]$/,x:/^[_0-9a-fA-F]$/,X:/^[_0-9a-fA-F]$/},c={b:2,B:2,o:8,O:8,x:16,X:16};let u,d,p=0,h=0;function f(e,t){let n=0,r=0;for(let i=0;i<e;++i)10==t.charCodeAt(i)&&(n++,r=i);return{line:n,column:e-r-1}}function m(e){switch(e.type){case n.Id:return`id(${e.value})`;case n.Op:return"'"+i[e.value]+"'";case n.Keyword:return e.value;case n.Number:return`num(${e.value})`;case n.String:return e.stringPrefix+JSON.stringify(e.value);case n.NewLine:return"<nl>";case n.Comment:return`/* ${e.value} */`;case n.Indent:return"indent"+e.value;case n.Dedent:return"dedent";case n.Error:return`[ERR: ${e.value}]`;case n.EOF:return"End of file";default:return"???"}}t.position=f,t.patchPosition=function(e,t){if(!e.start&&!e.length)return e.start=0,e.length=0,e.line=0,void(e.column=0);let n=f(e.start,t);e.line=n.line,e.column=n.column,e.length>0&&(n=f(e.start+e.length-1,t),e.endLine=n.line,e.endColumn=n.column+2)},t.tokenToString=m,t.friendlyTokenToString=function(e,t){let n=e.endPos-e.startPos,r="";return r=0==n?m(e):n>20?"`"+t.slice(e.startPos,e.startPos+20)+"`...":"`"+t.slice(e.startPos,e.endPos)+"`",r=r.replace(/\r/g,"").replace(/\n/g,"\\n").replace(/\t/g,"\\t"),r},t.tokensToString=function(e){let t="",r=0;for(let i of e){let e=m(i);r+e.length>70&&(r=0,t+="\n"),0!=r&&(t+=" "),t+=e,r+=e.length,i.type!=n.NewLine&&i.type!=n.Comment||(r=0,t+="\n")}return t},t.lex=function(f){for(0==s.length&&function(){const n={'"':k,"'":k,"#":C,"\\":S,".":A};r=e.U.clone(a);for(let e of Object.keys(o))r[e]=o[e],r[e+"="]=o[e]+"Assign";i={};for(let e of Object.keys(r))i[r[e]]=e;for(let e=0;e<128;++e)if(t.rx.isIdentifierStart(e))s[e]=g;else{let i=String.fromCharCode(e);if(n.hasOwnProperty(i))s[e]=n[i];else if(r.hasOwnProperty(i)){let t=!1,n=r[i];for(let e of Object.keys(r))e!=i&&e.startsWith(i)&&(t=!0);s[e]=t?()=>b(n):()=>y(n)}else t.rx.isSpace(e)?s[e]=()=>{}:13==e?s[e]=()=>{10==d.charCodeAt(p)&&p++,E()}:t.rx.isNewline(e)?s[e]=E:w(e)?s[e]=I:s[e]=N}}(),d=f,u=[],p=0,h=0,x();p<d.length;){h=p;const e=d.charCodeAt(p++);e<128?s[e]():t.rx.isIdentifierStart(e)?g():t.rx.isSpace(e)||(t.rx.isNewline(e)?E():N())}return h=p,E(),m(n.EOF,""),u;function m(e,t,n){let r={type:e,value:t,startPos:h,endPos:p,auxValue:n};return u.push(r),r}function _(e){m(n.Error,e)}function g(){for(;t.rx.isIdentifierChar(d.charCodeAt(p));)p++;let e=d.slice(h,p),r=d.charCodeAt(p);t.keywords.hasOwnProperty(e)?m(n.Keyword,e):34==r||39==r?T(e):m(n.Id,e)}function y(e){m(n.Op,e)}function b(e){let t=d.slice(h,p+1);if(2==t.length&&r.hasOwnProperty(t)){let n=d.slice(h,p+2);3==n.length&&r.hasOwnProperty(n)?(p+=2,e=r[n]):(p++,e=r[t])}y(e)}function v(e){switch(e){case 97:return 7;case 98:return 8;case 102:return 12;case 110:return 10;case 114:return 13;case 116:return 9;case 118:return 11;default:return 0}}function T(r){const i=d.charCodeAt(p++);let s=!1;d.charCodeAt(p)==i&&d.charCodeAt(p+1)==i&&(p+=2,s=!0);let o=(r=r.toLowerCase()).indexOf("r")>=0,a="",l="";for(;;){const n=d.charCodeAt(p++);if(n==i){if(!s)break;if(d.charCodeAt(p)==i&&d.charCodeAt(p+1)==i){p+=2;break}l+="\\"+String.fromCharCode(i),a+=String.fromCharCode(i)}else if(92==n){let n=d.charCodeAt(p++);if(13==n&&10==d.charCodeAt(p)&&(n=10,p++),34==n||39==n||92==n)o&&(l+="\\",a+="\\"),l+="\\"+String.fromCharCode(n),a+=String.fromCharCode(n);else if(!o&&v(n))l+="\\"+String.fromCharCode(n),a+=String.fromCharCode(v(n));else if(t.rx.isNewline(n))o&&(a+="\\"+String.fromCharCode(n),l+="\\\\",l+=10==n?"\\n":"\\u"+("0000"+n.toString(16)).slice(-4));else if(o||48!=n)if(o||117!=n&&120!=n)l+="\\\\"+String.fromCharCode(n),a+="\\"+String.fromCharCode(n);else{let t=117==n?4:2,r=d.slice(p,p+t);p+=t;let i=parseInt(r,16);isNaN(i)&&_(e.U.lf("invalid unicode or hex escape")),l+="\\"+String.fromCharCode(n)+r,a+=String.fromCharCode(i)}else l+="\\\\x00",a+="\0"}else{if(isNaN(n)){_(e.U.lf("end of file in a string"));break}if(t.rx.isNewline(n)&&!s){_(e.U.lf("new line in a string"));break}a+=String.fromCharCode(n),l+=String.fromCharCode(n)}}let c=m(n.String,a);c.quoted=l,c.stringPrefix=r}function k(){p--,T("")}function E(){m(n.NewLine,""),x()}function x(){let e=0;for(;;){const t=d.charCodeAt(p);if(9!=t){if(32!=t)break;e++,p++}else e=e+8&-8,p++}m(n.Indent,""+e)}function S(){let n=d.charCodeAt(p);t.rx.isNewline(n)?(p++,13==n&&10==d.charCodeAt(p)&&p++):_(e.U.lf("unexpected character after line continuation character"))}function C(){for(m(n.NewLine,"");p<d.length&&!t.rx.isNewline(d.charCodeAt(p));)p++;m(n.Comment,d.slice(h+1,p)),13==d.charCodeAt(p)&&10==d.charCodeAt(p+1)&&p++,p++,x()}function I(){let t=d[h],r="";if("0"==t){let i=d[p];const s=l[i];if(s){for(p++;;){const e=d[p];if(!s.test(e))break;r+=e,p++}if(r){let s=parseInt(r,c[i]);isNaN(s)&&_(e.U.lf("invalid number")),m(n.Number,t+i+r,s)}else _(e.U.lf("expecting numbers to follow 0b, 0o, 0x"));return}}let i=!1,s=!1,o=!1;for(p=h;;){const e=d.charCodeAt(p);if(!o||43!=e&&45!=e)if(o=!1,95==e||w(e));else if(s||i||46!=e){if(s||69!=e&&101!=e)break;s=!0,o=!0}else i=!0;else;r+=String.fromCharCode(e),p++}!i&&!s&&"0"==t&&r.length>1&&!/^0+/.test(r)&&_(e.U.lf("unexpected leading zero"));let a=parseFloat(r);isNaN(a)&&_(e.U.lf("invalid number")),m(n.Number,r,a)}function A(){w(d.charCodeAt(p))?I():m(n.Op,"Dot")}function w(e){return 48<=e&&e<=57}function N(){_(e.U.lf("invalid token"))}}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){let n,r,i,s,o,a,l,c,u;function d(){return r[o]}function p(){for(;r[o];o++){let i=r[o];if(i.type!=t.TokenType.Comment){if(n>=0&&i.type==t.TokenType.Op)switch(i.value){case"LParen":case"LSquare":case"LBracket":n++;break;case"RParen":case"RSquare":case"RBracket":n--}if(i.type!=t.TokenType.Error){if(n>0){if(i.type==t.TokenType.NewLine||i.type==t.TokenType.Indent)continue}else if(i.type==t.TokenType.Indent){if(r[o+1].type==t.TokenType.NewLine){o++;continue}let n=parseInt(i.value),s=l[l.length-1];if(n==s)continue;if(n>s)return void l.push(n);{i.type=t.TokenType.Dedent;let s=0;for(;l.length;){let t=l[l.length-1];if(!(t>n)){for(t!=n&&f(9552,e.U.lf("inconsitent indentation"));s>1;)r.splice(o,0,i),s--;return}l.pop(),s++}}}return}f(9551,i.value)}else a.push(i)}}function h(){c=d(),c.type!=t.TokenType.EOF&&(o++,p())}function f(n,r){r||(r=e.U.lf("invalid syntax")),n||(n=9550);const o=d(),a={code:n,category:pxtc.DiagnosticCategory.Error,messageText:e.U.lf("{0} near {1}",r,t.friendlyTokenToString(o,i)),fileName:s,start:o.startPos,length:o.endPos?o.endPos-o.startPos:0,line:0,column:0};t.patchPosition(a,i),u.push(a),9572!=n&&u.length>100&&e.U.userError(e.U.lf("too many parse errors"))}function m(n,r){const i=d();(i.type==n&&i.value==r||(f(9553,e.U.lf("expecting {0}",t.tokenToString(function(e,t){return{type:e,value:t,startPos:0,endPos:0}}(n,r)))),i.type!=t.TokenType.NewLine))&&h()}function _(){m(t.TokenType.NewLine,"")}function g(e){m(t.TokenType.Keyword,e)}function y(e){m(t.TokenType.Op,e)}function b(){let e=d();return e.type==t.TokenType.Keyword?e.value:""}function v(){let e=d();return e.type==t.TokenType.Op?e.value:""}const T={if:function e(){let t=x("If");h(),t.test=W(),t.body=E(),"elif"==b()?t.orelse=[e()]:t.orelse=C();return S(t)},while:function(){let e=x("While");return g("while"),e.test=W(),e.body=E(),e.orelse=C(),S(e)},for:function(){let e=x("For");return g("for"),e.target=B(),U(e.target),g("in"),e.iter=$(),e.body=E(),e.orelse=C(),S(e)},try:function(){let e=x("Try");g("try"),e.body=E(),e.handlers=[];let t=!1;for(;"except"==b();){let n=x("ExceptHandler");e.handlers.push(n),h(),"Colon"!=v()?(t&&f(),n.type=W(),"as"==b()?(h(),n.name=be()):n.name=void 0):(t=!0,n.type=void 0,n.name=void 0),n.body=E()}e.orelse=C(),0==e.handlers.length&&e.orelse.length&&f();"finally"==b()?(h(),e.finalbody=E()):e.finalbody=[];return S(e)},with:function(){let t=x("With");return g("with"),t.items=_e(e.U.lf("with item"),I),t.body=E(),S(t)},def:function(){let e=x("FunctionDef");g("def"),e.name=be(),y("LParen"),e.args=j(!0),y("RParen"),e.returns=void 0,"Arrow"==v()&&(h(),e.returns=W());return e.body=E(),S(e)},class:function(){let e=x("ClassDef");if(g("class"),e.name=be(),"LParen"==v()){let t=ve();e.bases=t.args,e.keywords=t.keywords}else e.bases=[],e.keywords=[];return e.body=E(),S(e)}},k={del:function(){let t=x("Delete");return g("del"),t.targets=me(e.U.lf("expression"),oe),S(t)},pass:function(){let e=x("Pass");return g("pass"),S(e)},break:function(){let e=x("Break");return h(),S(e)},continue:function(){let e=x("Continue");return h(),S(e)},return:function(){let e=x("Return");h(),w()?e.value=void 0:e.value=$();return S(e)},raise:function(){let e=x("Raise");g("raise"),e.exc=void 0,e.cause=void 0,w()||(e.exc=W(),"from"==b()&&(h(),e.cause=W()));return S(e)},global:N,nonlocal:function(){let e=N();return e.kind="Nonlocal",e},import:function(){let t=x("Import");return h(),t.names=_e(e.U.lf("import name"),O),S(t)},from:function(){let n=x("ImportFrom");h(),n.level=L(),d().type==t.TokenType.Id?n.module=D():n.module=void 0;n.level||n.module||f();if(g("import"),"Mult"==v()){h();let e=x("Alias");e.name="*",n.names=[e]}else"LParen"==v()?(h(),n.names=me(e.U.lf("import name"),R),y("RParen")):n.names=me(e.U.lf("import name"),R);return S(n)},assert:function(){let e=x("Assert");h(),e.test=W(),"Comma"==v()?(h(),e.msg=W()):e.msg=void 0;return S(e)},yield:function(){d();if(h(),"from"==b()){let e=x("YieldFrom");return e.value=W(),A(S(e))}let e=x("Yield");w()||(e.value=$());return A(S(e))}};function E(){return y("Colon"),function(){if(d().type==t.TokenType.NewLine){let n;if(h(),d().type!=t.TokenType.Indent)f(9554,e.U.lf("expected an indented block")),n=G();else{const r=parseInt(d().value);for(h(),n=G();;){if(d().type==t.TokenType.Dedent){const e=isNaN(r)||parseInt(d().value)<r;if(h(),e)break}if(e.U.pushRange(n,G()),d().type==t.TokenType.EOF)break}}return n}return H()}()}function x(e,t){let n=t||d();return{startPos:n.startPos,endPos:n.endPos,kind:e}}function S(e){return e.endPos=c.endPos,e}function C(){return"else"==b()?(h(),E()):[]}function I(){let e=x("WithItem");return e.context_expr=W(),e.optional_vars=void 0,"as"==b()&&(h(),e.optional_vars=oe()),S(e)}function A(e){let t=x("ExprStmt");return t.startPos=e.startPos,t.endPos=e.endPos,t.value=e,t}function w(){let e=d();return e.type==t.TokenType.NewLine||e.type==t.TokenType.Op&&"Semicolon"==e.value}function N(){let e=x("Global");for(h(),e.names=[];e.names.push(be()),"Comma"==v();)h();return S(e)}function D(){let e="";for(;;){if(e+=be(),"Dot"!=v())return e;e+=".",h()}}function O(){let e=x("Alias");return e.name=D(),"as"==b()?(h(),e.asname=be()):e.asname=void 0,S(e)}function R(){let e=x("Alias");return e.name=be(),"as"==b()?(h(),e.asname=be()):e.asname=void 0,S(e)}function L(){let e=0;for(;;)if("Dot"==v())e+=1,h();else{if("Ellipsis"!=v())return e;e+=3,h()}}function P(e,t){let n=x("Tuple",e);return n.elts=t,S(n)}function M(t){let n=d(),r=me(e.U.lf("expression"),t),i=r[0];return 1!=r.length?P(n,r):i}function F(){return M(le)}function $(){return M(W)}function B(){return M(oe)}function U(e){if("Tuple"==e.kind){e.elts.forEach(U)}else e.ctx="Store"}function V(){let n=e.U.lookup(k,b());return n?n():function(){let n=d(),r=F(),i=v();if("Assign"==i){let e=x("Assign");for(e.targets=[r];;){if(h(),r=F(),i=v(),"Assign"!=i){e.value=r;break}e.targets.push(r)}return e.targets.forEach(U),S(e)}if("Colon"==i){let e=x("AnnAssign");return e.target=r,h(),e.annotation=W(),"Assign"==v()&&(h(),e.value=W()),e.simple=n.type==t.TokenType.Id&&"Name"==r.kind?1:0,U(e.target),S(e)}if(e.U.endsWith(i,"Assign")){let e=x("AugAssign");return e.target=r,e.op=i.replace("Assign",""),h(),e.value=$(),U(e.target),S(e)}if("Semicolon"==i||d().type==t.TokenType.NewLine){let e=x("ExprStmt");return e.value=r,S(e)}return f(9555,e.U.lf("unexpected token")),h(),null}()}function H(){let e=[V()];for(;"Semicolon"==v()&&(h(),d().type!=t.TokenType.NewLine);)e.push(V());return _(),e.filter((e=>!!e))}function G(){const r=u.length,i=d().type==t.TokenType.Indent;i&&(h(),f(9573,e.U.lf("unexpected indent")));let s=[];for(;"MatMult"==v();)h(),s.push(ke()),_();let o=b(),l=e.U.lookup(T,b()),p=[],m=a;if(a=[],"class"==o||"def"==o){let e=l();e.decorator_list=s,p=[e]}else s.length?f(9556,e.U.lf("decorators not allowed here")):p=l?[l()]:H();m.length&&p.length&&(p[0]._comments=m);if(u.length>r){for(n=-1;c.type!=t.TokenType.Dedent&&c.type!=t.TokenType.NewLine&&(h(),d().type!=t.TokenType.EOF););i&&d().type===t.TokenType.Dedent&&h(),n=0}return p}function j(n){let r=x("Arguments");for(r.args=[],r.defaults=[],r.kwonlyargs=[],r.kw_defaults=[],r.vararg=void 0;;){let n=v();if("Colon"==n||"RParen"==n)break;if("Mult"==n)r.vararg&&f(9557,e.U.lf("multiple *arg")),h(),d().type==t.TokenType.Id?r.vararg=i():r.vararg=void 0;else if("Pow"==n)r.kwarg&&f(9558,e.U.lf("multiple **arg")),h(),r.kwarg=i();else{r.kwarg&&f(9559,e.U.lf("arguments after **"));let t,n=i();"Assign"==v()&&(h(),t=W()),void 0!==r.vararg&&t?(r.kwonlyargs.push(n),r.kw_defaults.push(t)):(r.args.push(n),t?r.defaults.push(t):r.defaults.length&&f(9560,e.U.lf("non-default argument follows default argument")))}if("Comma"!=v())break;h()}return r.kwarg||(r.kwarg=void 0),r.vararg||(r.vararg=void 0),S(r);function i(){let e=x("Arg");return e.arg=be(),e.annotation=void 0,n&&"Colon"==v()&&(h(),e.annotation=W()),e}}function K(e){let t=x("Lambda");return h(),t.args=j(!1),y("Colon"),t.body=e?ce():W(),S(t)}function W(){if("lambda"==b())return K();let e=d(),t=J();if("if"==b()){let n=x("IfExp",e);return n.body=t,g("if"),n.test=J(),g("else"),n.orelse=W(),S(n)}return t}function z(e,t){let n=d(),r=t();if(b()==e){let i=x("BoolOp",n);for(i.op="or"==e?"Or":"And",i.values=[r];b()==e;)g(e),i.values.push(t());return S(i)}return r}function q(){return z("and",Y)}function J(){return z("or",q)}function Y(){if("not"==b()){let e=x("UnaryOp");return h(),e.op="Not",e.operand=Y(),S(e)}return function(){let e=d(),t=oe();if(!Q())return t;let n=x("Compare",e);n.left=t,n.comparators=[],n.ops=[];for(;;){let e=Q();if(!e)break;h(),"NotIn"==e?g("in"):"Is"==e&&"not"==b()&&(h(),e="IsNot"),n.ops.push(e),n.comparators.push(oe())}return S(n)}()}const X={Lt:"Lt",Gt:"Gt",Eq:"Eq",GtE:"GtE",LtE:"LtE",NotEq:"NotEq",in:"In",not:"NotIn",is:"Is"};function Q(){return X[v()]||X[b()]||null}const Z={Invert:"Invert",Sub:"USub",Add:"UAdd"};function ee(e,t){let n=d(),r=e();for(;;){let i=v();if(!(i&&t.indexOf(","+i+",")>=0))return r;{let t=x("BinOp",n);t.left=r,t.op=i,h(),t.right=e(),r=t}}}function te(){return ee(Ee,",Mult,MatMult,Div,Mod,FloorDiv,")}function ne(){return ee(te,",Add,Sub,")}function re(){return ee(ne,",LShift,RShift,")}function ie(){return ee(re,",BitAnd,")}function se(){return ee(ie,",BitXor,")}function oe(){return ee(se,",BitOr,")}function ae(){let t,n=d();if("Colon"!=v()&&(t=W()),"Colon"==v()){let e=x("Slice",n);e.lower=t,h();let r=v();return e.upper="Colon"!=r&&"Comma"!=r&&"RSquare"!=r?W():void 0,e.step=void 0,"Colon"==v()&&(h(),r=v(),"Comma"!=r&&"RSquare"!=r&&(e.step=W())),S(e)}{t||f(9570,e.U.lf("unable to parse lower subscript"));let n=x("Index");return n.value=t,S(n)}}function le(){if("Mult"==v()){let e=x("Starred");return e.value=oe(),S(e)}return W()}function ce(){return"lambda"==b()?K(!0):J()}function ue(){let e=[];for(;;){let t=x("Comprehension");for(t.is_async=0,e.push(t),g("for"),t.target=B(),U(t.target),g("in"),t.iter=J(),t.ifs=[];"if"==b();)h(),t.ifs.push(ce());if("for"!=b())return e}}function de(){let t=d();if("Mult"==v()){let e=x("Starred");return h(),e.value=W(),S(e)}if("Pow"==v()){let e=x("Keyword");return h(),e.arg=void 0,e.value=W(),S(e)}let n=W();if("Assign"==v()){"Name"!=n.kind&&f(9561,e.U.lf("invalid keyword argument; did you mean ==?")),h();let r=x("Keyword",t);return r.arg=n.id||"???",r.value=W(),S(r)}if("for"==b()){let e=x("GeneratorExp",t);return e.elt=n,e.generators=ue(),S(e)}return n}function pe(){let e=x("NameConstant");return e.value=null,h(),S(e)}function he(){let n=d();if(n.type==t.TokenType.Id){let e=x("Name");return h(),e.id=n.value,e.ctx="Load",S(e)}if(n.type==t.TokenType.Number){let e=x("Num");return h(),e.ns=n.value,e.n=n.auxValue,S(e)}if(n.type==t.TokenType.String){h();let r=n.value;for(;d().type==t.TokenType.String;)r+=d().value,h();if("b"==n.stringPrefix){let t=x("Bytes",n);return t.s=e.U.toArray(e.U.stringToUint8Array(r)),S(t)}{let e=x("Str",n);return e.s=r,S(e)}}if(n.type==t.TokenType.Keyword){if("None"==n.value||"True"==n.value||"False"==n.value){let e=x("NameConstant");return h(),e.value="True"==n.value||"False"!=n.value&&null,S(e)}return f(9564,e.U.lf("expecting atom")),pe()}if(n.type==t.TokenType.Op){let t=n.value;return"LParen"==t?ye("RParen","Tuple","GeneratorExp"):"LSquare"==t?ye("RSquare","List","ListComp"):"LBracket"==t?function(){let t=d();if(h(),"Pow"==v())return h(),r(void 0,oe());if("RBracket"==v()){let e=x("Dict",t);return h(),e.keys=[],e.values=[],S(e)}{let n=le();return"Starred"!=n.kind&&"Colon"==v()?(h(),r(n,W())):function(n){if("for"==b()){"Starred"==n.kind&&f(9562,e.U.lf("iterable unpacking cannot be used in comprehension"));let r=x("SetComp",t);return r.elt=n,r.generators=ue(),S(r)}let r=x("Set",t);if(r.elts=[n],"Comma"==v()){let t=ge("RBracket",e.U.lf("set element"),le);r.elts=[n].concat(t)}else y("RBracket");return S(r)}(n)}function n(){if("Pow"==v())return h(),[null,oe()];{let e=W();return y("Colon"),[e,W()]}}function r(r,i){if("for"==b()){r||f(9563,e.U.lf("dict unpacking cannot be used in dict comprehension"));let n=x("DictComp",t);return n.key=r,n.value=i,n.generators=ue(),S(n)}let s=x("Dict",t);if(s.keys=[r],s.values=[i],"Comma"==v()){let t=ge("RBracket",e.U.lf("dict element"),n);for(let e of t)e.length>=2&&e[0]&&e[1]&&(s.keys.push(e[0]),s.values.push(e[1]))}else y("RBracket");return S(s)}}():(f(9565,e.U.lf("unexpected operator")),pe())}return f(9566,e.U.lf("unexpected token")),pe()}function fe(){let n=v();return"RParen"==n||"RSquare"==n||"RBracket"==n||"Colon"==n||"Semicolon"==n||(!!e.U.endsWith(n,"Assign")||("in"==b()||d().type==t.TokenType.NewLine))}function me(t,n){let r=[];if(fe())return r;for(;;){r.push(n());let i="Comma"==v();if(i&&h(),fe())return r;if(!i)return f(9567,e.U.lf("expecting {0}",t)),r}}function _e(e,t){let n=[];for(;n.push(t()),"Comma"==v();)h();return n}function ge(t,n,r){h();let i=[];if(v()!=t)for(;;){i.push(r());let s="Comma"==v();if(s&&h(),v()==t)break;if(!s){f(9568,e.U.lf("expecting {0}",n));break}}return y(t),i}function ye(t,n,r){let i=d();if(h(),v()==t){h();let e=x(n,i);return e.elts=[],S(e)}let s=le();if("for"==b()){let e=x(r,i);return e.elt=s,e.generators=ue(),y(t),S(e)}if("Comma"==v()){let r=x(n,i);return h(),r.elts=me(e.U.lf("expression"),le),r.elts.unshift(s),y(t),S(r)}if(y(t),"List"==n){let e=x(n,i);return e.elts=[s],S(e)}return s}function be(){let n=d();return n.type!=t.TokenType.Id&&f(9569,e.U.lf("expecting identifier")),h(),n.value}function ve(){let t=ge("RParen",e.U.lf("argument"),de),n=[],r=[];for(let i of t)"Keyword"==i.kind?r.push(i):(r.length&&f(9570,e.U.lf("positional argument follows keyword argument")),n.push(i));return{args:n,keywords:r}}function Te(t,n){let r=v();if("LParen"==r){let e=x("Call",t);e.func=n;let r=ve();return e.args=r.args,e.keywords=r.keywords,S(e)}if("LSquare"==r){let r=d(),i=x("Subscript",t);i.value=n;let s=ge("RSquare",e.U.lf("subscript"),ae);if(0==s.length)f(9571,e.U.lf("need non-empty index list"));else if(1==s.length)i.slice=s[0];else if(s.every((e=>"Index"==e.kind))){let e=s[0];e.value=P(r,s.map((e=>e.value))),i.slice=e}else{let e=x("ExtSlice",r);e.dims=s,i.slice=S(e)}return S(i)}if("Dot"==r){let e=x("Attribute",t);return e.value=n,h(),e.attr=be(),S(e)}return n}function ke(){let e=d(),t=he();for(;;){let n=Te(e,t);if(n===t)return t;t=n}}function Ee(){if(Z[v()]){let e=x("UnaryOp");return e.op=Z[v()],h(),e.operand=Ee(),S(e)}return function(){d();let e=ke();if("Pow"==v()){let t=x("BinOp");return h(),t.left=e,t.op="Pow",t.right=Ee(),S(t)}return e}()}const xe={kind:1,id:2,n:3,s:4,func:5,key:6,elt:7,elts:8,keys:9,left:10,ops:11,comparators:12,names:13,items:14,test:15,targets:16,dims:17,context_expr:18,name:19,bases:20,type:21,inClass:22,target:23,annotation:24,simple:25,op:26,operand:27,right:28,values:29,iter:30,ifs:31,is_async:32,value:33,slice:34,attr:35,generators:36,args:37,keywords:38,body:39,handlers:40,orelse:41,finalbody:42,decorator_list:43,kwonlyargs:44,kw_defaults:45,defaults:46,arg:47},Se={lineno:1,col_offset:1,startPos:1,endPos:1,kind:1},Ce={body:1,orelse:1,finalbody:1},Ie={_comments:1,ctx:1,ns:1};t.dump=function(t,n=!1){const r=(t,i)=>{if(Array.isArray(i)){let e="";for(let n=0;n<i.length;++n)n>0&&(e+=", "),e+=r(t,i[n]);return"["+e+"]"}if(!i||!i.kind)return JSON.stringify(i);let s="",o=Object.keys(i);o.sort(((t,n)=>(xe[t]||100)-(xe[n]||100)||e.U.strcmp(t,n)));for(let a of o)if(!(e.U.lookup(Se,a)||n&&e.U.lookup(Ie,a)))if(s&&(s+=", "),s+=a+"=",Array.isArray(i[a])&&i[a].length&&e.U.lookup(Ce,a)){s+="[\n";let e=t+"  ";for(let t of i[a])s+=e+r(e,t)+"\n";s+=t+"]"}else if("_comments"==a){s+="[\n";let e=t+"  ";for(let t of i[a])s+=e+JSON.stringify(t.value)+"\n";s+=t+"]"}else s+=r(t,i[a]);return i.kind+"("+s+")"};let i="";for(let e of t)i+=r("",e)+"\n";return i},t.parse=function(h,m,_){i=h,s=m,r=_,n=0,o=0,a=[],l=[0],u=[];let g=[];try{if(c=r[0],p(),d().type!=t.TokenType.EOF)for(g=G();d().type!=t.TokenType.EOF;)e.U.pushRange(g,G())}catch(t){f(9572,e.U.lf("exception: {0}",t.message))}return{stmts:g,diagnostics:u}}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(t){function n(e,t,n){const r={fileName:e.getSourceFile().fileName,start:e.getStart(),length:e.getEnd()-e.getStart(),line:void 0,column:void 0,code:t,category:pxtc.DiagnosticCategory.Error,messageText:n},i=new Error(n);throw i.pyDiagnostic=r,i}t.decompileToPython=function(r,i){let s={blocksInfo:void 0,outfiles:{},diagnostics:[],success:!0,times:{}};try{let o=function(r,i){const s=r.getTypeChecker(),o=(new ts.pxtc.LSHost(r),r.getSourceFile(i)),a=pxtc.decompiler.buildCommentMap(o),l=e.U.toSet(f(),(e=>e)),[c,u]=ts.pxtc.decompiler.buildRenameMap(r,o,{takenNames:l,declarations:"all"}),d=pxtc.getApiInfo(r),p=e.U.mapMap(d.byQName,((e,t)=>t.fileName==i?void 0:t)),h=t.computeScopeVariableLookup(o);return E(o);function f(){return["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EnvironmentError","Exception","False","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","NameError","None","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","True","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError","_","__build_class__","__debug__","__doc__","__import__","__loader__","__name__","__package__","__spec__","abs","all","any","ascii","bin","bool","bytearray","bytes","callable","chr","classmethod","compile","complex","copyright","credits","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","license","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","quit","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip",...Object.keys(e.py.keywords)]}function m(e){if(!e.getSourceFile())return null;let t=e.getText();return p[t]||null}function _(e){if(!e.getSourceFile())return null;let t=e.getText();const n=s.getSymbolAtLocation(e);n&&(t=s.getFullyQualifiedName(n));let r=p[t];if(r&&r.attributes.alias)return r.attributes.alias;if(r&&r.pyQName){if(r.isInstance){if(ts.isPropertyAccessExpression(e))return null;const t=new RegExp(`(?:^|.)${r.namespace}.(.+)`).exec(r.pyQName);if(t)return t[1]}return r.pyQName}return t in pxtc.ts2PyFunNameMap?pxtc.ts2PyFunNameMap[t].n:null}function g(t){let r=_(t);if(r)return r;if(!ts.isIdentifier(t))return e.tickEvent("depython.todo.advancedname"),n(t,3001,"Unsupported advanced name format: "+t.getText());let i=t.text;if(t.getSourceFile()){const e=c.getRenameForPosition(t.getStart());e&&(i=e.name)}return i}function y(e){return"string"!=typeof e&&(e=g(e)),u[e]?pxtc.decompiler.getNewName(e,u):(u[e]=!0,e)}function b(e,t){return 0!=(e.flags&t)}function v(e,t){return b(s.getTypeAtLocation(e),t)}function T(e){return v(e,ts.TypeFlags.StringLike)}function k(e){return v(e,ts.TypeFlags.NumberLike)}function E(e){let t=e.getChildren().map(x).reduce(((e,t)=>e.concat(t)),[]).reduce(((e,t)=>t||e[e.length-1]?[...e,t]:e),[]);return a.filter((e=>!e.owner)).forEach((e=>t.push(...S(e)))),t.join("\n")}function x(e){switch(e.kind){case ts.SyntaxKind.SyntaxList:return e._children.map(x).reduce(((e,t)=>e.concat(t)),[]);case ts.SyntaxKind.EndOfFileToken:case ts.SyntaxKind.OpenBraceToken:case ts.SyntaxKind.CloseBraceToken:return[];default:return C(e)}}function S(e){let t=[];if(e.kind===pxtc.decompiler.CommentKind.SingleLine)t.push("# "+e.text);else{t.push('"""');for(const n of e.lines)t.push(n);t.push('"""')}return t}function C(e){const t=I(e);return pxtc.decompiler.getCommentsForStatement(e,a).map(S).reduce(((e,t)=>e.concat(t)),[]).concat(t)}function I(t){return ts.isVariableStatement(t)?B(t):ts.isClassDeclaration(t)?U(t):ts.isEnumDeclaration(t)?V(t):ts.isExpressionStatement(t)?j(t):ts.isFunctionDeclaration(t)?W(t):ts.isIfStatement(t)?F(t):ts.isForStatement(t)?M(t):ts.isForOfStatement(t)?P(t):ts.isWhileStatement(t)?D(t):ts.isReturnStatement(t)?N(t):ts.isBlock(t)?K(t):ts.isTypeAliasDeclaration(t)?w(t):ts.isEmptyStatement(t)?[]:ts.isModuleDeclaration(t)?A(t):ts.isBreakStatement(t)?["break"]:ts.isContinueStatement(t)?["continue"]:(e.tickEvent("depython.todo.statement",{statement:t.kind}),n(t,3002,`Not supported in MakeCode Python: ${ts.SyntaxKind[t.kind]} (${t.kind})`))}function A(e){let n=g(e.name),r=e.body&&e.body.getChildren().map(x).reduce(((e,t)=>e.concat(t)),[]).map((e=>t.indent1(e)));return["@namespace",`class ${n}:`].concat(r||[])}function w(e){let t=pxtc.emitPyTypeFromTypeNode(e.type);return[`${g(e.name)} = ${t}`]}function N(e){if(!e.expression)return["return"];let[t,n]=Te(e.expression),r=X("return ",t);return n.concat(r)}function D(e){let[t,n]=Te(e.expression),r=L(e.statement),i=X("while ",t,":");return n.concat(i).concat(r)}function O(e){let t=Math.floor(Number(e));return t!==1/0&&String(t)===e}function R(e){if(!e.initializer)return null;if(e.initializer.kind!==ts.SyntaxKind.VariableDeclarationList)return null;let t=e.initializer;if(1!==t.declarations.length)return null;let n=t.declarations[0],r=g(n.name);if(!n.initializer||!be(n.initializer)||!k(n.initializer))return null;let[i,s]=Te(n.initializer);if(s.length)return null;let o=Y(i);if(!e.condition)return null;if(!ts.isBinaryExpression(e.condition))return null;if(!ts.isIdentifier(e.condition.left))return null;if(g(e.condition.left)!=r)return null;if(!k(e.condition.right))return null;let[a,l]=Te(e.condition.right);if(l.length)return null;let c=Y(a),u=c;if(e.condition.operatorToken.kind===ts.SyntaxKind.LessThanEqualsToken&&O(c))u=""+(Number(c)+1);else if(e.condition.operatorToken.kind!==ts.SyntaxKind.LessThanToken)return null;return e.incrementor&&(ts.isPostfixUnaryExpression(e.incrementor)||ts.isPrefixUnaryExpression(e.incrementor))?e.incrementor.operator!==ts.SyntaxKind.PlusPlusToken?null:o<u?{name:r,fromIncl:o,toExcl:u}:null:null}function L(e){let n=I(e).map(t.indent1);return n.length<1&&(n=[t.indent1("pass")]),n}function P(t){if(!ts.isVariableDeclarationList(t.initializer))return e.tickEvent("depython.todo.forof.complexexp"),n(t,3003,"Unsupported expression in for..of initializer: "+t.initializer.getText());let r=t.initializer.declarations.map((e=>g(e.name)));if(1!==r.length)return e.tickEvent("depython.todo.forof.multidecl"),n(t,3004,"Unsupported multiple declerations in for..of: "+t.initializer.getText());let i=r[0],[s,o]=Te(t.expression),a=o;a=a.concat(X(`for ${i} in `,s,":"));let l=L(t.statement);return a=a.concat(l),a}function M(e){let n=R(e);if(n){let{name:t,fromIncl:r,toExcl:i}=n,s="0"===r?`for ${t} in range(${i}):`:`for ${t} in range(${r}, ${i}):`,o=L(e.statement);return[s].concat(o)}let r,i=[];if(e.initializer)if(ts.isVariableDeclarationList(e.initializer)){let t=e.initializer.declarations.map(q).reduce(((e,t)=>e.concat(t)),[]);i=i.concat(t)}else{let[t,n]=Te(e.initializer);i=i.concat(n).concat(t)}if(e.condition){let[t,n]=Te(e.condition);i=i.concat(n),r=Y(t)}else r="True";let s=`while ${r}:`;i.push(s);let o=I(e.statement).map(t.indent1);if(0!==o.length||e.incrementor||(o=[t.indent1("pass")]),i=i.concat(o),e.incrementor){let n=G(e.incrementor);if(n)i=i.concat(n.map(t.indent1));else{let[n,r]=Te(e.incrementor);i=i.concat(r).concat(n.map(t.indent1))}}return i}function F(e){let{supportStmts:t,ifStmt:n,rest:r}=$(e);return t.concat([n]).concat(r)}function $(e){let t=[],[n,r]=Te(e.expression);t=t.concat(r);let i=`if ${Y(n)}:`,s=[],o=L(e.thenStatement);if(s=s.concat(o),e.elseStatement)if(ts.isIfStatement(e.elseStatement)){let{supportStmts:n,ifStmt:r,rest:i}=$(e.elseStatement),o=`el${r}`;t=t.concat(n),s.push(o),s=s.concat(i)}else{s.push("else:");let t=L(e.elseStatement);s=s.concat(t)}return{supportStmts:t,ifStmt:i,rest:s}}function B(e){return e.declarationList.declarations.map(q).reduce(((e,t)=>e.concat(t)),[])}function U(t){return e.tickEvent("depython.todo.classes"),n(t,3016,"Unsupported: classes are not supported in Python right now.")}function V(r){let i=[];i.push(`class ${g(r.name)}(Enum):`);let s=r.members.every((e=>!!e.initializer)),o=!r.members.every((e=>!!e.initializer));if(!s&&!o)return e.tickEvent("depython.todo.enummix"),n(r,3005,"Unsupported enum decleration: has mixture of explicit and implicit initialization");if(s)return e.tickEvent("depython.todo.enuminit"),n(r,3006,"Unsupported: explicit enum initialization");let a=0;for(let e of r.members)i.push(t.indent1(`${g(e.name)} = ${a++}`));return i}function H(e){return!(!ts.isPrefixUnaryExpression(e)&&!ts.isPostfixUnaryExpression(e))&&(e.operator===ts.SyntaxKind.MinusMinusToken||e.operator===ts.SyntaxKind.PlusPlusToken)}function G(e){if(!H(e))return null;let[t,n]=Te(e.operand),r=e.operator===ts.SyntaxKind.MinusMinusToken?" -= 1":" += 1",i=n;return i.push(`${Y(t)}${r}`),i}function j(e){let t=G(e.expression);if(t)return t;const[n,r]=Te(e.expression);return r.length?["",...r,...n,""]:[...r,...n]}function K(e){return e.getChildren().map(x).reduce(((e,t)=>e.concat(t)),[])}function W(r,i,s,o){let a=[];r.kind!==ts.SyntaxKind.MethodDeclaration&&r.kind!==ts.SyntaxKind.Constructor||a.push("self");let l=(s?oe(r.parameters,s):r.parameters).map((e=>z(e,!o)));a=a.concat(l);let c,u=a.join(", "),d=[];if(i)c=i;else{if(!r.name)return e.tickEvent("depython.todo.anonymousfunc"),n(r,3012,"Unsupported: anonymous function decleration");c=g(r.name)}if(d.push(`def ${c}(${u}):`),!r.body)return e.tickEvent("depython.todo.funcwithoutbody"),n(r,3013,"Unsupported: function decleration without body");let p=[];if(ts.isBlock(r.body))p=K(r.body);else{let[e,t]=Te(r.body);p=p.concat(t),p.concat(e)}if(p.length){let e=h.getExplicitGlobals(r).map((e=>g(e)));e&&e.length&&p.unshift(`global ${e.join(", ")}`);let n=h.getExplicitNonlocals(r).map((e=>g(e)));n&&n.length&&p.unshift(`nonlocal ${n.join(", ")}`),d=d.concat(p.map(t.indent1))}else d.push(t.indent1("pass"));return d}function z(t,r=!0){let i=t.altName||g(t.name),s="";if(t.type&&r){let e=pxtc.emitPyTypeFromTypeNode(t.type);e&&-1===e.indexOf("(TODO")&&(s=`: ${e}`)}let o="";if(t.initializer){let[r,i]=Te(t.initializer);if(i.length)return e.tickEvent("depython.todo.complexinit"),n(t,3007,`Unsupported: complex expression in parameter default value not supported. Expression: ${t.initializer.getText()}`);o=` = ${Y(r)}`}return`${i}${s}${o}`}function q(e){let t=[],n=g(e.name);if(e.initializer){let r,[i,s]=Te(e.initializer);if(t=t.concat(s),e.type){r=`${n}: ${pxtc.emitPyTypeFromTypeNode(e.type)} = ${Y(i)}`}else r=`${n} = ${Y(i)}`;return t.push(r),t}return t}function J(e,t){return[[e],t||[]]}function Y(e,t="\n"){return e.join(t)}function X(e="",t,n=""){return t[0]=e+t[0],t[t.length-1]=t[t.length-1]+n,t}function Q(t,r){switch(t){case ts.SyntaxKind.BarBarToken:return"or";case ts.SyntaxKind.AmpersandAmpersandToken:return"and";case ts.SyntaxKind.ExclamationToken:return"not";case ts.SyntaxKind.LessThanToken:return"<";case ts.SyntaxKind.LessThanEqualsToken:return"<=";case ts.SyntaxKind.GreaterThanToken:return">";case ts.SyntaxKind.GreaterThanEqualsToken:return">=";case ts.SyntaxKind.EqualsEqualsEqualsToken:case ts.SyntaxKind.EqualsEqualsToken:return"==";case ts.SyntaxKind.ExclamationEqualsEqualsToken:case ts.SyntaxKind.ExclamationEqualsToken:return"!=";case ts.SyntaxKind.EqualsToken:return"=";case ts.SyntaxKind.PlusToken:return"+";case ts.SyntaxKind.MinusToken:return"-";case ts.SyntaxKind.AsteriskToken:return"*";case ts.SyntaxKind.PlusEqualsToken:return"+=";case ts.SyntaxKind.MinusEqualsToken:return"-=";case ts.SyntaxKind.PercentToken:return"%";case ts.SyntaxKind.SlashToken:return"/";case ts.SyntaxKind.PlusPlusToken:case ts.SyntaxKind.MinusMinusToken:return e.tickEvent("depython.todo.unsupportedop",{op:t}),n(r,3008,"Unsupported ++ and -- in an expression (not a statement or for loop)");case ts.SyntaxKind.AmpersandToken:return"&";case ts.SyntaxKind.CaretToken:return"^";case ts.SyntaxKind.LessThanLessThanToken:return"<<";case ts.SyntaxKind.GreaterThanGreaterThanToken:return">>";case ts.SyntaxKind.GreaterThanGreaterThanGreaterThanToken:return e.tickEvent("depython.todo.unsupportedop",{op:t}),n(r,3009,"Unsupported operator: >>>");case ts.SyntaxKind.AsteriskAsteriskToken:return"**";case ts.SyntaxKind.AsteriskAsteriskEqualsToken:return"**=";case ts.SyntaxKind.PercentEqualsToken:return"%=";case ts.SyntaxKind.AsteriskEqualsToken:return"*=";case ts.SyntaxKind.SlashEqualsToken:return"/=";default:return e.tickEvent("depython.todo.unsupportedop",{op:t}),n(r,3008,`Unsupported Python operator (code: ${t})`)}}function Z(e){let t=T(e.left),n=T(e.right),r=e.operatorToken.kind===ts.SyntaxKind.PlusToken&&(t||n),[i,s]=Te(e.left);r&&!t&&(i=X("str(",i,")"));let o=Q(e.operatorToken.kind,e),[a,l]=Te(e.right);r&&!n&&(a=X("str(",a,")"));let c=s.concat(l);return[X(Y(i)+" "+o+" ",a),c]}function ee(e){let t=_(e);if(t)return J(t);let[n,r]=Te(e.expression),i=g(e.name);return J("length"===i?`len(${Y(n)})`:`${Y(n)}.${i}`,r)}function te(e){if(ts.isPropertyAccessExpression(e)){let t=g(e.name),n=t.substr(t.lastIndexOf(".")+1);return ts.isIdentifier(e.expression)?[n]:te(e.expression).concat([n])}return ts.isIdentifier(e)?[g(e)]:[]}function ne(t,n,r,i){let o="";n&&(o=te(n).map(e.U.snakify).join("_"));let a=[];if(r&&r.length>1&&i&&i.length>1)for(let t=0;t<r.length&&t<i.length;t++){let n=i[t];if(b(s.getTypeAtLocation(n),ts.TypeFlags.EnumLike)){let t=te(n).map(e.U.snakify);a=a.concat(t)}}let l=a.join("_"),c="";o||l||!t||(c=g(t.name));let u=([o,l,c].filter((e=>e)).map(e.U.snakify).map((e=>e.toLowerCase())).join("_")||"my_callback").split("_");u.length>4&&(u=p(u));let d=e.U.toDictionary(["any","on","event"],(e=>e));for(;u.length>2;){let e=h(u,d);if(e.length==u.length)break;u=e}return u=["on",...u],u.join("_");function p(e){let t={},n=[];for(let r of e)r in t||(t[r]=!0,n.push(r));return n}function h(e,t){let n=[],r=!1;for(let i of e)!(i in t)||r?n.push(i):r=!0;return n}}function re(e){let n=e.join(", ");return n.length>60&&e.length>1?e.map(((n,r)=>{let i=","==n.charAt(n.length-1)?"":",";if(0==r){let e=n.split("\n");if(e.length>1){n=e.shift()+"\n"+t.indent1(e.join("\n"))}return n+i}return r==e.length-1?t.indent1(n):t.indent1(n+i)})):[n]}function ie(e,t,n,r,i){if((ts.isFunctionExpression(e)||ts.isArrowFunction(e))&&t&&t.type&&ts.isFunctionTypeNode(t.type)){let s;return ae(e,ne(t,n,r,i),s,!0)}return Te(e)}function se(t){let r=s.getTypeAtLocation(t.expression),i=s.typeToTypeNode(r),o=ts.createNodeArray([]);if(ts.isFunctionTypeNode(i)&&(o=i.parameters,t.arguments&&o.length<t.arguments.length))return e.tickEvent("depython.todo.argparammismatch",{kind:t.kind}),n(t,3010,"TODO: Unsupported call site where caller the arguments outnumber the callee parameters: "+t.getText());const a=m(t.expression);if(t.arguments&&a&&"TD_ID"==a.attributes.shim)return Te(t.arguments[0]);if(ts.isPropertyAccessExpression(t.expression)&&"toString"===t.expression.name.getText()){const[e,n]=Te(t.expression.expression);return[X("str(",e,")"),n]}let[l,c]=Te(t.expression),u=Y(l),d=(t.arguments||ts.createNodeArray()).map(((e,n,r)=>ie(e,o[n],t.expression,o,r))),p=d.map((([e,t])=>t)).reduce(((e,t)=>e.concat(t)),c);if(0===u.indexOf("_py.py_")){if(d.length<=0)return e.tickEvent("depython.todo._pynoargs"),n(t,3014,"Unsupported: call expression has no arguments for _py.py_ fn");u=u.substr(7).split("_").filter(((e,t)=>0!==t)).join("_");return[X(`${d.shift()[0]}.${u}(`,re(d.map((([e,t])=>e)).reduce(((e,t)=>e.concat(t)),[])),")"),p]}return[X(`${u}(`,re(d.map((([e,t])=>e)).reduce(((e,t)=>e.concat(t)),[])),")"),p]}function oe(e,t){let n=[],r={};for(let i=0;i<Math.max(e.length,t.length);i++){let s;if(e[i])s=e[i],r[g(s.name)]=!0;else{s=t[i];let e=g(s.name);r[e]&&(e=pxtc.decompiler.getNewName(e,r),s=Object.assign({altName:e},t[i]))}n.push(s)}return ts.createNodeArray(n,!1)}function ae(e,t,n,r){let i=e.name?g(e.name):y(t||"my_function");return J(i,W(e,i,n,r))}function le(e){switch(e){case ts.SyntaxKind.ExclamationToken:return" ";case ts.SyntaxKind.PlusToken:case ts.SyntaxKind.MinusToken:return"";default:return" "}}function ce(e){let t=Q(e.operator,e),[n,r]=Te(e.operand);return J(`${t}${le(e.operator)}${Y(n)}`,r)}function ue(e){let t=Q(e.operator,e),[n,r]=Te(e.operand),i=le(e.operator);return J(`${Y(n)}${i}${t}`,r)}function de(e){let t=e.elements.map(Te),n=t.map((([e,t])=>t)).reduce(((e,t)=>e.concat(t)),[]);return[X("[",re(t.map((([e,t])=>e)).reduce(((e,t)=>e.concat(t)),[])),"]"),n]}function pe(t){if(!t.argumentExpression)return e.tickEvent("depython.todo.accesswithoutexp"),n(t,3015,"Unsupported: element access expression without an argument expression");let[r,i]=Te(t.expression),[s,o]=Te(t.argumentExpression),a=i.concat(o);return J(`${Y(r)}[${Y(s)}]`,a)}function he(e){let[t,n]=Te(e.expression);return J(`(${Y(t)})`,n)}function fe(e){if(ts.isNoSubstitutionTemplateLiteral(e))return J(`"""\n${e.text.trim().split("\n").map((e=>`${t.INDENT}${e.trim()}`)).join("\n")}\n${t.INDENT}"""`);let[n,r]=Te(e.tag),[i,s]=Te(e.template),o=r.concat(s);return J(`${Y(n)}(${Y(i)})`,o)}function me(e){if("undefined"==e.text)return J("None");return J(g(e))}function _e(e,t){let n=e=>_e(e,t);return ts.isBinaryExpression(e)?n(e.left)&&n(e.right):ts.isPropertyAccessExpression(e)?n(e.expression):ts.isPrefixUnaryExpression(e)||ts.isPostfixUnaryExpression(e)?e.operator!==ts.SyntaxKind.PlusPlusToken&&e.operator!==ts.SyntaxKind.MinusMinusToken&&n(e.operand):ts.isParenthesizedExpression(e)?n(e.expression):ts.isArrayLiteralExpression(e)?e.elements.map(n).reduce(((e,t)=>e&&t),!0):ts.isElementAccessExpression(e)?n(e.expression)&&(!e.argumentExpression||n(e.argumentExpression)):t(e)}function ge(e){return e.parent?e.parent.kind===ts.SyntaxKind.ParenthesizedExpression?ge(e.parent):e.parent:void 0}function ye(e){if("any"===e.type.getText().trim()&&(ts.isNumericLiteral(e.expression)||ts.isStringLiteral(e.expression)||e.expression.kind===ts.SyntaxKind.TrueKeyword||e.expression.kind===ts.SyntaxKind.FalseKeyword)){const t=ge(e);if((null==t?void 0:t.kind)===ts.SyntaxKind.BinaryExpression)switch(t.operatorToken.kind){case ts.SyntaxKind.EqualsEqualsToken:case ts.SyntaxKind.EqualsEqualsEqualsToken:case ts.SyntaxKind.ExclamationEqualsToken:case ts.SyntaxKind.ExclamationEqualsEqualsToken:case ts.SyntaxKind.LessThanToken:case ts.SyntaxKind.LessThanEqualsToken:case ts.SyntaxKind.GreaterThanToken:case ts.SyntaxKind.GreaterThanEqualsToken:return!0}}return!1}function be(e){return _e(e,(e=>{switch(e.kind){case ts.SyntaxKind.PropertyAccessExpression:case ts.SyntaxKind.BinaryExpression:case ts.SyntaxKind.ParenthesizedExpression:case ts.SyntaxKind.ArrayLiteralExpression:case ts.SyntaxKind.ElementAccessExpression:case ts.SyntaxKind.TrueKeyword:case ts.SyntaxKind.FalseKeyword:case ts.SyntaxKind.NullKeyword:case ts.SyntaxKind.UndefinedKeyword:case ts.SyntaxKind.NumericLiteral:case ts.SyntaxKind.StringLiteral:case ts.SyntaxKind.NoSubstitutionTemplateLiteral:return!0;case ts.SyntaxKind.CallExpression:case ts.SyntaxKind.NewExpression:case ts.SyntaxKind.FunctionExpression:case ts.SyntaxKind.ArrowFunction:case ts.SyntaxKind.Identifier:case ts.SyntaxKind.ThisKeyword:return!1;case ts.SyntaxKind.PrefixUnaryExpression:case ts.SyntaxKind.PostfixUnaryExpression:let t=e;return t.operator!==ts.SyntaxKind.PlusPlusToken&&t.operator!==ts.SyntaxKind.MinusMinusToken}return!1}))}function ve(e){let[t,n]=Te(e.condition),[r,i]=Te(e.whenTrue),[s,o]=Te(e.whenFalse),a=n.concat(i).concat(o);return J(`${r} if ${Y(t)} else ${Y(s)}`,a)}function Te(t){if(ts.isBinaryExpression(t))return Z(t);if(ts.isPropertyAccessExpression(t))return ee(t);if(ts.isCallExpression(t))return se(t);if(ts.isNewExpression(t))return se(t);if(ts.isFunctionExpression(t)||ts.isArrowFunction(t))return ae(t);if(ts.isPrefixUnaryExpression(t))return ce(t);if(ts.isPostfixUnaryExpression(t))return ue(t);if(ts.isParenthesizedExpression(t))return he(t);if(ts.isArrayLiteralExpression(t))return de(t);if(ts.isElementAccessExpression(t))return pe(t);if(ts.isNoSubstitutionTemplateLiteral(t)||ts.isTaggedTemplateExpression(t))return fe(t);switch(t.kind){case ts.SyntaxKind.TrueKeyword:return J("True");case ts.SyntaxKind.FalseKeyword:return J("False");case ts.SyntaxKind.ThisKeyword:return J("self");case ts.SyntaxKind.NullKeyword:case ts.SyntaxKind.UndefinedKeyword:return J("None")}return ts.isIdentifier(t)?me(t):ts.isNumericLiteral(t)||ts.isStringLiteral(t)?J(t.getText()):ts.isConditionalExpression(t)?ve(t):ts.isAsExpression(t)&&ye(t)?Te(t.expression):(e.tickEvent("depython.todo.expression",{kind:t.kind}),n(t,3017,"Unsupported expression kind: "+t.kind))}}(r,i),a=i.replace(/(\.py)?\.\w*$/i,"")+".py";s.outfiles[a]=o}catch(t){t.pyDiagnostic?s.diagnostics=[t.pyDiagnostic]:e.reportException(t),s.success=!1}return s};function r(e){return n=>(n||"").split("\n").map((n=>`${t.INDENT.repeat(e)}${n}`)).join("\n")}t.INDENT="    ",t.indent=r,t.indent1=r(1)}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(e){!function(e){const t=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/;e.isIdentifierStart=function(e){return ts.pxtc.isIdentifierStart(e,ts.pxtc.ScriptTarget.ES5)},e.isIdentifierChar=function(e){return ts.pxtc.isIdentifierPart(e,ts.pxtc.ScriptTarget.ES5)},e.isSpace=function(e){return!!(32===e||9===e||11===e||12===e||160===e||e>=5760&&t.test(String.fromCharCode(e)))},e.isNewline=function(e){return 10===e||13===e||(8232===e||8233===e)}}(e.rx||(e.rx={}))}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(e){function t(e){const t={refs:[],children:[],owner:void 0};return function e(r){var i;if(!r)return t;if(ts.isPropertyAccessOrQualifiedName(r))return t;if(ts.isIdentifier(r))return{refs:[{kind:"read",node:r,varName:r.text}],children:[],owner:void 0};if(ts.isVariableDeclaration(r)||ts.isParameter(r)){const t=e(r.initializer);return{refs:[...t.refs,{kind:"decl",node:r,varName:r.name.getText()}],children:t.children,owner:void 0}}if(ts.isPrefixUnaryExpression(r)||ts.isPostfixUnaryExpression(r)){const t=e(r.operand),i=r.operand.getText();return n(t,{refs:[{kind:"assign",node:r,varName:i}],children:[],owner:void 0})}if(function(e){const t=[ts.SyntaxKind.EqualsToken,ts.SyntaxKind.PlusEqualsToken,ts.SyntaxKind.MinusEqualsToken,ts.SyntaxKind.AsteriskEqualsToken,ts.SyntaxKind.AsteriskAsteriskEqualsToken,ts.SyntaxKind.SlashEqualsToken,ts.SyntaxKind.PercentEqualsToken,ts.SyntaxKind.LessThanLessThanEqualsToken,ts.SyntaxKind.GreaterThanGreaterThanEqualsToken,ts.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,ts.SyntaxKind.AmpersandEqualsToken,ts.SyntaxKind.BarEqualsToken,ts.SyntaxKind.CaretEqualsToken];return ts.isBinaryExpression(e)&&t.some((t=>e.operatorToken.kind===t))}(r)){const t=e(r.right);let i;r.operatorToken.kind!==ts.SyntaxKind.EqualsToken&&(i=e(r.left));const s=r.left.getText();return n(i,n(t,{refs:[{kind:"assign",node:r,varName:s}],children:[],owner:void 0}))}if(ts.isFunctionExpression(r)||ts.isArrowFunction(r)||ts.isFunctionDeclaration(r)||ts.isMethodDeclaration(r)){const s=null===(i=r.name)||void 0===i?void 0:i.getText();let o;s&&(o={kind:"decl",node:r,varName:s});const a=r.parameters.map((t=>e(t))).reduce(n,t),l=e(r.body),c=n(a,l);return c.owner=r,{refs:o?[o]:[],children:[c],owner:void 0}}return r.getChildren().map(e).reduce(n,t)}(e);function n(e,n){return e&&n?{refs:[...e.refs,...n.refs],children:[...e.children,...n.children],owner:e.owner||n.owner}:e||n||t}}function n(e,t,r=[]){const i=[],s=[],o=[],a=[],l={};for(const n of e.refs)"read"===n.kind||"assign"===n.kind?l[n.varName]?o.push(n):d(n)?s.push(n):t&&t[n.varName]?i.push(n):a.push(n):l[n.varName]=n;const c=t||l,u=t?[...r,l]:[];return{globalUsage:i,nonlocalUsage:s,localUsage:o,environmentUsage:a,children:e.children.map((e=>n(e,c,u))),owner:e.owner};function d(e){return r.map((t=>t[e.varName])).reduce(((e,t)=>t||e),void 0)}}function r(e){return`${e.kind}:${e.varName}`}e.computeScopeVariableLookup=function(e){const r=n(t(e)),i=new Map,s=new Map;return function e(t){const n=a((r=t,[...r.globalUsage,...r.environmentUsage].filter((e=>"assign"===e.kind)).map((e=>e))));var r;i.set(t.owner,n);const o=a(function(e){return e.nonlocalUsage.filter((e=>"assign"===e.kind)).map((e=>e))}(t));s.set(t.owner,o),t.children.forEach(e)}(r),{getExplicitGlobals:e=>i.get(e)||[],getExplicitNonlocals:e=>s.get(e)||[]};function o(e){let t=e.node.operand||e.node.left;return ts.isIdentifier(t)?t:void 0}function a(e){return e.map(o).filter((e=>!!e)).map((e=>e)).reduce(((e,t)=>e.find((e=>e.text===t.text))?e:[...e,t]),[])}},e.toStringVariableScopes=function(i){const s=t(i),o=n(s);return function t(n){return[n.refs.map(r).join(", "),...n.children.map(t).map((t=>t.map(e.indent1))).map((e=>["{",...e,"}"])).reduce(((e,t)=>[...e,...t]),[])]}(s).join("\n")+"\n\n\n"+function(t){return function t(n){const i=n.globalUsage.map(r).join(", "),s=n.nonlocalUsage.map(r).join(", "),o=n.localUsage.map(r).join(", "),a=n.environmentUsage.map(r).join(", ");return[i?"global "+i:"",s?"nonlocal "+s:"",o?"local "+o:"",a?"env "+a:"",...n.children.map(t).map((t=>t.map(e.indent1))).map((e=>["{",...e,"}"])).reduce(((e,t)=>[...e,...t]),[])].filter((e=>!!e))}(t).join("\n")}(o)}}(e.py||(e.py={}))}(pxt||(pxt={})),function(e){!function(e){let t;e.makeFocusable=function(e){e.setAttribute("focusable","true"),e.setAttribute("tabindex","0")},e.enableKeyboardInteraction=function(e,t,n){t&&e.addEventListener("keydown",(e=>{const n="number"==typeof e.which?e.which:e.keyCode;32!==n&&13!==n||t()})),n&&e.addEventListener("keyup",(e=>{const t="number"==typeof e.which?e.which:e.keyCode;32!==t&&13!==t||n()}))},e.setAria=function(e,t,n){t&&!e.hasAttribute("role")&&e.setAttribute("role",t),n&&!e.hasAttribute("aria-label")&&e.setAttribute("aria-label",n)},e.setLiveContent=function(e){if(!t){let e="position: absolute !important;display: block;visibility: visible;overflow: hidden;width: 1px;height: 1px;margin: -1px;border: 0;padding: 0;clip: rect(0 0 0 0);";t=document.createElement("div"),t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-hidden","false"),t.setAttribute("style",e),document.body.appendChild(t)}t.textContent!==e&&(t.textContent=e)}}(e.accessibility||(e.accessibility={}))}(pxsim||(pxsim={})),function(e){const t="blue",n="red",r="orange";const i=e=>(e=>e.reduce(((e,t)=>e+(t?1:0)),0))(e)>0;function s(e,t){let n={};for(let t in e)n[t]=e[t];for(let e in t)n[e]=t[e];return n}function o(t){e.U.assert(!!t,"Invalid pin: "+t);const n=/^(\w+)\.\s*(?:[a-z]*)?([A-Z][A-Z\d_]+)$/.exec(t);return n?n[2]:void 0}function a(e){return"-Z"===e.orientation&&"male"===e.style}e.readPin=o;class l{constructor(t){this.availablePowerPins={top:{fiveVolt:e.mkRange(26,51).map((e=>({type:"breadboard",row:"+",col:`${e}`}))),threeVolt:e.mkRange(26,51).map((e=>({type:"breadboard",row:"+",col:`${e}`}))),ground:e.mkRange(26,51).map((e=>({type:"breadboard",row:"-",col:`${e}`})))},bottom:{fiveVolt:e.mkRange(1,26).map((e=>({type:"breadboard",row:"+",col:`${e}`}))),threeVolt:e.mkRange(1,26).map((e=>({type:"breadboard",row:"+",col:`${e}`}))),ground:e.mkRange(1,26).map((e=>({type:"breadboard",row:"-",col:`${e}`})))}},this.opts=t}allocPartIRs(e,t,n){let r=[];const i=(e,t,r,i)=>{let s=[];for(let t=0;t<e.numberOfPins;t++){let i,o=e.pinDefinitions[t];if("string"==typeof o.target)i=o.target;else{let e=o.target.pinInstantiationIdx;if(!r||void 0===r[e])return void console.log(`error: parts no pin found for PinInstantiationIdx: ${e}. (Is the part missing an ArgumentRole or "trackArgs=" annotations?)`);i=r[e]}let a=e.visual.pinLocations[t],l=n.yOffset+a.y,c=Math.round(l/e.visual.pinDistance),u=l-c*e.visual.pinDistance,d=n.xOffset+a.x,p=Math.round(d/e.visual.pinDistance),h={partRelativeRowIdx:c,partRelativeColIdx:p,xOffset:d-p*e.visual.pinDistance,yOffset:u};s.push({def:o,loc:a,target:i,bbFit:h})}return{name:t,def:e,pins:s,partParams:i||{},bbFit:n}},s=e.instantiations||[];return e.instantiation&&s.push(e.instantiation),s.forEach((n=>{if("singleton"===n.kind)r.push(i(e,t));else if("function"===n.kind){let s=n,a=s.fullyQualifiedName.split(","),l={};a.forEach((e=>{this.opts.fnArgs[e]&&this.opts.fnArgs[e].forEach((e=>{l[e]=1}))}));let c=Object.keys(l);if(!c||!c.length)return void console.log(`error: parts failed to read pin(s) from callsite for: ${a}`);c.forEach((n=>{const l=n.split(",");if(l.length!=s.argumentRoles.length)return void console.log(`error: parts mismatch between number of arguments at callsite (function name: ${a}) vs number of argument roles in part definition (part: ${t}).`);let c=[],u={};l.forEach(((e,t)=>{let n=s.argumentRoles[t];if(void 0!==n.partParameter&&(u[n.partParameter]=e),void 0!==n.pinInstantiationIdx){let t=n.pinInstantiationIdx,r=o(e);c[t]=r}})),r.push(i(e,t,c,u))}))}})),r.filter((e=>!!e))}computePartDimensions(t,n){let r=t.visual.pinLocations,i=t.pinDefinitions,o=t.numberOfPins;e.U.assert(r.length===o,`Mismatch between "numberOfPins" and length of "visual.pinLocations" for "${n}"`),e.U.assert(i.length===o,`Mismatch between "numberOfPins" and length of "pinDefinitions" for "${n}"`),e.U.assert(o>0,`Part "${n}" has no pins`);let a,l,c,u,d=r.map(((e,t)=>{return n={idx:t},r=e,o=i[t],s(s(n,r),o);var n,r,o})).filter((e=>"-Z"===e.orientation)),p=d.length>0,h=t.visual.pinDistance;if(p){let e=d[0],n=Math.ceil(e.x/h),r=Math.ceil(e.y/h);a=n*h-e.x,l=r*h-e.y,c=Math.ceil((a+t.visual.width)/h)+1,u=Math.ceil((l+t.visual.height)/h)+1}else c=Math.ceil(t.visual.width/h),u=Math.ceil(t.visual.height/h),a=c*h-t.visual.width,l=u*h-t.visual.height;return{xOffset:a,yOffset:l,rowCount:u,colCount:c}}allocColumns(t){let n=t.length;let r=e.visuals.BREADBOARD_MID_COLS-t.map((e=>e.colCount)).reduce(((e,t)=>e+t),0);r<=0&&console.log("Not enough breadboard space!");let i=Math.floor(r/(n-1+2)),s=r-i*(n-1),o=Math.floor(s/2),a=(Math.ceil(s/2),1+o);return t.map((e=>{let t=a;return a+=e.colCount+i,t}))}placeParts(t){const n=e.visuals.BREADBOARD_MID_ROWS+2;let r=this.allocColumns(t.map((e=>e.bbFit))),i=t.map((e=>{let t=n-e.bbFit.rowCount,r=Math.floor(t/2);return r>4&&(r=4),r<1&&(r=1),r}));return t.map(((e,t)=>{let n=i[t];return s({startColumnIdx:r[t],startRowIdx:n},e)}))}nextColor(){return(!this.availableWireColors||this.availableWireColors.length<=0)&&(this.availableWireColors=e.visuals.GPIO_WIRE_COLORS.map((e=>e))),this.availableWireColors.pop()}allocWireIRs(i){let o=[],l=i.pins.map(((s,l)=>{let c,u,d=s.target,p=i.startColumnIdx+s.bbFit.partRelativeColIdx,h=e.visuals.getColumnName(p),f=i.startRowIdx+s.bbFit.partRelativeRowIdx;if(f>=7&&(f-=2),a(s.def)){c={type:"breadboard",row:f<5?"j":"a",col:h,style:s.def.style}}else{c={type:"breadboard",row:e.visuals.getRowName(f),col:h,xOffset:s.bbFit.xOffset/i.def.visual.pinDistance,yOffset:s.bbFit.yOffset/i.def.visual.pinDistance,style:s.def.style}}return u="ground"===d?t:"threeVolt"===d?n:"fiveVolt"===d?r:"number"==typeof s.def.colorGroup?o[s.def.colorGroup]?o[s.def.colorGroup]:o[s.def.colorGroup]=this.nextColor():this.nextColor(),{start:c,end:d,color:u,pinIdx:l}}));return s(i,{wires:l})}allocLocation(t,n){if("ground"===t||"threeVolt"===t||"fiveVolt"==t){if("ground"===t&&this.powerUsage.singleGround){return{type:"dalboard",pin:this.getBoardGroundPin()}}if("threeVolt"===t&&this.powerUsage.singleThreeVolt){return{type:"dalboard",pin:this.getBoardThreeVoltPin()}}if("fiveVolt"===t&&this.powerUsage.singleFiveVolt){return{type:"dalboard",pin:this.getBoardFiveVoltPin()}}e.U.assert(!!n.referenceBBPin);let r=this.opts.getBBCoord(n.referenceBBPin),i=[this.availablePowerPins.top.ground[0]||this.availablePowerPins.top.threeVolt[0],this.availablePowerPins.bottom.ground[0]||this.availablePowerPins.bottom.threeVolt[0]].map((e=>this.opts.getBBCoord(e)));i[0]&&i[1]||console.debug(`No more available "${t}" locations!`);let s,o=0==e.visuals.findClosestCoordIdx(r,i);o?"ground"===t?s=this.availablePowerPins.top.ground:"threeVolt"===t?s=this.availablePowerPins.top.threeVolt:"fiveVolt"===t&&(s=this.availablePowerPins.top.fiveVolt):"ground"===t?s=this.availablePowerPins.bottom.ground:"threeVolt"===t?s=this.availablePowerPins.bottom.threeVolt:"fiveVolt"===t&&(s=this.availablePowerPins.bottom.fiveVolt);let a=s.map((e=>this.opts.getBBCoord(e))),l=e.visuals.findClosestCoordIdx(r,a),c=s[l];return o?(this.availablePowerPins.top.ground.splice(l,1),this.availablePowerPins.top.threeVolt.splice(l,1)):(this.availablePowerPins.bottom.ground.splice(l,1),this.availablePowerPins.bottom.threeVolt.splice(l,1)),c}if("breadboard"===t.type)return t;if("MOSI"===t||"MISO"===t||"SCK"===t){return this.opts.boardDef.spiPins||console.debug("No SPI pin mappings found!"),{type:"dalboard",pin:this.opts.boardDef.spiPins[t]}}if("SDA"===t||"SCL"===t){return this.opts.boardDef.i2cPins||console.debug("No I2C pin mappings found!"),{type:"dalboard",pin:this.opts.boardDef.i2cPins[t]}}{e.U.assert("string"==typeof t,"Unknown location type: "+t);let n=t,r=this.opts.boardDef.gpioPinMap[n]||n;return r?{type:"dalboard",pin:r}:void console.debug(`unknown pin location for ${n}`)}}getBoardGroundPin(){let e=this.opts.boardDef.groundPins&&this.opts.boardDef.groundPins[0]||null;return e||console.debug("No available ground pin on board!"),e}getBoardThreeVoltPin(){let e=this.opts.boardDef.threeVoltPins&&this.opts.boardDef.threeVoltPins[0]||null;return e||console.debug("No available 3.3V pin on board!"),e}getBoardFiveVoltPin(){let e=this.opts.boardDef.fiveVoltPins&&this.opts.boardDef.fiveVoltPins[0]||null;return e||console.debug("No available 5V pin on board!"),e}allocPowerWires(e){let i=this.getBoardGroundPin(),s=this.getBoardThreeVoltPin(),o=this.getBoardFiveVoltPin();const a={type:"breadboard",row:"-",col:"26"},l={type:"breadboard",row:"-",col:"1"},c={type:"breadboard",row:"-",col:"50"},u={type:"breadboard",row:"-",col:"25"};let d,p;this.opts.boardDef.attachPowerOnRight?(d=c,p=u):(d=a,p=l);let h=[],f=[],m=[];e.bottomGround&&e.topGround&&h.push({start:this.allocLocation("ground",{referenceBBPin:d}),end:this.allocLocation("ground",{referenceBBPin:p}),color:t}),e.topGround?h.push({start:this.allocLocation("ground",{referenceBBPin:d}),end:{type:"dalboard",pin:i},color:t}):e.bottomGround&&h.push({start:this.allocLocation("ground",{referenceBBPin:p}),end:{type:"dalboard",pin:i},color:t}),e.bottomThreeVolt&&e.bottomGround?f.push({start:this.allocLocation("threeVolt",{referenceBBPin:d}),end:this.allocLocation("threeVolt",{referenceBBPin:p}),color:n}):e.bottomFiveVolt&&e.bottomGround&&m.push({start:this.allocLocation("fiveVolt",{referenceBBPin:d}),end:this.allocLocation("fiveVolt",{referenceBBPin:p}),color:r}),e.topThreeVolt?f.push({start:this.allocLocation("threeVolt",{referenceBBPin:d}),end:{type:"dalboard",pin:s},color:n}):e.bottomThreeVolt&&f.push({start:this.allocLocation("threeVolt",{referenceBBPin:p}),end:{type:"dalboard",pin:s},color:r}),e.topFiveVolt&&!e.topThreeVolt?m.push({start:this.allocLocation("fiveVolt",{referenceBBPin:d}),end:{type:"dalboard",pin:o},color:n}):e.bottomFiveVolt&&!e.bottomThreeVolt&&m.push({start:this.allocLocation("fiveVolt",{referenceBBPin:p}),end:{type:"dalboard",pin:o},color:r});let _=[];h.length>0&&_.push({wireIndices:h.map(((e,t)=>t))});let g=h.length;return f.length>0&&_.push({wireIndices:f.map(((e,t)=>t+g))}),m.length>0&&_.push({wireIndices:f.map(((e,t)=>t+g+f.length))}),{wires:h.concat(f).concat(m),assembly:_}}allocWire(e){const t=[e.start,e.end],n=t.map((e=>"ground"===e||"threeVolt"===e||"fiveVolt"===e));let r=t.map(((e,t)=>n[t]?void 0:this.allocLocation(e,{})));if(r=r.map(((e,n)=>{if(e)return e;const i=r[1-n];return this.allocLocation(t[n],{referenceBBPin:i})})),r[0]&&r[1])return{start:r[0],end:r[1],color:e.color}}allocPart(t){let n=t.pins.filter((e=>a(e.def))).map((n=>{let r=t.startRowIdx+n.bbFit.partRelativeRowIdx;r>=7&&(r-=2);let i=e.visuals.getRowName(r),s=t.startColumnIdx+n.bbFit.partRelativeColIdx;return{type:"breadboard",row:i,col:e.visuals.getColumnName(s)}}));return{name:t.name,visual:t.def.visual,bbFit:t.bbFit,startColumnIdx:t.startColumnIdx,startRowIdx:t.startRowIdx,breadboardConnections:n,params:t.partParams,simulationBehavior:t.def.simulationBehavior}}allocAll(){let e=this.opts.partsList.map((e=>({name:e,def:this.opts.partDefs[e]}))).filter((e=>!!e.def));if(e.length>0){let t=e.map((e=>this.computePartDimensions(e.def,e.name))),n=[];e.forEach(((e,r)=>{let i=t[r],s=this.allocPartIRs(e.def,e.name,i);n=n.concat(s)}));const r=this.placeParts(n).map((e=>this.allocWireIRs(e))),s=r.map((e=>e.wires)).reduce(((e,t)=>e.concat(t)),[]).map((e=>function(e){let t=[e.start,e.end],n=t.map((e=>"ground"===e)),r=t.map((e=>"threeVolt"===e)),s=t.map((e=>"fiveVolt"===e)),o=t.map((e=>function(e){let t=!1;if("string"!=typeof e&&"breadboard"===e.type){let n=e.row;t=0<=["a","b","c","d","e"].indexOf(n)}return t}(e))),a=i(n),l=i(r),c=i(s),u=i(o);return{topGround:a&&!u,topThreeVolt:l&&!u,topFiveVolt:c&&!u,bottomGround:a&&u,bottomThreeVolt:l&&u,bottomFiveVolt:c&&u,singleGround:a,singleThreeVolt:l,singleFiveVolt:c}}(e)));this.powerUsage=function(e){const t=e.reduce(((e,t)=>({topGround:e.topGround||t.topGround,topThreeVolt:e.topThreeVolt||t.topThreeVolt,topFiveVolt:e.topFiveVolt||t.topFiveVolt,bottomGround:e.bottomGround||t.bottomGround,bottomThreeVolt:e.bottomThreeVolt||t.bottomThreeVolt,bottomFiveVolt:e.bottomFiveVolt||t.bottomFiveVolt,singleGround:t.singleGround?null===e.singleGround:e.singleGround,singleThreeVolt:t.singleThreeVolt?null===e.singleThreeVolt:e.singleThreeVolt,singleFiveVolt:t.singleFiveVolt?null===e.singleFiveVolt:e.singleFiveVolt})),{topGround:!1,topThreeVolt:!1,topFiveVolt:!1,bottomGround:!1,bottomThreeVolt:!1,bottomFiveVolt:!1,singleGround:null,singleThreeVolt:null,singleFiveVolt:null});return t.singleGround&&(t.topGround=t.bottomGround=!1),t.singleThreeVolt&&(t.topThreeVolt=t.bottomThreeVolt=!1),t.singleFiveVolt&&(t.topFiveVolt=t.bottomFiveVolt=!1),t}(s);const o=this.allocPowerWires(this.powerUsage),a=r.map(((e,t)=>{const n=this.allocPart(e),r=e.wires.map((e=>this.allocWire(e)));if(r.some((e=>!e)))return;const i=[];e.wires.forEach(((e,t)=>{i[e.pinIdx]=t}));return{part:n,wires:r,assembly:e.def.assembly.map((e=>({part:e.part,wireIndices:(e.pinIndices||[]).map((e=>i[e]))})))}})).filter((e=>!!e)),l=[o].concat(a).filter((e=>e.assembly&&e.assembly.length)),c=!l.some((e=>e.part&&e.part.breadboardConnections&&e.part.breadboardConnections.length>0||e.wires&&e.wires.some((e=>"breadboard"==e.end.type&&"croc"!=e.end.style||"breadboard"==e.start.type&&"croc"!=e.start.style))));return{partsAndWires:l,wires:[],parts:[],hideBreadboard:c}}return{partsAndWires:[],wires:[],parts:[]}}}e.allocateDefinitions=function(e){return new l(e).allocAll()}}(pxsim||(pxsim={})),function(e){!function(e){class t{constructor(e){this.seq=0,this.type=e}}e.Message=t;e.Response=class extends t{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};class n extends t{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}e.Event=n;e.Source=class{constructor(e,t,n=0,r,i){this.name=e,this.path=t,this.sourceReference=n,r&&(this.origin=r),i&&(this.adapterData=i)}};e.Scope=class{constructor(e,t,n=!1){this.name=e,this.variablesReference=t,this.expensive=n}};e.StackFrame=class{constructor(e,t,n,r=0,i=0){this.id=e,this.source=n,this.line=r,this.column=i,this.name=t}};e.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};e.Variable=class{constructor(e,t,n=0,r,i){this.name=e,this.value=t,this.variablesReference=n,"number"==typeof i&&(this.namedVariables=i),"number"==typeof r&&(this.indexedVariables=r)}};e.Breakpoint=class{constructor(e,t,n,r){this.verified=e;const i=this;"number"==typeof t&&(i.line=t),"number"==typeof n&&(i.column=n),r&&(i.source=r)}};e.Module=class{constructor(e,t){this.id=e,this.name=t}};e.CompletionItem=class{constructor(e,t,n=0){this.label=e,this.start=t,this.length=n}};e.StoppedEvent=class extends n{constructor(e,t,n=null){if(super("stopped"),this.body={reason:e,threadId:t},n){this.body.text=n}}};e.ContinuedEvent=class extends n{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}};e.InitializedEvent=class extends n{constructor(){super("initialized")}};e.TerminatedEvent=class extends n{constructor(e){if(super("terminated"),"boolean"==typeof e){this.body={restart:e}}}};e.OutputEvent=class extends n{constructor(e,t="console",n){super("output"),this.body={category:t,output:e},void 0!==n&&(this.body.data=n)}};e.ThreadEvent=class extends n{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}};e.BreakpointEvent=class extends n{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}};e.ModuleEvent=class extends n{constructor(e,t){super("module"),this.body={reason:e,module:t}}};class r{constructor(){this._pendingRequests={}}start(e){this._sequence=1,this.host=e,this.host.onData((e=>{if("request"===e.type)this.dispatchRequest(e);else if("response"===e.type){const t=e,n=this._pendingRequests[t.seq];n&&(delete this._pendingRequests[t.seq],n(t))}}))}stop(){this.host&&this.host.close()}sendEvent(e){this.send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this.send("response",e)}sendRequest(t,n,r,i){const s={command:t};if(n&&Object.keys(n).length>0&&(s.arguments=n),this.send("request",s),i){this._pendingRequests[s.seq]=i;const t=setTimeout((()=>{clearTimeout(t);const n=this._pendingRequests[s.seq];n&&(delete this._pendingRequests[s.seq],n(new e.Response(s,"timeout")))}),r)}}send(e,t){if(t.type=e,t.seq=this._sequence++,this.host){const e=JSON.stringify(t);this.host.send(e)}}dispatchRequest(e){}}e.ProtocolServer=r;class i extends r{constructor(){super(...arguments),this._debuggerLinesStartAt1=!1,this._debuggerColumnsStartAt1=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0}shutdown(){}dispatchRequest(t){const n=new e.Response(t);try{if("initialize"===t.command){let e=t.arguments;if("boolean"==typeof e.linesStartAt1&&(this._clientLinesStartAt1=e.linesStartAt1),"boolean"==typeof e.columnsStartAt1&&(this._clientColumnsStartAt1=e.columnsStartAt1),"path"!==e.pathFormat)this.sendErrorResponse(n,2018,"debug adapter only supports native paths",null);else{const t=n;t.body={},this.initializeRequest(t,e)}}else"launch"===t.command?this.launchRequest(n,t.arguments):"attach"===t.command?this.attachRequest(n,t.arguments):"disconnect"===t.command?this.disconnectRequest(n,t.arguments):"setBreakpoints"===t.command?this.setBreakPointsRequest(n,t.arguments):"setFunctionBreakpoints"===t.command?this.setFunctionBreakPointsRequest(n,t.arguments):"setExceptionBreakpoints"===t.command?this.setExceptionBreakPointsRequest(n,t.arguments):"configurationDone"===t.command?this.configurationDoneRequest(n,t.arguments):"continue"===t.command?this.continueRequest(n,t.arguments):"next"===t.command?this.nextRequest(n,t.arguments):"stepIn"===t.command?this.stepInRequest(n,t.arguments):"stepOut"===t.command?this.stepOutRequest(n,t.arguments):"stepBack"===t.command?this.stepBackRequest(n,t.arguments):"restartFrame"===t.command?this.restartFrameRequest(n,t.arguments):"goto"===t.command?this.gotoRequest(n,t.arguments):"pause"===t.command?this.pauseRequest(n,t.arguments):"stackTrace"===t.command?this.stackTraceRequest(n,t.arguments):"scopes"===t.command?this.scopesRequest(n,t.arguments):"variables"===t.command?this.variablesRequest(n,t.arguments):"setVariable"===t.command?this.setVariableRequest(n,t.arguments):"source"===t.command?this.sourceRequest(n,t.arguments):"threads"===t.command?this.threadsRequest(n):"evaluate"===t.command?this.evaluateRequest(n,t.arguments):"stepInTargets"===t.command?this.stepInTargetsRequest(n,t.arguments):"gotoTargets"===t.command?this.gotoTargetsRequest(n,t.arguments):"completions"===t.command?this.completionsRequest(n,t.arguments):this.customRequest(t.command,n,t.arguments)}catch(e){this.sendErrorResponse(n,1104,"{_stack}",{_exception:e.message,_stack:e.stack})}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}customRequest(e,t,n){this.sendErrorResponse(t,1014,"unrecognized request",null)}sendErrorResponse(e,t,n,r){let s;"number"==typeof t?(s={id:t,format:n},r&&(s.variables=r),s.showUser=!0):s=t,e.success=!1,i.formatPII(s.format,!0,s.variables),e.body||(e.body={}),e.body.error=s,this.sendResponse(e)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!=this._debuggerPathsAreURIs?this._clientPathsAreURIs?i.uri2path(e):i.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!=this._clientPathsAreURIs?this._debuggerPathsAreURIs?i.uri2path(e):i.path2uri(e):e}static path2uri(e){let t=e.replace(/\\/g,"/");return"/"!==t[0]&&(t="/"+t),encodeURI("file://"+t)}static uri2path(e){return e}static formatPII(e,t,n){return e.replace(i._formatPIIRegexp,(function(e,r){return t&&r.length>0&&"_"!==r[0]?e:n[r]&&n.hasOwnProperty(r)?n[r]:e}))}}i._formatPIIRegexp=/{([^}]+)}/g,e.DebugSession=i}(e.protocol||(e.protocol={}))}(pxsim||(pxsim={})),function(e){!function(e){e.injectPolyphils=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return void 0!==e&&null!=e&&(t=!t||t<0?0:+t,this.substring(t,t+e.length)===e)}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{writable:!0,enumerable:!0,value:function(e){if(null==this)throw new TypeError("this is null or not defined");let t=Object(this),n=t.length>>>0,r=arguments[1],i=r>>0,s=i<0?Math.max(n+i,0):Math.min(i,n),o=arguments[2],a=void 0===o?n:o>>0,l=a<0?Math.max(n+a,0):Math.min(a,n);for(;s<l;)t[s]=e,s++;return t}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{writable:!0,enumerable:!0,value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');let t=Object(this);const n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");const r=arguments[1];let i=0;for(;i<n;){const n=t[i];if(e.call(r,n,i,t))return n;i++}}}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint16Array.prototype.slice||Object.defineProperty(Uint16Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint32Array.prototype.slice||Object.defineProperty(Uint32Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint8Array.prototype.fill||Object.defineProperty(Uint8Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint16Array.prototype.fill||Object.defineProperty(Uint16Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint32Array.prototype.fill||Object.defineProperty(Uint32Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint8Array.prototype.some||Object.defineProperty(Uint8Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint16Array.prototype.some||Object.defineProperty(Uint16Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint32Array.prototype.some||Object.defineProperty(Uint32Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint8Array.prototype.reverse||Object.defineProperty(Uint8Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Uint16Array.prototype.reverse||Object.defineProperty(Uint16Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Uint32Array.prototype.reverse||Object.defineProperty(Uint32Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Math.imul||(Math.imul=function(e,t){const n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");let n=Object(e);for(let e=1;e<arguments.length;e++){let t=arguments[e];if(null!=t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},writable:!0,configurable:!0}),Promise.prototype.finally||(Promise.prototype.finally=Promise.prototype.finally||{finally(e){const t=t=>Promise.resolve(e()).then(t);return this.then((e=>t((()=>e))),(e=>t((()=>Promise.reject(e)))))}}.finally)};function t(e){e=e.replace(/\\/g,"/");const t=[];return e.split("/").forEach((e=>{".."===e&&t.length?t.pop():e&&"."!==e&&t.push(e)})),t}e.Lazy=class{constructor(e){this._func=e,this._evaluated=!1}get value(){return this._evaluated||(this._value=this._func(),this._evaluated=!0),this._value}},e.getNormalizedParts=t,e.normalizePath=function(e){return t(e).join("/")},e.relativePath=function(e,n){const r=t(e),i=t(n);let s=0;for(;r[s]===i[s]&&(s++,s!==r.length&&s!==i.length););const o=r.slice(s),a=i.slice(s);for(let e=0;e<o.length;e++)a.unshift("..");return a.join("/")},e.pathJoin=function(...e){let t="";return e.forEach((e=>{e.replace(/\\/g,"/"),e.lastIndexOf("/")===e.length-1&&(e=e.slice(0,e.length-1)),t+="/"+e})),t},e.toArray=function(e){if(Array.isArray(e))return e;let t=[];for(let n=0;n<e.length;++n)t.push(e[n]);return t}}(e.util||(e.util={}))}(pxsim||(pxsim={})),function(e){e.getWarningMessage=function(t){let n={type:"debugger",subtype:"warning",breakpointIds:[],message:t},r=e.runtime.currFrame;for(;null!=r;)n.breakpointIds.push(r.lastBrkId),r=r.parent;return n};function t(t,n){switch(typeof t){case"string":case"number":case"boolean":return t;case"function":return{text:"(function)",type:"function"};case"undefined":return null;case"object":if(!t)return null;if(t instanceof e.RefObject){n&&(n[t.id]=t);let r=e.RefObject.toDebugString(t),i=r.startsWith("[")?"array":r;return{id:t.id,preview:r,hasFields:null!==t.fields||r.startsWith("["),type:i}}return t._width&&t._height?{text:t._width+"x"+t._height,type:"image"}:{text:"(object)",type:"object"};default:throw new Error}}function n(e,n,i,s){return function(e,i){const o={};for(let r of Object.keys(e))/^__/.test(r)||!/___\d+$/.test(r)||s&&-1===s.indexOf(r)||(o[r]=t(e[r],n));if(e.fields&&i)for(let s of i)s=s.substring(s.lastIndexOf(".")+1),o[s]=t(r(e.vtable.iface[s],e),n);if(e.fields)for(let r of Object.keys(e.fields).filter((e=>!e.startsWith("_"))))o[r]=t(e.fields[r],n);else Array.isArray(e.data)&&e.data.forEach(((e,r)=>{o[r]=t(e,n)}));return o}(e,i)}function r(e,t){let n={pc:0,arg0:t,fn:e,parent:{}};for(;n.fn;)n=n.fn(n);return n.retval}function i(e,r){let i=e.fn?e.fn.info:null;if(i){let s={thisParam:t(e.argL,r),params:[]};if(i.argumentNames){const n=i.argumentNames;s.params=n.map(((n,i)=>({name:n,value:t(e["arg"+i],r)})))}return{locals:n(e,r),funcInfo:i,breakpointId:e.lastBrkId,callLocationId:e.callLocIdx,arguments:s}}}e.BreakpointMap=class{constructor(e){this.fileMap={},this.idMap={},e.forEach((e=>{const[t,n]=e;this.fileMap[n.source.path]||(this.fileMap[n.source.path]=[]),this.fileMap[n.source.path].push(e),this.idMap[t]=n}));for(const e in this.fileMap){const t=this.fileMap[e];this.fileMap[e]=t.sort((([,e],[,t])=>e.line===t.line?t.endLine===e.endLine?e.column-t.column:t.endLine-e.endLine:e.line-t.line))}}getById(e){return this.idMap[e]}verifyBreakpoint(e,t){const n=this.fileMap[e];let r;if(n)for(const[e,i]of n)i.line<=t.line&&i.endLine>=t.line&&(r=[e,i]);return r?(r[1].verified=!0,r):[-1,{verified:!1}]}},e.dumpHeap=n,e.injectEnvironmentGlobals=function(n,r){const i=e.runtime.environmentGlobals;if(!Object.keys(i).length)return;const s=n.environmentGlobals={};Object.keys(i).forEach((n=>s[n]=t(e.runtime.environmentGlobals[n],r)))},e.getBreakpointMsg=function(t,r,s){const o={},a={type:"debugger",subtype:"breakpoint",breakpointId:r,globals:n(e.runtime.globals,o,void 0,s),stackframes:[]};for(;null!=t;){let e=i(t,o);e&&a.stackframes.push(e),t=t.parent}return{msg:a,heap:o}};class s extends e.protocol.DebugSession{constructor(t){super();let n={onDebuggerBreakpoint:e=>this.onDebuggerBreakpoint(e),onDebuggerWarning:e=>this.onDebuggerWarning(e),onDebuggerResume:()=>this.onDebuggerResume(),onStateChanged:e=>this.onStateChanged(e)};this.driver=new e.SimulatorDriver(t,n)}runCode(t,n,r,i,s){this.breakpoints=i,this.projectDir&&this.fixBreakpoints(),this.sendEvent(new e.protocol.InitializedEvent),this.driver.run(t,{parts:n,fnArgs:r,boardDefinition:s})}stopSimulator(e=!1){this.driver.stop(e)}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsConfigurationDoneRequest=!0,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(t,n){this.projectDir||(this.projectDir=e.util.normalizePath(n.projectDir),this.breakpoints&&this.fixBreakpoints()),this.sendResponse(t)}setBreakPointsRequest(t,n){t.body={breakpoints:[]};const r=[];n.breakpoints.forEach((i=>{if(this.breakpoints){const[s,o]=this.breakpoints.verifyBreakpoint(e.util.relativePath(this.projectDir,n.source.path),i);t.body.breakpoints.push(o),o.verified&&r.push(s)}else t.body.breakpoints.push({verified:!1})})),this.driver.setBreakpoints(r),this.sendResponse(t)}continueRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.Resume),this.sendResponse(t)}nextRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.StepOver),this.sendResponse(t)}stepInRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.StepInto),this.sendResponse(t)}stepOutRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.StepOut),this.sendResponse(t)}pauseRequest(t,n){this.driver.resume(e.SimulatorDebuggerCommand.Pause),this.sendResponse(t)}threadsRequest(e){e.body={threads:[{id:s.THREAD_ID,name:"main"}]},this.sendResponse(e)}stackTraceRequest(e,t){if(this.lastBreak){const t=this.state.getFrames();e.body={stackFrames:t}}this.sendResponse(e)}scopesRequest(e,t){this.state&&(e.body={scopes:this.state.getScopes(t.frameId)}),this.sendResponse(e)}variablesRequest(e,t){this.state&&(e.body={variables:this.state.getVariables(t.variablesReference)}),this.sendResponse(e)}onDebuggerBreakpoint(t){if(this.lastBreak=t,this.state=new o(this.lastBreak,this.breakpoints,this.projectDir),t.exceptionMessage){const n=t.exceptionMessage.replace(/___\d+/g,"");this.sendEvent(new e.protocol.StoppedEvent("exception",s.THREAD_ID,n))}else this.sendEvent(new e.protocol.StoppedEvent("breakpoint",s.THREAD_ID))}onDebuggerWarning(e){}onDebuggerResume(){this.sendEvent(new e.protocol.ContinuedEvent(s.THREAD_ID,!0))}onStateChanged(t){switch(t){case e.SimulatorState.Paused:break;case e.SimulatorState.Running:this.sendEvent(new e.protocol.ContinuedEvent(s.THREAD_ID,!0));break;case e.SimulatorState.Stopped:this.sendEvent(new e.protocol.TerminatedEvent)}}fixBreakpoints(){for(const t in this.breakpoints.idMap){const n=this.breakpoints.idMap[t];n.source.path=e.util.pathJoin(this.projectDir,n.source.path),n.line=this.convertDebuggerLineToClient(n.line),n.endLine=this.convertDebuggerLineToClient(n.endLine),n.column=this.convertDebuggerColumnToClient(n.column),n.endColumn=this.convertDebuggerColumnToClient(n.endColumn)}}}s.THREAD_ID=1,e.SimDebugSession=s;class o{constructor(e,t,n){this._message=e,this._map=t,this._dir=n,this._currentId=1,this._frames={},this._vars={};const r=this.nextId();this._vars[r]=this.getVariableValues(this._message.globals),this._globalScope={name:"Globals",variablesReference:r,expensive:!1}}getFrames(){return this._message.stackframes.map(((e,t)=>{const n=this._map.getById(e.breakpointId);if(n)return this._frames[e.breakpointId]=e,{id:e.breakpointId,name:e.funcInfo?e.funcInfo.functionName:0===t?"main":"anonymous",line:n.line,column:n.column,endLine:n.endLine,endColumn:n.endLine,source:n.source}})).filter((e=>!!e))}getScopes(e){const t=this._frames[e];if(t){const e=this.nextId();return this._vars[e]=this.getVariableValues(t.locals),[{name:"Locals",variablesReference:e,expensive:!1},this._globalScope]}return[this._globalScope]}getVariables(e){const t=this._vars[e];return t&&t.value||[]}getVariableValues(t){return new e.util.Lazy((()=>{const e=[];for(const n in t){const r=t[n];let i,s=0;null===r?i="null":void 0===r?i="undefined":"object"==typeof r?(i="(object)",s=this.nextId(),this._vars[s]=this.getVariableValues(r)):i=r.toString();const o=n.substr(0,n.lastIndexOf("___"));e.push({name:o,value:i,variablesReference:s})}return e}))}nextId(){return this._currentId++}}}(pxsim||(pxsim={})),function(e){let t,n;function r(e=0){function t(){try{window.print()}catch(e){}}e?setTimeout(t,e):t()}function i(e,t){s({type:"pxtsim",action:"event",tick:e,data:t})}function s(e){"undefined"!=typeof window&&window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}function o(){setInterval((()=>{e.Runtime.postMessage({type:"simulator",command:"reload"})}),3e3)}!function(e){let t;!function(e){e[e.Player=0]="Player",e[e.Reaction=1]="Reaction"}(t=e.IconType||(e.IconType={}))}(t=e.multiplayer||(e.multiplayer={})),e.print=r,function(t){function n(t){t.origin;let n=t.data||{},o=n.type;if(o)switch(o){case"run":l(n);break;case"instructions":e.instructions.renderInstructions(n);break;case"stop":a();break;case"mute":c(n.mute);break;case"stopsound":e.AudioContextManager.stopAll();break;case"print":r();break;case"recorder":!function(e){if(!s)return;switch(e.action){case"start":s.startRecording(e.width);break;case"stop":s.stopRecording()}}(n);break;case"screenshot":e.Runtime.postScreenshotAsync(n);break;case"custom":e.handleCustomMessage&&e.handleCustomMessage(n);break;case"pxteditor":break;case"debugger":s&&s.handleDebuggerMsg(n);break;case"simulator":let t=n;switch(t.command){case"focus":i("simulator.focus",{timestamp:t.timestamp});break;case"blur":i("simulator.blur",{timestamp:t.timestamp})}default:!function(e){if(!s||s.dead)return;s.board.receiveMessage(e)}(n)}}let s;function a(){s&&(s.kill(),s.board&&s.board.kill())}function l(t){a(),t.mute&&c(t.mute),t.localizedStrings&&e.localization.setLocalizedStrings(t.localizedStrings);const n=new e.Runtime(t);s=n,n.board.initAsync(t).then((()=>{n===s&&n.run((t=>{e.dumpLivePointers(),e.Runtime.postMessage({type:"toplevelcodefinished"})}))}))}function c(t){e.AudioContextManager.mute(t)}t.start=function(){window.addEventListener("message",n,!1),t.frameid=window.location.hash.slice(1),function(){if("serviceWorker"in navigator&&-1!==window.location.href.indexOf("---simulator")&&!e.U.isLocalHost()){const e=window.location.pathname,t=e.substring(1,e.indexOf("---"));navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("message",(e=>{const n=e.data;n&&"serviceworker"===n.type&&"activated"===n.state&&n.ref===t&&o()}));const n=window.location.href.replace(/---simulator.*$/,"---simserviceworker");navigator.serviceWorker.register(n).then((function(e){console.log("Simulator ServiceWorker registration successful with scope: ",e.scope)}),(function(e){console.log("Simulator ServiceWorker registration failed: ",e)}))}}(),e.Runtime.postMessage({type:"ready",frameid:t.frameid})},t.stop=a,t.run=l}(n=e.Embed||(e.Embed={})),e.tickEvent=i,e.reportError=function(e,t,n){s({type:"pxtsim",action:"event",tick:"error",category:e,message:t,data:n})},e.reload=o}(pxsim||(pxsim={})),pxsim.util.injectPolyphils(),"undefined"!=typeof window&&window.addEventListener("load",(function(e){pxsim.Embed.start()})),function(e){!function(t){const n=e=>`${e}x`,r=.95,[i,s]=[816*r,1056*r],o=i-86.4,a=s-86.4,[l,c]=[1,1],u=24,d=o/c-48*c,p=`\n            .instr-panel {\n                margin: 20px;\n                padding: 24px;\n                border-width: 4px;\n                border-color: gray;\n                border-style: solid;\n                border-radius: 20px;\n                display: inline-block;\n                width: ${d}px;\n                height: ${a/l-48*l}px;\n                position: relative;\n                overflow: hidden;\n                page-break-inside: avoid;\n            }\n            .board-svg {\n                margin: 0 auto;\n                display: block;\n                position: absolute;\n                bottom: 24px;\n                left: ${(d-465)/2+u}px;\n            }\n            .panel-num-outer {\n                position: absolute;\n                left: -4px;\n                top: -4px;\n                width: 120px;\n                height: 120px;\n                border-width: 4px;\n                border-style: solid;\n                border-color: gray;\n                border-radius: 20px 0 20px 0;\n            }\n            .panel-num {\n                margin: 10px 0;\n                text-align: center;\n                font-size: 80px;\n            }\n            .cmp-div {\n                display: inline-block;\n            }\n            .reqs-div {\n                margin-left: 144px;\n                margin-top: 5px;\n            }\n            .partslist-wire,\n            .partslist-cmp {\n                margin: 10px;\n            }\n            .partslist-wire {\n                display: inline-block;\n            }\n            `;function h(t,n){let r=document.createElementNS("http://www.w3.org/2000/svg","svg"),i={l:0,t:0,w:0,h:0},s=document.createElementNS("http://www.w3.org/2000/svg","svg");r.appendChild(s),s.appendChild(t.el);let o={viewBox:`${t.x} ${t.y} ${t.w} ${t.h}`,preserveAspectRatio:"xMidYMid"};i.w=t.w,i.h=t.h;let a=e=>{i.h*=e,i.w*=e,o.width=i.w,o.height=i.h};n.cmpScale&&a(n.cmpScale),n.cmpWidth&&n.cmpWidth<i.w?a(n.cmpWidth/i.w):n.cmpHeight&&n.cmpHeight<i.h&&a(n.cmpHeight/i.h),e.svg.hydrate(s,o);let l=i.l,c=i.t,u=i.w,d=i.h,p=e=>{if(e<i.l){let t=i.l-e;i.l=e,i.w+=t}},h=e=>{let t=i.l+i.w;if(t<e){let n=e-t;i.w+=n}},f=e=>{if(e<i.t){let t=i.t-e;i.t=e,i.h+=t}},m=e=>{let t=i.t+i.h;if(t<e){let n=e-t;i.h+=n}},[_,g]=[-.3,.3];const y=[1.4,1];if(n&&n.top){let t=n.topSize,i=t/y[0],s=t/y[1],[o,a]=[l+u/2,c-3-s/2],d=e.visuals.mkTxt(o,a,t,0,n.top,_,g);e.U.addClass(d,"cmp-lbl"),r.appendChild(d);let m=i*n.top.length;f(a-s/2),p(o-m/2),h(o+m/2)}if(n&&n.bot){let t=n.botSize,i=t/y[0],s=t/y[1],[o,a]=[l+u/2,c+d+3+s/2],f=e.visuals.mkTxt(o,a,t,0,n.bot,_,g);e.U.addClass(f,"cmp-lbl"),r.appendChild(f);let b=i*n.bot.length;m(a+s/2),p(o-b/2),h(o+b/2)}if(n&&n.right){let t=n.rightSize,i=t/y[1],s=t/y[0]*n.right.length,[o,a]=[l+u+5+s/2,c+d/2],p=e.visuals.mkTxt(o,a,t,0,n.right,_,g);e.U.addClass(p,"cmp-lbl"),r.appendChild(p),f(a-i/2),h(o+s/2),m(a+i/2)}if(n&&n.left){let t=n.leftSize,i=t/y[1],s=t/y[0]*n.left.length,[o,a]=[l-5-s/2,c+d/2],u=e.visuals.mkTxt(o,a,t,0,n.left,_,g);e.U.addClass(u,"cmp-lbl"),r.appendChild(u),f(a-i/2),p(o-s/2),m(a+i/2)}let b={viewBox:`${i.l} ${i.t} ${i.w} ${i.h}`,width:1.7*i.w,height:1.7*i.h,preserveAspectRatio:"xMidYMid"};e.svg.hydrate(r,b);let v=document.createElement("div");return v.appendChild(r),v}function f(t,n){let r,i=e.runtime.board;if("wire"==t)r=e.visuals.mkWirePart([0,0],n.wireClr||"red",n.crocClips);else{let n=t;if("string"==typeof n.builtIn){r=(0,i.builtinPartVisuals[n.builtIn])([0,0])}else r=e.visuals.mkGenericPartSVG(n)}return h(r,n)}function m(t,n,r=!1){const i={state:e.runtime.board,boardDef:t.boardDef,forceBreadboardLayout:!0,forceBreadboardRender:t.allAlloc.requiresBreadboard,partDefs:t.cmpDefs,maxWidth:`${n}px`,fnArgs:t.fnArgs,wireframe:r,partsList:[]};let s=new e.visuals.BoardHost(e.visuals.mkBoardView({visual:i.boardDef.visual,boardDef:i.boardDef,wireframe:i.wireframe}),i),o=s.getView();return e.U.addClass(o,"board-svg"),s}function _(){let t=document.createElement("div");return e.U.addClass(t,"instr-panel"),t}function g(t){let r=_();var i;let s=h((i=t.boardDef,e.visuals.mkBoardView({visual:i.visual,boardDef:i}).getView()),{left:n(1),leftSize:30,cmpScale:.17});r.appendChild(s);let o=h(new e.visuals.Breadboard({}).getSVGAndSize(),{left:n(1),leftSize:30,cmpScale:.25});return r.appendChild(o),t.allCmps.forEach((t=>{let i=1;"buttonpair"===t.visual.builtIn&&(i=2);let s=f(t.visual,{left:n(i),leftSize:30,cmpScale:.3});e.U.addClass(s,"partslist-cmp"),r.appendChild(s)})),t.allWireColors.forEach((i=>{let s=t.colorToWires[i].length,o=t.boardDef.pinStyles[i]||"female",a=f("wire",{left:n(s),leftSize:20,wireClr:i,cmpScale:.23,crocClips:"croc"==o});e.U.addClass(a,"partslist-wire"),r.appendChild(a)})),r}function y(t,n){let r=_(),i=m(n,465,!0);!function(t,n,r){let i=t.getView();n>0&&e.U.addClass(i,"grayed");for(let i=0;i<=n;i++){let s=r.stepToCmps[i];s&&s.forEach((r=>{let s=t.addPart(r);i===n&&(r.breadboardConnections.forEach((e=>t.highlightBreadboardPin(e))),e.U.addClass(s.element,"notgrayed"))}));let o=r.stepToWires[i];o&&o.forEach((e=>{let r=t.addWire(e);r&&i===n&&("breadboard"==e.start.type?t.highlightBreadboardPin(e.start):t.highlightBoardPin(e.start.pin),"breadboard"==e.end.type?t.highlightBreadboardPin(e.end):t.highlightBoardPin(e.end.pin),t.highlightWire(r))}))}}(i,t,n),r.appendChild(i.getView());let s=document.createElement("div");e.U.addClass(s,"panel-num-outer"),e.U.addClass(s,"noselect"),r.appendChild(s);let o=document.createElement("div");e.U.addClass(o,"panel-num"),o.textContent=t+1+"",s.appendChild(o);let a=document.createElement("div");e.U.addClass(a,"reqs-div"),r.appendChild(a);let l=n.stepToWires[t]||[],c=e=>{if("breadboard"===e.type){let{row:t,col:n}=e;return`(${t},${n})`}return e.pin};return l.forEach((t=>{let r=!1;"dalboard"==t.end.type&&(r="croc"==n.boardDef.pinStyles[t.end.pin]);let i=f("wire",{top:c(t.end),topSize:10,bot:c(t.start),botSize:10,wireClr:t.color,cmpHeight:40,crocClips:r});e.U.addClass(i,"cmp-div"),a.appendChild(i)})),(n.stepToCmps[t]||[]).forEach((t=>{let n;n="buttonpair"===t.visual.builtIn?[t.breadboardConnections[0],t.breadboardConnections[2]]:[t.breadboardConnections[0]],n.forEach(((n,r)=>{let i;if(n){let{row:e,col:t}=n;i=`(${e},${t})`}else i="";let s=1.5;"buttonpair"===t.visual.builtIn&&(s*=.5);let o=f(t.visual,{top:i,topSize:10,cmpHeight:50,cmpScale:s});e.U.addClass(o,"cmp-div"),a.appendChild(o)}))})),r}function b(t,n){n.boardDef.pinStyles||(n.boardDef.pinStyles={}),n.configData&&e.setConfigData(n.configData.cfg,n.configData.cfgKey);const r={type:"run",code:"",boardDefinition:n.boardDef,partDefinitions:n.partDefinitions};e.runtime=new e.Runtime(r),e.runtime.board=null,e.initCurrentRuntime(r);let i=document.createElement("style");i.textContent+=p,document.head.appendChild(i);const s=n.partDefinitions;let o=new e.visuals.Breadboard({}),a=function(t){let n=e.allocateDefinitions(t),r=[],i=[],s=1;n.partsAndWires.forEach((e=>{let t=e.part,n=e.wires;e.assembly.forEach(((e,o)=>{e.part&&t&&(i[s+o]=[t]),e.wireIndices&&e.wireIndices.length>0&&n&&(r[s+o]=e.wireIndices.map((e=>n[e])))})),s+=e.assembly.length}));let o=s-1,a=n.partsAndWires.map((e=>e.part)).filter((e=>!!e)),l=n.partsAndWires.map((e=>e.wires||[])).reduce(((e,t)=>e.concat(t)),[]),c={},u=[];return l.forEach((e=>{c[e.color]||(c[e.color]=[],u.push(e.color)),c[e.color].push(e)})),{boardDef:t.boardDef,cmpDefs:t.partDefs,fnArgs:t.fnArgs,allAlloc:n,stepToWires:r,stepToCmps:i,allWires:l,allCmps:a,lastStep:o,colorToWires:c,allWireColors:u}}({boardDef:n.boardDef,partDefs:s,partsList:n.parts,fnArgs:n.fnArgs,getBBCoord:o.getCoord.bind(o)});a.allAlloc.requiresBreadboard=!0;!function(e){let t=document.getElementById("front-panel"),n=m(e,400,!1);n.addAll(e.allAlloc),t.appendChild(n.getView())}(a);let l=g(a);t.appendChild(l);for(let e=0;e<=a.lastStep;e++){let n=y(e,a);t.appendChild(n)}n.print&&e.print(2e3)}t.renderParts=b,t.renderInstructions=function(e){document.getElementById("proj-title").innerText=e.options.name||"",b(document.body,e.options)}}(e.instructions||(e.instructions={}))}(pxsim||(pxsim={})),function(e){function t(e,t="sim: check failed"){if(!e)throw new Error(t)}e.quiet=!1,e.check=t,e.title="";let n,r,i,s,o,a={},l={};e.getConfig=function(e){return l.hasOwnProperty(e+"")?l[e+""]:null},e.getConfigKey=function(e){return a.hasOwnProperty(e)?a[e]:null},e.getAllConfigKeys=function(){return Object.keys(a)},e.setConfigKey=function(e,t){a[e]=t},e.setConfig=function(e,t){l[e]=t},e.setConfigData=function(e,t){l=e,a=t},e.getConfigData=function(){return{cfg:l,cfgKey:a}},e.setTitle=function(t){e.title=t};class c{constructor(){e.runtime?this.id=e.runtime.registerLiveObject(this):this.id=0}destroy(){}scan(t){throw e.U.userError("scan not implemented")}gcKey(){throw e.U.userError("gcKey not implemented")}gcSize(){throw e.U.userError("gcSize not implemented")}gcIsStatic(){return!1}print(){e.runtime&&e.runtime.refCountingDebug&&console.log(`RefObject id:${this.id}`)}toDebugString(){return"(object)"}static toAny(e){return e&&e.toAny?e.toAny():e}static toDebugString(e){return null===e?"null":void 0===e?"undefined;":e.vtable&&e.vtable.name?e.vtable.name:e.toDebugString?e.toDebugString():"string"==typeof e?JSON.stringify(e):e.toString()}}e.RefObject=c;class u{constructor(e,t,n){this.func=e,this.caps=t,this.args=n}}e.FnWrapper=u;class d extends c{constructor(){super(...arguments),this.fields={}}scan(e){for(let t of Object.keys(this.fields))e(t,this.fields[t])}gcKey(){return this.vtable.name}gcSize(){return this.vtable.numFields+1}destroy(){this.fields=null,this.vtable=null}print(){e.runtime&&e.runtime.refCountingDebug&&console.log(`RefRecord id:${this.id} (${this.vtable.name})`)}}e.RefRecord=d;class p extends c{constructor(){super(...arguments),this.fields=[]}scan(e){for(let t=0;t<this.fields.length;++t)e("_cap"+t,this.fields[t])}gcKey(){return e.functionName(this.func)}gcSize(){return this.fields.length+3}isRef(e){return t(0<=e&&e<this.fields.length),e<this.len}ldclo(e){return t(0<=(e>>=2)&&e<this.fields.length),this.fields[e]}destroy(){this.fields=null,this.func=null}print(){e.runtime&&e.runtime.refCountingDebug&&console.log(`RefAction id:${this.id} len:${this.fields.length}`)}}e.RefAction=p,function(t){t.seedAddRandom=function(e){},t.mkAction=function(e,t){let n=new p;n.len=e,n.func=t;for(let t=0;t<e;++t)n.fields.push(null);return n},t.runAction=function(t,n){let r=e.getResume();r(t instanceof p?new u(t.func,t.fields,n):new u(t,null,n))};let n={};t.dumpPerfCounters=function(){if(!e.runtime||!e.runtime.perfCounters)return;let t="calls,us,name\n";for(let n of e.runtime.perfCounters){n.lastFew.sort();const e=n.lastFew[n.lastFew.length>>1];t+=`${n.numstops},${n.value},${n.name},${e}\n`}!function(e){let t="";const r=(e,n)=>{t+=e.length>=n?e:("              "+e).slice(-n)},i=e=>r(""+Math.round(e),6),s=(e,n)=>{r(Math.round(n)+"",8),t+=" /",i(e),t+=" =",i(n/e)};for(let r of e.split(/\n/)){if(!r)continue;if(!/^\d/.test(r))continue;const e=r.split(/,/);let l=n[e[2]];l||(n[e[2]]=l={stops:0,us:0,meds:[]}),o=e[2],a=25,t+=o.length>=a?o:(o+"                         ").slice(0,a);const c=parseInt(e[0]),u=parseInt(e[1]);s(c,u),t+=" |",s(c-l.stops,u-l.us),t+=" ~";const d=parseInt(e[3]);i(d),l.meds.length>10&&l.meds.shift(),l.meds.push(d);const p=l.meds.slice();p.sort(((e,t)=>e-t));const h=p[p.length>>1];t+=" ~~",i(h),l.stops=c,l.us=u,t+="\n"}var o,a;console.log(t)}(t)}}(n=e.pxtcore||(e.pxtcore={}));class h extends c{constructor(){super(...arguments),this.v=void 0}scan(e){e("*",this.v)}gcKey(){return"LOC"}gcSize(){return 2}destroy(){}print(){e.runtime&&e.runtime.refCountingDebug&&console.log(`RefRefLocal id:${this.id} v:${this.v}`)}}e.RefRefLocal=h;class f extends c{constructor(){super(...arguments),this.vtable=e.mkMapVTable(),this.data=[]}scan(e){for(let t of this.data)e(t.key,t.val)}gcKey(){return"{...}"}gcSize(){return 2*this.data.length+4}findIdx(e){e+="";for(let t=0;t<this.data.length;++t)if(this.data[t].key==e)return t;return-1}destroy(){super.destroy();for(let e=0;e<this.data.length;++e)this.data[e].val=0;this.data=[]}print(){e.runtime&&e.runtime.refCountingDebug&&console.log(`RefMap id:${this.id} size:${this.data.length}`)}toAny(){const e={};return this.data.forEach((t=>{e[t.key]=c.toAny(t.val)})),e}}function m(){e.runtime&&e.runtime.dumpLivePointers()}e.RefMap=f,e.dumpLivePointers=m,function(e){e.toString=function(e){return null===e?"null":void 0===e?"undefined":e.toString()},e.toBoolDecr=function(e){return!!e},e.toBool=function(e){return!!e}}(r=e.numops||(e.numops={})),function(e){e.toInt=function(e){return 0|e},e.toFloat=function(e){return e},e.ignore=function(e){return e}}(i=e.langsupp||(e.langsupp={})),function(t){t.ptrOfLiteral=function(e){return e},t.debugMemLeaks=function(){m()},t.templateHash=function(){return 0},t.programHash=function(){return 0},t.programName=function(){return e.title},t.programSize=function(){return 0},t.afterProgramPage=function(){return 0},t.getConfig=function(t,n){let r=e.getConfig(t);return null==r?n:r},t.toInt=function(e){return e>>0},t.toUInt=function(e){return e>>>0},t.toDouble=function(e){return e},t.toFloat=function(e){return e},t.fromInt=function(e){return e},t.fromUInt=function(e){return e},t.fromDouble=function(e){return e},t.fromFloat=function(e){return e},t.fromBool=function(e){return!!e}}(n=e.pxtcore||(e.pxtcore={})),function(n){function r(e,t){if(t+="",e instanceof d){return e.fields[t]}let n=e.findIdx(t);if(!(n<0))return e.data[n].val}function i(e,t,n){if(t+="",e instanceof d){return void(e.fields[t]=n)}let r=e.findIdx(t);r<0?e.data.push({key:t,val:n}):e.data[r].val=n}n.toInt8=function(e){return(255&e)<<24>>24},n.toInt16=function(e){return(65535&e)<<16>>16},n.toInt32=function(e){return 0|e},n.toUInt32=function(e){return e>>>0},n.toUInt8=function(e){return 255&e},n.toUInt16=function(e){return 65535&e},n.nullFix=function(e){return null==e||!1===e?0:!0===e?1:e},n.nullCheck=function(t){null==t&&e.U.userError("Dereferencing null/undefined value.")},n.panic=function(t){e.U.userError("PANIC! Code "+t)},n.stringToBool=function(e){return e?1:0},n.ptrToBool=function(e){return e?1:0},n.emptyToNull=function(e){return""==e?0:e},n.ldlocRef=function(e){return e.v},n.stlocRef=function(e,t){e.v=t},n.mklocRef=function(){return new h},n.stclo=function(e,n,r){return t(0<=n&&n<e.fields.length),t(null===e.fields[n]),e.fields[n]=r,e},n.runtimeWarning=function(t){e.Runtime.postMessage(e.getWarningMessage(t))},n.mkMap=function(){return new f},n.mapGet=function(e,t){return r(e,n.mapKeyNames[t])},n.mapSet=function(e,t,r){return i(e,n.mapKeyNames[t],r)},n.mapGetByString=r,n.mapDeleteByString=function(e,t){e instanceof f||n.panic(923);let r=e.findIdx(t);return r>=0&&e.data.splice(r,1),!0},n.mapSetGeneric=i,n.mapGetGeneric=r,n.mapSetByString=i,n.keysOf=function(t){let n=new e.RefCollection;if(t instanceof f)for(let e of t.data)n.push(e.key);return n}}(s=e.pxtrt||(e.pxtrt={})),function(e){e.mkClassInstance=function(e){t(!!e.methods);let n=new d;return n.vtable=e,n},e.switch_eq=function(e,t){return e==t},e.typeOf=function(e){return typeof e}}(n=e.pxtcore||(e.pxtcore={})),function(t){t.panic=s.panic,t.pause=function(t){let n=e.getResume();e.runtime.schedule((()=>{n()}),t)},t.runInBackground=function(t){e.runtime.runFiberAsync(t)},t.forever=function(t){s.nullCheck(t),function n(){e.runtime.runFiberAsync(t).then((()=>e.U.delay(20))).then(n)}()}}(o=e.thread||(e.thread={}))}(pxsim||(pxsim={})),function(e){class t extends e.RefObject{constructor(){super(),this.data=[]}scan(e){for(let t=0;t<this.data.length;++t)e("["+t+"]",this.data[t])}gcKey(){return"[...]"}gcSize(){return this.data.length+2}toArray(){return this.data.slice(0)}toAny(){return this.data.map((t=>e.RefObject.toAny(t)))}toDebugString(){let t="[";for(let n=0;n<this.data.length;++n){n>0&&(t+=",");let r=e.RefObject.toDebugString(this.data[n]);if(t.length+r.length>100){0==n&&(t+=r.substr(0,100)),t+="...";break}t+=r}return t+="]",t}destroy(){let e=this.data;for(let t=0;t<e.length;++t)e[t]=0;this.data=[]}isValidIndex(e){return e>=0&&e<this.data.length}push(e){this.data.push(e)}pop(){return this.data.pop()}getLength(){return this.data.length}setLength(e){this.data.length=e}getAt(e){return this.data[e]}setAt(e,t){this.data[e]=t}insertAt(e,t){this.data.splice(e,0,t)}removeAt(e){return this.data.splice(e,1)[0]}indexOf(e,t){return this.data.indexOf(e,t)}print(){}}let n,r,i,s,o,a,l,c;e.RefCollection=t,function(n){function r(t,n){if(e.pxtrt.nullCheck(t),t.isValidIndex(n))return t.removeAt(n)}function i(t,n,r){return e.pxtrt.nullCheck(t),t.indexOf(n,r)}n.mk=function(){return new t},n.isArray=function(e){return e instanceof t},n.length=function(t){return e.pxtrt.nullCheck(t),t.getLength()},n.setLength=function(t,n){e.pxtrt.nullCheck(t),t.setLength(n)},n.push=function(t,n){e.pxtrt.nullCheck(t),t.push(n)},n.pop=function(t,n){return e.pxtrt.nullCheck(t),t.pop()},n.getAt=function(t,n){return e.pxtrt.nullCheck(t),t.getAt(n)},n.removeAt=r,n.insertAt=function(t,n,r){e.pxtrt.nullCheck(t),t.insertAt(n,r)},n.setAt=function(t,n,r){e.pxtrt.nullCheck(t),t.setAt(n,r)},n.indexOf=i,n.removeElement=function(t,n){e.pxtrt.nullCheck(t);let s=i(t,n,0);return s>=0?(r(t,s),1):0}}(n=e.Array_||(e.Array_={})),function(e){e.imul=Math.imul||function(e,t){const n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},e.idiv=function(e,t){return(0|e)/(0|t)|0},e.round=function(e){return Math.round(e)},e.roundWithPrecision=function(e,t){if((t|=0)<=0)return Math.round(e);if(0==e)return 0;let n=0;for(;0==n&&t<21;){const r=Math.pow(10,t++);n=Math.round(e*r+Number.EPSILON)/r}return n},e.ceil=function(e){return Math.ceil(e)},e.floor=function(e){return Math.floor(e)},e.sqrt=function(e){return Math.sqrt(e)},e.pow=function(e,t){return Math.pow(e,t)},e.clz32=function(e){return Math.clz32(e)},e.log=function(e){return Math.log(e)},e.log10=function(e){return Math.log10(e)},e.log2=function(e){return Math.log2(e)},e.exp=function(e){return Math.exp(e)},e.sin=function(e){return Math.sin(e)},e.sinh=function(e){return Math.sinh(e)},e.cos=function(e){return Math.cos(e)},e.cosh=function(e){return Math.cosh(e)},e.tan=function(e){return Math.tan(e)},e.tanh=function(e){return Math.tanh(e)},e.asin=function(e){return Math.asin(e)},e.asinh=function(e){return Math.asinh(e)},e.acos=function(e){return Math.acos(e)},e.acosh=function(e){return Math.acosh(e)},e.atan=function(e){return Math.atan(e)},e.atanh=function(e){return Math.atanh(e)},e.atan2=function(e,t){return Math.atan2(e,t)},e.trunc=function(e){return e>0?Math.floor(e):Math.ceil(e)},e.random=function(){return Math.random()},e.randomRange=function(e,t){if(e==t)return e;if(e>t){let n=e;e=t,t=n}return Math.floor(e)==e&&Math.floor(t)==t?e+Math.floor(Math.random()*(t-e+1)):e+Math.random()*(t-e)}}(r=e.Math_||(e.Math_={})),function(t){function n(t,n){return e.pxtrt.nullFix(t)==e.pxtrt.nullFix(n)}t.lt=function(e,t){return e<t},t.le=function(e,t){return e<=t},t.neq=function(e,t){return!n(e,t)},t.eq=n,t.eqDecr=function(t,n){return e.pxtrt.nullFix(t)==e.pxtrt.nullFix(n)},t.gt=function(e,t){return e>t},t.ge=function(e,t){return e>=t},t.div=function(e,t){return 0|Math.floor(e/t)},t.mod=function(e,t){return e%t},t.bnot=function(e){return~e},t.toString=function(e){return e+""}}(i=e.Number_||(e.Number_={})),function(e){e.adds=function(e,t){return e+t|0},e.subs=function(e,t){return e-t|0},e.divs=function(e,t){return 0|Math.floor(e/t)},e.muls=function(e,t){return r.imul(e,t)},e.ands=function(e,t){return e&t},e.orrs=function(e,t){return e|t},e.eors=function(e,t){return e^t},e.lsls=function(e,t){return e<<t},e.lsrs=function(e,t){return e>>>t},e.asrs=function(e,t){return e>>t},e.bnot=function(e){return~e},e.ignore=function(e){return e}}(s=e.thumb||(e.thumb={})),function(e){function t(e){return e<<16>>16}e.adds=function(e,n){return t(e+n)},e.subs=function(e,n){return t(e-n)},e.divs=function(e,n){return t(Math.floor(e/n))},e.muls=function(e,n){return t(r.imul(e,n))},e.ands=function(e,n){return t(e&n)},e.orrs=function(e,n){return t(e|n)},e.eors=function(e,n){return t(e^n)},e.lsls=function(e,n){return t(e<<n)},e.lsrs=function(e,t){return(65535&e)>>>t},e.asrs=function(e,n){return t(e>>n)},e.bnot=function(e){return~e},e.ignore=function(e){return e}}(o=e.avr||(e.avr={})),function(t){t.stringConv=function(t){const n=e.getResume();t instanceof e.RefRecord&&t.vtable.toStringMethod?e.runtime.runFiberAsync(t.vtable.toStringMethod,t).then((()=>{n(e.runtime.currFrame.retval+"")})):n(t+"")},t.mkEmpty=function(){return""},t.fromCharCode=function(e){return String.fromCharCode(e)},t.toNumber=function(e){return parseFloat(e)},t.concat=function(e,t){return e+t},t.substring=function(t,n,r){return e.pxtrt.nullCheck(t),t.slice(n,n+r)},t.equals=function(e,t){return e==t},t.compare=function(e,t){return e==t?0:e<t?-1:1},t.compareDecr=function(e,t){return e==t?0:e<t?-1:1},t.length=function(e){return e.length},t.substr=function(e,t,n){return e.substr(t,n)},t.charAt=function(e,t){return e.charAt(t)},t.charCodeAt=function(t,n){return e.pxtrt.nullCheck(t),function(t,n){return e.pxtrt.nullCheck(t),0<=n&&n<t.length}(t,n)?t.charCodeAt(n):0},t.indexOf=function(t,n,r){return e.pxtrt.nullCheck(t),null==n?-1:t.indexOf(n,r)},t.lastIndexOf=function(t,n,r){return e.pxtrt.nullCheck(t),null==n?-1:t.lastIndexOf(n,r)},t.includes=function(t,n,r){return e.pxtrt.nullCheck(t),null!=n&&t.includes(n,r)}}(a=e.String_||(e.String_={})),function(e){e.toString=function(e){return e?"true":"false"},e.bang=function(e){return!e}}(l=e.Boolean_||(e.Boolean_={}));class u extends e.RefObject{constructor(e){super(),this.data=e,this.isStatic=!1}scan(e){}gcKey(){return"Buffer"}gcSize(){return 2+(this.data.length+3>>2)}gcIsStatic(){return this.isStatic}print(){}toDebugString(){return c.toHex(this)}}e.RefBuffer=u,function(t){let n;function r(t){let r=function(t){switch(t){case n.Int8LE:return-1;case n.UInt8LE:return 1;case n.Int16LE:return-2;case n.UInt16LE:return 2;case n.Int32LE:return-4;case n.UInt32LE:return 4;case n.Int8BE:return-10;case n.UInt8BE:return 10;case n.Int16BE:return-20;case n.UInt16BE:return 20;case n.Int32BE:return-40;case n.UInt32BE:return 40;case n.Float32LE:return 4;case n.Float32BE:return 40;case n.Float64LE:return 8;case n.Float64BE:return 80;default:throw e.U.userError("bad format")}}(t),i=!1;r<0&&(i=!0,r=-r);let s=!1;return r>=10&&(s=!0,r/=10),{size:r,signed:i,swap:s,isFloat:t>=n.Float32LE}}function i(e){return new u(new Uint8Array(e))}function s(t,n){return e.pxtrt.nullCheck(t),0<=n&&n<t.data.length}function o(e,t){return s(e,t)?e.data[t]:0}function a(t){t.isStatic&&e.U.userError("Writing to read only buffer.")}function l(e,t,n){s(e,t)&&(a(e),e.data[t]=n)}function c(e,t,n=0,r=-1){n<0||n>e.data.length||(r<0&&(r=e.data.length),r=Math.min(r,e.data.length-n),a(e),e.data.fill(t,n,n+r))}function d(e,t,n,r,i){if(n.buffer===e.buffer)d(e,t,n.slice(r,r+i),0,i);else for(let s=0;s<i;++s)e[t+s]=n[r+s]}!function(e){e[e.Int8LE=1]="Int8LE",e[e.UInt8LE=2]="UInt8LE",e[e.Int16LE=3]="Int16LE",e[e.UInt16LE=4]="UInt16LE",e[e.Int32LE=5]="Int32LE",e[e.Int8BE=6]="Int8BE",e[e.UInt8BE=7]="UInt8BE",e[e.Int16BE=8]="Int16BE",e[e.UInt16BE=9]="UInt16BE",e[e.Int32BE=10]="Int32BE",e[e.UInt32LE=11]="UInt32LE",e[e.UInt32BE=12]="UInt32BE",e[e.Float32LE=13]="Float32LE",e[e.Float64LE=14]="Float64LE",e[e.Float32BE=15]="Float32BE",e[e.Float64BE=16]="Float64BE"}(n=t.NumberFormat||(t.NumberFormat={})),t.getNumber=function(e,t,n){let i=r(t);if(i.isFloat){let t=e.data.buffer.slice(n,n+i.size);if(i.swap){new Uint8Array(t).reverse()}return 4==i.size?new Float32Array(t)[0]:new Float64Array(t)[0]}let s=0;for(let t=0;t<i.size;++t){s<<=8;let r=i.swap?n+t:n+i.size-t-1;s|=e.data[r]}if(i.signed){let e=32-8*i.size;s=s<<e>>e}else s>>>=0;return s},t.setNumber=function(e,t,n,i){let s=r(t);if(s.isFloat){let t=new Uint8Array(s.size);4==s.size?new Float32Array(t.buffer)[0]=i:new Float64Array(t.buffer)[0]=i,s.swap&&t.reverse();for(let r=0;r<s.size;++r)e.data[n+r]=t[r]}else for(let t=0;t<s.size;++t){let r=s.swap?n+s.size-t-1:n+t;e.data[r]=255&i,i>>=8}},t.createBuffer=i,t.createBufferFromHex=function(e){let t=i(e.length>>1);for(let n=0;n<e.length;n+=2)t.data[n>>1]=parseInt(e.slice(n,n+2),16);return t.isStatic=!0,t},t.isReadOnly=function(e){return e.isStatic},t.getBytes=function(e){return e.data},t.getUint8=function(e,t){return o(e,t)},t.getByte=o,t.setUint8=function(e,t,n){l(e,t,n)},t.setByte=l,t.length=function(e){return e.data.length},t.fill=c,t.slice=function(e,t,n){return t=Math.min(e.data.length,t),n<0&&(n=e.data.length),n=Math.min(n,e.data.length-t),new u(e.data.slice(t,t+n))},t.toHex=function(e){const t="0123456789abcdef";let n="";for(let r=0;r<e.data.length;++r)n+=t[e.data[r]>>4],n+=t[15&e.data[r]];return n},t.toString=function(t){return e.U.fromUTF8Array(t.data)};const p=-2147483648;t.shift=function(e,t,n,r){r<0&&(r=e.data.length-n),n<0||n+r>e.data.length||n+r<n||0==r||0==t||t==p||0!=r&&0!=t&&t!=p&&(t<=-r||t>=r?c(e,0):(a(e),t<0?(t=-t,d(e.data,n+t,e.data,n,r-t),e.data.fill(0,n,n+t)):(r-=t,d(e.data,n,e.data,n+t,r),e.data.fill(0,n+r,n+r+t))))},t.rotate=function(e,t,n,r){if(r<0&&(r=e.data.length-n),n<0||n+r>e.data.length||n+r<n||0==r||0==t||t==p)return;a(e),t<0&&(t+=r<<8),(t%=r)<0&&(t+=r);let i=e.data,s=t,o=0,l=s,c=r;for(;o!=l;){let e=i[o+n];i[o+++n]=i[l+n],i[l+++n]=e,l==c?l=s:o==s&&(s=l)}},t.write=function(e,t,n,r=0,i=-1){i<0&&(i=n.data.length),r<0||t<0||t>e.data.length||(i=Math.min(n.data.length-r,e.data.length-t))<0||(a(e),d(e.data,t,n.data,r,i))}}(c=e.BufferMethods||(e.BufferMethods={}))}(pxsim||(pxsim={})),function(e){!function(t){t.createBufferFromUTF8=function(t){return new e.RefBuffer(e.U.toUTF8Array(t))}}(e.control||(e.control={}))}(pxsim||(pxsim={})),function(e){!function(e){let t={};e.setLocalizedStrings=function(e){t=e||{}};function n(e,t){return 0==t.length?e:e.replace(/\{([0-9]+)(\:[^\}]+)?\}/g,(function(e,n,s){let o=t[parseInt(n)],a="",l=/^:f(\d*)\.(\d+)/.exec(s);if(l){let e=parseInt(l[2]),t=parseInt(l[1])||0,n=/^0/.test(l[1])?"0":" ",r=o.toFixed(e);if(t>0&&e>0&&(t+=e+1),t>0)for(;r.length<t;)r=n+r;a=r}else a=":x"==s?"0x"+o.toString(16):void 0===o?"(undef)":null===o?"(null)":o.toString?o.toString():o+"";return":a"==s?/^\s*[euioah]/.test(a.toLowerCase())?a="an "+a:/^\s*[bcdfgjklmnpqrstvwxz]/.test(a.toLowerCase())&&(a="a "+a):":s"==s?a=1==o?"":"s":":q"==s?a=r(a):":jq"==s?a=i(a):":uri"==s?a=encodeURIComponent(a).replace(/'/g,"%27").replace(/"/g,"%22"):":url"==s?a=encodeURI(a).replace(/'/g,"%27").replace(/"/g,"%22"):":%"==s&&(a=(100*o).toFixed(1).toString()+"%"),a}))}function r(e){return e?e.replace(/([^\w .!?\-$])/g,(e=>"&#"+e.charCodeAt(0)+";")):e}function i(e){return e.replace(/[^\w .!?\-$]/g,(e=>{let t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substr(0,4-t.length)+t}))}e.lf=function(e,...r){let i=t[e]||e;return i=i.replace(/^\{(id|loc):[^\}]+\}/g,""),n(i,r)},e.fmt_va=n,e.htmlEscape=r,e.jsStringQuote=i}(e.localization||(e.localization={}))}(pxsim||(pxsim={})),function(pxsim){const MIN_MESSAGE_WAIT_MS=200;let tracePauseMs=0,U,pxtcore;!function(e){function t(e){return e.split(/\s+/).filter((e=>!!e))}function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}let r;e.containsClass=function(e,n){return t(n).every((t=>function(e,t){if(e.classList)return e.classList.contains(t);return!((e.className+"").split(/\s+/).indexOf(t)<0)}(e,t)))},e.addClass=function(e,n){t(n).forEach((t=>function(e,t){if(e.classList)e.classList.add(t);else{(e.className+"").split(/\s+/).indexOf(t)<0&&(e.className.baseVal+=" "+t)}}(e,t)))},e.removeClass=function(e,n){t(n).forEach((t=>function(e,t){e.classList?e.classList.remove(t):e.className.baseVal=(e.className+"").split(/\s+/).filter((e=>e!=t)).join(" ")}(e,t)))},e.remove=function(e){e.parentElement.removeChild(e)},e.removeChildren=n,e.clear=function(e){n(e)},e.assert=function(e,t="Assertion failed"){if(!e)throw new Error(t)},e.repeatMap=function(e,t){e=e||0;let n=[];for(let r=0;r<e;++r)n.push(t(r));return n},e.userError=function(e){let t=new Error(e);throw t.isUserError=!0,t},e.now=function(){return Date.now()},e.perfNowUs=function(){return r||(r="undefined"!=typeof performance?performance.now.bind(performance)||performance.moznow.bind(performance)||performance.msNow.bind(performance)||performance.webkitNow.bind(performance)||performance.oNow.bind(performance):Date.now),1e3*r()};const i=Promise.resolve();async function s(e,t,n){let r=0;const i=[],s=[];for(let o=0;o<e;o++){const e=(async()=>{for(;r<t.length;){const e=r++,i=t[e];s[e]=await n(i)}})();i.push(e)}try{await Promise.all(i)}catch(e){throw r=t.length,e}return s}function o(){return"undefined"!=typeof window&&!!window.pxtElectron}function a(){return"undefined"!=typeof window&&!!window.ipcRenderer}function l(){return o()||a()}function c(){try{return"undefined"!=typeof window&&/^http:\/\/(localhost|127\.0\.0\.1):\d+\//.test(window.location.href)&&!/nolocalhost=1/.test(window.location.href)}catch(e){return!1}}e.nextTick=function(e){i.then(e)},e.delay=async function(e,t){const n=await t;return await new Promise((t=>setTimeout((()=>t()),e))),n},e.throttle=function(e,t,n){let r;return function(){let i=this,s=arguments,o=function(){r=null,n||e.apply(i,s)},a=n&&!r;r||(r=setTimeout(o,t)),a&&e.apply(i,s)}},e.promiseMapAll=function(e,t){return Promise.all(e.map((e=>t(e))))},e.promiseMapAllSeries=function(e,t){return s(1,e,t)},e.promisePoolAsync=s,e.promiseTimeout=async function(e,t,n){let r,i;const s=new Promise(((t,s)=>{i=t,r=setTimeout((()=>{i=void 0,clearTimeout(r),s(n||`Promise timed out after ${e}ms`)}),e)}));return Promise.race([t,s]).then((e=>(i&&(clearTimeout(r),i()),e)))},e.stringToUint8Array=function(e){let t=e.length,n=new Uint8Array(t);for(let r=0;r<t;++r)n[r]=255&e.charCodeAt(r);return n},e.uint8ArrayToString=function(e){let t=e.length,n="";for(let r=0;r<t;++r)n+=String.fromCharCode(e[r]);return n},e.fromUTF8=function(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){let r=255&e.charCodeAt(n);t+=37==r||r>127?"%"+r.toString(16):e.charAt(n)}return decodeURIComponent(t)},e.toUTF8=function(e,t){let n="";if(!e)return n;for(let r=0;r<e.length;++r){let i=e.charCodeAt(r);if(i<=127)n+=e.charAt(r);else if(i<=2047)n+=String.fromCharCode(192|i>>6,128|63&i);else{if(!t&&55296<=i&&i<=56319){let t=e.charCodeAt(++r);isNaN(t)||(i=65536+(i-55296<<10)+(t-56320))}n+=i<=65535?String.fromCharCode(224|i>>12,128|i>>6&63,128|63&i):String.fromCharCode(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)}}return n},e.toUTF8Array=function(e){return(new TextEncoder).encode(e)},e.fromUTF8Array=function(e){return(new TextDecoder).decode(e)},e.isPxtElectron=o,e.isIpcRenderer=a,e.isElectron=l,e.isLocalHost=c,e.isLocalHostDev=function(){return c()&&!l()},e.unique=function(e,t){let n=[],r={};return e.forEach((e=>{let i=t(e);r.hasOwnProperty(i)||(r[i]=null,n.push(e))})),n}}(U=pxsim.U||(pxsim.U={}));class BreakLoopException{}function getResume(){return pxsim.runtime.getResume()}pxsim.BreakLoopException=BreakLoopException,function(e){function t(e){let t=pxsim.runtime.currTryFrame();t||U.userError("unhandled exception: "+e);const n=t.handlerFrame;throw pxsim.runtime.currFrame=n,n.pc=t.handlerPC,n.tryFrame=t.parent,n.thrownValue=e,n.hasThrownValue=!0,new BreakLoopException}e.beginTry=function(e){pxsim.runtime.currFrame.tryFrame={parent:pxsim.runtime.currTryFrame(),handlerPC:e,handlerFrame:pxsim.runtime.currFrame}},e.endTry=function(){const e=pxsim.runtime.currFrame;e.tryFrame=e.tryFrame.parent},e.throwValue=t,e.getThrownValue=function(){const e=pxsim.runtime.currFrame;return U.assert(e.hasThrownValue),e.hasThrownValue=!1,e.thrownValue},e.endFinally=function(){const e=pxsim.runtime.currFrame;e.hasThrownValue&&(e.hasThrownValue=!1,t(e.thrownValue))}}(pxtcore=pxsim.pxtcore||(pxsim.pxtcore={})),pxsim.getResume=getResume;const SERIAL_BUFFER_LENGTH=16;class BaseBoard{constructor(){this.messageListeners=[],this.serialOutBuffer="",this.messages=[],this.lastSerialTime=0,this.debouncedPostAll=()=>{const e=Date.now();e-this.lastSerialTime>MIN_MESSAGE_WAIT_MS?(clearTimeout(this.serialTimeout),this.messages.length&&(Runtime.postMessage({type:"bulkserial",data:this.messages,id:pxsim.runtime.id,sim:!0}),this.messages=[],this.lastSerialTime=e)):this.serialTimeout=setTimeout(this.debouncedPostAll,50)},this.id=pxsim.Embed.frameid||"b"+Math.round(2147483647*Math.random()),this.bus=new pxsim.EventBus(pxsim.runtime,this)}updateView(){}receiveMessage(e){pxsim.runtime&&!pxsim.runtime.dead&&this.dispatchMessage(e)}dispatchMessage(e){for(const t of this.messageListeners)t(e)}addMessageListener(e){this.messageListeners.push(e)}get storedState(){return this.runOptions?(this.runOptions.storedState||(this.runOptions.storedState={}),this.runOptions.storedState):{}}initAsync(e){return this.runOptions=e,Promise.resolve()}setStoredState(e,t){null==t?delete this.storedState[e]:this.storedState[e]=t,Runtime.postMessage({type:"simulator",command:"setstate",stateKey:e,stateValue:t})}onDebuggerResume(){}screenshotAsync(e){return Promise.resolve(void 0)}kill(){}writeSerial(e){this.serialOutBuffer+=e,(/\n/.test(this.serialOutBuffer)||this.serialOutBuffer.length>SERIAL_BUFFER_LENGTH)&&(this.messages.push({time:Date.now(),data:this.serialOutBuffer}),this.debouncedPostAll(),this.serialOutBuffer="")}}pxsim.BaseBoard=BaseBoard;class CoreBoard extends BaseBoard{constructor(){super(),this.updateSubscribers=[],this.updateView=()=>{this.updateSubscribers.forEach((e=>e()))},this.builtinParts={},this.builtinVisuals={},this.builtinPartVisuals={}}kill(){super.kill(),pxsim.codal.music.__stopSoundExpressions(),pxsim.AudioContextManager.stopAll()}}pxsim.CoreBoard=CoreBoard;class BareBoard extends BaseBoard{}function initBareRuntime(){pxsim.runtime.board=new BareBoard;let e=pxsim;e.basic={pause:pxsim.thread.pause,showNumber:e=>{let t=getResume();console.log("SHOW NUMBER:",e),U.nextTick(t)}},e.serial={writeString:e=>pxsim.runtime.board.writeSerial(e)},e.pins={createBuffer:pxsim.BufferMethods.createBuffer},e.control={inBackground:pxsim.thread.runInBackground,createBuffer:pxsim.BufferMethods.createBuffer,dmesg:e=>console.log("DMESG: "+e),deviceDalVersion:()=>"sim",__log:(e,t)=>console.log("LOG: "+t.trim())}}let LogType;pxsim.initBareRuntime=initBareRuntime,function(e){e[e.UserSet=0]="UserSet",e[e.BackAdd=1]="BackAdd",e[e.BackRemove=2]="BackRemove"}(LogType||(LogType={}));class EventQueue{constructor(e,t){this.runtime=e,this.valueToArgs=t,this.max=5,this.events=[],this.awaiters=[],this._handlers=[],this._addRemoveLog=[]}push(e,t){if(this.awaiters.length>0)if(t){const e=this.awaiters.shift();e&&e()}else{const e=this.awaiters.slice();this.awaiters=[],e.forEach((e=>e()))}return 0==this.handlers.length||this.events.length>this.max?Promise.resolve():(this.events.push(e),this.lock?Promise.resolve():this.poke())}poke(){this.lock=!0;let e=this.events;return this.events=[],U.promiseMapAllSeries(e,(e=>U.promiseMapAllSeries(this.handlers,(t=>this.runtime.runFiberAsync(t,...this.valueToArgs?this.valueToArgs(e):[e]))))).then((()=>this.events.length>0?this.poke():(this.lock=!1,this._addRemoveLog.forEach((e=>{e.log===LogType.BackAdd?this.addHandler(e.act):e.log===LogType.BackRemove?this.removeHandler(e.act):this.setHandler(e.act)})),this._addRemoveLog=[],Promise.resolve())))}get handlers(){return this._handlers}setHandler(e){this.lock?this._addRemoveLog.push({act:e,log:LogType.UserSet}):this._handlers=[e]}addHandler(e){if(this.lock)this._addRemoveLog.push({act:e,log:LogType.BackAdd});else{-1==this._handlers.indexOf(e)&&this._handlers.push(e)}}removeHandler(e){if(this.lock)this._addRemoveLog.push({act:e,log:LogType.BackRemove});else{let t=this._handlers.indexOf(e);-1!=t&&this._handlers.splice(t,1)}}addAwaiter(e){this.awaiters.push(e)}}function bind(e){const t=e.arg0,n=e.fn;return e=>{let r=0;for(;e.hasOwnProperty("arg"+r);)r++;const i=e;for(let e=r;e>0;e--)i["arg"+e]=i["arg"+(e-1)];return e.arg0=t,n(e)}}function _leave(e,t){return e.parent.retval=t,e.parent}function syntheticRefAction(e){return pxtcore.mkAction(0,(t=>_leave(t,e(t))))}pxsim.EventQueue=EventQueue,pxsim.initCurrentRuntime=void 0,pxsim.handleCustomMessage=void 0,pxsim.syntheticRefAction=syntheticRefAction;class TimeoutScheduled{constructor(e,t,n,r){this.id=e,this.fn=t,this.totalRuntime=n,this.timestampCall=r}}pxsim.TimeoutScheduled=TimeoutScheduled;class PausedTimeout{constructor(e,t){this.fn=e,this.timeRemaining=t}}function mkVTable(e){return{name:e.name,numFields:e.numFields,classNo:e.classNo,methods:e.methods,iface:e.iface,lastSubtypeNo:e.lastSubtypeNo,toStringMethod:e.toStringMethod,maxBgInstances:e.maxBgInstances}}pxsim.PausedTimeout=PausedTimeout,pxsim.mkVTable=mkVTable;let mapVTable=null;function mkMapVTable(){return mapVTable||(mapVTable=mkVTable({name:"_Map",numFields:0,classNo:0,lastSubtypeNo:0,methods:null})),mapVTable}function functionName(e){const t=e.info;return t?`${t.functionName} (${t.fileName}:${t.line+1}:${t.column+1})`:"()"}pxsim.mkMapVTable=mkMapVTable,pxsim.functionName=functionName;class Runtime{constructor(msg){this.numGlobals=1e3,this.dead=!1,this.running=!1,this.idleTimer=void 0,this.recording=!1,this.recordingTimer=0,this.recordingLastImageData=void 0,this.recordingWidth=void 0,this.startTime=0,this.startTimeUs=0,this.pausedTime=0,this.lastPauseTimestamp=0,this.globals={},this.environmentGlobals={},this.otherFrames=[],this.loopLock=null,this.loopLockWaitList=[],this.heapSnapshots=[],this.timeoutsScheduled=[],this.timeoutsPausedOnBreakpoint=[],this.pausedOnBreakpoint=!1,this.traceDisabled=!1,this.perfOffset=0,this.perfElapsed=0,this.perfStack=0,this.refCountingDebug=!1,this.refObjId=1,this.numDisplayUpdates=0,U.assert(!!pxsim.initCurrentRuntime),this.id=msg.id,this.refCountingDebug=!!msg.refCountingDebug;let threadId=0,breakpoints=null,currResume,dbgHeap,dbgResume,breakFrame=null,lastYield=Date.now(),userGlobals,__this=this;this.traceDisabled=!!msg.traceDisabled;const evalIface={runtime:this,oops:oops,doNothing:doNothing,pxsim:pxsim,globals:this.globals,setupYield:setupYield,maybeYield:maybeYield,setupDebugger:setupDebugger,isBreakFrame:isBreakFrame,breakpoint:breakpoint,trace:trace,checkStack:checkStack,leave:_leave,checkResumeConsumed:checkResumeConsumed,setupResume:setupResume,setupLambda:setupLambda,checkSubtype:checkSubtype,failedCast:failedCast,buildResume:buildResume,mkVTable:mkVTable,bind:bind,leaveAccessor:leaveAccessor};function oops(e){throw new Error("sim error: "+e)}function doNothing(e){return e.pc=-1,_leave(e,e.parent.retval)}function flushLoopLock(){for(;__this.loopLockWaitList.length>0&&!__this.loopLock;){__this.loopLockWaitList.shift()()}}let yieldReset=()=>{};function setupYield(e){yieldReset=e}function loopForSchedule(e){const t=new Object,n=e.pc;return __this.loopLock=t,__this.otherFrames.push(e),()=>{__this.dead||(U.assert(e.pc==n),U.assert(__this.loopLock===t),__this.loopLock=null,loop(e),flushLoopLock())}}function maybeYield(e,t,n){if(__this.pausedOnBreakpoint)return!1;__this.cleanScheduledExpired(),yieldReset();let r=Date.now();return r-lastYield>=20&&(lastYield=r,e.pc=t,e.r0=n,setTimeout(loopForSchedule(e),5),!0)}function setupDebugger(e,t){return breakpoints=new Uint8Array(e),breakpoints[0]=msg.breakOnStart?1:0,userGlobals=t,breakpoints}function isBreakFrame(e){if(!breakFrame)return!0;for(let t=breakFrame;t;t=t.parent)if(t==e)return!0;return!1}function breakpoint(e,t,n,r){let i={};__this.loopLock=i,U.assert(!dbgResume),U.assert(!dbgHeap),e.pc=t,e.r0=r;const{msg:s,heap:o}=pxsim.getBreakpointMsg(e,n,userGlobals);return dbgHeap=o,pxsim.injectEnvironmentGlobals(s,o),Runtime.postMessage(s),breakpoints[0]=0,breakFrame=null,__this.pauseScheduled(),dbgResume=n=>{if(dbgResume=null,dbgHeap=null,__this.dead)return null;switch(__this.resumeAllPausedScheduled(),__this.board.onDebuggerResume(),pxsim.runtime=__this,U.assert(e.pc==t),breakpoints[0]=0,breakFrame=null,n.subtype){case"resume":break;case"stepover":breakpoints[0]=1,breakFrame=e;break;case"stepinto":breakpoints[0]=1;break;case"stepout":breakpoints[0]=1,breakFrame=e.parent||e}U.assert(__this.loopLock==i),__this.loopLock=null,__this.otherFrames.push(e),loop(e),flushLoopLock()},null}function trace(e,t,n,r){if(setupResume(t,n),"<main>"===r.functionName||"main.ts"===r.fileName){if(!pxsim.runtime.traceDisabled){const{msg:n}=pxsim.getBreakpointMsg(t,e,userGlobals);n.subtype="trace",Runtime.postMessage(n)}pxsim.thread.pause(tracePauseMs||1)}else pxsim.thread.pause(0);checkResumeConsumed()}function handleDebuggerMsg(e){switch(e.subtype){case"config":let t=e;if(t.setBreakpoints&&breakpoints){breakpoints.fill(0);for(let e of t.setBreakpoints)breakpoints[e]=1}break;case"traceConfig":tracePauseMs=e.interval;break;case"pause":breakpoints[0]=1,breakFrame=null;break;case"resume":case"stepover":case"stepinto":case"stepout":dbgResume&&dbgResume(e);break;case"variables":const n=e;let r;if(dbgHeap){const e=dbgHeap[n.variablesReference];void 0!==e&&(r=pxsim.dumpHeap(e,dbgHeap,n.fields))}Runtime.postMessage({type:"debugger",subtype:"variables",req_seq:e.seq,variables:r})}}function removeFrame(e){const t=__this.otherFrames;for(let n=t.length-1;n>=0;--n)if(t[n]===e)return void t.splice(n,1);U.userError("frame cannot be removed!")}function loop(e){if(__this.dead)console.log("Runtime terminated");else{U.assert(!__this.loopLock),__this.perfStartRuntime(),removeFrame(e);try{for(pxsim.runtime=__this;e;)__this.currFrame=e,__this.currFrame.overwrittenPC=!1,e=e.fn(e),__this.maybeUpdateDisplay(),__this.currFrame.overwrittenPC&&(e=__this.currFrame);__this.perfStopRuntime()}catch(t){if(t instanceof BreakLoopException)return void U.nextTick(loopForSchedule(__this.currFrame));if(__this.perfStopRuntime(),__this.errorHandler)__this.errorHandler(t);else{console.error("Simulator crashed, no error handler",t.stack);const{msg:n,heap:r}=pxsim.getBreakpointMsg(e,e.lastBrkId,userGlobals);pxsim.injectEnvironmentGlobals(n,r),n.exceptionMessage=t.message,n.exceptionStack=t.stack,Runtime.postMessage(n),__this.postError&&__this.postError(t)}}}}function checkStack(e){e>100&&U.userError("Stack overflow")}function actionCall(e){return e.depth=e.parent.depth+1,checkStack(e.depth),e.pc=0,e}function setupTop(e){let t=setupTopCore(e);return setupResume(t,0),t}function setupTopCore(e){let t={parent:null,pc:0,depth:0,threadId:++threadId,fn:()=>(e&&e(t.retval),null)};return t}function topCall(e,t){U.assert(!!__this.board),U.assert(!__this.running),__this.setRunning(!0);let n={parent:setupTopCore(t),fn:e,depth:0,pc:0};__this.otherFrames=[n],loop(actionCall(n))}function checkResumeConsumed(){currResume&&oops("getResume() not called")}function setupResume(e,t){currResume=buildResume(e,t)}function leaveAccessor(e,t){if(e.stage2Call){const n={pc:0,fn:null,depth:e.depth,parent:e.parent};let r=1;for(;e.hasOwnProperty("arg"+r);)n["arg"+(r-1)]=e["arg"+r],r++;return setupLambda(n,t),n}return e.parent.retval=t,e.parent}function setupLambda(e,t,n){if(n){const t=e;for(let e=1;e<n;++e)t["arg"+(e-1)]=t["arg"+e];delete t["arg"+(n-1)]}t instanceof pxsim.RefAction?(e.fn=t.func,e.caps=t.fields):"function"==typeof t?e.fn=t:oops("calling non-function")}function checkSubtype(e,t){if(!e)return!1;const n=e.vtable;return t===n||n&&t.classNo<=n.classNo&&n.classNo<=t.lastSubtypeNo}function failedCast(e){pxsim.control&&pxsim.control.dmesgValue&&pxsim.control.dmesgValue(e),oops("failed cast on "+e)}function buildResume(e,t){currResume&&oops("already has resume"),e.pc=t;let n=Date.now();__this.otherFrames.push(e);let r=i=>{if(__this.dead)return;if(__this.loopLock)return void __this.loopLockWaitList.push((()=>r(i)));pxsim.runtime=__this;let s=Date.now();if(s-n>3&&(lastYield=s),U.assert(e.pc==t),i instanceof pxsim.FnWrapper){let t=i,n={parent:e,fn:t.func,lambdaArgs:t.args,pc:0,caps:t.caps,depth:e.depth+1},r={};return __this.loopLock=r,removeFrame(e),__this.otherFrames.push(n),U.nextTick((()=>{U.assert(__this.loopLock===r),__this.loopLock=null,loop(actionCall(n)),flushLoopLock()}))}return e.retval=i,loop(e)};return r}const entryPoint=msg.code&&eval(msg.code)(evalIface);this.run=e=>topCall(entryPoint,e),this.getResume=()=>{currResume||oops("noresume");let e=currResume;return currResume=null,e},this.setupTop=setupTop,this.handleDebuggerMsg=handleDebuggerMsg,this.entry=entryPoint,this.overwriteResume=e=>{currResume=null,e>=0&&(this.currFrame.pc=e),this.currFrame.overwrittenPC=!0},pxsim.runtime=this,pxsim.initCurrentRuntime(msg)}registerLiveObject(e){return this.refObjId++}runningTime(){return U.now()-this.startTime-this.pausedTime}runningTimeUs(){return 4294967295&U.perfNowUs()-this.startTimeUs>>0}runFiberAsync(e,t,n,r){return new Promise(((i,s)=>U.nextTick((()=>{pxsim.runtime=this,this.setupTop(i),pxtcore.runAction(e,[t,n,r])}))))}currTryFrame(){for(let e=this.currFrame;e;e=e.parent)if(e.tryFrame)return e.tryFrame;return null}traceObjects(){const e={};for(;this.heapSnapshots.length>2;)this.heapSnapshots.shift();const t={count:0,size:0,name:"TOTAL"},n={TOTAL:t};function r(t,n,i=null){if(!(n instanceof pxsim.RefObject))return;const s=n;if(s.gcIsStatic())return;const o=e[s.id];if(o)return void(i&&o.pointers.push([i,t]));const a={obj:s,path:null,pointers:[[i,t]]};e[s.id]=a,s.scan(((t,n)=>{n instanceof pxsim.RefObject&&!e[n.id]&&r(t,n,a)}))}this.heapSnapshots.push({visited:e,statsByType:n});for(let e of Object.keys(this.globals))r(e.replace(/___\d+$/,""),this.globals[e]);const i=this.otherFrames.slice();this.currFrame&&i.indexOf(this.currFrame)<0&&i.unshift(this.currFrame);for(const e of this.getThreads()){const t="Thread-"+this.rootFrame(e).threadId;for(let n=e;n;n=n.parent){const e=t+"."+functionName(n.fn);for(let t of Object.keys(n))if(/^(r0|arg\d+|.*___\d+)/.test(t)){const i=n[t];i instanceof pxsim.RefObject&&(t=t.replace(/___.*/,""),r(e+"."+t,i))}if(n.caps)for(let t of n.caps)r(e+".cap",t)}}const s=Object.keys(e).map((t=>e[t]));s.sort(((e,t)=>t.obj.gcSize()-e.obj.gcSize()));const o=e=>{if(null!=e.path)return;let t="";e.path="(cycle)";for(let[n,r]of e.pointers){if(null==n)return void(e.path=r);o(n);const i=n.path+"."+r;(!t||t.length>i.length)&&(t=i)}e.path=t};s.forEach(o);const a=[t];for(const e of s){const r=e.obj.gcSize(),i=e.obj.gcKey();n.hasOwnProperty(i)||a.push(n[i]={count:0,size:0,name:i});const s=n[i];s.size+=r,s.count++,t.size+=r,t.count++}a.sort(((e,t)=>e.size-t.size));let l="";const c=e=>("        "+e.toString()).slice(-7);for(const e of a)l+=c(4*e.size)+c(e.count)+" "+e.name+"\n";const u=e=>c(4*e.obj.gcSize())+" "+e.obj.gcKey()+" "+e.path,d=s.slice(0,20).map(u).join("\n");let p="";if(this.heapSnapshots.length>=3){const e=this.heapSnapshots[this.heapSnapshots.length-3].visited,t=this.heapSnapshots[this.heapSnapshots.length-2].visited,r=e=>e instanceof pxsim.RefRecord&&!!(e.vtable&&e.vtable.maxBgInstances&&n[e.gcKey()].count<=e.vtable.maxBgInstances);p=s.filter((n=>!e[n.obj.id]&&t[n.obj.id])).filter((e=>!r(e.obj))).map(u).join("\n")}return"Threads:\n"+this.threadInfo()+"\n\nSummary:\n"+l+"\n\nLarge Objects:\n"+d+"\n\nNew Objects:\n"+p}getThreads(){const e=this.otherFrames.slice();return this.currFrame&&e.indexOf(this.currFrame)<0&&e.unshift(this.currFrame),e}rootFrame(e){let t=e;for(;t.parent;)t=t.parent;return t}threadInfo(){const e=this.getThreads();let t="";for(let n of e){t+=`Thread ${this.rootFrame(n).threadId}:\n`;for(let e of pxsim.getBreakpointMsg(n,n.lastBrkId).msg.stackframes){let n=e.funcInfo;t+=`   at ${n.functionName} (${n.fileName}:${n.line+1}:${n.column+1})\n`}t+="\n"}return t}static postMessage(e){e&&("undefined"!=typeof window&&window.parent&&window.parent.postMessage&&window.parent.postMessage(e,"*"),Runtime.messagePosted&&Runtime.messagePosted(e))}static async postScreenshotAsync(e){const t=pxsim.runtime&&pxsim.runtime.board;if(!t)return;const n=await t.screenshotAsync();Runtime.postMessage({type:"screenshot",data:n,delay:e&&e.delay})}static requestToggleRecording(){const e=pxsim.runtime;e&&Runtime.postMessage({type:"recorder",action:e.recording?"stop":"start"})}restart(){this.kill(),setTimeout((()=>pxsim.Runtime.postMessage({type:"simulator",command:"restart"})),500)}kill(){this.dead=!0,this.stopRecording(),this.stopIdle(),this.setRunning(!1)}updateDisplay(){this.board.updateView(),this.postFrame()}startRecording(e){!this.recording&&this.running&&(this.recording=!0,this.recordingTimer=setInterval((()=>this.postFrame()),66),this.recordingLastImageData=void 0,this.recordingWidth=e)}stopRecording(){this.recording&&(this.recordingTimer&&clearInterval(this.recordingTimer),this.recording=!1,this.recordingTimer=0,this.recordingLastImageData=void 0,this.recordingWidth=void 0)}postFrame(){if(!this.recording||!this.running)return;let e=pxsim.U.now();this.board.screenshotAsync(this.recordingWidth).then((t=>{this.recordingLastImageData&&isImageDataEqual(this.recordingLastImageData,t)||(this.recordingLastImageData=t,Runtime.postMessage({type:"screenshot",data:t,time:e}))}))}queueDisplayUpdate(){this.numDisplayUpdates++}maybeUpdateDisplay(){this.numDisplayUpdates&&(this.numDisplayUpdates=0,this.updateDisplay())}setRunning(e){this.running!=e&&(this.running=e,this.running?(this.startTime=U.now(),this.startTimeUs=U.perfNowUs(),Runtime.postMessage({type:"status",frameid:pxsim.Embed.frameid,runtimeid:this.id,state:"running"})):(this.stopRecording(),this.stopIdle(),Runtime.postMessage({type:"status",frameid:pxsim.Embed.frameid,runtimeid:this.id,state:"killed"})),this.stateChanged&&this.stateChanged())}dumpLivePointers(){}setupPerfCounters(e){e&&e.length&&(this.perfCounters=e.map((e=>new PerfCounter(e))))}perfStartRuntime(){0!==this.perfOffset?this.perfStack++:this.perfOffset=U.perfNowUs()-this.perfElapsed}perfStopRuntime(){this.perfStack?this.perfStack--:(this.perfElapsed=this.perfNow(),this.perfOffset=0)}perfNow(){return 0===this.perfOffset&&U.userError("bad time now"),U.perfNowUs()-this.perfOffset|0}startPerfCounter(e){if(!this.perfCounters)return;const t=this.perfCounters[e];t.start&&U.userError("startPerf"),t.start=this.perfNow()}stopPerfCounter(e){if(!this.perfCounters)return;const t=this.perfCounters[e];t.start||U.userError("stopPerf");const n=this.perfNow()-t.start;t.start=0,t.value+=n,t.numstops++;let r=t.lastFewPtr++;r>=t.lastFew.length&&(r=0,t.lastFewPtr=1),t.lastFew[r]=n}startIdle(){void 0===this.idleTimer&&(this.idleTimer=setInterval((()=>{if(!this.running||this.pausedOnBreakpoint)return;const e=this.board.bus;e&&e.queueIdle()}),20))}stopIdle(){void 0!==this.idleTimer&&(clearInterval(this.idleTimer),this.idleTimer=void 0)}schedule(e,t){if(t<=0&&(t=0),this.pausedOnBreakpoint)return this.timeoutsPausedOnBreakpoint.push(new PausedTimeout(e,t)),-1;const n=U.now(),r=new TimeoutScheduled(-1,e,t,n);return r.id=setTimeout((()=>{const t=this.timeoutsScheduled.indexOf(r);t>=0&&this.timeoutsScheduled.splice(t,1),e()}),t),this.timeoutsScheduled.push(r),r.id}pauseScheduled(){this.pausedOnBreakpoint=!0,this.timeoutsScheduled.forEach((e=>{clearTimeout(e.id);let t=U.now()-e.timestampCall,n=e.totalRuntime-t;n<=0&&(n=1),this.timeoutsPausedOnBreakpoint.push(new PausedTimeout(e.fn,n))})),this.lastPauseTimestamp=U.now(),this.timeoutsScheduled=[]}resumeAllPausedScheduled(){this.pausedOnBreakpoint=!1,this.timeoutsPausedOnBreakpoint.forEach((e=>{this.schedule(e.fn,e.timeRemaining)})),this.lastPauseTimestamp&&(this.pausedTime+=U.now()-this.lastPauseTimestamp,this.lastPauseTimestamp=0),this.timeoutsPausedOnBreakpoint=[]}cleanScheduledExpired(){let e=U.now();this.timeoutsScheduled=this.timeoutsScheduled.filter((t=>{let n=e-t.timestampCall;return t.totalRuntime>n}))}registerUserInteraction(){this.lastInteractionTime=Date.now(),this.thumbnailRecordingIntervalRef||this.lastThumbnailTime&&this.lastInteractionTime-this.lastThumbnailTime<1e3||(this.thumbnailFrames=[],this.thumbnailRecordingIntervalRef=setInterval((async()=>{const e=await this.board.screenshotAsync();this.thumbnailFrames.length&&isImageDataEqual(e,this.thumbnailFrames[this.thumbnailFrames.length-1])||(this.thumbnailFrames.push(e),(Date.now()-this.lastInteractionTime>1e4||this.thumbnailFrames.length>30)&&(clearInterval(this.thumbnailRecordingIntervalRef),this.thumbnailRecordingIntervalRef=void 0,this.lastThumbnailTime=Date.now(),Runtime.postMessage({type:"thumbnail",frames:this.thumbnailFrames})))}),66))}}function setParentMuteState(e){Runtime.postMessage({type:"setmutebuttonstate",state:e})}pxsim.Runtime=Runtime,pxsim.setParentMuteState=setParentMuteState;class PerfCounter{constructor(e){this.name=e,this.start=0,this.numstops=0,this.value=0,this.lastFew=new Uint32Array(32),this.lastFewPtr=0}}function isImageDataEqual(e,t){if(e.data.byteLength!==t.data.byteLength)return!1;const n=e.data.byteLength;let r=0;for(r=0;r<n&&e.data[r]==t.data[r];++r);return r===n}pxsim.PerfCounter=PerfCounter}(pxsim||(pxsim={})),function(e){let t,n;!function(e){e[e.Unloaded=0]="Unloaded",e[e.Stopped=1]="Stopped",e[e.Pending=2]="Pending",e[e.Starting=3]="Starting",e[e.Running=4]="Running",e[e.Paused=5]="Paused",e[e.Suspended=6]="Suspended"}(t=e.SimulatorState||(e.SimulatorState={})),function(e){e[e.StepInto=0]="StepInto",e[e.StepOver=1]="StepOver",e[e.StepOut=2]="StepOut",e[e.Resume=3]="Resume",e[e.Pause=4]="Pause"}(n=e.SimulatorDebuggerCommand||(e.SimulatorDebuggerCommand={}));const r="pxtdriver";e.SimulatorDriver=class{constructor(n,r={}){this.container=n,this.options=r,this.themes=["blue","red","green","yellow"],this.runId="",this.nextFrameId=0,this.frameCounter=0,this.traceInterval=0,this.breakpointsSet=!1,this._runOptions={},this.state=t.Unloaded,this._allowedOrigins=[],this.frameCleanupTimeout=void 0,this.debuggerSeq=1,this.debuggerResolvers={},this._allowedOrigins.push(window.location.origin),r.parentOrigin&&this._allowedOrigins.push(r.parentOrigin),this._allowedOrigins.push(this.getSimUrl().origin);const i=null==r?void 0:r.messageSimulators;i&&Object.keys(i).map((e=>i[e])).forEach((e=>{this._allowedOrigins.push(new URL(e.url).origin),e.localHostUrl&&this._allowedOrigins.push(new URL(e.localHostUrl).origin)})),this._allowedOrigins=e.U.unique(this._allowedOrigins,(e=>e))}isDebug(){return this._runOptions&&!!this._runOptions.debug}isTracing(){return this._runOptions&&!!this._runOptions.trace}hasParts(){return this._runOptions&&this._runOptions.parts&&!!this._runOptions.parts.length}setDirty(){this.state==e.SimulatorState.Running&&this.suspend()}setPending(){this.setState(t.Pending)}focus(){const e=this.simFrames()[0];e&&e.focus()}registerDependentEditor(e){e&&(this._dependentEditors||(this._dependentEditors=[]),this._dependentEditors.push(e))}dependentEditors(){return this._dependentEditors&&(this._dependentEditors=this._dependentEditors.filter((e=>!!e.parent)),this._dependentEditors.length||(this._dependentEditors=void 0)),this._dependentEditors}setStarting(){this.setState(t.Starting)}setHwDebugger(e){e?(this.hwdbg=e,this.setState(t.Running),this.container.style.opacity="0.3"):(delete this.container.style.opacity,this.hwdbg=null,this.setState(t.Running),this.stop())}handleHwDebuggerMsg(e){this.hwdbg&&this.handleMessage(e)}setThemes(t){e.U.assert(t&&t.length>0),this.themes=t}startRecording(e){this.simFrames()[0]&&this.postMessage({type:"recorder",action:"start",source:r,width:e})}stopRecording(){this.postMessage({type:"recorder",source:r,action:"stop"})}setFrameState(n){const r=n.nextElementSibling,i=r.nextElementSibling;switch(this.state){case t.Pending:case t.Starting:r.style.display="",r.className="",i.style.display="";break;case t.Stopped:case t.Suspended:e.U.addClass(n,this.state==t.Stopped||this._runOptions&&this._runOptions.autoRun?this.stoppedClass:this.invalidatedClass),this._runOptions&&this._runOptions.autoRun?r.style.display="none":(r.style.display="",r.className="videoplay xicon icon"),i.style.display="none",this.scheduleFrameCleanup();break;default:e.U.removeClass(n,this.stoppedClass),e.U.removeClass(n,this.invalidatedClass),r.style.display="none",i.style.display="none"}}setState(e){this.state!=e&&(this.state=e,this.freeze(this.state==t.Paused),this.simFrames().forEach((e=>this.setFrameState(e))),this.options.onStateChanged&&this.options.onStateChanged(this.state))}freeze(t){const n="pause-overlay";t?e.util.toArray(this.container.querySelectorAll("div.simframe")).forEach((e=>{if(e.querySelector(`div.${n}`))return;const t=document.createElement("div");t.className=n,t.onclick=e=>(e.preventDefault(),!1),e.appendChild(t)})):e.util.toArray(this.container.querySelectorAll(`div.simframe div.${n}`)).forEach((e=>e.parentElement.removeChild(e)))}simFrames(t=!1){let n=e.util.toArray(this.container.getElementsByTagName("iframe"));const r=this.loanedIFrame();return r&&!t&&n.unshift(r),n}getSimUrl(){var e,t;const n=this.options.simUrl||(null===(e=window.pxtConfig)||void 0===e?void 0:e.simUrl)||(null===(t=pxt.webConfig)||void 0===t?void 0:t.simUrl)||`${location.origin}/sim/simulator.html`;try{return new URL(n)}catch(e){return new URL(n,location.origin)}}postMessage(t,n,r){var i;if(this.hwdbg)return void this.hwdbg.postMessage(t);const s=this.dependentEditors();let o=this.simFrames();r&&(o=o.filter((e=>e.id===r)));let a=!1;const l=t;if(n&&(null==l?void 0:l.broadcast)){l.srcFrameIndex=this.simFrames().findIndex((e=>e.contentWindow===n));const r=!!(null===(i=this._currentRuntime)||void 0===i?void 0:i.single),c=window.parent&&window.parent!==window.window?window.parent:window.opener;if(c&&n!==c&&c.postMessage(t,"*"),!this.options.nestedEditorSim&&!(null==l?void 0:l.toParentIFrameOnly))if(s)s.forEach((e=>{n!==e&&e.postMessage(t,window.location.origin)}));else if(!r){const n="messagepacket"===t.type&&t.channel,r=n&&this.options.messageSimulators&&this.options.messageSimulators[n];if(r){let t=o.find((e=>e.dataset.messagechannel===n));if(t)t.dataset.runid!=this.runId&&this.startFrame(t);else{const i=(e.U.isLocalHost()&&/localhostmessagesims=1/i.test(window.location.href)&&r.localHostUrl||r.url).replace("$PARENT_ORIGIN$",encodeURIComponent(this.options.parentOrigin||""));let s=this.createFrame(i);this.container.appendChild(s),t=s.firstElementChild,t.dataset.messagechannel=n,e.U.addClass(s,"simmsg"),e.U.addClass(s,"simmsg"+n),r.permanent&&(t.dataset.permanent="true"),this.startFrame(t),o=this.simFrames()}}else{a=!0;const e=o.filter((e=>!e.dataset.messagechannel));e.length<2?(this.container.appendChild(this.createFrame()),o=this.simFrames()):e[1].dataset.runid!=this.runId&&this.startFrame(e[1])}}}for(let e=0;e<o.length;++e){const r=o[e];if((!n||r.contentWindow!=n)&&(r.contentWindow&&(a?this.postDeferrableMessage(r,t):this.postMessageCore(r,t),"recorder"==t.type&&"start"==t.action)))break}}postDeferrableMessage(e,t){!e.dataset.loading?this.postMessageCore(e,t):(this.deferredMessages||(this.deferredMessages=[]),this.deferredMessages.push([e,t]))}postMessageCore(t,n){const r=e.U.isLocalHostDev()?"*":t.dataset.origin;t.contentWindow.postMessage(n,r)}setRunOptionQueryParams(e){var t,n;const r=new URL(e);if((null===(t=this._runOptions)||void 0===t?void 0:t.hideSimButtons)&&r.searchParams.set("hideSimButtons","1"),null===(n=this._runOptions)||void 0===n?void 0:n.queryParameters){const e=this._runOptions.queryParameters.split("&");for(const t of e){const[e,n]=t.split(/[:=]/);e&&n&&r.searchParams.set(e,n)}}return r.toString()}createFrame(n){var r;const i=document.createElement("div");i.className="simframe ui embed";const s=document.createElement("iframe");s.id="sim-frame-"+this.nextId(),s.title=e.localization.lf("Simulator"),s.allowFullscreen=!0,s.setAttribute("allow","autoplay;microphone"),s.setAttribute("sandbox","allow-same-origin allow-scripts"),s.className="no-select";let o=this.setRunOptionQueryParams(n||this.getSimUrl().toString());o+="#"+s.id,s.src=o,s.frameBorder="0",s.dataset.runid=this.runId,s.dataset.origin=new URL(o).origin||"*",s.dataset.loading="true",(null===(r=this._runOptions)||void 0===r?void 0:r.autofocus)&&s.setAttribute("autofocus","true"),i.appendChild(s);const a=document.createElement("i");a.className="videoplay xicon icon",a.style.display="none",a.onclick=e=>(e.preventDefault(),this.state!=t.Running&&this.state!=t.Starting&&(this.options.restart?this.options.restart():this.start()),s.focus(),!1),i.appendChild(a);const l=document.createElement("div");return l.className="ui active loader",a.style.display="none",i.appendChild(l),this._runOptions&&this.applyAspectRatioToFrame(s),i}preload(e,t){this.addEventListeners(),t&&(this._currentRuntime=void 0,this.container.textContent=""),this.simFrames().length||(this.container.appendChild(this.createFrame()),this.applyAspectRatio(e),this.setStarting())}stop(e=!1,n=!1){this.state!==t.Stopped&&this.state!==t.Unloaded&&(this.clearDebugger(),this.stopSound(),this.postMessage({type:"stop",source:r}),this.setState(n?t.Starting:t.Stopped)),e&&this.unload()}suspend(){this.stopSound(),this.postMessage({type:"stop",source:r}),this.setState(t.Suspended)}unload(){this.cancelFrameCleanup(),e.U.removeChildren(this.container),this.setState(t.Unloaded),this._runOptions=void 0,this._currentRuntime=void 0,this.runId=void 0,this.deferredMessages=void 0}mute(e){this._currentRuntime&&(this._currentRuntime.mute=e),this.postMessage({type:"mute",source:r,mute:e})}stopSound(){this.postMessage({type:"stopsound",source:r})}isLoanedSimulator(e){return!!this.loanedSimulator&&this.loanedIFrame()==e}loanSimulator(){return this.loanedSimulator||(this.loanedSimulator=this.container.firstElementChild||this.createFrame(),this.loanedSimulator.parentNode&&this.container.removeChild(this.loanedSimulator)),this.loanedSimulator}unloanSimulator(){this.loanedSimulator&&(this.loanedSimulator.parentNode&&this.loanedSimulator.parentNode.removeChild(this.loanedSimulator),this.container.insertBefore(this.loanedSimulator,this.container.firstElementChild),delete this.loanedSimulator)}loanedIFrame(){return this.loanedSimulator&&this.loanedSimulator.parentNode&&this.loanedSimulator.querySelector("iframe")}cancelFrameCleanup(){this.frameCleanupTimeout&&(clearTimeout(this.frameCleanupTimeout),this.frameCleanupTimeout=void 0)}scheduleFrameCleanup(){this.cancelFrameCleanup(),this.frameCleanupTimeout=setTimeout((()=>{this.frameCleanupTimeout=void 0,this.cleanupFrames()}),5e3)}applyAspectRatio(e){if(!e&&!this._runOptions)return;this.simFrames().forEach((t=>this.applyAspectRatioToFrame(t,e)))}applyAspectRatioToFrame(e,t){var n,r,i,s;let o=t;if(void 0===o){const t=parseFloat(e.dataset.aspectratio);isNaN(t)||(o=t)}if(void 0===o){const t=e.dataset.messagechannel;if(t){const e=null===(i=null===(r=null===(n=this.options)||void 0===n?void 0:n.messageSimulators)||void 0===r?void 0:r[t])||void 0===i?void 0:i.aspectRatio;e&&(o=e)}}void 0===o&&(o=(null===(s=this._runOptions)||void 0===s?void 0:s.aspectRatio)||1.22),e.parentElement.style.paddingBottom=100/o+"%"}cleanupFrames(){const e=this.simFrames(!0);e.shift(),e.filter((e=>!e.dataset.permanent)).forEach((e=>{this.state!=t.Stopped&&e.dataset.runid==this.runId||(this.options.removeElement?this.options.removeElement(e.parentElement):e.parentElement.remove())}))}hide(e){if(this.suspend(),!this.options.removeElement)return;const t=this.simFrames();t.forEach((t=>{this.options.removeElement(t.parentElement,e)})),0==t.length&&e&&e()}unhide(){if(!this.options.unhideElement)return;this.simFrames().forEach((e=>{this.options.unhideElement(e.parentElement)}))}setRunOptions(e={}){this._runOptions=e}run(e,t={}){this.setRunOptions(t),this.runId=this.nextId(),this._currentRuntime={type:"run",source:r,boardDefinition:t.boardDefinition,parts:t.parts,builtinParts:t.builtinParts,fnArgs:t.fnArgs,code:e,partDefinitions:t.partDefinitions,mute:t.mute,highContrast:t.highContrast,light:t.light,cdnUrl:t.cdnUrl,localizedStrings:t.localizedStrings,refCountingDebug:t.refCountingDebug,version:t.version,clickTrigger:t.clickTrigger,breakOnStart:t.breakOnStart,storedState:t.storedState,ipc:t.ipc,single:t.single,dependencies:t.dependencies,activePlayer:t.activePlayer,theme:t.theme},this.stopSound(),this.start()}restart(){this.stop(),this.cleanupFrames(),this.start()}areBreakpointsSet(){return this.breakpointsSet}start(){if(this.clearDebugger(),this.addEventListeners(),this.applyAspectRatio(),this.scheduleFrameCleanup(),!this._currentRuntime)return;this.breakpointsSet=!1;let e=this.simFrames()[0];if(e)this.startFrame(e);else{let t=this.createFrame();this.container.appendChild(t),e=t.firstElementChild}this.debuggingFrame=e.id,this.setState(t.Running),this.setTraceInterval(this.traceInterval)}startFrame(e){var t,n,r;if(!this._currentRuntime||!e.contentWindow)return!1;const i=JSON.parse(JSON.stringify(this._currentRuntime));i.frameCounter=++this.frameCounter;const s=(null===(t=this._runOptions)||void 0===t?void 0:t.mpRole)||(null===(r=null===(n=/[\&\?]mp=(server|client)/i.exec(window.location.href))||void 0===n?void 0:n[1])||void 0===r?void 0:r.toLowerCase());return i.options={theme:this.themes[this.nextFrameId++%this.themes.length],mpRole:s},i.id=`${i.options.theme}-${this.nextId()}`,e.dataset.runid=this.runId,e.dataset.runtimeid=i.id,e.id!==this.debuggingFrame&&(i.traceDisabled=!0,i.breakOnStart=!1),this.postMessageCore(e,i),this.traceInterval&&this.setTraceInterval(this.traceInterval),this.applyAspectRatioToFrame(e),this.setFrameState(e),!0}handleDeferredMessages(e){var t,n,r;e.dataset.loading&&(delete e.dataset.loading,null===(n=null===(t=this.deferredMessages)||void 0===t?void 0:t.filter((t=>t[0]===e)))||void 0===n||n.forEach((t=>{const[n,r]=t;this.postMessageCore(e,r)})),this.deferredMessages=null===(r=this.deferredMessages)||void 0===r?void 0:r.filter((t=>t[0]!==e)))}handleMessage(e,n){var r,i,s;switch(e.type||""){case"ready":{const t=e.frameid,n=document.getElementById(t);n&&((null===(r=this._runOptions)||void 0===r?void 0:r.autofocus)&&n.focus(),this.startFrame(n),this.options.revealElement&&this.options.revealElement(n),this.handleDeferredMessages(n)),this.options.onSimulatorReady&&this.options.onSimulatorReady();break}case"status":{const n=e.frameid,r=document.getElementById(n);if(r){const n=e;if(n.runtimeid==r.dataset.runtimeid)switch(n.state){case"running":this.setState(t.Running),this.handleDeferredMessages(r);break;case"killed":this.setState(t.Stopped)}}break}case"simulator":this.handleSimulatorCommand(e);break;case"serial":case"pxteditor":case"screenshot":case"custom":case"recorder":case"addextensions":break;case"aspectratio":{const t=e,n=t.frameid,r=document.getElementById(n);r&&(r.dataset.aspectratio=t.value+"",this.applyAspectRatioToFrame(r));break}case"debugger":this.handleDebuggerMessage(e);break;case"toplevelcodefinished":this.options.onTopLevelCodeEnd&&this.options.onTopLevelCodeEnd();break;case"setmutebuttonstate":null===(s=(i=this.options).onMuteButtonStateChange)||void 0===s||s.call(i,e.state);break;default:this.postMessage(e,n)}}addEventListeners(){this.listener||(this.listener=t=>{if(!this.hwdbg){if(e.U.isLocalHost());else if(this._allowedOrigins.indexOf(t.origin)<0)return;this.handleMessage(t.data,t.source)}},window.addEventListener("message",this.listener,!1))}removeEventListeners(){this.listener&&(window.removeEventListener("message",this.listener,!1),this.listener=void 0)}resume(e){let i;switch(e){case n.Resume:i="resume",this.setState(t.Running);break;case n.StepInto:i="stepinto",this.setState(t.Running);break;case n.StepOut:i="stepout",this.setState(t.Running);break;case n.StepOver:i="stepover",this.setState(t.Running);break;case n.Pause:i="pause";break;default:return void console.debug("unknown command")}this.postMessage({type:"debugger",subtype:i,source:r})}setBreakpoints(e){this.breakpointsSet=!0,this.postDebuggerMessage("config",{setBreakpoints:e},void 0,this.debuggingFrame)}setTraceInterval(e){this.traceInterval=e,this.postDebuggerMessage("traceConfig",{interval:e})}variablesAsync(e,t){return this.postDebuggerMessageAsync("variables",{variablesReference:e,fields:t},this.debuggingFrame).then((e=>e),(e=>{}))}handleSimulatorCommand(e){this.options.onSimulatorCommand&&this.options.onSimulatorCommand(e)}clearDebugger(){const e=new Error("Debugging cancelled");Object.keys(this.debuggerResolvers).forEach((t=>{const{reject:n}=this.debuggerResolvers[t];n(e)})),this.debuggerResolvers={},this.debuggerSeq++}handleDebuggerMessage(e){if("trace"!==e.subtype&&console.log("DBG-MSG",e.subtype,e),e.seq){const{resolve:t}=this.debuggerResolvers[e.seq];t&&t(e)}switch(e.subtype){case"warning":this.options.onDebuggerWarning&&this.options.onDebuggerWarning(e);break;case"breakpoint":{const r=e;if(this.state==t.Running){if(r.exceptionMessage)this.suspend();else{this.setState(t.Paused);this.simFrames(!0).length>1&&this.resume(n.Pause)}this.options.onDebuggerBreakpoint&&this.options.onDebuggerBreakpoint(r);let e=r.exceptionMessage+"\n";for(let t of r.stackframes){let n=t.funcInfo;e+=`   at ${n.functionName} (${n.fileName}:${n.line+1}:${n.column+1})\n`}r.exceptionMessage&&console.error(e)}else console.error("debugger: trying to pause from "+this.state);break}case"trace":{const n=e;this.state==t.Running&&this.options.onTraceMessage&&this.options.onTraceMessage(n);break}default:const r=e.req_seq;if(r){const{resolve:t}=this.debuggerResolvers[r];t&&(delete this.debuggerResolvers[r],t(e))}}}postDebuggerMessageAsync(e,t={},n){return new Promise(((r,i)=>{const s=this.debuggerSeq++;this.debuggerResolvers[s.toString()]={resolve:r,reject:i},this.postDebuggerMessage(e,t,s,n)}))}postDebuggerMessage(e,t={},n,i){const s=JSON.parse(JSON.stringify(t));s.type="debugger",s.subtype=e,s.source=r,n&&(s.seq=n),this.postMessage(s,void 0,i)}nextId(){return this.nextFrameId+++(Math.random()+""+Math.random()).replace(/[^\d]/,"")}get stoppedClass(){return this.options&&this.options.stoppedClass||"grayscale"}get invalidatedClass(){return this.options&&this.options.invalidatedClass||"sepia"}}}(pxsim||(pxsim={})),function(e){e.mkRange=function(e,t){let n=[];for(;e<t;e++)n.push(e);return n};e.EventBus=class{constructor(e,t,n){this.runtime=e,this.board=t,this.valueToArgs=n,this.queues={},this.backgroundHandlerFlag=!1,this.nextNotifyEvent=1024,this.schedulerID=15,this.idleEventID=2,this.board.addMessageListener(this.handleMessage.bind(this))}handleMessage(e){if("eventbus"===e.type){const t=e;this.queue(t.id,t.eventid,t.value)}}setBackgroundHandlerFlag(){this.backgroundHandlerFlag=!0}setNotify(e,t){this.notifyID=e,this.notifyOneID=t}setIdle(e,t){this.schedulerID=e,this.idleEventID=t}start(t,n,r,i=!1){let s=(r?"back":"fore")+":"+t+":"+n;return!this.queues[s]&&i&&(this.queues[s]=new e.EventQueue(this.runtime,this.valueToArgs)),this.queues[s]}listen(e,t,n){e==this.schedulerID&&t==this.idleEventID&&this.runtime.startIdle();let r=this.start(e,t,this.backgroundHandlerFlag,!0);this.backgroundHandlerFlag?r.addHandler(n):r.setHandler(n),this.backgroundHandlerFlag=!1}removeBackgroundHandler(e){Object.keys(this.queues).forEach((t=>{t.startsWith("back:")&&this.queues[t].removeHandler(e)}))}getQueues(e,t,n){let r=[this.start(0,0,n)];return 0==e&&0==t||(t&&r.push(this.start(0,t,n)),e&&r.push(this.start(e,0,n)),e&&t&&r.push(this.start(e,t,n))),r}queue(t,n,r=null){if(e.runtime.pausedOnBreakpoint)return;const i=this.notifyID&&this.notifyOneID&&t==this.notifyOneID;i&&(t=this.notifyID);let s=this.getQueues(t,n,!0).concat(this.getQueues(t,n,!1));this.lastEventValue=n,this.lastEventTimestampUs=e.U.perfNowUs(),e.U.promiseMapAllSeries(s,(e=>e?e.push(r,i):Promise.resolve()))}queueIdle(){this.schedulerID&&this.idleEventID&&this.queue(this.schedulerID,this.idleEventID)}wait(e,t,n){this.start(e,t,!1,!0).addAwaiter(n)}getLastEventValue(){return this.lastEventValue}getLastEventTime(){return 4294967295&this.lastEventTimestampUs-e.runtime.startTimeUs}};let t;function n(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&navigator.maxTouchPoints>0)}function r(){return"undefined"!=typeof window&&!!window.PointerEvent}e.AnimationQueue=class{constructor(e){this.runtime=e,this.queue=[],this.process=()=>{let t=this.queue[0];if(!t)return;if(this.runtime.dead)return;e=this.runtime;let n=t.frame();e.queueDisplayUpdate(),e.maybeUpdateDisplay(),!1===n?(this.queue.shift(),this.queue[0]&&(this.queue[0].setTimeoutHandle=setTimeout(this.process,this.queue[0].interval)),t.whenDone(!1)):t.setTimeoutHandle=setTimeout(this.process,t.interval)}}cancelAll(){let e=this.queue;this.queue=[];for(let t of e)t.whenDone(!0),t.setTimeoutHandle&&clearTimeout(t.setTimeoutHandle)}cancelCurrent(){let e=this.queue[0];e&&(this.queue.shift(),e.whenDone(!0),e.setTimeoutHandle&&clearTimeout(e.setTimeoutHandle))}enqueue(e){e.whenDone||(e.whenDone=()=>{}),this.queue.push(e),1==this.queue.length&&this.process()}executeAsync(t){return e.U.assert(!t.whenDone),new Promise(((e,n)=>{t.whenDone=e,this.enqueue(t)}))}},function(t){let n,r,i,s,o=0,a=!1;const l=[];let c,u=[];function d(){return n||(n=function(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}return}(),n&&(c=n.createGain(),c.connect(n.destination),c.gain.setValueAtTime(1,0))),n}function p(){x(0),o=0,s&&s.pause()}function h(e,t){e.gain.value&&e.gain.setTargetAtTime(0,d().currentTime,.015),setTimeout((()=>{e.disconnect(),t&&t.disconnect()}),450)}t.isAudioElementActive=function(){return!!i},t.mute=function(e){a=e;const t=d();e?c.gain.setTargetAtTime(0,t.currentTime,.015):c.gain.setTargetAtTime(1,t.currentTime,.015),!e&&t&&"suspended"===t.state&&t.resume()},t.isMuted=function(){return a},t.stopAll=function(){p(),k();for(const e of u)e()},t.stop=function(){p(),function(){if(i){try{h(i,r)}catch(e){}i=void 0,r=void 0}}()},t.onStopAll=function(e){u.push(e)},t.frequency=function(){return o};const f=[null,"triangle","sawtooth","sine"];let m,_,g=[],y=[];function b(e,t){let n,r=f[e];if(r){let e=d().createOscillator();return e.type=r,e.frequency.value=t,e}if(4==e)n=function(){if(!_){const e=131072;_=d().createBuffer(1,e,d().sampleRate);const t=_.getChannelData(0);let n=251771520;for(let r=0;r<e;r+=4)n^=n<<13,n^=n>>17,n^=n<<5,32768&n?(t[r]=1,t[r+1]=1,t[r+2]=-1,t[r+3]=-1):(t[r]=0,t[r+1]=0,t[r+2]=0,t[r+3]=0)}return _}();else if(5==e)n=function(){if(!m){const e=1e5;m=d().createBuffer(1,e,d().sampleRate);const t=m.getChannelData(0);let n=251771520;for(let r=0;r<e;r++)n^=n<<13,n^=n>>17,n^=n<<5,t[r]=(1023&n)/512-1}return m}();else if(11<=e&&e<=15)n=function(e){if(!y[e]){const t=1024,n=d().createBuffer(1,t,d().sampleRate),r=n.getChannelData(0);for(let n=0;n<t;n++)r[n]=n<e/100*t?1:-1;y[e]=n}return y[e]}(10*(e-10));else{if(!(16<=e&&e<=18))return null;n=function(e){if(!g[e]){const t=1024,n=d().createBuffer(1,t,d().sampleRate),r=n.getChannelData(0),i=[770763591,3356908179],s=[15,31,63];for(let n=0;n<t;n+=4){let t,o=n/4;o&=s[e-4],t=0!=(i[o>>5]&1<<(31&o)),t?(r[n]=1,r[n+1]=1,r[n+2]=-1,r[n+3]=-1):(r[n]=0,r[n+1]=0,r[n+2]=0,r[n+3]=0)}g[e]=n}return g[e]}(e-16+4)}let i=d().createBufferSource();i.buffer=n,i.loop=!0;return 4==e||16<=e&&e<=18?i.playbackRate.value=t/(d().sampleRate/4):5!=e&&(i.playbackRate.value=t/(d().sampleRate/1024)),i}class v{disconnectNodes(){this.gain?h(this.gain,this.generator):this.generator&&(this.generator.stop(),this.generator.disconnect()),this.gain=null,this.generator=null}remove(){const e=l.indexOf(this);e>=0&&l.splice(e,1),this.disconnectNodes()}}let T=1;function k(){for(null===t.soundEventCallback||void 0===t.soundEventCallback||t.soundEventCallback("muteallchannels"),T++;l.length;)l[0].remove()}function E(e,t){if(e<0)return;o=e;let n=d();if(n){t=Math.max(0,Math.min(1,t));try{r||(r=n.createOscillator(),i=n.createGain(),i.gain.value=0,r.type="triangle",r.connect(i),i.connect(c),r.start(0)),x(t)}catch(e){return r=void 0,void(i=void 0)}r.frequency.value=e,x(t)}}function x(e){(null==i?void 0:i.gain)&&i.gain.setTargetAtTime(e,n.currentTime,.015)}t.muteAllChannels=k,t.queuePlayInstructions=function(t,n){const r=T;e.U.delay(t).then((()=>r!=T?Promise.resolve():S(n.data)))},t.tone=E,t.setCurrentToneGain=x,t.playBufferAsync=function(e){return e?new Promise((t=>{function n(){t&&t(),t=void 0}const r="data:audio/wav;base64,"+window.btoa(function(e){let t=e.length,n="";for(let r=0;r<t;++r)n+=String.fromCharCode(e[r]);return n}(e.data));s=new Audio(r),a&&(s.volume=0),s.onended=()=>n(),s.onpause=()=>n(),s.onerror=()=>n(),s.play()})):Promise.resolve()};function S(n,r,i){return new Promise((async s=>{null===t.soundEventCallback||void 0===t.soundEventCallback||t.soundEventCallback("playinstructions",n);let o=!1,a=d(),u=new v;l.length>20&&l[0].remove(),l.push(u),u.gain=a.createGain(),u.gain.gain.value=1,u.gain.connect(c);const p={},h={};let f=a.currentTime,m=f,_=0,g=0;const y=(e,t)=>e/1024/4*(t?.5:1),T=()=>{if(!o){o=!0,u.disconnectNodes();for(const e of Object.keys(p))p[e].stop(),p[e].disconnect(),h[e].disconnect();s()}};for(let e=0;e<n.length;e+=12){const t=n[e],r=C(n,e+2),i=C(n,e+4)/1e3,s=C(n,e+6),o=C(n,e+8),l=C(n,e+10);if(g+=i,0===t){m+=i;continue}const c=11<=t&&t<=15;p[t]||(p[t]=b(t,r),h[t]=a.createGain(),h[t].gain.value=0,h[t].connect(u.gain),p[t].connect(h[t]),p[t].start()),_&&t!==_&&h[_].gain.setTargetAtTime(0,m,.015);const d=p[t],f=h[t];if(d instanceof OscillatorNode)d.frequency.setValueAtTime(r,m),d.frequency.linearRampToValueAtTime(l,m+i);else{4==t||16<=t&&t<=18?d.playbackRate.linearRampToValueAtTime(l/(a.sampleRate/4),m+i):5!=t&&d.playbackRate.linearRampToValueAtTime(l/(a.sampleRate/1024),m+i)}f.gain.setValueAtTime(y(s,c),m),f.gain.linearRampToValueAtTime(y(o,c),m+i),_=t,m+=i}if(u.gain.gain.setTargetAtTime(0,m,.015),r||i){const e=()=>{const t=a.currentTime;if(t>f+g)return;if(r&&r())return void T();const{frequency:s,volume:o}=function(e,t){let n=0;for(let r=0;r<t.length;r+=12){const i=C(t,r+2),s=C(t,r+4),o=C(t,r+6),a=C(t,r+8),l=C(t,r+10);if(n+s<e){n+=s;continue}const c=(e-n)/s;return{frequency:i+(l-i)*c,volume:o+(a-o)*c}}return{frequency:-1,volume:-1}}(1e3*(t-f),n);i&&i(s,o/1024),requestAnimationFrame(e)};requestAnimationFrame(e)}await e.U.delay(1e3*g),T()}))}function C(e,t){const n=new Uint8Array(2);return n[0]=e[t],n[1]=e[t+1],new Uint16Array(n.buffer)[0]}t.playPCMBufferStreamAsync=function(e,t,n=.3,r){return new Promise((i=>{let s=[],o=d().currentTime,a=!1;const u=new v;u.gain=d().createGain(),u.gain.gain.value=0,u.gain.gain.setValueAtTime(n,d().currentTime),u.gain.connect(c),l.length>20&&l[0].remove(),l.push(u);const p=()=>!!(r&&r()||!u.gain)&&(i&&i(),i=void 0,u.remove(),!0);function h(){for(;!a&&s.length<3&&!p();){const t=e();if(!t||!t.length){a=!0;break}f(t)}a&&0===s.length&&(u.remove(),i&&i(),i=void 0)}function f(e){if(p())return;const n=d().createBuffer(1,e.length,t);if(n.copyToChannel)n.copyToChannel(e,0);else{const t=n.getChannelData(0);for(let n=0;n<e.length;n++)t[n]=e[n]}const r=d().createBufferSource();s.push(r),r.connect(u.gain),r.buffer=n,r.addEventListener("ended",(()=>{s.shift().disconnect(),h()})),r.start(o),o+=n.duration}h()}))},t.playInstructionsAsync=S,t.sendMidiMessage=function(e){const t=e.data;if(!t.length)return;const n=t[0]>>4,r=15&t[0],i=t[1]||0,s=(o=i,440*Math.pow(2,(o-69)/12));var o;const a=t[2]||0;8==n||9==n&&0==a?p():9==n&&(E(s,1),9==r&&setTimeout((()=>p()),500))}}(t=e.AudioContextManager||(e.AudioContextManager={})),e.isTouchEnabled=n,e.hasPointerEvents=r,e.pointerEvents=r()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:n()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"}}(pxsim||(pxsim={})),function(e){!function(t){function n(e,t){return n=>n*(t/e)}function r(e,t){let n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}t.translateEl=function(t,n){e.svg.hydrate(t,{transform:`translate(${n[0]} ${n[1]})`})},t.composeSVG=function(t){let[n,r]=[t.el1,t.el2];e.U.assert(0==n.x&&0==n.y&&0==r.x&&0==r.y,"el1 and el2 x,y offsets not supported");let i=(t,n,r)=>e.svg.hydrate(t,{x:n,y:r}),s=(t,n,r)=>e.svg.hydrate(t,{width:`${n}px`,height:`${r}px`}),o=t.scaleUnit2,a=t.scaleUnit2/t.scaleUnit1,l=n.w*a,c=n.h*a;s(n.el,l,c);let u=1*r.w,d=1*r.h;s(r.el,u,d);let[p,h,f,m]=t.margin,_=t.middleMargin,g=Math.max(l,u),y=h+(g-l)/2,b=p;i(n.el,y,b);let v=h+(g-u)/2,T=b+c+_;i(r.el,v,T);let k=[b,b+c,T,T+d],E=h+g+m,x=p+c+_+d+f,S=e.svg.elt("svg",{version:"1.0",viewBox:`0 0 ${E} ${x}`,class:"sim-bb"});((t,n,r)=>{n&&e.svg.hydrate(t,{width:n}),r&&e.svg.hydrate(t,{height:r})})(S,t.maxWidth,t.maxHeight),i(S,0,0);let C=e.svg.child(S,"g");return S.appendChild(n.el),S.appendChild(r.el),{under:C,over:e.svg.child(S,"g"),host:S,edges:k,scaleUnit:o,toHostCoord1:e=>{let[t,n]=e;return[t*a+y,n*a+b]},toHostCoord2:e=>{let[t,n]=e;return[1*t+v,1*n+T]}}},t.mkScaleFn=n,t.mkImageSVG=function(t){let r=n(t.imageUnitDist,t.targetUnitDist),i=r(t.width),s=r(t.height),o=e.svg.elt("image",{width:i,height:s});return o.setAttributeNS("http://www.w3.org/1999/xlink","href",`${t.image}`),{el:o,w:i,h:s,x:0,y:0}},t.findDistSqrd=r,t.findClosestCoordIdx=function(e,t){return t.map((t=>r(e,t))).reduce(((e,t,n,r)=>t<r[e]?n:e),0)},t.mkTxt=function(t,n,r,i,s,o,a){let l=e.svg.elt("text");a=a||.3;const c=(o=o||-.33333)*r*s.length,u=a*r;return e.svg.hydrate(l,{style:`font-size:${r}px;`,transform:`translate(${t} ${n}) rotate(${i}) translate(${c} ${u})`}),e.U.addClass(l,"noselect"),l.textContent=s,l},t.GPIO_WIRE_COLORS=["pink","orange","yellow","green","purple"],t.WIRE_COLOR_MAP={black:"#514f4d",white:"#fcfdfc",gray:"#acabab",purple:"#a772a1",blue:"#01a6e8",green:"#3cce73",yellow:"#ece600",orange:"#fdb262",red:"#f44f43",brown:"#c89764",pink:"#ff80fa"},t.mapWireColor=function(e){return t.WIRE_COLOR_MAP[e]||e},t.PIN_DIST=15,t.rgbToHsl=function(e){let t,n,r,[i,s,o]=e,[a,l,c]=[i/255,s/255,o/255],u=Math.min(a,l,c),d=Math.max(a,l,c),p=d-u,h=d+u;return r=h/2*100,0===p?n=t=0:(d===a?t=(l-c)/p%6*60:d===l?t=60*((c-a)/p+2):d===c&&(t=60*((a-l)/p+4)),n=r>50?p/(2-h)*100:p/h*100),[Math.floor(t),Math.floor(n),Math.floor(r)]}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){var t;!function(n){function r(e,n,r){let i={class:e,d:n};r&&(i.title=r);let s=t.elt("path");return t.hydrate(s,i),s}function i(e,n=!1){let r=t.elt("linearGradient");t.hydrate(r,{id:e,x1:"0%",y1:"0%",x2:n?"100%":"0%",y2:n?"0%":"100%"});t.child(r,"stop",{offset:"0%"}),t.child(r,"stop",{offset:"100%"}),t.child(r,"stop",{offset:"100%"}),t.child(r,"stop",{offset:"100%"});return r}function s(e){let n=t.elt("title");return n.textContent=e,n}n.parseString=function(e){return(new DOMParser).parseFromString(e,"image/svg+xml").getElementsByTagName("svg").item(0)},n.toDataUri=function(e){return"data:image/svg+xml,"+encodeURI(e)},n.cursorPoint=function(e,t,n){return e.x=null!=n.clientX?n.clientX:n.pageX,e.y=null!=n.clientY?n.clientY:n.pageY,e.matrixTransform(t.getScreenCTM().inverse())},n.rotateElement=function(e,t,n,r){e.setAttribute("transform",`translate(${t},${n}) rotate(${r+90}) translate(${-t},${-n})`)},n.hydrate=function(e,n){for(let r in n)"title"==r?t.title(e,n[r]):e.setAttributeNS(null,r,n[r])},n.elt=function(e,n){let r=document.createElementNS("http://www.w3.org/2000/svg",e);return n&&t.hydrate(r,n),r},n.child=function(e,n,r){let i=t.elt(n,r);return e.appendChild(i),i},n.mkPath=r,n.path=function(e,t,n,i){let s=r(t,n,i);return e.appendChild(s),s},n.fill=function(e,t){e.style.fill=t},n.filter=function(e,t){e.style.filter=t},n.fills=function(e,t){e.forEach((e=>e.style.fill=t))},n.isTouchEnabled=function(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)},n.onClick=function(t,n){let r=!1;e.pointerEvents.down.forEach((e=>t.addEventListener(e,(e=>(r=!0,!0)),!1))),t.addEventListener(e.pointerEvents.up,(e=>!r||(r=!1,n(e),e.preventDefault(),!1)),!1)},n.buttonEvents=function(t,n,r,i,s){let o=!1;e.pointerEvents.down.forEach((e=>t.addEventListener(e,(e=>(o=!0,r&&r(e),!0)),!1))),t.addEventListener(e.pointerEvents.move,(e=>!o||(n&&n(e),e.preventDefault(),!1)),!1),t.addEventListener(e.pointerEvents.up,(e=>{o=!1,i&&i(e)}),!1),t.addEventListener(e.pointerEvents.leave,(e=>{o=!1,i&&i(e)}),!1),t.addEventListener("keydown",(e=>{o=!1,s&&s(e)}))},n.mkLinearGradient=i,n.linearGradient=function(e,t,n=!1){let r=i(t,n);return e.appendChild(r),r},n.setGradientColors=function(e,t,n){e&&(e.childNodes[0].style.stopColor=t,e.childNodes[1].style.stopColor=t,e.childNodes[2].style.stopColor=n,e.childNodes[3].style.stopColor=n)},n.setGradientValue=function(e,t){e.childNodes[1].getAttribute("offset")!=t&&(e.childNodes[1].setAttribute("offset",t),e.childNodes[2].setAttribute("offset",t))},n.animate=function(t,n){e.U.addClass(t,n);let r=t.parentElement;r&&(r.removeChild(t),r.appendChild(t))},n.mkTitle=s,n.title=function(e,t){let n=s(t);return e.appendChild(n),n},n.toHtmlColor=function(e){return`rgba(${e>>16&255}, ${e>>8&255}, ${255&e}, ${e>>24&1})`}}(t=e.svg||(e.svg={}))}(pxsim||(pxsim={})),function(e){!function(e){e.Metronome=class{constructor(){this.tickListeners=[],this.onTick=()=>{for(const e of this.tickListeners)e()}}initAsync(){return this.metronomeLoadPromise?this.metronomeLoadPromise:this.metronomeWorker?this.metronomeWorker:(this.metronomeLoadPromise=new Promise((e=>{this.metronomeWorker=new Worker("data:application/javascript,"+encodeURIComponent(t));const n=t=>{"ready"===t.data&&(e(this.metronomeWorker),this.metronomeWorker.removeEventListener("message",n),this.metronomeWorker.addEventListener("message",this.onTick))};this.metronomeWorker.addEventListener("message",n)})),this.metronomeLoadPromise)}stop(){this.postMessage({type:"stop"})}setInterval(e){this.currentInterval=e,this.postMessage({type:"set-interval",interval:e})}start(e){this.currentInterval=e,this.postMessage({type:"start",interval:e})}addTickListener(e){this.tickListeners.push(e)}removeTickListener(e){this.tickListeners=this.tickListeners.filter((t=>t!==e))}interval(){return this.currentInterval}dispose(){if(this.metronomeWorker)this.metronomeWorker.terminate(),this.metronomeWorker=void 0,this.metronomeLoadPromise=void 0,this.tickListeners=[],this.interval=void 0;else if(this.metronomeLoadPromise)return void this.metronomeLoadPromise.then((()=>this.dispose()))}postMessage(e){if(!this.metronomeWorker)throw new Error("initAsync not called on metronome");this.metronomeWorker.postMessage(e)}};const t='\n/**\n * Adpated from https://github.com/cwilso/metronome/\n */\n\nlet timerRef;\nlet interval;\n\naddEventListener("message", ev => {\n    const message = ev.data;\n\n    if (message.type === "start") {\n        updateInterval(message.interval, true);\n    }\n    else if (message.type === "stop") {\n        clearInterval(timerRef);\n        timerRef = undefined;\n    }\n    else if (message.type === "set-interval") {\n        updateInterval(message.interval, false);\n    }\n})\n\npostMessage("ready");\n\nfunction updateInterval(interval, startIfStopped) {\n    if (timerRef) {\n        clearInterval(timerRef);\n        startIfStopped = true;\n    }\n    interval = interval;\n\n    if (startIfStopped) {\n        timerRef = setInterval(() => postMessage("tick"), interval);\n    }\n}\n'}(e.music||(e.music={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(e){e.chromaticInterval=[1,1.0417,1.125,1.2,1.25,1.3333,1.4063,1.5,1.6,1.6667,1.8,1.875],e.majorScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[5],e.chromaticInterval[7],e.chromaticInterval[9],e.chromaticInterval[11]],e.minorScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[3],e.chromaticInterval[5],e.chromaticInterval[7],e.chromaticInterval[8],e.chromaticInterval[10]],e.pentatonicScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[7],e.chromaticInterval[9]],e.majorTriadInterval=[e.chromaticInterval[0],e.chromaticInterval[4],e.chromaticInterval[7]],e.minorTriadInterval=[e.chromaticInterval[0],e.chromaticInterval[3],e.chromaticInterval[7]],e.diminishedInterval=[e.chromaticInterval[0],e.chromaticInterval[3],e.chromaticInterval[6],e.chromaticInterval[9]],e.wholeToneInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[6],e.chromaticInterval[8],e.chromaticInterval[10]]}(e.MusicalIntervals||(e.MusicalIntervals={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(t){t.chromatic={interval:e.MusicalIntervals.chromaticInterval,length:12},t.majorScale={interval:e.MusicalIntervals.majorScaleInterval,length:7},t.minorScale={interval:e.MusicalIntervals.minorScaleInterval,length:7},t.pentatonicScale={interval:e.MusicalIntervals.pentatonicScaleInterval,length:5},t.majorTriad={interval:e.MusicalIntervals.majorTriadInterval,length:3},t.minorTriad={interval:e.MusicalIntervals.minorTriadInterval,length:3},t.diminished={interval:e.MusicalIntervals.diminishedInterval,length:4},t.wholeTone={interval:e.MusicalIntervals.wholeToneInterval,length:6},t.calculateFrequencyFromProgression=function(e,t,n){let r=Math.floor(n/t.length),i=n%t.length;return e*Math.pow(2,r)*t.interval[i]}}(e.MusicalProgressions||(e.MusicalProgressions={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(t){const n=[31,33,35,37,39,41,44,46,49,52,55,58,62,65,69,73,78,82,87,92,98,104,110,117,123,131,139,147,156,165,175,185,196,208,220,233,247,262,277,294,311,330,349,370,392,415,440,466,494,523,554,587,622,659,698,740,784,831,880,932,988,1047,1109,1175,1245,1319,1397,1480,1568,1661,1760,1865,1976,2093,2217,2349,2489,2637,2794,2960,3136,3322,3520,3729,3951,4186,4435,4699,4978,5274,5588,5920,6272,6645,7040,7459,7902];async function r(t,r,i,s,o=100){await e.AudioContextManager.playInstructionsAsync(e.music.renderInstrument(r,n[t],i,o),s)}async function i(t,n,r=100){await e.AudioContextManager.playInstructionsAsync(e.music.renderDrumInstrument(t,r),n)}function s(e,t,n){return 6e4/e/t*n}t.Sequencer=class{constructor(){this._currentTick=0,this._state="stop",this.listeners={},this.globalVolume=1024,this.trackVolumes=[],this.drumTrackVolumes=[],this.currentCancelToken={cancelled:!1},this.onTick=()=>{const e=this.currentCancelToken;for(let t=0;t<this.currentlyPlaying.tracks.length;t++){const n=this.currentlyPlaying.tracks[t];for(const o of n.notes)if(o.startTick===this._currentTick)for(const a of o.notes)n.drums?i(n.drums[a.note],(()=>e.cancelled),this.getDrumTrackVolume(t,a.note)):r(a.note,n.instrument,s(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,o.endTick-o.startTick),(()=>e.cancelled),this.getMelodicTrackVolume(t));else if(o.startTick>this._currentTick)break}this.fireEvent("tick"),this._currentTick++,this._currentTick>=this.maxTick()&&("loop"===this._state?(this._currentTick=0,this.fireEvent("looped")):this.stop(!0))}}async initAsync(){this.metronome?await this.metronome.initAsync():(this.metronome=new t.Metronome,await this.metronome.initAsync(),this.metronome.addTickListener(this.onTick))}dispose(){this.metronome&&this.metronome.dispose(),this.metronome=void 0,this.stop(),this.currentlyPlaying=void 0,this.listeners={}}state(){return this._state}currentTick(){return this._currentTick}currentTime(){return s(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,this.currentTick())}maxTick(){return this.currentlyPlaying?this.currentlyPlaying.measures*this.currentlyPlaying.beatsPerMeasure*this.currentlyPlaying.ticksPerBeat:0}duration(){return s(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,this.maxTick())}start(e,t){this.startFrom(e,t,0)}startFrom(e,t,n){"stop"!==this._state&&this.stop(),void 0!==t&&(this.shouldLoop=t),this._currentTick=null!=n?n:0,this.currentlyPlaying=e,this.metronome.start(s(e.beatsPerMinute,e.ticksPerBeat,1)),this._state=this.shouldLoop?"loop":"play",this.fireStateChange()}stop(e=!1){"stop"!==this._state&&(this._state="stop",this.metronome&&this.metronome.stop(),this.fireStateChange(),e||(this.currentCancelToken.cancelled=!0),this.currentCancelToken={cancelled:!1})}updateSong(e){this.currentlyPlaying=e,"stop"!==this._state&&this.metronome.setInterval(s(e.beatsPerMinute,e.ticksPerBeat,1))}setLooping(e){e&&"play"===this._state?(this._state="loop",this.fireStateChange()):e||"loop"!==this._state||(this._state="play",this.fireStateChange()),this.shouldLoop=e}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e!==t)))}setVolume(e){this.globalVolume=Math.min(Math.max(e,0),1024)}setTrackVolume(e,t){for(t=Math.min(Math.max(t,0),1024);this.trackVolumes.length<e;)this.trackVolumes.push(1024);this.trackVolumes[e]=t}setDrumTrackVolume(e,t,n){for(n=Math.min(Math.max(n,0),1024);this.drumTrackVolumes.length<e;)this.drumTrackVolumes.push([]);for(;this.drumTrackVolumes[e].length<t;)this.drumTrackVolumes[e].push(1024);this.drumTrackVolumes[e][t]=n}getMelodicTrackVolume(e){let t=1024;return e<this.trackVolumes.length&&(t=this.trackVolumes[e]),this.globalVolume*(t/1024)}getDrumTrackVolume(e,t){const n=this.getMelodicTrackVolume(e);let r=1024;return e<this.drumTrackVolumes.length&&t<this.drumTrackVolumes[e].length&&(r=this.drumTrackVolumes[e][t]),n*(r/1024)}fireStateChange(){this.fireEvent(this._state),this.fireEvent("state-change")}fireEvent(e){if(this.listeners[e])for(const t of this.listeners[e])t()}},t.playNoteAsync=r,t.playDrumAsync=i,t.tickToMs=s}(e.music||(e.music={}))}(pxsim||(pxsim={})),function(e){!function(e){function t(e,t,n,s){var o,a;let l=0;return(null===(o=e.pitchEnvelope)||void 0===o?void 0:o.amplitude)&&(l+=r(e.pitchEnvelope,s,n)),(null===(a=e.pitchLFO)||void 0===a?void 0:a.amplitude)&&(l+=i(e.pitchLFO,s)),Math.max(t+l,0)}function n(e,t,n,s){var o;let a=0;return e.ampEnvelope.amplitude&&(a+=r(e.ampEnvelope,n,t)),(null===(o=e.ampLFO)||void 0===o?void 0:o.amplitude)&&(a+=i(e.ampLFO,n)),Math.max(Math.min(a,e.ampEnvelope.amplitude),0)/1024*s|0}function r(e,t,n){const r=e.sustain/1024*e.amplitude;if(t>n){if(t-n>e.release)return 0;if(t<e.attack){const r=e.amplitude/e.attack*n;return r-r/e.release*(t-n)}if(t<e.attack+e.decay){const i=e.amplitude-(e.amplitude-r)/e.decay*(n-e.attack);return i-i/e.release*(t-n)}return r-r/e.release*(t-n)}return t<e.attack?e.amplitude/e.attack*t:t<e.attack+e.decay?e.amplitude-(e.amplitude-r)/e.decay*(t-e.attack):r}function i(e,t){return Math.cos(t/1e3*e.frequency*2*Math.PI)*e.amplitude}function s(e,t,n,r,i,s,a,l){return n>0&&(e[t]=s,e[t+1]=0,o(e,t+2,a),o(e,t+4,n),o(e,t+6,255*r>>6),o(e,t+8,255*i>>6),o(e,t+10,l),t+=12),e[t]=0,t}function o(e,t,n){const r=new Uint8Array(2);new Uint16Array(r.buffer)[0]=0|n,e[t]=r[0],e[t+1]=r[1]}function a(e,t){const n=new Uint8Array(2);return n[0]=e[t],n[1]=e[t+1],new Uint16Array(n.buffer)[0]}function l(e,t){return{waveform:e[t],ampEnvelope:{attack:a(e,t+1),decay:a(e,t+3),sustain:a(e,t+5),release:a(e,t+7),amplitude:a(e,t+9)},pitchEnvelope:{attack:a(e,t+11),decay:a(e,t+13),sustain:a(e,t+15),release:a(e,t+17),amplitude:a(e,t+19)},ampLFO:{frequency:e[t+21],amplitude:a(e,22)},pitchLFO:{frequency:e[t+24],amplitude:a(e,25)},octave:e[t+27]}}function c(e,t){return e[t+1]?function(e,t){const n={id:e[t],instrument:{ampEnvelope:{attack:0,decay:0,sustain:0,release:0,amplitude:0},waveform:0},notes:[],drums:[]},r=a(e,t+2);let i=t+4;for(;i<t+4+r;)n.drums.push(u(e,i)),i+=5+7*n.drums[n.drums.length-1].steps.length;const s=a(e,i);i+=2;for(;i<t+4+r+s;)n.notes.push(d(e,i,0,!0)),i+=5+n.notes[n.notes.length-1].notes.length;return[n,i]}(e,t):function(e,t){const n={id:e[t],instrument:l(e,t+4),notes:[]},r=t+4+a(e,t+2),i=a(e,r);let s=r+2;for(;s<r+2+i;)n.notes.push(d(e,s,n.instrument.octave,!1)),s+=5+n.notes[n.notes.length-1].notes.length;return[n,s]}(e,t)}function u(e,t){const n={startFrequency:a(e,t+1),startVolume:a(e,t+3),steps:[]};for(let r=0;r<e[t];r++){const i=t+5+7*r;n.steps.push({waveform:e[i],frequency:a(e,i+1),volume:a(e,i+3),duration:a(e,i+5)})}return n}function d(e,t,n,r){const i={startTick:a(e,t),endTick:a(e,t+2),notes:[]};for(let s=0;s<e[t+4];s++)i.notes.push(p(e[t+5+s],n,r));return i}function p(e,t,n){const r=e>>6,i={note:n?e:(63&e)+12*(t-2),enharmonicSpelling:"normal"};return 1===r?i.enharmonicSpelling="flat":2===r&&(i.enharmonicSpelling="sharp"),i}e.renderInstrument=function(e,r,i,o){var a,l,c,u,d;const p=i+e.ampEnvelope.release,h=(null===(a=e.ampLFO)||void 0===a?void 0:a.amplitude)?Math.max(500/e.ampLFO.frequency,50):50,f=(null===(l=e.pitchLFO)||void 0===l?void 0:l.amplitude)?Math.max(500/e.pitchLFO.frequency,50):50;let m=[0],_=e.ampEnvelope.attack,g=(null===(c=e.pitchEnvelope)||void 0===c?void 0:c.amplitude)?e.pitchEnvelope.attack:p,y=(null===(u=e.pitchLFO)||void 0===u?void 0:u.amplitude)?f:p,b=(null===(d=e.ampLFO)||void 0===d?void 0:d.amplitude)?h:p,v=0;for(;v<p&&(_<=g&&_<=y&&_<=b?(v=_,m.push(_),_=v<e.ampEnvelope.attack+e.ampEnvelope.decay&&e.ampEnvelope.attack+e.ampEnvelope.decay<i?e.ampEnvelope.attack+e.ampEnvelope.decay:v<i?i:p):g<=y&&g<=b&&g<p?(v=g,m.push(g),g=v<e.pitchEnvelope.attack+e.pitchEnvelope.decay&&e.pitchEnvelope.attack+e.pitchEnvelope.decay<i?e.pitchEnvelope.attack+e.pitchEnvelope.decay:v<i?i:v<i+e.pitchEnvelope.release?Math.min(p,i+e.pitchEnvelope.release):p):y<=b&&y<p?(v=y,m.push(y),y+=f):b<p&&(v=b,m.push(b),b+=h),!(v>=p));){for(_<=v&&(_=v<e.ampEnvelope.attack+e.ampEnvelope.decay&&e.ampEnvelope.attack+e.ampEnvelope.decay<i?e.ampEnvelope.attack+e.ampEnvelope.decay:v<i?i:p),g<=v&&(g=v<e.pitchEnvelope.attack+e.pitchEnvelope.decay&&e.pitchEnvelope.attack+e.pitchEnvelope.decay<i?e.pitchEnvelope.attack+e.pitchEnvelope.decay:v<i?i:v<i+e.pitchEnvelope.release?Math.min(p,i+e.pitchEnvelope.release):p);b<=v;)b+=h;for(;y<=v;)y+=f}let T,k,E=0|n(e,i,0,o),x=0|t(e,r,i,0),S=0;const C=new Uint8Array(12*(m.length+1));for(let a=1;a<m.length;a++)m[a]-S<5||(T=0|n(e,i,m[a],o),k=0|t(e,r,i,m[a]),s(C,12*(a-1),m[a]-S|0,E,T,e.waveform,x,k),E=T,x=k),S=m[a];return s(C,12*m.length,10,E,0,e.waveform,x,x),C},e.renderDrumInstrument=function(e,t){let n=e.startVolume,r=e.startFrequency;const i=e=>e/1024*t;let o=new Uint8Array(12*(e.steps.length+1));for(let t=0;t<e.steps.length;t++)s(o,12*t,e.steps[t].duration,i(n),i(e.steps[t].volume),e.steps[t].waveform,r,e.steps[t].frequency),n=e.steps[t].volume,r=e.steps[t].frequency;return s(o,12*e.steps.length,10,i(n),0,e.steps[e.steps.length-1].waveform,r,r),o},e.decodeSong=function(e){const t={beatsPerMinute:a(e,1),beatsPerMeasure:e[3],ticksPerBeat:e[4],measures:e[5],tracks:[]};let n=7;for(;n<e.length;){const[r,i]=c(e,n);n=i,t.tracks.push(r)}return t}}(e.music||(e.music={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){e.EMOJI_SYNTHESIZER_SAMPLE_RATE=44100,e.EMOJI_SYNTHESIZER_TONE_WIDTH_F=1024,e.EMOJI_SYNTHESIZER_TONE_WIDTH=1024,e.EMOJI_SYNTHESIZER_BUFFER_SIZE=512,e.EMOJI_SYNTHESIZER_TONE_EFFECT_PARAMETERS=2,e.EMOJI_SYNTHESIZER_TONE_EFFECTS=3,e.EMOJI_SYNTHESIZER_STATUS_ACTIVE=1,e.EMOJI_SYNTHESIZER_STATUS_OUTPUT_SILENCE_AS_EMPTY=2,e.EMOJI_SYNTHESIZER_STATUS_STOPPING=4;e.SoundEmojiSynthesizer=class{constructor(t,n=e.EMOJI_SYNTHESIZER_SAMPLE_RATE){this.samplesPerStep=[],this.status=0,this.effectPointer=0,this.position=0,this.bufferSize=e.EMOJI_SYNTHESIZER_BUFFER_SIZE,this.sampleRate=n,this.samplesToWrite=0,this.samplesWritten=0,this.sampleRange=1023,this.orMask=0,this.effectPointer=-1,this.volume=1}get effect(){return this.effectBuffer[this.effectPointer]}play(e){this.effectBuffer=e,this.effectPointer=-1,this.nextSoundEffect()}nextSoundEffect(){const t=null!=this.effect;if(this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING&&(this.effectPointer=null,this.effectBuffer=[]),this.effect?this.effectPointer++:this.effectPointer=0,this.effectPointer>=this.effectBuffer.length&&(this.effectPointer=0,this.effect.duration>=0))return this.effectPointer=-1,this.effectBuffer=[],this.samplesWritten=0,this.samplesToWrite=0,this.position=0,t;this.samplesToWrite=this.determineSampleCount(this.effect.duration),this.frequency=this.effect.frequency,this.volume=this.effect.volume,this.samplesWritten=0;for(let t=0;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)this.effect.effects[t].step=0,this.effect.effects[t].steps=Math.max(this.effect.effects[t].steps,1),this.samplesPerStep[t]=Math.floor(this.samplesToWrite/this.effect.effects[t].steps);return!1}pull(){let t,n,r=!1;for(;!r;){if(this.samplesWritten==this.samplesToWrite||this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING){let t=this.nextSoundEffect();(0==this.samplesToWrite||this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(r=!0,(t||this.status&e.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(this.status&=~e.EMOJI_SYNTHESIZER_STATUS_STOPPING))}for(!(this.samplesWritten<this.samplesToWrite)&&this.status&e.EMOJI_SYNTHESIZER_STATUS_OUTPUT_SILENCE_AS_EMPTY||null!=t||(this.buffer=new Array(this.bufferSize),t=0,n=this.buffer.length);this.samplesWritten<this.samplesToWrite;){let r=e.EMOJI_SYNTHESIZER_TONE_WIDTH_F*this.frequency/this.sampleRate,i=this.sampleRange*this.volume/1024,s=512-512*i,o=[];for(let t=0;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)o[t]=this.samplesPerStep[t]*this.effect.effects[t].step,this.effect.effects[t].step==this.effect.effects[t].steps-1&&(o[t]=this.samplesToWrite);let a=o[0];for(let t=1;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)a=Math.min(a,o[t]);for(;this.samplesWritten<a;){if(t==n)return this.buffer;let o=this.effect.tone.tonePrint(this.effect.tone.parameter,Math.max(this.position,0));for(this.buffer[t]=o*i+s,t++,this.samplesWritten++,this.position+=r;this.position>e.EMOJI_SYNTHESIZER_TONE_WIDTH_F;)this.position-=e.EMOJI_SYNTHESIZER_TONE_WIDTH_F}for(let t=0;t<e.EMOJI_SYNTHESIZER_TONE_EFFECTS;t++)this.samplesWritten==o[t]&&this.effect.effects[t].step<this.effect.effects[t].steps&&(this.effect.effects[t].effect&&this.effect.effects[t].effect(this,this.effect.effects[t]),this.effect.effects[t].step++)}}if(null==t)this.buffer=[];else{const e=.5*this.sampleRange;for(;t<n;)this.buffer[t]=e,t++}return this.buffer}determineSampleCount(e){e<0&&(e=-e);const t=e/1e3;return Math.floor(this.sampleRate*t)}totalDuration(){let e=0;for(const t of this.effectBuffer)e+=t.duration;return e}}}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(e){const t=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,3,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,11,11,12,13,13,14,15,16,16,17,18,19,20,21,22,22,23,24,25,26,27,28,29,30,32,33,34,35,36,37,38,40,41,42,43,45,46,47,49,50,51,53,54,56,57,58,60,61,63,64,66,68,69,71,72,74,76,77,79,81,82,84,86,87,89,91,93,95,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,141,143,145,147,149,152,154,156,158,161,163,165,167,170,172,175,177,179,182,184,187,189,191,194,196,199,201,204,206,209,211,214,216,219,222,224,227,229,232,235,237,240,243,245,248,251,253,256,259,262,264,267,270,273,275,278,281,284,287,289,292,295,298,301,304,307,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390,393,396,399,402,405,408,411,414,417,420,424,427,430,433,436,439,442,445,448,452,455,458,461,464,467,470,473,477,480,483,486,489,492,495,498,502,505,508,511,514,517,520,524,527,530,533,536,539,542,545,549,552,555,558,561,564,567,570,574,577,580,583,586,589,592,595,598,602,605,608,611,614,617,620,623,626,629,632,635,638,641,644,647,650,653,656,659,662,665,668,671,674,677,680,683,686,689,692,695,698,701,704,707,710,713,715,718,721,724,727,730,733,735,738,741,744,747,749,752,755,758,760,763,766,769,771,774,777,779,782,785,787,790,793,795,798,800,803,806,808,811,813,816,818,821,823,826,828,831,833,835,838,840,843,845,847,850,852,855,857,859,861,864,866,868,870,873,875,877,879,881,884,886,888,890,892,894,896,898,900,902,904,906,908,910,912,914,916,918,920,922,924,926,927,929,931,933,935,936,938,940,941,943,945,946,948,950,951,953,954,956,958,959,961,962,964,965,966,968,969,971,972,973,975,976,977,979,980,981,982,984,985,986,987,988,989,990,992,993,994,995,996,997,998,999,1e3,1e3,1001,1002,1003,1004,1005,1006,1006,1007,1008,1009,1009,1010,1011,1011,1012,1013,1013,1014,1014,1015,1015,1016,1016,1017,1017,1018,1018,1019,1019,1019,1020,1020,1020,1021,1021,1021,1021,1022,1022,1022,1022,1022,1022,1022,1022,1022,1022,1023,1022];e.SineTone=function(e,n){let r=1024-(n|=0);return r<512&&(n=r),t[n]},e.SawtoothTone=function(e,t){return t},e.TriangleTone=function(e,t){return t<512?2*t:2*(1023-t)},e.NoiseTone=function(e,t){let n=e[0];return 0==n&&(n=7919),t*n&1023},e.SquareWaveTone=function(e,t){return t<512?1023:0}}(e.Synthesizer||(e.Synthesizer={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(e){!function(e){!function(t){t.noInterpolation=function(e,t){},t.linearInterpolation=function(e,t){let n=(t.parameter[0]-e.effect.frequency)/t.steps;e.frequency=e.effect.frequency+n*t.step},t.logarithmicInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.log10(Math.max(t.step,.1))*(t.parameter[0]-e.effect.frequency)/1.95},t.curveInterpolation=function(e,t){e.frequency=Math.sin(3.12159*t.step/180)*(t.parameter[0]-e.effect.frequency)+e.effect.frequency},t.slowVibratoInterpolation=function(e,t){e.frequency=Math.sin(t.step/10)*t.parameter[0]+e.effect.frequency},t.warbleInterpolation=function(e,t){e.frequency=Math.sin(t.step)*(t.parameter[0]-e.effect.frequency)+e.effect.frequency},t.vibratoInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.sin(t.step)*t.parameter[0]},t.exponentialRisingInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.sin(.01745329*t.step)*t.parameter[0]},t.exponentialFallingInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.cos(.01745329*t.step)*t.parameter[0]},t.appregrioAscending=function(t,n){t.frequency=e.MusicalProgressions.calculateFrequencyFromProgression(t.effect.frequency,n.parameter_p[0],n.step)},t.appregrioDescending=function(t,n){t.frequency=e.MusicalProgressions.calculateFrequencyFromProgression(t.effect.frequency,n.parameter_p[0],n.steps-n.step-1)},t.frequencyVibratoEffect=function(e,t){0!=t.step&&(t.step%2==0?e.frequency/=t.parameter[0]:e.frequency*=t.parameter[0])},t.volumeVibratoEffect=function(e,t){0!=t.step&&(t.step%2==0?e.volume/=t.parameter[0]:e.volume*=t.parameter[0])},t.adsrVolumeEffect=function(e,t){let n=.5*t.steps;if(t.step<=n){let r=(t.parameter[0]-e.effect.volume)/n;e.volume=e.effect.volume+t.step*r}else{let r=(t.parameter[1]-t.parameter[0])/n;e.volume=t.parameter[0]+(t.step-n)*r}},t.volumeRampEffect=function(e,t){let n=(t.parameter[0]-e.effect.volume)/t.steps;e.volume=e.effect.volume+t.step*n}}(e.SoundSynthesizerEffects||(e.SoundSynthesizerEffects={}))}(e.music||(e.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){!function(t){!function(t){let n,r,i;!function(e){e[e.Sine=0]="Sine",e[e.Sawtooth=1]="Sawtooth",e[e.Triangle=2]="Triangle",e[e.Square=3]="Square",e[e.Noise=4]="Noise"}(n=t.WaveShape||(t.WaveShape={})),function(e){e[e.None=0]="None",e[e.Linear=1]="Linear",e[e.Curve=2]="Curve",e[e.ExponentialRising=5]="ExponentialRising",e[e.ExponentialFalling=6]="ExponentialFalling",e[e.ArpeggioRisingMajor=8]="ArpeggioRisingMajor",e[e.ArpeggioRisingMinor=10]="ArpeggioRisingMinor",e[e.ArpeggioRisingDiminished=12]="ArpeggioRisingDiminished",e[e.ArpeggioRisingChromatic=14]="ArpeggioRisingChromatic",e[e.ArpeggioRisingWholeTone=16]="ArpeggioRisingWholeTone",e[e.ArpeggioFallingMajor=9]="ArpeggioFallingMajor",e[e.ArpeggioFallingMinor=11]="ArpeggioFallingMinor",e[e.ArpeggioFallingDiminished=13]="ArpeggioFallingDiminished",e[e.ArpeggioFallingChromatic=15]="ArpeggioFallingChromatic",e[e.ArpeggioFallingWholeTone=17]="ArpeggioFallingWholeTone",e[e.Logarithmic=18]="Logarithmic"}(r=t.InterpolationEffect||(t.InterpolationEffect={})),function(e){e[e.None=0]="None",e[e.Vibrato=1]="Vibrato",e[e.Tremolo=2]="Tremolo",e[e.Warble=3]="Warble"}(i=t.Effect||(t.Effect={}));class s{constructor(){this.src="000000000000000000000000000000000000000000000000000000000000000000000000"}get wave(){return this.getValue(0,1)}set wave(e){this.setValue(0,_(e,0,4),1)}get volume(){return this.getValue(1,4)}set volume(e){this.setValue(1,_(e,0,1023),4)}get frequency(){return this.getValue(5,4)}set frequency(e){this.setValue(5,e,4)}get duration(){return this.getValue(9,4)}set duration(e){this.setValue(9,e,4)}get shape(){return this.getValue(13,2)}set shape(e){this.setValue(13,e,2)}get endFrequency(){return this.getValue(18,4)}set endFrequency(e){this.setValue(18,e,4)}get endVolume(){return this.getValue(26,4)}set endVolume(e){this.setValue(26,_(e,0,1023),4)}get steps(){return this.getValue(30,4)}set steps(e){this.setValue(30,e,4)}get fx(){return this.getValue(34,2)}set fx(e){this.setValue(34,_(e,0,3),2)}get fxParam(){return this.getValue(36,4)}set fxParam(e){this.setValue(36,e,4)}get fxnSteps(){return this.getValue(40,4)}set fxnSteps(e){this.setValue(40,e,4)}get frequencyRandomness(){return this.getValue(44,4)}set frequencyRandomness(e){this.setValue(44,e,4)}get endFrequencyRandomness(){return this.getValue(48,4)}set endFrequencyRandomness(e){this.setValue(48,e,4)}get volumeRandomness(){return this.getValue(52,4)}set volumeRandomness(e){this.setValue(52,e,4)}get endVolumeRandomness(){return this.getValue(56,4)}set endVolumeRandomness(e){this.setValue(56,e,4)}get durationRandomness(){return this.getValue(60,4)}set durationRandomness(e){this.setValue(60,e,4)}get fxParamRandomness(){return this.getValue(64,4)}set fxParamRandomness(e){this.setValue(64,e,4)}get fxnStepsRandomness(){return this.getValue(68,4)}set fxnStepsRandomness(e){this.setValue(68,e,4)}copy(){const e=new s;return e.src=this.src.slice(0),e}setValue(e,t,n){t=_(0|t,0,Math.pow(10,n)-1),this.src=this.src.substr(0,e)+function(e,t){let n=e+"";for(;n.length<t;)n="0"+n;return n}(t,n)+this.src.substr(e+n)}getValue(e,t){return parseInt(this.src.substr(e,t))}}t.Sound=s;let o,a=!1,l={cancelled:!1};async function c(){if(o.length){a=!0;const e=o.shift();let t=l;try{e.onStarted(),await d(e.notes,(()=>t.cancelled)),t.cancelled?e.onCancelled():e.onFinished()}catch(t){e.onCancelled()}c()}else a=!1}function u(){o=[],l.cancelled=!0,l={cancelled:!1}}function d(n,r,i){const s=new t.SoundEmojiSynthesizer(0),o=function(e){const t=72,n=Math.floor((e.length+1)/(t+1)),r=n*(t+1)-1;if(e.length!=r)return[];const i=[];for(let r=0;r<n;++r){const n=r*t+r;if(n>0&&","!=e[n-1])return[];const s=m();if(!p(e.substr(n),s))return[];i.push(s)}return i}(n);s.play(o);let a=!1;return Promise.race([(l=s.totalDuration(),new Promise((e=>setTimeout(e,l)))).then((()=>{a=!0})),e.AudioContextManager.playPCMBufferStreamAsync((()=>{if(!s.effect)return;const e=s.pull();i&&i(s.frequency,s.volume);const t=new Float32Array(e.length);for(let n=0;n<e.length;n++)t[n]=(e[n]-512)/512;return t}),s.sampleRate,.03,(()=>a||r&&r()))]);var l}function p(e,n){let r=parseInt(e.substr(0,1)),i=parseInt(e.substr(1,4)),s=parseInt(e.substr(5,4)),o=parseInt(e.substr(9,4)),a=parseInt(e.substr(13,2)),l=parseInt(e.substr(18,4)),c=parseInt(e.substr(26,4)),u=parseInt(e.substr(30,4)),d=parseInt(e.substr(34,2)),p=parseInt(e.substr(36,4)),m=parseInt(e.substr(40,4));if(s=f(s,parseInt(e.substr(44,4))),l=f(l,parseInt(e.substr(48,4))),i=f(i,parseInt(e.substr(52,4))),c=f(c,parseInt(e.substr(56,4))),o=f(o,parseInt(e.substr(60,4))),p=f(p,parseInt(e.substr(64,4))),m=f(m,parseInt(e.substr(68,4))),-1==s||-1==l||-1==i||-1==c||-1==o||-1==p||-1==m)return!1;switch(r){case 0:n.tone.tonePrint=t.Synthesizer.SineTone;break;case 1:n.tone.tonePrint=t.Synthesizer.SawtoothTone;break;case 2:n.tone.tonePrint=t.Synthesizer.TriangleTone;break;case 3:n.tone.tonePrint=t.Synthesizer.SquareWaveTone;break;case 4:n.tone.tonePrint=t.Synthesizer.NoiseTone}switch(n.frequency=s,n.duration=o,n.effects[0].steps=u,a){case 0:n.effects[0].effect=t.SoundSynthesizerEffects.noInterpolation;break;case 1:n.effects[0].effect=t.SoundSynthesizerEffects.linearInterpolation,n.effects[0].parameter[0]=l;break;case 2:n.effects[0].effect=t.SoundSynthesizerEffects.curveInterpolation,n.effects[0].parameter[0]=l;break;case 5:n.effects[0].effect=t.SoundSynthesizerEffects.exponentialRisingInterpolation,n.effects[0].parameter[0]=l;break;case 6:n.effects[0].effect=t.SoundSynthesizerEffects.exponentialFallingInterpolation,n.effects[0].parameter[0]=l;break;case 8:case 10:case 12:case 14:case 16:n.effects[0].effect=t.SoundSynthesizerEffects.appregrioAscending;break;case 9:case 11:case 13:case 15:case 17:n.effects[0].effect=t.SoundSynthesizerEffects.appregrioDescending;break;case 18:n.effects[0].effect=t.SoundSynthesizerEffects.logarithmicInterpolation,n.effects[0].parameter[0]=l}switch(a){case 8:case 9:n.effects[0].parameter_p[0]=t.MusicalProgressions.majorScale;break;case 10:case 11:n.effects[0].parameter_p[0]=t.MusicalProgressions.minorScale;break;case 12:case 13:n.effects[0].parameter_p[0]=t.MusicalProgressions.diminished;break;case 14:case 15:n.effects[0].parameter_p[0]=t.MusicalProgressions.chromatic;break;case 16:case 17:n.effects[0].parameter_p[0]=t.MusicalProgressions.wholeTone}let _=h(0,i,1023)/1023,g=h(0,c,1023)/1023;n.volume=1*_,n.effects[1].effect=t.SoundSynthesizerEffects.volumeRampEffect,n.effects[1].steps=36,n.effects[1].parameter[0]=1*g;let y=Math.round(n.duration/1e4*m);switch(d){case 1:n.effects[2].steps=y,n.effects[2].effect=t.SoundSynthesizerEffects.frequencyVibratoEffect,n.effects[2].parameter[0]=p;break;case 2:n.effects[2].steps=y,n.effects[2].effect=t.SoundSynthesizerEffects.volumeVibratoEffect,n.effects[2].parameter[0]=p;break;case 3:n.effects[2].steps=y,n.effects[2].effect=t.SoundSynthesizerEffects.warbleInterpolation,n.effects[2].parameter[0]=p}return!0}function h(e,t,n){return Math.min(n,Math.max(e,t))}function f(e,t){if(e<0||t<0)return-1;const n=(r=2*t+1,Math.floor(Math.random()*r)-t);var r;return Math.abs(e+n)}function m(){const e={frequency:0,volume:1,duration:0,tone:{tonePrint:void 0,parameter:[0]},effects:[]};for(let n=0;n<t.EMOJI_SYNTHESIZER_TONE_EFFECTS;n++)e.effects.push({effect:void 0,step:0,steps:0,parameter:[],parameter_p:[]});return e}function _(e,t,n){return Math.min(Math.max(e,t),n)}t.isSoundExpPlaying=function(){return a},t.__playSoundExpression=function(t,n){o||(o=[]);const r=e.getResume(),i=new Promise(((e,i)=>{o.push({notes:t,onStarted:()=>{n||r()},onFinished:e,onCancelled:e})}));a||c(),n&&i.then(r)},t.clearSoundQueue=u,t.playSoundExpressionAsync=d,t.__stopSoundExpressions=function(){u(),e.AudioContextManager.stopAll()},t.parseSoundExpression=p}(t.music||(t.music={}))}(e.codal||(e.codal={}))}(pxsim||(pxsim={})),function(e){class t{constructor(e){this.id=e}}e.Button=t;e.ButtonPairState=class{constructor(e){this.props=e,this.usesButtonAB=!1,this.aBtn=new t(this.props.ID_BUTTON_A),this.bBtn=new t(this.props.ID_BUTTON_B),this.abBtn=new t(this.props.ID_BUTTON_AB),this.abBtn.virtual=!0}}}(pxsim||(pxsim={})),function(e){e.CompassState=class{constructor(){this.usesHeading=!1,this.heading=90}}}(pxsim||(pxsim={})),function(e){e.FileSystemState=class{constructor(){this.files={}}append(e,t){this.files[e]=(this.files[e]||"")+t}remove(e){delete this.files[e]}}}(pxsim||(pxsim={})),function(e){e.LightSensorState=class{constructor(){this.usesLightLevel=!1,this.lightLevel=128}}}(pxsim||(pxsim={})),function(e){!function(t){t.mkBoardView=e=>{const n=e.visual;return new t.GenericBoardSvg({visualDef:n,boardDef:e.boardDef,wireframe:e.wireframe})};t.BoardHost=class{constructor(n,r){this.parts=[],this.boardView=n,this.opts=r,r.boardDef.pinStyles||(r.boardDef.pinStyles={}),this.state=r.state;let i=r.partsList,s=0<i.length||r.forceBreadboardLayout;if(s){this.breadboard=new t.Breadboard({wireframe:r.wireframe});const n=r.boardDef.marginWhenBreadboarding||[0,0,40,0],o=t.composeSVG({el1:this.boardView.getView(),scaleUnit1:this.boardView.getPinDist(),el2:this.breadboard.getSVGAndSize(),scaleUnit2:this.breadboard.getPinDist(),margin:[n[0],n[1],20,n[3]],middleMargin:n[2],maxWidth:r.maxWidth,maxHeight:r.maxHeight}),a=o.under,l=o.over;this.view=o.host;const c=o.edges;this.fromMBCoord=o.toHostCoord1,this.fromBBCoord=o.toHostCoord2,this.partGroup=l,this.partOverGroup=e.svg.child(this.view,"g"),this.style=e.svg.child(this.view,"style",{}),this.defs=e.svg.child(this.view,"defs",{}),this.wireFactory=new t.WireFactory(a,l,c,this.style,this.getLocCoord.bind(this),this.getPinStyle.bind(this));const u=e.allocateDefinitions({boardDef:r.boardDef,partDefs:r.partDefs,fnArgs:r.fnArgs,getBBCoord:this.breadboard.getCoord.bind(this.breadboard),partsList:i});u.partsAndWires.length||r.forceBreadboardLayout?(this.addAll(u),u.requiresBreadboard||r.forceBreadboardRender?u.hideBreadboard&&this.breadboard&&this.breadboard.hide():s=!1):s=!1}if(!s){delete this.breadboard,delete this.wireFactory,delete this.partOverGroup,delete this.partGroup,delete this.style,delete this.defs,delete this.fromBBCoord,delete this.fromMBCoord;const t=this.boardView.getView().el;this.view=t,this.partGroup=e.svg.child(this.view,"g"),this.partOverGroup=e.svg.child(this.view,"g"),r.maxWidth&&e.svg.hydrate(this.view,{width:r.maxWidth}),r.maxHeight&&e.svg.hydrate(this.view,{height:r.maxHeight})}this.state.updateSubscribers.push((()=>this.updateState()))}highlightBoardPin(e){this.boardView.highlightPin(e)}removeEventListeners(){this.boardView.removeEventListeners&&this.boardView.removeEventListeners()}highlightBreadboardPin(e){this.breadboard.highlightLoc(e)}highlightWire(t){t.wires.forEach((t=>{e.U.addClass(t,"highlight"),t.style.visibility="visible"})),e.U.addClass(t.endG,"highlight")}getView(){return this.view}screenshotAsync(e){const t=this.view.classList.contains("sim")?this.view:this.view.querySelector(".sim"),n=t?t.cloneNode(!0):this.view.cloneNode(!0);n.setAttribute("width",n.viewBox.baseVal.width+""),n.setAttribute("height",n.viewBox.baseVal.height+"");const r=(new XMLSerializer).serializeToString(n),i="data:image/svg+xml,"+encodeURIComponent(r.replace(/\s+/g," ").replace(/"/g,"'"));return new Promise(((t,n)=>{const r=document.createElement("img");r.onload=()=>{const n=document.createElement("canvas");n.width=r.width,n.height=r.height,e>0?(n.width=e,n.height=r.height*e/r.width|0):n.width<200?(n.width*=2,n.height*=2):n.width>480&&(n.width/=2,n.height/=2);const i=n.getContext("2d");i.drawImage(r,0,0,n.width,n.height),t(i.getImageData(0,0,n.width,n.height))},r.onerror=e=>{console.log(e),t(void 0)},r.src=i}))}updateState(){this.parts.forEach((e=>e.updateState()))}getBBCoord(e){let t=this.breadboard.getCoord(e);return this.fromBBCoord(t)}getPinCoord(e){let t=this.boardView.getCoord(e);if(t)return this.fromMBCoord(t);console.error(`Unable to find coord for pin: ${e}`)}getLocCoord(e){let t;if("breadboard"===e.type){let n=e;t=this.getBBCoord(n)}else{let n=e.pin;t=this.getPinCoord(n)}return t||console.debug("Unknown location: "+name),t}getPinStyle(e){return"breadboard"==e.type?"female":this.opts.boardDef.pinStyles[e.pin]||"female"}addPart(n){let r=null;if(n.simulationBehavior){let e=n.simulationBehavior,t=this.state.builtinVisuals[e],i=this.state.builtinParts[e];r=t(),r.init(this.state.bus,i,this.view,n.params)}else{let e=n.visual;r=new t.GenericPart(e)}this.parts.push(r),this.partGroup.appendChild(r.element),r.overElement&&this.partOverGroup.appendChild(r.overElement),r.defs&&r.defs.forEach((e=>this.defs.appendChild(e))),this.style.textContent+=r.style||"";let i=n.startColumnIdx,s=n.startRowIdx,o={type:"breadboard",row:t.getRowName(s),col:t.getColumnName(i),xOffset:n.bbFit.xOffset/n.visual.pinDistance,yOffset:n.bbFit.yOffset/n.visual.pinDistance},a=this.getBBCoord(o);r.moveToCoord(a);let l=`sim-${n.name}-cmp`;return e.U.addClass(r.element,l),e.U.addClass(r.element,"sim-cmp"),r.updateTheme(),r.updateState(),r}addWire(e){return this.wireFactory.addWire(e.start,e.end,e.color)}addAll(e){e.partsAndWires.forEach((t=>{const n=t.wires,r=n&&n.every((e=>this.wireFactory.checkWire(e.start,e.end)));r&&n.forEach((t=>e.wires.push(this.addWire(t))));let i=t.part;!i||n&&!r||e.parts.push(this.addPart(i))})),e.requiresBreadboard=!!e.wires.length||!!e.parts.length}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){const n=15,r="#DD4BA0",i=`\n        /* bread board */\n        .sim-bb-background {\n            fill:#E0E0E0;\n        }\n        .sim-bb-pin {\n            fill:#999;\n        }\n        .sim-bb-pin-hover {\n            visibility: hidden;\n            pointer-events: all;\n            stroke-width: 7.5px;\n            stroke: transparent;\n            fill: #777;\n        }\n        .sim-bb-pin-hover:hover {\n            visibility: visible;\n            fill:#444;\n        }\n        .sim-bb-group-wire {\n            stroke: #999;\n            stroke-width: 3.75px;\n            visibility: hidden;\n        }\n        .sim-bb-pin-group {\n            pointer-events: all;\n        }\n        .sim-bb-label,\n        .sim-bb-label-hover {\n            font-family:"Lucida Console", Monaco, monospace;\n            fill:#555;\n            pointer-events: all;\n            stroke-width: 0;\n            cursor: default;\n        }\n        .sim-bb-label-hover {\n            visibility: hidden;\n            fill:#000;\n            font-weight: bold;\n        }\n        .sim-bb-bar {\n            stroke-width: 0;\n        }\n        .sim-bb-blue {\n            fill:#1AA5D7;\n            stroke:#1AA5D7\n        }\n        .sim-bb-red {\n            fill:${r};\n            stroke:${r};\n        }\n        .sim-bb-pin-group:hover .sim-bb-pin-hover,\n        .sim-bb-pin-group:hover .sim-bb-group-wire,\n        .sim-bb-pin-group:hover .sim-bb-label-hover {\n            visibility: visible;\n        }\n        .sim-bb-pin-group:hover .sim-bb-label {\n            visibility: hidden;\n        }\n        /* outline mode */\n        .sim-bb-outline .sim-bb-background {\n            stroke-width: ${n/7}px;\n            fill: #FFF;\n            stroke: #000;\n        }\n        .sim-bb-outline .sim-bb-mid-channel {\n            fill: #FFF;\n            stroke: #888;\n            stroke-width: 2px;\n        }\n        /* grayed out */\n        .grayed .sim-bb-background {\n            stroke-width: 3px;\n        }\n        .grayed .sim-bb-red,\n        .grayed .sim-bb-blue {\n            fill: #BBB;\n        }\n        .grayed .sim-bb-bar {\n            fill: #FFF;\n        }\n        .grayed .sim-bb-pin {\n            fill: #000;\n            stroke: #FFF;\n            stroke-width: 3px;\n        }\n        .grayed .sim-bb-label {\n            fill: none;\n        }\n        .grayed .sim-bb-background {\n            stroke-width: 7.5px;\n            stroke: #555;\n        }\n        .grayed .sim-bb-group-wire {\n            stroke: #DDD;\n        }\n        .grayed .sim-bb-channel {\n            visibility: hidden;\n        }\n        /* highlighted */\n        .sim-bb-label.highlight {\n            visibility: hidden;\n        }\n        .sim-bb-label-hover.highlight {\n            visibility: visible;\n        }\n        .sim-bb-blue.highlight {\n            fill:#1AA5D7;\n        }\n        .sim-bb-red.highlight {\n            fill:${r};\n        }\n        .sim-bb-bar.highlight {\n            stroke-width: 0px;\n        }\n        `;t.BREADBOARD_MID_ROWS=10,t.BREADBOARD_MID_COLS=30;const s=[4,4],o=t.BREADBOARD_MID_ROWS+s.length,a=25,l=[4,9,14,19],c=a+l.length,u=n*(t.BREADBOARD_MID_COLS+3),d=n*(o+4+5.5),p=2/3,h=d*p,f=.16666666666666669*d,m=(t.BREADBOARD_MID_COLS-1)*n,_=(u-m)/2,g=f+(h-(o-1)*n)/2,y=(c-1)*n,b=(u-y)/2,v=(f-15)/2,T=b,k=v+f+h,E=25.5,x=12,S=1.05,C=-90,I="abcdefghij".split("").reverse();function A(e){return`${e+1}`}function w(e){return I[e]}function N(t){let n=t.xOffset||0,r=t.yOffset||0,i=[],s=e.svg.elt("g"),o=t.colStartIdx||0,a=t.rowStartIdx||0,l=e=>e?e.slice(0,e.length):[],c=(e,t)=>{let n,r=0;for(;0<=(n=e.indexOf(t));)e.splice(n,1),r+=1;return r},u=0,d=l(t.rowIdxsWithGap);for(let p=0;p<t.rowCount;p++){let h=0,f=l(t.colIdxsWithGap),m=r+p*t.pinDist+u*t.pinDist,_=p+a;for(let r=0;r<t.colCount;r++){let a=n+r*t.pinDist+h*t.pinDist,l=r+o;const u=t=>(e.svg.hydrate(t.el,"circle"==t.el.tagName?{cx:a,cy:m}:{x:a-.5*t.w,y:m-.5*t.h}),s.appendChild(t.el),t.el);let d=u(t.mkPin()),p=u(t.mkHoverPin()),g=t.getRowName(_),y=t.getColName(l),b=t.getGroupName?t.getGroupName(_,l):null,v={el:d,hoverEl:p,cx:a,cy:m,row:g,col:y,group:b};i.push(v),h+=c(f,l)}u+=c(d,_)}return{g:s,allPins:i}}function D(){let t=e.svg.elt("rect");return e.svg.hydrate(t,{class:"sim-bb-pin",rx:2,ry:2,width:6,height:6}),{el:t,w:6,h:6,x:0,y:0}}function O(){let t=e.svg.elt("rect"),n=6*1.3;return e.svg.hydrate(t,{class:"sim-bb-pin-hover",rx:2,ry:2,width:n,height:n}),{el:t,w:n,h:n,x:0,y:0}}function R(n,r,i,s,o,a,l){let c=t.mkTxt(n,r,i,s,o);e.U.addClass(c,"sim-bb-label"),l&&l.forEach((t=>e.U.addClass(c,t)));let u=t.mkTxt(n,r,1.3*i,s,o);return e.U.addClass(u,"sim-bb-label-hover"),l&&l.forEach((t=>e.U.addClass(u,t))),{el:c,hoverEl:u,txt:o,group:a}}t.getColumnName=A,t.getRowName=w,t.mkGrid=N;t.Breadboard=class{constructor(t){this.allPins=[],this.allLabels=[],this.allPowerBars=[],this.rowColToPin={},this.rowColToLbls={},this.buildDom(),t.wireframe&&e.U.addClass(this.bb,"sim-bb-outline")}hide(){this.bb.style.display="none"}updateLocation(t,n){e.svg.hydrate(this.bb,{x:`${t}px`,y:`${n}px`})}getPin(e,t){let n=this.rowColToPin[e];if(!n)return null;let r=n[t];return r||null}getCoord(e){let{row:t,col:r,xOffset:i,yOffset:s}=e,o=this.getPin(t,r);if(!o)return null;let a=(i||0)*n,l=(s||0)*n;return[o.cx+a,o.cy+l]}getPinDist(){return n}buildDom(){this.bb=e.svg.elt("svg",{version:"1.0",viewBox:`0 0 ${u} ${d}`,class:"sim-bb",width:u+"px",height:d+"px"}),this.styleEl=e.svg.child(this.bb,"style",{}),this.styleEl.textContent+=i,this.defs=e.svg.child(this.bb,"defs",{}),e.svg.child(this.bb,"rect",{class:"sim-bb-background",width:u,height:d,rx:4.5,ry:4.5});let r="sim-bb-channel-grad",o=e.svg.elt("linearGradient");e.svg.hydrate(o,{id:r,x1:"0%",y1:"0%",x2:"0%",y2:"100%"}),this.defs.appendChild(o);e.svg.child(o,"stop",{offset:"0%",style:"stop-color: #AAA;"}),e.svg.child(o,"stop",{offset:"20%",style:"stop-color: #CCC;"}),e.svg.child(o,"stop",{offset:"80%",style:"stop-color: #CCC;"}),e.svg.child(o,"stop",{offset:"100%",style:"stop-color: #AAA;"});const c=(t,n,i)=>{let s=e.svg.child(this.bb,"rect",{class:`sim-bb-channel ${i||""}`,y:t-n/2,width:u,height:n});return s.setAttribute("fill",`url(#${r})`),s};c(f+h/2,15,"sim-bb-mid-channel"),c(f,.75,"sim-bb-sml-channel"),c(f+h,.75,"sim-bb-sml-channel");const p=(e,n)=>`${(e=>e<t.BREADBOARD_MID_ROWS/2?"b":"t")(e)}${A(n)}`,m=e=>0===e?"-":"+",I=(e,t)=>{let n=(e=>e<25?"b":"t")(t);return`${m(e)}${n}`};let L=N({xOffset:_,yOffset:g,rowCount:t.BREADBOARD_MID_ROWS,colCount:t.BREADBOARD_MID_COLS,pinDist:n,mkPin:D,mkHoverPin:O,getRowName:w,getColName:A,getGroupName:p,rowIdxsWithGap:s});L.g;this.allPins=this.allPins.concat(L.allPins);let P=N({xOffset:T,yOffset:k,rowCount:2,colCount:a,pinDist:n,mkPin:D,mkHoverPin:O,getRowName:m,getColName:A,getGroupName:I,colIdxsWithGap:l});P.g;this.allPins=this.allPins.concat(P.allPins);let M=N({xOffset:b,yOffset:v,rowCount:2,colCount:a,colStartIdx:a,pinDist:n,mkPin:D,mkHoverPin:O,getRowName:m,getColName:A,getGroupName:I,colIdxsWithGap:l.map((e=>e+a))});M.g;this.allPins=this.allPins.concat(M.allPins),this.allPins.forEach((t=>{let{el:n,row:r,col:i,hoverEl:s}=t,o=`(${r},${i})`;e.svg.hydrate(n,{title:o}),e.svg.hydrate(s,{title:o})})),this.allPins.forEach((e=>{let t=this.rowColToPin[e.row];t||(t=this.rowColToPin[e.row]={}),t[e.col]=e}));const F=(e,t,n,r,i,s)=>{let o=this.getCoord({type:"breadboard",row:e,col:t}),[a,l]=o;return R(a+n,l+r,10.5,-90,i,s)};for(let e=0;e<t.BREADBOARD_MID_COLS;e++){let n=A(e),r=0,i=F(w(r),n,0,-15,n,p(r,e));this.allLabels.push(i);let s=t.BREADBOARD_MID_ROWS-1,o=F(w(s),n,0,15,n,p(s,e));this.allLabels.push(o)}for(let e=0;e<t.BREADBOARD_MID_ROWS;e++){let n=w(e),r=F(n,A(0),-15,0,n);this.allLabels.push(r);let i=F(n,A(t.BREADBOARD_MID_COLS-1),15,0,n);this.allLabels.push(i)}let $=[R(13.05,f+h+x,30,C,"-",I(0,0),["sim-bb-blue"]),R(12,f+h+f-x,E,C,"+",I(1,0),["sim-bb-red"]),R(u-x+S,f+h+x,30,C,"-",I(0,24),["sim-bb-blue"]),R(u-x,f+h+f-x,E,C,"+",I(1,24),["sim-bb-red"])];this.allLabels=this.allLabels.concat($);let B=[R(13.05,12,30,C,"-",I(0,a),["sim-bb-blue"]),R(12,f-x,E,C,"+",I(1,a),["sim-bb-red"]),R(u-x+S,12,30,C,"-",I(0,49),["sim-bb-blue"]),R(u-x,f-x,E,C,"+",I(1,49),["sim-bb-red"])];this.allLabels=this.allLabels.concat(B);let U={};this.allLabels.forEach((e=>{let{el:t,txt:n}=e;(U[n]=U[n]||[]).push(e)}));this.allPins.forEach((e=>{let{row:t,col:n,group:r}=e,i=this.rowColToLbls[t]||(this.rowColToLbls[t]={}),s=i[n]||(i[n]=[]);if((e=>"-"===e.row||"+"===e.row)(e)){Number(n)<=a?$.filter((t=>t.group==e.group)).forEach((e=>s.push(e))):B.filter((t=>t.group==e.group)).forEach((e=>s.push(e)))}else{U[t].forEach((e=>s.push(e))),U[n].forEach((e=>s.push(e)))}}));const V=y+22.5,H=(V-y)/2,G=(t,n,r,i)=>{let s=e.svg.elt("rect");return e.svg.hydrate(s,{class:`sim-bb-bar ${i}`,x:t,y:n-1.5,width:V,height:3}),{el:s,group:r}};let j=[G(T-H,k-9,I(0,49),"sim-bb-blue"),G(T-H,k+n+9,I(1,49),"sim-bb-red"),G(b-H,v-9,I(0,0),"sim-bb-blue"),G(b-H,v+n+9,I(1,0),"sim-bb-red")];this.allPowerBars=this.allPowerBars.concat(j),this.allPowerBars.forEach((e=>this.bb.appendChild(e.el)));let K=this.allPins.map((e=>e.group)).filter(((e,t,n)=>n.indexOf(e)==t)),W=K.map((t=>e.svg.elt("g")));W.forEach((t=>e.U.addClass(t,"sim-bb-pin-group"))),W.forEach(((t,n)=>e.U.addClass(t,`group-${K[n]}`)));let z={};K.forEach(((e,t)=>z[e]=W[t]));let q={};this.allPins.forEach(((e,t)=>{let n=e.group;(q[n]||(q[n]=[])).push(e)})),K.forEach((t=>{let n=q[t],[r,i]=[n.map((e=>e.cx)),n.map((e=>e.cy))],s=e=>e.reduce(((e,t)=>e<t?e:t)),o=e=>e.reduce(((e,t)=>e>t?e:t)),[a,l,c,u]=[s(r),o(r),s(i),o(i)],d=e.svg.elt("rect"),p=Math.max(l-a,1e-4),h=Math.max(u-c,1e-4);e.svg.hydrate(d,{x:a,y:c,width:p,height:h}),e.U.addClass(d,"sim-bb-group-wire"),z[t].appendChild(d)})),this.allPins.forEach((e=>{let t=z[e.group];t.appendChild(e.el),t.appendChild(e.hoverEl)}));let J=e.svg.elt("g");e.svg.hydrate(J,{class:"sim-bb-group-misc"}),W.push(J),this.allLabels.forEach((e=>{if(e.group){let t=z[e.group];t.appendChild(e.el),t.appendChild(e.hoverEl)}else J.appendChild(e.el),J.appendChild(e.hoverEl)})),W.forEach((e=>this.bb.appendChild(e)))}getSVGAndSize(){return{el:this.bb,y:0,x:0,w:u,h:d}}highlightLoc(t){let{row:n,col:r}=t,i=this.rowColToPin[n][r],{cx:s,cy:o}=i;this.rowColToLbls[n][r].forEach((t=>{e.U.addClass(t.el,"highlight"),e.U.addClass(t.hoverEl,"highlight")}))}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){t.BOARD_SYTLE=`\n        .noselect {\n            -webkit-touch-callout: none; /* iOS Safari */\n            -webkit-user-select: none;   /* Chrome/Safari/Opera */\n            -khtml-user-select: none;    /* Konqueror */\n            -moz-user-select: none;      /* Firefox */\n            -ms-user-select: none;       /* Internet Explorer/Microsoft Edge */\n            user-select: none;           /* Non-prefixed version, currently\n                                            not supported by any browser */\n        }\n\n        .sim-board-pin {\n            fill:#999;\n            stroke:#000;\n            stroke-width:${t.PIN_DIST/3}px;\n        }\n        .sim-board-pin-lbl {\n            fill: #333;\n        }\n        .gray-cover {\n            fill:#FFF;\n            opacity: 0.3;\n            stroke-width:0;\n            visibility: hidden;\n        }\n        .sim-board-pin-hover {\n            visibility: hidden;\n            pointer-events: all;\n            stroke-width:${t.PIN_DIST/6}px;\n        }\n        .sim-board-pin-hover:hover {\n            visibility: visible;\n        }\n        .sim-board-pin-lbl {\n            visibility: hidden;\n        }\n        .sim-board-outline .sim-board-pin-lbl {\n            visibility: visible;\n        }\n        .sim-board-pin-lbl {\n            fill: #555;\n        }\n        .sim-board-pin-lbl-hover {\n            fill: red;\n        }\n        .sim-board-outline .sim-board-pin-lbl-hover {\n            fill: black;\n        }\n        .sim-board-pin-lbl,\n        .sim-board-pin-lbl-hover {\n            font-family:"Lucida Console", Monaco, monospace;\n            pointer-events: all;\n            stroke-width: 0;\n        }\n        .sim-board-pin-lbl-hover {\n            visibility: hidden;\n        }\n        .sim-board-outline .sim-board-pin-hover:hover + .sim-board-pin-lbl,\n        .sim-board-pin-lbl.highlight {\n            visibility: hidden;\n        }\n        .sim-board-outline .sim-board-pin-hover:hover + * + .sim-board-pin-lbl-hover,\n        .sim-board-pin-lbl-hover.highlight {\n            visibility: visible;\n        }\n        /* Graying out */\n        .grayed .sim-board-pin-lbl:not(.highlight) {\n            fill: #AAA;\n        }\n        .grayed .sim-board-pin:not(.highlight) {\n            fill:#BBB;\n            stroke:#777;\n        }\n        .grayed .gray-cover {\n            visibility: inherit;\n        }\n        .grayed .sim-cmp:not(.notgrayed) {\n            opacity: 0.3;\n        }\n        /* Highlighting */\n        .sim-board-pin-lbl.highlight {\n            fill: #000;\n            font-weight: bold;\n        }\n        .sim-board-pin.highlight {\n            fill:#999;\n            stroke:#000;\n        }\n        `;const n=.7*t.PIN_DIST,r=1.5*n,i=.66666*t.PIN_DIST,s=.66666*t.PIN_DIST+t.PIN_DIST/3;let o=0;t.GenericBoardSvg=class{constructor(a){this.props=a,this.allPins=[],this.allLabels=[],this.pinNmToLbl={},this.pinNmToPin={},this.id=o++;let l=a.visualDef,c=a.wireframe&&l.outlineImage?l.outlineImage:l.image,u=t.mkImageSVG({image:c,width:l.width,height:l.height,imageUnitDist:l.pinDist,targetUnitDist:t.PIN_DIST}),d=t.mkScaleFn(l.pinDist,t.PIN_DIST);this.width=u.w,this.height=u.h;let p=u.el;this.element=e.svg.elt("svg"),e.svg.hydrate(this.element,{version:"1.0",viewBox:`0 0 ${this.width} ${this.height}`,class:`sim sim-board-id-${this.id}`,x:"0px",y:"0px"}),a.wireframe&&e.U.addClass(this.element,"sim-board-outline"),this.style=e.svg.child(this.element,"style",{}),this.style.textContent+=t.BOARD_SYTLE,this.defs=e.svg.child(this.element,"defs",{}),this.g=e.svg.elt("g"),this.element.appendChild(this.g),this.g.appendChild(p),this.background=p,e.svg.hydrate(p,{class:"sim-board"});const h=()=>{let t=e.svg.elt("circle"),n=i;return e.svg.hydrate(t,{class:"sim-board-pin",r:n/2}),{el:t,w:n,h:n,x:0,y:0}},f=()=>{let t=e.svg.elt("circle"),n=s;return e.svg.hydrate(t,{class:"sim-board-pin-hover",r:n/2}),{el:t,w:n,h:n,x:0,y:0}},m=()=>{let t=e.svg.elt("rect"),n=i;return e.svg.hydrate(t,{class:"sim-board-pin",width:n,height:n}),{el:t,w:n,h:n,x:0,y:0}},_=()=>{let t=e.svg.elt("rect"),n=s;return e.svg.hydrate(t,{class:"sim-board-pin-hover",width:n,height:n}),{el:t,w:n,h:n,x:0,y:0}};let g=l.pinBlocks.map(((n,r)=>{let i=d(n.x)+t.PIN_DIST/2,s=d(n.y)+t.PIN_DIST/2,o=n.labels.length,a=t.mkGrid({xOffset:i,yOffset:s,rowCount:1,colCount:o,pinDist:t.PIN_DIST,mkPin:l.useCrocClips?h:m,mkHoverPin:l.useCrocClips?f:_,getRowName:()=>`${r+1}`,getColName:e=>n.labels[e],getGroupName:()=>n.labels.join(" ")});a.allPins,a.g;return e.U.addClass(a.g,"sim-board-pin-group"),a})),y=[];g.forEach(((e,t)=>e.allPins.forEach(((e,n)=>{this.allPins.push(e),y.push(l.pinBlocks[t])})))),this.allPins.forEach((t=>{let n=t.col;e.svg.hydrate(t.el,{title:n}),e.svg.hydrate(t.hoverEl,{title:n})})),this.allPins.forEach((e=>{this.pinNmToPin[e.col]=e}));const b=(e,n,r,i,s)=>{let o,a;if("below"===s){a=e,o=n+12+.25*r*i.length}else{a=e,o=n-11-.32*r*i.length}return t.mkTxt(a,o,r,-90,i)};this.allLabels=this.allPins.map(((t,i)=>{let s=y[i];return((t,i,s,o)=>{let a=b(t,i,n,s,o);e.U.addClass(a,"sim-board-pin-lbl");let l=b(t,i,r,s,o);return e.U.addClass(l,"sim-board-pin-lbl-hover"),{el:a,hoverEl:l,txt:s}})(t.cx,t.cy,t.col,s.labelPosition||"above")})),this.allPins.forEach(((e,t)=>{let n=this.allLabels[t];this.pinNmToLbl[e.col]=n})),this.allPins.forEach(((e,t)=>{let n=this.allLabels[t];this.g.appendChild(e.el),this.g.appendChild(e.hoverEl),this.g.appendChild(n.el),this.g.appendChild(n.hoverEl)}))}findPin(e){let t=this.pinNmToPin[e];return!t&&this.props.boardDef.gpioPinMap&&(e=this.props.boardDef.gpioPinMap[e])&&(t=this.pinNmToPin[e]),t}findPinLabel(e){let t=this.pinNmToLbl[e];return!t&&this.props.boardDef.gpioPinMap&&(e=this.props.boardDef.gpioPinMap[e])&&(t=this.pinNmToLbl[e]),t}getCoord(e){let t=this.findPin(e);return t?[t.cx,t.cy]:null}mkGrayCover(t,n,r,i){let s=e.svg.elt("rect");return e.svg.hydrate(s,{x:t,y:n,width:r,height:i,class:"gray-cover"}),s}getView(){return{el:this.element,w:this.width,h:this.height,x:0,y:0}}getPinDist(){return t.PIN_DIST}highlightPin(t){let n=this.findPinLabel(t),r=this.findPin(t);n&&r&&(e.U.addClass(n.el,"highlight"),e.U.addClass(n.hoverEl,"highlight"),e.U.addClass(r.el,"highlight"),e.U.addClass(r.hoverEl,"highlight"))}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){function n(e){return t.mkImageSVG({image:e.image,width:e.width,height:e.height,imageUnitDist:e.pinDistance,targetUnitDist:t.PIN_DIST})}t.mkGenericPartSVG=n;t.GenericPart=class{constructor(t){this.style="",this.defs=[];let r=n(t).el;this.element=e.svg.elt("g"),this.element.appendChild(r)}moveToCoord(e){t.translateEl(this.element,e)}init(e,t,n){}updateState(){}updateTheme(){}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function(e){!function(t){const n=t.PIN_DIST/2.5,r=.7;function i(e){return e.replace(/\#/g,"-").replace(/\(/g,"-").replace(/\)/g,"-").replace(/\,/g,"-").replace(/\./g,"-").replace(/\s/g,"")}let s;function o(t,n,r,i){const s=e=>`${e[0]}, ${e[1]}`;let[o,a]=t,[l,c]=n,u=c-a,d=[o,a+u*r],p=[l,c-u*r],h=e.svg.mkPath("sim-bb-wire",`M${s(t)} C${s(d)} ${s(p)} ${s(n)}`);return e.U.addClass(h,`wire-stroke-${i}`),h}function a(t,n,r){const i=e=>`${e[0]}, ${e[1]}`;let s=e.svg.mkPath("sim-bb-wire",`M${i(t)} L${i(n)}`);return e.U.addClass(s,`wire-stroke-${r}`),s}function l(r,i){const s=t.PIN_DIST/4;let o=e.svg.elt("circle"),a=r[0],l=r[1],c=n/2+s/2;return e.svg.hydrate(o,{cx:a,cy:l,r:c,class:"sim-bb-wire-end"}),e.U.addClass(o,`wire-fill-${i}`),o.style["stroke-width"]=`${s}px`,o}function c(n,r,i){let s=.24*t.PIN_DIST,o=10*s,a=2*s,l=6*s,c=s;const u=t.PIN_DIST/4;let[d,p]=n,h=r?-1:1,f=e.svg.elt("g"),m=e.svg.elt("rect"),_=o,g=a,y=d-g/2,b=p-_/2;e.svg.hydrate(m,{x:y,y:b,width:g,height:_,rx:.5,ry:.5,class:"sim-bb-wire-end"}),m.style["stroke-width"]=`${u}px`;let v=e.svg.elt("rect"),T=l,k=c,E=d-k/2,x=p+h*(_/2+T/2)-T/2;return e.svg.hydrate(v,{x:E,y:x,width:k,height:T,class:"sim-bb-wire-bare-end"}),v.style.fill="#bbb",f.appendChild(v),f.appendChild(m),{el:f,x:y-u,y:Math.min(b,x),w:g+2*u,h:_+T}}function u(n,r,i){let s=.24*t.PIN_DIST;const o=4*s,a=10*s,l=3.5*s,c=3.5*s,u=t.PIN_DIST/4;let[d,p]=n,h=r?-1:1,f=e.svg.elt("g"),m=e.svg.elt("polygon"),_=a,g=o,y=d-g/2,b=p-_/2;const v=r?.15:.3,T=r?.7:1-.7,k=r?.3:.15;e.svg.hydrate(m,{points:((...e)=>e.map((e=>(e=>`${e[0]},${e[1]}`)(e))).join(" "))([y+g*v,b],[y+g*(1-v),b],[y+g,b+_*T],[y+g*(1-k),b+_],[y+g*k,b+_],[y,b+_*T])}),e.svg.hydrate(m,{rx:.5,ry:.5,class:"sim-bb-wire-end"}),m.style["stroke-width"]=`${u}px`;let E=e.svg.elt("rect"),x=l,S=c,C=d-S/2,I=p+h*(_/2+x/2)-x/2;return e.svg.hydrate(E,{x:C,y:I,width:S,height:x,class:"sim-bb-wire-bare-end"}),f.appendChild(E),f.appendChild(m),{el:f,x:y-u,y:Math.min(b,I),w:g+2*u,h:_+x}}t.WIRES_CSS=`\n        .sim-bb-wire {\n            fill:none;\n            stroke-linecap: round;\n            stroke-width:${n}px;\n            pointer-events: none;\n        }\n        .sim-bb-wire-end {\n            stroke:#333;\n            fill:#333;\n        }\n        .sim-bb-wire-bare-end {\n            fill: #ccc;\n        }\n        .sim-bb-wire-hover {\n            stroke-width: ${n}px;\n            visibility: hidden;\n            stroke-dasharray: ${t.PIN_DIST/10},${t.PIN_DIST/1.5};\n            /*stroke-opacity: 0.4;*/\n        }\n        .grayed .sim-bb-wire-ends-g:not(.highlight) .sim-bb-wire-end {\n            stroke: #777;\n            fill: #777;\n        }\n        .grayed .sim-bb-wire:not(.highlight) {\n            stroke: #CCC;\n        }\n        .sim-bb-wire-ends-g:hover .sim-bb-wire-end {\n            stroke: red;\n            fill: red;\n        }\n        .sim-bb-wire-ends-g:hover .sim-bb-wire-bare-end {\n            stroke: #FFF;\n            fill: #FFF;\n        }\n        `,function(e){e[e.BBJumper=0]="BBJumper",e[e.OpenJumper=1]="OpenJumper",e[e.Croc=2]="Croc"}(s=t.WireEndStyle||(t.WireEndStyle={})),t.mkWirePart=function(n,r,i=!1){let s,o=e.svg.elt("g"),[a,l]=n,d=[a-15,l-50],p=[a+15,l+50];r=t.mapWireColor(r),s=i?u(d,!0,r):c(d,!0,r);let h=function(t,n,r){const i=e=>`${e[0]}, ${e[1]}`;let[s,o]=t,[a,l]=n,c=l-o,u=[s,o+.8*c],d=[a,l-.8*c],p=e.svg.mkPath("sim-bb-wire",`M${i(t)} C${i(u)} ${i(d)} ${i(n)}`);return p.style.stroke=r,{el:p,x:Math.min(s,a),y:Math.min(o,l),w:Math.abs(s-a),h:Math.abs(o-l)}}(d,p,r),f=c(p,!1,r);o.appendChild(h.el),o.appendChild(s.el),o.appendChild(f.el);let m=Math.min(s.x,f.x),_=Math.max(s.x+s.w,f.x+f.w),g=Math.min(s.y,f.y);return{el:o,x:m,y:g,w:_-m,h:Math.max(s.y+s.h,f.y+f.h)-g}};t.WireFactory=class{constructor(e,n,r,i,s,o){this.nextWireId=0,this.styleEl=i,this.styleEl.textContent+=t.WIRES_CSS,this.underboard=e,this.overboard=n,this.boardEdges=r,this.getLocCoord=s,this.getPinStyle=o}indexOfMin(e){let t=0,n=e[0];for(let r=1;r<e.length;r++)e[r]<n&&(n=e[r],t=r);return t}closestEdgeIdx(e){let t=this.boardEdges.map((t=>Math.abs(e[1]-t)));return this.indexOfMin(t)}closestEdge(e){return this.boardEdges[this.closestEdgeIdx(e)]}drawWire(n,s,c){let u=[],d=e.svg.child(this.overboard,"g",{class:"sim-bb-wire-group"});const p=e=>{const n=t.PIN_DIST/2;let r,i=this.closestEdge(e);return r=i-e[1]<0?i-n:i+n,[e[0],r]};let h=this.nextWireId++,f=i(c),m=l(n,f),_=l(s,f),g=e.svg.child(d,"g",{class:"sim-bb-wire-ends-g"});g.appendChild(m),g.appendChild(_);let y=this.closestEdgeIdx(n),b=this.closestEdgeIdx(s);if(y==b){let e=a(n,s,f);d.appendChild(e),u.push(e)}else{let t,i,l=p(n),c=p(s),m=a(n,l,f),_=a(s,c,f);!(1!=y&&2!=y||1!=b&&2!=b)?(t=o(l,c,r,f),i=o(l,c,r,f)):(t=a(l,c,f),i=a(l,c,f)),e.U.addClass(i,"sim-bb-wire-hover"),d.appendChild(m),u.push(m),d.appendChild(_),u.push(_),this.underboard.appendChild(t),u.push(t),d.appendChild(i),u.push(i);let v=`sim-bb-wire-id-${h}`;const T=t=>e.U.addClass(t,v);T(g),T(i),this.styleEl.textContent+=`\n                    .${v}:hover ~ .${v}.sim-bb-wire-hover {\n                        visibility: visible;\n                    }`}let v=`\n                .wire-stroke-${f} {\n                    stroke: ${t.mapWireColor(c)};\n                }\n                .wire-fill-${f} {\n                    fill: ${t.mapWireColor(c)};\n                }\n                `;return this.styleEl.textContent+=v,{endG:g,end1:m,end2:_,wires:u}}drawWireWithCrocs(n,s,c,d=!1){let p=[],h=e.svg.child(this.overboard,"g",{class:"sim-bb-wire-group"});const f=e=>{const n=t.PIN_DIST/2;let r,i=this.closestEdge(e);return r=i-e[1]<0?i-n:i+n,[e[0],r]};let m=this.nextWireId++,_=i(c),g=l(n,_),y=s,[b,v]=s;s=[b,v+40],[b,v]=s;let T,k=[b,v+-17];T=d?function(n,r,i){let s=.24*t.PIN_DIST,o=4*s,a=1.2*s,l=10*s,c=s;const u=t.PIN_DIST/4;let[d,p]=n,h=r?-1:1,f=e.svg.elt("g"),m=e.svg.elt("rect"),_=o,g=a,y=d-g/2,b=p+10-_/2;e.svg.hydrate(m,{x:y,y:b,width:g,height:_,rx:.5,ry:.5,class:"sim-bb-wire-end"}),m.style["stroke-width"]=`${u}px`;let v=e.svg.elt("rect"),T=l,k=c,E=d-k/2,x=p+10+h*(_/2+T/2)-T/2;return e.svg.hydrate(v,{x:E,y:x,width:k,height:T,class:"sim-bb-wire-bare-end"}),v.style.fill="#bbb",f.appendChild(v),f.appendChild(m),{el:f,x:y-u,y:Math.min(b,x),w:g+2*u,h:_+T}}(k,!0):u(k,!0);let E=T.el,x=e.svg.child(h,"g",{class:"sim-bb-wire-ends-g"});x.appendChild(g);let S=this.closestEdgeIdx(n),C=this.closestEdgeIdx(y);if(S==C){let e=a(n,s,_);h.appendChild(e),p.push(e)}else{let t,i,l=f(n),c=a(n,l,_);!(1!=S&&2!=S||1!=C&&2!=C)?(t=o(l,s,r,_),i=o(l,s,r,_)):(t=a(l,s,_),i=a(l,s,_)),e.U.addClass(i,"sim-bb-wire-hover"),h.appendChild(c),p.push(c),this.underboard.appendChild(t),p.push(t);let u=`sim-bb-wire-id-${m}`;const d=t=>e.U.addClass(t,u);d(x),d(i),this.styleEl.textContent+=`\n                    .${u}:hover ~ .${u}.sim-bb-wire-hover {\n                        visibility: visible;\n                    }`}x.appendChild(E);let I=`\n                .wire-stroke-${_} {\n                    stroke: ${t.mapWireColor(c)};\n                }\n                .wire-fill-${_} {\n                    fill: ${t.mapWireColor(c)};\n                }\n                `;return this.styleEl.textContent+=I,{endG:x,end1:g,end2:E,wires:p}}checkWire(e,t){let n=this.getLocCoord(e),r=this.getLocCoord(t);return!!n&&!!r}addWire(e,t,n){let r=this.getLocCoord(e),i=this.getLocCoord(t);if(!r||!i)return void console.debug(`unable to allocate wire for ${e} or ${t}`);let s,o=this.getPinStyle(t);return s="dalboard"==t.type&&"croc"==o?this.drawWireWithCrocs(r,i,n):this.drawWire(r,i,n),s}}}(e.visuals||(e.visuals={}))}(pxsim||(pxsim={})),function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};t[o][0].call(u.exports,(function(e){return i(t[o][1][e]||e)}),u,u.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BlockDragger=void 0;const r=e("./plugins/duplicateOnDrag");class i extends r.DuplicateOnDragBlockDragger{drag(e,t){const n=document.getElementsByClassName("blocklyToolboxDiv")[0],r=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],i=document.getElementById("blocklyTrashIcon");if(r&&i){const t=function(e,t){return Math.abs(t-(e.left+e.width/2))}(r.getBoundingClientRect(),e.clientX);if(t<200){const e=t/200;i.style.opacity=""+(1-e),i.style.display="block",n&&(r.style.opacity=`${e}`,t<50&&pxt.BrowserUtils.addClass(n,"blocklyToolboxDeleting"))}else i.style.display="none",r.style.opacity="1",n&&pxt.BrowserUtils.removeClass(n,"blocklyToolboxDeleting")}return super.drag(e,t)}endDrag(e,t){super.endDrag(e,t);const n=document.getElementsByClassName("blocklyToolboxDiv")[0],r=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],i=document.getElementById("blocklyTrashIcon");i&&r&&(i.style.display="none",r.style.opacity="1",n&&pxt.BrowserUtils.removeClass(n,"blocklyToolboxDeleting"))}}n.BlockDragger=i},{"./plugins/duplicateOnDrag":78}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BreakpointIcon=void 0;const r=e("blockly");class i extends r.icons.Icon{constructor(e,t){super(e),this.onStateChange=t,this.isSet_=!1}getType(){return i.type}initView(e){super.initView(e),this.breakpointSvg||(this.breakpointSvg=r.utils.dom.createSvgElement("circle",{class:"blocklyBreakpointSymbol",stroke:"white","stroke-width":2,cx:7,cy:11.5,r:8},this.svgRoot),this.updateColor())}getSize(){return new r.utils.Size(25,25)}onClick(){this.isSet_=!this.isSet_,this.updateColor(),this.onStateChange(this.sourceBlock,this.isSet_)}isEnabled(){return this.isSet_}setEnabled(e){this.isSet_=e,this.updateColor()}updateColor(){this.breakpointSvg&&this.breakpointSvg.setAttribute("fill",this.isSet_?"#FF0000":"#CCCCCC")}}n.BreakpointIcon=i,i.type=new r.icons.IconType("breakpoint")},{blockly:154}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initFunctions=void 0;const r=e("blockly"),i=e("../help"),s=e("../plugins/functions"),o=e("../toolbox"),a=e("../fields"),l=e("../loader"),c=e("../importer"),u=e("../plugins/duplicateOnDrag");n.initFunctions=function(){const e=r.Msg;e.FUNCTION_CREATE_NEW=lf("Make a Function..."),e.FUNCTION_WARNING_DUPLICATE_ARG=lf("Functions cannot use the same argument name more than once."),e.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME=lf("Argument names must not be the same as the function name."),e.FUNCTION_WARNING_EMPTY_NAME=lf("Function and argument names cannot be empty."),e.FUNCTIONS_DEFAULT_FUNCTION_NAME=lf("doSomething"),e.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME=lf("bool"),e.FUNCTIONS_DEFAULT_STRING_ARG_NAME=lf("text"),e.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME=lf("num"),e.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME=lf("arg"),e.PROCEDURES_HUE=pxt.toolbox.getNamespaceColor("functions"),e.REPORTERS_HUE=pxt.toolbox.getNamespaceColor("variables");const t=pxt.blocks.getBlockDefinition("procedures_defnoreturn");e.PROCEDURES_DEFNORETURN_TITLE=t.block.PROCEDURES_DEFNORETURN_TITLE,e.PROCEDURE_ALREADY_EXISTS=t.block.PROCEDURE_ALREADY_EXISTS,r.Blocks.procedures_defnoreturn.init=function(){let e=new r.FieldTextInput("",r.Procedures.rename);this.appendDummyInput().appendField(r.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.argumentVarModels_=[],this.hat="cap",this.setStatements_(!0),this.statementConnection_=null},(0,i.installBuiltinHelpInfo)("procedures_defnoreturn");const n=pxt.blocks.getBlockDefinition("procedures_callnoreturn");e.PROCEDURES_CALLRETURN_TOOLTIP=t.tooltip.toString(),r.Blocks.procedures_callnoreturn={init:function(){let e=new a.FieldProcedure("");this.appendDummyInput("TOPROW").appendField(n.block.PROCEDURES_CALLNORETURN_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){r.Names.equals(e,this.getProcedureCall())&&this.setFieldValue(t,"NAME")},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&!this.isInsertionMarker())if(e.type==r.Events.CREATE&&-1!=e.ids.indexOf(this.id)){let t=this.getProcedureCall(),n=r.Procedures.getDefinition(t,this.workspace);if(!n||n.type==this.defType_&&JSON.stringify(n.arguments_)==JSON.stringify(this.arguments_)||(n=null),!n){r.Events.setGroup(e.group);let t=r.utils.xml.createElement("xml"),n=r.utils.xml.createElement("block");n.setAttribute("type",this.defType_);let i=this.getRelativeToSurfaceXY(),s=i.x+r.SNAP_RADIUS*(this.RTL?-1:1),o=i.y+2*r.SNAP_RADIUS;n.setAttribute("x",s),n.setAttribute("y",o);let a=r.utils.xml.createElement("field");a.setAttribute("name","NAME"),a.appendChild(document.createTextNode(this.getProcedureCall())),n.appendChild(a),t.appendChild(n),(0,c.domToWorkspaceNoEvents)(t,this.workspace),r.Events.setGroup(!1)}}else if(e.type==r.Events.DELETE){let t=this.getProcedureCall();r.Procedures.getDefinition(t,this.workspace)||(r.Events.setGroup(e.group),this.dispose(!0,!1),r.Events.setGroup(!1))}},mutationToDom:function(){const e=document.createElement("mutation");return e.setAttribute("name",this.getProcedureCall()),e},domToMutation:function(e){const t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t)},customContextMenu:function(e){let t={enabled:!0};t.text=r.Msg.PROCEDURES_HIGHLIGHT_DEF;let n=this.getProcedureCall(),i=this.workspace;t.callback=function(){let e=r.Procedures.getDefinition(n,i);e&&e.select()},e.push(t)},defType_:"procedures_defnoreturn"},(0,i.installBuiltinHelpInfo)("procedures_callnoreturn");const d=pxt.blocks.getBlockDefinition("function_definition");e.FUNCTIONS_EDIT_OPTION=d.block.FUNCTIONS_EDIT_OPTION,(0,i.installBuiltinHelpInfo)("function_definition");const p=pxt.blocks.getBlockDefinition("function_call");e.FUNCTIONS_CALL_TITLE=p.block.FUNCTIONS_CALL_TITLE,e.FUNCTIONS_GO_TO_DEFINITION_OPTION=p.block.FUNCTIONS_GO_TO_DEFINITION_OPTION,(0,i.installBuiltinHelpInfo)("function_call"),(0,i.installBuiltinHelpInfo)("function_call_output"),r.Blocks.function_return={init:function(){!function(e){const t=pxt.blocks.getBlockDefinition("function_return"),n="0_add_button",i="0_rem_button";r.Extensions.apply("inline-svgs",e,!1);let s,o=!0;function a(){const r=e.getInput("RETURN_VALUE");if(o){if(!r){for(;e.getInput("");)e.removeInput("");e.jsonInit({message0:t.block.message_with_value,args0:[{type:"input_value",name:"RETURN_VALUE",check:null}],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})}if(e.getInput(n)&&e.removeInput(n),e.getInput(i)||u(i,e.REMOVE_IMAGE_DATAURI,lf("Remove return value")),s){const t=e.workspace.getBlockById(s);t&&t.outputConnection&&!t.outputConnection.targetBlock()&&e.getInput("RETURN_VALUE").connection.connect(t.outputConnection),s=void 0}}else{if(r){const n=r.connection.targetBlock();n&&(n.isShadow()&&n.setShadow(!1),r.connection.disconnect(),s=n.id),e.removeInput("RETURN_VALUE"),e.jsonInit({message0:t.block.message_no_value,args0:[],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})}e.getInput(i)&&e.removeInput(i),e.getInput(n)||u(n,e.ADD_IMAGE_DATAURI,lf("Add return value"))}e.setInputsInline(!0)}function l(){return r.Xml.domToText(e.mutationToDom())}function c(t,n){t!==n&&r.Events.fire(new r.Events.BlockChange(e,"mutation",null,t,n))}function u(t,n,i){e.appendDummyInput(t).appendField(new r.FieldImage(n,24,24,i,(()=>{const e=l();o=!o;const t=l();c(e,t),a(),c(t,l())}),!1))}a(),e.domToMutation=e=>{e.hasAttribute("last_connected_id")&&(s=e.getAttribute("last_connected_id")),o=function(e){return"true"!==e.getAttribute("no_return_value")}(e),a()},e.mutationToDom=()=>{const t=document.createElement("mutation");return function(e,t){e.setAttribute("no_return_value",t?"false":"true")}(t,!!e.getInput("RETURN_VALUE")),s&&t.setAttribute("last_connected_id",s),t}}(this)},onchange:function(e){const t=this;if(!t.workspace||t.workspace.isFlyout)return;const n=e.type===r.Events.BLOCK_CREATE&&-1!=e.ids.indexOf(t.id),i=e.type===r.Events.BLOCK_DRAG&&e.blocks.some((e=>e.id===t.id));if(n||i){const n=t.getRootBlock();if("function_return"===n.type||null!=n.previousConnection)return;"function_definition"!==n.type&&(r.Events.setGroup(e.group),t.previousConnection.disconnect(),r.Events.setGroup(!1))}}},(0,i.installBuiltinHelpInfo)("function_return"),r.Procedures.flyoutCategory=function(e){let t=[];if(!pxt.appTarget.appTheme.hideFlyoutHeadings){let e=(0,o.createFlyoutHeadingLabel)(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions");t.push(e)}const n=lf("Make a Function..."),i=lf("New function name:");let s=r.utils.xml.createElement("button");return s.setAttribute("text",n),s.setAttribute("callbackKey","CREATE_FUNCTION"),e.registerButtonCallback("CREATE_FUNCTION",(function(t){let s=t=>{r.dialog.prompt(i,t,(function(t){pxt.tickEvent("blocks.makeafunction"),t&&(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))==n&&(t=null),t&&(e.getVariable(t)?r.dialog.alert(r.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",t.toLowerCase()),(function(){s(t)})):r.Procedures.isNameUsed(t,e)?(t=>{let n=e.getTopBlocks(!0)[0],i=10,s=10;if(n){let e=n.getRelativeToSurfaceXY();i=e.x+r.SNAP_RADIUS*(n.RTL?-1:1),s=e.y+2*r.SNAP_RADIUS}let o=r.utils.xml.createElement("xml"),a=r.utils.xml.createElement("block");a.setAttribute("type","procedures_defnoreturn"),a.setAttribute("x",String(i)),a.setAttribute("y",String(s));let l=r.utils.xml.createElement("field");l.setAttribute("name","NAME"),l.appendChild(document.createTextNode(t)),a.appendChild(l),o.appendChild(a);let u=(0,c.domToWorkspaceNoEvents)(o,e);r.hideChaff();let d=e.getBlockById(u[0]);d.select(),e.centerOnBlock(d.id)})(t):r.dialog.alert(r.Msg.PROCEDURE_ALREADY_EXISTS.replace("%1",t.toLowerCase()),(function(){s(t)})))}))};s("doSomething")})),t.push(s),function(e,n){for(let n=0;n<e.length;n++){let i=e[n][0],s=(e[n][1],r.utils.xml.createElement("block"));s.setAttribute("type","procedures_callnoreturn"),s.setAttribute("gap","16"),s.setAttribute("colour",pxt.toolbox.getNamespaceColor("functions"));let o=r.utils.xml.createElement("field");o.textContent=i,o.setAttribute("name","NAME"),s.appendChild(o),t.push(s)}}(r.Procedures.allProcedures(e)[0]),t};const h={number:pxt.blocks.defaultIconForArgType("number"),boolean:pxt.blocks.defaultIconForArgType("boolean"),string:pxt.blocks.defaultIconForArgType("string"),Array:pxt.blocks.defaultIconForArgType("Array")},f={},m=pxt.appTarget.runtime&&pxt.appTarget.runtime.functionsOptions;m&&m.extraFunctionEditorTypes&&m.extraFunctionEditorTypes.forEach((e=>{h[e.typeName]=e.icon||pxt.blocks.defaultIconForArgType(),e.defaultName&&(f[e.typeName]=e.defaultName)}));for(const e of Object.keys(h))s.FunctionManager.getInstance().setIconForType(e,h[e]);for(const e of Object.keys(f))s.FunctionManager.getInstance().setArgumentNameForType(e,f[e]);r.Blocks.argument_reporter_custom&&(r.Blocks.argument_reporter_custom.domToMutation=function(e){const t=e.getAttribute("typename");this.typeName_=t,e.hasAttribute(u.DUPLICATE_ON_DRAG_MUTATION_KEY)&&(this.duplicateOnDrag_="true"===e.getAttribute(u.DUPLICATE_ON_DRAG_MUTATION_KEY).toLowerCase()),this.pathObject&&this.pathObject.setHasDottedOutllineOnHover(this.duplicateOnDrag_),(0,l.setOutputCheck)(this,t,l.cachedBlockInfo)});const _=r.Blocks.function_definition.makeCallOption;r.Blocks.function_definition.makeCallOption=function(){const e=_.call(this),t=this.getName();return e.text=pxt.Util.lf("Create 'call {0}'",t),e}}},{"../fields":65,"../help":66,"../importer":67,"../loader":71,"../plugins/duplicateOnDrag":78,"../plugins/functions":93,"../toolbox":120,blockly:154}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initLists=void 0;const r=e("blockly"),i=e("../help"),s=e("../constants");n.initLists=function(){const e=r.Msg,t=pxt.blocks.getBlockDefinition("lists_create_with");e.LISTS_CREATE_EMPTY_TITLE=t.block.LISTS_CREATE_EMPTY_TITLE,e.LISTS_CREATE_WITH_INPUT_WITH=t.block.LISTS_CREATE_WITH_INPUT_WITH,e.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD=t.block.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD,e.LISTS_CREATE_WITH_ITEM_TITLE=t.block.LISTS_CREATE_WITH_ITEM_TITLE,(0,i.installBuiltinHelpInfo)("lists_create_with");const n=pxt.blocks.getBlockDefinition("lists_length");e.LISTS_LENGTH_TITLE=n.block.LISTS_LENGTH_TITLE,r.Blocks.lists_length.init=function(){this.jsonInit({message0:e.LISTS_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["Array"]}],output:"Number",outputShape:s.provider.SHAPES.ROUND})},(0,i.installBuiltinHelpInfo)("lists_length");const o=pxt.blocks.getBlockDefinition("lists_index_get");r.Blocks.lists_index_get={init:function(){this.jsonInit({message0:o.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"}],colour:pxt.toolbox.blockColors.arrays,outputShape:s.provider.SHAPES.ROUND,inputsInline:!0}),this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0),(0,i.setBuiltinHelpInfo)(this,"lists_index_get")}};const a=pxt.blocks.getBlockDefinition("lists_index_set");r.Blocks.lists_index_set={init:function(){this.jsonInit({message0:a.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"},{type:"input_value",name:"VALUE",check:null}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.arrays,inputsInline:!0}),(0,i.setBuiltinHelpInfo)(this,"lists_index_set")}}}},{"../constants":18,"../help":66,blockly:154}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initLogic=void 0;const r=e("blockly"),i=e("../help");n.initLogic=function(){const e=r.Msg,t=pxt.blocks.getBlockDefinition("controls_if"),n=t.tooltip;e.CONTROLS_IF_MSG_IF=t.block.CONTROLS_IF_MSG_IF,e.CONTROLS_IF_MSG_THEN=t.block.CONTROLS_IF_MSG_THEN,e.CONTROLS_IF_MSG_ELSE=t.block.CONTROLS_IF_MSG_ELSE,e.CONTROLS_IF_MSG_ELSEIF=t.block.CONTROLS_IF_MSG_ELSEIF,e.CONTROLS_IF_TOOLTIP_1=n.CONTROLS_IF_TOOLTIP_1,e.CONTROLS_IF_TOOLTIP_2=n.CONTROLS_IF_TOOLTIP_2,e.CONTROLS_IF_TOOLTIP_3=n.CONTROLS_IF_TOOLTIP_3,e.CONTROLS_IF_TOOLTIP_4=n.CONTROLS_IF_TOOLTIP_4,(0,i.installBuiltinHelpInfo)("controls_if");const s=pxt.blocks.getBlockDefinition("logic_compare").tooltip;e.LOGIC_COMPARE_TOOLTIP_EQ=s.LOGIC_COMPARE_TOOLTIP_EQ,e.LOGIC_COMPARE_TOOLTIP_NEQ=s.LOGIC_COMPARE_TOOLTIP_NEQ,e.LOGIC_COMPARE_TOOLTIP_LT=s.LOGIC_COMPARE_TOOLTIP_LT,e.LOGIC_COMPARE_TOOLTIP_LTE=s.LOGIC_COMPARE_TOOLTIP_LTE,e.LOGIC_COMPARE_TOOLTIP_GT=s.LOGIC_COMPARE_TOOLTIP_GT,e.LOGIC_COMPARE_TOOLTIP_GTE=s.LOGIC_COMPARE_TOOLTIP_GTE,(0,i.installBuiltinHelpInfo)("logic_compare");const o=pxt.blocks.getBlockDefinition("logic_operation"),a=o.tooltip;e.LOGIC_OPERATION_AND=o.block.LOGIC_OPERATION_AND,e.LOGIC_OPERATION_OR=o.block.LOGIC_OPERATION_OR,e.LOGIC_OPERATION_TOOLTIP_AND=a.LOGIC_OPERATION_TOOLTIP_AND,e.LOGIC_OPERATION_TOOLTIP_OR=a.LOGIC_OPERATION_TOOLTIP_OR,(0,i.installBuiltinHelpInfo)("logic_operation");const l=pxt.blocks.getBlockDefinition("logic_negate");e.LOGIC_NEGATE_TITLE=l.block.LOGIC_NEGATE_TITLE,(0,i.installBuiltinHelpInfo)("logic_negate");const c=pxt.blocks.getBlockDefinition("logic_boolean");e.LOGIC_BOOLEAN_TRUE=c.block.LOGIC_BOOLEAN_TRUE,e.LOGIC_BOOLEAN_FALSE=c.block.LOGIC_BOOLEAN_FALSE,(0,i.installBuiltinHelpInfo)("logic_boolean")}},{"../help":66,blockly:154}],6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initLoops=void 0;const r=e("blockly"),i=e("../help");n.initLoops=function(){const e=r.Msg,t=pxt.blocks.getBlockDefinition("controls_repeat_ext");e.CONTROLS_REPEAT_TITLE=t.block.CONTROLS_REPEAT_TITLE,e.CONTROLS_REPEAT_INPUT_DO=t.block.CONTROLS_REPEAT_INPUT_DO,(0,i.installBuiltinHelpInfo)("controls_repeat_ext");const n=pxt.blocks.getBlockDefinition("device_while");r.Blocks.device_while={init:function(){this.jsonInit({message0:n.block.message0,args0:[{type:"input_value",name:"COND",check:"Boolean"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops")}),this.appendStatementInput("DO").appendField(n.block.appendField),(0,i.setBuiltinHelpInfo)(this,"device_while")}};const s=pxt.blocks.getBlockDefinition("pxt_controls_for");r.Blocks.pxt_controls_for={init:function(){this.jsonInit({message0:s.block.message0,args0:[{type:"input_value",name:"VAR",variable:s.block.variable,check:"Variable"},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(s.block.appendField);let e=this;(0,i.setHelpResources)(this,"pxt_controls_for",s.name,(function(){return pxt.U.rlf(s.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")}),s.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){const n=this.getField("VAR");r.Names.equals(e,n.getText())&&n.setValue(t)}};const o=pxt.blocks.getBlockDefinition("controls_simple_for");r.Blocks.controls_simple_for={init:function(){this.jsonInit({message0:o.block.message0,args0:[{type:"field_variable",name:"VAR",variable:o.block.variable},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(o.block.appendField);let e=this;(0,i.setHelpResources)(this,"controls_simple_for",o.name,(function(){return pxt.U.rlf(o.tooltip,e.getField("VAR").getText())}),o.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){const n=this.getField("VAR");r.Names.equals(e,n.getText())&&n.setValue(t)},customContextMenu:function(e){var t,n;if(!this.isCollapsed()&&!(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly)){let t={enabled:!0},n=this.getField("VAR").getText();t.text=lf("Create 'get {0}'",n);let i=r.utils.xml.createElement("field");i.textContent=n,i.setAttribute("name","VAR");let s=r.utils.xml.createElement("block");s.setAttribute("type","variables_get"),s.appendChild(i),t.callback=r.ContextMenu.callbackFactory(this,s),e.push(t)}}};const a=pxt.blocks.getBlockDefinition(ts.pxtc.TS_BREAK_TYPE);r.Blocks[pxtc.TS_BREAK_TYPE]={init:function(){const e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:a.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,i.setHelpResources)(this,ts.pxtc.TS_BREAK_TYPE,a.name,a.tooltip,a.url,e,void 0,void 0,!1)}};const l=pxt.blocks.getBlockDefinition(ts.pxtc.TS_CONTINUE_TYPE);r.Blocks[pxtc.TS_CONTINUE_TYPE]={init:function(){const e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:l.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,i.setHelpResources)(this,ts.pxtc.TS_CONTINUE_TYPE,l.name,l.tooltip,l.url,e,void 0,void 0,!1)}},r.Blocks[pxtc.COLLAPSED_BLOCK]={init:function(){this.jsonInit({message0:"...",inputsInline:!0,previousStatement:null,nextStatement:null,colour:"#cccccc"}),(0,i.setHelpResources)(this,ts.pxtc.COLLAPSED_BLOCK,"...",lf("a few blocks"),void 0,"#cccccc",void 0,void 0,!1)}};const c=pxt.blocks.getBlockDefinition("pxt_controls_for_of");r.Blocks.pxt_controls_for_of={init:function(){this.jsonInit({message0:c.block.message0,args0:[{type:"input_value",name:"VAR",variable:c.block.variable,check:"Variable"},{type:"input_value",name:"LIST",check:["Array","String"]}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(c.block.appendField);let e=this;(0,i.setHelpResources)(this,"pxt_controls_for_of",c.name,(function(){return pxt.Util.rlf(c.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")}),c.url,String(pxt.toolbox.getNamespaceColor("loops")))}};const u=pxt.blocks.getBlockDefinition("controls_for_of");r.Blocks.controls_for_of={init:function(){this.jsonInit({message0:u.block.message0,args0:[{type:"field_variable",name:"VAR",variable:u.block.variable},{type:"input_value",name:"LIST",check:"Array"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(u.block.appendField);let e=this;(0,i.setHelpResources)(this,"controls_for_of",u.name,(function(){return pxt.Util.rlf(u.tooltip,e.getField("VAR").getText())}),u.url,String(pxt.toolbox.getNamespaceColor("loops")))}}}},{"../help":66,blockly:154}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initMathRoundBlock=n.initMathOpBlock=n.initMath=void 0;const r=e("blockly"),i=e("../help"),s=e("../constants"),o=e("../composableMutations"),a=e("../fields/field_dropdown");function l(){const e=pxt.blocks.MATH_FUNCTIONS.unary.concat(pxt.blocks.MATH_FUNCTIONS.binary).concat(pxt.blocks.MATH_FUNCTIONS.infix),t=pxt.blocks.getBlockDefinition("math_js_op");function n(e,t){const n=e.appendValueInput("ARG"+(t?1:0));n.setCheck("Number"),t&&(n.connection.setShadowDom(function(){if(!c){(c=document.createElement("shadow")).setAttribute("type","math_number");const e=document.createElement("field");e.setAttribute("name","NUM"),e.textContent="0",c.appendChild(e)}return c}()),n.connection.respawnShadow_())}function l(e,t){let n=!!e.getInput("ARG1");t?(n&&e.moveInputBefore("op_dropdown","ARG1"),e.moveInputBefore("ARG0","op_dropdown")):(n&&e.moveInputBefore("ARG0","ARG1"),e.moveInputBefore("op_dropdown","ARG0"))}r.Blocks.math_js_op={init:function(){const r=this;r.setPreviousStatement(!1),r.setNextStatement(!1),r.setOutput(!0,"Number"),r.setOutputShape(s.provider.SHAPES.ROUND),r.setInputsInline(!0),r.appendDummyInput("op_dropdown").appendField(new a.FieldDropdown(e.map((e=>[t.block[e],e])),(e=>function(e,t){return!function(e){return-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e)}(t)?e.getInput("ARG1")||n(e,!0):e.removeInput("ARG1",!0),l(e,function(e){return-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e)}(t)),t}(r,e))),"OP"),n(r,!1),(0,o.appendMutation)(r,{mutationToDom:e=>{let t;for(let e=0;e<r.inputList.length;e++){const n=r.inputList[e];if("op_dropdown"===n.name){t=!1;break}if("ARG0"===n.name){t=!0;break}}return e.setAttribute("op-type",(r.getInput("ARG1")?t?"infix":"binary":"unary").toString()),e},domToMutation:e=>{if(e.hasAttribute("op-type")){const t=e.getAttribute("op-type");"unary"!=t&&n(r,!0),l(r,"infix"===t)}}})}},(0,i.installHelpResources)("math_js_op",t.name,(function(e){return t.tooltip[e.getFieldValue("OP")]}),t.url,pxt.toolbox.getNamespaceColor(t.category))}let c;function u(){const e=pxt.blocks.ROUNDING_FUNCTIONS,t=pxt.blocks.getBlockDefinition("math_js_round");r.Blocks.math_js_round={init:function(){const n=this;n.setPreviousStatement(!1),n.setNextStatement(!1),n.setOutput(!0,"Number"),n.setOutputShape(s.provider.SHAPES.ROUND),n.setInputsInline(!0),n.appendDummyInput("round_dropdown").appendField(new a.FieldDropdown(e.map((e=>[t.block[e],e]))),"OP"),function(e){e.appendValueInput("ARG0").setCheck("Number")}(n)}},(0,i.installHelpResources)("math_js_round",t.name,(function(e){return t.tooltip[e.getFieldValue("OP")]}),t.url,pxt.toolbox.getNamespaceColor(t.category))}n.initMath=function(e){const t=pxt.blocks.getBlockDefinition("math_op2"),n=t.tooltip;r.Blocks.math_op2={init:function(){this.jsonInit({message0:lf("%1 of %2 and %3"),args0:[{type:"field_dropdown",name:"op",options:[[lf("{id:op}min"),"min"],[lf("{id:op}max"),"max"]]},{type:"input_value",name:"x",check:"Number"},{type:"input_value",name:"y",check:"Number"}],inputsInline:!0,output:"Number",outputShape:s.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,i.setHelpResources)(this,"math_op2",t.name,(function(e){return n[e.getFieldValue("op")]}),t.url,pxt.toolbox.getNamespaceColor(t.category))},codeCard:(0,i.attachCardInfo)(e,"Math.min")};const o=pxt.blocks.getBlockDefinition("math_op3");r.Blocks.math_op3={init:function(){this.jsonInit({message0:o.block.message0,args0:[{type:"input_value",name:"x",check:"Number"}],inputsInline:!0,output:"Number",outputShape:s.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,i.setBuiltinHelpInfo)(this,"math_op3")},codeCard:(0,i.attachCardInfo)(e,"Math.abs")},["math_number","math_integer","math_whole_number","math_number_minmax"].forEach((e=>{const t=pxt.blocks.getBlockDefinition(e);(0,i.installHelpResources)(e,t.name,t.tooltip,t.url,"#fff","#fff","#fff")}));const a=r.Msg,c=pxt.blocks.getBlockDefinition("math_arithmetic"),d=c.tooltip;a.MATH_ADDITION_SYMBOL=c.block.MATH_ADDITION_SYMBOL,a.MATH_SUBTRACTION_SYMBOL=c.block.MATH_SUBTRACTION_SYMBOL,a.MATH_MULTIPLICATION_SYMBOL=c.block.MATH_MULTIPLICATION_SYMBOL,a.MATH_DIVISION_SYMBOL=c.block.MATH_DIVISION_SYMBOL,a.MATH_POWER_SYMBOL=c.block.MATH_POWER_SYMBOL,(0,i.installHelpResources)("math_arithmetic",c.name,(function(e){return d[e.getFieldValue("OP")]}),c.url,pxt.toolbox.getNamespaceColor(c.category));const p=pxt.blocks.getBlockDefinition("math_modulo");a.MATH_MODULO_TITLE=p.block.MATH_MODULO_TITLE,(0,i.installBuiltinHelpInfo)("math_modulo"),l(),u()},n.initMathOpBlock=l,n.initMathRoundBlock=u},{"../composableMutations":17,"../constants":18,"../fields/field_dropdown":33,"../help":66,blockly:154}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initOnStart=void 0;const r=e("blockly"),i=e("../fields"),s=e("../help");n.initOnStart=function(){const e=pxt.blocks.getBlockDefinition(ts.pxtc.ON_START_TYPE);if(r.Blocks[ts.pxtc.ON_START_TYPE]={init:function(){this.jsonInit({message0:e.block.message0,args0:[{type:"input_dummy"},{type:"input_statement",name:"HANDLER"}],colour:(pxt.appTarget.runtime?pxt.appTarget.runtime.onStartColor:"")||pxt.toolbox.getNamespaceColor("loops")}),(0,s.setHelpResources)(this,ts.pxtc.ON_START_TYPE,e.name,e.tooltip,e.url,String((pxt.appTarget.runtime?pxt.appTarget.runtime.onStartColor:"")||pxt.toolbox.getNamespaceColor("loops")),void 0,void 0,!!pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable)}},r.Blocks[pxtc.TS_STATEMENT_TYPE]={init:function(){let e,t,n=this;n.setColour("#717171"),n.setPreviousStatement(!0),n.setNextStatement(!0),n.setInputsInline(!1),n.domToMutation=e=>{const r=parseInt(e.getAttribute("numlines"));n.declaredVariables=e.getAttribute("declaredvars"),t=[];for(let n=0;n<r;n++){const r=e.getAttribute("line"+n);t.push(r)}n.setPythonEnabled(!1)},n.mutationToDom=()=>{let e=document.createElement("mutation");return t&&(t.forEach(((t,n)=>e.setAttribute("line"+n,t))),e.setAttribute("numlines",t.length.toString())),n.declaredVariables&&e.setAttribute("declaredvars",this.declaredVariables),e},n.setPythonEnabled=r=>{if(e!==r){for(;n.inputList.length;)n.removeInput(n.inputList[0].name);e=r,r?(n.appendDummyInput().appendField(pxt.Util.lf("<python code>"),"LINE0"),n.setTooltip(lf("A Python statement that could not be converted to blocks"))):(t.forEach(((e,t)=>{n.appendDummyInput().appendField(e,"LINE"+t)})),n.setTooltip(lf("A JavaScript statement that could not be converted to blocks")))}},n.getLines=()=>t,n.setEditable(!1),(0,s.setHelpResources)(this,pxtc.TS_STATEMENT_TYPE,lf("JavaScript statement"),lf("A JavaScript statement that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},r.Blocks[pxtc.TS_OUTPUT_TYPE]={init:function(){let e=this;e.setColour("#717171"),e.setPreviousStatement(!1),e.setNextStatement(!1),e.setOutput(!0),e.setEditable(!1),e.appendDummyInput().appendField(new i.FieldTsExpression(""),"EXPRESSION"),e.setPythonEnabled=t=>{e.getField("EXPRESSION").setPythonEnabled(t),t?e.setTooltip(lf("A Python expression that could not be converted to blocks")):e.setTooltip(lf("A JavaScript expression that could not be converted to blocks"))},(0,s.setHelpResources)(e,pxtc.TS_OUTPUT_TYPE,lf("JavaScript expression"),lf("A JavaScript expression that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock){const e=pxt.appTarget.runtime.pauseUntilBlock,t=pxt.blocks.getBlockDefinition(ts.pxtc.PAUSE_UNTIL_TYPE);r.Blocks[pxtc.PAUSE_UNTIL_TYPE]={init:function(){const n=e.color||pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:t.block.message0,args0:[{type:"input_value",name:"PREDICATE",check:"Boolean"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:n}),(0,s.setHelpResources)(this,ts.pxtc.PAUSE_UNTIL_TYPE,t.name,t.tooltip,t.url,n,void 0,void 0,!1)}}}}},{"../fields":65,"../help":66,blockly:154}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initText=void 0;const r=e("blockly"),i=e("../help"),s=e("../constants");n.initText=function(){const e=pxt.blocks.getBlockDefinition("text");(0,i.installHelpResources)("text",e.name,e.tooltip,e.url,"#fff","#fff","#fff");const t=pxt.blocks.getBlockDefinition("text_length");r.Msg.TEXT_LENGTH_TITLE=t.block.TEXT_LENGTH_TITLE,r.Blocks.text_length.init=function(){this.jsonInit({message0:r.Msg.TEXT_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String"]}],output:"Number",outputShape:s.provider.SHAPES.ROUND})},(0,i.installBuiltinHelpInfo)("text_length");const n=pxt.blocks.getBlockDefinition("text_join");r.Msg.TEXT_JOIN_TITLE_CREATEWITH=n.block.TEXT_JOIN_TITLE_CREATEWITH,(0,i.installBuiltinHelpInfo)("text_join")}},{"../constants":18,"../help":66,blockly:154}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initVariables=void 0;const r=e("blockly"),i=e("../toolbox"),s=e("../help");n.initVariables=function(){r.FieldVariable.prototype.getVariableTypes_=()=>[""];let e=lf("{id:var}item");r.Variables.flyoutCategory=function(e){let t=[];if(!pxt.appTarget.appTheme.hideFlyoutHeadings){let e=(0,i.createFlyoutHeadingLabel)(lf("Variables"),pxt.toolbox.getNamespaceColor("variables"),pxt.toolbox.getNamespaceIcon("variables"));t.push(e)}let n=document.createElement("button");n.setAttribute("text",lf("Make a Variable...")),n.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",(function(e){r.Variables.createVariableButtonHandler(e.getTargetWorkspace())})),t.push(n);let s=r.Variables.flyoutCategoryBlocks(e);return t.concat(s)},r.Variables.flyoutCategoryBlocks=function(e){let t=e.getVariablesOfType(""),n=[];if(t.length>0){let e=t[t.length-1];t.sort(r.VariableModel.compareByName);for(let e=0;e<t.length;e++){const s=t[e];if(r.Blocks.variables_get){let e=(0,i.mkVariableFieldBlock)("variables_get",s.getId(),s.type,s.name,!1);e.setAttribute("gap","8"),n.push(e)}}if(n[n.length-1].setAttribute("gap","24"),(r.Blocks.variables_change||r.Blocks.variables_set)&&n.unshift((0,i.createFlyoutGroupLabel)(lf("Your Variables"))),r.Blocks.variables_change){let t=r.Blocks.variables_get?20:8,s=(0,i.mkVariableFieldBlock)("variables_change",e.getId(),e.type,e.name,!1);s.setAttribute("gap",t+"");{let e=r.utils.xml.createElement("value");e.setAttribute("name","VALUE");let t=r.utils.xml.createElement("shadow");t.setAttribute("type","math_number"),e.appendChild(t);let n=r.utils.xml.createElement("field");n.setAttribute("name","NUM"),n.appendChild(document.createTextNode("1")),t.appendChild(n),s.appendChild(e)}n.unshift(s)}if(r.Blocks.variables_set){let t=r.Blocks.variables_change?8:24,s=(0,i.mkVariableFieldBlock)("variables_set",e.getId(),e.type,e.name,!1);s.setAttribute("gap",t+"");{let e=r.utils.xml.createElement("value");e.setAttribute("name","VALUE");let t=r.utils.xml.createElement("shadow");t.setAttribute("type","math_number"),e.appendChild(t);let n=r.utils.xml.createElement("field");n.setAttribute("name","NUM"),n.appendChild(document.createTextNode("0")),t.appendChild(n),s.appendChild(e)}n.unshift(s)}}return n};const t=r.Msg,n=pxt.blocks.getBlockDefinition("variables_get");t.VARIABLES_GET_CREATE_SET=n.block.VARIABLES_GET_CREATE_SET,(0,s.installBuiltinHelpInfo)("variables_get"),(0,s.installBuiltinHelpInfo)("variables_get_reporter"),t.RENAME_VARIABLE=lf("Rename variable..."),t.DELETE_VARIABLE=lf('Delete the "%1" variable'),t.DELETE_VARIABLE_CONFIRMATION=lf('Delete %1 uses of the "%2" variable?'),t.NEW_VARIABLE_DROPDOWN=lf("New variable...");const o=pxt.blocks.getBlockDefinition("variables_set");t.VARIABLES_SET=o.block.VARIABLES_SET,t.VARIABLES_DEFAULT_NAME=e,t.VARIABLES_SET_CREATE_GET=lf("Create 'get %1'"),(0,s.installBuiltinHelpInfo)("variables_set");const a=pxt.blocks.getBlockDefinition("variables_change");r.Blocks.variables_change={init:function(){this.jsonInit({message0:a.block.message0,args0:[{type:"field_variable",name:"VAR",variable:e},{type:"input_value",name:"VALUE",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("variables")}),(0,s.setBuiltinHelpInfo)(this,"variables_change")},customContextMenu:function(e){var t,n;if(!(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly)){let t={enabled:this.workspace.remainingCapacity()>0},n=this.getField("VAR").getText();t.text=lf("Create 'get {0}'",n);let i=r.utils.xml.createElement("field");i.textContent=n,i.setAttribute("name","VAR");let s=r.utils.xml.createElement("block");s.setAttribute("type","variables_get"),s.appendChild(i),t.callback=r.ContextMenu.callbackFactory(this,s),e.push(t)}}},t.NEW_VARIABLE_TITLE=lf("New variable name:"),t.RENAME_VARIABLE_TITLE=lf("Rename all '%1' variables to:")}},{"../help":66,"../toolbox":120,blockly:154}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.renderCodeCard=void 0;const r=e("./render");n.renderCodeCard=function(e,t={}){const n=e.url?/^[^:]+:\/\//.test(e.url)?e.url:"/"+e.url.replace(/^\.?\/?/,""):e.youTubeId?`https://youtu.be/${e.youTubeId}`:void 0,i=!!n,s=(e,t,n="div",r="")=>{let i=document.createElement(n);return t&&(i.className=t),e&&e.appendChild(i),r&&i.appendChild(document.createTextNode(r+"")),i};let o=s(null,"ui "+(e.style||"card")+" "+(e.color||"")+(i?" link":""),i?"a":"div");if(o.setAttribute("role","option"),o.setAttribute("aria-selected","true"),i){const e=o;e.href=n,/^https?:\/\//.test(n)&&(e.target="_blank")}if(!t.hideHeader&&e.header){let t=s(o,"ui content "+(e.responsive?" tall desktop only":""));e.header&&s(t,"description","span",e.header)}const a=(t.shortName?e.shortName:"")||e.name;let l=s(o,"ui image"+(e.responsive?" tall landscape only":""));if(e.label){let t=document.createElement("label");t.className=`ui ${e.labelClass?e.labelClass:"orange right ribbon"} label`,t.textContent=e.label,l.appendChild(t)}if(e.blocksXml){const t=(0,r.render)(e.blocksXml);if(t){let e=s(l,"");e.setAttribute("style","width:100%; min-height:10em"),e.appendChild(t)}else console.error("failed to render blocks"),pxt.debug(e.blocksXml)}if(e.typeScript){let t=document.createElement("pre");t.appendChild(document.createTextNode(e.typeScript)),l.appendChild(t)}if(e.imageUrl||(e.youTubeId?`https://img.youtube.com/vi/${e.youTubeId}/0.jpg`:void 0)){let t=document.createElement("div");t.className="ui imagewrapper";let n=document.createElement("div");n.className="ui cardimage",n.style.backgroundImage=`url("${e.imageUrl}")`,n.title=a,n.setAttribute("role","presentation"),t.appendChild(n),l.appendChild(t)}if("file"==e.cardType){let e=s(o,"ui fileimage");l.appendChild(e)}if(a||e.description){let t=s(o,"ui content");if(a&&(o.setAttribute("aria-label",a),s(t,"header","div",a)),e.description){const n=s(t,"ui description"),r=e.description.split(".")[0]+".";n.appendChild(document.createTextNode(r))}}if(e.time){let t=s(o,"meta");e.time&&s(t,"date","span").appendChild(document.createTextNode(pxt.Util.timeSince(e.time)))}return e.extracontent&&s(o,"extra content","div").appendChild(document.createTextNode(e.extracontent)),o}},{"./render":118}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.workerOpAsync=n.compileExpression=n.callKey=n.compileAsync=n.compileBlockAsync=void 0;const r=e("blockly"),i=e("./environment"),s=e("./typeChecker"),o=e("./util"),a=e("../toolbox"),l=e("../legacyMutations"),c=e("./variables"),u=e("../fields");function d(e,t){if(e.type===ts.pxtc.ON_START_TYPE)return 0;const n=t.stdCallTable[e.type],r=p(t,e),i=1+ts.pxtc.Util.codalHash16(r);return n&&n.attrs.afterOnStart?i:-i}function p(e,t){return t.type==ts.pxtc.ON_START_TYPE?JSON.stringify({name:ts.pxtc.ON_START_TYPE}):t.type==ts.pxtc.FUNCTION_DEFINITION_TYPE?JSON.stringify({type:"function",name:t.getFieldValue("function_name")}):JSON.stringify(h(t)).replace(/"id"\s*:\s*"[^"]+"/g,"")}function h(e){const t=[],n=[];for(const i of e.inputList){for(const e of i.fieldRow)e.name&&t.push(e.getText());i.type===r.inputTypes.VALUE&&(i.connection.targetBlock()?n.push(h(i.connection.targetBlock())):n.push(null))}return{type:e.type,fields:t,inputs:n}}function f(e,t){e.setEnabled(t);const n=e.getDescendants(!1);for(const e of n)e.setEnabled(t)}function m(e,t){if(t.isInsertionMarker())return[];let n;const r=[];switch(e.stats[t.type]=(e.stats[t.type]||0)+1,x(t,r),t.type){case"controls_if":n=function(e,t,n){let r=[];for(let i=0;i<=t.elseifCount_;++i){let s=_(e,(0,o.getInputTargetBlock)(e,t,"IF"+i),n),a=g(e,(0,o.getInputTargetBlock)(e,t,"DO"+i)),l=pxt.blocks.mkText("if (");i>0&&((l=pxt.blocks.mkText("else if (")).glueToBlock=pxt.blocks.GlueMode.WithSpace),(0,o.append)(r,[l,s,pxt.blocks.mkText(")"),a])}if(t.elseCount_){let n=pxt.blocks.mkText("else");n.glueToBlock=pxt.blocks.GlueMode.WithSpace,(0,o.append)(r,[n,g(e,(0,o.getInputTargetBlock)(e,t,"ELSE"))])}return r}(e,t,r);break;case"pxt_controls_for":case"controls_for":case"controls_simple_for":n=function(e,t,n){let r=(0,o.getInputTargetBlock)(e,t,"TO"),i=(0,o.getInputTargetBlock)(e,t,"DO"),a=(0,o.getInputTargetBlock)(e,t,"BY"),l=(0,o.getInputTargetBlock)(e,t,"FROM"),c=!a||a.type.match(/^math_number/)&&1==F(a),u=(0,s.lookup)(e,t,(0,o.getLoopVariableField)(e,t).getField("VAR").getText());return[pxt.blocks.mkText("for (let "+u.escapedName+" = "),l?_(e,l,n):pxt.blocks.mkText("0"),pxt.blocks.mkText("; "),pxt.blocks.mkInfix(pxt.blocks.mkText(u.escapedName),"<=",_(e,r,n)),pxt.blocks.mkText("; "),c?pxt.blocks.mkText(u.escapedName+"++"):pxt.blocks.mkInfix(pxt.blocks.mkText(u.escapedName),"+=",_(e,a,n)),pxt.blocks.mkText(")"),g(e,i)]}(e,t,r);break;case"pxt_controls_for_of":case"controls_for_of":n=function(e,t,n){let r=(0,o.getInputTargetBlock)(e,t,"LIST"),i=(0,o.getInputTargetBlock)(e,t,"DO"),a=(0,s.lookup)(e,t,(0,o.getLoopVariableField)(e,t).getField("VAR").getText());return[pxt.blocks.mkText("for (let "+a.escapedName+" of "),_(e,r,n),pxt.blocks.mkText(")"),g(e,i)]}(e,t,r);break;case"variables_set":n=[b(e,t,r)];break;case"variables_change":n=[v(e,t,r)];break;case"controls_repeat_ext":n=function(e,t,n){let r=_(e,(0,o.getInputTargetBlock)(e,t,"TIMES"),n),i=g(e,(0,o.getInputTargetBlock)(e,t,"DO")),a=n=>!(0,s.lookup)(e,t,n),l="index";for(let e=2;!a(l);e++)l="index"+e;return[pxt.blocks.mkText("for (let "+l+" = 0; "),pxt.blocks.mkInfix(pxt.blocks.mkText(l),"<",r),pxt.blocks.mkText("; "+l+"++)"),i]}(e,t,r);break;case"device_while":n=function(e,t,n){let r=_(e,(0,o.getInputTargetBlock)(e,t,"COND"),n),i=g(e,(0,o.getInputTargetBlock)(e,t,"DO"));return[pxt.blocks.mkText("while ("),r,pxt.blocks.mkText(")"),i]}(e,t,r);break;case"procedures_defnoreturn":n=function(e,t,n){const r=(0,o.escapeVarName)(t.getFieldValue("NAME"),e,!0),i=(0,o.getInputTargetBlock)(e,t,"STACK");return[pxt.blocks.mkText("function "+r+"() "),g(e,i)]}(e,t);break;case"function_definition":n=function(e,t,n){const r=(0,o.escapeVarName)(t.getField("function_name").getText(),e,!0),i=(0,o.getInputTargetBlock)(e,t,"STACK"),a=t.getArguments().map((n=>{if("Array"==n.type){const r=(0,s.lookup)(e,t,n.name),i=(0,s.getConcreteType)(r.type),a=(null==i?void 0:i.type)&&"Array"!==i.type?i.type:"any[]";return`${(0,o.escapeVarName)(n.name,e)}: ${a}`}return`${(0,o.escapeVarName)(n.name,e)}: ${n.type}`})),l=(0,s.isFunctionRecursive)(e,t,!1);return[pxt.blocks.mkText(`function ${r} (${a.join(", ")})${l?": any":""}`),g(e,i)]}(e,t);break;case"procedures_callnoreturn":n=[A(e,t,r)];break;case"function_call":n=[w(e,t,r,!0)];break;case pxtc.TS_RETURN_STATEMENT_TYPE:n=[N(e,t,r)];break;case ts.pxtc.ON_START_TYPE:n=function(e,t){const n=g(e,(0,o.getInputTargetBlock)(e,t,"HANDLER"));return pxt.appTarget.compile&&pxt.appTarget.compile.onStartText&&n&&n.children&&n.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText(`// ${pxtc.ON_START_COMMENT}\n`))),n}(e,t).children;break;case pxtc.TS_STATEMENT_TYPE:n=function(e,t){return t.getLines().map((e=>pxt.blocks.mkText(e+"\n")))}(0,t);break;case pxtc.PAUSE_UNTIL_TYPE:n=function(e,t,n){const r=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;pxt.U.assert(!!r,"target has block enabled");const i=r.namespace,s=r.callName||"pauseUntil",o=O(e,t,{definitionName:"PREDICATE",actualName:"PREDICATE"},n),a=[pxt.blocks.mkGroup([pxt.blocks.mkText("() => "),o])];return i?[pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(i,s,a,!1))]:[pxt.blocks.mkStmt(pxt.blocks.H.mkCall(s,a,!1,!1))]}(e,t,r);break;case pxtc.TS_DEBUGGER_TYPE:n=function(e,t){return"1"==t.getFieldValue("ON_OFF")?[pxt.blocks.mkText("debugger;\n")]:[]}(0,t);break;case pxtc.TS_BREAK_TYPE:n=[pxt.blocks.mkText("break;\n")];break;case pxtc.TS_CONTINUE_TYPE:n=[pxt.blocks.mkText("continue;\n")];break;default:n=e.stdCallTable[t.type]?[D(e,t,r)]:[pxt.blocks.mkStmt(_(e,t,r))]}let i=n[n.length-1];return i&&!i.id&&(i.id=t.id),r.length&&function(e,t){const n=[];for(const t of e)for(const e of t.split("\n"))n.push(pxt.blocks.mkText(`// ${e}`)),n.push(pxt.blocks.mkNewLine());for(const e of n.reverse())t.unshift(e)}(r,n),n.forEach((e=>{!(e.type===pxt.blocks.NT.Block||e.type===pxt.blocks.NT.Prefix&&pxt.Util.startsWith(e.op,"//"))||t.type==pxtc.ON_START_TYPE&&e.id||(e.id=t.id)})),n}function _(e,t,n){let r;if(pxt.U.assert(null!=t),e.stats[t.type]=(e.stats[t.type]||0)+1,x(t,n),"placeholder"!=t.type&&t.isEnabled&&t.isEnabled())switch(t.type){case"math_number":case"math_integer":case"math_whole_number":case"math_number_minmax":r=function(e,t,n){return pxt.blocks.H.mkNumberLiteral(F(t))}(0,t);break;case"math_op2":r=function(e,t,n){let r=t.getFieldValue("op"),i=_(e,(0,o.getInputTargetBlock)(e,t,"x"),n),s=_(e,(0,o.getInputTargetBlock)(e,t,"y"),n);return pxt.blocks.H.mathCall(r,[i,s])}(e,t,n);break;case"math_op3":r=function(e,t,n){let r=_(e,(0,o.getInputTargetBlock)(e,t,"x"),n);return pxt.blocks.H.mathCall("abs",[r])}(e,t,n);break;case"math_arithmetic":case"logic_compare":case"logic_operation":r=function(e,t,n){let r=t.getFieldValue("OP"),i=(0,o.getInputTargetBlock)(e,t,"A"),a=(0,o.getInputTargetBlock)(e,t,"B"),l=[_(e,i,n),_(e,a,n)];(function(e){return-1!==["LT","LTE","GT","GTE","EQ","NEQ"].indexOf(e)})(r)&&P(e,i)&&P(e,a)&&pxt.blocks.flattenNode([l[0]]).output!==pxt.blocks.flattenNode([l[1]]).output&&(l=l.map((e=>pxt.blocks.H.mkParenthesizedExpression(pxt.blocks.mkGroup([e,pxt.blocks.mkText(" as any")])))));const c=(0,s.returnType)(e,i);if((0,s.isStringType)(c)){if("EQ"==r)return pxt.blocks.H.mkSimpleCall("==",l);if("NEQ"==r)return pxt.blocks.H.mkSimpleCall("!=",l)}else if((0,s.isBooleanType)(c))return pxt.blocks.H.mkSimpleCall(I[r],l);return pxt.U.assert(r in I),pxt.blocks.H.mkSimpleCall(I[r],l)}(e,t,n);break;case"math_modulo":r=function(e,t,n){let r=(0,o.getInputTargetBlock)(e,t,"DIVIDEND"),i=(0,o.getInputTargetBlock)(e,t,"DIVISOR"),s=[_(e,r,n),_(e,i,n)];return pxt.blocks.H.mkSimpleCall("%",s)}(e,t,n);break;case"logic_boolean":r=function(e,t,n){return pxt.blocks.H.mkBooleanLiteral("TRUE"==t.getFieldValue("BOOL"))}(0,t);break;case"logic_negate":r=function(e,t,n){let r=_(e,(0,o.getInputTargetBlock)(e,t,"BOOL"),n);return pxt.blocks.mkPrefix("!",[pxt.blocks.H.mkParenthesizedExpression(r)])}(e,t,n);break;case"variables_get":case"variables_get_reporter":r=function(e,t){const n=t.getField("VAR").getText();let r=(0,s.lookup)(e,t,n);return r?(r.firstReference||(r.firstReference=t),pxt.U.assert(null!=r&&null!=r.type),pxt.blocks.mkText(r.escapedName)):pxt.blocks.mkText(n)}(e,t);break;case"text":r=function(e,t,n){return pxt.blocks.H.mkStringLiteral(t.getFieldValue("TEXT"))}(0,t);break;case"text_join":r=function(e,t,n){let r,i=0;for(;;){const s=(0,o.getInputTargetBlock)(e,t,"ADD"+i);if(i++,!s){if(i<t.inputList.length)continue;break}const a=_(e,s,n);r=r?pxt.blocks.H.mkSimpleCall("+",[r,a]):0===s.type.indexOf("text")?a:pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),a])}return r||pxt.blocks.H.mkStringLiteral("")}(e,t,n);break;case"lists_create_with":r=function(e,t,n){let r=t.inputList.map((t=>t.connection&&t.connection.targetBlock()?_(e,t.connection.targetBlock(),n):void 0)).filter((e=>!!e));return pxt.blocks.H.mkArrayLiteral(r,!t.getInputsInline())}(e,t,n);break;case"lists_index_get":r=function(e,t,n){const r=_(e,(0,o.getInputTargetBlock)(e,t,"LIST"),n),i=_(e,(0,o.getInputTargetBlock)(e,t,"INDEX"),n);return pxt.blocks.mkGroup([r,pxt.blocks.mkText("["),i,pxt.blocks.mkText("]")])}(e,t,n);break;case"lists_index_set":r=function(e,t,n){const r=(0,o.getInputTargetBlock)(e,t,"LIST"),i=_(e,r,n),s=_(e,(0,o.getInputTargetBlock)(e,t,"INDEX"),n),a=_(e,(0,o.getInputTargetBlock)(e,t,"VALUE"),n),l=pxt.blocks.mkGroup([i,pxt.blocks.mkText("["),s,pxt.blocks.mkText("] = "),a]);return"lists_create_with"===r.type?y(l):l}(e,t,n);break;case"math_js_op":case"math_js_round":r=function(e,t,n){const r=t.getFieldValue("OP"),i=[_(e,(0,o.getInputTargetBlock)(e,t,"ARG0"),n)];return t.getInput("ARG1")&&i.push(_(e,(0,o.getInputTargetBlock)(e,t,"ARG1"),n)),pxt.blocks.H.mathCall(r,i)}(e,t,n);break;case pxtc.TS_OUTPUT_TYPE:r=function(e,t,n){return pxt.blocks.mkText(t.getFieldValue("EXPRESSION").trim())}(0,t);break;case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":r=function(e,t,n){const r=(0,o.escapeVarName)(t.getFieldValue("VALUE"),e);return pxt.blocks.mkText(r)}(e,t);break;case"function_call_output":r=w(e,t,n,!1);break;default:let i=e.stdCallTable[t.type];i?r=i.imageLiteral?k(e,t,i.imageLiteral,i.imageLiteralColumns,i.imageLiteralRows,i.namespace,i.f,(0,o.visibleParams)(i,(0,o.countOptionals)(t,i)).map((r=>O(e,t,r,n)))):R(e,t,i,n):(pxt.reportError("blocks","unable to compile expression",{details:t.type}),r=(0,s.defaultValueForType)((0,s.returnType)(e,t)))}else if("Array"===(0,s.find)((0,s.returnType)(e,t)).type){let n="lists_index_get"===t.getParent().type;if(!n){const r=e.stdCallTable[t.getParent().type];n=r&&r.isExpression}const i=pxt.blocks.mkText("[0]");r=n?i:y(i)}else r=(0,s.defaultValueForType)((0,s.returnType)(e,t));return r.id=t.id,r}function g(e,t){let n=[],r=t;for(;t;)t.isEnabled()&&(0,o.append)(n,m(e,t)),t=t.getNextBlock();return r&&e.blockDeclarations[r.id]&&e.blockDeclarations[r.id].filter((e=>!e.alreadyDeclared)).forEach((t=>{n.unshift(S(t,e.blocksInfo)),t.alreadyDeclared=i.BlockDeclarationType.Implicit})),pxt.blocks.mkBlock(n)}function y(e){const t=pxt.blocks.mkStmt(pxt.blocks.mkText(";"));return t.glueToBlock=pxt.blocks.GlueMode.NoSpace,pxt.blocks.mkGroup([t,e])}function b(e,t,n){let r=(0,o.getInputTargetBlock)(e,t,"VALUE"),a=(0,s.lookup)(e,t,t.getField("VAR").getText()),l=e.idToScope[t.id].declaredVars[a.name]===a&&!a.firstReference&&!a.alreadyDeclared;l&&(0,o.forEachChildExpression)(t,(t=>{"variables_get"===t.type&&(0,s.lookup)(e,t,t.getField("VAR").getText())===a&&(l=!1)}),!0);let c=_(e,r,n),u=a.escapedName+" = ";if(a.isAssigned=!0,l){a.alreadyDeclared=i.BlockDeclarationType.Assigned;const t=(0,s.getConcreteType)(a.type);if(u=`let ${a.escapedName} = `,t){const n=(0,s.getConcreteType)((0,s.returnType)(e,r));t.type!==n.type&&(u=`let ${a.escapedName}: ${t.type} = `)}}else a.firstReference||(a.firstReference=t);return pxt.blocks.mkStmt(pxt.blocks.mkText(u),c)}function v(e,t,n){let r=(0,o.getInputTargetBlock)(e,t,"VALUE"),i=(0,s.lookup)(e,t,t.getField("VAR").getText()),a=_(e,r,n),l=pxt.blocks.mkText(i.escapedName);return pxt.blocks.mkStmt(pxt.blocks.mkInfix(l,"+=",a))}function T(e,t,n,r,i,a){const c=r.map((n=>O(e,t,n,a))),u=(0,o.getInputTargetBlock)(e,t,"HANDLER"),d=g(e,u);let p;if(pxt.appTarget.compile&&pxt.appTarget.compile.emptyEventHandlerComments&&0===d.children.length&&d.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText(`// ${pxtc.HANDLER_COMMENT}`))),(0,o.isMutatingBlock)(t)&&t.mutation.getMutationType()===l.MutatorTypes.ObjectDestructuringMutator)p=t.mutation.compileMutation(e,a);else if(n.comp.handlerArgs.length){let r=(0,s.getEscapedCBParameters)(t,n,e);p=pxt.blocks.mkText(`function (${r.join(", ")})`)}return function(e,t,n,r,i,s,o=!1){let a;return i.noFinalNewline=!0,a=s?pxt.blocks.mkGroup([s,i]):pxt.blocks.mkGroup([pxt.blocks.mkText("function ()"),i]),o?pxt.blocks.mkStmt(pxt.blocks.H.extensionCall(n,r.concat([a]),!1)):t?pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(t,n,r.concat([a]),!1)):pxt.blocks.mkStmt(pxt.blocks.H.mkCall(n,r.concat([a]),!1))}(0,i,n.f,c,d,p,n.isExtensionMethod)}function k(e,t,n,r,i,s,o,a){a=void 0===a?[]:a;let l="\n";i=i||5,r=(r||5)*n;let c=t.getFieldValue("LEDS");c=c.replace(/[ `\n]+/g,"");for(let e=0;e<i;++e){for(let t=0;t<r;++t)t>0&&(l+=" "),l+="#"===c[e*r+t]?"#":".";l+="\n"}let u=pxt.blocks.H.mkStringLiteral(l);return u.canIndentInside=!0,pxt.blocks.H.namespaceCall(s,o,[u].concat(a),!1)}function E(e,t,n){let r=pxt.blocks.flattenNode(t);return $("format",{format:{input:r.output,pos:1}}).then((()=>({source:r.output,sourceMap:r.sourceMap,stats:e.stats,diagnostics:n||[]})))}function x(e,t){var n;const r=null===(n=e.getCommentText)||void 0===n?void 0:n.call(e);r&&t.push(r)}function S(e,t){const n=(0,s.getConcreteType)(e.type);let r,i="";if("null"==(r="Array"===n.type?pxt.blocks.mkText("[]"):(0,s.defaultValueForType)(n)).op||"[]"==r.op){let e=n.type;"Array"!==e&&"null[]"!==e||(e="number[]");let s=t.apis.byQName[e];s&&s.attributes.autoCreate?r=pxt.blocks.mkText(s.attributes.autoCreate+"()"):i=": "+e}return pxt.blocks.mkStmt(pxt.blocks.mkText("let "+e.escapedName+i+" = "),r)}function C(e,t,n,r,i){const s=a(e,i.x,i.x+i.width)||a(i.x,e,e+n),o=a(t,i.y,i.y+i.height)||a(i.y,t,t+r);return s&&o;function a(e,t,n){return e>=t&&e<=n}}n.compileBlockAsync=function(e,t){const n=e.workspace,r=(0,i.mkEnv)(n,t);(0,s.infer)(n&&n.getAllBlocks(!1),r,n);const o=m(r,e);return r.placeholders={},E(r,o)},n.compileAsync=function(e,t,n={}){const l=(0,i.mkEnv)(e,t,n),[u,h]=function(e,t,n){try{let l=t.getAllBlocks(!1);pxt.react.getTilemapProject&&pxt.react.getTilemapProject().removeInactiveBlockAssets(l.map((e=>e.id)));let u=t.getTopBlocks(!0);u=u.sort(((t,n)=>d(t,e)-d(n,e))),function(e,t,n){const i=r.Events.isEnabled();i&&r.Events.disable(),t.forEach((e=>e.setEnabled(!0)));const s={};function a(e,t){s[e]?f(t,!1):(f(t,!0),s[e]=t)}n.forEach((t=>{const n=e.stdCallTable[t.type];if(t.type==ts.pxtc.ON_START_TYPE)a(ts.pxtc.ON_START_TYPE,t);else{if((0,o.isFunctionDefinition)(t)||n&&n.attrs.blockAllowMultiple&&!n.attrs.handlerStatement)return;if(n&&n.hasHandler&&!n.attrs.handlerStatement)a(n.attrs.blockHandlerKey||p(e,t),t);else{let e=t;for(;e;)f(t,!1),e=e.getNextBlock()}}})),i&&r.Events.enable()}(e,l,u),l=l.filter((e=>e.isEnabled())),u=u.filter((e=>e.isEnabled())),(0,c.trackAllVariables)(u,e),(0,s.infer)(l,e,t);const h=[],_=function(e,t){if(!e.length||e.some((e=>!e.rendered)))return{orphans:t,idToComments:{}};const n=e.map((e=>{const t=e.getBoundingRectangle(),n=e.getHeightWidth();return{id:e.id,x:t.left,y:t.top,width:n.width,height:n.height}})),r={orphans:[],idToComments:{}};for(const e of t){const t=e.getBoundingRectangle(),i=e.getHeightWidth(),s=t.left,o=t.top;let a;for(const e of n)(C(s,o,i.width,i.height,e)||!a&&C(s-20,o-20,i.width+40,i.height+40,e))&&(a=e);a?(r.idToComments[a.id]||(r.idToComments[a.id]=[]),r.idToComments[a.id].push(e)):r.orphans.push(e)}return r}(u,t.getTopComments(!0));_.orphans.forEach((e=>(0,o.append)(h,L(e).children))),u.forEach((t=>{if(_.idToComments[t.id]&&_.idToComments[t.id].forEach((e=>{(0,o.append)(h,L(e).children)})),t.type==ts.pxtc.ON_START_TYPE)(0,o.append)(h,m(e,t));else{const n=pxt.blocks.mkBlock(m(e,t));n.type==pxt.blocks.NT.Block?(0,o.append)(h,n.children):h.push(n)}}));const g=[];e.enums.forEach((e=>{const n=t.getVariablesOfType(e.name);if(n&&n.length){const t=n.map((e=>{const t=/^(\d+)([^0-9].*)$/.exec(e.name);return t?[t[2],parseInt(t[1])]:[e.name,-1]}));t.sort(((e,t)=>e[1]-t[1]));const r=[];let i=-1;t.forEach((([t,n],s)=>{let o;if(e.isBitMask){const e=Math.log2(n);e>=0&&Math.floor(e)===e&&(o=pxt.blocks.H.mkAssign(pxt.blocks.mkText(t),pxt.blocks.H.mkSimpleCall("<<",[pxt.blocks.H.mkNumberLiteral(1),pxt.blocks.H.mkNumberLiteral(e)])))}else if(e.isHash){const e=ts.pxtc.Util.codalHash16(t.toLowerCase());o=pxt.blocks.H.mkAssign(pxt.blocks.mkText(t),pxt.blocks.H.mkNumberLiteral(e))}o||(o=n===i+1?pxt.blocks.mkText(t):pxt.blocks.H.mkAssign(pxt.blocks.mkText(t),pxt.blocks.H.mkNumberLiteral(n))),r.push(o),i=n}));const s=pxt.blocks.mkCommaSep(r,!0);s.glueToBlock=pxt.blocks.GlueMode.NoSpace,g.push(pxt.blocks.mkGroup([pxt.blocks.mkText(`enum ${e.name}`),pxt.blocks.mkBlock([s])]))}})),e.kinds.forEach((e=>{const n=t.getVariablesOfType("KIND_"+e.name);if(n&&n.length){const t=n.map((e=>e.name)).filter((t=>-1===e.initialMembers.indexOf(t)));t.length&&g.push(pxt.blocks.mkGroup([pxt.blocks.mkText(`namespace ${e.name}`),pxt.blocks.mkBlock(t.map((t=>pxt.blocks.mkStmt(pxt.blocks.mkText(`export const ${t} = ${e.name}.${e.createFunctionName}()`)))))]))}}));const y=e.allVariables.filter((e=>!e.alreadyDeclared)).map((e=>S(e,n)));return e.allVariables.filter((e=>e.alreadyDeclared===i.BlockDeclarationType.Implicit&&!e.isAssigned)).forEach((t=>{const n=(0,s.getConcreteType)(t.type);"string"===n.type||"number"===n.type||"boolean"===n.type||(0,a.isArrayType)(n.type)||e.diagnostics.push({blockId:t.firstReference&&t.firstReference.id,message:lf("Variable '{0}' is never assigned",t.name)})})),[g.concat(y.concat(h)),e.diagnostics]}catch(t){let n=t.block;if(!n)throw t;n.setWarningText(t+""),e.errors.push(n)}finally{e.placeholders={}}return[null,null]}(l,e,t);return E(l,u,h)},n.callKey=p,n.compileExpression=_;let I={ADD:"+",MINUS:"-",MULTIPLY:"*",DIVIDE:"/",LT:"<",LTE:"<=",GT:">",GTE:">=",AND:"&&",OR:"||",EQ:"==",NEQ:"!=",POWER:"**"};function A(e,t,n){const r=(0,o.escapeVarName)(t.getFieldValue("NAME"),e,!0);return pxt.blocks.mkStmt(pxt.blocks.mkText(r+"()"))}function w(e,t,n,r){const i=(0,o.escapeVarName)(t.getField("function_name").getText(),e,!0),s=!t.getInputsInline(),a=t.getArguments().map((e=>({actualName:e.name,definitionName:e.id}))).map((r=>O(e,t,r,n))),l=pxt.blocks.H.stdCall(i,a,s);return r?pxt.blocks.mkStmt(l):l}function N(e,t,n){const r=(0,o.getInputTargetBlock)(e,t,"RETURN_VALUE");return r&&"placeholder"!=r.type?pxt.blocks.mkStmt(pxt.blocks.mkText("return "),_(e,r,n)):pxt.blocks.mkStmt(pxt.blocks.mkText("return"))}function D(e,t,n){const r=e.stdCallTable[t.type];return r.imageLiteral?pxt.blocks.mkStmt(k(0,t,r.imageLiteral,r.imageLiteralColumns,r.imageLiteralRows,r.namespace,r.f,(0,o.visibleParams)(r,(0,o.countOptionals)(t,r)).map((r=>O(e,t,r,n))))):r.hasHandler?T(e,t,r,function(e,t){return(0,o.visibleParams)(e,(0,o.countOptionals)(t,e)).filter((e=>!!e.definitionName))}(r,t),r.namespace,n):pxt.blocks.mkStmt(R(e,t,r,n))}function O(e,t,n,i,a=!1){let l=t.getFieldValue(n.definitionName);if(null!=l){const i=t.getField(n.definitionName);if(i instanceof r.FieldTextInput||i instanceof u.FieldTextInput)return pxt.blocks.H.mkStringLiteral(l);if(i instanceof u.FieldTilemap&&!i.isGreyBlock){const t=pxt.react.getTilemapProject(),n=i.getValue();if(n.startsWith("tilemap`"))return pxt.blocks.mkText(n);if(e.options.emitTilemapLiterals)try{const e=pxt.sprite.decodeTilemap(n,"typescript",t);if(e){const[n]=t.createNewTilemapFromData(e);return pxt.blocks.mkText(`tilemap\`${n}\``)}}catch(e){}}const s=e.blocksInfo.apis.byQName[n.type];if(s&&s.attributes.emitAsConstant)for(const t of Object.keys(e.blocksInfo.apis.byQName)){const n=e.blocksInfo.apis.byQName[t];if(n&&n.attributes&&n.attributes.enumIdentity===l)return pxt.blocks.mkText(t)}let o=pxt.blocks.mkText(l);return o.canIndentInside="string"==typeof l&&l.indexOf("\n")>=0,o}{(0,s.attachPlaceholderIf)(e,t,n.definitionName);const r=(0,o.getInputTargetBlock)(e,t,n.definitionName);return a&&"lists_create_with"===r.type?y(_(e,r,i)):n.shadowOptions&&n.shadowOptions.toString&&!(0,s.isStringType)((0,s.returnType)(e,r))?pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),pxt.blocks.H.mkParenthesizedExpression(_(e,r,i))]):_(e,r,i)}}function R(e,t,n,r){let i;if((0,o.isMutatingBlock)(t)&&t.mutation.getMutationType()===l.MutatorTypes.RestParameterMutator)i=t.mutation.compileMutation(e,r).children;else{if("ENUM_GET"===n.attrs.shim){const e=n.attrs.enumName,r=t.getFieldValue("MEMBER").replace(/^\d+/,"");return pxt.blocks.H.mkPropertyAccess(r,pxt.blocks.mkText(e))}if("KIND_GET"===n.attrs.shim){const r=e.kinds.filter((e=>e.blockId===n.attrs.blockId))[0];return pxt.blocks.H.mkPropertyAccess(t.getFieldValue("MEMBER"),pxt.blocks.mkText(r.name))}i=(0,o.visibleParams)(n,(0,o.countOptionals)(t,n)).map(((i,s)=>O(e,t,i,r,n.isExtensionMethod&&0===s&&!n.isExpression)))}let s=n.namespace,a=n.f;if(n.attrs.blockAliasFor){const t=e.blocksInfo.apis.byQName[n.attrs.blockAliasFor];t&&(a=t.name,s=t.namespace)}const c=!t.getInputsInline();if(n.isIdentity)return i[0];if(n.property)return pxt.blocks.H.mkPropertyAccess(a,i[0]);if("@get@"==a)return pxt.blocks.H.mkPropertyAccess(i[1].op.replace(/.*\./,""),i[0]);if("@set@"==a)return pxt.blocks.H.mkAssign(pxt.blocks.H.mkPropertyAccess(i[1].op.replace(/.*\./,"").replace(/@set/,""),i[0]),i[2]);if("@change@"==a)return pxt.blocks.H.mkSimpleCall("+=",[pxt.blocks.H.mkPropertyAccess(i[1].op.replace(/.*\./,"").replace(/@set/,""),i[0]),i[2]]);if(n.isExtensionMethod){if(n.attrs.defaultInstance){let s;(0,o.isMutatingBlock)(t)&&t.mutation.getMutationType()===l.MutatorTypes.DefaultInstanceMutator&&(s=t.mutation.compileMutation(e,r)),s?i.unshift(s):i.unshift(pxt.blocks.mkText(n.attrs.defaultInstance))}return pxt.blocks.H.extensionCall(a,i,c)}return s?pxt.blocks.H.namespaceCall(s,a,i,c):pxt.blocks.H.stdCall(a,i,c)}function L(e){const t=e.getContent();return pxt.blocks.H.mkMultiComment(t.trim())}function P(e,t){return M(e,t)||"logic_boolean"===t.type||"text"===t.type}function M(e,t){if(!t)return!1;if("math_number"===t.type||"math_integer"===t.type||"math_number_minmax"===t.type||"math_whole_number"===t.type)return!0;const n=e.stdCallTable[t.type];if(!n)return!1;const{comp:r}=n;if("TD_ID"===n.attrs.shim&&1===r.parameters.length){const n=t.getFieldValue(r.parameters[0].definitionName);return n?!isNaN(parseInt(n)):M(e,(0,o.getInputTargetBlock)(e,t,r.parameters[0].definitionName))}return!1}function F(e){let t=e.getFieldValue("math_number_minmax"===e.type?"SLIDER":"NUM");const n=parseFloat(t);return function(e,t){isFinite(e)&&!isNaN(e)||function(e,t){let n=new Error(e);throw n.block=t,n}(lf("Number entered is either too large or too small"),t)}(n,e),n}function $(e,t){return pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t)}n.workerOpAsync=$},{"../fields":65,"../legacyMutations":70,"../toolbox":120,"./environment":13,"./typeChecker":14,"./util":15,"./variables":16,blockly:154}],13:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mkEnv=n.emptyEnv=n.BlockDeclarationType=n.Point=void 0;const r=e("./util");function i(e,t){return{workspace:e,options:t,stdCallTable:{},userFunctionReturnValues:{},diagnostics:[],errors:[],renames:{oldToNew:{},takenNames:{},oldToNewFunctions:{}},stats:{},enums:[],kinds:[],idToScope:{},blockDeclarations:{},allVariables:[],blocksInfo:null,placeholders:{}}}n.Point=class{constructor(e,t,n,r,i){this.link=e,this.type=t,this.parentType=n,this.childType=r,this.isArrayType=i}},function(e){e[e.None=0]="None",e[e.Argument=1]="Argument",e[e.Assigned=2]="Assigned",e[e.Implicit=3]="Implicit"}(n.BlockDeclarationType||(n.BlockDeclarationType={})),n.emptyEnv=i,n.mkEnv=function(e,t,n={}){let s=i(e,n);return s.blocksInfo=t,t&&(Object.keys(t.apis.byQName).forEach((e=>{const n=t.apis.byQName[e];!n.pkg||6!==n.kind&&3!==n.kind&&5!==n.kind&&4!==n.kind||(s.renames.takenNames[n.qName]=!0)})),t.enumsByName&&Object.keys(t.enumsByName).forEach((e=>s.enums.push(t.enumsByName[e]))),t.kindsByName&&Object.keys(t.kindsByName).forEach((e=>s.kinds.push(t.kindsByName[e]))),t.blocks.forEach((e=>{if(s.stdCallTable[e.attributes.blockId])return void pxt.reportError("blocks","function already defined",{details:e.attributes.blockId,qualifiedName:e.qName,packageName:e.pkg});s.renames.takenNames[e.namespace]=!0;const t=pxt.blocks.compileInfo(e),n=!!t.thisParameter;s.stdCallTable[e.attributes.blockId]={namespace:e.namespace,f:e.name,comp:t,attrs:e.attributes,isExtensionMethod:n,isExpression:e.retType&&"void"!==e.retType,imageLiteral:e.attributes.imageLiteral||e.attributes.gridLiteral,imageLiteralColumns:e.attributes.imageLiteralColumns,imageLiteralRows:e.attributes.imageLiteralRows,hasHandler:pxt.blocks.hasHandler(e),property:!e.parameters,isIdentity:"TD_ID"==e.attributes.shim}})),e.getTopBlocks(!1).filter(r.isFunctionDefinition).forEach((e=>{const t="procedures_defnoreturn"===e.type?e.getFieldValue("NAME"):e.getField("function_name").getText();(0,r.escapeVarName)(t,s,!0)}))),s}},{"./util":15}],14:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isBooleanType=n.isStringType=n.defaultValueForType=n.getEscapedCBParameters=n.isFunctionRecursive=n.getDeclaredVariables=n.lookup=n.getConcreteType=n.attachPlaceholderIf=n.returnType=n.find=n.mkPoint=n.infer=void 0;const r=e("./environment"),i=e("./util"),s=e("../plugins/functions");function o(e,t){let n=f(e),r=f(t);if(I(null==n.link&&null==r.link),n==r)return;if(m(n))return void y(e.type,t.type);if(m(r))return y(e.type,t.type),e.type=null,e.link=r,n.link=r,void(n.isArrayType=r.isArrayType);if(n.childType&&r.childType){const e=n.childType;n.childType=null,o(e,r.childType)}else n.childType&&!r.childType&&(r.childType=n.childType);if(n.parentType&&r.parentType){const e=n.parentType;n.parentType=null,o(e,r.parentType)}else!n.parentType||r.parentType||r.type||(r.parentType=n.parentType);let i=y(n.type,r.type);e.link=r,n.link=r,n.isArrayType=r.isArrayType,e.type=null,t.type=i}function a(e,t,n,r){v(e,t,n);try{o(_(e,(0,i.getInputTargetBlock)(e,t,n)),r)}catch(e){}}function l(e,t=!1){return new r.Point(null,e,null,null,t)}n.infer=function(e,t,n){function r(e){var t,n;const r=null===(n=null===(t=e.connection)||void 0===t?void 0:t.getCheck())||void 0===n?void 0:n[0];return e.name?r||"T":void 0}function s(e,n){let s=e.inputList.filter((e=>"T"===r(e)));if(s.length){const r=(0,i.getInputTargetBlock)(t,e,s[0].name);if(r){const i=_(t,r),s=i.type?h(_(t,r).type+"[]"):h(null);return T(s,i),a(t,e,n,s),!0}}return!1}e&&e.filter((e=>e.isEnabled())).forEach((e=>{try{switch(e.type){case"math_op2":a(t,e,"x",h(c.type)),a(t,e,"y",h(c.type));break;case"math_op3":a(t,e,"x",h(c.type));break;case"math_arithmetic":case"logic_compare":switch(e.getFieldValue("OP")){case"ADD":case"MINUS":case"MULTIPLY":case"DIVIDE":case"LT":case"LTE":case"GT":case"GTE":case"POWER":a(t,e,"A",h(c.type)),a(t,e,"B",h(c.type));break;case"AND":case"OR":v(t,e,"A",u.type),v(t,e,"B",u.type);break;case"EQ":case"NEQ":v(t,e,"A"),v(t,e,"B");let n=_(t,(0,i.getInputTargetBlock)(t,e,"A")),r=_(t,(0,i.getInputTargetBlock)(t,e,"B"));try{o(n,r)}catch(e){}}break;case"logic_operation":v(t,e,"A",u.type),v(t,e,"B",u.type);break;case"logic_negate":v(t,e,"BOOL",u.type);break;case"controls_if":for(let n=0;n<=e.elseifCount_;++n)v(t,e,"IF"+n,u.type);break;case"pxt_controls_for":case"controls_simple_for":a(t,e,"TO",h(c.type));break;case"pxt_controls_for_of":case"controls_for_of":T(_(t,(0,i.getInputTargetBlock)(t,e,"LIST")),E(t,e,(0,i.getLoopVariableField)(t,e).getField("VAR").getText()).type);break;case"variables_set":case"variables_change":let n=E(t,e,e.getField("VAR").getText()).type;v(t,e,"VALUE");let l=(0,i.getInputTargetBlock)(t,e,"VALUE");if(l){let r=function(e,t){var n;const r=null===(n=t.outputConnection)||void 0===n?void 0:n.getCheck();return(null==r?void 0:r.length)&&"Array"!==r[0]&&"T"!==r[0]?r.map((e=>h(e))):[_(e,t)]}(t,l);const i=f(n);if(i.type&&r.slice(1).some((e=>e.type===i.type)))n.link=f(r[0]);else try{o(n,r[0])}catch(e){}}break;case"controls_repeat_ext":a(t,e,"TIMES",h(c.type));break;case"device_while":v(t,e,"COND",u.type);break;case"lists_index_get":a(t,e,"LIST",h("Array")),a(t,e,"INDEX",h(c.type)),T(_(t,(0,i.getInputTargetBlock)(t,e,"LIST")),_(t,e));break;case"lists_index_set":a(t,e,"LIST",h("Array")),v(t,e,"VALUE"),s(e,"LIST"),a(t,e,"INDEX",h(c.type));break;case"function_definition":g(t,e.getField("function_name").getText());break;case"function_call":case"function_call_output":e.getArguments().forEach((n=>{a(t,e,n.id,h(n.type))}));break;case pxtc.TS_RETURN_STATEMENT_TYPE:v(t,e,"RETURN_VALUE");break;case pxtc.PAUSE_UNTIL_TYPE:a(t,e,"PREDICATE",u);break;default:if(e.type in t.stdCallTable){const n=t.stdCallTable[e.type];if("ENUM_GET"===n.attrs.shim||"KIND_GET"===n.attrs.shim)return;(0,i.visibleParams)(n,(0,i.countOptionals)(e,n)).forEach(((i,o)=>{var l;const c=n.isExtensionMethod&&0===o;if(i.definitionName&&!e.getFieldValue(i.definitionName)){let n=e.inputList.find((e=>e.name==i.definitionName));const o=null===(l=null==n?void 0:n.connection)||void 0===l?void 0:l.getCheck();if(o){if(c&&"Array"===r(n)&&s(e,i.definitionName))return;for(let n=0;n<o.length;n++)try{let r=o[n];a(t,e,i.definitionName,h(r));break}catch(e){}}}}))}}}catch(n){const r=n.block||e;r.setWarningText(n+""),t.errors.push(r)}})),t.allVariables.forEach((e=>{null==k(e.type).type&&(e.isFunctionParameter?e.type.isArrayType&&(e.type.type="any[]"):o(e.type,h(e.type.isArrayType?"number[]":c.type)))}))},n.mkPoint=l;const c=l("number"),u=l("boolean"),d=l("string"),p=l("void");function h(e){if(!e)return l(e);switch(e.toLowerCase()){case"number":return c;case"boolean":return u;case"string":return d;case"void":return p;default:return l(e)}}function f(e){return e.link?f(e.link):e}function m(e){return e===c||e===u||e===d||e===p}function _(e,t){var n,r;if(I(null!=t),function(e){return"placeholder"==e.type||e.type===pxtc.TS_OUTPUT_TYPE}(t))return t.p||(t.p=l(null)),f(t.p);if("variables_get"==t.type)return f(E(e,t,t.getField("VAR").getText()).type);if("function_call_output"==t.type)return function(e,t){return g(e,t.getField("function_name").getText())}(e,t);if(!t.outputConnection)return h(p.type);const i=(null===(r=null===(n=t.outputConnection)||void 0===n?void 0:n.getCheck())||void 0===r?void 0:r[0])||"T";if("Array"===i){const n=t.outputConnection.getCheck();if(n.length>1)return h(n[1]);let r;if("lists_create_with"==t.type){if(t.inputList&&t.inputList.length)for(const n of t.inputList)if(n.connection&&n.connection.targetBlock()){let t=f(_(e,n.connection.targetBlock()));if(t){if(t.parentType)return t.parentType;T(r=t.type?h(t.type+"[]"):l(null),t);break}}}else"argument_reporter_array"==t.type&&(r||(r=E(e,t,t.getFieldValue("VALUE")).type));return r&&(r.isArrayType=!0),r||l(null,!0)}if("T"===i){const n=e.stdCallTable[t.type],r="lists_index_get"===t.type;if(r||n&&n.comp.thisParameter){let i;if((i=r?t.inputList.find((e=>"LIST"===e.name)):t.inputList.find((e=>e.name===n.comp.thisParameter.definitionName))).connection&&i.connection.targetBlock()){const t=_(e,i.connection.targetBlock());if(t.childType)return t.childType;const n=b(t.type)&&"Array"!==t.type?l(t.type.substr(0,t.type.length-2)):l(null);return T(t,n),n}}return l(null)}return h(i)}function g(e,t){if(!e.userFunctionReturnValues[t]){const n=(0,s.getDefinition)(t,e.workspace);let r=l("void");if(S(e,n,!0))r=l("any");else{const s=[];for(const t of n.getDescendants(!1))"function_return"===t.type&&(v(e,t,"RETURN_VALUE"),s.push(_(e,(0,i.getInputTargetBlock)(e,t,"RETURN_VALUE"))));if(s.length)try{const e=l(null);for(const t of s)o(e,t);r=e}catch(i){e.diagnostics.push({blockId:n.id,message:pxt.Util.lf("Function '{0}' has an invalid return type",t)}),r=l("any")}}e.userFunctionReturnValues[t]=r}return e.userFunctionReturnValues[t]}function y(e,t){if(null==e||"Array"===e&&b(t))return t;if(null==t||"Array"===t&&b(e))return e;if(e==t)return e;throw new Error("cannot mix "+e+" with "+t)}function b(e){return e&&(-1!==e.indexOf("[]")||"Array"==e)}function v(e,t,n,r){const i=t.getInputTargetBlock(n);i?i.type!==pxtc.TS_OUTPUT_TYPE||i.p||(i.p=l(null)):(e.placeholders[t.id]||(e.placeholders[t.id]={}),e.placeholders[t.id][n]||(e.placeholders[t.id][n]=function(e,t,n){return{type:"placeholder",p:l(n||null),workspace:e.workspace,parentBlock_:t,getParent:()=>t}}(e,t,r)))}function T(e,t){const n=f(e),r=f(t);n.childType?o(n.childType,r):n.type||(n.childType=r),r.parentType?o(r.parentType,n):r.type||(r.parentType=n),b(n.type)&&(n.isArrayType=!0)}function k(e,t=[]){const n=f(e);if(-1===t.indexOf(n)&&(t.push(n),!n.type||"Array"===n.type)){if(n.parentType){const e=k(n.parentType,t);if(e.type&&"Array"!==e.type)return b(e.type)?n.type=e.type.substr(0,e.type.length-2):n.type=e.type,n}if(n.childType){const e=k(n.childType,t);if(e.type)return n.type=e.type+"[]",n}}return n}function E(e,t,n){return x(n,e.idToScope[t.id])}function x(e,t){return t&&t.declaredVars[e]?t.declaredVars[e]:t&&t.parent?x(e,t.parent):null}function S(e,t,n){const r=(0,i.getFunctionName)(t),o={};return function t(a){let l;l=n?a.getDescendants(!1).filter((e=>"function_return"==e.type)).map((t=>(0,i.getInputTargetBlock)(e,t,"RETURN_VALUE"))).filter((e=>e&&"function_call_output"===e.type)):a.getDescendants(!1).filter((e=>"function_call_output"==e.type));for(const e of l){const n=(0,i.getFunctionName)(e);if(n===r)return!0;if(!o[n]&&(o[n]=!0,t((0,s.getDefinition)(n,e.workspace))))return!0}return!1}(t)}function C(e,t,n){let r=[];if(t.attrs.draggableParameters)for(let s=0;s<t.comp.handlerArgs.length;s++){const o=t.comp.handlerArgs[s];let a;const c=(0,i.getInputTargetBlock)(n,e,"HANDLER_DRAG_PARAM_"+o.name);if(null===(a="reporter"===t.attrs.draggableParameters?c&&c.getFieldValue("VALUE"):c&&c.getField("VAR").getText()))break;r.push({name:a,type:l(o.type)})}else for(let n=0;n<t.comp.handlerArgs.length;n++){const i=t.comp.handlerArgs[n],s=e.getField("HANDLER_"+i.name),o=s&&s.getText();if(null===o)break;r.push({name:o,type:l(i.type)})}return r}function I(e){if(!e)throw new Error("Assertion failure")}n.find=f,n.returnType=_,n.attachPlaceholderIf=v,n.getConcreteType=k,n.lookup=E,n.getDeclaredVariables=function(e,t){switch(e.type){case"pxt_controls_for":case"controls_simple_for":return[{name:(0,i.getLoopVariableField)(t,e).getField("VAR").getText(),type:c}];case"pxt_controls_for_of":case"controls_for_of":return[{name:(0,i.getLoopVariableField)(t,e).getField("VAR").getText(),type:l(null)}];case"function_definition":return e.getArguments().filter((e=>"Array"===e.type)).map((e=>{const t=l(null);return t.isArrayType=!0,{name:e.name,type:t,isFunctionParameter:!0}}))}if((0,i.isMutatingBlock)(e)){const t=e.mutation.getDeclaredVariables();if(t)return Object.keys(t).map((e=>({name:e,type:l(t[e])})))}let n=t.stdCallTable[e.type];return n&&n.comp.handlerArgs.length?C(e,n,t):[]},n.isFunctionRecursive=S,n.getEscapedCBParameters=function(e,t,n){return C(e,t,n).map((t=>E(n,e,t.name).escapedName))},n.defaultValueForType=function(e){if(null==e.type&&(o(e,h(c.type)),e=f(e)),b(e.type)||e.isArrayType)return pxt.blocks.mkText("[]");switch(e.type){case"boolean":return pxt.blocks.H.mkBooleanLiteral(!1);case"number":return pxt.blocks.H.mkNumberLiteral(0);case"string":return pxt.blocks.H.mkStringLiteral("");default:return pxt.blocks.mkText("null")}},n.isStringType=function(e){return e===d},n.isBooleanType=function(e){return e===u}},{"../plugins/functions":93,"./environment":13,"./util":15}],15:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isFunctionDefinition=n.append=n.escapeVarName=n.isMutatingBlock=n.getInputTargetBlock=n.countOptionals=n.visibleParams=n.getFunctionName=n.getLoopVariableField=n.printScope=n.forEachStatementInput=n.forEachChildExpression=void 0;const r=e("blockly");function i(e){let t="";for(let n=0;n<e;n++)t+="    ";return t}function s(e,t,n){var r;return t.getInputTargetBlock(n)||(null===(r=e.placeholders[t.id])||void 0===r?void 0:r[n])}n.forEachChildExpression=function e(t,n,i=!1){t.inputList.filter((e=>e.type===r.inputTypes.VALUE)).forEach((t=>{t.connection&&t.connection.targetBlock()&&(n(t.connection.targetBlock()),i&&e(t.connection.targetBlock(),n,i))}))},n.forEachStatementInput=function(e,t){e.inputList.filter((e=>e.type===r.inputTypes.STATEMENT)).forEach((e=>{e.connection&&e.connection.targetBlock()&&t(e.connection.targetBlock())}))},n.printScope=function e(t,n=0){const r=Object.keys(t.declaredVars).map((e=>`${e}(${t.declaredVars[e].id})`)).join(",");t.referencedVars.join(", "),console.log(`${i(n)}SCOPE: ${t.firstStatement?t.firstStatement.type:"TOP-LEVEL"}`),r.length&&console.log(`${i(n)}DECS: ${r}`),t.children.forEach((t=>e(t,n+1)))},n.getLoopVariableField=function(e,t){return"pxt_controls_for"==t.type||"pxt_controls_for_of"==t.type?s(e,t,"VAR"):t},n.getFunctionName=function(e){return e.getField("function_name").getText()},n.visibleParams=function({comp:e},t){const n=[];return e.thisParameter&&n.push(e.thisParameter),e.parameters.forEach((e=>{e.isOptional&&t>0?(n.push(e),--t):e.isOptional||n.push(e)})),n},n.countOptionals=function(e,t){if(t.attrs.compileHiddenArguments)return t.comp.parameters.reduce(((e,t)=>(t.isOptional&&e++,e)),0);if(e.mutationToDom){const t=e.mutationToDom();if(t.hasAttribute("_expanded")){const e=parseInt(t.getAttribute("_expanded"));return isNaN(e)?0:Math.max(e,0)}}return 0},n.getInputTargetBlock=s,n.isMutatingBlock=function(e){return!!e.mutation},n.escapeVarName=function(e,t,n=!1){if(!e)return"_";if(n){if(t.renames.oldToNewFunctions[e])return t.renames.oldToNewFunctions[e]}else if(t.renames.oldToNew[e])return t.renames.oldToNew[e];let r=ts.pxtc.escapeIdentifier(e);if(t.renames.takenNames[r]){let e=2;for(;t.renames.takenNames[r+e];)e++;r+=e}return n?(t.renames.oldToNewFunctions[e]=r,t.renames.takenNames[r]=!0):t.renames.oldToNew[e]=r,r},n.append=function(e,t){e.push.apply(e,t)},n.isFunctionDefinition=function(e){return"procedures_defnoreturn"===e.type||"function_definition"===e.type}},{blockly:154}],16:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.trackAllVariables=void 0;const r=e("blockly"),i=e("./environment"),s=e("./typeChecker"),o=e("./util");function a(e,t){const n=Object.keys(e.declaredVars);if(n.length){const r=n.map((t=>e.declaredVars[t]));e.firstStatement&&(t.blockDeclarations[e.firstStatement.id]=r.concat(t.blockDeclarations[e.firstStatement.id]||[])),r.forEach((e=>t.allVariables.push(e)))}e.children.forEach((e=>a(e,t)))}function l(e,t){let n;if(-1!==e.referencedVars.indexOf(t))return e;for(const r of e.children)if(c(r,t)){if(u(r,t))return e;if(n)return e;n=r}return n?l(n,t):void 0}function c(e,t){if(-1!==e.referencedVars.indexOf(t))return!0;for(const n of e.children)if(c(n,t))return!0;return!1}function u(e,t){if(-1!==e.assignedVars.indexOf(t))return!0;for(const n of e.children)if(u(n,t))return!0;return!1}function d(e,t){for(const t of Object.keys(e.declaredVars)){const r=e.declaredVars[t];r.escapedName||(r.escapedName=n(t))}function n(n){if(!n)return"_";let i=ts.pxtc.escapeIdentifier(n);if(t.renames.takenNames[i]||r(i,e,n)){let s=2;for(;t.renames.takenNames[i+s]||r(i+s,e,n);)s++;i+=s}return i}function r(e,t,n){if(t){for(const r of Object.keys(t.declaredVars)){const i=t.declaredVars[r];if((n!==i.name||i.name!==i.escapedName)&&i.escapedName===e)return!0}return r(e,t.parent,n)}return!1}e.children.forEach((e=>d(e,t)))}n.trackAllVariables=function(e,t){let n,c=1;return e.forEach((e=>{if(e.type===ts.pxtc.ON_START_TYPE){const r=e.getInputTargetBlock("HANDLER");r&&u(r,n={firstStatement:r,declaredVars:{},referencedVars:[],children:[],assignedVars:[]},t)}})),n||(n={firstStatement:null,declaredVars:{},referencedVars:[],children:[],assignedVars:[]}),e.forEach((e=>{e.type!==ts.pxtc.ON_START_TYPE&&u(e,n,t)})),Object.keys(n.declaredVars).forEach((e=>{const t=n.declaredVars[e];delete n.declaredVars[e],(l(n,t.id)||n).declaredVars[e]=t})),a(n,t),d(n,t),n;function u(e,t,n){if(n.idToScope[e.id]=t,"variables_get"===e.type){const n=p(e.getField("VAR").getText(),t);t.referencedVars.push(n.id)}else if("variables_set"===e.type||"variables_change"===e.type){const n=p(e.getField("VAR").getText(),t);t.assignedVars.push(n.id),t.referencedVars.push(n.id)}else if(e.type===pxtc.TS_STATEMENT_TYPE){const n=e.declaredVariables;n&&n.split(",").forEach((e=>{p(e,t).alreadyDeclared=i.BlockDeclarationType.Argument}))}if(function(e){return e.inputList.some((e=>e.type===r.inputTypes.STATEMENT))}(e)){const r=(0,s.getDeclaredVariables)(e,n).map((e=>Object.assign(Object.assign({},e),{id:c++})));let a=t;r.length&&(a={parent:t,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]},r.forEach((e=>{e.alreadyDeclared=i.BlockDeclarationType.Assigned,a.declaredVars[e.name]=e})),n.idToScope[e.id]=a),t!==a&&t.children.push(a),(0,o.forEachChildExpression)(e,(e=>{u(e,a,n)})),(0,o.forEachStatementInput)(e,(e=>{const t={parent:a,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]};a.children.push(t),u(e,t,n)}))}else(0,o.forEachChildExpression)(e,(e=>{u(e,t,n)}));e.nextConnection&&e.nextConnection.targetBlock()&&u(e.nextConnection.targetBlock(),t,n)}function p(e,t){return t.declaredVars[e]?t.declaredVars[e]:t.parent?p(e,t.parent):(t.declaredVars[e]={name:e,type:(0,s.mkPoint)(null),id:c++},t.declaredVars[e])}}},{"./environment":13,"./typeChecker":14,"./util":15,blockly:154}],17:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.initExpandableBlock=n.initVariableArgsBlock=n.appendMutation=void 0;const r=e("blockly"),i=e("./toolbox"),s=e("./constants"),o=e("./fields"),a=e("./loader");function l(e,t){const n=e,r=n.mutationToDom,i=n.domToMutation;n.mutationToDom=()=>{const e=r?r():document.createElement("mutation");return t.mutationToDom(e)},n.domToMutation=e=>{i&&i(e),t.domToMutation(e)}}n.appendMutation=l,n.initVariableArgsBlock=function(e,t){let n=0,i=0,s=e.appendDummyInput(),c=()=>{if(n!==i){if(n>i){const r=n-i;for(let n=0;n<r;n++){const r=t[i+n];s.insertFieldAt(s.fieldRow.length-1,new o.FieldArgumentVariable(r.name),"HANDLER_"+r.name);const a=e;(null==a?void 0:a.initSvg)&&a.initSvg()}}else{let e=i-n;for(let n=0;n<e;n++){const e=t[i-n-1];s.removeField("HANDLER_"+e.name)}}n>=t.length?s.removeField("_HANDLER_ADD"):i>=t.length&&u(),i=n}};function u(){s.appendField(new r.FieldImage(e.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),(()=>{n=Math.min(n+1,t.length),c()}),!1),"_HANDLER_ADD")}r.Extensions.apply("inline-svgs",e,!1),u(),l(e,{mutationToDom:r=>{r.setAttribute("numArgs",n.toString());for(let i=0;i<n;i++){const n=e.getField("HANDLER_"+t[i].name);let s=n&&n.getText();r.setAttribute("arg"+i,s)}return r},domToMutation:r=>{let i=parseInt(r.getAttribute("numargs"));n=Math.min(isNaN(i)?0:i,t.length),c();for(let i=0;i<n;i++){const n=r.getAttribute("arg"+i),s="HANDLER_"+t[i].name;e.getField(s)&&(0,a.setVarFieldValue)(e,s,n)}}})},n.initExpandableBlock=function(e,t,n,o,a,u){const d="0_add_button",p="0_rem_button",h="0_add_rem_button",f="_expanded",m="_input_init",_=n.parameters.map((e=>e.name)),g=n.parameters.length,y=a?g:1,b="variable"===e.blocksById[t.type].attributes.inlineInputMode,v=e.blocksById[t.type].attributes.inlineInputModeLimit||4,T=e.blocksById[t.type].attributes.compileHiddenArguments,k=e.blocksById[t.type].attributes.expandableArgumentBreaks;let E;k&&(E=k.split(/[;,]/).map((e=>parseInt(e))));const x=new c(t);x.setEventsEnabled(!1),x.setValue(f,0),x.setValue(m,!1),x.setEventsEnabled(!0),r.Extensions.apply("inline-svgs",t,!1);let S=!1,C=!0;if(l(t,{mutationToDom:e=>(e.setAttribute(f,x.getString(f)),e.setAttribute(m,x.getString(m)),e),domToMutation:e=>{if(x.setEventsEnabled(!1),e.hasAttribute(m)&&"true"==e.getAttribute(m)&&!x.getBoolean(m)&&x.setValue(m,!0),D(),e.hasAttribute(f)){const n=parseInt(e.getAttribute(f));if(!isNaN(n)){const e=n-(x.getNumber(f)||0);x.getBoolean(m)?t.rendered||t.isInsertionMarker()?A(e,!0,t.isInsertionMarker()):(x.setValue(f,O(e)),N()):A(e,!0)}}x.setEventsEnabled(!0)}}),D(),T){let e=0;for(let r=0;r<t.inputList.length;r++){const i=t.inputList[r];(pxt.Util.startsWith(i.name,s.optionalInputWithFieldPrefix)||-1!==_.indexOf(i.name))&&(!i.connection||i.connection.isConnected()||t.isInsertionMarker()||L(i,o.definitionNameToParam[n.parameters[e].name]),++e)}}const I={updateBeforeRender:()=>{S||C&&(C=!1,S=!0,A(0,void 0,!0),S=!1)}};function A(e,r=!1,i=!1){const a=O(e);if(!i&&!r&&a===x.getNumber(f))return;x.setValue(f,a);const l=a;if(!x.getBoolean(m)&&l>0&&(D(),!t.rendered))return;let c=0;for(let e=0;e<t.inputList.length;e++){const r=t.inputList[e];if(pxt.Util.startsWith(r.name,s.optionalDummyInputPrefix))R(r,c<l||l===g);else if(pxt.Util.startsWith(r.name,s.optionalInputWithFieldPrefix)||-1!==_.indexOf(r.name)){const e=c<l;R(r,e),e&&r.connection&&!r.connection.isConnected()&&!t.isInsertionMarker()&&L(r,o.definitionNameToParam[n.parameters[c].name]),++c}}N(),b&&t.setInputsInline(l<v),r||t.render()}function w(e,n,i,s){t.appendDummyInput(e).appendField(new r.FieldImage(n,24,24,i,(()=>A(s)),!1))}function N(){if(S)return;const e=x.getNumber(f),n=e!==g,i=0!==e;t.inputList.some((e=>e.name===d))&&t.removeInput(d,!0),t.inputList.some((e=>e.name===p))&&t.removeInput(p,!0),t.inputList.some((e=>e.name===h))&&t.removeInput(h,!0),n&&i?t.appendDummyInput(h).appendField(new r.FieldImage(t.REMOVE_IMAGE_DATAURI,24,24,lf("Hide optional arguments"),(()=>A(-1*y)),!1)).appendField(new r.FieldImage(t.ADD_IMAGE_DATAURI,24,24,lf("Reveal optional arguments"),(()=>A(y)),!1)):n?w(d,t.ADD_IMAGE_DATAURI,lf("Reveal optional arguments"),y):i&&w(p,t.REMOVE_IMAGE_DATAURI,lf("Hide optional arguments"),-1*y)}function D(){x.setValue(m,!0),u(),N()}function O(e){const t=Math.min(Math.max(x.getNumber(f)+e,0),g);if(E){if(e>=0){if(0===t)return 0;for(const e of E)if(e>=t)return e;return g}for(let e=0;e<E.length;e++)if(E[e]>=t)return e>0?E[e-1]:0;return E[E.length-1]}return t}function R(e,t){e.setVisible(t)}function L(n,s){let o=(0,i.createShadowValue)(e,s);"value"===o.tagName.toLowerCase()&&(o=o.firstElementChild),r.Events.disable();try{const e=r.Xml.domToBlock(o,t.workspace);e&&n.connection.connect(e.outputConnection)}catch(e){}r.Events.enable()}t.mixin(I)};class c{constructor(e,t){this.block=e,this.fireEvents=!0,this.state=t||{}}setValue(e,t){if(this.fireEvents&&this.block.mutationToDom){const n=this.block.mutationToDom();this.state[e]=t.toString();const i=this.block.mutationToDom();Object.keys(this.state).forEach((e=>{n.getAttribute(e)!==this.state[e]&&i.setAttribute(e,this.state[e])}));const s=r.Xml.domToText(n),o=r.Xml.domToText(i);s!=o&&r.Events.fire(new r.Events.BlockChange(this.block,"mutation",null,s,o))}else this.state[e]=t.toString()}getNumber(e){return parseInt(this.state[e])}getBoolean(e){return"false"!=this.state[e]}getString(e){return this.state[e]}setEventsEnabled(e){this.fireEvents=e}}},{"./constants":18,"./fields":65,"./loader":71,"./toolbox":120,blockly:154}],18:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.optionalInputWithFieldPrefix=n.optionalDummyInputPrefix=n.provider=void 0;const r=e("blockly");n.provider=new r.zelos.ConstantProvider,n.optionalDummyInputPrefix="0_optional_dummy",n.optionalInputWithFieldPrefix="0_optional_field"},{blockly:154}],19:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.registerBlockitems=void 0;const r=e("blockly"),i=e("../external");var s;!function(e){e[e.Duplicate=10]="Duplicate",e[e.AddComment=20]="AddComment",e[e.ExpandCollapse=30]="ExpandCollapse",e[e.DeleteBlock=40]="DeleteBlock",e[e.Help=50]="Help"}(s||(s={})),n.registerBlockitems=function(){(function(){const e={displayText:e=>e.block.isCollapsed()?pxt.U.lf("Expand Block"):pxt.U.lf("Collapse Block"),preconditionFn(e){const t=e.block;return t.workspace.getTopBlocks(!1).some((e=>e===t))&&t.statementInputCount>0&&!t.previousConnection&&!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block&&(pxt.tickEvent("blocks.context.expandCollapseBlock",void 0,{interactiveConsent:!0}),e.block.setCollapsed(!e.block.isCollapsed()))},scopeType:r.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtExpandCollapseBlock",weight:s.ExpandCollapse};r.ContextMenuRegistry.registry.register(e)})(),function(){const e={displayText:()=>pxt.U.lf("Help"),preconditionFn(e){const t=e.block;return("function"==typeof t.helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback(e){if(!e.block)return;const t=e.block,n="function"==typeof t.helpUrl?t.helpUrl():t.helpUrl;n&&(0,i.openHelpUrl)(n)},scopeType:r.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtHelpBlock",weight:s.Help};r.ContextMenuRegistry.registry.register(e)}(),r.ContextMenuRegistry.registry.getItem("blockDelete").weight=s.DeleteBlock,r.ContextMenuRegistry.registry.getItem("blockComment").weight=s.AddComment,r.ContextMenuRegistry.registry.getItem("blockDuplicate").weight=s.Duplicate,r.ContextMenuRegistry.registry.unregister("blockCollapseExpand"),r.ContextMenuRegistry.registry.unregister("blockHelp"),r.ContextMenuRegistry.registry.unregister("blockInline")}},{"../external":24,blockly:154}],20:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setupWorkspaceContextMenu=n.initContextMenu=void 0;const r=e("blockly"),i=e("./workspaceItems"),s=e("../external"),o=e("./blockItems");n.initContextMenu=function(){const e=r.Msg;e.DUPLICATE_BLOCK=lf("{id:block}Duplicate"),e.DUPLICATE_COMMENT=lf("Duplicate Comment"),e.REMOVE_COMMENT=lf("Remove Comment"),e.ADD_COMMENT=lf("Add Comment"),e.EXTERNAL_INPUTS=lf("External Inputs"),e.INLINE_INPUTS=lf("Inline Inputs"),e.EXPAND_BLOCK=lf("Expand Block"),e.COLLAPSE_BLOCK=lf("Collapse Block"),e.ENABLE_BLOCK=lf("Enable Block"),e.DISABLE_BLOCK=lf("Disable Block"),e.DELETE_BLOCK=lf("Delete Block"),e.DELETE_X_BLOCKS=lf("Delete Blocks"),e.DELETE_ALL_BLOCKS=lf("Delete All Blocks"),e.HELP=lf("Help"),(0,i.registerWorkspaceItems)(),(0,o.registerBlockitems)()},n.setupWorkspaceContextMenu=function(e){e.configureContextMenu=(t,n)=>{e.options.comments&&!e.options.readOnly&&t.unshift(r.ContextMenu.workspaceCommentOption(e,n)),(0,s.onWorkspaceContextMenu)(e,t)}}},{"../external":24,"./blockItems":19,"./workspaceItems":22,blockly:154}],21:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./contextMenu"),n)},{"./contextMenu":20}],22:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.registerWorkspaceItems=void 0;const r=e("blockly"),i=e("../layout");var s;!function(e){e[e.DeleteAll=20]="DeleteAll",e[e.FormatCode=30]="FormatCode",e[e.CollapseBlocks=40]="CollapseBlocks",e[e.ExpandBlocks=50]="ExpandBlocks",e[e.Snapshot=60]="Snapshot"}(s||(s={})),n.registerWorkspaceItems=function(){(function(){const e={displayText:()=>pxt.U.lf("Format Code"),preconditionFn:e=>e.workspace.options.readOnly?"hidden":"enabled",callback(e){e.workspace&&(pxt.tickEvent("blocks.context.format",void 0,{interactiveConsent:!0}),(0,i.flow)(e.workspace,{useViewWidth:!0}))},scopeType:r.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtFormatCode",weight:s.FormatCode};r.ContextMenuRegistry.registry.register(e)})(),function(){const e={displayText:()=>pxt.U.lf("Snapshot"),preconditionFn(e){if(!(0,i.screenshotEnabled)())return"hidden";const t=e.workspace,n=t.getTopBlocks(!1),r=t.getTopComments(!1);return 0===n.length&&0===r.length?"disabled":"enabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.screenshot",void 0,{interactiveConsent:!0}),(async()=>{var t;let n=await(0,i.screenshotAsync)(e.workspace,null,null===(t=pxt.appTarget.appTheme)||void 0===t?void 0:t.embedBlocksInSnapshot);pxt.BrowserUtils.isSafari()&&(n=n.replace(/^data:image\/[^;]/,"data:application/octet-stream")),pxt.BrowserUtils.browserDownloadDataUri(n,`${pxt.appTarget.nickname||pxt.appTarget.id}-${lf("screenshot")}.png`)})())},scopeType:r.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtSnapshotCode",weight:s.Snapshot};r.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:()=>pxt.U.lf("Collapse Blocks"),preconditionFn(e){const t=e.workspace;return t.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing?"hidden":t.getTopBlocks(!1).some((e=>e.isEnabled()&&!e.isCollapsed()))?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.collapse",void 0,{interactiveConsent:!0}),(0,i.setCollapsedAll)(e.workspace,!0))},scopeType:r.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtCollapseBlocks",weight:s.CollapseBlocks};r.ContextMenuRegistry.registry.register(e)}(),function(){const e={displayText:()=>pxt.U.lf("Expand Blocks"),preconditionFn(e){const t=e.workspace;return t.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing?"hidden":t.getTopBlocks(!1).some((e=>e.isEnabled()&&e.isCollapsed()))?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.expand",void 0,{interactiveConsent:!0}),(0,i.setCollapsedAll)(e.workspace,!1))},scopeType:r.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtExpandBlocks",weight:s.ExpandBlocks};r.ContextMenuRegistry.registry.register(e)}(),function(){const e=e=>{const t=[],n=e=>{if(e.isDeletable())t.push(...e.getDescendants(!1));else for(const t of e.getChildren(!1))n(t)};for(const t of e.getTopBlocks())n(t);return t},t={displayText:t=>e(t.workspace).filter((e=>!e.isShadow())).length>1?pxt.U.lf("Delete All Blocks"):pxt.U.lf("Delete Block"),preconditionFn:t=>t.workspace.options.readOnly?"hidden":0===e(t.workspace).filter((e=>!e.isShadow())).length?"disabled":"enabled",callback(t){if(!t.workspace)return;const n=e(t.workspace),i=n.filter((e=>!e.isShadow())).length,s=()=>{let e=r.utils.idGenerator.genUid();r.Events.setGroup(e);let t=n.shift();t&&(t.workspace?(t.dispose(!1,!0),setTimeout(s,10)):s()),r.Events.setGroup(!1)};pxt.tickEvent("blocks.context.delete",void 0,{interactiveConsent:!0}),i<2?s():r.dialog.confirm(lf("Delete all {0} blocks?",i),(e=>{e&&s()}))},scopeType:r.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtDeleteAllBlocks",weight:s.DeleteAll};r.ContextMenuRegistry.registry.register(t)}(),r.ContextMenuRegistry.registry.unregister("workspaceDelete"),r.ContextMenuRegistry.registry.unregister("expandWorkspace"),r.ContextMenuRegistry.registry.unregister("collapseWorkspace"),r.ContextMenuRegistry.registry.unregister("cleanWorkspace"),r.ContextMenuRegistry.registry.unregister("redoWorkspace"),r.ContextMenuRegistry.registry.unregister("undoWorkspace")}},{"../layout":69,blockly:154}],23:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decompiledDiffAsync=n.mergeXml=n.diffXml=n.needsDecompiledDiff=void 0;const r=e("blockly"),i=e("./importer"),s=e("./render");n.needsDecompiledDiff=function(e,t){if(!e||!t)return!1;const n={};if(e.replace(/id="([^"]+)"/g,((e,t)=>(n[t]=!0,""))),!Object.keys(n).length)return!1;let r=0,i=0;return t.replace(/id="([^"]+)"/g,((e,t)=>(r++,n[t]&&i++,""))),r>0&&0==i},n.diffXml=function(e,t,n){return a((0,i.loadWorkspaceXml)(e,!0),(0,i.loadWorkspaceXml)(t,!0),n)};const o="#d0d0d0";function a(e,t,n){try{return r.Events.disable(),function(e,t,n){pxt.tickEvent("blocks.diff",{started:1}),n=n||{};const a=l();if(!e)return{ws:void 0,message:lf("All blocks are new."),added:0,deleted:0,modified:1};if(!t)return{ws:void 0,message:lf("The current blocks seem corrupted."),added:0,deleted:0,modified:1};const u=pxt.Util.toDictionary(e.getTopBlocks(!1),(e=>c(e,!0)));t.getTopBlocks(!1).forEach((t=>{const n=c(t,!0),r=e.getBlockById(t.id)||u[n];r&&n==c(r,!0)&&(a("fast unmodified top ",t.id),t.dispose(!1),r.dispose(!1))}));const d=e.getAllBlocks(!1).filter((e=>e.isEnabled())),p=e.getTopBlocks(!1).filter((e=>e.isEnabled())),h=t.getAllBlocks(!1).filter((e=>e.isEnabled()));if(a("blocks",h.map((e=>e.toDevString()))),a(h),0==d.length&&0==h.length)return pxt.tickEvent("blocks.diff",{moves:1}),{ws:void 0,message:lf("Some blocks were moved or changed."),added:0,deleted:0,modified:1};const f=p.filter((e=>!t.getBlockById(e.id))),m=d.filter((e=>!t.getBlockById(e.id))),_=h.filter((t=>!e.getBlockById(t.id))),g=(0,s.initRenderingWorkspace)(),y=(0,i.saveWorkspaceXml)(t,!0);(0,i.domToWorkspaceNoEvents)(r.utils.xml.textToDom(y),g),g.getAllBlocks(!1).filter((e=>!e.isEnabled())).forEach((e=>{a("disabled ",e.toDevString()),e.dispose(!1)}));const b=pxt.Util.toDictionary(g.getAllBlocks(!1),(e=>e.id));a("todo blocks",b),A("start"),n.hideDeletedTopBlocks||(f.forEach((e=>{a(`deleted top ${e.toDevString()}`),I(e);const t=C(e);I(t),t.setEnabled(!1)})),A("deleted top")),_.map((e=>g.getBlockById(e.id))).filter((e=>!!e)).forEach((e=>{a(`added ${e.toDevString()}`),I(e)})),A("added");const v={};if(!n.hideDeletedBlocks){const e=m.filter((e=>!(b[e.id]||S(e)||e.outputConnection&&e.outputConnection.isConnected())));e.forEach((e=>{const t=C(e);v[e.id]=t.id,a(`deleted block ${e.toDevString()}->${t.toDevString()}`)})),e.forEach((e=>function(e){a(`stitching ${e.toDevString()}->${v[e.id]}`);const t=g.getBlockById(v[e.id]);t.setEnabled(!1),x(t),I(t);const n=e.getPreviousBlock();if(n){const i=g.getBlockById(v[n.id])||g.getBlockById(n.id);if(a(`previous ${e.id}->${t.toDevString()}: ${i.toDevString()}`),i)if(i.nextConnection)t.previousConnection.connect(i.nextConnection);else{const e=i.inputList.slice().reverse().find((e=>e.connection&&e.connection.type==r.NEXT_STATEMENT));e&&t.previousConnection.connect(e.connection)}}const i=e.getNextBlock();if(i){const n=g.getBlockById(v[i.id])||g.getBlockById(i.id);n&&(a(`next ${e.id}->${t.toDevString()}: ${n.toDevString()}`),t.nextConnection.connect(n.previousConnection))}}(e)))}let T=0;if(pxt.Util.values(b).filter((t=>function(t){const n=e.getBlockById(t.id);if(!n)return!1;const r=t.getPreviousBlock();if(r&&!b[r.id])return!1;const i=t.getNextBlock();if(i&&!b[i.id])return!1;const s=n.getPreviousBlock();if(!s&&!r)return!1;if(!!s!=!!r||s.id!=r.id)return!0;const o=n.getNextBlock();return!(!o&&!i||!!o==!!i&&o.id==i.id)}(t))).forEach((e=>{a(`moved ${e.toDevString()}`),delete b[e.id],x(e),T++})),A("moved"),pxt.Util.values(b).filter((t=>function(t){let n=e.getBlockById(t.id);if(!n)return!1;const r=c(n),i=c(t);return r!=i&&(a(`old ${n.toDevString()}`,r),a(`new ${t.toDevString()}`,i),!0)}(t))).forEach((e=>{a(`changed ${e.toDevString()}`),delete b[e.id],x(e),T++})),A("changed"),g.getTopBlocks(!1).forEach((e=>{(function(e){return!!e.getDescendants(!1).find((e=>S(e)))})(e)||(a(`unmodified top ${e.toDevString()}`),delete b[e.id],e.dispose(!1))})),A("cleaned"),pxt.Util.values(b).filter((e=>!!g.getBlockById(e.id))).forEach((e=>{!function e(t){t.setColour(o),function(e){e.rendered=!1,e.inputList.forEach((e=>e.fieldRow.forEach((e=>{e.init()}))))}(t),n.statementsOnly&&(t.inputList||[]).map((e=>e.type==r.inputTypes.VALUE&&e.connection&&e.connection.targetBlock())).filter((e=>!!e)).forEach((t=>e(t)))}(e)})),A("unmodified"),!g.getAllBlocks(!1).length)return pxt.tickEvent("blocks.diff",{missed:1}),{ws:g,message:lf("Some blocks were changed."),deleted:m.length,added:_.length,modified:T};g.resize(),r.svgResize(g);const k=(0,s.renderWorkspace)(n.renderOptions||{emPixels:20,layout:4,aspectRatio:.5,useViewWidth:!0}),E={ws:g,svg:k,deleted:m.length,added:_.length,modified:T};return pxt.tickEvent("blocks.diff",{deleted:E.deleted,added:E.added,modified:E.modified}),E;function x(e){e.__pxt_used=!0}function S(e){return!!e.__pxt_used}function C(e){const t=r.Xml.blockToDom(e,!1),n=r.Xml.domToBlock(t,g);return n.nextConnection&&n.nextConnection.targetConnection&&n.nextConnection.disconnect(),n.previousConnection&&n.previousConnection.targetConnection&&n.previousConnection.disconnect(),n}function I(e){e.getDescendants(!1).forEach((e=>{delete b[e.id],x(e)}))}function A(e){a(`${e}:`,pxt.Util.values(b).map((e=>e.toDevString())))}}(e,t,n)}catch(e){return pxt.reportException(e),{ws:void 0,message:lf("Oops, we could not diff those blocks."),error:e,deleted:0,added:0,modified:0}}finally{r.Events.enable()}}function l(){return pxt.options.debug||window&&/diffdbg=1/.test(window.location.href)?console.log:(e,...t)=>{}}function c(e,t){const n=r.Xml.blockToDom(e,!0);return u(n),d(n,(e=>{u(e),t||("next"==e.localName||"statement"==e.localName||"shadow"==e.localName)&&e.remove()})),r.Xml.domToText(n)}function u(e){e.removeAttribute("id"),e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("deletable"),e.removeAttribute("editable"),e.removeAttribute("movable")}function d(e,t){if(e){t(e);for(const n of pxt.Util.toArray(e.children))d(n,t)}}function p(e,t){if(!t)return;let n,r;for(let i=0;i<e.length;++i){let s=e[i];s.startPos<=t.start&&s.endPos>=t.start+t.length&&(!n||r>s.endPos-s.startPos)&&(n=s,r=s.endPos-s.startPos)}return n?n.id:void 0}n.mergeXml=function(e,t,n){return e==t?n:n==t?e:void 0},n.decompiledDiffAsync=function(e,t,n,r,s={}){const o=l(),c=t.outfiles[pxt.MAIN_BLOCKS];let u=r.outfiles[pxt.MAIN_BLOCKS];o(c),o(u);const d=pxt.diff.compute(e,n,{ignoreWhitespace:!0,full:!0});o(d);const h={};let f=0,m=0;d.forEach(((e,n)=>{const i=e[0],s=e.substr(2);let a=s.length;switch(i){case"-":f+=a+1;break;case"+":m+=a+1;break;default:const n=/^\s+/.exec(s);if(n){const e=n[0].length;f+=e,m+=e,a-=e}const i=p(r.blockSourceMap,{start:m,length:a});if(i&&!h[i]){const n=p(t.blockSourceMap,{start:f,length:a});n&&(o(e),o(`id ${f}:${s.length}>${n} ==> ${m}:${s.length}>${i}`),h[i]=n,u=u.replace(i,n))}f+=a+1,m+=a+1}}));const _=(0,i.loadWorkspaceXml)(c,!0),g=(0,i.loadWorkspaceXml)(u,!0);return s.statementsOnly=!0,a(_,g,s)}},{"./importer":67,"./render":118,blockly:154}],24:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.prompt=n.setPrompt=n.setOnWorkspaceContextMenu=n.onWorkspaceContextMenu=n.setOpenHelpUrl=n.openHelpUrl=n.setExtensionBlocklyPatch=n.extensionBlocklyPatch=n.setPromptTranslateBlock=n.promptTranslateBlock=void 0;const r=e("blockly");let i,s,o,a,l;n.promptTranslateBlock=function(e,t){i&&i(e,t)},n.setPromptTranslateBlock=function(e){i=e},n.extensionBlocklyPatch=function(e,t){s&&s(e,t)},n.setExtensionBlocklyPatch=function(e){s=e},n.openHelpUrl=function(e){o?o(e):window.open(e)},n.setOpenHelpUrl=function(e){o=e},n.onWorkspaceContextMenu=function(e,t){a&&a(e,t)},n.setOnWorkspaceContextMenu=function(e){a=e},n.setPrompt=function(e,t){t&&r.dialog.setPrompt(e),l=e},n.prompt=function(e,t,n,i){l?l(e,t,n,i):r.dialog.prompt(e,t,n)}},{blockly:154}],25:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFieldEditor=n.registerFieldEditor=n.initFieldEditors=void 0;const r=e("./field_animation"),i=e("./field_tilemap"),s=e("./field_textinput"),o=e("./field_sprite"),a=e("./field_gridpicker"),l=e("./field_colour"),c=e("./field_images"),u=e("./field_textdropdown"),d=e("./field_numberdropdown"),p=e("./field_imagedropdown"),h=e("./field_note"),f=e("./field_melodySandbox"),m=e("./field_toggle"),_=e("./field_toggle_downup"),g=e("./field_toggle_highlow"),y=e("./field_toggle_onoff"),b=e("./field_toggle_updown"),v=e("./field_toggle_winlose"),T=e("./field_toggle_yesno"),k=e("./field_protractor"),E=e("./field_position"),x=e("./field_speed"),S=e("./field_tileset"),C=e("./field_turnratio"),I=e("./field_musiceditor"),A=e("./field_sound_effect"),w=e("./field_autocomplete"),N=e("./field_colorwheel");let D={};function O(e,t,n){null==D[e]&&(D[e]={field:t,validator:n})}n.initFieldEditors=function(){var e;O("text",s.FieldTextInput),O("note",h.FieldNote),O("gridpicker",a.FieldGridPicker),O("textdropdown",u.FieldTextDropdown),O("numberdropdown",d.FieldNumberDropdown),O("imagedropdown",p.FieldImageDropdown),O("colorwheel",N.FieldColorWheel),O("toggle",m.FieldToggle),O("toggleonoff",y.FieldToggleOnOff),O("toggleyesno",T.FieldToggleYesNo),O("toggleupdown",b.FieldToggleUpDown),O("toggledownup",_.FieldToggleDownUp),O("togglehighlow",g.FieldToggleHighLow),O("togglewinlose",v.FieldToggleWinLose),O("colornumber",l.FieldColorNumber),O("images",c.FieldImages),O("sprite",o.FieldSpriteEditor),O("animation",r.FieldAnimationEditor),O("tilemap",i.FieldTilemap),O("tileset",S.FieldTileset),O("speed",x.FieldSpeed),O("turnratio",C.FieldTurnRatio),O("protractor",k.FieldProtractor),O("position",E.FieldPosition),O("melody",f.FieldCustomMelody),O("soundeffect",A.FieldSoundEffect),O("autocomplete",w.FieldAutoComplete),(null===(e=pxt.appTarget.appTheme)||void 0===e?void 0:e.songEditor)&&O("musiceditor",I.FieldMusicEditor)},n.registerFieldEditor=O,n.createFieldEditor=function(e,t,n){if(null==D[e])return console.error(`Field editor ${e} not registered`),null;n||(n={}),pxt.Util.assert(null==n.lightMode,"lightMode is a reserved parameter for custom fields"),n.lightMode=pxt.options.light;let r=D[e];return new r.field(t,n,r.validator)}},{"./field_animation":26,"./field_autocomplete":29,"./field_colorwheel":31,"./field_colour":32,"./field_gridpicker":34,"./field_imagedropdown":35,"./field_images":36,"./field_melodySandbox":39,"./field_musiceditor":40,"./field_note":41,"./field_numberdropdown":42,"./field_position":43,"./field_protractor":45,"./field_sound_effect":46,"./field_speed":47,"./field_sprite":48,"./field_textdropdown":50,"./field_textinput":51,"./field_tilemap":52,"./field_tileset":53,"./field_toggle":54,"./field_toggle_downup":55,"./field_toggle_highlow":56,"./field_toggle_onoff":57,"./field_toggle_updown":58,"./field_toggle_winlose":59,"./field_toggle_yesno":60,"./field_turnratio":62}],26:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldAnimationEditor=void 0;var r=pxt.svgUtil;const i=e("./field_asset"),s=e("./field_utils"),o=32;class a extends i.FieldAssetEditor{constructor(){super(...arguments),this.onMouseEnter=()=>{if(this.animateRef||!this.asset)return;const e=this.getParentInterval()||this.asset.interval,t=e>50?e:50;let n=0;this.animateRef=setInterval((()=>{this.preview&&this.frames[n]&&this.preview.src(this.frames[n]),n=(n+1)%this.frames.length}),t)},this.onMouseLeave=()=>{this.animateRef&&clearInterval(this.animateRef),this.animateRef=void 0,this.preview&&this.frames[0]&&this.preview.src(this.frames[0])}}initView(){this.sourceBlock_.getSvgRoot().addEventListener("mouseenter",this.onMouseEnter),this.sourceBlock_.getSvgRoot().addEventListener("mouseleave",this.onMouseLeave)}showEditor_(){this.asset&&(this.asset.interval=this.getParentInterval()||this.asset.interval),super.showEditor_()}render_(){super.render_(),this.size_.height=42,this.size_.width=80}getAssetType(){return"animation"}createNewAsset(e){const t=pxt.react.getTilemapProject();if(e){const n=pxt.lookupProjectAssetByTSReference(e,t);if(n)return n;const r=function(e,t){return-1===e.indexOf("[")?null:(e=e.replace(/[\[\]]/gm,"")).split(",").map((e=>pxt.sprite.imageLiteralToBitmap(e,t).data())).filter((e=>e.height&&e.width))}(e,this.params.taggedTemplate);if(r&&r.length)return{internalID:-1,id:this.sourceBlock_.id,type:"animation",frames:r,interval:this.getParentInterval(),meta:{}};const i=t.lookupAssetByName("animation",e.trim());if(i)return i}return{internalID:-1,id:this.sourceBlock_.id,type:"animation",frames:[new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight).data()],interval:500,meta:{}}}onEditorClose(e){this.setParentInterval(e.interval)}getValueText(){return this.asset?this.isTemporaryAsset()?"["+this.asset.frames.map((e=>pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e),"typescript",this.params.taggedTemplate))).join(",")+"]":pxt.getTSReferenceForAsset(this.asset):this.valueText||"[]"}redrawPreview(){if(!this.fieldGroup_)return;pxsim.U.clear(this.fieldGroup_);const e=(new r.Rect).at(35,1).size(40,40).corner(4).setClass("blocklyAnimationField");this.fieldGroup_.appendChild(e.el);const t=new r.Text("").at(5,26).setClass("semanticIcon");this.fieldGroup_.appendChild(t.el),this.asset&&(this.frames=this.asset.frames.map((e=>(0,s.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e),o,this.lightMode))),this.preview=(new r.Image).src(this.frames[0]).at(39,5).size(o,o),this.fieldGroup_.appendChild(this.preview.el))}getParentIntervalBlock(){const e=this.sourceBlock_;if(e.getParent()){const t=e.getParent();for(const e of t.inputList)if("frameInterval"===e.name)return e.connection.targetBlock()}}setParentInterval(e){const t=this.getParentIntervalBlock();if(t){const n=l(t);n&&t.setFieldValue(String(e),n)}}getParentInterval(){const e=this.getParentIntervalBlock();if(e){const t=l(e);if(t)return Number(e.getFieldValue(t))}return 100}parseFieldOptions(e){return function(e){const t={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};return e?(t.lightMode=e.lightMode,e.filter&&(t.filter=e.filter),t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t.taggedTemplate=e.taggedTemplate,t):t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(e)}}function l(e){return"math_number_minmax"===e.type?"SLIDER":function(e){return"math_number"===e||"math_integer"===e||"math_whole_number"===e}(e.type)?"NUM":"timePicker"===e.type?"ms":null}n.FieldAnimationEditor=a},{"./field_asset":28,"./field_utils":64}],27:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldArgumentVariable=void 0;const r=e("blockly");class i extends r.FieldVariable{constructor(e){super(e),this.menuGenerator_=this.generateMenu}generateMenu(){return r.FieldVariable.dropdownCreate.call(this).filter((e=>e[1]!=r.DELETE_VARIABLE_ID))}}n.FieldArgumentVariable=i},{blockly:154}],28:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BlocklyTilemapChange=n.FieldAssetEditor=void 0;const r=e("blockly");var i=pxt.svgUtil;const s=e("./field_base"),o=e("./field_utils"),a=32;class l extends s.FieldBase{constructor(e,t,n){super(e,t,n),this.pendingEdit=!1,this.isEmpty=!1,this.assetChangeListener=()=>{if(this.pendingEdit)return;const e=this.getBlockData();e&&(this.asset=pxt.react.getTilemapProject().lookupAsset(this.getAssetType(),e)),this.redrawPreview()},this.lightMode=t.lightMode,this.params=this.parseFieldOptions(t),this.blocksInfo=t.blocksInfo}onInit(){this.redrawPreview()}onValueChanged(e){return this.parseValueText(e),this.redrawPreview(),this.getValueText()}showEditor_(){if(this.isGreyBlock)return;const e=Object.assign({},this.params);let t;switch(e.blocksInfo=this.blocksInfo,this.asset.type){case"tile":case"image":t="image-editor",e.temporaryAssets=(0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"image");break;case"animation":t="animation-editor",e.temporaryAssets=(0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"image").concat((0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"animation"));break;case"tilemap":t="tilemap-editor";const n=pxt.react.getTilemapProject();pxt.sprite.addMissingTilemapTilesAndReferences(n,this.asset);for(const e of(0,o.getTilesReferencedByTilesets)(this.sourceBlock_.workspace))-1===this.asset.data.projectReferences.indexOf(e.id)&&this.asset.data.projectReferences.push(e.id);break;case"song":t="music-editor",e.temporaryAssets=(0,o.getTemporaryAssets)(this.sourceBlock_.workspace,"song"),(0,o.setMelodyEditorOpen)(this.sourceBlock_,!0)}this.isFullscreen()?this.showEditorFullscreen(t,e):this.showEditorInWidgetDiv(t,e)}showEditorFullscreen(e,t){const n=pxt.react.getFieldEditorView(e,this.asset,t);this.undoRedoState&&n.restorePersistentData(this.undoRedoState),pxt.react.getTilemapProject().pushUndo(),n.onHide((()=>{this.onFieldEditorHide(n)})),n.show()}showEditorInWidgetDiv(e,t){let n,i={getScaledBBox:()=>n};r.WidgetDiv.show(i,this.sourceBlock_.RTL,(()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),a.hide(),s.classList.remove("sound-effect-editor-widget"),s.style.transform="",s.style.position="",s.style.left="",s.style.top="",s.style.width="",s.style.height="",s.style.opacity="",s.style.transition="",s.style.alignItems="",this.onFieldEditorHide(a)}));const s=r.WidgetDiv.getDiv(),a=pxt.react.getFieldEditorView(e,this.asset,t,s),l=this.sourceBlock_,c=l.getBoundingRectangle(),u=(0,o.workspaceToScreenCoordinates)(l.workspace,new r.utils.Coordinate(c.right,c.top)),d=u.x-400,p=u.y+60-20;s.style.opacity="0",s.classList.add("sound-effect-editor-widget"),s.style.position="absolute",s.style.left=d+"px",s.style.top=p+"px",s.style.width="50rem",s.style.height="34.25rem",s.style.display="flex",s.style.alignItems="center",s.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",s.style.borderRadius="",a.onHide((()=>{r.WidgetDiv.hideIfOwner(i)})),a.show();const h=s.getBoundingClientRect(),f=l.workspace.getInjectionDiv().getBoundingClientRect();h.height>f.height?(s.style.height="",s.style.top="calc(1rem - 20px)",s.style.bottom="calc(1rem + 20px)"):(h.bottom>f.bottom||h.top<f.top)&&(s.style.top=f.top+f.height/2-h.height/2-20+"px");const m=l.workspace.getToolbox().getWidth(),_=f.left+m;if(h.width>f.width-m)s.style.width="",s.style.left="1rem",s.style.right="1rem";else if(h.left+h.width>=f.right){const e=(0,o.workspaceToScreenCoordinates)(l.workspace,new r.utils.Coordinate(c.left,c.top));e.x-h.width-20>_?s.style.left=e.x-h.width-20+"px":s.style.left=_+(f.width-m)/2-h.width/2+"px"}else h.left<f.left&&(s.style.left=_+"px");const g=s.getBoundingClientRect();n=new r.utils.Rect(g.top,g.bottom,g.left,g.right),requestAnimationFrame((()=>{s.style.opacity="1",s.style.transform="translateY(20px)"}))}onFieldEditorHide(e){var t;const n=e.getResult(),i=pxt.react.getTilemapProject();if("song"===this.asset.type&&(0,o.setMelodyEditorOpen)(this.sourceBlock_,!1),n){const s=this.getValue();if(pxt.assetEquals(this.asset,n))return;const o=c(this.asset)?null:this.asset.id;let a=c(n)?null:n.id;o||a!==this.sourceBlock_.id||(n.id=i.generateNewID(n.type),a=n.id),this.pendingEdit=!0,(null===(t=n.meta)||void 0===t?void 0:t.displayName)&&this.disposeOfTemporaryAsset(),this.asset=n;const l=i.revision();if(this.onEditorClose(this.asset),this.updateAssetListener(),this.updateAssetMeta(),this.redrawPreview(),this.undoRedoState=e.getPersistentData(),this.sourceBlock_&&r.Events.isEnabled()){const e=new u(this.sourceBlock_,"field",this.name,s,this.getValue(),l,i.revision());o!==a&&(e.oldAssetId=o,e.newAssetId=a),r.Events.fire(e)}this.pendingEdit=!1}}render_(){this.isGreyBlock&&!this.textElement_&&this.createTextElement_(),super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=50)}getDisplayText_(){if(this.isGreyBlock){const e=pxt.Util.htmlUnescape(this.valueText);return e.substr(0,e.indexOf("("))+"(...)"}return""}updateEditable(){if(this.isGreyBlock&&this.fieldGroup_){const e=this.fieldGroup_;r.utils.dom.removeClass(e,"blocklyNonEditableText"),r.utils.dom.removeClass(e,"blocklyEditableText"),e.style.cursor=""}else super.updateEditable()}getValue(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.getValueText()}onDispose(){var e;(null===(e=this.sourceBlock_)||void 0===e?void 0:e.workspace)&&!this.sourceBlock_.workspace.rendered&&this.disposeOfTemporaryAsset(),pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener)}disposeOfTemporaryAsset(){this.isTemporaryAsset()&&(pxt.react.getTilemapProject().removeAsset(this.asset),this.setBlockData(null),this.asset=void 0)}clearTemporaryAssetData(){this.isTemporaryAsset()&&this.setBlockData(null)}isTemporaryAsset(){return c(this.asset)}getAsset(){return this.asset}updateAsset(e){this.asset=e,this.setValue(this.getValue())}onEditorClose(e){}redrawPreview(){if(!this.fieldGroup_)return;if(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock)return this.createTextElement_(),this.render_(),void this.updateEditable();const e=(new i.Rect).at(5,1).size(40,40).setClass("blocklySpriteField").stroke("#898989",1).corner(4);if(this.fieldGroup_.appendChild(e.el),this.asset){let e;switch(this.asset.type){case"image":case"tile":e=(0,o.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.bitmap),a,this.lightMode);break;case"animation":e=(0,o.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.frames[0]),a,this.lightMode);break;case"tilemap":e=(0,o.tilemapToImageURI)(this.asset.data,a,this.lightMode);break;case"song":e=(0,o.songToDataURI)(this.asset.song,60,20,this.lightMode)}if(e){const t=(new i.Image).src(e).at(9,5).size(a,a);this.fieldGroup_.appendChild(t.el)}}}parseValueText(e){if(e=pxt.Util.htmlUnescape(e),this.sourceBlock_){const t=pxt.react.getTilemapProject(),n=this.getBlockData(),r=t.lookupAsset(this.getAssetType(),n);!r||e&&this.isEmpty?(this.setBlockData(null),this.asset&&this.sourceBlock_&&this.asset.meta.blockIDs&&(this.asset.meta.blockIDs=this.asset.meta.blockIDs.filter((e=>e!==this.sourceBlock_.id)),this.isTemporaryAsset()||t.updateAsset(this.asset)),this.isEmpty=!e,this.asset=this.createNewAsset(e)):this.asset=r,this.updateAssetMeta(),this.updateAssetListener()}}parseFieldOptions(e){const t={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};return e?(e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t.lightMode=e.lightMode,t):t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}updateAssetMeta(){if(this.asset){if(this.asset.meta||(this.asset.meta={}),this.asset.meta.blockIDs||(this.asset.meta.blockIDs=[]),this.sourceBlock_){if(-1===this.asset.meta.blockIDs.indexOf(this.sourceBlock_.id)){const e=this.asset.meta.blockIDs;e.length&&this.isTemporaryAsset()&&e.some((e=>this.sourceBlock_.workspace.getBlockById(e)))&&(this.asset=pxt.cloneAsset(this.asset),this.asset.meta.blockIDs=[]),this.asset.meta.blockIDs.push(this.sourceBlock_.id)}this.setBlockData(this.isTemporaryAsset()?null:this.asset.id)}this.isTemporaryAsset()?this.asset.meta.temporaryInfo={blockId:this.sourceBlock_.id,fieldName:this.name}:pxt.react.getTilemapProject().updateAsset(this.asset)}}updateAssetListener(){pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener),this.asset&&!this.isTemporaryAsset()&&pxt.react.getTilemapProject().addChangeListener(this.asset,this.assetChangeListener)}isFullscreen(){return!0}}function c(e){return e&&!e.meta.displayName}n.FieldAssetEditor=l;class u extends r.Events.BlockChange{constructor(e,t,n,r,i,s,o){super(e,t,n,r,i),this.oldRevision=s,this.newRevision=o,this.fieldName=n}isNull(){return this.oldRevision===this.newRevision&&super.isNull()}run(e){if(this.newAssetId||this.oldAssetId){const t=this.getEventWorkspace_().getBlockById(this.blockId);e?(0,o.setBlockDataForField)(t,this.fieldName,this.newAssetId):(0,o.setBlockDataForField)(t,this.fieldName,this.oldAssetId)}e?(pxt.react.getTilemapProject().redo(),super.run(e)):(pxt.react.getTilemapProject().undo(),super.run(e));const t=this.getEventWorkspace_(),n=new u(t.getBlockById(this.blockId),"tilemap-revision","revision",null,pxt.react.getTilemapProject().revision(),0,0);n.recordUndo=!1,r.Events.fire(n)}}n.BlocklyTilemapChange=u},{"./field_base":30,"./field_utils":64,blockly:154}],29:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldAutoComplete=void 0;const r=e("blockly"),i=e("./field_utils"),s=e("./field_textdropdown"),o=e("../plugins/text");class a extends s.FieldTextDropdown{constructor(e,t,n){super(e,t,n),this.isFieldCustom_=!0,this.key=t.key,this.isTextValid_=!0}isOptionListDynamic(){return!0}getDisplayText_(){return this.parsedValue||""}doValueUpdate_(e){this.isDirty_=!0,null!==e&&(/['"`].*['"`]/.test(e)?this.parsedValue=JSON.parse(e):this.parsedValue=e,this.value_=this.parsedValue)}getValue(){return this.parsedValue?this.parsedValue:""}getOptions(){var e;const t=null===(e=this.sourceBlock_)||void 0===e?void 0:e.workspace;if(!t)return[];const n=[],r=(0,i.getAllFields)(t,(e=>e instanceof a&&e.getKey()===this.key)).map((e=>e.ref.getDisplayText_()));for(const e of r)e.trim()&&!n.some((t=>t[0]===e))&&n.push([e,e]);return n.sort(((e,t)=>e[0].localeCompare(t[0]))),n}showDropdown_(){this.getOptions().length&&super.showDropdown_()}getKey(){return this.key?this.key:this.sourceBlock_?this.sourceBlock_.type:void 0}initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=r.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=r.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(){super.updateSize_();const e=Math.max(this.size_.width,1);let t=this.positionLeft(e+3);this.textElement_.setAttribute("x",t.toString()),t+=this.positionRight(t+e+3),this.size_.width=e+t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteRightX_=o.FieldString.quotePadding,t=this.quoteWidth_+o.FieldString.quotePadding):(this.quoteRightX_=e+o.FieldString.quotePadding,t=this.quoteWidth_+o.FieldString.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteLeftX_=e+this.quoteWidth_+2*o.FieldString.quotePadding,t=this.quoteWidth_+o.FieldString.quotePadding):(this.quoteLeftX_=0,t=this.quoteWidth_+o.FieldString.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}createSVGArrow(){}}n.FieldAutoComplete=a},{"../plugins/text":115,"./field_textdropdown":50,"./field_utils":64,blockly:154}],30:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldBase=void 0;const r=e("blockly"),i=e("./field_utils");class s extends r.Field{constructor(e,t,n){super(e,n),this.SERIALIZABLE=!0,this.options=t,e&&!this.valueText&&(this.valueText=e)}static enqueueInit(e){s.pendingInit.push(e),this.pendingTimeout||(s.pendingTimeout=setTimeout((()=>s.flushInitQueue())))}static flushInitQueue(){for(const e of s.pendingInit)e.onLoadedIntoWorkspace();s.pendingTimeout=void 0,s.pendingInit=[]}init(){super.init(),this.onInit(),s.enqueueInit(this)}dispose(){this.onDispose()}getValue(){return this.valueText}doValueUpdate_(e){null!==e&&(this.valueText=this.loaded?this.onValueChanged(e):e)}getDisplayText_(){return this.valueText}onLoadedIntoWorkspace(){this.loaded||(this.loaded=!0,this.valueText=this.onValueChanged(this.valueText))}getAnchorDimensions(){const e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=r.FieldDropdown.CHECKMARK_OVERHANG:e.left-=r.FieldDropdown.CHECKMARK_OVERHANG,e}isInitialized(){return!!this.fieldGroup_}getBlockData(){return(0,i.getBlockDataForField)(this.sourceBlock_,this.name)}setBlockData(e){(0,i.setBlockDataForField)(this.sourceBlock_,this.name,e)}getSiblingBlock(e,t=!1){const n=t?this.sourceBlock_.getParent():this.sourceBlock_;if(n&&n.inputList)for(const t of n.inputList)if(t.name===e)return t.connection.targetBlock()}getSiblingField(e,t=!1){const n=t?this.sourceBlock_.getParent():this.sourceBlock_;if(n)return n.getField(e)}}n.FieldBase=s,s.pendingInit=[]},{"./field_utils":64,blockly:154}],31:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldColorWheel=void 0;const r=e("../plugins/math");class i extends r.FieldSlider{constructor(e,t,n){super(String(e),"0","255","1","10","Color",n),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.channel&&(this.channel_=this.params.channel)}setBackground_(e){let t=this.createColourStops_().join(",");e.style.background=`linear-gradient(left, ${t})`,this.params.sliderWidth&&(e.style.width=`${this.params.sliderWidth}px`)}setReadout_(e,t){const n=this.colorWheel(parseInt(t),this.channel_),r=document.createElement("span");r.className="blocklyColorReadout",r.style.backgroundColor=`${n}`,pxsim.U.clear(e),e.appendChild(r)}createColourStops_(){let e=[];for(let t=0;t<=255;t+=20)e.push(this.colorWheel(t,this.channel_));return e}colorWheel(e,t){return"hsvfast"==t?this.hsvFast(e,255,255):(e=255-e)<85?this.hex(3*e,255,255-3*e):e<170?(e-=85,this.hex(255,255-3*e,3*e)):(e-=170,this.hex(255-3*e,3*e,255))}hsvFast(e,t,n){let r=e%255>>0;r<0&&(r+=255);let i,s,o,a=n*(255-t)/255>>0,l=n-a,c=(r=192*r/255>>0)/64>>0,u=r%64>>0,d=(u*l/63.75>>0)+a,p=((63-u)*l/63.75>>0)+a;return c?1==c?(i=a,s=p,o=d):(i=d,s=a,o=p):(i=p,s=d,o=a),this.hex(i,s,o)}hex(e,t,n){return`#${this.componentToHex(255&e)}${this.componentToHex(255&t)}${this.componentToHex(255&n)}`}componentToHex(e){let t=e.toString(16);return 1==t.length?"0"+t:t}}n.FieldColorWheel=i},{"../plugins/math":101}],32:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldColorNumber=void 0;const r=e("blockly");class i extends r.FieldColour{constructor(e,t,n){if(super(e,n),this.isFieldCustom_=!0,this.valueMode_="rgb",t.colours)this.setColours(JSON.parse(t.colours));else if(pxt.appTarget.runtime&&pxt.appTarget.runtime.palette){let e,t=pxt.Util.clone(pxt.appTarget.runtime.palette);t[0]="#dedede",pxt.appTarget.runtime.paletteNames&&((e=pxt.Util.clone(pxt.appTarget.runtime.paletteNames))[0]=lf("transparent")),this.setColours(t,e)}this.setValue(this.getColours_()[0]),t.columns&&this.setColumns(parseInt(t.columns)),t.valueMode&&(this.valueMode_=t.valueMode)}setColours(e,t){const n=super.setColours(e,t);return this.colours_=e,n}doClassValidation_(e){return"string"!=typeof e?null:s(e,this.getColours_())}getValue(e){if(e)return this.value_;switch(this.valueMode_){case"hex":return`"${this.value_}"`;case"rgb":return this.value_.indexOf("#")>-1?`0x${this.value_.replace(/^#/,"")}`:this.value_;case"index":if(!this.value_)return"-1";const e=this.getColours_();for(let t=0;t<e.length;t++)if(this.value_.toUpperCase()===e[t].toUpperCase())return t+""}return this.value_}doValueUpdate_(e){super.doValueUpdate_(s(e,this.getColours_()))}getColours_(){return this.colours_}applyColour(){const e=this.getSourceBlock();if(!e)throw new r.UnattachedFieldError;if(!this.fieldGroup_)return;const t=this.borderRect_;if(!t)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",s(this.getValue(),this.getColours_())),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getValue())}}function s(e,t){if(e){const n=/Colors\.([a-zA-Z]+)/.exec(e),r=/(0x|#)([0-9a-fA-F]+)/.exec(e);if(n)switch(n[1].toLocaleLowerCase()){case"red":return"#FF0000";case"orange":return"#FF7F00";case"yellow":return"#FFFF00";case"green":return"#00FF00";case"blue":return"#0000FF";case"indigo":return"#4B0082";case"violet":return"#8A2BE2";case"purple":return"#A033E5";case"pink":return"#FF007F";case"white":return"#FFFFFF";case"black":return"#000000";default:return e}else if(r){const e=r[2];if(3===e.length){let t="#";for(let n=0;n<e.length;n++){const r=e.charAt(n);t+=r+r}return t}if(6===e.length)return"#"+e}if(t){const n=parseInt(e);return isNaN(n)||null==t[n]?t[0]:t[n]}}return e}n.FieldColorNumber=i,r.Css.register("\n/* eslint-disable indent */\ntable.blocklyColourTable {\n    outline: none;\n    border-radius: 11px;\n}\n\ntable.blocklyColourTable > tr > td {\n    height: 22px;\n    width: 22px;\n    margin: 2px;\n    text-align: center;\n    cursor: pointer;\n    border-radius: 4px;\n    border: 2px solid rgba(0,0,0,.1);\n}\n\ntable.blocklyColourTable > tr > td:hover {\n    border: 1px solid #FFF;\n    box-sizing: border-box;\n}\n\ntable.blocklyColourTable > tr > td.blocklyColourSelected {\n    border: 1px solid #000;\n    box-sizing: border-box;\n    color: #fff;\n}\n\ntable.blocklyColourTable>tr>td.blocklyColourHighlighted {\n    border-color: #eee;\n    box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);\n    position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n    border-color: #eee !important;\n    outline: 1px solid #333;\n    position: relative;\n}\n/* eslint-enable indent */\n")},{blockly:154}],33:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldDropdown=void 0;const r=e("blockly"),i=e("../plugins/newVariableField/fieldDropdownMixin");class s extends r.FieldDropdown{shouldAddBorderRect_(){return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}showEditor_(e){i.showEditorMixin.call(this,e)}}n.FieldDropdown=s},{"../plugins/newVariableField/fieldDropdownMixin":103,blockly:154}],34:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldGridPicker=void 0;const r=e("blockly"),i=e("./field_utils");class s extends r.FieldDropdown{constructor(e,t,n){super(t.data),this.isFieldCustom_=!0,this.buttonClick_=e=>{let t=e.target.getAttribute("data-value");null!==t&&(this.setValue(t),this.closeModal_&&(this.close(),this.closeModal_=!1))},this.buttonClickAndClose_=e=>{this.closeModal_=!0,this.buttonClick_(e)},this.columns_=parseInt(t.columns)||4,this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||200,this.backgroundColour_=(0,i.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1);let r={xOffset:parseInt(t.tooltipsXOffset)||15,yOffset:parseInt(t.tooltipsYOffset)||-10};this.tooltipConfig_=r,this.hasSearchBar_=!!t.hasSearchBar||!1,this.hideRect_=!!t.hideRect||!1}dispose(){super.dispose(),this.disposeTooltip(),this.disposeIntersectionObserver()}createTooltip_(){this.gridTooltip_||(this.gridTooltip_=document.createElement("div"),this.gridTooltip_.className="goog-tooltip blocklyGridPickerTooltip",this.gridTooltip_.style.position="absolute",this.gridTooltip_.style.display="none",this.gridTooltip_.style.visibility="hidden",document.body.appendChild(this.gridTooltip_))}populateTableContainer(e,t,n){pxsim.U.removeChildren(t),0==e.length&&(this.firstItem_=void 0);for(let n=0;n<e.length/this.columns_;n++){let r=this.populateRow(n,e,t);t.appendChild(r)}}populateRow(e,t,n){const i=this.columns_,o=document.createElement("div");o.className="blocklyGridPickerRow";for(let a=i*e;a<Math.min(i*e+i,t.length);a++){let e=t[a][0];const i=t[a][1],l=document.createElement("div");l.className="goog-menuitem goog-option",l.setAttribute("id",":"+a),l.setAttribute("role","menuitem"),l.style.userSelect="none",l.title=e.alt||e,l.setAttribute("data-value",i);const c=document.createElement("div");c.setAttribute("class","goog-menuitem-content"),c.title=e.alt||e,c.setAttribute("data-value",i);const u="object"==typeof e;let d=this.backgroundColour_;if(i==this.getValue()&&(l.setAttribute("aria-selected","true"),pxt.BrowserUtils.addClass(l,"goog-option-selected"),d=this.sourceBlock_.getColourTertiary(),this.selectedItemDom=l,u&&!this.shouldShowTooltips()&&this.updateSelectedBar_(e,i)),l.style.backgroundColor=d,l.style.borderColor=this.borderColour_,u){const t=new Image(e.width,e.height);t.setAttribute("draggable","false"),"IntersectionObserver"in window?(t.src=s.DEFAULT_IMG,t.setAttribute("data-src",e.src),this.observer.observe(t)):t.src=e.src,t.alt=e.alt||"",t.setAttribute("data-value",i),c.appendChild(t)}else c.textContent=e;if(this.shouldShowTooltips()){r.browserEvents.conditionalBind(l,"click",this,this.buttonClickAndClose_);const e=this.sourceBlock_.RTL?-this.tooltipConfig_.xOffset:this.tooltipConfig_.xOffset,t=this.tooltipConfig_.yOffset;r.browserEvents.conditionalBind(l,"mousemove",this,(r=>{if(u){this.gridTooltip_.style.top=`${r.clientY+t}px`,this.gridTooltip_.style.left=`${r.clientX+e}px`;const n=document.elementFromPoint(r.clientX,r.clientY),i=n.title||n.alt;this.gridTooltip_.textContent=i,this.gridTooltip_.style.visibility=i?"visible":"hidden",this.gridTooltip_.style.display=i?"":"none"}pxt.BrowserUtils.addClass(l,"goog-menuitem-highlight"),n.setAttribute("aria-activedescendant",l.id)})),r.browserEvents.conditionalBind(l,"mouseout",this,(e=>{u&&(this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"),pxt.BrowserUtils.removeClass(l,"goog-menuitem-highlight"),n.removeAttribute("aria-activedescendant")}))}else u?(this.selectedBar_.style.display="",r.browserEvents.conditionalBind(l,"click",this,(t=>{if(this.closeModal_)this.buttonClick_(t);else{const t=n.getElementsByClassName("goog-menuitem-highlight");for(let e=0;e<t.length;e++)pxt.BrowserUtils.removeClass(t[e],"goog-menuitem-highlight");pxt.BrowserUtils.addClass(l,"goog-menuitem-highlight"),this.updateSelectedBar_(e,i)}}))):(r.browserEvents.conditionalBind(l,"click",this,this.buttonClickAndClose_),r.browserEvents.conditionalBind(l,"mouseup",this,this.buttonClickAndClose_));l.appendChild(c),o.appendChild(l),0==a&&(this.firstItem_=l)}return o}shouldShowRect_(){return!this.hideRect_&&!this.sourceBlock_.isShadow()}doClassValidation_(e){return e}close(){this.disposeTooltip(),r.WidgetDiv.hideIfOwner(this),r.Events.setGroup(!1)}getFirstItem(){return this.firstItem_}highlightFirstItem(e){let t=e.childNodes;if(t.length&&t[0].childNodes){for(let e=0;e<t.length;++e){let n=t[e].childNodes.length;for(let r=0;r<n;++r){const n=t[e].childNodes[r];pxt.BrowserUtils.removeClass(n,"goog-menuitem-highlight"),pxt.BrowserUtils.removeClass(n,"goog-option-selected")}}t[0].childNodes[0].className+=" goog-menuitem-highlight"}}highlightAndScrollSelected(e,t){this.selectedItemDom&&r.utils.style.scrollIntoContainerView(this.selectedItemDom,t,!0)}showEditor_(){r.WidgetDiv.show(this,this.sourceBlock_.RTL,(()=>{this.onClose_()})),this.setupIntersectionObserver_(),this.createTooltip_();const e=document.createElement("div");this.positionMenu_(e)}positionMenu_(e){const t=r.utils.svgMath.getViewportBBox(),n=this.getAnchorDimensions_(),{paddingContainer:i,scrollContainer:s}=this.createWidget_(e),o={width:i.offsetWidth,height:i.offsetHeight},a=window.outerWidth,l=window.outerHeight;this.width_>a&&(this.width_=a),e.style.width=this.width_+"px";let c=0;if(this.hasSearchBar_&&(c+=50),this.selectedBar_&&(c+=50),this.maxRows_){let t=e.children[0].offsetHeight*(this.maxRows_+.3);l<t+c&&(t=l-c),o.height>t&&(s.style.overflowY="auto",s.style.height=t+"px",o.height=t)}o.height+=c,r.WidgetDiv.positionWithAnchor(t,n,o,this.sourceBlock_.RTL),this.highlightAndScrollSelected(e,s)}shouldShowTooltips(){return!pxt.BrowserUtils.isMobile()}getAnchorDimensions_(){const e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=r.FieldDropdown.CHECKMARK_OVERHANG:e.left-=r.FieldDropdown.CHECKMARK_OVERHANG,e}createWidget_(e){const t=r.WidgetDiv.getDiv(),n=this.getOptions();e.setAttribute("role","menu"),e.setAttribute("aria-haspopup","true");const i=document.createElement("div"),s=document.createElement("div");if(s.style.border=`solid 1px ${this.borderColour_}`,e.style.backgroundColor=this.backgroundColour_,i.style.backgroundColor=this.backgroundColour_,s.style.backgroundColor=this.backgroundColour_,e.className="blocklyGridPickerMenu",i.className="blocklyGridPickerScroller",s.className="blocklyGridPickerPadder",s.appendChild(i),i.appendChild(e),t.appendChild(s),this.hasSearchBar_){const t=this.createSearchBar_(e,i,n);s.insertBefore(t,s.childNodes[0])}return this.shouldShowTooltips()||(this.selectedBar_=this.createSelectedBar_(),s.appendChild(this.selectedBar_)),this.populateTableContainer(n,e,i),{paddingContainer:s,scrollContainer:i}}createSearchBar_(e,t,n){const r=document.createElement("div");r.setAttribute("class","ui fluid icon input");const i=document.createElement("i");i.setAttribute("class","search icon");const s=document.createElement("input");return s.setAttribute("type","search"),s.setAttribute("id","search-bar"),s.setAttribute("class","blocklyGridPickerSearchBar"),s.setAttribute("placeholder",pxt.Util.lf("Search")),s.addEventListener("click",(()=>{s.focus(),s.setSelectionRange(0,s.value.length)})),s.addEventListener("keyup",pxt.Util.debounce((()=>{let r=s.value,i=new RegExp(r,"i"),o=n.filter((e=>{const t=e[0].alt,n=e[1];return t?i.test(t):i.test(n)}));this.populateTableContainer.bind(this)(o,e,t),r?this.highlightFirstItem(e):this.highlightAndScrollSelected(e,t),this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"}),300,!1)),s.addEventListener("keyup",(t=>{if(13==t.which){const t=e.childNodes[0];if(t){const e=t.childNodes[0];e&&(this.closeModal_=!0,e.click())}}})),r.appendChild(s),r.appendChild(i),r}createSelectedBar_(){const e=document.createElement("div");e.setAttribute("class","blocklyGridPickerSelectedBar"),e.style.display="none";const t=document.createElement("div"),n=document.createElement("div");n.className="blocklyGridPickerSelectedImage",t.appendChild(n),this.selectedImg_=document.createElement("img"),this.selectedImg_.setAttribute("width","30px"),this.selectedImg_.setAttribute("height","30px"),this.selectedImg_.setAttribute("draggable","false"),this.selectedImg_.style.display="none",this.selectedImg_.src=s.DEFAULT_IMG,n.appendChild(this.selectedImg_),this.selectedBarText_=document.createElement("span"),this.selectedBarText_.className="blocklyGridPickerTooltip",t.appendChild(this.selectedBarText_);const i=document.createElement("div"),o=document.createElement("div");o.className="ui buttons mini",i.appendChild(o);const a=document.createElement("button");a.className="ui button icon green";const l=document.createElement("i");l.className="icon check",a.appendChild(l),r.browserEvents.conditionalBind(a,"click",this,(()=>{this.setValue(this.selectedBarValue_),this.close()}));const c=document.createElement("button");c.className="ui button icon red";const u=document.createElement("i");return u.className="icon cancel",c.appendChild(u),r.browserEvents.conditionalBind(c,"click",this,(()=>{this.close()})),o.appendChild(a),o.appendChild(c),e.appendChild(t),e.appendChild(i),e}updateSelectedBar_(e,t){e.src&&(this.selectedImg_.src=e.src,this.selectedImg_.style.display=""),this.selectedImg_.alt=e.alt||e,this.selectedBarText_.textContent=e.alt||e,this.selectedBarValue_=t}setupIntersectionObserver_(){"IntersectionObserver"in window&&(this.disposeIntersectionObserver(),this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.intersectionRatio>0&&(this.observer.unobserve(e.target),(e=>{const t=e.getAttribute("data-src");t&&(e.src=t,e.removeAttribute("data-src"))})(e.target))}))}),{rootMargin:"20px 0px",threshold:.01}))}disposeIntersectionObserver(){this.observer&&(this.observer=null)}disposeTooltip(){this.gridTooltip_&&(pxsim.U.remove(this.gridTooltip_),this.gridTooltip_=null)}onClose_(){this.disposeTooltip()}}n.FieldGridPicker=s,s.DEFAULT_IMG="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="},{"./field_utils":64,blockly:154}],35:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldImageDropdown=void 0;const r=e("blockly"),i=e("./field_utils"),s=e("./field_dropdown");class o extends s.FieldDropdown{constructor(e,t,n){super(t.data),this.isFieldCustom_=!0,this.buttonClick_=e=>{let t=e.target.getAttribute("data-value");t&&(this.setValue(t),r.DropDownDiv.hide())},this.columns_=parseInt(t.columns),this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||300,this.backgroundColour_=(0,i.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1)}showEditor_(){if(r.DropDownDiv.hideIfOwner(this))return;r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent();let e=r.DropDownDiv.getContentDiv(),t=document.createElement("div");t.setAttribute("role","menu"),t.setAttribute("aria-haspopup","true");const n=this.getOptions();let i=0;for(let e=0;e<n.length;e++){let s=n[e][0];const o=n[e][1];if("placeholder"==s.type){let e=document.createElement("span");e.setAttribute("class","blocklyDropDownPlaceholder"),e.style.width=s.width+"px",e.style.height=s.height+"px",t.appendChild(e);continue}let a=document.createElement("button");a.setAttribute("id",":"+e),a.setAttribute("role","menuitem"),a.setAttribute("class","blocklyDropDownButton"),a.title=s.alt;let l=s.height;this.columns_?(l=this.width_/this.columns_-8,a.style.width=l+"px",a.style.height=l+"px"):(a.style.width=s.width+"px",a.style.height=s.height+"px"),l>i&&(i=l);let c=this.backgroundColour_;o==this.getValue()&&(c=this.sourceBlock_.getColourTertiary(),a.setAttribute("aria-selected","true")),a.style.backgroundColor=c,a.style.borderColor=this.borderColour_,r.browserEvents.bind(a,"click",this,this.buttonClick_),r.browserEvents.bind(a,"mouseover",this,(()=>{a.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),t.setAttribute("aria-activedescendant",a.id)})),r.browserEvents.bind(a,"mouseout",this,(()=>{a.setAttribute("class","blocklyDropDownButton"),t.removeAttribute("aria-activedescendant")}));let u=document.createElement("img");u.src=s.src,a.setAttribute("data-value",o),u.setAttribute("data-value",o),a.appendChild(u),t.appendChild(a)}t.style.width=this.width_+"px",e.appendChild(t),this.maxRows_&&(e.style.maxHeight=(this.maxRows_+.4)*(i+8)+"px"),pxt.BrowserUtils.isFirefox()&&(e.style.paddingRight="20px"),r.DropDownDiv.setColour(this.backgroundColour_,this.borderColour_),r.DropDownDiv.showPositionedByField(this,this.onHide_.bind(this));let s=this.sourceBlock_;this.savedPrimary_=null==s?void 0:s.getColour(),(null==s?void 0:s.isShadow())?s.setColour(s.getColourTertiary()):this.borderRect_&&this.borderRect_.setAttribute("fill",s.getColourTertiary())}doValueUpdate_(e){this.selectedOption_=void 0,super.doValueUpdate_(e)}onHide_(){let e=r.DropDownDiv.getContentDiv();e.removeAttribute("role"),e.removeAttribute("aria-haspopup"),e.removeAttribute("aria-activedescendant"),e.style.width="",e.style.paddingRight="",e.style.maxHeight="";let t=this.sourceBlock_;(null==t?void 0:t.isShadow())?this.sourceBlock_.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}}n.FieldImageDropdown=o,r.Css.register("\n.blocklyDropDownButton {\n    display: inline-block;\n    float: left;\n    padding: 0;\n    margin: 4px;\n    border-radius: 4px;\n    outline: none;\n    border: 1px solid;\n    transition: box-shadow .1s;\n    cursor: pointer;\n}\n\n.blocklyDropDownButtonHover {\n    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);\n}\n\n.blocklyDropDownButton:active {\n    box-shadow: 0px 0px 0px 6px rgba(255, 255, 255, 0.2);\n}\n\n.blocklyDropDownButton > img {\n    width: 80%;\n    height: 80%;\n    margin-top: 5%\n}\n")},{"./field_dropdown":33,"./field_utils":64,blockly:154}],36:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldImages=void 0;const r=e("blockly"),i=e("./field_imagedropdown");class s extends i.FieldImageDropdown{constructor(e,t,n){super(e,t,n),this.isFieldCustom_=!0,this.shouldSort_=t.sort,this.addLabel_=!!t.addLabel}showEditor_(){if(r.DropDownDiv.hideIfOwner(this))return;let e=this.sourceBlock_;r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent();let t=r.DropDownDiv.getContentDiv(),n=document.createElement("div");n.setAttribute("role","menu"),n.setAttribute("aria-haspopup","true");const i=this.getOptions();this.shouldSort_&&i.sort();for(let t=0;t<i.length;t++){const s=i[t][0],o=i[t][1];if("placeholder"==s.type){let e=document.createElement("span");e.setAttribute("class","blocklyDropDownPlaceholder"),e.style.width=s.width+"px",e.style.height=s.height+"px",n.appendChild(e);continue}let a=document.createElement("button");a.setAttribute("id",":"+t),a.setAttribute("role","menuitem"),a.setAttribute("class","blocklyDropDownButton"),a.title=s.alt,this.columns_?a.style.width=this.width_/this.columns_-8+"px":(a.style.width=s.width+"px",a.style.height=s.height+"px");let l=e.getColour();o==this.getValue()&&(l=e.getColourTertiary(),a.setAttribute("aria-selected","true")),a.style.backgroundColor=l,a.style.borderColor=e.getColourTertiary(),r.browserEvents.bind(a,"click",this,this.buttonClick_),r.browserEvents.bind(a,"mouseover",this,(()=>{a.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),n.setAttribute("aria-activedescendant",a.id)})),r.browserEvents.bind(a,"mouseout",this,(()=>{a.setAttribute("class","blocklyDropDownButton"),n.removeAttribute("aria-activedescendant")}));let c=document.createElement("img");if(c.src=s.src,a.setAttribute("data-value",o),c.setAttribute("data-value",o),a.appendChild(c),this.addLabel_){const e=this.createTextNode_(s.alt);e.setAttribute("data-value",o),a.appendChild(e)}n.appendChild(a)}n.style.width=this.width_+"px",t.appendChild(n),r.DropDownDiv.setColour(e.getColour(),e.getColourTertiary()),r.DropDownDiv.showPositionedByField(this,this.onHideCallback.bind(this)),this.savedPrimary_=null==e?void 0:e.getColour(),(null==e?void 0:e.isShadow())?e.setColour(e.style.colourTertiary):this.borderRect_&&this.borderRect_.setAttribute("fill",e.style.colourTertiary)}onHideCallback(){let e=this.sourceBlock_;(null==e?void 0:e.isShadow())?e.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}createTextNode_(e){const t=document.createElement("span");return t.setAttribute("class","blocklyDropdownTextLabel"),t.textContent=e,t}}n.FieldImages=s},{"./field_imagedropdown":35,blockly:154}],37:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldKind=void 0;const r=e("blockly"),i=e("./field_utils"),s=e("../external"),o=e("./field_dropdown");class a extends o.FieldDropdown{constructor(e){super(function(e){return function(){const t=[],n=this.getSourceBlock();return(null==n?void 0:n.workspace)&&!n.isInFlyout?n.workspace.getVariablesOfType(h(e.name)).forEach((e=>{t.push([e.name,e.name])})):e.initialMembers.forEach((e=>t.push([e,e]))),t.push([lf("Add a new {0}...",e.memberName),"CREATE"]),t.push([void 0,"SEPARATOR"]),t.push([lf("Rename {0}...",e.memberName),"RENAME"]),t.push([lf("Delete {0}...",e.memberName),"DELETE"]),t}}(e)),this.opts=e}initView(){super.initView()}onItemSelected_(e,t){const n=t.getValue();if("CREATE"===n)c(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),(e=>e&&this.setValue(e)));else if("RENAME"===n){const e=this.sourceBlock_.workspace,t=e.getVariable(this.value_,h(this.opts.name)),n=t.name;if(-1!==this.opts.initialMembers.indexOf(n))return void r.dialog.alert(lf("The built-in {0} '{1}' cannot be renamed. Try creating a new kind instead!",this.opts.memberName,n));u(e,Object.assign(Object.assign({},this.opts),{toRename:t}),lf("Rename '{0}':",n),(t=>{const r=(0,i.getAllFields)(e,(e=>e instanceof a&&e.getValue()===n&&e.opts.name===this.opts.name));for(const e of r)e.ref.setValue(t)}))}else if("DELETE"===n){const e=this.sourceBlock_.workspace,t=e.getVariable(this.value_,h(this.opts.name)),n=t.name;if(-1!==this.opts.initialMembers.indexOf(n))return void r.dialog.alert(lf("The built-in {0} '{1}' cannot be deleted.",this.opts.memberName,n));const s=(0,i.getAllFields)(e,(e=>e instanceof a&&e.getValue()===n&&e.opts.name===this.opts.name));s.length>1?r.dialog.confirm(lf('Delete {0} uses of the "{1}" {2}?',s.length,n,this.opts.memberName),(n=>{if(n){r.Events.setGroup(!0);for(const e of s)e.block.dispose(!0);e.deleteVariableById(t.getId()),this.setValue(this.opts.initialMembers[0]),r.Events.setGroup(!1)}})):(e.deleteVariableById(t.getId()),this.setValue(this.opts.initialMembers[0]))}else super.onItemSelected_(e,t)}doClassValidation_(e){var t;return(null===(t=this.opts)||void 0===t?void 0:t.initialMembers)&&!this.opts.initialMembers.find((t=>t==e))&&this.getOptions(),super.doClassValidation_(e)}getOptions(e){return this.initVariables(),super.getOptions(e)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){const e=this.sourceBlock_.workspace,t=d(e,this.opts.name);this.opts.initialMembers.forEach((n=>{-1===t.indexOf(n)&&p(e,this.opts,n)})),"CREATE"!==this.getValue()&&"RENAME"!==this.getValue()&&"DELETE"!==this.getValue()||this.opts.initialMembers.length&&this.setValue(this.opts.initialMembers[0])}}}function l(e,t,n,i,o){(0,s.prompt)(n,null,(s=>{if(s){let a=!1;if(pxtc.isIdentifierStart(s.charCodeAt(0),2)){a=!0;for(let e=1;e<s.length;e++)pxtc.isIdentifierPart(s.charCodeAt(e),2)||(a=!1)}if(!a)return void r.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),(()=>l(e,t,n,i,o)));if(pxt.blocks.isReservedWord(s)||"CREATE"===s||"RENAME"===s||"DELETE"===s)return void r.dialog.alert(lf("'{0}' is a reserved word and cannot be used.",s),(()=>l(e,t,n,i,o)));const c=d(e,t.name);for(let a=0;a<c.length;a++)if(c[a]===s)return void r.dialog.alert(lf("A {0} named '{1}' already exists.",t.memberName,s),(()=>l(e,t,n,i,o)));s===t.createFunctionName&&r.dialog.alert(lf("'{0}' is a reserved name.",t.createFunctionName),(()=>l(e,t,n,i,o))),i(s)}}),{placeholder:t.promptHint})}function c(e,t,n,r){l(e,t,n,(n=>{r(p(e,t,n))}),c)}function u(e,t,n,r){l(e,t,n,(n=>{e.getVariableMap().renameVariable(t.toRename,n),r(n)}),u)}function d(e,t){const n=e.getVariablesOfType(h(t));return n&&n.length?n.map((e=>e.name)):[]}function p(e,t,n){return r.Variables.getOrCreateVariablePackage(e,null,n,h(t.name)),n}function h(e){return"KIND_"+e}n.FieldKind=a},{"../external":24,"./field_dropdown":33,"./field_utils":64,blockly:154}],38:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldMatrix=void 0;const r=e("blockly"),i=/^.*[\.#].*$/;var s,o;(o=s||(s={}))[o.None=0]="None",o[o.Number=1]="Number",o[o.Letter=2]="Letter";class a extends r.Field{constructor(e,t,n){if(super(e,n),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.onColor="#FFFFFF",this.scale=1,this.matrixWidth=5,this.matrixHeight=5,this.yAxisLabel=s.None,this.xAxisLabel=s.None,this.cellState=[],this.cells=[],this.dontHandleMouseEvent_=e=>{e.stopPropagation(),e.preventDefault()},this.clearLedDragHandler=e=>{const t=this.sourceBlock_.getSvgRoot();pxsim.pointerEvents.down.forEach((e=>t.removeEventListener(e,this.dontHandleMouseEvent_))),t.removeEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.removeEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.removeEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),r.Touch.clearTouchIdentifier(),this.elt.removeEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),e.stopPropagation(),e.preventDefault()},this.toggleRect=(e,t)=>{this.cellState[e][t]=this.currentDragState_,this.updateValue()},this.handleRootMouseMoveListener=e=>{let t,n;e.changedTouches&&1==e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):(t=e.clientX,n=e.clientY);const r=document.elementFromPoint(t,n);if(!r)return;const i=r.getAttribute("data-x"),s=r.getAttribute("data-y");null!=i&&null!=s&&this.toggleRect(parseInt(i),parseInt(s))},this.params=t,void 0!==this.params.rows){let e=parseInt(this.params.rows);isNaN(e)||(this.matrixHeight=e)}if(void 0!==this.params.columns){let e=parseInt(this.params.columns);isNaN(e)||(this.matrixWidth=e)}void 0!==this.params.onColor&&(this.onColor=this.params.onColor),void 0!==this.params.offColor&&(this.offColor=this.params.offColor),void 0!==this.params.scale?this.scale=Math.max(.6,Math.min(2,Number(this.params.scale))):Math.max(this.matrixWidth,this.matrixHeight)>15?this.scale=.85:Math.max(this.matrixWidth,this.matrixHeight)>10&&(this.scale=.9)}showEditor_(){}initMatrix(){if(!this.sourceBlock_.isInsertionMarker()){this.elt=pxsim.svg.parseString('<svg xmlns="http://www.w3.org/2000/svg" id="field-matrix" />');for(let e=0;e<this.matrixWidth;e++){this.cellState.push([]),this.cells.push([]);for(let t=0;t<this.matrixHeight;t++)this.cellState[e].push(!1)}this.restoreStateFromString();for(let e=0;e<this.matrixWidth;e++)for(let t=0;t<this.matrixHeight;t++)this.createCell(e,t);if(this.updateValue(),this.xAxisLabel!==s.None){const e=this.scale*this.matrixHeight*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+2*a.CELL_VERTICAL_MARGIN+a.BOTTOM_MARGIN,t=pxsim.svg.child(this.elt,"g",{transform:`translate(0 ${e})`});for(let e=0;e<this.matrixWidth;e++){const n=this.getYAxisWidth()+this.scale*e*(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)+a.CELL_WIDTH/2+a.CELL_HORIZONTAL_MARGIN/2;pxsim.svg.child(t,"text",{x:n,class:"blocklyText"}).textContent=this.getLabel(e,this.xAxisLabel)}}if(this.yAxisLabel!==s.None){const e=pxsim.svg.child(this.elt,"g",{});for(let t=0;t<this.matrixHeight;t++){const n=this.scale*t*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+a.CELL_WIDTH/2+2*a.CELL_VERTICAL_MARGIN;pxsim.svg.child(e,"text",{x:0,y:n,class:"blocklyText"}).textContent=this.getLabel(t,this.yAxisLabel)}}this.fieldGroup_.replaceChild(this.elt,this.fieldGroup_.firstChild)}}getLabel(e,t){switch(t){case s.Letter:return String.fromCharCode(e+65);default:return(e+1).toString()}}createCell(e,t){const n=this.scale*e*(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)+a.CELL_HORIZONTAL_MARGIN+this.getYAxisWidth(),i=this.scale*t*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+a.CELL_VERTICAL_MARGIN,s=pxsim.svg.child(this.elt,"g",{transform:`translate(${n} ${i})`}),o=pxsim.svg.child(s,"rect",{class:"blocklyLed"+(this.cellState[e][t]?"On":"Off"),cursor:"pointer",width:this.scale*a.CELL_WIDTH,height:this.scale*a.CELL_WIDTH,fill:this.getColor(e,t),"data-x":e,"data-y":t,rx:Math.max(2,this.scale*a.CELL_CORNER_RADIUS)});this.cells[e][t]=o,this.sourceBlock_.workspace.isFlyout||pxsim.pointerEvents.down.forEach((n=>o.addEventListener(n,(n=>{const i=this.sourceBlock_.getSvgRoot();this.currentDragState_=!this.cellState[e][t],r.hideChaff(),this.sourceBlock_.select(),this.toggleRect(e,t),pxsim.pointerEvents.down.forEach((e=>i.addEventListener(e,this.dontHandleMouseEvent_))),i.addEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.addEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.addEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),this.elt.addEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),n.stopPropagation(),n.preventDefault()}),!1)))}getColor(e,t){return this.cellState[e][t]?this.onColor:this.offColor||a.DEFAULT_OFF_COLOR}getOpacity(e,t){const n=this.offColor?"1.0":"0.2";return this.cellState[e][t]?"1.0":n}updateCell(e,t){const n=this.cells[e][t];n.setAttribute("fill",this.getColor(e,t)),n.setAttribute("fill-opacity",this.getOpacity(e,t)),n.setAttribute("class","blocklyLed"+(this.cellState[e][t]?"On":"Off"))}setValue(e,t=!0){if(super.setValue(String(e)),this.elt){t&&this.restoreStateFromString();for(let e=0;e<this.matrixWidth;e++)for(let t=0;t<this.matrixHeight;t++)this.updateCell(e,t)}}render_(){this.visible_?(this.elt||this.initMatrix(),this.size_.height=this.scale*Number(this.matrixHeight)*(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)+2*a.CELL_VERTICAL_MARGIN+a.BOTTOM_MARGIN+this.getXAxisHeight(),this.size_.width=this.scale*Number(this.matrixWidth)*(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)+this.getYAxisWidth()):this.markDirty()}getValue(){let e=function(e){const t=(e=(e||"").trim()).charAt(0);return t===e.charAt(e.length-1)&&-1!==u.indexOf(t)?e.substr(1,e.length-2).trim():e}(this.value_);return`\`\n${a.TAB}${e}\n${a.TAB}\``}restoreStateFromString(){let e=this.value_;if(e){const t=e.split("\n").filter((e=>i.test(e)));for(let e=0;e<t.length&&e<this.matrixHeight;e++){let n=0;const r=t[e];for(let t=0;t<r.length&&n<this.matrixWidth;t++)c(r[t])?(this.cellState[n][e]=!1,n++):l(r[t])&&(this.cellState[n][e]=!0,n++)}}}updateValue(){let e="";for(let t=0;t<this.matrixHeight;t++){for(let n=0;n<this.matrixWidth;n++)e+=(this.cellState[n][t]?"#":".")+" ";e+="\n"+a.TAB}this.setValue(e,!1)}getYAxisWidth(){return this.yAxisLabel===s.None?0:a.Y_AXIS_WIDTH}getXAxisHeight(){return this.xAxisLabel===s.None?0:a.X_AXIS_HEIGHT}}function l(e){return"#"===e||"*"===e||"1"===e}function c(e){return"."===e||"_"===e||"0"===e}n.FieldMatrix=a,a.CELL_WIDTH=25,a.CELL_HORIZONTAL_MARGIN=7,a.CELL_VERTICAL_MARGIN=5,a.CELL_CORNER_RADIUS=5,a.BOTTOM_MARGIN=9,a.Y_AXIS_WIDTH=9,a.X_AXIS_HEIGHT=10,a.TAB="        ",a.DEFAULT_OFF_COLOR="#000000";const u=["'",'"',"`"]},{blockly:154}],39:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldCustomMelody=n.TOTAL_WIDTH=n.HEADER_HEIGHT=void 0;const r=e("blockly");var i=pxt.svgUtil;const s=e("./field_utils");n.HEADER_HEIGHT=50,n.TOTAL_WIDTH=300;class o extends r.Field{constructor(e,t,n){super(e,n),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.soundingKeys=0,this.numRow=8,this.numCol=8,this.tempo=120,this.isPlaying=!1,this.timeouts=[],this.params=t,this.createMelodyIfDoesntExist()}init(){super.init(),this.onInit()}showEditor_(){r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent(),r.DropDownDiv.setColour(this.getDropdownBackgroundColour(),this.getDropdownBorderColour());let e=r.DropDownDiv.getContentDiv();pxt.BrowserUtils.addClass(e,"melody-content-div"),pxt.BrowserUtils.addClass(e.parentElement,"melody-editor-dropdown"),this.gallery=new pxtmelody.MelodyGallery,this.renderEditor(e),this.prevString=this.getValue(),(0,s.setMelodyEditorOpen)(this.sourceBlock_,!0),r.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,(()=>{this.onEditorClose(),pxt.BrowserUtils.removeClass(e,"melody-content-div"),pxt.BrowserUtils.removeClass(e.parentElement,"melody-editor-dropdown"),(0,s.setMelodyEditorOpen)(this.sourceBlock_,!1)}))}getValue(){return this.stringRep=this.getTypeScriptValue(),this.stringRep}doValueUpdate_(e){null==e||""==e||'""'==e||this.stringRep&&this.stringRep===e||(this.stringRep=e,this.parseTypeScriptValue(e),super.doValueUpdate_(this.getValue()))}getText_(){return this.invalidString?pxt.Util.lf("Invalid Input"):this.getValue()}onInit(){this.render_(),this.createMelodyIfDoesntExist(),this.invalidString||(this.fieldGroup_||(this.fieldGroup_=r.utils.dom.createSvgElement("g",{},null)),this.visible_||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.updateFieldLabel())}render_(){super.render_(),this.invalidString||(this.size_.width=o.MUSIC_ICON_WIDTH+(o.COLOR_BLOCK_WIDTH+o.COLOR_BLOCK_SPACING)*this.numCol),this.sourceBlock_.setColour("#ffffff")}renderEditor(e){let t=this.getDropdownBackgroundColour(),r=this.getDropdownBorderColour();this.topDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.topDiv,"melody-top-bar-div"),this.root=new i.SVG(this.topDiv).id("melody-editor-header-controls"),this.toggle=new c(this.root,{leftText:lf("Editor"),rightText:lf("Gallery"),baseColor:t}),this.toggle.onStateChange((e=>{e?this.hideGallery():this.showGallery()})),this.toggle.layout(),this.toggle.translate((n.TOTAL_WIDTH-this.toggle.width())/2,0),e.appendChild(this.topDiv),e.appendChild(this.gallery.getElement()),this.editorDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.editorDiv,"melody-editor-div"),this.editorDiv.style.setProperty("background-color",r),this.gridDiv=this.createGridDisplay(),this.editorDiv.appendChild(this.gridDiv),this.bottomDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.bottomDiv,"melody-bottom-bar-div"),this.doneButton=document.createElement("button"),pxt.BrowserUtils.addClass(this.doneButton,"melody-confirm-button"),this.doneButton.innerText=lf("Done"),this.doneButton.addEventListener("click",(()=>this.onDone())),this.doneButton.style.setProperty("background-color",t),this.playButton=document.createElement("button"),this.playButton.id="melody-play-button",this.playButton.addEventListener("click",(()=>this.togglePlay())),this.playIcon=document.createElement("i"),this.playIcon.id="melody-play-icon",pxt.BrowserUtils.addClass(this.playIcon,"play icon"),this.playButton.appendChild(this.playIcon),this.tempoInput=document.createElement("input"),pxt.BrowserUtils.addClass(this.tempoInput,"ui input"),this.tempoInput.type="number",this.tempoInput.title=lf("tempo"),this.tempoInput.id="melody-tempo-input",this.tempoInput.addEventListener("input",(()=>this.setTempo(+this.tempoInput.value))),this.syncTempoField(!0),this.bottomDiv.appendChild(this.tempoInput),this.bottomDiv.appendChild(this.playButton),this.bottomDiv.appendChild(this.doneButton),this.editorDiv.appendChild(this.bottomDiv),e.appendChild(this.editorDiv)}onEditorClose(){this.stopMelody(),this.gallery&&this.gallery.stopMelody(),this.clearDomReferences(),this.sourceBlock_&&r.Events.isEnabled()&&this.getValue()!==this.prevString&&r.Events.fire(new r.Events.BlockChange(this.sourceBlock_,"field",this.name,this.prevString,this.getValue())),this.prevString=void 0}onDone(){r.DropDownDiv.hideIfOwner(this),this.onEditorClose()}clearDomReferences(){this.topDiv=null,this.editorDiv=null,this.gridDiv=null,this.bottomDiv=null,this.doneButton=null,this.playButton=null,this.playIcon=null,this.tempoInput=null,this.elt=null,this.cells=null,this.toggle=null,this.root=null,this.gallery.clearDomReferences()}getTypeScriptValue(){return this.invalidString?this.invalidString:this.melody?'"'+this.melody.getStringRepresentation()+'"':""}parseTypeScriptValue(e){let t=e;try{e=(e=e.slice(1,-1)).trim(),this.createMelodyIfDoesntExist();let t=e.split(" ");t.forEach((e=>{if(!this.isValidNote(e))throw new Error(lf("Invalid note '{0}'. Notes can be C D E F G A B C5",e))})),this.melody.resetMelody();for(let e=0;e<t.length;e++)if("-"!=t[e]){let n=pxtmelody.noteToRow(t[e]);this.melody.updateMelody(n,e)}this.updateFieldLabel()}catch(e){pxt.log(e),this.invalidString=t}}isValidNote(e){switch(e){case"C":case"D":case"E":case"F":case"G":case"A":case"B":case"C5":case"-":return!0}return!1}getPreviewWidth(){return this.updateSize_(),this.size_.width}getPreviewHeight(){var e;return(null===(e=this.getConstants())||void 0===e?void 0:e.FIELD_BORDER_RECT_HEIGHT)||16}getDropdownBackgroundColour(){const e=this.sourceBlock_.getParent();return e?e.getColour():"#3D3D3D"}getDropdownBorderColour(){const e=this.sourceBlock_.getParent();return e?e.getColourTertiary():"#2A2A2A"}updateFieldLabel(){if(!this.fieldGroup_)return;pxsim.U.clear(this.fieldGroup_);let e=u("").appendClass("melody-editor-field-icon").at(6,15);this.fieldGroup_.appendChild(e.el);let t=this.melody.getStringRepresentation().trim().split(" ");for(let e=0;e<t.length;e++){let n=pxtmelody.getColorClass(pxtmelody.noteToRow(t[e]));const r=(new i.Rect).at((o.COLOR_BLOCK_WIDTH+o.COLOR_BLOCK_SPACING)*e+o.COLOR_BLOCK_X,o.COLOR_BLOCK_Y).size(o.COLOR_BLOCK_WIDTH,o.COLOR_BLOCK_HEIGHT).stroke("#898989",1).fill(d(pxtmelody.noteToRow(t[e]))).corners(3,2);pxt.BrowserUtils.addClass(r.el,n),this.fieldGroup_.appendChild(r.el)}}setTempo(e){(isNaN(e)||e<=0)&&this.tempoInput?this.tempoInput.value=this.tempo+"":this.tempo!=e&&(this.tempo=e,this.melody&&this.melody.setTempo(this.tempo),this.tempoInput&&(this.tempoInput.value=this.tempo+""),this.syncTempoField(!1))}syncTempoField(e){const t=this.sourceBlock_.getParent();if(t)for(const n of t.inputList)if("tempo"===n.name||"bpm"===n.name){const t=n.connection.targetBlock();t&&(e?t.getFieldValue("SLIDER")?(this.tempoInput.value=t.getFieldValue("SLIDER"),this.tempo=+this.tempoInput.value):this.tempoInput.value=this.tempo+"":("math_number_minmax"===t.type?t.setFieldValue(this.tempoInput.value,"SLIDER"):t.setFieldValue(this.tempoInput.value,"NUM"),this.tempoInput.focus()));break}}getDuration(){return 6e4/this.tempo}createMelodyIfDoesntExist(){return!this.melody&&(this.melody=new pxtmelody.MelodyArray,!0)}onNoteSelect(e,t){this.invalidString=null,this.melody.updateMelody(e,t),this.melody.getValue(e,t)&&!this.isPlaying&&this.playNote(e,t),this.updateGrid(),this.updateFieldLabel()}updateGrid(){for(let e=0;e<this.numRow;e++){const t=pxtmelody.getColorClass(e);for(let n=0;n<this.numCol;n++){const r=this.cells[e][n];this.melody.getValue(e,n)?(pxt.BrowserUtils.removeClass(r,"melody-default"),pxt.BrowserUtils.addClass(r,t)):(pxt.BrowserUtils.addClass(r,"melody-default"),pxt.BrowserUtils.removeClass(r,t))}}}playNote(e,t){let n=++this.soundingKeys;this.isPlaying?(this.timeouts.push(setTimeout((()=>{this.playToneCore(e)}),t*this.getDuration())),this.timeouts.push(setTimeout((()=>{pxt.AudioContextManager.stop()}),(t+1)*this.getDuration()))):(this.playToneCore(e),this.timeouts.push(setTimeout((()=>{this.soundingKeys==n&&pxt.AudioContextManager.stop()}),this.getDuration())))}queueToneForColumn(e,t,n){const r=setTimeout((()=>{++this.soundingKeys,pxt.AudioContextManager.stop();for(let t=0;t<this.numRow;t++)this.melody.getValue(t,e)&&this.playToneCore(t);this.highlightColumn(e,!0),this.timeouts=this.timeouts.filter((e=>e!==r))}),t),i=setTimeout((()=>{this.timeouts=this.timeouts.filter((e=>e!==i)),this.highlightColumn(e,!1)}),t+n);this.timeouts.push(r),this.timeouts.push(i)}playToneCore(e){let t=0;switch(e){case 0:t=523;break;case 1:t=494;break;case 2:t=440;break;case 3:t=392;break;case 4:t=349;break;case 5:t=330;break;case 6:t=294;break;case 7:t=262}pxt.AudioContextManager.tone(t)}highlightColumn(e,t){this.cells.map((t=>t[e])).forEach((e=>{t?pxt.BrowserUtils.addClass(e,"playing"):pxt.BrowserUtils.removeClass(e,"playing")}))}createGridDisplay(){o.VIEWBOX_WIDTH=(o.CELL_WIDTH+o.CELL_VERTICAL_MARGIN)*this.numCol+o.CELL_VERTICAL_MARGIN,pxt.BrowserUtils.isEdge()&&(o.VIEWBOX_WIDTH+=37),o.VIEWBOX_HEIGHT=(o.CELL_WIDTH+o.CELL_HORIZONTAL_MARGIN)*this.numRow+o.CELL_HORIZONTAL_MARGIN,this.elt=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" class="melody-grid-div" viewBox="0 0 ${o.VIEWBOX_WIDTH} ${o.VIEWBOX_HEIGHT}"/>`),this.cells=[];for(let e=0;e<this.numRow;e++)this.cells.push([]);for(let e=0;e<this.numRow;e++)for(let t=0;t<this.numCol;t++)this.createCell(e,t);return this.elt}createCell(e,t){const n=e*(o.CELL_WIDTH+o.CELL_HORIZONTAL_MARGIN)+o.CELL_HORIZONTAL_MARGIN,r=t*(o.CELL_WIDTH+o.CELL_VERTICAL_MARGIN)+o.CELL_VERTICAL_MARGIN,i=pxsim.svg.child(this.elt,"g",{transform:`translate(${r} ${n})`}),s=pxsim.svg.child(i,"rect",{cursor:"pointer",width:o.CELL_WIDTH,height:o.CELL_WIDTH,stroke:"white","data-x":e,"data-y":t,rx:o.CELL_CORNER_RADIUS});this.melody.getValue(e,t)?pxt.BrowserUtils.addClass(s,pxtmelody.getColorClass(e)):pxt.BrowserUtils.addClass(s,"melody-default"),this.sourceBlock_.workspace.isFlyout||(pxsim.pointerEvents.down.forEach((n=>s.addEventListener(n,(n=>{this.onNoteSelect(e,t),n.stopPropagation(),n.preventDefault()}),!1))),this.cells[e][t]=s)}togglePlay(){this.isPlaying?this.stopMelody():(this.isPlaying=!0,this.playMelody()),this.updatePlayButton()}updatePlayButton(){this.isPlaying?(pxt.BrowserUtils.removeClass(this.playIcon,"play icon"),pxt.BrowserUtils.addClass(this.playIcon,"stop icon")):(pxt.BrowserUtils.removeClass(this.playIcon,"stop icon"),pxt.BrowserUtils.addClass(this.playIcon,"play icon"))}playMelody(){if(this.isPlaying){for(let e=0;e<this.numCol;e++)this.queueToneForColumn(e,e*this.getDuration(),this.getDuration());this.timeouts.push(setTimeout((()=>this.playMelody()),this.numCol*this.getDuration()))}else this.stopMelody()}stopMelody(){if(this.isPlaying){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop(),this.isPlaying=!1,this.cells.forEach((e=>e.forEach((e=>pxt.BrowserUtils.removeClass(e,"playing")))))}}showGallery(){this.stopMelody(),this.updatePlayButton(),this.gallery.show((e=>{e&&(this.melody.parseNotes(e),this.gallery.hide(),this.toggle.toggle(),this.updateFieldLabel(),this.updateGrid())}))}hideGallery(){this.gallery.hide()}}n.FieldCustomMelody=o,o.CELL_WIDTH=25,o.CELL_HORIZONTAL_MARGIN=7,o.CELL_VERTICAL_MARGIN=5,o.CELL_CORNER_RADIUS=5,o.COLOR_BLOCK_WIDTH=10,o.COLOR_BLOCK_HEIGHT=20,o.COLOR_BLOCK_X=20,o.COLOR_BLOCK_Y=5,o.COLOR_BLOCK_SPACING=2,o.MUSIC_ICON_WIDTH=20;const a=200,l=40;class c{constructor(e,t){this.props=function(e){return e.baseColor||(e.baseColor="#e95153"),e.backgroundColor||(e.backgroundColor="rgba(52,73,94,.2)"),e.borderColor||(e.borderColor="rgba(52,73,94,.4)"),e.selectedTextColor||(e.selectedTextColor=e.baseColor),e.unselectedTextColor||(e.unselectedTextColor="hsla(0,0%,100%,.9)"),e.switchColor||(e.switchColor="#ffffff"),e}(t),this.root=e.group(),this.buildDom(),this.isLeft=!0}buildDom(){this.root.style().content("\n        .toggle-left {\n            transform: translateX(0px);\n            animation: mvleft 0.2s 0s ease;\n        }\n\n        .toggle-right {\n            transform: translateX(100px);\n            animation: mvright 0.2s 0s ease;\n        }\n\n        @keyframes mvright {\n            0% {\n                transform: translateX(0px);\n            }\n            100% {\n                transform: translateX(100px);\n            }\n        }\n\n        @keyframes mvleft {\n            0% {\n                transform: translateX(100px);\n            }\n            100% {\n                transform: translateX(0px);\n            }\n        }\n        "),this.root.def().create("clipPath","sprite-editor-toggle-border").clipPathUnits(!0).draw("rect").at(0,0).corners(.02,.1).size(1,1),this.root.draw("rect").size(a,l).fill(this.props.baseColor).stroke(this.props.borderColor,4).corners(4,4).clipPath("url(#sprite-editor-toggle-border)"),this.root.draw("rect").at(2,2).size(196,36).fill(this.props.backgroundColor).corners(4,4),this.switch=this.root.draw("rect").at(2,2).size(98,36).fill(this.props.switchColor).corners(4,4),this.leftElement=this.root.group(),this.leftText=u(this.props.leftText).appendClass("sprite-editor-text").fill(this.props.selectedTextColor),this.leftElement.appendChild(this.leftText),this.rightElement=this.root.group(),this.rightText=u(this.props.rightText).appendClass("sprite-editor-text").fill(this.props.unselectedTextColor),this.rightElement.appendChild(this.rightText),this.root.onClick((()=>this.toggle()))}toggle(e=!1){this.isLeft?(this.switch.removeClass("toggle-left"),this.switch.appendClass("toggle-right"),this.leftText.fill(this.props.unselectedTextColor),this.rightText.fill(this.props.selectedTextColor)):(this.switch.removeClass("toggle-right"),this.switch.appendClass("toggle-left"),this.leftText.fill(this.props.selectedTextColor),this.rightText.fill(this.props.unselectedTextColor)),this.isLeft=!this.isLeft,!e&&this.changeHandler&&this.changeHandler(this.isLeft)}onStateChange(e){this.changeHandler=e}layout(){this.leftText.moveTo(51,20),this.rightText.moveTo(149,20)}translate(e,t){this.root.translate(e,t)}height(){return l}width(){return a}}function u(e){return new i.Text(e).anchor("middle").setAttribute("dominant-baseline","middle").setAttribute("dy",pxt.BrowserUtils.isIE()||pxt.BrowserUtils.isEdge()?"0.3em":"0.1em")}function d(e){switch(e){case 0:return"#A80000";case 1:return"#D83B01";case 2:return"#FFB900";case 3:return"#107C10";case 4:return"#008272";case 5:return"#0078D7";case 6:return"#5C2D91";case 7:return"#B4009E"}return"#DCDCDC"}},{"./field_utils":64,blockly:154}],40:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldMusicEditor=void 0;var r=pxt.svgUtil;const i=e("./field_asset"),s=e("./field_utils");class o extends i.FieldAssetEditor{getAssetType(){return"song"}createNewAsset(e){const t=pxt.react.getTilemapProject();if(e){const n=pxt.lookupProjectAssetByTSReference(e,t);if(n)return n}if(this.getBlockData())return t.lookupAsset("song",this.getBlockData());let n;if(e){const t=/^\s*hex\s*`([a-fA-F0-9]+)`\s*(?:;?)\s*$/.exec(e);t&&(n=pxt.assets.music.decodeSongFromHex(t[1]))}else n=pxt.assets.music.getEmptySong(2);return n?(pxt.assets.music.inflateSong(n),{internalID:-1,id:this.sourceBlock_.id,type:"song",meta:{},song:n}):(this.isGreyBlock=!0,void(this.valueText=e))}render_(){super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=18+this.previewWidth())}getValueText(){return this.asset&&!this.isTemporaryAsset()?pxt.getTSReferenceForAsset(this.asset):this.asset?`hex\`${pxt.assets.music.encodeSongToHex(this.asset.song)}\``:this.valueText||""}parseFieldOptions(e){return{}}redrawPreview(){var e;if(!this.fieldGroup_)return;if(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock)return void super.redrawPreview();const t=18+this.previewWidth(),n=(new r.Rect).at(5,1).size(8+this.previewWidth(),40).setClass("blocklySpriteField").stroke("#898989",1).corner(4);if(this.fieldGroup_.appendChild(n.el),this.asset){const e=(0,s.songToDataURI)(this.asset.song,this.previewWidth(),32,this.lightMode);if(e){const t=(new r.Image).src(e).at(9,5).size(this.previewWidth(),32);this.fieldGroup_.appendChild(t.el)}}(null===(e=this.size_)||void 0===e?void 0:e.width)!=t&&this.forceRerender()}previewWidth(){return 32*(this.asset?this.asset.song.measures:2)}}n.FieldMusicEditor=o},{"./field_asset":28,"./field_utils":64}],41:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldNote=void 0;const r=e("blockly"),i=e("./field_utils");var s;!function(e){e[e.C=262]="C",e[e.CSharp=277]="CSharp",e[e.D=294]="D",e[e.Eb=311]="Eb",e[e.E=330]="E",e[e.F=349]="F",e[e.FSharp=370]="FSharp",e[e.G=392]="G",e[e.GSharp=415]="GSharp",e[e.A=440]="A",e[e.Bb=466]="Bb",e[e.B=494]="B",e[e.C3=131]="C3",e[e.CSharp3=139]="CSharp3",e[e.D3=147]="D3",e[e.Eb3=156]="Eb3",e[e.E3=165]="E3",e[e.F3=175]="F3",e[e.FSharp3=185]="FSharp3",e[e.G3=196]="G3",e[e.GSharp3=208]="GSharp3",e[e.A3=220]="A3",e[e.Bb3=233]="Bb3",e[e.B3=247]="B3",e[e.C4=262]="C4",e[e.CSharp4=277]="CSharp4",e[e.D4=294]="D4",e[e.Eb4=311]="Eb4",e[e.E4=330]="E4",e[e.F4=349]="F4",e[e.FSharp4=370]="FSharp4",e[e.G4=392]="G4",e[e.GSharp4=415]="GSharp4",e[e.A4=440]="A4",e[e.Bb4=466]="Bb4",e[e.B4=494]="B4",e[e.C5=523]="C5",e[e.CSharp5=555]="CSharp5",e[e.D5=587]="D5",e[e.Eb5=622]="Eb5",e[e.E5=659]="E5",e[e.F5=698]="F5",e[e.FSharp5=740]="FSharp5",e[e.G5=784]="G5",e[e.GSharp5=831]="GSharp5",e[e.A5=880]="A5",e[e.Bb5=932]="Bb5",e[e.B5=988]="B5",e[e.C6=1047]="C6",e[e.CSharp6=1109]="CSharp6",e[e.D6=1175]="D6",e[e.Eb6=1245]="Eb6",e[e.E6=1319]="E6",e[e.F6=1397]="F6",e[e.FSharp6=1480]="FSharp6",e[e.G6=1568]="G6",e[e.GSharp6=1568]="GSharp6",e[e.A6=1760]="A6",e[e.Bb6=1865]="Bb6",e[e.B6=1976]="B6",e[e.C7=2093]="C7"}(s||(s={}));class o extends r.FieldNumber{constructor(e,t,n){super(null,0,null,null,n),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.isTextValid_=!0,this.nKeys_=36,this.minNote_=28,this.maxNote_=63,this.eps=2,this.setSpellcheck(!1),this.prepareNotes(),this.isExpanded=!1,this.currentPage=0,this.totalPlayCount=0,t.editorColour&&(this.primaryColour=(0,i.parseColour)(t.editorColour),this.borderColour=r.utils.colour.blend("#000000",this.primaryColour,.2));const s=parseInt(t.eps);!Number.isNaN(s)&&s>=0&&(this.eps=s);const o=parseInt(t.minNote)||this.minNote_,a=parseInt(t.maxNote)||this.maxNote_;o>=28&&a<=75&&a>o&&(this.minNote_=o,this.maxNote_=a,this.nKeys_=this.maxNote_-this.minNote_+1),this.setValue(e)}doClassValidation_(e){const t=/^Note\.(.+)$/.exec(e),n=t&&t.length>1?t[1]:null;if(null===(e=s[n]?s[n]:String(parseFloat(e||"0"))))return null;const r=parseFloat(e||"0");if(isNaN(r)||r<0)return null;const i=Math.floor(r)!=r;return Number(r.toFixed(i?2:0))}getValue(){return this.value_+""}doValueUpdate_(e){isNaN(Number(e))||Number(e)<0||(this.sourceBlock_&&r.Events.isEnabled()&&this.value_!=e&&r.Events.fire(new r.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e)),this.value_=e,this.refreshText())}getText(){if(this.isExpanded)return""+this.value_;{const e=+this.value_;for(let t=0;t<this.nKeys_;t++)if(Math.abs(this.getKeyFreq(t+this.minNote_)-e)<this.eps)return this.getKeyName(t+this.minNote_);let t=e.toString();return isNaN(e)||(t+=" Hz"),t}}refreshText(){this.forceRerender()}onFinishEditing_(e){this.refreshText()}onHide(){this.isExpanded=!1,this.refreshText()}showEditor_(e){this.isExpanded=!0,this.updateColor(),r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent();const t=pxt.BrowserUtils.isMobile()||pxt.BrowserUtils.isIOS();super.showEditor_(e,t),this.refreshText(),r.Events.setGroup(!0),this.piano=[],this.currentSelectedKey=void 0;const n=this.nKeys_-this.nKeys_/o.notesPerOctave*o.blackKeysPerOctave,i=o.notesPerOctave-o.blackKeysPerOctave;let s=o.keyWidth*n,l=o.keyHeight+o.labelHeight;const c=window.innerWidth<s;c&&(s=i*o.keyWidth,l=o.keyHeight+o.labelHeight+o.prevNextHeight);const u=a("blocklyPianoDiv",`width: ${s}px;\n            height: ${l}px;`);r.DropDownDiv.getContentDiv().appendChild(u),this.noteLabel=a("blocklyNoteLabel",`top: ${o.keyHeight}px;\n            width: ${s}px;\n            background-color: ${this.primaryColour};\n            border-color: ${this.primaryColour};`),u.appendChild(this.noteLabel),this.noteLabel.textContent="-";let d=0;for(let e=0;e<this.nKeys_;e++){const t=Math.floor(e/o.notesPerOctave);let n=this.getPosition(e+this.minNote_);c&&e>=o.notesPerOctave&&(n-=i*t*o.keyWidth);const r=this.getKeyDiv(e+this.minNote_,n);this.piano.push(r),u.appendChild(r),Math.abs(this.getKeyFreq(e+this.minNote_)-Number(this.getValue()))<this.eps&&(pxt.BrowserUtils.addClass(r,"selected"),this.currentSelectedKey=r,d=t)}c&&(this.setPage(d),u.appendChild(this.getNextPrevDiv(!0,s)),u.appendChild(this.getNextPrevDiv(!1,s))),r.DropDownDiv.setColour(this.primaryColour,this.borderColour),r.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,(()=>this.onHide()))}playKey(e,t){const n=++this.totalPlayCount;this.currentSelectedKey!==e&&(this.currentSelectedKey&&pxt.BrowserUtils.removeClass(this.currentSelectedKey,"selected"),pxt.BrowserUtils.addClass(e,"selected"),this.setValue(t)),this.currentSelectedKey=e,this.htmlInput_.value=this.getText(),pxt.AudioContextManager.tone(t),setTimeout((()=>{this.totalPlayCount==n&&pxt.AudioContextManager.stop()}),300)}dispose(){r.DropDownDiv.hideIfOwner(this),super.dispose()}updateColor(){const e=this.sourceBlock_.getParent();e&&(this.sourceBlock_.isShadow()||function(e){return 1===e.inputList.length&&1===e.inputList[0].fieldRow.length}(this.sourceBlock_))?(this.primaryColour=e.getColour(),this.borderColour=e.getColourTertiary()):(this.primaryColour="#3D3D3D",this.borderColour="#2A2A2A")}setPage(e){const t=this.nKeys_/o.notesPerOctave;e=Math.max(Math.min(e,t-1),0),this.noteLabel.textContent=`Octave #${e+1}`;const n=e*o.notesPerOctave;for(let e=0;e<this.piano.length;++e){const t=e>=n&&e<n+o.notesPerOctave;this.piano[e].style.display=t?"block":"none"}this.currentPage=e}getNextPrevDiv(e,t){const n=e?0:t/2,i=a("blocklyNotePrevNext",`top: ${o.keyHeight+o.labelHeight}px;\n            left: ${n}px;\n            width: ${Math.ceil(t/2)}px;\n            ${e?"border-left-color":"border-right-color"}: ${this.primaryColour};\n            background-color: ${this.primaryColour};\n            border-bottom-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach((t=>{r.browserEvents.conditionalBind(i,t,this,(()=>this.setPage(e?this.currentPage-1:this.currentPage+1)),!0)})),i.textContent=e?"<":">",i}getKeyDiv(e,t){const n=a("blocklyNote "+(this.isWhite(e)?"":"black"),`width: ${this.getKeyWidth(e)}px;\n            height: ${this.getKeyHeight(e)}px;\n            left: ${t}px;\n            border-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach((t=>{r.browserEvents.conditionalBind(n,t,this,(()=>this.playKey(n,this.getKeyFreq(e))),!0)})),r.browserEvents.conditionalBind(n,"mouseover",this,(t=>{this.noteLabel.textContent=this.getKeyName(e),t.buttons&&this.playKey(n,this.getKeyFreq(e))}),!0),n}isWhite(e){switch((e+=8)%12){case 1:case 3:case 6:case 8:case 10:return!1;default:return!0}}whiteKeysBefore(e){switch((e+=8)%12){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return 2;case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5;case 10:case 11:return 6}return-1}getKeyWidth(e){return this.isWhite(e)?o.keyWidth:o.keyWidth/2}getKeyHeight(e){return this.isWhite(e)?o.keyHeight:o.keyHeight/2}getKeyFreq(e){return this.getKeyNoteData(e).freq}getKeyName(e){const t=this.getKeyNoteData(e);let n=t.prefixedName;return this.nKeys_<=o.notesPerOctave?n=t.name:this.minNote_>=28&&this.maxNote_<=63&&(n=t.altPrefixedName||n),n}getKeyNoteData(e){return o.Notes[e]}getPosition(e){if(e===this.minNote_)return 0;const t=o.keyWidth/4,n=Math.floor((this.minNote_+8)/o.notesPerOctave),r=Math.floor((e+8)/o.notesPerOctave);let i=this.whiteKeysBefore(this.minNote_)*o.keyWidth;if(this.isWhite(this.minNote_)||(i-=t),r>n){const s=7*o.keyWidth,a=s-i+(r-n-1)*s;return this.whiteKeysBefore(e)*o.keyWidth+a-(this.isWhite(e)?0:t)}return this.whiteKeysBefore(e)*o.keyWidth-i-(this.isWhite(e)?0:t)}prepareNotes(){o.Notes||(o.Notes={28:{name:lf("{id:note}C"),prefixedName:lf("Low C"),freq:131},29:{name:lf("C#"),prefixedName:lf("Low C#"),freq:139},30:{name:lf("{id:note}D"),prefixedName:lf("Low D"),freq:147},31:{name:lf("D#"),prefixedName:lf("Low D#"),freq:156},32:{name:lf("{id:note}E"),prefixedName:lf("Low E"),freq:165},33:{name:lf("{id:note}F"),prefixedName:lf("Low F"),freq:175},34:{name:lf("F#"),prefixedName:lf("Low F#"),freq:185},35:{name:lf("{id:note}G"),prefixedName:lf("Low G"),freq:196},36:{name:lf("G#"),prefixedName:lf("Low G#"),freq:208},37:{name:lf("{id:note}A"),prefixedName:lf("Low A"),freq:220},38:{name:lf("A#"),prefixedName:lf("Low A#"),freq:233},39:{name:lf("{id:note}B"),prefixedName:lf("Low B"),freq:247},40:{name:lf("{id:note}C"),prefixedName:lf("Middle C"),freq:262},41:{name:lf("C#"),prefixedName:lf("Middle C#"),freq:277},42:{name:lf("{id:note}D"),prefixedName:lf("Middle D"),freq:294},43:{name:lf("D#"),prefixedName:lf("Middle D#"),freq:311},44:{name:lf("{id:note}E"),prefixedName:lf("Middle E"),freq:330},45:{name:lf("{id:note}F"),prefixedName:lf("Middle F"),freq:349},46:{name:lf("F#"),prefixedName:lf("Middle F#"),freq:370},47:{name:lf("{id:note}G"),prefixedName:lf("Middle G"),freq:392},48:{name:lf("G#"),prefixedName:lf("Middle G#"),freq:415},49:{name:lf("{id:note}A"),prefixedName:lf("Middle A"),freq:440},50:{name:lf("A#"),prefixedName:lf("Middle A#"),freq:466},51:{name:lf("{id:note}B"),prefixedName:lf("Middle B"),freq:494},52:{name:lf("{id:note}C"),prefixedName:lf("Tenor C"),altPrefixedName:lf("High C"),freq:523},53:{name:lf("C#"),prefixedName:lf("Tenor C#"),altPrefixedName:lf("High C#"),freq:554},54:{name:lf("{id:note}D"),prefixedName:lf("Tenor D"),altPrefixedName:lf("High D"),freq:587},55:{name:lf("D#"),prefixedName:lf("Tenor D#"),altPrefixedName:lf("High D#"),freq:622},56:{name:lf("{id:note}E"),prefixedName:lf("Tenor E"),altPrefixedName:lf("High E"),freq:659},57:{name:lf("{id:note}F"),prefixedName:lf("Tenor F"),altPrefixedName:lf("High F"),freq:698},58:{name:lf("F#"),prefixedName:lf("Tenor F#"),altPrefixedName:lf("High F#"),freq:740},59:{name:lf("{id:note}G"),prefixedName:lf("Tenor G"),altPrefixedName:lf("High G"),freq:784},60:{name:lf("G#"),prefixedName:lf("Tenor G#"),altPrefixedName:lf("High G#"),freq:831},61:{name:lf("{id:note}A"),prefixedName:lf("Tenor A"),altPrefixedName:lf("High A"),freq:880},62:{name:lf("A#"),prefixedName:lf("Tenor A#"),altPrefixedName:lf("High A#"),freq:932},63:{name:lf("{id:note}B"),prefixedName:lf("Tenor B"),altPrefixedName:lf("High B"),freq:988},64:{name:lf("{id:note}C"),prefixedName:lf("High C"),freq:1046},65:{name:lf("C#"),prefixedName:lf("High C#"),freq:1109},66:{name:lf("{id:note}D"),prefixedName:lf("High D"),freq:1175},67:{name:lf("D#"),prefixedName:lf("High D#"),freq:1245},68:{name:lf("{id:note}E"),prefixedName:lf("High E"),freq:1319},69:{name:lf("{id:note}F"),prefixedName:lf("High F"),freq:1397},70:{name:lf("F#"),prefixedName:lf("High F#"),freq:1478},71:{name:lf("{id:note}G"),prefixedName:lf("High G"),freq:1568},72:{name:lf("G#"),prefixedName:lf("High G#"),freq:1661},73:{name:lf("{id:note}A"),prefixedName:lf("High A"),freq:1760},74:{name:lf("A#"),prefixedName:lf("High A#"),freq:1865},75:{name:lf("{id:note}B"),prefixedName:lf("High B"),freq:1976}})}}function a(e,t){const n=document.createElement("div");return pxt.BrowserUtils.addClass(n,e),n.setAttribute("style",t.replace(/\s+/g," ")),n}n.FieldNote=o,o.keyWidth=22,o.keyHeight=90,o.labelHeight=24,o.prevNextHeight=20,o.notesPerOctave=12,o.blackKeysPerOctave=5},{"./field_utils":64,blockly:154}],42:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldNumberDropdown=void 0;const r=e("./field_textdropdown");class i extends r.BaseFieldTextDropdown{constructor(e,t,n,r,i,s){super(e+"",t,s),this.setConstraints(n,r,i)}setConstraints(e,t,n){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(n),this.setValue(this.getValue())}getValue(){return Number(super.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);-1!==t.indexOf("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=t.indexOf(".");this.decimalPlaces=-1===n?e?0:null:t.length-n-1}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=`${e}`).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);return isNaN(t)?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!==this.decimalPlaces&&(t=Number(t.toFixed(this.decimalPlaces))),t+"")}}n.FieldNumberDropdown=class extends i{constructor(e,t,n){super(e,t.data,t.min,t.max,t.precision,n),this.isFieldCustom_=!0}getOptions(){let e;return this.menuGenerator_&&("string"==typeof this.menuGenerator_&&(this.menuGenerator_=JSON.parse(this.menuGenerator_)),e=this.menuGenerator_.map((e=>"object"==typeof e?[pxt.Util.rlf(e[0]),e[1]]:[String(e),String(e)]))),e}}},{"./field_textdropdown":50}],43:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldPosition=void 0;const r=e("blockly"),i=e("../plugins/math");class s extends i.FieldSlider{constructor(e,t,n){super(e,"0","100","1","1","Value",n),this.isFieldCustom_=!0,this.params=t,this.params.screenHeight||(this.params.screenHeight=120),this.params.screenWidth||(this.params.screenWidth=160),this.params.xInputName||(this.params.xInputName="x"),this.params.yInputName||(this.params.yInputName="y"),this.params.min&&(this.min_=parseInt(this.params.min)),this.params.max&&(this.max_=parseInt(this.params.max))}showEditor_(e){this.getFieldByName(this.params.xInputName)===this&&(this.max_=this.params.screenWidth,this.labelText_=this.params.xInputName),this.getFieldByName(this.params.yInputName)===this&&(this.max_=this.params.screenHeight,this.labelText_=this.params.yInputName),super.showEditor_(e),this.renderScreenPicker()}doValueUpdate_(e){super.doValueUpdate_(e),this.resetCrosshair&&this.resetCrosshair()}renderScreenPicker(){let e=r.DropDownDiv.getContentDiv();this.selectorDiv_=document.createElement("div"),this.selectorDiv_.className="blocklyCanvasOverlayOuter",e.appendChild(this.selectorDiv_);const t=document.createElement("div");t.className="blocklyCanvasOverlayDiv",this.selectorDiv_.appendChild(t);const n=document.createElement("div");n.className="cross-x",t.appendChild(n);const i=document.createElement("div");i.className="cross-y",t.appendChild(i);const s=document.createElement("div");s.className="label",t.appendChild(s);const o=1.5*this.params.screenWidth,a=1.5*this.params.screenHeight;t.style.height=a+"px",t.style.width=o+"px";const l=e.getElementsByClassName("goog-slider-horizontal")[0];if(l){l.style.width=o+"px";const e=Number(this.getValue());!isNaN(e)&&e>this.getMin()&&(this.setValue(e-1+""),this.setValue(e+""))}const c=(e,t)=>{e=Math.round(Math.max(0,Math.min(o,e))),t=Math.round(Math.max(0,Math.min(a,t))),n.style.top=t+"px",i.style.left=e+"px",e=Math.round(Math.max(0,Math.min(this.params.screenWidth,e/o*this.params.screenWidth))),t=Math.round(Math.max(0,Math.min(this.params.screenHeight,t/a*this.params.screenHeight))),isNaN(e)?s.textContent=`${this.params.yInputName}=${t}`:isNaN(t)?s.textContent=`${this.params.xInputName}=${e}`:s.textContent=`${this.params.xInputName}=${e} ${this.params.yInputName}=${t}`;const r=s.getBoundingClientRect();e>this.params.screenWidth/2?s.style.left=e*(o/this.params.screenWidth)-r.width-8+"px":s.style.left=e*(o/this.params.screenWidth)+4+"px",t>this.params.screenHeight/2?s.style.top=t*(a/this.params.screenHeight)-r.height-6+"px":s.style.top=t*(a/this.params.screenHeight)+"px"};this.resetCrosshair=()=>{const{currentX:e,currentY:t}=this.getXY();c(e/this.params.screenWidth*o,t/this.params.screenHeight*a)},this.resetCrosshair(),r.browserEvents.bind(this.selectorDiv_,"mousemove",this,(e=>{const n=t.getBoundingClientRect(),r=e.clientX-n.left,i=e.clientY-n.top;c(r,i)})),r.browserEvents.bind(this.selectorDiv_,"mouseleave",this,this.resetCrosshair),r.browserEvents.bind(this.selectorDiv_,"click",this,(e=>{const n=t.getBoundingClientRect(),r=e.clientX-n.left,i=e.clientY-n.top,s=Math.round(r/o*this.params.screenWidth),l=Math.round(i/a*this.params.screenHeight);this.close(),this.setXY(s,l)}))}resizeHandler(){this.close()}setXY(e,t){const n=this.getFieldByName(this.params.xInputName);n&&"number"==typeof n.getValue()&&n.setValue(String(e));const r=this.getFieldByName(this.params.yInputName);r&&"number"==typeof r.getValue()&&r.setValue(String(t))}getFieldByName(e){const t=this.sourceBlock_.getParent();if(t)for(let n=0;n<t.inputList.length;n++){const r=t.inputList[n];if(r.name===e)return this.getTargetField(r)}}getXY(){let e,t;const n=this.getFieldByName(this.params.xInputName);n&&(e=n.getValue());const r=this.getFieldByName(this.params.yInputName);return r&&(t=r.getValue()),{currentX:parseInt(e),currentY:parseInt(t)}}getTargetField(e){const t=e.connection.targetBlock();if(!t)return null;const n=t.inputList[0];return n?n.fieldRow[0]:null}widgetDispose_(){super.widgetDispose_(),this.close(!0)}close(e){e||(r.WidgetDiv.hideIfOwner(this),r.DropDownDiv.hideIfOwner(this)),window.removeEventListener("resize",this.resizeHandler),this.resetCrosshair=void 0,this.selectorDiv_&&(r.utils.dom.removeNode(this.selectorDiv_),this.selectorDiv_=void 0)}}n.FieldPosition=s},{"../plugins/math":101,blockly:154}],44:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldProcedure=void 0;const r=e("./field_dropdown");class i extends r.FieldDropdown{constructor(e,t){super((function(){let e=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){let t=this.sourceBlock_.workspace.getAllBlocks(!1);for(let n=0;n<t.length;n++)if(t[n].getProcedureDef){let r=t[n].getProcedureDef();e.push(r[0])}}let t=this.getValue();t&&-1==e.indexOf(t)&&e.push(t),e.sort(((e,t)=>{const n=e.toLowerCase(),r=t.toLowerCase();return n===r?0:n>r?1:-1})),e.length||e.push("Temp"),this.rawValue&&-1===e.indexOf(this.rawValue)&&e.push(this.rawValue);let n=[];for(let t=0;t<e.length;t++)n[t]=[e[t],e[t]];return n}),t),this.setValue(e||"")}getOptions(e){return this.menuGenerator_()}doClassValidation_(e){return void 0===e?null:e}doValueUpdate_(e){this.rawValue=e,super.doValueUpdate_(e)}init(){this.fieldGroup_||super.init.call(this)}setSourceBlock(e){pxt.Util.assert(!e.isShadow(),"Procedure fields are not allowed to exist on shadow blocks."),super.setSourceBlock.call(this,e)}}n.FieldProcedure=i},{"./field_dropdown":33}],45:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldProtractor=void 0;const r=e("../plugins/math");class i extends r.FieldSlider{constructor(e,t,n){super(String(e),"0","180","1","15",lf("Angle"),n),this.isFieldCustom_=!0,this.params=t}createLabelDom_(e){const t=document.createElement("div");this.circleSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.circleSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.circleSVG),pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"}),this.circleBar=pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.circleSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"});const n=document.createElement("span");return n.setAttribute("class","blocklyFieldSliderReadout"),[t,n]}setReadout(e){this.updateAngle("string"==typeof e?parseFloat(e):e),this.reporter&&(this.reporter.textContent=`${e}`)}updateAngle(e){if(!this.circleBar)return;const t=(180-(e=Math.max(0,Math.min(180,e))))/180*Math.PI*90;this.circleBar.setAttribute("stroke-dashoffset",`${t}`)}}n.FieldProtractor=i},{"../plugins/math":101}],46:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSoundEffect=void 0;const r=e("blockly");var i=pxt.svgUtil;const s=e("./field_base"),o=e("./field_utils"),a=160,l=40;class c extends s.FieldBase{constructor(){super(...arguments),this.registeredChangeListener=!1,this.onWorkspaceChange=e=>{if(e.type!==r.Events.CHANGE)return;const t=this.sourceBlock_.workspace.getBlockById(e.blockId);!t||t!==this.sourceBlock_&&t.getParent()!==this.sourceBlock_||this.redrawPreview()}}onInit(){this.options||(this.options={}),this.options.durationInputName||(this.options.durationInputName="duration"),this.options.startFrequencyInputName||(this.options.startFrequencyInputName="startFrequency"),this.options.endFrequencyInputName||(this.options.endFrequencyInputName="endFrequency"),this.options.startVolumeInputName||(this.options.startVolumeInputName="startVolume"),this.options.endVolumeInputName||(this.options.endVolumeInputName="endVolume"),this.options.waveFieldName||(this.options.waveFieldName="waveShape"),this.options.interpolationFieldName||(this.options.interpolationFieldName="interpolation"),this.options.effectFieldName||(this.options.effectFieldName="effect"),this.options.useMixerSynthesizer||(this.options.useMixerSynthesizer=!1),this.redrawPreview(),this.sourceBlock_.workspace&&(this.workspace=this.sourceBlock_.workspace,this.sourceBlock_.isShadow()||this.sourceBlock_.isInsertionMarker()||(this.registeredChangeListener=!0,this.workspace.addChangeListener(this.onWorkspaceChange)))}onDispose(){this.workspace&&this.registeredChangeListener&&(this.workspace.removeChangeListener(this.onWorkspaceChange),this.registeredChangeListener=!1)}onValueChanged(e){return e}redrawPreview(){if(!this.fieldGroup_)return;if(this.drawnSound){const e=this.readCurrentSound();if(e.startFrequency===this.drawnSound.startFrequency&&e.endFrequency===this.drawnSound.endFrequency&&e.startVolume===this.drawnSound.startVolume&&e.endVolume===this.drawnSound.endVolume&&e.wave===this.drawnSound.wave&&e.interpolation===this.drawnSound.interpolation)return}pxsim.U.clear(this.fieldGroup_);const e=(new i.Rect).at(5,4).size(a,l).setClass("blocklySpriteField").stroke("#fff",1).fill("#dedede").corner(20),t="preview-clip-"+pxt.U.guidGen(),n=(new i.ClipPath).id(t).clipPathUnits(!1),r=(new i.Rect).size(115,l).fill("#FFF").at(0,0);n.appendChild(r),this.drawnSound=this.readCurrentSound();const s=(new i.Path).stroke("grey",2).fill("none").setD(pxt.assets.renderSoundPath(this.drawnSound,120,32)).clipPath("url('#"+t+"')"),o=(new i.Group).translate(35,7);o.appendChild(n),o.appendChild(s);const c=new i.Text("").appendClass("melody-editor-field-icon").setAttribute("alignment-baseline","middle").anchor("middle").at(20,24);this.fieldGroup_.appendChild(e.el),this.fieldGroup_.appendChild(c.el),this.fieldGroup_.appendChild(o.el)}showEditor_(){const e=this.readCurrentSound();let t;r.Events.disable();let n={getScaledBBox:()=>t};r.WidgetDiv.show(n,this.sourceBlock_.RTL,(()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),a.hide(),i.classList.remove("sound-effect-editor-widget"),i.style.transform="",i.style.position="",i.style.left="",i.style.top="",i.style.width="",i.style.height="",i.style.opacity="",i.style.transition="",i.style.alignItems="",r.Events.enable(),r.Events.setGroup(!0),this.fireNumberInputUpdate(this.options.durationInputName,e.duration),this.fireNumberInputUpdate(this.options.startFrequencyInputName,e.startFrequency),this.fireNumberInputUpdate(this.options.endFrequencyInputName,e.endFrequency),this.fireNumberInputUpdate(this.options.startVolumeInputName,e.startVolume),this.fireNumberInputUpdate(this.options.endVolumeInputName,e.endVolume),this.fireFieldDropdownUpdate(this.options.waveFieldName,u[e.wave]),this.fireFieldDropdownUpdate(this.options.interpolationFieldName,p[e.interpolation]),this.fireFieldDropdownUpdate(this.options.effectFieldName,d[e.effect]),r.Events.setGroup(!1),this.mostRecentValue&&this.setBlockData(JSON.stringify(this.mostRecentValue))}));const i=r.WidgetDiv.getDiv(),s={onClose:()=>{a.hide(),r.WidgetDiv.hideIfOwner(n)},onSoundChange:e=>{this.mostRecentValue=e,this.updateSiblingBlocks(e),this.redrawPreview()},initialSound:e,useMixerSynthesizer:f(this.options.useMixerSynthesizer)},a=pxt.react.getFieldEditorView("soundeffect-editor",e,s,i),l=this.sourceBlock_,c=l.getBoundingRectangle(),h=(0,o.workspaceToScreenCoordinates)(l.workspace,new r.utils.Coordinate(c.right,c.top)),m=h.x+20,_=h.y-20;i.style.opacity="0",i.classList.add("sound-effect-editor-widget"),i.style.position="absolute",i.style.left=m+"px",i.style.top=_+"px",i.style.width="30rem",i.style.height="40rem",i.style.display="flex",i.style.alignItems="center",i.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",i.style.borderRadius="",a.onHide((()=>{})),a.show();const g=i.getBoundingClientRect(),y=l.workspace.getInjectionDiv().getBoundingClientRect();g.height>y.height?(i.style.height="",i.style.top="calc(1rem - 20px)",i.style.bottom="calc(1rem + 20px)"):(g.bottom>y.bottom||g.top<y.top)&&(i.style.top=y.top+y.height/2-g.height/2-20+"px");const b=l.workspace.getToolbox().getWidth();if(g.width>y.width-b)i.style.width="",i.style.left="1rem",i.style.right="1rem";else if(g.left+g.width>=y.right){const e=(0,o.workspaceToScreenCoordinates)(l.workspace,new r.utils.Coordinate(c.left,c.top)),t=y.left+b;e.x-g.width-20>t?i.style.left=e.x-g.width-20+"px":i.style.left=t+(y.width-b)/2-g.width/2+"px"}const v=i.getBoundingClientRect();t=new r.utils.Rect(v.top,v.bottom,v.left,v.right),requestAnimationFrame((()=>{i.style.opacity="1",i.style.transform="translateY(20px)"}))}render_(){super.render_(),this.size_.height=48,this.size_.width=165}updateSiblingBlocks(e){this.setNumberInputValue(this.options.durationInputName,e.duration),this.setNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),this.setNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),this.setNumberInputValue(this.options.startVolumeInputName,e.startVolume),this.setNumberInputValue(this.options.endVolumeInputName,e.endVolume),this.setFieldDropdownValue(this.options.waveFieldName,u[e.wave]),this.setFieldDropdownValue(this.options.interpolationFieldName,p[e.interpolation]),this.setFieldDropdownValue(this.options.effectFieldName,d[e.effect])}setNumberInputValue(e,t){const n=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);n&&("math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?n.setFieldValue(Math.round(t),"NUM"):"math_number_minmax"===n.type&&n.setFieldValue(Math.round(t),"SLIDER"))}getNumberInputValue(e,t){const n=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);return n?"math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?parseInt(n.getFieldValue("NUM")+""):"math_number_minmax"===n.type?parseInt(n.getFieldValue("SLIDER")+""):t:t}fireNumberInputUpdate(e,t){const n=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);if(!n)return;let i;"math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?i="NUM":"math_number_minmax"===n.type&&(i="SLIDER"),i&&r.Events.fire(new r.Events.BlockChange(n,"field",i,t,this.getNumberInputValue(e,t)))}setFieldDropdownValue(e,t){const n=this.getSiblingField(e)||this.getSiblingField(e,!0);n&&n.setValue(t)}getFieldDropdownValue(e){const t=this.getSiblingField(e)||this.getSiblingField(e,!0);if(t)return t.getValue()}fireFieldDropdownUpdate(e,t){const n=this.getSiblingField(e)||this.getSiblingField(e,!0);n&&r.Events.fire(new r.Events.BlockChange(n.getSourceBlock(),"field",n.name,t,this.getFieldDropdownValue(e)))}readCurrentSound(){const e=this.readBlockDataSound();return{duration:this.getNumberInputValue(this.options.durationInputName,e.duration),startFrequency:this.getNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),endFrequency:this.getNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),startVolume:this.getNumberInputValue(this.options.startVolumeInputName,e.startVolume),endVolume:this.getNumberInputValue(this.options.endVolumeInputName,e.endVolume),wave:h(u,this.getFieldDropdownValue(this.options.waveFieldName))||e.wave,interpolation:h(p,this.getFieldDropdownValue(this.options.interpolationFieldName))||e.interpolation,effect:h(d,this.getFieldDropdownValue(this.options.effectFieldName))||e.effect}}readBlockDataSound(){const e=this.getBlockData();let t;try{t=JSON.parse(e)}catch(e){t={duration:1e3,startFrequency:100,endFrequency:4800,startVolume:100,endVolume:0,wave:"sine",interpolation:"linear",effect:"none"}}return t}}n.FieldSoundEffect=c;const u={sine:"WaveShape.Sine",square:"WaveShape.Square",sawtooth:"WaveShape.Sawtooth",triangle:"WaveShape.Triangle",noise:"WaveShape.Noise"},d={none:"SoundExpressionEffect.None",vibrato:"SoundExpressionEffect.Vibrato",tremolo:"SoundExpressionEffect.Tremolo",warble:"SoundExpressionEffect.Warble"},p={linear:"InterpolationCurve.Linear",curve:"InterpolationCurve.Curve",logarithmic:"InterpolationCurve.Logarithmic"};function h(e,t){return Object.keys(e).find((n=>e[n]===t))}function f(e){if(!e)return!1;if("string"==typeof e)switch(e.toLowerCase().trim()){case"1":case"yes":case"y":case"on":case"true":return!0;default:return!1}return!!e}},{"./field_base":30,"./field_utils":64,blockly:154}],47:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSpeed=void 0;const r=e("../plugins/math");class i extends r.FieldSlider{constructor(e,t,n){super(String(e),"-100","100","1","10","Speed",n),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.format||(this.params.format="{0}%")}createLabelDom_(e){const t=document.createElement("div");this.speedSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.speedSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.speedSVG),pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"}),this.circleBar=pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.speedSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:`font-size: ${Math.max(14,50-5*(this.params.format.length-4))}px`,class:"sim-text inverted number"});const n=document.createElement("span");return n.setAttribute("class","blocklyFieldSliderReadout"),[t,n]}setReadout(e){this.updateSpeed("string"==typeof e?parseFloat(e):e),this.params&&this.reporter&&(this.reporter.textContent=ts.pxtc.U.rlf(this.params.format,e))}updateSpeed(e){if(!this.circleBar)return;let t=this.sign(e);e=Math.abs(e)/100*50+50,-1==t&&(e=50-e);let n=(100-e)/100*(180*Math.PI);this.circleBar.setAttribute("stroke-dashoffset",`${n}`)}sign(e){return e?e<0?-1:1:0}}n.FieldSpeed=i},{"../plugins/math":101}],48:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSpriteEditor=void 0;const r=e("./field_asset");class i extends r.FieldAssetEditor{getAssetType(){return"image"}createNewAsset(e){const t=pxt.react.getTilemapProject();if(e){const n=pxt.lookupProjectAssetByTSReference(e,t);if(n)return n}if(this.getBlockData())return t.lookupAsset("image",this.getBlockData());const n=e?pxt.sprite.imageLiteralToBitmap(e,this.params.taggedTemplate):new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight);let r;if(!n){if(!(r=s(e)))return this.isGreyBlock=!0,void(this.valueText=e);this.qName=e}return r||(r=n.data()),{internalID:-1,id:this.sourceBlock_.id,type:"image",jresData:pxt.sprite.base64EncodeBitmap(r),meta:{},bitmap:r}}getValueText(){if(!this.asset)return this.valueText||"";if(this.asset&&!this.isTemporaryAsset())return pxt.getTSReferenceForAsset(this.asset);if(this.qName){const e=s(this.qName);if(e&&pxt.sprite.bitmapEquals(e,this.asset.bitmap))return this.qName}return pxt.sprite.bitmapToImageLiteral(this.asset&&pxt.sprite.Bitmap.fromData(this.asset.bitmap),"typescript",this.params.taggedTemplate)}parseFieldOptions(e){return function(e){const t={initColor:1,initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};if(!e)return t;if(t.lightMode=e.lightMode,e.sizes){const n=e.sizes.split(";"),r=[];for(let e=0;e<n.length;e++){const t=n[e].split(",");if(2!==t.length)continue;let i=parseInt(t[0]),s=parseInt(t[1]);if(isNaN(i)||isNaN(s))continue;const o=pxt.appTarget.runtime&&pxt.appTarget.runtime.screenSize;i<0&&o&&(i=o.width),s<0&&o&&(s=o.height),r.push([i,s])}r.length>0&&(t.initWidth=r[0][0],t.initHeight=r[0][1])}return e.filter&&(t.filter=e.filter),e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initColor=n(e.initColor,t.initColor),t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t.taggedTemplate=e.taggedTemplate,t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(e)}}function s(e){const t=pxt.react.getTilemapProject().getGalleryAssets("image").filter((t=>t.id===e)),n=t.length&&t[0];if(n)return n.bitmap}n.FieldSpriteEditor=i},{"./field_asset":28}],49:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldStyledLabel=void 0;const r=e("blockly");class i extends r.FieldLabel{constructor(e,t,n){super(e,function(e){if(e){if(e.bold&&e.italics)return"blocklyBoldItalicizedText";if(e.bold)return"blocklyBoldText";if(e.italics)return"blocklyItalicizedText"}}(t)),this.isFieldCustom_=!0}}n.FieldStyledLabel=i},{blockly:154}],50:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTextDropdown=n.BaseFieldTextDropdown=void 0;const r=e("blockly");class i extends r.FieldTextInput{constructor(e,t,n){super(e,n),this.menuGenerator_=t,this.selectedMenuItem=null,this.menu_=null,this.svgArrow=null,this.generatedOptions=null}initView(){super.initView(),this.createSVGArrow()}showEditor_(e,t){super.showEditor_(e,t),this.dropDownOpen_||this.showDropdown_(),r.Touch.clearTouchIdentifier()}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)?"string"!=typeof r[1]?(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!=typeof r[0]&&"string"!=typeof r[0].src&&(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",r))}if(t)throw TypeError("Found invalid FieldDropdown options.")}(this.generatedOptions),this.generatedOptions)}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}dropdownDispose_(){this.dropDownOpen_=!1,this.menu_&&this.menu_.dispose(),this.menu_=null,this.selectedMenuItem=null,this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new r.UnattachedFieldError;const t=new r.Menu;t.setRole(r.utils.aria.Role.LISTBOX),this.menu_=t;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let i=0;i<n.length;i++){const[s,o]=n[i],a=(()=>{if("object"==typeof s){const e=new Image(s.width,s.height);return e.src=s.src,e.alt=s.alt||"",e}return s})(),l=new r.MenuItem(a,o);l.setRole(r.utils.aria.Role.OPTION),l.setRightToLeft(e.RTL),l.setCheckable(!0),t.addChild(l),l.setChecked(o===this.value_),o===this.value_&&(this.selectedMenuItem=l),l.onAction(this.handleMenuActionEvent,this)}}showDropdown_(e){const t=this.getSourceBlock();if(!t)throw new r.UnattachedFieldError;this.dropdownCreate(),e&&"number"==typeof e.clientX?this.menu_.openingCoords=new r.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,r.DropDownDiv.clearContent();const n=this.menu_.render(r.DropDownDiv.getContentDiv());r.utils.dom.addClass(n,"blocklyDropdownMenu");const i=t.getParent(),s=(i||t).getColour(),o=(i||t).style.colourTertiary;r.DropDownDiv.setColour(s,o),this.dropDownOpen_=!0,r.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),r.utils.style.scrollIntoContainerView(this.selectedMenuItem.getElement(),r.DropDownDiv.getContentDiv(),!0)),this.applyColour()}updateSize_(e){super.updateSize_(e);const t=this.positionSVGArrow(this.size_.width,this.size_.height/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2);this.size_.width+=t}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new r.UnattachedFieldError;const i=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE,a=n.RTL?i:e+s;return this.svgArrow.setAttribute("transform","translate("+a+","+t+")"),o+s}createSVGArrow(){this.svgArrow=r.utils.dom.createSvgElement("image",{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(r.utils.dom.XLINK_NS,"xlink:href",s.DROPDOWN_SVG_DATAURI)}handleMenuActionEvent(e){r.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue()),r.WidgetDiv.hideIfOwner(this)}}n.BaseFieldTextDropdown=i,i.DROPDOWN_SVG_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiM1NzVFNzUiLz48L3N2Zz4K";class s extends i{constructor(e,t,n){super(e,t.values,n),this.isFieldCustom_=!0}}n.FieldTextDropdown=s},{blockly:154}],51:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTextInput=void 0;const r=e("blockly");class i extends r.FieldTextInput{constructor(e,t,n){super(e,n),this.isFieldCustom_=!0}}n.FieldTextInput=i},{blockly:154}],52:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTilemap=void 0;const r=e("./field_asset");class i extends r.FieldAssetEditor{getInitText(){return this.initText}getTileset(){var e;return null===(e=this.asset)||void 0===e?void 0:e.data.tileset}getAssetType(){return"tilemap"}createNewAsset(e=""){var t;e&&(e=e.replace(/&#96;/g,"`"));const n=pxt.react.getTilemapProject(),r=pxt.lookupProjectAssetByTSReference(e,n);if(r)return r;if(null===(t=this.sourceBlock_)||void 0===t?void 0:t.isInFlyout)return;const i=pxt.sprite.decodeTilemap(e,"typescript",n)||n.blankTilemap(this.params.tileWidth,this.params.initWidth,this.params.initHeight);let s;if(function(e){return!!(e&&e.tilemap&&e.tilemap.width&&e.tilemap.height&&e.layers&&e.layers.width===e.tilemap.width&&e.layers.height===e.tilemap.height&&e.tileset)}(i)){this.initText=e,this.isGreyBlock=!1;const[t]=n.createNewTilemapFromData(i);s=n.getTilemap(t)}else e.trim()&&(this.isGreyBlock=!0,this.valueText=e);return s}onEditorClose(e){pxt.sprite.updateTilemapReferencesFromResult(pxt.react.getTilemapProject(),e)}getValueText(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.asset?pxt.getTSReferenceForAsset(this.asset):this.initText?this.getInitText():this.valueText||""}parseFieldOptions(e){return function(e){const t={initWidth:16,initHeight:16,disableResize:!1,tileWidth:16,lightMode:!1};if(!e)return t;if(t.lightMode=e.lightMode,e.filter&&(t.filter=e.filter),e.tileWidth)if("number"==typeof e.tileWidth)switch(e.tileWidth){case 4:t.tileWidth=4;break;case 8:t.tileWidth=8;break;case 16:t.tileWidth=16;break;case 32:t.tileWidth=32}else switch(e.tileWidth.trim().toLowerCase()){case"4":case"four":t.tileWidth=4;break;case"8":case"eight":t.tileWidth=8;break;case"16":case"sixteen":t.tileWidth=16;break;case"32":case"thirtytwo":t.tileWidth=32}return t.initWidth=n(e.initWidth,t.initWidth),t.initHeight=n(e.initHeight,t.initHeight),t;function n(e,t){const n=parseInt(e);return isNaN(n)?t:n}}(e)}}n.FieldTilemap=i},{"./field_asset":28}],53:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTileset=void 0;const r=e("./field_images"),i=e("./field_utils"),s=32;class o extends r.FieldImages{constructor(e,t,n){super(e,t,n),this.isFieldCustom_=!0,this.menuGenerator_=()=>{var e,t;return(null===(e=this.sourceBlock_)||void 0===e?void 0:e.workspace)&&(0,i.needsTilemapUpgrade)(null===(t=this.sourceBlock_)||void 0===t?void 0:t.workspace)?[a()]:o.getReferencedTiles(this.sourceBlock_.workspace)},this.assetChangeListener=()=>{this.doValueUpdate_(this.getValue()),this.forceRerender()},this.blocksInfo=t.blocksInfo}static getReferencedTiles(e){const t=pxt.react.getTilemapProject();if(t.revision()!==o.cachedRevision||e.id!=o.cachedWorkspaceId){o.cachedRevision=t.revision(),o.cachedWorkspaceId=e.id;const n=(0,i.getAllReferencedTiles)(e),r=[16,4,8,32];for(const e of r){const r=t.getProjectTiles(e,16===e);if(r)for(const e of r.tiles)n.find((t=>t.id===e.id))||n.push(e)}let a={};n.sort(((e,t)=>e.id===t.id?0:e.bitmap.width!==t.bitmap.width?e.bitmap.width-t.bitmap.width:e.isProjectTile!==t.isProjectTile?e.isProjectTile?-1:1:(a[e.id]||(a[e.id]=c(e.id)))-(a[t.id]||(a[t.id]=c(t.id)))));const d=e=>c(e.id)<=2?l(e.bitmap.width):(0,i.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e.bitmap),s,!1);o.referencedTiles=n.map((e=>[{src:d(e),width:s,height:s,alt:u(e)},e.id,e]))}return o.referencedTiles}initView(){super.initView(),this.sourceBlock_&&this.sourceBlock_.isInFlyout&&this.setValue(this.getOptions()[0][1])}getValue(){if(this.selectedOption_){let e=this.selectedOption_[2];return(e=pxt.react.getTilemapProject().lookupAsset(e.type,e.id))?pxt.getTSReferenceForAsset(e):super.getValue()}const e=super.getValue();return"string"==typeof e&&-1===e.indexOf(".")&&-1===e.indexOf("`")?`img\`${e}\``:e}getText(){const e=this.getValue();return"string"==typeof e&&-1!==e.indexOf("`")?e:super.getText()}render_(){if(this.value_&&this.selectedOption_&&this.selectedOption_[1]!==this.value_){const e=pxt.react.getTilemapProject().resolveTile(this.value_);o.cachedRevision=-1,e&&(this.selectedOption_=[{src:(0,i.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e.bitmap),s,!1),width:s,height:s,alt:u(e)},this.value_,e])}super.render_()}doValueUpdate_(e){let t=!1;const n=this.getOptions(!0);if(e){const r=pxt.parseAssetTSReference(e);r&&(e=r.name),e=e.trim();for(const r of n)if(e===r[2].id||e===r[2].meta.displayName||e===pxt.getShortIDForAsset(r[2]))return this.selectedOption_=r,this.value_=this.getValue(),this.updateAssetListener(),super.doValueUpdate_(r[1]),void(t=!0);t||super.doValueUpdate_(e),this.selectedOption_=null,this.updateAssetListener()}}doClassValidation_(e){if(!this.getOptions(!0).some((([t,n])=>n===e))){if(e){const t=pxt.react.getTilemapProject(),n=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(e);if(n){const r=t.lookupAssetByName("tile",n[1]);if(r)return this.localTile=r,e}}return this.sourceBlock_&&console.warn(`Trying to set tile reference to nonexistent tile. Block type: ${this.sourceBlock_.type}, Field name: ${this.name}, Value: ${e}`),null}return e}getOptions(e){if("function"!=typeof this.menuGenerator_){this.transparent=a();const e=[this.transparent];return this.localTile&&e.push([{src:(0,i.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.localTile.bitmap),s,!1),width:s,height:s,alt:u(this.localTile)},this.localTile.id,this.localTile]),e}return this.menuGenerator_.call(this)}dispose(){super.dispose(),pxt.react.getTilemapProject().removeChangeListener("tile",this.assetChangeListener)}updateAssetListener(){const e=pxt.react.getTilemapProject();e.removeChangeListener("tile",this.assetChangeListener),this.selectedOption_&&e.addChangeListener(this.selectedOption_[2],this.assetChangeListener)}}function a(){const e=pxt.react.getTilemapProject().getTransparency(16);return[{src:l(16),width:s,height:s,alt:pxt.U.lf("transparency")},e.id,e]}function l(e){const t=document.createElement("canvas"),n=t.getContext("2d");t.width=e,t.height=e,n.fillStyle="#aeaeae",n.fillRect(0,0,e,e),n.fillStyle="#dedede";for(let t=0;t<e;t+=4)for(let r=0;r<e;r+=4)t+r>>2&1&&n.fillRect(t,r,4,4);return t.toDataURL()}function c(e){switch(e){case"myTiles.transparency16":return 1;case"myTiles.transparency4":case"myTiles.transparency8":case"myTiles.transparency32":return 2;default:if(e.startsWith("myTiles.tile")){const t=parseInt(e.slice(12));if(!Number.isNaN(t))return t+2}return 9999999999}}function u(e){return e.meta.displayName||pxt.getShortIDForAsset(e)}n.FieldTileset=o},{"./field_images":36,"./field_utils":64}],54:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggle=n.BaseFieldToggle=void 0;const r=e("blockly"),i=e("../constants");class s extends r.FieldNumber{constructor(e,t,n,r,i){super(e,void 0,void 0,void 0,i),this.trueText=n,this.falseText=r,this.isFieldCustom_=!0,this.CURSOR="pointer",this.params=t,this.setValue(e),this.type_=t.type}initView(){if(!this.fieldGroup_)return;this.clickTarget_=this.sourceBlock_.getSvgRoot(),!this.sourceBlock_.isShadow()&&this.sourceBlock_.inputList&&this.sourceBlock_.inputList.length>1&&(this.borderRect_=r.utils.dom.createSvgElement("rect",{rx:this.getConstants().CORNER_RADIUS,ry:this.getConstants().CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColour(),stroke:this.sourceBlock_.getColourTertiary()},null),this.fieldGroup_.insertBefore(this.borderRect_,this.textElement_));const e=this.getSize();switch(this.checkElement_=r.utils.dom.createSvgElement("g",{class:"blocklyToggle "+(this.state_?"blocklyToggleOn":"blocklyToggleOff"),transform:`translate(8, ${e.height/2})`},this.fieldGroup_),this.getOutputShape()){case i.provider.SHAPES.HEXAGONAL:this.toggleThumb_=r.utils.dom.createSvgElement("polygon",{class:"blocklyToggleRect",points:"-7,-14 -21,0 -7,14 7,14 21,0 7,-14",cursor:"pointer"},this.checkElement_);break;case i.provider.SHAPES.ROUND:this.toggleThumb_=r.utils.dom.createSvgElement("rect",{class:"blocklyToggleCircle",x:-6,y:-14,height:28,width:28,rx:14,ry:14,cursor:"pointer"},this.checkElement_);break;case i.provider.SHAPES.SQUARE:this.toggleThumb_=r.utils.dom.createSvgElement("rect",{class:"blocklyToggleRect",x:-6,y:-14,height:28,width:28,rx:3,ry:3,cursor:"pointer"},this.checkElement_)}let t=this.sourceBlock_.RTL?-e.width/2:e.width/2;this.textElement_=r.utils.dom.createSvgElement("text",{class:"blocklyText",x:t,dy:"0.6ex",y:e.height/2},this.fieldGroup_),this.updateEditable(),this.switchToggle(this.state_),this.setValue(this.getValue()),this.markDirty()}getDisplayText_(){return this.state_?this.getTrueText():this.getFalseText()}getTrueText(){return this.trueText}getFalseText(){return this.falseText}updateSize_(){switch(this.getOutputShape()){case i.provider.SHAPES.ROUND:this.size_.width=2*this.getInnerWidth()-7;break;case i.provider.SHAPES.HEXAGONAL:this.size_.width=2*this.getInnerWidth()+8-Math.floor(this.getInnerWidth()/2);break;case i.provider.SHAPES.SQUARE:this.size_.width=9+2*this.getInnerWidth()}}getInnerWidth(){return 10*this.getMaxLength()}getMaxLength(){return Math.max(this.getTrueText().length,this.getFalseText().length)}getOutputShape(){return this.sourceBlock_.isShadow()?this.sourceBlock_.getOutputShape():i.provider.SHAPES.SQUARE}doClassValidation_(e){return"boolean"==typeof this.fromVal(e)?e:"false"}applyColour(){let e=this.sourceBlock_.getColourTertiary();this.borderRect_?this.borderRect_.setAttribute("stroke",e):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e)}getValue(){return this.toVal(this.state_)}doValueUpdate_(e){let t=this.fromVal(e);this.state_!==t&&(this.sourceBlock_&&r.Events.isEnabled()&&r.Events.fire(new r.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,t)),this.state_=t,this.switchToggle(this.state_),this.isDirty_=!0)}switchToggle(e){if(this.checkElement_){this.updateSize_();const t=this.getSize(),n=this.getInnerWidth();e?(pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOff")):(pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOff"));const r=this.getOutputShape();let s=0,o=0,a=0,l=0;switch(r){case i.provider.SHAPES.HEXAGONAL:a=-(o=(s=t.width/2)/2),l=o-n,this.toggleThumb_.setAttribute("points",`0,-14 -14,0 0,14 ${s},14 ${s+14},0 ${s},-14`);break;case i.provider.SHAPES.ROUND:case i.provider.SHAPES.SQUARE:o=(s=5+n)/2,this.toggleThumb_.setAttribute("width",""+s),this.toggleThumb_.setAttribute("x",`-${o}`),a=l=r==i.provider.SHAPES.SQUARE?2:-6}this.checkElement_.setAttribute("transform",`translate(${e?l+n+o:o+a}, ${t.height/2})`)}}render_(){if(this.visible_&&this.textElement_){for(;this.textElement_.firstChild;)this.textElement_.firstChild.remove();let e=document.createTextNode(this.getDisplayText_());this.textElement_.appendChild(e),pxt.BrowserUtils.addClass(this.textElement_,"blocklyToggleText"),this.updateSize_();let t=this.size_.width,n=(this.state_?t+t/8:t/2)-t/2;this.textElement_.setAttribute("x",`${n}`)}this.borderRect_&&(this.borderRect_.setAttribute("width",`${this.size_.width}`),this.borderRect_.setAttribute("height",`${this.size_.height}`))}showEditor_(){let e=!this.state_;null!==e&&this.setValue(this.toVal(e))}toVal(e){return"number"==this.type_?String(e?"1":"0"):String(e?"true":"false")}fromVal(e){return"string"==typeof e?"1"==e||"TRUE"==e.toUpperCase():!!e}}n.BaseFieldToggle=s;n.FieldToggle=class extends s{constructor(e,t,n){super(e,t,lf("True"),lf("False"),n)}}},{"../constants":18,blockly:154}],55:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleDownUp=void 0;const r=e("./field_toggle");class i extends r.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("DOWN"),lf("UP"),n)}}n.FieldToggleDownUp=i},{"./field_toggle":54}],56:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleHighLow=void 0;const r=e("./field_toggle");class i extends r.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("HIGH"),lf("LOW"),n)}}n.FieldToggleHighLow=i},{"./field_toggle":54}],57:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleOnOff=void 0;const r=e("./field_toggle");class i extends r.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("ON"),lf("OFF"),n)}}n.FieldToggleOnOff=i},{"./field_toggle":54}],58:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleUpDown=void 0;const r=e("./field_toggle");class i extends r.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("UP"),lf("DOWN"),n)}}n.FieldToggleUpDown=i},{"./field_toggle":54}],59:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleWinLose=void 0;const r=e("./field_toggle");class i extends r.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("WIN"),lf("LOSE"),n)}}n.FieldToggleWinLose=i},{"./field_toggle":54}],60:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldToggleYesNo=void 0;const r=e("./field_toggle");class i extends r.BaseFieldToggle{constructor(e,t,n){super(e,t,lf("Yes"),lf("No"),n)}}n.FieldToggleYesNo=i},{"./field_toggle":54}],61:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTsExpression=void 0;const r=e("blockly");class i extends r.FieldTextInput{constructor(){super(...arguments),this.isFieldCustom_=!0,this.pythonMode=!1}updateEditable(){let e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?(pxt.BrowserUtils.addClass(e,"blocklyEditableText"),pxt.BrowserUtils.removeClass(e,"blocklyGreyExpressionBlockText"),this.fieldGroup_.style.cursor=this.CURSOR):(pxt.BrowserUtils.addClass(e,"blocklyGreyExpressionBlockText"),pxt.BrowserUtils.removeClass(e,"blocklyEditableText"),this.fieldGroup_.style.cursor=""))}setPythonEnabled(e){e!==this.pythonMode&&(this.pythonMode=e,this.forceRerender())}getText(){return this.pythonMode?pxt.Util.lf("<python code>"):this.getValue()}applyColour(){var e;this.sourceBlock_&&(null===(e=this.getConstants())||void 0===e?void 0:e.FULL_BLOCK_FIELDS)&&this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourPrimary),this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourPrimary))}}n.FieldTsExpression=i},{blockly:154}],62:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldTurnRatio=void 0;const r=e("blockly"),i=e("../plugins/math");class s extends i.FieldSlider{constructor(e,t,n){super(String(e),"-200","200","1","10","TurnRatio",n),this.isFieldCustom_=!0,this.params=t,this.sliderColor_="#a8aaa8"}createLabelDom_(e){let t=document.createElement("div"),n=r.utils.dom.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:s.HALF+s.HANDLE_RADIUS+10+"px",width:2*s.HALF+"px"},t),i=r.utils.dom.createSvgElement("defs",{},n),o=r.utils.dom.createSvgElement("marker",{id:"head",orient:"auto",markerWidth:"2",markerHeight:"4",refX:"0.1",refY:"1.5"},i);r.utils.dom.createSvgElement("path",{d:"M0,0 V3 L1.5,1.5 Z",fill:"#f12a21"},o),this.reporter_=pxsim.svg.child(n,"text",{x:s.HALF,y:96,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"}),this.path_=r.utils.dom.createSvgElement("path",{x1:s.HALF,y1:s.HALF,"marker-end":"url(#head)",style:"fill: none; stroke: #f12a21; stroke-width: 10"},n),this.updateGraph_();let a=document.createElement("span");return a.setAttribute("class","blocklyFieldSliderReadout"),[t,a]}updateGraph_(){if(!this.path_)return;let e=Math.min(Math.max(Number(this.getValue())||0,-200),200);const t=e/100,n=Math.max(-1,Math.min(1,t)),r=Math.max(n)*Math.PI/2,i=s.RADIUS-6;let o=s.HALF;const a=s.HALF-22;Math.abs(t)>1&&(o-=(t-(t>0?1:-1))*i/2);const l=.2+.5*Math.abs(n),c=i*l,u=i*Math.sin(Math.PI/2-r),d=i*Math.cos(Math.PI/2-r),p=u-i*l*Math.cos(2*r),h=`M ${o} ${a} C ${o} ${a-c} ${o+(d-i*l*Math.sin(2*r))} ${a-p} ${o+d} ${a-u}`;this.path_.setAttribute("d",h),this.reporter_.textContent=`${e}`}setReadout(e){this.updateGraph_()}}n.FieldTurnRatio=s,s.HALF=80,s.HANDLE_RADIUS=30,s.RADIUS=s.HALF-s.HANDLE_RADIUS-1},{"../plugins/math":101,blockly:154}],63:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNextValue=n.FieldUserEnum=void 0;const r=e("blockly"),i=e("../external"),s=e("./field_dropdown");class o extends s.FieldDropdown{constructor(e){super(function(e){return function(){const t=[];return this.sourceBlock_&&this.sourceBlock_.workspace?this.sourceBlock_.workspace.getVariablesOfType(e.name).forEach((e=>{const n=e.name.replace(/^\d+/,"");t.push([n,e.name])})):e.initialMembers.forEach((e=>t.push([e,e]))),t.push([lf("Add a new {0}...",e.memberName),"CREATE"]),t}}(e)),this.opts=e}init(){super.init(),this.initVariables()}onItemSelected_(e,t){"CREATE"===t.getValue()?a(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),(e=>e&&this.setValue(e))):super.onItemSelected_(e,t)}doClassValidation_(e){var t;return(null===(t=this.opts)||void 0===t?void 0:t.initialMembers)&&!this.opts.initialMembers.find((t=>t==e))&&this.getOptions(),super.doClassValidation_(e)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){const e=this.sourceBlock_.workspace,t=c(e,this.opts.name);if(this.opts.initialMembers.forEach((n=>{t.some((([e,t])=>e===n))||d(e,this.opts,n)})),"CREATE"===this.getValue()){const t=function(e,t,n){const r=e.getVariablesOfType(t);if(r&&r.length)for(let e=0;e<r.length;e++){const[t]=l(r[e]);if(t===n)return r[e].name}}(e,this.opts.name,this.opts.initialMembers[0]);t&&this.setValue(t)}}}}function a(e,t,n,s){(0,i.prompt)(n,null,(i=>{if(i){let o=!1;if(pxtc.isIdentifierStart(i.charCodeAt(0),2)){o=!0;for(let e=1;e<i.length;e++)pxtc.isIdentifierPart(i.charCodeAt(e),2)||(o=!1)}if(!o)return void r.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),(()=>a(e,t,n,s)));const l=c(e,t.name);for(let o=0;o<l.length;o++){const[c,u]=l[o];if(c===i)return void r.dialog.alert(lf("A {0} named '{1}' already exists.",t.memberName,i),(()=>a(e,t,n,s)))}s(d(e,t,i))}}),{placeholder:t.promptHint})}function l(e){const t=/^(\d+)([^0-9].*)$/.exec(e.name);return t?[t[2],parseInt(t[1])]:[e.name,-1]}function c(e,t){const n=e.getVariablesOfType(t);return n&&n.length?n.map(l):[]}function u(e,t){const n=e.map((([e,t])=>t));if(t.isBitMask){for(let e=0;e<n.length;e++){let t=1<<e;if(n.indexOf(t)<0)return t}return 1<<n.length}if(t.isHash)return 0;{const e=t.firstValue||0;for(let t=0;t<n.length;t++)if(n.indexOf(e+t)<0)return e+t;return e+n.length}}function d(e,t,n){const i=u(c(e,t.name),t)+n;return r.Variables.getOrCreateVariablePackage(e,null,i,t.name),i}n.FieldUserEnum=o,n.getNextValue=u},{"../external":24,"./field_dropdown":33,blockly:154}],64:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getBlockDataForField=n.setBlockDataForField=n.setBlockData=n.getBlockData=n.workspaceToScreenCoordinates=n.setMelodyEditorOpen=n.FieldEditorOpenEvent=n.FIELD_EDITOR_OPEN_EVENT_TYPE=n.getTemporaryAssets=n.getTilesReferencedByTilesets=n.getAllReferencedTiles=n.getAllFields=n.upgradeTilemapsInWorkspace=n.needsTilemapUpgrade=n.getAllBlocksWithTilesets=n.getAllBlocksWithTilemaps=n.songToDataURI=n.tilemapToImageURI=n.bitmapToImageURI=n.parseColour=n.svg=void 0;const r=e("blockly"),i=e("./field_tilemap"),s=e("./field_animation"),o=e("./field_musiceditor"),a=e("./field_sprite"),l=e("./field_tileset");function c(e,t){const n=e.getVariablesOfType(pxt.sprite.BLOCKLY_TILESET_TYPE);for(const r of n)if(parseInt(r.name.substr(0,r.name.indexOf(";")))===t.projectId){e.deleteVariableById(r.getId());break}}function u(e){return p(e,(e=>e instanceof i.FieldTilemap&&!e.isGreyBlock))}function d(e){return p(e,(e=>e instanceof l.FieldTileset))}function p(e,t){const n=[];return e.getTopBlocks(!1).forEach((e=>function e(r){for(const i of r.inputList){for(const e of i.fieldRow)t(e)&&n.push({block:r,field:e.name,ref:e});i.connection&&i.connection.targetBlock()&&e(i.connection.targetBlock())}r.nextConnection&&r.nextConnection.targetBlock()&&e(r.nextConnection.targetBlock())}(e))),n}!function(e){e.hasClass=function(e,t){return pxt.BrowserUtils.containsClass(e,t)},e.addClass=function(e,t){pxt.BrowserUtils.addClass(e,t)},e.removeClass=function(e,t){pxt.BrowserUtils.removeClass(e,t)}}(n.svg||(n.svg={})),n.parseColour=function(e){const t=Number(e);return isNaN(t)?"string"==typeof e&&e.match(/^#[0-9a-fA-F]{6}$/)?e:"#000":r.utils.colour.hueToHex(t)},n.bitmapToImageURI=function(e,t,n){const r=pxt.appTarget.runtime.palette.slice(1),i=document.createElement("canvas");i.width=t,i.height=t;const s=Math.min(t/e.width,t/e.height),o=Math.max(Math.floor(t*(1-e.width/e.height)/2),0),a=Math.max(Math.floor(t*(1-e.height/e.width)/2),0);let l;n?((l=i.getContext("2d",{alpha:!1})).fillStyle="#dedede",l.fillRect(0,0,t,t)):l=i.getContext("2d");for(let t=0;t<e.width;t++)for(let i=0;i<e.height;i++){const c=e.get(t,i);c?(l.fillStyle=r[c-1],l.fillRect(o+t*s,a+i*s,s,s)):n&&(l.fillStyle="#dedede",l.fillRect(o+t*s,a+i*s,s,s))}return i.toDataURL()},n.tilemapToImageURI=function(e,t,n){const r=pxt.appTarget.runtime.palette.slice(),i=document.createElement("canvas");i.width=t,i.height=t;const s=Math.min(t/e.tilemap.width,t/e.tilemap.height),o=Math.max(Math.floor(t*(1-e.tilemap.width/e.tilemap.height)/2),0),a=Math.max(Math.floor(t*(1-e.tilemap.height/e.tilemap.width)/2),0);let l;n?((l=i.getContext("2d",{alpha:!1})).fillStyle="#dedede",l.fillRect(0,0,t,t)):l=i.getContext("2d");let c=[];for(let t=0;t<e.tilemap.width;t++)for(let i=0;i<e.tilemap.height;i++){const u=e.tilemap.get(t,i);if(u){if(!c[u]){const t=e.tileset.tiles[u];c[u]=t?pxt.sprite.computeAverageColor(pxt.sprite.Bitmap.fromData(t.bitmap),r):"#dedede"}l.fillStyle=c[u],l.fillRect(o+t*s,a+i*s,s,s)}else n&&(l.fillStyle="#dedede",l.fillRect(o+t*s,a+i*s,s,s))}return i.toDataURL()},n.songToDataURI=function(e,t,n,r,i){const s=pxt.appTarget.runtime.palette.slice(),o=document.createElement("canvas");let a;o.width=t,o.height=n,r?((a=o.getContext("2d",{alpha:!1})).fillStyle="#dedede",a.fillRect(0,0,t,n)):a=o.getContext("2d");const l=[5,11,5,4,2,6,14,2,5,1];i=i||e.measures;const c=Math.max(Math.floor(t/(e.beatsPerMeasure*i*2)),1),u=Math.floor(t/c),d=Math.max(Math.floor(n/12),1),p=Math.floor(n/d);for(const t of e.tracks)for(const n of t.notes){const r=Math.floor(n.startTick/(e.ticksPerBeat/2));if(r>u)break;for(const i of n.notes){const n=12-i.note%12;n>p||(a.fillStyle=s[l[t.id||e.tracks.indexOf(t)]],a.fillRect(r*c,n*d,c,d))}}return o.toDataURL()},n.getAllBlocksWithTilemaps=u,n.getAllBlocksWithTilesets=d,n.needsTilemapUpgrade=function(e){return!!e.getVariablesOfType(pxt.sprite.BLOCKLY_TILESET_TYPE).map((e=>pxt.sprite.legacy.blocklyVariableToTile(e.name))).length},n.upgradeTilemapsInWorkspace=function(e,t){const n=e.getVariablesOfType(pxt.sprite.BLOCKLY_TILESET_TYPE).map((e=>pxt.sprite.legacy.blocklyVariableToTile(e.name)));if(n.length)try{r.Events.disable();let i=[];for(const r of n)r.qualifiedName?i[r.projectId]=t.resolveTile(r.qualifiedName):r.data&&(i[r.projectId]=t.createNewTile(r.data,"myTiles.tile"+r.projectId)),c(e,r);const s=u(e);for(const e of s){const n=pxt.sprite.legacy.decodeTilemap(e.ref.getInitText(),"typescript"),r=[],s=new pxt.sprite.TilemapData(n.tilemap,{tileWidth:n.tileset.tileWidth,tiles:n.tileset.tiles.map(((e,n)=>null!=e.projectId?i[e.projectId]:(r[n]||(r[n]=t.resolveTile(e.qualifiedName)),r[n])))},n.layers);e.ref.setValue(pxt.sprite.encodeTilemap(s,"typescript"))}const o=d(e);for(const e of o)e.ref.doValueUpdate_(e.ref.getValue()),e.ref.getSize()}finally{r.Events.enable()}},n.getAllFields=p,n.getAllReferencedTiles=function(e,t){var n;let r={};const i=u(e),s=pxt.react.getTilemapProject();for(const e of i)if(e.block.id!==t)for(const t of(null===(n=e.ref.getTileset())||void 0===n?void 0:n.tiles)||[])r[t.id]=s.lookupAsset("tile",t.id);const o=s.getAssets("tilemap");for(const e of o)for(const t of e.data.tileset.tiles)r[t.id]=s.lookupAsset("tile",t.id);const a=d(e);for(const e of a){const t=e.ref.getValue(),n=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(t);if(n){const e=s.lookupAssetByName("tile",n[1]);e&&!r[e.id]&&(r[e.id]=e)}else r[t]||(r[t]=s.resolveTile(t))}return Object.keys(r).map((e=>r[e])).filter((e=>!!e))},n.getTilesReferencedByTilesets=function(e){let t={};const n=pxt.react.getTilemapProject(),r=d(e);for(const e of r){const r=e.ref.getValue(),i=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(r);if(i){const e=n.lookupAssetByName("tile",i[1]);e&&!t[e.id]&&(t[e.id]=e)}else t[r]||(t[r]=n.resolveTile(r))}return Object.keys(t).map((e=>t[e])).filter((e=>!!e))},n.getTemporaryAssets=function(e,t){switch(t){case"image":return p(e,(e=>e instanceof a.FieldSpriteEditor&&e.isTemporaryAsset())).map((e=>e.ref.getAsset()));case"animation":return p(e,(e=>e instanceof s.FieldAnimationEditor&&e.isTemporaryAsset())).map((e=>e.ref.getAsset()));case"song":return p(e,(e=>e instanceof o.FieldMusicEditor&&e.isTemporaryAsset())).map((e=>e.ref.getAsset()));default:return[]}},n.FIELD_EDITOR_OPEN_EVENT_TYPE="field_editor_open";class h extends r.Events.UiBase{constructor(e,t){super(e.workspace.id),this.type=n.FIELD_EDITOR_OPEN_EVENT_TYPE,this.blockId=e.id,this.isOpen=t}}function f(e){return e.data?/^(?:\d+;?)+$/.test(e.data)?{commentRefs:e.data.split(";"),fieldData:{}}:JSON.parse(e.data):{commentRefs:[],fieldData:{}}}function m(e,t){e.data=JSON.stringify(t)}n.FieldEditorOpenEvent=h,n.setMelodyEditorOpen=function(e,t){r.Events.fire(new h(e,t))},n.workspaceToScreenCoordinates=function(e,t){const n=t.scale(e.scale),i=e.getOriginOffsetInPixels(),s=r.utils.Coordinate.sum(n,i),o=e.getInjectionDiv().getBoundingClientRect();return new r.utils.Coordinate(s.x+o.left,s.y+o.top)},n.getBlockData=f,n.setBlockData=m,n.setBlockDataForField=function(e,t,n){const r=f(e);r.fieldData[t]=n,m(e,r)},n.getBlockDataForField=function(e,t){return f(e).fieldData[t]}},{"./field_animation":26,"./field_musiceditor":40,"./field_sprite":48,"./field_tilemap":52,"./field_tileset":53,blockly:154}],65:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./field_utils"),n),i(e("./fieldEditorRegistry"),n),i(e("./field_animation"),n),i(e("./field_argumentvariable"),n),i(e("./field_kind"),n),i(e("./field_asset"),n),i(e("./field_ledmatrix"),n),i(e("./field_styledlabel"),n),i(e("./field_base"),n),i(e("./field_tsexpression"),n),i(e("./field_textinput"),n),i(e("./field_tilemap"),n),i(e("./field_userenum"),n),i(e("./field_procedure"),n),i(e("./field_sprite"),n),i(e("./field_imagedropdown"),n),i(e("./field_protractor"),n),i(e("./field_toggle_highlow"),n),i(e("./field_images"),n),i(e("./field_sound_effect"),n),i(e("./field_toggle_onoff"),n),i(e("./field_speed"),n),i(e("./field_toggle_updown"),n),i(e("./field_toggle_winlose"),n),i(e("./field_autocomplete"),n),i(e("./field_melodySandbox"),n),i(e("./field_toggle_yesno"),n),i(e("./field_musiceditor"),n),i(e("./field_textdropdown"),n),i(e("./field_note"),n),i(e("./field_turnratio"),n),i(e("./field_colorwheel"),n),i(e("./field_numberdropdown"),n),i(e("./field_colour"),n),i(e("./field_position"),n),i(e("./field_tileset"),n),i(e("./field_gridpicker"),n),i(e("./field_toggle"),n)},{"./fieldEditorRegistry":25,"./field_animation":26,"./field_argumentvariable":27,"./field_asset":28,"./field_autocomplete":29,"./field_base":30,"./field_colorwheel":31,"./field_colour":32,"./field_gridpicker":34,"./field_imagedropdown":35,"./field_images":36,"./field_kind":37,"./field_ledmatrix":38,"./field_melodySandbox":39,"./field_musiceditor":40,"./field_note":41,"./field_numberdropdown":42,"./field_position":43,"./field_procedure":44,"./field_protractor":45,"./field_sound_effect":46,"./field_speed":47,"./field_sprite":48,"./field_styledlabel":49,"./field_textdropdown":50,"./field_textinput":51,"./field_tilemap":52,"./field_tileset":53,"./field_toggle":54,"./field_toggle_highlow":56,"./field_toggle_onoff":57,"./field_toggle_updown":58,"./field_toggle_winlose":59,"./field_toggle_yesno":60,"./field_tsexpression":61,"./field_turnratio":62,"./field_userenum":63,"./field_utils":64}],66:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.attachCardInfo=n.mkCard=n.installHelpResources=n.setHelpResources=n.installBuiltinHelpInfo=n.setBuiltinHelpInfo=void 0;const r=e("blockly"),i=e("./xml"),s=e("./external"),o=e("./toolbox");function a(e,t,n,r,o,a,l,c,u){!r||"string"!=typeof r&&"function"!=typeof r||e.setTooltip(r),o&&e.setHelpUrl(o),a&&e.setColour(a,l,c),u&&e.setDeletable(!1);let d=document.getElementById("blocklyToolboxDefinition"),p=d?(0,i.getFirstChildWithAttr)(d,"block","type",t):void 0;e.codeCard={header:n,name:n,software:1,description:"function"==typeof r?r(e):r,blocksXml:p?'<xml xmlns="http://www.w3.org/1999/xhtml">'+((0,i.cleanOuterHTML)(p)||`<block type="${t}"></block>`)+"</xml>":void 0,url:o},pxt.Util.isTranslationMode()&&(e.customContextMenu=n=>{const r=pxt.blocks.getBlockDefinition(e.type);r&&r.translationIds&&n.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,s.promptTranslateBlock)(t,r.translationIds)}})})}function l(e,t,n,i,s,o,l){let c=r.Blocks[e],u=c.init;u&&(c.init=function(){u.call(this),a(this,e,t,n,i,s,o,l)})}function c(e,t){return{name:e.namespace+"."+e.name,shortName:e.name,description:e.attributes.jsDoc,url:e.attributes.help?"reference/"+e.attributes.help.replace(/^\//,""):void 0,blocksXml:`<xml xmlns="http://www.w3.org/1999/xhtml">${(0,i.cleanOuterHTML)(t)}</xml>`}}n.setBuiltinHelpInfo=function(e,t){const n=pxt.blocks.getBlockDefinition(t);a(e,t,n.name,n.tooltip,n.url,pxt.toolbox.getNamespaceColor(n.category))},n.installBuiltinHelpInfo=function(e){const t=pxt.blocks.getBlockDefinition(e);l(e,t.name,t.tooltip,t.url,pxt.toolbox.getNamespaceColor(t.category))},n.setHelpResources=a,n.installHelpResources=l,n.mkCard=c,n.attachCardInfo=function(e,t){const n=e.apis.byQName[t];if(n){const t=pxt.blocks.compileInfo(n);return c(n,(0,o.createToolboxBlock)(e,n,t))}}},{"./external":24,"./toolbox":120,"./xml":121,blockly:154}],67:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateAllReferencedBlocksExist=n.patchShadows=n.patchCommentIds=n.importXml=n.loadWorkspaceXml=n.loadBlocksXml=n.getFirstChildWithAttr=n.getChildrenWithAttr=n.getBlocksWithType=n.getDirectChildren=n.saveBlocksXml=n.workspaceToDom=n.saveWorkspaceXml=n.clearWithoutEvents=n.domToWorkspaceNoEvents=void 0;const r=e("blockly"),i=e("./loader"),s=e("./external"),o=e("./fields");function a(e,t,n){pxt.tickEvent("blocks.domtow");let i=[];h(e),m(e,!1);try{r.Events.disable(),i=r.Xml.domToWorkspace(e,t),o.FieldBase.flushInitQueue();for(const e of t.getAllBlocks())e.afterWorkspaceLoad&&e.afterWorkspaceLoad.call(e);!function(e,t){e.getAllBlocks(!1).filter((e=>!!e.getCommentText())).forEach((n=>{var r,i;const s=n.getCommentText();if(/@hide/.test(s)&&(null==t?void 0:t.applyHideMetaComment))return void n.dispose(!0);let o=s;/@highlight/.test(o)&&(o=o.replace(/@highlight/g,"").trim(),null===(i=(r=e).highlightBlock)||void 0===i||i.call(r,n.id,!0)),/@collapsed/.test(o)&&!n.getParent()&&(o=o.replace(/@collapsed/g,"").trim(),n.setCollapsed(!0)),s===(o=o.replace(/@validate-\S+/g,"").trim())||(null==t?void 0:t.keepMetaComments)||n.setCommentText(o||null)}))}(t,n)}catch(e){pxt.reportException(e)}finally{r.Events.enable()}return i.filter((e=>!!t.getBlockById(e)))}function l(e,t){const n=r.Xml.workspaceToDom(e,t),i=r.Xml.variablesToDom(e.getAllVariables()),s=c(n,"variables");for(const e of s)e.remove();return n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),n}function c(e,t){const n=[];for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes.item(r);i.tagName===t&&n.push(i)}return n}function u(e,t){return d(e,"block","type",t).concat(d(e,"shadow","type",t))}function d(e,t,n,r){return pxt.Util.toArray(e.getElementsByTagName(t)).filter((e=>e.getAttribute(n)===r))}function p(e,t,n,r){const i=d(e,t,n,r);return i.length?i[0]:void 0}function h(e){const t=c(e,"comment");for(const e of t)e.hasAttribute("id")||e.setAttribute("id",r.utils.idGenerator.genUid())}function f(e){if(2===e.parentElement.childElementCount)return void e.remove();const t=r.utils.xml.createElement("block");for(const n of e.getAttributeNames())t.setAttribute(n,e.getAttribute(n));for(const n of e.childNodes)t.appendChild(n.cloneNode(!0));return e.parentElement.appendChild(t),e.remove(),t}function m(e,t){if("shadow"===e.tagName){const t=e.getAttribute("type");let n=!1;switch(t){case"variables_get_reporter":case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":n=!0}if(n){if(!(e=f(e)))return;let t=c(e,"mutation")[0];t?t.setAttribute("duplicateondrag","true"):((t=r.utils.xml.createElement("mutation")).setAttribute("duplicateondrag","true"),e.appendChild(t))}else("variables_get"===t||_(e))&&(e=f(e))}if(e)for(const n of e.children)m(n,t||"shadow"===e.tagName)}function _(e){for(const t of e.children)if("block"===t.tagName.toLowerCase()||_(t))return!0;return!1}function g(e,t,n){var s;let o=n.getAttribute("type"),a=r.Blocks[o],l=(0,i.blockSymbol)(o);if(!l||!a)return;let c=pxt.blocks.compileInfo(l);null===(s=l.parameters)||void 0===s||s.forEach(((r,i)=>{let s=e.apis.byQName[r.type];if(s&&6==s.kind){let e=p(n,"field","name",c.actualNameToParam[r.name].definitionName);if(e){let n=t[s.name+"."+e.textContent];n&&(e.textContent=n)}}}))}n.domToWorkspaceNoEvents=a,n.clearWithoutEvents=function(e){if(pxt.tickEvent("blocks.clear"),e)try{r.Events.disable(),e.clear(),e.clearUndo()}finally{r.Events.enable()}},n.saveWorkspaceXml=function(e,t){const n=l(e,!t);return r.Xml.domToText(n)},n.workspaceToDom=l,n.saveBlocksXml=function(e,t){return e.getTopBlocks(!1).map((e=>r.Xml.domToText(r.Xml.blockToDom(e,!t))))},n.getDirectChildren=c,n.getBlocksWithType=u,n.getChildrenWithAttr=d,n.getFirstChildWithAttr=p,n.loadBlocksXml=function(e,t){let n=r.utils.xml.textToDom(t),i=r.Xml.domToBlock(n,e);if(e.getMetrics){let t=e.getMetrics(),n=i.getHeightWidth();i.moveBy(t.viewLeft+t.viewWidth/2-n.width/2,t.viewTop+t.viewHeight/2-n.height/2)}},n.loadWorkspaceXml=function(e,t=!1,n){const i=new r.Workspace;try{return a(r.utils.xml.textToDom(e),i,n),i}catch(e){return t||pxt.reportException(e),null}},n.importXml=function(e,t,n,r=!1){try{(0,i.initializeAndInject)(n);const r=(new DOMParser).parseFromString(t,"application/xml"),o=pxt.patching.computePatches(e);o&&(o.filter((e=>"blockId"==e.type)).forEach((e=>Object.keys(e.map).forEach((t=>{u(r,t).forEach((n=>{n.setAttribute("type",e.map[t]),pxt.debug(`patched block ${t} -> ${e.map[t]}`)}))})))),o.filter((e=>"blockValue"==e.type)).forEach((e=>Object.keys(e.map).forEach((t=>{const n=t.split("."),i=n[0];n[1],u(r,i).reduce(((e,t)=>e.concat(c(t,"value"))),[]).forEach((n=>{n.setAttribute("name",e.map[t]),pxt.debug(`patched block value ${t} -> ${e.map[t]}`)}))})))),o.filter((e=>"userenum"==e.type)).forEach((e=>Object.keys(e.map).forEach((t=>{d(r,"variable","type",t).forEach((n=>{n.setAttribute("type",e.map[t]),pxt.debug(`patched enum variable type ${t} -> ${e.map[t]}`)}))})))));const a=c(r.children.item(0),"shadow");for(const e of a){const t=r.createElement("block");e.getAttributeNames().forEach((n=>t.setAttribute(n,e.getAttribute(n))));for(let n=0;n<e.childNodes.length;n++)t.appendChild(e.childNodes.item(n));e.replaceWith(t)}m(r.documentElement,!1),h(r.documentElement);const l={};Object.keys(n.apis.byQName).forEach((e=>{let t=n.apis.byQName[e];7==t.kind&&(l[t.namespace+"."+(t.attributes.blockImportId||t.attributes.block||t.attributes.blockId||t.name)]=t.namespace+"."+t.name)}));const p=r.getElementsByTagName("block");for(let e=0;e<p.length;++e)g(n,l,p[e]);return function(e,t){const n=u(e,ts.pxtc.ON_START_TYPE);let r=n.length?n[0]:void 0;if(r)return void r.removeAttribute("deletable");let s=[];const o=t.blocksById;let a,l=e.firstElementChild;for(;l;){const t=l.nextElementSibling,n=l.getAttribute("type");if(!l.getAttribute("disabled")&&!l.getElementsByTagName("statement").length&&(i.buildinBlockStatements[n]||o[n]&&"void"==o[n].retType&&!(0,i.hasArrowFunction)(o[n])))if(a){const t=e.ownerDocument.createElement("next");t.appendChild(l),a.appendChild(t),l.removeAttribute("x"),l.removeAttribute("y"),a=l}else(a=e.ownerDocument.createElement("statement")).setAttribute("name","HANDLER"),r||((r=e.ownerDocument.createElement("block")).setAttribute("type",ts.pxtc.ON_START_TYPE),s.push(r)),r.appendChild(a),a.appendChild(l),l.removeAttribute("x"),l.removeAttribute("y"),a=l;l=t}s.forEach((t=>e.appendChild(t)))}(r.documentElement,n),function(e,t){pxt.U.toArray(e.querySelectorAll("block[type=procedures_defnoreturn]")).forEach((e=>{e.setAttribute("type","function_definition"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")})),pxt.U.toArray(e.querySelectorAll("block[type=procedures_callnoreturn]")).forEach((e=>{e.setAttribute("type","function_call"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}))}(r.documentElement),(0,s.extensionBlocklyPatch)(e,r.documentElement),(new XMLSerializer).serializeToString(r)}catch(e){return r||pxt.reportException(e),t}},n.patchCommentIds=h,n.patchShadows=m,n.validateAllReferencedBlocksExist=function(e){pxt.U.assert(!!(null==r?void 0:r.Blocks),"Called validateAllReferencedBlocksExist before initializing Blockly");const t=r.utils.xml.textToDom(e),n=t.querySelectorAll("block");for(let e=0;e<n.length;e++)if(!r.Blocks[n.item(e).getAttribute("type")])return!1;const i=t.querySelectorAll("shadow");for(let e=0;e<i.length;e++)if(!r.Blocks[i.item(e).getAttribute("type")])return!1;return!0}},{"./external":24,"./fields":65,"./loader":71,blockly:154}],68:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.external=n.contextMenu=void 0,i(e("./plugins/arrays"),n),i(e("./plugins/functions"),n),i(e("./plugins/logic"),n),i(e("./plugins/math"),n),i(e("./plugins/text"),n),i(e("./plugins/renderer"),n),i(e("./plugins/flyout"),n),i(e("./plugins/newVariableField"),n),i(e("./compiler/compiler"),n),i(e("./compiler/environment"),n),i(e("./loader"),n),i(e("./layout"),n),i(e("./render"),n),i(e("./toolbox"),n),i(e("./fields"),n),i(e("./sourceMap"),n),i(e("./importer"),n),i(e("./diff"),n),i(e("./legacyMutations"),n),i(e("./blockDragger"),n);const s=e("./contextMenu");n.contextMenu=s;const o=e("./external");n.external=o,i(e("./breakpointIcon"),n)},{"./blockDragger":1,"./breakpointIcon":2,"./compiler/compiler":12,"./compiler/environment":13,"./contextMenu":21,"./diff":23,"./external":24,"./fields":65,"./importer":67,"./layout":69,"./legacyMutations":70,"./loader":71,"./plugins/arrays":75,"./plugins/flyout":80,"./plugins/functions":93,"./plugins/logic":99,"./plugins/math":101,"./plugins/newVariableField":105,"./plugins/renderer":110,"./plugins/text":115,"./render":118,"./sourceMap":119,"./toolbox":120}],69:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.documentToSvg=n.blocklyToSvgAsync=n.cleanUpBlocklySvg=n.serializeSvgString=n.serializeNode=n.toSvgAsync=n.toPngAsync=n.screenshotAsync=n.screenshotEnabled=n.flow=n.setCollapsedAll=n.verticalAlign=n.splitSvg=n.patchBlocksFromOldWorkspace=void 0;const r=e("blockly"),i=e("./compiler/environment"),s=e("./fields"),o=e("./compiler/compiler"),a=e("./importer");n.patchBlocksFromOldWorkspace=function(e,t,n){const s=(0,a.loadWorkspaceXml)(n,!0);return function(e,t,n){let r,s;t.getTopBlocks(!1).filter((e=>e.isEnabled())).forEach((a=>{const l=a.getRelativeToSurfaceXY();if(l&&0!=l.x&&0!=l.y){r||(r=(0,i.mkEnv)(t,e),s={},n.getTopBlocks(!1).forEach((e=>{const t=(0,o.callKey)(r,e),n=s[t]||[];n.push(e),s[t]=n})));const c=(0,o.callKey)(r,a),u=(s[c]||[]).shift();if(u){const e=u.getRelativeToSurfaceXY();e.x=l.x,e.y=l.y}}}))}(e,t,s),function(e,t){const n=(0,a.workspaceToDom)(e,!0),i=(0,a.workspaceToDom)(t,!0);return pxt.Util.toArray(n.childNodes).filter((e=>e.nodeType==Node.ELEMENT_NODE&&"block"==e.localName&&"true"==e.getAttribute("disabled"))).filter((e=>!!r.Blocks[e.getAttribute("type")])).forEach((e=>i.appendChild(i.ownerDocument.importNode(e,!0)))),r.Xml.domToText(i)}(t,s)},n.splitSvg=function(e,t,n=18){const r=t.getTopComments(!0),i=t.getTopBlocks(!0);if(r.length+i.length<2)return e;const s=document.createElement("div");function o(t,r,i,o,a,l){const c=e.cloneNode(!0),u=c.querySelector(`g.blocklyWorkspace > g.${t}`),d=c.querySelector(`g.blocklyWorkspace > g.${r}`),p=pxt.Util.toArray(u.querySelectorAll(`g.blocklyWorkspace > g.${t} > ${l?"."+l:"g[transform]"}`)),h=p.splice(i,1)[0];if(!h)return void pxt.log("missing block, did block failed to load?");p.filter((e=>e!=h)).forEach((e=>{e.parentNode.removeChild(e)})),u.removeAttribute("transform"),d.parentNode.removeChild(d),h.setAttribute("transform",`translate(${a.x}, ${a.y})`);const f=o.width/n+"em",m=o.height/n+"em";c.setAttribute("viewBox",`0 0 ${o.width} ${o.height}`),c.style.width=f,c.style.height=m,c.setAttribute("width",f),c.setAttribute("height",m),s.appendChild(c)}return s.className=`blocks-svg-list ${t.getInjectionDiv().className}`,r.forEach(((e,t)=>o("blocklyBubbleCanvas","blocklyBlockCanvas",t,e.getHeightWidth(),{x:0,y:0},"blocklyComment"))),i.forEach(((e,t)=>{const r=e.getHeightWidth(),i={x:0,y:0};e.hat&&(r.height+=n,i.y+=n),o("blocklyBlockCanvas","blocklyBubbleCanvas",t,r,i)})),s},n.verticalAlign=function(e,t){let n=0;e.getTopComments(!0).forEach((e=>{e.moveBy(0,n),n+=e.getHeightWidth().height,n+=t})),e.getTopBlocks(!0).forEach(((e,r)=>{e.hat&&(n+=t),e.moveBy(0,n),n+=e.getHeightWidth().height,n+=t}))},n.setCollapsedAll=function(e,t){e.getTopBlocks(!1).filter((e=>e.isEnabled())).forEach((e=>e.setCollapsed(t)))};const l=20;function c(e,t,n){let r;n&&(r={target:pxt.appTarget.id,versions:pxt.appTarget.versions,xml:(0,a.saveBlocksXml)(e).map((e=>pxt.Util.htmlEscape(e)))});const i=0|t||4;return p(e,i).then((e=>e?pxt.BrowserUtils.encodeToPngAsync(e.xml,{width:e.width,height:e.height,pixelDensity:i,text:n?JSON.stringify(r,null,2):null}):Promise.resolve(void 0))).catch((e=>{pxt.reportException(e)}))}n.flow=function(e,t){if(t){if(t.useViewWidth){const t=e.getMetrics();if(t.viewHeight>t.viewWidth)return v(e.getTopComments(!0),e.getTopBlocks(!0),void 0,t.viewWidth),void e.scroll(l,20)}v(e.getTopComments(!0),e.getTopBlocks(!0),t.ratio)}else v(e.getTopComments(!0),e.getTopBlocks(!0));e.scroll(l,20)},n.screenshotEnabled=function(){return!pxt.BrowserUtils.isIE()},n.screenshotAsync=function(e,t,n){return c(e,t,n)},n.toPngAsync=c;const u="http://www.w3.org/1999/xlink",d=12e7;function p(e,t){if(!e)return Promise.resolve(void 0);const n=e.getBlocksBoundingBox(),r=e.getParentSvg().cloneNode(!0);m(r);let i=n.right-n.left,s=n.bottom-n.top,o=1;const a=i*s*Math.pow(t,2);return a>d&&(o=Math.sqrt(d/a)),_(r,n.left,n.top,i,s,o)}function h(e){return f((new XMLSerializer).serializeToString(e))}function f(e){return e.replace(new RegExp("&nbsp;","g"),"&#160;")}function m(e){pxt.BrowserUtils.removeClass(e,"blocklySvg"),pxt.BrowserUtils.addClass(e,"blocklyPreview pxt-renderer classic-theme"),pxt.U.toArray(e.querySelectorAll(".blocklyMainBackground,.blocklyScrollbarBackground")).forEach((e=>{e&&e.parentNode.removeChild(e)})),pxt.U.toArray(e.querySelectorAll(".blocklyConnectionIndicator,.blocklyInputConnectionIndicator")).forEach((e=>{e&&e.parentNode.removeChild(e)})),e.removeAttribute("width"),e.removeAttribute("height"),pxt.U.toArray(e.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach((e=>e.removeAttribute("transform")));const t=new DOMParser;return pxt.U.toArray(e.querySelectorAll(".blocklyCommentTextarea")).forEach((e=>{const n=t.parseFromString("<!doctype html><body>"+pxt.docs.html2Quote(e.value),"text/html");e.textContent=n.body.textContent})),e}function _(e,t,n,r,i,s){if(!e.childNodes[0])return Promise.resolve(void 0);e.removeAttribute("width"),e.removeAttribute("height"),e.removeAttribute("transform");let o=Math.round(r*(s||1)),a=Math.round(i*(s||1));const l=h(e).replace(/^\s*<svg[^>]+>/i,"").replace(/<\/svg>\s*$/i,""),c=`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="${u}" width="${o}" height="${a}" viewBox="${t} ${n} ${r} ${i}" class="pxt-renderer classic-theme">${l}</svg>`,d=(new DOMParser).parseFromString(c,"image/svg+xml"),p=d.createElementNS("http://www.w3.org/1999/xhtml","style"),f=pxt.Util.isUserLanguageRtl(),m=document.getElementById(`style-${f?"rtl":""}blockly.css`).href,_=pxt.Util.toArray(document.head.getElementsByTagName("link")).filter((e=>pxt.Util.endsWith(e.getAttribute("href"),"semantic.css")))[0].href;return Promise.all([pxt.BrowserUtils.loadAjaxAsync(m),pxt.BrowserUtils.loadAjaxAsync(_)]).then((e=>{var t,n;const r=pxt.Util.toArray(document.head.querySelectorAll("style")).filter((e=>/\.blocklySvg/.test(e.innerText)))[0];e.unshift((null===(t=document.getElementById("blockly-common-style"))||void 0===t?void 0:t.innerText)||""),e.unshift((null===(n=document.getElementById("blockly-renderer-style-pxt-classic"))||void 0===n?void 0:n.innerText)||"");const i=(r?r.innerText:"")+"\n\n"+e.map((e=>e+"\n\n"));return p.appendChild(d.createCDATASection(i)),d.documentElement.insertBefore(p,d.documentElement.firstElementChild),function(e){y||(y={});const t=e.getElementsByTagName("image"),n=pxt.Util.toArray(t).filter((e=>{const t=e.getAttributeNS(u,"href");return t&&!/^data:/.test(t)})).map((e=>e)).map((e=>{const t=e.getAttributeNS(u,"href");let n=y[t];return(n?Promise.resolve(y[t]):pxt.BrowserUtils.loadImageAsync(e.getAttributeNS(u,"href")).then((e=>{const r=document.createElement("canvas"),i=r.getContext("2d");let s=e.width,o=e.height;return r.width=s,r.height=o,i.drawImage(e,0,0,s,o,0,0,r.width,r.height),y[t]=n=r.toDataURL("image/png"),n})).catch((e=>(pxt.debug(`svg render: failed to load ${t}`),"")))).then((t=>{e.setAttributeNS(u,"href",t)}))}));return Promise.all(n).then((()=>{}))}(d).then((()=>function(e){if(b||(b={}),!pxt.BrowserUtils.isEdge())return Promise.resolve();const t=e.getElementsByTagName("image"),n=pxt.Util.toArray(t).filter((e=>/^data:image\/svg\+xml/.test(e.getAttributeNS(u,"href")))).map((e=>e)).map((e=>{const t=e.getAttributeNS(u,"href"),n=parseInt(e.getAttribute("width").replace(/[^0-9]/g,"")),r=parseInt(e.getAttribute("height").replace(/[^0-9]/g,""));let i=b[t];return(i?Promise.resolve(i):pxt.BrowserUtils.encodeToPngAsync(t,{width:n,height:r,pixelDensity:2})).then((n=>{b[t]=n,e.setAttributeNS(u,"href",n)}))}));return Promise.all(n).then((()=>{}))}(d))).then((()=>({width:o,height:a,svg:h(d).replace('<style xmlns="http://www.w3.org/1999/xhtml">',"<style>"),xml:g(d),css:i})))}))}function g(e){const t=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;base64,"+ts.pxtc.encodeBase64(unescape(encodeURIComponent(t)))}let y,b;function v(e,t,n=1.62,r){const i=[],o={};let a;e.forEach((e=>{const t=e.data;null!=t&&(o[t]=e)})),t.sort(((e,t)=>e.isEnabled()===t.isEnabled()?e.type===t.type?0:"function_definition"===e.type?1:"function_definition"===t.type?-1:e.type.localeCompare(t.type):e.isEnabled()?-1:1)),t.forEach((e=>{const t=(0,s.getBlockData)(e).commentRefs;if(t.length){const n=[];for(let e=0;e<t.length;e++){const r=o[t[e]];r&&(n.push(T(r)),delete o[t[e]])}if(n.length)return void i.push({value:e,width:-1,height:-1,children:n})}const n=T(e);!a&&e.isEnabled()&&e.type===pxtc.ON_START_TYPE?a=n:i.push(n)})),a&&i.unshift(a),Object.keys(o).sort(((e,t)=>e.length===t.length?e>t?-1:1:e.length>t.length?-1:1)).forEach((e=>{o[e]&&i.push(T(o[e]))})),e.forEach((e=>{null==e.data&&i.push(T(e))}));let c,u=0;for(let e=0;e<i.length;e++){const t=i[e];if(t.children){const e=t.value.getHeightWidth();t.x=0,t.y=0;let n=e.width+13,r=0;for(let e=0;e<t.children.length;e++){const i=t.children[e];i.x=n,i.y=r,r+=i.height+13,t.width=Math.max(t.width,n+i.width)}t.height=Math.max(r-13,e.height)}u+=(t.height+13)*(t.width+13)}c=r>l?r-l:Math.sqrt(u)*n;let d=l,p=20,h=0;for(let e=0;e<i.length;e++){const t=i[e];if(t.children){f(t,d+t.x,p+t.y);for(let e=0;e<t.children.length;e++){const n=t.children[e];f(n,d+n.x,p+n.y)}}else f(t,d,p);d+=t.width+45,h=Math.max(h,p+t.height+45),d>c&&(d=l,p=h)}function f(e,t,n){const r=e.value.getBoundingRectangle();e.value.moveBy(t-r.left,n-r.top)}}function T(e){const t=e.getHeightWidth();return{value:e,height:t.height,width:t.width}}n.toSvgAsync=p,n.serializeNode=h,n.serializeSvgString=f,n.cleanUpBlocklySvg=m,n.blocklyToSvgAsync=_,n.documentToSvg=g},{"./compiler/compiler":12,"./compiler/environment":13,"./fields":65,"./importer":67,blockly:154}],70:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mutateToolboxBlock=n.addMutation=n.MutatorTypes=void 0;const r=e("blockly"),i=e("./compiler/util"),s=e("./compiler/compiler"),o=e("./loader");var a,l;(l=a=n.MutatorTypes||(n.MutatorTypes={})).ObjectDestructuringMutator="objectdestructuring",l.RestParameterMutator="restparameter",l.DefaultInstanceMutator="defaultinstance",n.addMutation=function(e,t,n){let r;switch(n){case a.ObjectDestructuringMutator:if(!t.parameters||t.parameters.length<1)console.error("Destructuring mutations require at least one parameter");else{let e=!1;for(const n of t.parameters)if(-1!==n.type.indexOf("=>")){if(!n.properties||0===n.properties.length)return void console.error("Destructuring mutations only supported for functions with an event parameter that has multiple properties");e=!0}if(!e)return void console.error("Destructuring mutations must have an event parameter")}r=new u(e,t);break;case a.RestParameterMutator:r=new d(e,t);break;case a.DefaultInstanceMutator:r=new p(e,t);break;default:return void console.warn("Ignoring unknown mutation type: "+n)}e.mutationToDom=r.mutationToDom.bind(r),e.domToMutation=r.domToMutation.bind(r),e.compose=r.compose.bind(r),e.decompose=r.decompose.bind(r),e.mutation=r},n.mutateToolboxBlock=function(e,t,n){const r=document.createElement("mutation");switch(t){case a.ObjectDestructuringMutator:r.setAttribute(u.propertiesAttributeName,n);break;case a.RestParameterMutator:r.setAttribute(d.countAttributeName,n);break;case a.DefaultInstanceMutator:r.setAttribute(p.attributeName,n);default:return void console.warn("Ignoring unknown mutation type: "+t)}e.appendChild(r)};class c{constructor(e,t){this.info=t,this.block=e,this.topBlockType=this.block.type+"_mutator";const n=this.getSubBlockNames();this.initializeMutatorTopBlock(),this.initializeMutatorSubBlocks(n);const i=n.map((e=>e.type));this.block.setMutator(new r.icons.MutatorIcon(i,e))}compose(e){const t=e.getDescendants(!1).map((e=>({type:e.type,name:e.inputList[0].name})));t.shift(),this.updateBlock(t)}decompose(e){const t=e.newBlock(this.topBlockType);t.initSvg();for(const n of t.inputList)if(n.name===c.mutatorStatmentInput){let t=n.connection;this.getVisibleBlockTypes().forEach((n=>{const r=e.newBlock(n);r.initSvg(),t.connect(r.previousConnection),t=r.nextConnection}));break}return t}compileMutation(e,t){}getDeclaredVariables(){}isDeclaredByMutation(e){return!1}initializeMutatorSubBlock(e,t,n){e.appendDummyInput(t).appendField(t),e.setColour(n),e.setNextStatement(!0),e.setPreviousStatement(!0)}initializeMutatorTopBlock(){const e=this.info.attributes.mutateText,t=this.block.getColour();r.Blocks[this.topBlockType]=r.Blocks[this.topBlockType]||{init:function(){this.appendDummyInput().appendField(e),this.setColour(t),this.appendStatementInput(c.mutatorStatmentInput)}}}initializeMutatorSubBlocks(e){const t=this.block.getColour(),n=this.initializeMutatorSubBlock.bind(this);e.forEach((e=>{r.Blocks[e.type]=r.Blocks[e.type]||{init:function(){n(this,e.name,t)}}}))}}c.mutatorStatmentInput="PROPERTIES",c.mutatedVariableInputName="properties";class u extends c{constructor(e,t){super(e,t),this.currentlyVisible=[],this.parameterRenames={},this.prefix=this.info.attributes.mutatePrefix,this.block.appendDummyInput(c.mutatedVariableInputName),this.block.appendStatementInput("HANDLER").setCheck("null")}getMutationType(){return a.ObjectDestructuringMutator}compileMutation(e,t){if(!this.info.attributes.mutatePropertyEnum&&!this.parameters.length)return;const n=`function ({ ${this.parameters.map((t=>{const n=this.block.getField(t),r=n&&n.getText(),s=(0,i.escapeVarName)(t,e);return r!==t?(this.parameterRenames[t]=r,`${t}: ${(0,i.escapeVarName)(r,e)}`):s})).join(", ")} })`;return this.info.attributes.mutatePropertyEnum?pxt.blocks.mkText(` [${this.parameters.map((e=>`${this.info.attributes.mutatePropertyEnum}.${e}`)).join(", ")}],${n}`):pxt.blocks.mkText(n)}getDeclaredVariables(){const e={};return this.parameters.forEach((t=>{e[this.getVarFieldValue(t)]=this.parameterTypes[t]})),e}isDeclaredByMutation(e){return this.parameters.some((t=>this.getVarFieldValue(t)===e))}mutationToDom(){const e=document.createElement("mutation"),t=this.parameters.map((e=>{const t=this.getVarFieldValue(e);return t!==e&&(this.parameterRenames[e]=pxt.Util.htmlEscape(t)),pxt.Util.htmlEscape(e)})).join(",");e.setAttribute(u.propertiesAttributeName,t);for(const e in this.parameterRenames)e===this.parameterRenames[e]&&delete this.parameterRenames[e];return e.setAttribute(u.renameAttributeName,JSON.stringify(this.parameterRenames)),e}domToMutation(e){const t=e.getAttribute(u.propertiesAttributeName);if(t){const n=t.split(","),r=[];if(void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),n.forEach((e=>{const t=e.split(":");this.info.parameters[this.paramIndex].properties.some((e=>e.name===t[0]))&&r.push({property:t[0],newName:t[1]})})),this.parameterRenames=void 0,e.hasAttribute(u.renameAttributeName))try{this.parameterRenames=JSON.parse(e.getAttribute(u.renameAttributeName))}catch(e){console.warn("Ignoring invalid rename map in saved block mutation")}this.parameterRenames=this.parameterRenames||{},this.parameters=[],r.forEach((e=>{this.parameters.push(e.property),e.newName&&e.newName!==e.property&&(this.parameterRenames[e.property]=e.newName)})),this.updateVisibleProperties(),r.filter((e=>!!e.newName)).forEach((e=>this.setVarFieldValue(e.property,e.newName)))}}getVarFieldValue(e){const t=this.block.getField(e);return t&&t.getText()}setVarFieldValue(e,t){this.block.getField(e),this.block.getField(e)&&(0,o.setVarFieldValue)(this.block,e,t)}updateBlock(e){this.parameters=[],e.forEach((e=>{-1===this.parameters.indexOf(e.name)&&this.parameters.push(e.name)})),this.updateVisibleProperties()}getSubBlockNames(){return this.parameters=[],this.parameterTypes={},void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),this.info.parameters[this.paramIndex].properties.map((e=>(this.parameterTypes[e.name]=e.type,{type:this.propertyId(e.name),name:e.name})))}getVisibleBlockTypes(){return this.currentlyVisible.map((e=>this.propertyId(e)))}updateVisibleProperties(){if(pxt.Util.listsEqual(this.currentlyVisible,this.parameters))return;const e=this.block.inputList.find((e=>e.name===c.mutatedVariableInputName));this.prefix&&0===this.currentlyVisible.length&&e.appendField(this.prefix,u.prefixLabel),this.currentlyVisible.forEach((t=>{if(-1===this.parameters.indexOf(t)){const n=this.getVarFieldValue(t);n!==t&&(this.parameterRenames[t]=n),e.removeField(t)}})),this.parameters.forEach((t=>{if(-1===this.currentlyVisible.indexOf(t)){const n=this.parameterRenames[t]||t;e.appendField(new r.FieldVariable(n),t)}})),this.prefix&&0===this.parameters.length&&e.removeField(u.prefixLabel),this.currentlyVisible=this.parameters}propertyId(e){return this.block.type+"_"+e}getParameterIndex(){for(let e=0;e<this.info.parameters.length;e++)if(-1!==this.info.parameters[e].type.indexOf("=>"))return e}}u.propertiesAttributeName="callbackproperties",u.renameAttributeName="renamemap",u.prefixLabel="0prefix_label_";class d extends c{constructor(){super(...arguments),this.count=0}getMutationType(){return a.RestParameterMutator}compileMutation(e,t){const n=[];return this.forEachInput((r=>n.push((0,s.compileExpression)(e,r,t)))),pxt.blocks.mkGroup(n)}mutationToDom(){const e=document.createElement("mutation");return e.setAttribute(d.countAttributeName,this.count.toString()),e}domToMutation(e){const t=e.getAttribute(d.countAttributeName);if(t){try{this.count=parseInt(t)}catch(e){return}for(let e=0;e<this.count;e++)this.addNumberField(!1,e)}}updateBlock(e){if(e){const t=Math.abs(this.count-e.length);if(this.count<e.length)for(let e=0;e<t;e++)this.addNumberField(!0,this.count);else if(this.count>e.length)for(let e=0;e<t;e++)this.removeNumberField()}}getSubBlockNames(){return[{name:"Value",type:d.entryTypeName}]}getVisibleBlockTypes(){const e=[];return this.forEachInput((()=>e.push(d.entryTypeName))),e}addNumberField(e,t){const n=this.block.appendValueInput(d.valueInputPrefix+t).setCheck("Number");if(e){const e=this.block.workspace.newBlock("math_number");e.initSvg(),e.setShadow(!0),n.connection.connect(e.outputConnection),this.block.workspace.render(),this.count++}}removeNumberField(){this.count>0&&this.block.removeInput(d.valueInputPrefix+(this.count-1)),this.count--}forEachInput(e){for(let t=0;t<this.count;t++)e(this.block.getInputTargetBlock(d.valueInputPrefix+t),t)}}d.countAttributeName="count",d.entryTypeName="entry",d.valueInputPrefix="value_input_";class p extends c{constructor(){super(...arguments),this.showing=!1}getMutationType(){return a.DefaultInstanceMutator}compileMutation(e,t){if(this.showing){const n=this.block.getInputTargetBlock(p.instanceInputName);if(n)return(0,s.compileExpression)(e,n,t)}}mutationToDom(){const e=document.createElement("mutation");return e.setAttribute(p.attributeName,this.showing?"true":"false"),e}domToMutation(e){const t=e.getAttribute(p.attributeName);t?this.updateShape("true"===t):this.updateShape(!1)}updateBlock(e){this.updateShape(!(!e||!e.length))}getSubBlockNames(){return[{name:"Instance",type:p.instanceSubBlockType}]}getVisibleBlockTypes(){const e=[];return this.showing&&e.push(p.instanceSubBlockType),e}updateShape(e){this.showing!==e&&(e&&!this.block.getInputTargetBlock(p.instanceInputName)?this.block.appendValueInput(p.instanceInputName):this.block.removeInput(p.instanceInputName),this.showing=e)}}p.attributeName="showing",p.instanceInputName="__instance__",p.instanceSubBlockType="instance"},{"./compiler/compiler":12,"./compiler/util":15,"./loader":71,blockly:154}],71:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PxtWorkspaceSearch=n.setVarFieldValue=n.generateIcons=n.getFixedInstanceDropdownValues=n.setOutputCheck=n.initialize=n.initializeAndInject=n.cleanBlocks=n.hasArrowFunction=n.injectBlocks=n.blockSymbol=n.cachedBlockInfo=n.buildinBlockStatements=n.builtinBlocks=n.isTupleType=void 0;const r=e("blockly"),i=e("@blockly/plugin-workspace-search"),s=e("./constants"),o=e("./composableMutations"),a=e("./legacyMutations"),l=e("./builtins/math"),c=e("./fields"),u=e("./builtins/functions"),d=e("./builtins/lists"),p=e("./builtins/logic"),h=e("./builtins/loops"),f=e("./builtins/text"),m=e("./toolbox"),_=e("./help"),g=e("./fields"),y=e("./fields"),b=e("./fields"),v=e("./fields"),T=e("./external"),k=e("./builtins/variables"),E=e("./builtins/misc"),x=e("./contextMenu"),S=e("./codecardRenderer"),C=e("./monkeyPatches"),I=e("./fields/field_dropdown");let A;function w(){return A||(A={},Object.keys(r.Blocks).forEach((e=>A[e]={block:r.Blocks[e]}))),A}n.isTupleType=function(e){let t=/^\[(.+)\]$/.exec(e);return t?t[1].split(/,\s*/):void 0},n.builtinBlocks=w,n.buildinBlockStatements={controls_if:!0,controls_for:!0,pxt_controls_for:!0,controls_simple_for:!0,controls_repeat_ext:!0,pxt_controls_for_of:!0,controls_for_of:!0,variables_set:!0,variables_change:!0,device_while:!0};let N={};function D(e){return n.cachedBlockInfo=e,e.blocks.map((t=>{const n=pxt.blocks.compileInfo(t),i=(0,m.createToolboxBlock)(e,t,n);if(t.attributes.blockBuiltin){pxt.Util.assert(!!w()[t.attributes.blockId]);const e=w()[t.attributes.blockId];e.symbol=t,e.block.codeCard=(0,_.mkCard)(t,i)}else!function(e,t,n,i){let l=t.attributes.blockId;if(w()[l])return pxt.reportError("blocks","trying to override builtin block",{details:l}),!1;let u=JSON.stringify(t);if(N[l]&&N[l].hash==u)return!0;if(r.Blocks[t.attributes.blockId])return console.error("duplicate block definition: "+l),!1;let d={hash:u,fn:t,block:{codeCard:(0,_.mkCard)(t,i),init:function(){!function(e,t,n,i){var l;const u=(n.attributes.blockNamespace||n.namespace).split(".")[0],d=1==n.kind||2==n.kind,p=t.apis.byQName[u],h=n.attributes.blockNamespace&&p&&p.attributes.color||n.attributes.color||p&&p.attributes.color||pxt.toolbox.getNamespaceColor(u)||255,f=pxt.blocks.getHelpUrl(n);f&&e.setHelpUrl(f),e.setColour(h);let m=s.provider.SHAPES.ROUND;"boolean"==n.retType&&(m=s.provider.SHAPES.HEXAGONAL),e.setOutputShape(m),n.attributes.undeletable&&e.setDeletable(!1),E(n.attributes._def);let _=!1;if(n.attributes.mutate)(0,a.addMutation)(e,n,n.attributes.mutate);else if(n.attributes.defaultInstance)(0,a.addMutation)(e,n,a.MutatorTypes.DefaultInstanceMutator);else if(n.attributes._expandedDef&&"disabled"!==n.attributes.expandableArgumentMode){const r="toggle"===n.attributes.expandableArgumentMode;(0,o.initExpandableBlock)(t,e,n.attributes._expandedDef,i,r,(()=>E(n.attributes._expandedDef,!0)))}else if(i.handlerArgs.length)if(_=!0,n.attributes.optionalVariableArgs)(0,o.initVariableArgsBlock)(e,i.handlerArgs);else if(n.attributes.draggableParameters)i.handlerArgs.filter((e=>!e.inBlockDef)).forEach((r=>{const i=e.appendValueInput("HANDLER_DRAG_PARAM_"+r.name);"reporter"==n.attributes.draggableParameters?i.setCheck(P(r.type,t)):i.setCheck("Variable")}));else{let t=e.appendDummyInput();i.handlerArgs.filter((e=>!e.inBlockDef)).forEach((e=>{t.appendField(new r.FieldVariable(e.name),"HANDLER_"+e.name)}))}(0,o.appendMutation)(e,{mutationToDom:t=>(e.inputList.forEach((e=>{e.fieldRow.forEach((e=>{if(e.isFieldCustom_&&e.saveOptions){const n=e.saveOptions();n&&t.setAttribute("customfield",JSON.stringify(n))}}))})),t),domToMutation:t=>{e.inputList.forEach((e=>{e.fieldRow.forEach((e=>{if(e.isFieldCustom_&&e.restoreOptions){const n=JSON.parse(t.getAttribute("customfield"));n&&e.restoreOptions(n)}}))}))}});const T=n.attributes.imageLiteral||n.attributes.gridLiteral;if(T){const t=(n.attributes.imageLiteralColumns||5)*T,r=n.attributes.imageLiteralRows||5,i=n.attributes.imageLiteralScale,s=n.attributes.gridLiteralOnColor,o=n.attributes.gridLiteralOffColor;e.appendDummyInput().appendField(new g.FieldMatrix("",{columns:t,rows:r,scale:i,onColor:s,offColor:o}),"LEDS")}"external"===n.attributes.inlineInputMode?e.setInputsInline(!1):"inline"===n.attributes.inlineInputMode?e.setInputsInline(!0):e.setInputsInline(!n.parameters||n.parameters.length<4&&!T),((null===(l=n.parameters)||void 0===l?void 0:l.find((e=>pxtc.parameterTypeIsArrowFunction(e))))||_)&&(e.appendStatementInput("HANDLER").setCheck(null),e.setInputsInline(!0)),M(e,n.retType,t);const k=O(n);function E(o,a=!1){let l=0,u=!a&&!!i.thisParameter;const p=function(e){const t=[];let n=[];return e.parts.forEach((e=>{switch(e.kind){case"break":r();break;case"param":n.push(e),r();break;case"image":case"label":n.push(e)}})),r(),t;function r(){n.length&&(t.push(n),n=[])}}(o),f=new pxt.ImageConverter;if(("ENUM_GET"===n.attributes.shim||"KIND_GET"===n.attributes.shim)&&(i.parameters.length>1||i.thisParameter))return void console.warn(`Enum blocks may only have 1 parameter but ${n.attributes.blockId} has ${i.parameters.length}`);const m=t=>{var n;return null===(n=e.inputList)||void 0===n?void 0:n.some((e=>e.name===t))};p.forEach((o=>{const p=[];let _,g,T,k=!1;if(o.forEach((e=>{if("param"!==e.kind){const t=function(e){if("image"===e.kind)return function(e){let t=$[e];if(t)return new r.FieldImage(t,40,40,"",null,pxt.Util.isUserLanguageRtl());pxt.log(`missing jres icon ${e}`)}(e.uri);const t=function(e){if(" "===e)return"";if(e.length>1){const t=" "==e.charAt(0),n=" "==e.charAt(e.length-1);if(t||n)return e.substring(t?1:0,n?e.length-1:e.length)}return e}(e.text);return t?e.cssClass?new r.FieldLabel(t,e.cssClass):e.style.length?new y.FieldStyledLabel(t,{bold:-1!==e.style.indexOf("bold"),italics:-1!==e.style.indexOf("italics"),blocksInfo:void 0}):new r.FieldLabel(t,void 0):void 0}(e);t&&p.push({field:t})}else{if("ENUM_GET"===n.attributes.shim)return pxt.Util.assert(!!n.attributes.enumName,"Trying to create an ENUM_GET block without a valid enum name"),void p.push({name:"MEMBER",field:new b.FieldUserEnum(t.enumsByName[n.attributes.enumName])});if("KIND_GET"===n.attributes.shim)return void p.push({name:"MEMBER",field:new c.FieldKind(t.kindsByName[n.attributes.kindNamespace||n.attributes.blockNamespace||n.namespace])});{let s=function(e,t,n=!1){if(e.ref){const n="this"===e.name?t.thisParameter:t.actualNameToParam[e.name];if(!n){let n;if(t.handlerArgs.forEach((t=>{t.name===e.name&&(n=t)})),n)return n}return n}return n?t.thisParameter:t.definitionNameToParam[e.name]}(e,i,u);if(u=!1,!s)return void console.error("block "+n.attributes.blockId+": unknown parameter "+e.name+(e.ref?` (${e.ref})`:""));if(function(e){return!e.definitionName}(s))return _="HANDLER_DRAG_PARAM_"+s.name,void(g="reporter"===n.attributes.draggableParameters?P(s.type,t):"Variable");let o=pxt.Util.lookup(t.apis.byQName,s.type);k=!0;const a=s.definitionName,l=s.actualName;let c=o&&6==o.kind,m=o&&!!o.attributes.fixedInstances&&!s.shadowBlockId,y=!!n.attributes.constantShim,b="@combined@"==s.type,T=s.fieldEditor,E=a.charAt(0).toUpperCase()+a.slice(1),x=s.type;if(c||m||y||b){let e;0==(e=c?function(e,t){return pxt.Util.values(e.byQName).filter((e=>e.namespace===t&&!e.attributes.blockHidden))}(t.apis,s.type):m?U(t.apis,o.qName):b?n.combinedProperties.map((e=>pxt.Util.lookup(t.apis.byQName,e))):function(e,t){return pxt.Util.values(e.byQName).filter((e=>e.attributes.blockIdentity===t))}(t.apis,n.qName)).length&&console.error(`no instances of ${o.qName} found`);const r=e.map((e=>{let t=e.attributes.block||e.attributes.blockId||e.name,n=e.attributes.blockCombine;return e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=f.convert(e.attributes.jresURL)),n&&(t=t.replace(/@set/,"")),[e.attributes.iconURL||e.attributes.blockImage?{src:e.attributes.iconURL||pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,`blocks/${e.namespace.toLowerCase()}/${e.name.toLowerCase()}.png`),alt:t,width:36,height:36,value:e.name}:t,e.namespace+"."+e.name]}));if(s.defaultValue){let e=-1;if(r.some(((t,n)=>t[1]===s.defaultValue&&(e=n,!0))),e>-1){const t=r.splice(e,1)[0];r.unshift(t)}}if(T){let e=n.attributes.paramDefl[l]||"";const i={data:r,colour:h,label:E,type:x,blocksInfo:t};pxt.Util.jsonMergeFrom(i,n.attributes.paramFieldEditorOptions&&n.attributes.paramFieldEditorOptions[l]||{}),p.push(B((0,v.createFieldEditor)(T,e,i),a))}else p.push(B(new I.FieldDropdown(r),a))}else if(T){const e=n.attributes.paramDefl[s.actualName]||"",r={colour:h,label:E,type:x,blocksInfo:t};pxt.Util.jsonMergeFrom(r,n.attributes.paramFieldEditorOptions&&n.attributes.paramFieldEditorOptions[s.actualName]||{}),p.push(B((0,v.createFieldEditor)(T,e,r),s.definitionName))}else _=a,d&&"this"===e.name?g=s.type:"number"==s.type&&s.shadowBlockId&&"value"==s.shadowBlockId?(_=void 0,p.push(B(new r.FieldNumber("0"),a))):g="string"==s.type&&s.shadowOptions&&s.shadowOptions.toString?null:P(s.type,t)}}})),_){if(m(_))return;(T=e.appendValueInput(_)).setAlign(r.ALIGN_LEFT)}else if(a){const t=k?s.optionalInputWithFieldPrefix:s.optionalDummyInputPrefix;if(_=t+l++,m(_))return;T=e.appendDummyInput(_)}else T=e.appendDummyInput();g&&T.setCheck(g),p.forEach((e=>T.appendField(e.field,e.name)))})),f.logTime()}e.setPreviousStatement(!(k&&!n.attributes.handlerStatement)&&"void"==n.retType),e.setNextStatement(!(k&&!n.attributes.handlerStatement)&&"void"==n.retType),e.setTooltip(/^__/.test(n.namespace)?"":n.attributes.jsDoc)}(this,e,t,n)}}};pxt.Util.isTranslationMode()&&(d.block.customContextMenu=e=>{t.attributes.translationId&&e.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,T.promptTranslateBlock)(l,[t.attributes.translationId])}})}),N[l]=d,r.Blocks[l]=d.block}(e,t,n,i);return t}))}function O(e){var t;return!!(null===(t=e.parameters)||void 0===t?void 0:t.some((e=>pxtc.parameterTypeIsArrowFunction(e))))}n.blockSymbol=function(e){let t=N[e];return t?t.fn:void 0},n.injectBlocks=D,n.hasArrowFunction=O,n.cleanBlocks=function(){pxt.debug("removing all custom blocks");for(const e in N)F(N[e].fn)},n.initializeAndInject=function(e){L(e),D(e)},n.initialize=function(e){L(e),function(e){$={};const t=e.apis.jres;t&&Object.keys(t).forEach((e=>{const n=t[e];n&&n.icon&&($[e]=n.icon)}))}(e)};let R=!1;function L(e){R||(R=!0,(0,C.applyMonkeyPatches)(),(0,v.initFieldEditors)(),(0,x.initContextMenu)(),(0,E.initOnStart)(),(0,l.initMath)(e),(0,k.initVariables)(),(0,u.initFunctions)(),(0,d.initLists)(),(0,h.initLoops)(),(0,p.initLogic)(),(0,f.initText)(),r.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="",function(){const e=e=>{if(e.disabled)return lf("This block is disabled and will not run. Attach this block to an event to enable it.");let t=e.tooltip;for(;"function"==typeof t;)t=t(e);return t};r.Tooltip.setCustomTooltip(((t,n)=>{if(n.codeCard){const r=(0,S.renderCodeCard)({header:e(n)});t.appendChild(r)}else{let i=e(n),s=(i=r.utils.string.wrap(i,r.Tooltip.LIMIT)).split("\n");for(let e=0;e<s.length;e++){let n=document.createElement("div");n.appendChild(document.createTextNode(s[e])),t.appendChild(n)}}}))}())}function P(e,t){const n=e.split(/\s*\|\s*/),r=[];for(const e of n)switch(e){case"number":r.push("Number");break;case"string":r.push("String");break;case"boolean":r.push("Boolean");break;case"T":case"any":return null;case"void":return;default:if((0,m.isArrayType)(e)){if(n.length>1)return null;r.push("Array")}const i=t.apis.byQName[e];i&&i.extendsTypes&&0<i.extendsTypes.length?r.push(...i.extendsTypes):r.push(e)}return r}function M(e,t,n){const r=P(t,n);(r||null===r)&&e.setOutput(!0,r)}function F(e){delete r.Blocks[e.attributes.blockId],delete N[e.attributes.blockId]}n.setOutputCheck=M;let $={};function B(e,t){return{field:e,name:t}}function U(e,t){return pxt.Util.values(e.byQName).filter((n=>4===n.kind&&n.attributes.fixedInstance&&function(e,t,n){if(t==n)return!0;let r=e.byQName[t];return!(!r||!r.extendsTypes)&&r.extendsTypes.indexOf(n)>=0}(e,n.retType,t))).sort(((e,t)=>(t.attributes.weight||50)-(e.attributes.weight||50)))}n.getFixedInstanceDropdownValues=U,n.generateIcons=function(e){const t=new pxt.ImageConverter;e.forEach((e=>{e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=t.convert(e.attributes.jresURL))}))},n.setVarFieldValue=function(e,t,n){const r=e.getField(t),i=e.workspace.getAllVariables();let s=!1;if(i&&i.length)for(let e=0;e<i.length;e++){const t=i[e];t.name===n&&(r.setValue(t.getId()),s=!0)}if(!s){r.initModel();const e=r.getVariable();e.name=n,r.setValue(e.getId())}};class V extends i.WorkspaceSearch{}n.PxtWorkspaceSearch=V},{"./builtins/functions":3,"./builtins/lists":4,"./builtins/logic":5,"./builtins/loops":6,"./builtins/math":7,"./builtins/misc":8,"./builtins/text":9,"./builtins/variables":10,"./codecardRenderer":11,"./composableMutations":17,"./constants":18,"./contextMenu":21,"./external":24,"./fields":65,"./fields/field_dropdown":33,"./help":66,"./legacyMutations":70,"./monkeyPatches":73,"./toolbox":120,"@blockly/plugin-workspace-search":147,blockly:154}],72:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.monkeyPatchBlockSvg=void 0;const r=e("blockly"),i=e("../plugins/renderer/constants");n.monkeyPatchBlockSvg=function(){const e=r.BlockSvg.prototype.setCollapsed;r.BlockSvg.prototype.setCollapsed=function(t){if(t!==this.isCollapsed()&&(e.call(this,t),this.isCollapsed())){const e=this.getInput(r.constants.COLLAPSED_INPUT_NAME),t=i.ConstantProvider.EXPAND_IMAGE_DATAURI;t&&e.appendField(new r.FieldImage(t,24,24,"",(()=>{this.setCollapsed(!1)}),!1))}}}},{"../plugins/renderer/constants":108,blockly:154}],73:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.applyMonkeyPatches=void 0;const r=e("./blockSvg");n.applyMonkeyPatches=function(){(0,r.monkeyPatchBlockSvg)()}},{"./blockSvg":72}],74:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("../functions/constants"),s={valueConnections_:[],horizontalAfter_:3,itemCount_:3,mutationToDom:function(){const e=r.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),this.horizontalAfter_&&e.setAttribute("horizontalafter",this.horizontalAfter_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10);const t=e.getAttribute("horizontalafter");t&&(this.horizontalAfter_=parseInt(t,10)),this.updateShape_()},storeConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreConnections_:function(){var e;for(let t=0;t<this.itemCount_;t++)null===(e=this.valueConnections_[t])||void 0===e||e.reconnect(this,"ADD"+t)},addItem_:function(){if(this.storeConnections_(),this.update_((()=>{this.itemCount_++})),this.restoreConnections_(),this.itemCount_>1){const s=this.getInput("ADD0");if(s&&s.connection.targetConnection){const o=this.getInput("ADD"+(this.itemCount_-1)),a=s.connection.getShadowDom(),l=a&&a.getAttribute("type");if(l){const r=n("shadow",l),i=e(a,"value");for(let n=0;n<i.length;n++){const s=i[n],o=s.getAttribute("name"),a=e(s,"shadow")[0];t(r,o,a&&a.getAttribute("type"))}o.connection.setShadowDom(r)}const c=s.connection.targetConnection,u=c&&c.getSourceBlock(),d=u&&u.type;if(d&&d!==l){const e=n("block",d);if(u)if(d===i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){const t=r.utils.xml.createElement("mutation");t.setAttribute("name",u.getName()),e.appendChild(t)}else if(u.inputList)for(let n=0;n<u.inputList.length;n++){const r=u.inputList[n],i=r.connection&&r.connection.getShadowDom(),s=i&&i.getAttribute("type");t(e,r.name,s)}const s=r.Xml.domToBlock(e,this.workspace);o.connection.connect(s.outputConnection)}else o.connection.setShadowDom(o.connection.getShadowDom())}}function e(e,t){const n=[];if(!e||!e.children)return n;for(let r=0;r<e.children.length;r++){const i=e.children[r];i.tagName===t&&n.push(i)}return n}function t(e,t,i){if(!t||!i)return;const s=r.utils.xml.createElement("value");s.setAttribute("name",t),s.appendChild(n("shadow",i)),e.appendChild(s)}function n(e,t){const n=r.utils.xml.createElement(e);return n.setAttribute("type",t),n.setAttribute("id",r.utils.idGenerator.genUid()),n}},removeItem_:function(){this.storeConnections_(),this.update_((()=>{this.itemCount_--})),this.restoreConnections_()},update_:function(e){r.Events.setGroup(!0);const t=this,n=t.mutationToDom(),i=n&&r.Xml.domToText(n),s=t.rendered;t.rendered=!1,e&&e.call(this),this.updateShape_(),t.rendered=s,t instanceof r.BlockSvg&&t.initSvg();const o=r.Events.getGroup(),a=t.mutationToDom(),l=a&&r.Xml.domToText(a);i!=l&&(r.Events.fire(new r.Events.BlockChange(t,"mutation",null,i,l)),setTimeout((function(){r.Events.setGroup(o),t.bumpNeighbours(),r.Events.setGroup(!1)}),r.config.bumpDelay)),t.rendered&&t instanceof r.BlockSvg&&t.render(),r.Events.setGroup(!1)},updateShape_:function(){this.itemCount_?(this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(r.Msg.LISTS_CREATE_WITH_INPUT_WITH)):(this.getInput("TITLE")&&this.removeInput("TITLE"),this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(r.Msg.LISTS_CREATE_EMPTY_TITLE));let e=0;for(e=0;e<this.itemCount_;e++)this.getInput("ADD"+e)||this.appendValueInput("ADD"+e);for(;this.getInput("ADD"+e);)this.removeInput("ADD"+e),e++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");const t=this.appendDummyInput("BUTTONS");this.itemCount_>0&&t.appendField(new r.FieldImage(this.REMOVE_IMAGE_DATAURI,24,24,"*",(()=>{this.removeItem_()}),!1)),t.appendField(new r.FieldImage(this.ADD_IMAGE_DATAURI,24,24,"*",(()=>{this.addItem_()}),!1));const n=this.itemCount_<=this.horizontalAfter_;if(this.setInputsInline(n),this.workspace instanceof r.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(n?e.getConstants().SHAPES.ROUND:e.getConstants().SHAPES.SQUARE)}}};r.Blocks.lists_create_with=Object.assign(Object.assign({},s),{init:function(){if(r.Extensions.apply("inline-svgs",this,!1),this.setHelpUrl(r.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.updateShape_(),this.setOutput(!0,"Array"),this.workspace instanceof r.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(e.getConstants().SHAPES.ROUND)}this.setInputsInline(!0),this.setTooltip(r.Msg.LISTS_CREATE_WITH_TOOLTIP)}})},{"../functions/constants":88,blockly:154}],75:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./createList"),n)},{"./createList":74}],76:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DuplicateOnDragConnectionChecker=void 0;const r=e("blockly"),i=e("./duplicateOnDrag"),s=[];s[r.ConnectionType.INPUT_VALUE]=r.ConnectionType.OUTPUT_VALUE,s[r.ConnectionType.OUTPUT_VALUE]=r.ConnectionType.INPUT_VALUE,s[r.ConnectionType.NEXT_STATEMENT]=r.ConnectionType.PREVIOUS_STATEMENT,s[r.ConnectionType.PREVIOUS_STATEMENT]=r.ConnectionType.NEXT_STATEMENT;class o extends r.ConnectionChecker{doDragChecks(e,t,n){if(!super.doDragChecks(e,t,n))return!1;const r=t.targetBlock();return!r||!(0,i.isDuplicateOnDragBlock)(r)}doSafetyChecks(e,t){if(!e||!t)return r.Connection.REASON_TARGET_NULL;let n,i,o,a;return e.isSuperior()?(n=e.getSourceBlock(),i=t.getSourceBlock(),o=e,a=t):(i=e.getSourceBlock(),n=t.getSourceBlock(),a=e,o=t),n===i?r.Connection.REASON_SELF_CONNECTION:a.type!==s[o.type]?r.Connection.REASON_WRONG_TYPE:n.workspace!==i.workspace?r.Connection.REASON_DIFFERENT_WORKSPACES:a.type===r.ConnectionType.OUTPUT_VALUE&&i.previousConnection&&i.previousConnection.isConnected()||a.type===r.ConnectionType.PREVIOUS_STATEMENT&&i.outputConnection&&i.outputConnection.isConnected()?r.Connection.REASON_PREVIOUS_AND_OUTPUT:r.Connection.CAN_CONNECT}}n.DuplicateOnDragConnectionChecker=o},{"./duplicateOnDrag":77,blockly:154}],77:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isDuplicateOnDragBlock=n.DuplicateOnDragBlockDragger=n.DUPLICATE_ON_DRAG_MUTATION_KEY=void 0;const r=e("blockly");n.DUPLICATE_ON_DRAG_MUTATION_KEY="duplicateondrag";class i extends r.BlockDragger{disconnectBlock_(e,t){var i,s,o;let a,l;const c=this.draggingBlock_.mutationToDom&&this.draggingBlock_.mutationToDom();if("true"===(null===(i=null==c?void 0:c.getAttribute(n.DUPLICATE_ON_DRAG_MUTATION_KEY))||void 0===i?void 0:i.toLowerCase())){const e=this.draggingBlock_.outputConnection;if(!(null==e?void 0:e.targetConnection))return;a=r.Xml.domToBlock(r.Xml.blockToDom(this.draggingBlock_,!0),this.workspace_),l=e.targetConnection}super.disconnectBlock_(e,t),a&&l&&(l.connect(a.outputConnection),c.setAttribute(n.DUPLICATE_ON_DRAG_MUTATION_KEY,"false"),null===(o=(s=this.draggingBlock_).domToMutation)||void 0===o||o.call(s,c))}}n.DuplicateOnDragBlockDragger=i,n.isDuplicateOnDragBlock=function(e){var t,r,i;return"true"===(null===(i=null===(r=null===(t=e.mutationToDom)||void 0===t?void 0:t.call(e))||void 0===r?void 0:r.getAttribute(n.DUPLICATE_ON_DRAG_MUTATION_KEY))||void 0===i?void 0:i.toLowerCase())}},{blockly:154}],78:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./duplicateOnDrag"),n),i(e("./variablesGetReporter"),n),i(e("./connectionChecker"),n)},{"./connectionChecker":76,"./duplicateOnDrag":77,"./variablesGetReporter":79}],79:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("./duplicateOnDrag"),s={duplicateOnDrag_:!1,mutationToDom(){const e=r.utils.xml.createElement("mutation");return this.duplicateOnDrag_&&e.setAttribute(i.DUPLICATE_ON_DRAG_MUTATION_KEY,"true"),e},domToMutation(e){e.hasAttribute(i.DUPLICATE_ON_DRAG_MUTATION_KEY)&&(this.duplicateOnDrag_="true"===e.getAttribute(i.DUPLICATE_ON_DRAG_MUTATION_KEY).toLowerCase(),this.pathObject&&this.pathObject.setHasDottedOutllineOnHover(this.duplicateOnDrag_))}};r.Extensions.registerMutator("variables_get_reporter_mutator",s),r.defineBlocksWithJsonArray([{type:"variables_get_reporter",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,colour:"%{BKY_VARIABLES_HUE}",outputShape:(new r.zelos.ConstantProvider).SHAPES.ROUND,helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableReporter"],mutator:"variables_get_reporter_mutator"}])},{"./duplicateOnDrag":77,blockly:154}],80:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./verticalFlyout"),n)},{"./verticalFlyout":81}],81:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VerticalFlyout=void 0;const r=e("blockly");n.VerticalFlyout=class{constructor(e){this.options=e,this.horizontalLayout=!1,this.autoClose=!0,this.cached=[],this.dummyWorkspace=new r.WorkspaceSvg(e)}createDom(e){return this.element||(this.dummyWorkspace.createDom(),this.element=r.utils.dom.createSvgElement(e,{class:"blocklyFlyout"}),this.element.id="multiFlyout",this.element.style.display="none"),this.element}init(e){this.targetWorkspace=e}dispose(){for(const e of this.cached)e.dispose()}getWidth(){return this.activeFlyout?this.activeFlyout.getWidth():0}getHeight(){return this.activeFlyout?this.activeFlyout.getHeight():0}getWorkspace(){return this.activeFlyout?this.activeFlyout.getWorkspace():this.dummyWorkspace}isVisible(){return this.visible}setVisible(e){if(e!==this.visible){this.visible=e,this.element.style.display=e?"block":"none";for(const e of this.cached)e!==this.activeFlyout&&e.isVisible()&&e.setVisible(!1);this.activeFlyout&&this.activeFlyout.setVisible(e)}}setContainerVisible(e){if(this.containerVisible!==e){this.containerVisible=e;for(const t of this.cached)t.setContainerVisible(e)}}hide(){this.activeFlyout&&this.activeFlyout.hide(),this.setVisible(!1)}show(e,t){const n=t||this.hashBlocks(e);this.activeFlyout&&this.activeFlyout.hide();const r=this.cached.find((e=>e.key===n));if(this.element.style.display="block",this.visible=!0,r)return this.activeFlyout=r,this.activeFlyout.autoClose=this.autoClose,this.activeFlyout.setContainerVisible(this.containerVisible),void this.activeFlyout.show(e);this.activeFlyout=new i(this.options),this.cached.push(this.activeFlyout),this.element.appendChild(this.activeFlyout.createDom("g")),this.activeFlyout.init(this.targetWorkspace),this.activeFlyout.key=n,this.activeFlyout.autoClose=this.autoClose,this.activeFlyout.setContainerVisible(this.containerVisible),this.activeFlyout.show(e)}createBlock(e){if(this.activeFlyout)return this.activeFlyout.createBlock(e)}reflow(){this.activeFlyout&&this.activeFlyout.reflow()}isScrollable(){return!this.activeFlyout||this.activeFlyout.isScrollable()}getX(){return this.activeFlyout?this.activeFlyout.getX():0}getY(){return this.activeFlyout?this.activeFlyout.getY():0}position(){this.activeFlyout&&this.activeFlyout.position()}isDragTowardWorkspace(e){return!!this.activeFlyout&&this.activeFlyout.isDragTowardWorkspace(e)}isBlockCreatable(e){return!!this.activeFlyout&&this.activeFlyout.isBlockCreatable(e)}scrollToStart(){this.activeFlyout&&this.activeFlyout.scrollToStart()}blocksToString(e){let t=null;return e.map((e=>e?e.outerHTML?e.outerHTML:(t||(t=new XMLSerializer),t.serializeToString(e)):"\x3c!-- invalid block here! --\x3e")).reduce(((e,t)=>e+t),"")}hashBlocks(e){if(Array.isArray(e))return pxt.Util.codalHash16(this.blocksToString(e))}};class i extends r.VerticalFlyout{constructor(e){super(e),this.options=e,this.buttonListeners=[]}show(e){Array.isArray(e)&&(this.def=e.slice()),super.show(e)}blockIsRecyclable_(e){switch(e.type){case"variables_get":case"variables_set":case"variables_change":return!1}return!0}initFlyoutButton_(e,t,n){const i=r.FlyoutButton.TEXT_MARGIN_X,s=r.FlyoutButton.TEXT_MARGIN_Y;e.isLabel()||(r.FlyoutButton.TEXT_MARGIN_X=17.5,r.FlyoutButton.TEXT_MARGIN_Y=14);const o=e.createDom();if(e.moveTo(t,n),e.show(),this.buttonListeners.push(r.browserEvents.conditionalBind(o,"pointerdown",this,this.onButtonMouseDown)),this.buttons_.push(e),r.FlyoutButton.TEXT_MARGIN_X=i,r.FlyoutButton.TEXT_MARGIN_Y=s,!this.def)return;const a=this.def.find((t=>t.getAttribute("text")===e.getButtonText()));if(this.def.splice(this.def.indexOf(a),1),!a)return;a.hasAttribute("web-class")&&o.classList.add(a.getAttribute("web-class"));const l=a.getAttribute("web-icon"),c=a.getAttribute("web-icon-class"),u=a.getAttribute("web-icon-color");if(l||c){const t=r.utils.dom.createSvgElement("text",{class:c?"blocklyFlyoutLabelIcon "+c:"blocklyFlyoutLabelIcon",x:0,y:0,"text-anchor":"start"},o);l&&(t.textContent=l),u&&t.setAttribute("style","fill: "+u);const n=e.getTargetWorkspace();t.setAttribute("dominant-baseline","central"),t.setAttribute("dy","0"),t.setAttribute("x",(n.RTL?e.width+r.FlyoutButton.TEXT_MARGIN_X:0)+""),t.setAttribute("y",e.height/2+r.FlyoutButton.TEXT_MARGIN_Y+"");const i=r.utils.dom.getTextWidth(t)+2*r.FlyoutButton.TEXT_MARGIN_X;e.width+=i;for(let e=0;e<o.children.length;e++){const n=o.children.item(e);if(n!==t){const e=Number(n.getAttribute("x"));n.setAttribute("x",e+i+"")}}}const d=a.getAttribute("web-line"),p=a.getAttribute("web-line-width");if(d){const t=r.utils.dom.createSvgElement("line",{class:"blocklyFlyoutLine","stroke-dasharray":d,"text-anchor":"middle"},o);t.setAttribute("x1","0"),t.setAttribute("x2",null!=p?p:e.width+""),t.setAttribute("y1",e.height+10+""),t.setAttribute("y2",e.height+10+"")}}onButtonMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}}},{blockly:154}],82:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("../constants"),s={typeName_:"",getTypeName(){return this.typeName_},removeFieldCallback(e){const t=this.getParent();(null==t?void 0:t.removeFieldCallback)&&t.removeFieldCallback(e)}};r.Blocks[i.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"bool"}],extensions:["output_boolean","text_field_color"]}),this.typeName_="boolean"}}),r.Blocks[i.ARGUMENT_EDITOR_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"text"}],extensions:["output_string","text_field_color"]}),this.typeName_="string"}}),r.Blocks[i.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"num"}],extensions:["output_number","text_field_color"]}),this.typeName_="number"}}),r.Blocks[i.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"list"}],extensions:["output_array","text_field_color"]}),this.typeName_="Array"}}),r.Blocks[i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},s),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"arg"}],outputShape:(new r.zelos.ConstantProvider).SHAPES.ROUND,extensions:["text_field_color"]}),this.typeName_="any"},mutationToDom(){const e=r.utils.xml.createElement("mutation");return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_)}})},{"../constants":88,blockly:154}],83:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("../constants"),s=e("../msg"),o=e("../../duplicateOnDrag"),a={typeName_:"",duplicateOnDrag_:!1,getTypeName(){return this.typeName_},mutationToDom(){const e=r.utils.xml.createElement("mutation");return this.duplicateOnDrag_&&e.setAttribute(o.DUPLICATE_ON_DRAG_MUTATION_KEY,"true"),e},domToMutation(e){e.hasAttribute(o.DUPLICATE_ON_DRAG_MUTATION_KEY)&&(this.duplicateOnDrag_="true"===e.getAttribute(o.DUPLICATE_ON_DRAG_MUTATION_KEY).toLowerCase(),this.pathObject&&this.pathObject.setHasDottedOutllineOnHover(this.duplicateOnDrag_))}};r.Blocks[i.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_label_serializable",name:"VALUE",text:""}],colour:r.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_boolean"]}),this.typeName_="boolean"}}),r.Blocks[i.ARGUMENT_REPORTER_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_label_serializable",name:"VALUE",text:""}],colour:r.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_string"]}),this.typeName_="string"}}),r.Blocks[i.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_label_serializable",name:"VALUE",text:""}],colour:r.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_number"]}),this.typeName_="number"}}),r.Blocks[i.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_label_serializable",name:"VALUE",text:""}],colour:r.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_array"]}),this.typeName_="Array"}}),r.Blocks[i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_label_serializable",name:"VALUE",text:""}],colour:r.Msg[s.MsgKey.REPORTERS_HUE],inputsInline:!0,outputShape:(new r.zelos.ConstantProvider).SHAPES.ROUND,output:null}),this.typeName_=""},mutationToDom(){const e=a.mutationToDom.call(this);return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_),a.domToMutation.call(this,e),this.pathObject&&this.pathObject.setHasDottedOutllineOnHover(this.duplicateOnDrag_)}})},{"../../duplicateOnDrag":78,"../constants":88,"../msg":94,blockly:154}],84:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("../commonFunctionMixin"),s=e("../constants"),o=e("../utils"),a=e("../msg"),l=Object.assign(Object.assign({},i.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,n){let i=null,s=null;if(t&&e.id in t){const n=t[e.id];i=n.block,s=n.shadow}const o=null==i?void 0:i.workspace.connectionChecker;r.Events.disable();try{if(i&&!i.isDisposed()&&t&&(null==o?void 0:o.canConnectWithReason(null==i?void 0:i.outputConnection,n.connection,!1))===r.Connection.CAN_CONNECT){let o;i.outputConnection.connect(n.connection),"variables_get"!==(o=i.isShadow()?r.Xml.blockToDom(i):s||this.buildShadowDom_(e.type)).getAttribute("type")&&n.connection.setShadowDom(o),delete t[n.name]}else this.attachShadow_(n,e.type)}finally{r.Events.enable()}},afterWorkspaceLoad:function(){var e;for(const t of this.inputList){if(t.type!==r.inputTypes.VALUE)continue;const n=null===(e=t.connection)||void 0===e?void 0:e.targetBlock();n&&n.isShadow()&&n.getVarModels().length&&n.setShadow(!1);const i=t.connection&&t.getShadowDom();(0,o.isVariableBlockType)(null==i?void 0:i.getAttribute("type"))&&t.setShadowDom(null)}},addFunctionLabel_:function(e){this.appendDummyInput("function_name").appendField(new r.FieldLabel(e,"functionNameText"),"function_name")},updateFunctionLabel_:function(e){this.getField("function_name").setValue(e)},attachShadow_(e,t){const n=(0,o.getShadowBlockInfoFromType_)(t,this.workspace),i=n[0],s=n[1],a=n[2];r.Events.disable();let l=null;try{(l=this.workspace.newBlock(i)).setFieldValue(a,s),l.setShadow("variables_get"!==i),!this.isInsertionMarker()&&l instanceof r.BlockSvg&&(l.initSvg(),l.render())}finally{r.Events.enable()}l&&(l.setShadow(!0),l.outputConnection.connect(e.connection))},buildShadowDom_(e){const t=r.utils.xml.createElement("shadow"),n=(0,o.getShadowBlockInfoFromType_)(e,this.workspace),i=n[0],s=n[1],a=n[2],l="variables_get"===i;t.setAttribute("type",i);const c=r.utils.xml.createElement("field");if(c.textContent=a,l){c.setAttribute("id",a);const e=this.workspace.getVariableById(a);c.textContent=e?e.name:""}return c.setAttribute("name",s),t.appendChild(c),t},onchange(e){var t;if(this.workspace&&!this.workspace.isFlyout)if(e.type==r.Events.BLOCK_CREATE&&-1!=(null===(t=e.ids)||void 0===t?void 0:t.indexOf(this.id))){const t=this.getName(),n=(0,o.getDefinition)(t,this.workspace);if(n){const e=n.getArguments().slice(),t=this.arguments_.slice();JSON.stringify(t)!==JSON.stringify(e)&&(0,o.mutateCallersAndDefinition)(n.getName(),this.workspace,n.mutationToDom()),this.functionId_=n.functionId_}else{r.Events.setGroup(e.group);const t=r.utils.xml.createElement("xml"),n=r.utils.xml.createElement("block");n.setAttribute("type",s.FUNCTION_DEFINITION_BLOCK_TYPE);const i=this.getRelativeToSurfaceXY(),o=i.x+r.config.snapRadius*(this.RTL?-1:1),a=i.y+2*r.config.snapRadius;n.setAttribute("x",o+""),n.setAttribute("y",a+"");const l=this.mutationToDom();n.appendChild(l),t.appendChild(n),r.Xml.domToWorkspace(t,this.workspace),r.Events.setGroup(!1)}}else if(e.type==r.Events.BLOCK_DELETE){const t=this.getName();(0,o.getDefinition)(t,this.workspace)||(r.Events.setGroup(e.group),this.dispose(!0),r.Events.setGroup(!1))}}});r.Blocks[s.FUNCTION_CALL_BLOCK_TYPE]=Object.assign(Object.assign({},l),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(r.Msg[a.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(r.Msg[a.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(r.Msg[a.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}}),r.Blocks[s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE]=Object.assign(Object.assign({},l),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,null),this.setOutputShape((new r.zelos.ConstantProvider).SHAPES.ROUND),this.setColour(r.Msg[a.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(r.Msg[a.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(r.Msg[a.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}})},{"../commonFunctionMixin":87,"../constants":88,"../msg":94,"../utils":96,blockly:154}],85:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.newFunctionMutation=void 0;const r=e("blockly"),i=e("../commonFunctionMixin"),s=e("../constants"),o=e("../utils"),a=e("../fields/fieldAutocapitalizeTextInput"),l=e("../functionManager"),c=e("../msg"),u=Object.assign(Object.assign({},i.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,n){const r=this.createArgumentEditor_(e.type,e.name);n.connection.connect(r.outputConnection)},addFunctionLabel_:function(e){const t=new a.FieldAutocapitalizeTextInput(e||"",void 0,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(t,"function_name")},updateFunctionLabel_:function(e){r.Events.disable(),this.getField("function_name").setValue(e),r.Events.enable()},createArgumentEditor_:function(e,t){let n;r.Events.disable();try{let i="";switch(e){case"boolean":i=s.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE;break;case"number":i=s.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE;break;case"string":i=s.ARGUMENT_EDITOR_STRING_BLOCK_TYPE;break;case"Array":i=s.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE;break;default:i=s.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE}(n=i==s.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE?(0,o.createCustomArgumentEditor)(e,this.workspace):this.workspace.newBlock(i)).setFieldValue(t,"TEXT"),n.setShadow(!0),!this.isInsertionMarker()&&n instanceof r.BlockSvg&&(n.initSvg(),n.render())}finally{r.Events.enable()}return n},focusLastEditor_(){if(this.inputList.length>0){let e=this.inputList[this.inputList.length-2];if(e.type==r.inputTypes.DUMMY){const t=this.workspace;t instanceof r.WorkspaceSvg&&t.centerOnBlock(this.id),e.fieldRow[0].showEditor()}else if(e.type==r.inputTypes.VALUE){const t=e.connection.targetBlock(),n=t.workspace;n instanceof r.WorkspaceSvg&&n.centerOnBlock(t.id),t.getField("TEXT").showEditor()}}},removeFieldCallback(e){let t=null;for(let n=0;n<this.inputList.length&&!t;n++){let r=this.inputList[n];if(r.connection){let n=r.connection.targetBlock();if(!n)continue;n.getField(e.name)===e&&(t=r.name)}else for(let n=0;n<r.fieldRow.length;n++)r.fieldRow[n]==e&&(t=r.name)}t&&(r.WidgetDiv.hide(),this.removeInput(t),this.updateFunctionSignature(),this.updateDisplay_())},addParam_(e,t){r.WidgetDiv.hide();const n=(0,o.findUniqueParamName)(t,this.arguments_.map((e=>e.name)));this.arguments_.push({id:r.utils.idGenerator.genUid(),name:n,type:e}),this.updateDisplay_(),this.focusLastEditor_()},addBooleanExternal(){this.addParam_("boolean",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME])},addStringExternal(){this.addParam_("string",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_STRING_ARG_NAME])},addNumberExternal(){this.addParam_("number",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME])},addArrayExternal(){this.addParam_("Array",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME])},addCustomExternal(e){this.addParam_(e,l.FunctionManager.getInstance().getArgumentNameForType(e))},updateFunctionSignature(){this.arguments_=[];for(let e=1;e<this.inputList.length;e++){const t=this.inputList[e];switch(t.type){case r.inputTypes.STATEMENT:break;case r.inputTypes.DUMMY:this.name_=t.fieldRow[0].getValue()||t.fieldRow[0].getText();break;case r.inputTypes.VALUE:const e=t.connection.targetBlock();this.arguments_.push({id:t.name,name:e.getFieldValue("TEXT"),type:e.getTypeName()});break;default:console.warn("Unexpected input type on a function mutator root: "+t.type)}}}});n.newFunctionMutation=function(e){const t=(0,o.findLegalName)(r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_FUNCTION_NAME],e),n=r.utils.xml.createElement("mutation");return n.setAttribute("name",t),n.setAttribute("functionid",r.utils.idGenerator.genUid()),n},r.Blocks[s.FUNCTION_DECLARATION_BLOCK_TYPE]=Object.assign(Object.assign({},u),{init:function(){this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(r.Msg[c.MsgKey.PROCEDURES_HUE]),this.setStatements_(!0),this.setDeletable(!1),this.setMovable(!1),this.contextMenu=!1,this.setInputsInline(!0)}})},{"../commonFunctionMixin":87,"../constants":88,"../fields/fieldAutocapitalizeTextInput":91,"../functionManager":92,"../msg":94,"../utils":96,blockly:154}],86:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("../commonFunctionMixin"),s=e("../constants"),o=e("../utils"),a=e("../fields/fieldAutocapitalizeTextInput"),l=e("../msg"),c=e("../functionManager"),u=e("../svgs"),d=e("../../duplicateOnDrag"),p=Object.assign(Object.assign({},i.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,n){let r,i=null;(null==t?void 0:t[e.id])&&(i=t[e.id].block),t&&i&&!i.isDisposed()?((r=i).setFieldValue(e.name,"VALUE"),delete t[n.name]):r=this.createArgumentReporter_(e),r.duplicateOnDrag_=!0,n.connection.connect(r.outputConnection)},afterWorkspaceLoad:function(){var e;for(const t of this.inputList){if(t.type!==r.inputTypes.VALUE)continue;const n=null===(e=t.connection)||void 0===e?void 0:e.targetBlock();(null==n?void 0:n.isShadow())&&n.mutationToDom&&n.mutationToDom().getAttribute(d.DUPLICATE_ON_DRAG_MUTATION_KEY)&&n.setShadow(!1);const i=t.connection&&t.getShadowDom();(0,o.isVariableBlockType)(null==i?void 0:i.getAttribute("type"))&&t.setShadowDom(null)}},addFunctionLabel_:function(e){const t=new a.FieldAutocapitalizeTextInput(e||"",o.rename,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(t,"function_name")},updateFunctionLabel_:function(e){r.Events.disable(),this.getField("function_name").setValue(e),r.Events.enable()},createArgumentReporter_:function(e){let t,n="";switch(e.type){case"boolean":n=s.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE;break;case"number":n=s.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE;break;case"string":n=s.ARGUMENT_REPORTER_STRING_BLOCK_TYPE;break;case"Array":n=s.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE;break;default:n=s.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}r.Events.disable();try{(t=n==s.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE?(0,o.createCustomArgumentReporter)(e.type,this.workspace):this.workspace.newBlock(n)).setFieldValue(e.name,"VALUE"),t.setShadow(!0),!this.isInsertionMarker()&&t instanceof r.BlockSvg&&(t.initSvg(),t.render())}finally{r.Events.enable()}return t},customContextMenu:function(e){var t,n;this.isInFlyout||(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly)||(e.push(this.makeEditOption()),e.push(this.makeCallOption()))},makeEditOption:function(){var e,t;return{enabled:!(null===(t=null===(e=this.workspace)||void 0===e?void 0:e.options)||void 0===t?void 0:t.readOnly),text:r.Msg.FUNCTIONS_EDIT_OPTION,callback:()=>{!function(e){if(e.type==s.FUNCTION_CALL_BLOCK_TYPE||e.type==s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){const t=e.workspace;e=(0,o.getDefinition)(e.getName(),t)}r.hideChaff(),r.getSelected()&&r.getSelected().unselect(),c.FunctionManager.getInstance().editFunctionExternal(e.mutationToDom(),(t=>{t&&((0,o.mutateCallersAndDefinition)(e.getName(),e.workspace,t),e.updateDisplay_()),setTimeout((()=>{e.afterWorkspaceLoad&&e.afterWorkspaceLoad()}))}))}(this)}}},makeCallOption:function(){var e,t;const n=this.getName(),i=r.utils.xml.createElement("mutation");i.setAttribute("name",n);const o=r.utils.xml.createElement("block");return o.appendChild(i),o.setAttribute("type",s.FUNCTION_CALL_BLOCK_TYPE),{enabled:this.workspace.remainingCapacity()>0&&!(null===(t=null===(e=this.workspace)||void 0===e?void 0:e.options)||void 0===t?void 0:t.readOnly),text:r.Msg.FUNCTIONS_CREATE_CALL_OPTION.replace("%1",n),callback:r.ContextMenu.callbackFactory(this,o)}}});r.Blocks[s.FUNCTION_DEFINITION_BLOCK_TYPE]=Object.assign(Object.assign({},p),{init:function(){if(this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(r.Msg[l.MsgKey.PROCEDURES_HUE]),this.setTooltip(r.Msg[l.MsgKey.PROCEDURES_DEFNORETURN_TOOLTIP]),this.setHelpUrl(r.Msg[l.MsgKey.PROCEDURES_DEFNORETURN_HELPURL]),this.setStatements_(!0),this.setInputsInline(!0),this.workspace.options.collapse){const e=u.COLLAPSE_IMAGE_DATAURI;this.appendDummyInput("function_collapse").appendField(new r.FieldImage(e,24,24,"",(()=>{this.setCollapsed(!0)}),!1))}}})},{"../../duplicateOnDrag":78,"../commonFunctionMixin":87,"../constants":88,"../fields/fieldAutocapitalizeTextInput":91,"../functionManager":92,"../msg":94,"../svgs":95,"../utils":96,blockly:154}],87:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.COMMON_FUNCTION_MIXIN=void 0;const r=e("blockly"),i=e("./constants"),s=e("./utils"),o=e("./msg");n.COMMON_FUNCTION_MIXIN={name_:"",functionId_:"",arguments_:[],mutationToDom:function(){this.ensureIds_();const e=r.utils.xml.createElement("mutation");return e.setAttribute("name",this.name_),e.setAttribute("functionid",this.functionId_),this.arguments_.forEach((function(t){const n=r.utils.xml.createElement("arg");n.setAttribute("name",t.name),n.setAttribute("id",t.id),n.setAttribute("type",t.type),e.appendChild(n)})),e},domToMutation:function(e){const t=[];for(let n=0;n<e.childNodes.length;++n){const r=e.childNodes[n];"arg"==r.nodeName.toLowerCase()&&t.push({id:r.getAttribute("id"),name:r.getAttribute("name"),type:r.getAttribute("type")})}this.arguments_=t,this.name_=e.getAttribute("name"),this.restoreSavedFunctionId(e.getAttribute("functionid"))},saveExtraState:function(){return{name:this.name_,functionid:this.functionId_,arguments:this.arguments_.slice()}},loadExtraState:function(e){this.arguments_=e.arguments.slice(),this.name_=e.name,this.restoreSavedFunctionId(e.functionid)},restoreSavedFunctionId:function(e){(0,s.idsInUse)(this.workspace).indexOf(e)<0&&(this.functionId_=e),this.ensureIds_();let t=null;this instanceof r.BlockSvg&&(t=this.getHeightWidth()),this.type!==i.FUNCTION_DEFINITION_BLOCK_TYPE||t&&!t.height&&!t.width?this.updateDisplay_():!this.getFieldValue("function_name")&&this.name_&&(this.setFieldValue(this.name_,"function_name"),this.updateDisplay_())},getName:function(){return this.name_},getFunctionId:function(){return this.functionId_},getArguments:function(){return this.arguments_},removeValueInputs_:function(){const e=[];for(let t,n=0;t=this.inputList[n];n++)t.type==r.inputTypes.VALUE?t.dispose():e.push(t);this.inputList=e},disconnectOldBlocks_:function(){let e={};for(let t,n=0;t=this.inputList[n];n++)if("STACK"!==t.name&&t.connection){let n=t.connection.targetBlock(),r={shadow:t.connection.getShadowDom(),block:n};e[t.name]=r,t.connection.setShadowDom(null),t.connection.targetConnection&&t.connection.disconnect()}return e},deleteShadows_:function(e){if(e)for(let t in e){let n=e[t];if(n){const r=n.block;(null==r?void 0:r.isShadow())&&(r.dispose(!1),delete e[t])}}},createAllInputs_:function(e){let t=!1,n=!1,a=!1;if(this.inputList.forEach((function(e){"function_title"==e.name?t=!0:"function_name"==e.name?n=!0:"function_collapse"==e.name&&(a=!0)})),!t){let e="";switch(this.type){case i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case i.FUNCTION_CALL_BLOCK_TYPE:e=r.Msg[o.MsgKey.FUNCTIONS_CALL_TITLE];break;case i.FUNCTION_DEFINITION_BLOCK_TYPE:case i.FUNCTION_DECLARATION_BLOCK_TYPE:e=r.Msg[o.MsgKey.FUNCTIONS_DEFNORETURN_TITLE]}this.appendDummyInput("function_title").appendField(e,"function_title")}n?this.updateFunctionLabel_(this.getName()):this.addFunctionLabel_(this.getName());let l=this;this.arguments_.forEach((function(t){let n=l.appendValueInput(t.id);(0,s.isCustomType)(t.type)?n.setCheck(t.type):n.setCheck(t.type.charAt(0).toUpperCase()+t.type.slice(1)),l.isInsertionMarker()||l.populateArgument_(t,e,n)})),a&&this.moveInputBefore("function_collapse",null),this.hasStatements_&&this.moveInputBefore("STACK",null)},updateDisplay_:function(){let e=this.rendered;this.rendered=!1;let t=this.disconnectOldBlocks_();this.removeValueInputs_(),this.createAllInputs_(t),this.deleteShadows_(t),this.rendered=e,e&&!this.isInsertionMarker()&&this instanceof r.BlockSvg&&(this.initSvg(),this.render())},setStatements_:function(e){this.hasStatements_!==e&&(e?this.appendStatementInput("STACK"):this.removeInput("STACK",!0),this.hasStatements_=e)},ensureIds_:function(){switch(this.type){case i.FUNCTION_DEFINITION_BLOCK_TYPE:this.functionId_&&"null"!=this.functionId_||(this.functionId_=r.utils.idGenerator.genUid());for(let e=0;e<this.arguments_.length;++e)this.arguments_[e].id||(this.arguments_[e].id=r.utils.idGenerator.genUid());break;case i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case i.FUNCTION_CALL_BLOCK_TYPE:const e=(0,s.getDefinition)(this.name_,this.workspace);if(e){this.functionId_=e.getFunctionId();const t=e.getArguments();for(let e=0;e<this.arguments_.length;++e)for(let n=0;n<t.length;++n)if(t[n].name==this.arguments_[e].name){this.arguments_[e].id=t[n].id;break}}}}}},{"./constants":88,"./msg":94,"./utils":96,blockly:154}],88:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE=n.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE=n.ARGUMENT_EDITOR_STRING_BLOCK_TYPE=n.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE=n.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE=n.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE=n.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE=n.ARGUMENT_REPORTER_STRING_BLOCK_TYPE=n.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE=n.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE=n.FUNCTION_CALL_OUTPUT_BLOCK_TYPE=n.FUNCTION_CALL_BLOCK_TYPE=n.FUNCTION_DECLARATION_BLOCK_TYPE=n.FUNCTION_DEFINITION_BLOCK_TYPE=void 0,n.FUNCTION_DEFINITION_BLOCK_TYPE="function_definition",n.FUNCTION_DECLARATION_BLOCK_TYPE="function_declaration",n.FUNCTION_CALL_BLOCK_TYPE="function_call",n.FUNCTION_CALL_OUTPUT_BLOCK_TYPE="function_call_output",n.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE="argument_reporter_boolean",n.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE="argument_reporter_number",n.ARGUMENT_REPORTER_STRING_BLOCK_TYPE="argument_reporter_string",n.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE="argument_reporter_array",n.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE="argument_reporter_custom",n.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE="argument_editor_boolean",n.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE="argument_editor_number",n.ARGUMENT_EDITOR_STRING_BLOCK_TYPE="argument_editor_string",n.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE="argument_editor_array",n.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE="argument_editor_custom"},{}],89:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=e("./utils"),s=e("./msg"),o=e("./svgs"),a=new r.zelos.ConstantProvider;const l={customContextMenu:function(e){var t,n;const o={enabled:!(null===(n=null===(t=this.workspace)||void 0===t?void 0:t.options)||void 0===n?void 0:n.readOnly),text:r.Msg[s.MsgKey.FUNCTIONS_GO_TO_DEFINITION_OPTION],callback:()=>{const e=this.getField("function_name").getText(),t=(0,i.getDefinition)(e,this.workspace);t&&this.workspace instanceof r.WorkspaceSvg&&this.workspace.centerOnBlock(t.id)}};e.push(o)}},c={customContextMenu:function(e){if(this.isCollapsed())return;const t={text:r.Msg.RENAME_VARIABLE,enabled:!this.workspace.options.readOnly,callback:()=>{const e=this.workspace,t=this.getField("VAR").getVariable();r.Variables.renameVariable(e,t)}};if(e.unshift(t),!this.isInFlyout){const t=this.workspace.getVariablesOfType("");for(const n of t){const t={enabled:!this.workspace.options.readOnly,text:n.name,callback:()=>{let e=this.getField("VAR");e||console.log("Tried to get a variable field on the wrong type of block."),e.setValue(n.getId())}};e.unshift(t)}}}};r.Extensions.registerMixin("function_contextmenu_edit",l),r.Extensions.registerMixin("contextMenu_variableReporter",c),r.Extensions.register("output_number",(function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"Number")})),r.Extensions.register("output_string",(function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"String")})),r.Extensions.register("output_boolean",(function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.HEXAGONAL),this.setOutput(!0,"Boolean")})),r.Extensions.register("output_array",(function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"Array")})),r.Extensions.register("text_field_color",(function(){if(this.workspace instanceof r.WorkspaceSvg){const e=this.workspace.getRenderer().getConstants();this.setColour(e.FIELD_BORDER_RECT_COLOUR)}else this.setColour("#fff")})),r.Extensions.register("inline-svgs",(function(){this.ADD_IMAGE_DATAURI=o.ADD_IMAGE_DATAURI,this.REMOVE_IMAGE_DATAURI=o.REMOVE_IMAGE_DATAURI}))},{"./msg":94,"./svgs":95,"./utils":96,blockly:154}],90:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldArgumentEditor=void 0;const r=e("blockly"),i=e("../functionManager");class s extends r.FieldTextInput{constructor(e,t,n){super(e,t,n),this.typeName=n.typeName}showEditor(e){var t;super.showEditor(e);const n=r.WidgetDiv.getDiv();n.className+=" argumentEditorInput";const o=document.createElement("img");if(o.setAttribute("class","argumentEditorRemoveIcon"),o.setAttribute("src",s.REMOVE_ARG_URI),this.removeButtonMouseWrapper_=r.browserEvents.conditionalBind(o,"mousedown",this,this.removeCallback),n.appendChild(o),this.typeName&&(null===(t=this.sourceBlock_)||void 0===t?void 0:t.workspace)){const e=i.FunctionManager.getInstance().getIconForType(this.typeName);if(e){const t=e+" icon argumentEditorTypeIcon",r=document.createElement("i");r.className=t,n.appendChild(r)}}}removeCallback(){var e,t;const n=null===(e=this.sourceBlock_)||void 0===e?void 0:e.getParent();if(!n)return;let i;for(const e of n.inputList)if((null===(t=e.connection)||void 0===t?void 0:t.targetBlock())===this.sourceBlock_){i=e.name;break}i&&(r.WidgetDiv.hide(),n.removeInput(i))}}n.FieldArgumentEditor=s,s.REMOVE_ARG_URI="data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='UTF-8' standalone='no'?%3e%3csvg width='20px' height='20px' viewBox='0 0 20 20' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3c!-- Generator: Sketch 48.1 (47250) - http://www.bohemiancoding.com/sketch --%3e%3ctitle%3edelete-argument v2%3c/title%3e%3cdesc%3eCreated with Sketch.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg id='Page-1' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e%3cg id='delete-argument-v2' stroke='%23FF661A'%3e%3cg id='Group' transform='translate(3.000000, 2.500000)'%3e%3cpath d='M1,3 L13,3 L11.8900496,14.0995037 C11.8389294,14.6107055 11.4087639,15 10.8950124,15 L3.10498756,15 C2.59123611,15 2.16107055,14.6107055 2.10995037,14.0995037 L1,3 Z' id='Rectangle' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M7,11 L7,6' id='Line' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M9.5,11 L9.5,6' id='Line-Copy' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M4.5,11 L4.5,6' id='Line-Copy-2' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3crect id='Rectangle-2' fill='%23FF661A' x='0' y='2.5' width='14' height='1' rx='0.5'%3e%3c/rect%3e%3cpath d='M6,0 L8,0 C8.55228475,-1.01453063e-16 9,0.44771525 9,1 L9,3 L5,3 L5,1 C5,0.44771525 5.44771525,1.01453063e-16 6,0 Z' id='Rectangle-3' stroke-width='1.5'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",r.fieldRegistry.register("field_argument_editor",s),r.Css.register("\n\n.argumentEditorInput {\n    overflow: visible;\n}\n\n.functioneditor i.argumentEditorTypeIcon {\n    position: absolute;\n    width: 24px;\n    height: 24px;\n    top: 40px;\n    left: 50%;\n    margin-left: -12px;\n}\n\n.argumentEditorRemoveIcon {\n    position: absolute;\n    width: 24px;\n    height: 24px;\n    top: -40px;\n    left: 50%;\n    margin-left: -12px;\n    cursor: pointer;\n}\n\n")},{"../functionManager":92,blockly:154}],91:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldAutocapitalizeTextInput=void 0;const r=e("blockly");class i extends r.FieldTextInput{constructor(e,t,n){super(e,t,n),this.disableAutocapitalize=!1}setAutocapitalize(e){this.disableAutocapitalize=!e,this.htmlInput_&&(this.disableAutocapitalize?this.htmlInput_.setAttribute("autocapitalize","none"):this.htmlInput_.removeAttribute("autocapitalize"))}configure_(e){super.configure_(e),void 0!==e.disableAutocapitalize&&(this.disableAutocapitalize=e.disableAutocapitalize)}widgetCreate_(){const e=super.widgetCreate_();return this.disableAutocapitalize&&e.setAttribute("autocapitalize","none"),e}}n.FieldAutocapitalizeTextInput=i,r.fieldRegistry.register("field_autocapitalize_text_input",i)},{blockly:154}],92:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FunctionManager=void 0;const r=e("blockly"),i=e("./msg");class s{constructor(){this.typeIcons={},this.typeArgumentNames={}}static getInstance(){return s.instance}getIconForType(e){return this.typeIcons[e]}setIconForType(e,t){this.typeIcons[t]=e}setArgumentNameForType(e,t){this.typeArgumentNames[e]=t}getArgumentNameForType(e){return this.typeArgumentNames[e]?this.typeArgumentNames[e]:r.Msg[i.MsgKey.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME]}setEditFunctionExternal(e){this._editFunctionExternal=e}editFunctionExternal(e,t){this._editFunctionExternal?this._editFunctionExternal(e,t):console.warn("External function editor must be overriden: Blockly.Functions.editFunctionExternalHandler",e,t)}}n.FunctionManager=s,s.instance=new s},{"./msg":94,blockly:154}],93:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.validateFunctionExternal=n.getAllFunctionDefinitionBlocks=n.getDefinition=n.flyoutCategory=void 0,i(e("./msg"),n),i(e("./extensions"),n),i(e("./fields/fieldArgumentEditor"),n),i(e("./fields/fieldAutocapitalizeTextInput"),n),i(e("./blocks/argumentEditorBlocks"),n),i(e("./blocks/argumentReporterBlocks"),n),i(e("./blocks/functionDeclarationBlock"),n),i(e("./blocks/functionDefinitionBlock"),n),i(e("./blocks/functionCallBlocks"),n),i(e("./functionManager"),n);var s=e("./utils");Object.defineProperty(n,"flyoutCategory",{enumerable:!0,get:function(){return s.flyoutCategory}}),Object.defineProperty(n,"getDefinition",{enumerable:!0,get:function(){return s.getDefinition}}),Object.defineProperty(n,"getAllFunctionDefinitionBlocks",{enumerable:!0,get:function(){return s.getAllFunctionDefinitionBlocks}}),Object.defineProperty(n,"validateFunctionExternal",{enumerable:!0,get:function(){return s.validateFunctionExternal}})},{"./blocks/argumentEditorBlocks":82,"./blocks/argumentReporterBlocks":83,"./blocks/functionCallBlocks":84,"./blocks/functionDeclarationBlock":85,"./blocks/functionDefinitionBlock":86,"./extensions":89,"./fields/fieldArgumentEditor":90,"./fields/fieldAutocapitalizeTextInput":91,"./functionManager":92,"./msg":94,"./utils":96}],94:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MsgKey=void 0;const r=e("blockly");var i,s;function o(e,t){r.Msg[e]||(r.Msg[e]=t)}(s=i=n.MsgKey||(n.MsgKey={})).REPORTERS_HUE="REPORTERS_HUE",s.FUNCTIONS_CALL_TITLE="FUNCTIONS_CALL_TITLE",s.FUNCTIONS_DEFNORETURN_TITLE="FUNCTIONS_DEFNORETURN_TITLE",s.FUNCTIONS_GO_TO_DEFINITION_OPTION="FUNCTIONS_GO_TO_DEFINITION_OPTION",s.FUNCTION_CALL_TOOLTIP="FUNCTION_CALL_TOOLTIP",s.PROCEDURES_HUE="PROCEDURES_HUE",s.PROCEDURES_CALLNORETURN_HELPURL="PROCEDURES_CALLNORETURN_HELPURL",s.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME="FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME",s.FUNCTIONS_DEFAULT_STRING_ARG_NAME="FUNCTIONS_DEFAULT_STRING_ARG_NAME",s.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME="FUNCTIONS_DEFAULT_NUMBER_ARG_NAME",s.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME="FUNCTIONS_DEFAULT_ARRAY_ARG_NAME",s.PROCEDURES_DEFNORETURN_TOOLTIP="PROCEDURES_DEFNORETURN_TOOLTIP",s.PROCEDURES_DEFNORETURN_HELPURL="PROCEDURES_DEFNORETURN_HELPURL",s.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME="FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME",s.FUNCTIONS_DEFAULT_FUNCTION_NAME="FUNCTIONS_DEFAULT_FUNCTION_NAME",s.FUNCTION_CREATE_NEW="FUNCTION_CREATE_NEW",s.FUNCTION_FLYOUT_LABEL="FUNCTION_FLYOUT_LABEL",s.FUNCTIONS_EDIT_OPTION="FUNCTIONS_EDIT_OPTION",s.FUNCTIONS_CREATE_CALL_OPTION="FUNCTIONS_CREATE_CALL_OPTION",o(i.REPORTERS_HUE,"#A80000"),o(i.FUNCTIONS_CALL_TITLE,"call"),o(i.FUNCTIONS_DEFNORETURN_TITLE,"function"),o(i.FUNCTIONS_GO_TO_DEFINITION_OPTION,"Go to Definition"),o(i.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME,"bool"),o(i.FUNCTIONS_DEFAULT_STRING_ARG_NAME,"text"),o(i.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME,"num"),o(i.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME,"array"),o(i.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME,"value"),o(i.FUNCTIONS_DEFAULT_FUNCTION_NAME,"doSomething"),o(i.FUNCTION_CREATE_NEW,"Make a Function"),o(i.FUNCTION_FLYOUT_LABEL,"Your Functions"),o(i.FUNCTIONS_EDIT_OPTION,"Edit Function"),o(i.FUNCTIONS_CREATE_CALL_OPTION,"Create 'call %1'")},{blockly:154}],95:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.REMOVE_IMAGE_DATAURI=n.ADD_IMAGE_DATAURI=n.COLLAPSE_IMAGE_DATAURI=void 0,n.COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",n.ADD_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJhZGQuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjQ4MjEiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NjkiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjEyLjkxNTI1NCIKICAgICBpbmtzY2FwZTpjeT0iMTYuMDY3Nzk2IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0icmVwZWF0IiAvPjxzdHlsZQogICAgIHR5cGU9InRleHQvY3NzIgogICAgIGlkPSJzdHlsZTMiPgoJLnN0MHtmaWxsOiNDRjhCMTc7fQoJLnN0MXtmaWxsOiNGRkZGRkY7fQo8L3N0eWxlPjx0aXRsZQogICAgIGlkPSJ0aXRsZTUiPnJlcGVhdDwvdGl0bGU+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMiCiAgICAgd2lkdGg9IjQuMDUwMDAwMiIKICAgICBoZWlnaHQ9IjEyLjM5NzA1IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSItMTguMTk4NTI2IgogICAgIHJ4PSIwLjgxIgogICAgIHJ5PSIwLjgxIgogICAgIHRyYW5zZm9ybT0ic2NhbGUoMSwtMSkiIC8+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMtMSIKICAgICB3aWR0aD0iNC4wNTAwMDAyIgogICAgIGhlaWdodD0iMTIuMzk3MTE5IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSI1LjgwMTQ0MDciCiAgICAgcng9IjAuODEiCiAgICAgcnk9IjAuODEiCiAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMCwxLDEsMCwwLDApIiAvPjxjaXJjbGUKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6I2ZmZmZmZjtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICBpZD0icGF0aDQxMzYiCiAgICAgY3g9IjEyIgogICAgIGN5PSIxMiIKICAgICByPSIxMC41MDMxOTEiIC8+PC9zdmc+",n.REMOVE_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJyZW1vdmUuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjFhZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NTAiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjAuMDUwODQ3NTIxIgogICAgIGlua3NjYXBlOmN5PSI5Ljk2NjEwMTciCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJyZXBlYXQiIC8+PHN0eWxlCiAgICAgdHlwZT0idGV4dC9jc3MiCiAgICAgaWQ9InN0eWxlMyI+Cgkuc3Qwe2ZpbGw6I0NGOEIxNzt9Cgkuc3Qxe2ZpbGw6I0ZGRkZGRjt9Cjwvc3R5bGU+PHRpdGxlCiAgICAgaWQ9InRpdGxlNSI+cmVwZWF0PC90aXRsZT48cmVjdAogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eTowLjA3ODQzMTM3IgogICAgIGlkPSJyZWN0NDE0My0xIgogICAgIHdpZHRoPSI0LjA1MDAwMDIiCiAgICAgaGVpZ2h0PSIxMi4zOTcxMTkiCiAgICAgeD0iOS45NzUwMDA0IgogICAgIHk9IjUuODAxNDQwNyIKICAgICByeD0iMC44MSIKICAgICByeT0iMC44MSIKICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLDEsMSwwLDAsMCkiIC8+PGNpcmNsZQogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTojZmZmZmZmO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgIGlkPSJwYXRoNDEzNiIKICAgICBjeD0iMTIiCiAgICAgY3k9IjEyIgogICAgIHI9IjEwLjUwMzE5MSIgLz48L3N2Zz4="},{}],96:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isVariableBlockType=n.validateFunctionExternal=n.flyoutCategory=n.getShadowBlockInfoFromType_=n.findUniqueParamName=n.mutateCallersAndDefinition=n.idsInUse=n.findLegalName=n.createCustomArgumentEditor=n.createCustomArgumentReporter=n.isCustomType=n.getAllFunctionDefinitionBlocks=n.getDefinition=n.rename=void 0;const r=e("blockly"),i=e("./constants"),s=e("./functionManager"),o=e("./msg"),a=e("./blocks/functionDeclarationBlock");function l(e,t){for(const n of t.getTopBlocks(!1))if(n.type===i.FUNCTION_DEFINITION_BLOCK_TYPE){const t=n;if(t.getName()===e)return t}return null}function c(e){return e.getTopBlocks(!1).filter((e=>e.type===i.FUNCTION_DEFINITION_BLOCK_TYPE))}function u(e,t,n){const i=r.utils.xml.createElement("block");i.setAttribute("type",e);const s=r.utils.xml.createElement("mutation");return s.setAttribute("typename",t),i.appendChild(s),r.Xml.domToBlock(i,n)}function d(e,t,n){if(null==n?void 0:n.isInFlyout)return e;const r=p(t,n);for(;r[e];)e=h(e);return e}function p(e,t,n){const r={};return e.getAllVariables().forEach((function(e){r[e.name]=!0})),e.getAllBlocks(!1).forEach((function(e){const s=e;s==t||n&&s.getFunctionId&&s.getFunctionId()==n||(s.type==i.FUNCTION_DEFINITION_BLOCK_TYPE?r[s.getName()]=!0:"procedures_defreturn"==e.type||e.type)})),r}function h(e){const t=e.match(/^(.*?)(\d+)$/);return t?e=t[1]+(parseInt(t[2],10)+1):e+="2",e}function f(e,t,n){const s=l(e,t);if(s){const t=function(e,t){const n=[];for(const r of t.getAllBlocks(!1))if(r.type===i.FUNCTION_CALL_BLOCK_TYPE||r.type===i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){const t=r;t.getName()===e&&n.push(t)}return n}(e,s.workspace);t.push(s),r.Events.setGroup(!0),t.forEach((function(e){const t=e.mutationToDom(),o=t&&r.Xml.domToText(t);e.domToMutation(n);const a=e.mutationToDom(),l=a&&r.Xml.domToText(a);if(o!=l)if(r.Events.fire(new r.Events.BlockChange(e,"mutation",null,o,l)),e.id==s.id){const e=m(t,!1),n=m(a,!0);s.getDescendants(!1).forEach((function(t){if(!function(e){return e.type==i.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE||e.type==i.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE||e.type==i.ARGUMENT_REPORTER_STRING_BLOCK_TYPE||e.type==i.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE||e.type==i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}(t))return;let r=t.getFieldValue("VALUE"),s=e[r];n[s]?n[s]!==r&&t.setFieldValue(n[s],"VALUE"):t.dispose(!0)}))}else setTimeout((function(){e.bumpNeighbours()}),r.config.bumpDelay)})),r.Events.setGroup(!1)}else console.warn("Attempted to change function "+e+", but no definition block was found on the workspace")}function m(e,t){const n={};for(let r=0;r<e.childNodes.length;++r){const i=e.childNodes[r],s=t?i.getAttribute("id"):i.getAttribute("name"),o=t?i.getAttribute("name"):i.getAttribute("id");n[s]=o}return n}function _(e,t){return!t||-1==t.indexOf(e)}n.rename=function(e){e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");const t=this.sourceBlock_,n=d(e,t.workspace,t),r=this.getValue();if(!e)return r;if(!n)return e;if(!r)return t.name_=n,n;if(r!=e&&r!=n){t.name_=n;const e=t.mutationToDom();t.name_=r,f(r,t.workspace,e)}return n},n.getDefinition=l,n.getAllFunctionDefinitionBlocks=c,n.isCustomType=function(e){return!("boolean"==e||"string"==e||"number"==e)},n.createCustomArgumentReporter=function(e,t){return u(i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE,e,t)},n.createCustomArgumentEditor=function(e,t){return u(i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE,e,t)},n.findLegalName=d,n.idsInUse=function(e){const t=[];return e.getAllBlocks(!1).forEach((function(e){e.type==i.FUNCTION_DEFINITION_BLOCK_TYPE&&t.push(e.getFunctionId())})),t},n.mutateCallersAndDefinition=f,n.findUniqueParamName=function(e,t){for(;!_(e,t);)e=h(e);return e},n.getShadowBlockInfoFromType_=function(e,t){let n="",i="",o="";switch(e){case"boolean":n="logic_boolean",i="BOOL",o="TRUE";break;case"number":n="math_number",i="NUM",o="1";break;case"string":n="text",i="TEXT",o="abc";break;case"Array":n="variables_get",i="VAR",o=r.Variables.getOrCreateVariablePackage(t,null,"list","").getId();break;default:n="variables_get",i="VAR",o=r.Variables.getOrCreateVariablePackage(t,null,s.FunctionManager.getInstance().getArgumentNameForType(e),"").getId()}return[n,i,o]},n.flyoutCategory=function(e){const t=[],n=document.createElement("button"),l=r.Msg[o.MsgKey.FUNCTION_CREATE_NEW];n.setAttribute("text",l),n.setAttribute("callbackKey","CREATE_FUNCTION"),e.registerButtonCallback("CREATE_FUNCTION",(()=>{!function(e){r.hideChaff(),r.getSelected()&&r.getSelected().unselect(),s.FunctionManager.getInstance().editFunctionExternal((0,a.newFunctionMutation)(e),function(e){return function(t){if(t){const n='<xml><block type="'+i.FUNCTION_DEFINITION_BLOCK_TYPE+'">'+r.Xml.domToText(t)+"</block></xml>",s=r.utils.xml.textToDom(n);r.Events.setGroup(!0);const o=r.Xml.domToBlock(s.firstChild,e);if(o.updateDisplay_(),e.getMetrics){const t=e.getMetrics(),n=o.getHeightWidth();o.moveBy(t.viewLeft+t.viewWidth/2-n.width/2,t.viewTop+t.viewHeight/2-n.height/2),o.scheduleSnapAndBump()}e.centerOnBlock(o.id),r.Events.setGroup(!1),setTimeout((()=>{o.afterWorkspaceLoad&&o.afterWorkspaceLoad()}))}}}(e))}(e)})),t.push(n);for(const n of c(e)){const e=n.getName(),i=n.getArguments(),s=r.utils.xml.createElement("block");s.setAttribute("type","function_call"),s.setAttribute("gap","16");const o=r.utils.xml.createElement("mutation");o.setAttribute("name",e),s.appendChild(o);for(let e=0;e<i.length;e++){const t=r.utils.xml.createElement("arg");t.setAttribute("name",i[e].name),t.setAttribute("type",i[e].type),t.setAttribute("id",i[e].id),o.appendChild(t)}t.push(s)}return t},n.validateFunctionExternal=function(e,t){const n=e.getAttribute("name");if(!n)return r.dialog.alert(r.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;const i={};for(let t=0;t<e.childNodes.length;++t){const n=e.childNodes[t].getAttribute("name");if(!n)return r.dialog.alert(r.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;if(i[n])return r.dialog.alert(r.Msg.FUNCTION_WARNING_DUPLICATE_ARG),!1;i[n]=!0}return i[n]?(r.dialog.alert(r.Msg.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME),!1):!p(t,null,e.getAttribute("functionid"))[n]||(r.dialog.alert(r.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",n)),!1)},n.isVariableBlockType=function(e){switch(e){case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":case"variables_get_reporter":case"variables_get":return!0}return!1}},{"./blocks/functionDeclarationBlock":85,"./constants":88,"./functionManager":92,"./msg":94,blockly:154}],97:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly");r.Extensions.unregister("logic_compare"),r.Extensions.register("logic_compare",(function(){}))},{blockly:154}],98:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i={elseifCount_:0,elseCount_:0,valueConnections_:[],statementConnections_:[],elseStatementConnection_:null,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=r.utils.xml.createElement("mutation");return this.elseifCount_&&e.setAttribute("elseif",this.elseifCount_+""),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){e&&(this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_())},storeConnections_:function(e){e||(e=0),this.valueConnections_=[null],this.statementConnections_=[null],this.elseStatementConnection_=null;for(let t=1;t<=this.elseifCount_;t++)e!=t&&(this.valueConnections_.push(this.getInput("IF"+t).connection.targetConnection),this.statementConnections_.push(this.getInput("DO"+t).connection.targetConnection));this.getInput("ELSE")&&(this.elseStatementConnection_=this.getInput("ELSE").connection.targetConnection)},restoreConnections_:function(){var e,t,n;for(let n=1;n<=this.elseifCount_;n++)null===(e=this.valueConnections_[n])||void 0===e||e.reconnect(this,"IF"+n),null===(t=this.statementConnections_[n])||void 0===t||t.reconnect(this,"DO"+n);this.getInput("ELSE")&&(null===(n=this.elseStatementConnection_)||void 0===n||n.reconnect(this,"ELSE"))},addElse_:function(){this.storeConnections_(),this.update_((()=>{this.elseCount_++})),this.restoreConnections_()},removeElse_:function(){this.storeConnections_(),this.update_((()=>{this.elseCount_--})),this.restoreConnections_()},addElseIf_:function(){this.storeConnections_(),this.update_((()=>{this.elseifCount_++})),this.restoreConnections_()},removeElseIf_:function(e){this.storeConnections_(e),this.update_((()=>{this.elseifCount_--})),this.restoreConnections_()},update_:function(e){r.Events.setGroup(!0);const t=this,n=t.mutationToDom(),i=n&&r.Xml.domToText(n),s=t.rendered;t.rendered=!1,e&&e.call(this),this.updateShape_(),t.rendered=s,t instanceof r.BlockSvg&&t.initSvg();const o=r.Events.getGroup(),a=t.mutationToDom(),l=a&&r.Xml.domToText(a);i!=l&&(r.Events.fire(new r.Events.BlockChange(t,"mutation",null,i,l)),setTimeout((function(){r.Events.setGroup(o),t.bumpNeighbours(),r.Events.setGroup(!1)}),r.config.bumpDelay)),t.rendered&&t instanceof r.BlockSvg&&t.render(),r.Events.setGroup(!1)},updateShape_:function(){this.getInput("ELSE")&&(this.removeInput("ELSE"),this.removeInput("ELSETITLE"),this.removeInput("ELSEBUTTONS"));let e=1;for(;this.getInput("IF"+e);)this.removeInput("IF"+e),this.removeInput("IFTITLE"+e),this.removeInput("IFBUTTONS"+e),this.removeInput("DO"+e),e++;for(let e=1;e<=this.elseifCount_;e++){const n=function(e){return function(){t.removeElseIf_(e)}}(e);this.appendValueInput("IF"+e).setCheck("Boolean").appendField(r.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendDummyInput("IFTITLE"+e).appendField(r.Msg.CONTROLS_IF_MSG_THEN),this.appendDummyInput("IFBUTTONS"+e).appendField(new r.FieldImage(this.REMOVE_IMAGE_DATAURI,24,24,"*",n,!1)).setAlign(r.ALIGN_RIGHT),this.appendStatementInput("DO"+e)}this.elseCount_&&(this.appendDummyInput("ELSETITLE").appendField(r.Msg.CONTROLS_IF_MSG_ELSE),this.appendDummyInput("ELSEBUTTONS").setAlign(r.ALIGN_RIGHT).appendField(new r.FieldImage(this.REMOVE_IMAGE_DATAURI,24,24,"*",this.removeElse_.bind(this),!1)),this.appendStatementInput("ELSE")),this.getInput("ADDBUTTON")&&this.removeInput("ADDBUTTON");const t=this;this.appendDummyInput("ADDBUTTON").appendField(new r.FieldImage(this.ADD_IMAGE_DATAURI,24,24,"*",(function(){0==t.elseCount_?t.addElse_():(t.elseifCount_||(t.elseifCount_=0),t.addElseIf_())}),!1))},rebuildShape_:function(){const e=[null],t=[null];let n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);let r=1;for(;this.getInput("IF"+r);){const n=this.getInput("IF"+r),i=this.getInput("DO"+r);e.push(n.connection.targetConnection),t.push(i.connection.targetConnection),r++}this.updateShape_(),this.reconnectChildBlocks_(e,t,n)},reconnectChildBlocks_:function(e,t,n){var r,i;for(let n=1;n<=this.elseifCount_;n++)null===(r=e[n])||void 0===r||r.reconnect(this,"IF"+n),null===(i=t[n])||void 0===i||i.reconnect(this,"DO"+n);null==n||n.reconnect(this,"ELSE")}};r.Blocks.controls_if=Object.assign(Object.assign({},i),{init(){if(r.Extensions.apply("inline-svgs",this,!1),this.elseifCount_=0,this.elseCount_=0,this.setHelpUrl(r.Msg.CONTROLS_IF_HELPURL),this.appendValueInput("IF0").setCheck("Boolean").appendField(r.Msg.CONTROLS_IF_MSG_IF),this.appendDummyInput("THEN0").appendField(r.Msg.CONTROLS_IF_MSG_THEN),this.appendStatementInput("DO0"),this.workspace instanceof r.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(e.getConstants().SHAPES.HEXAGONAL)}this.updateShape_(),this.setInputsInline(!0),this.setColour(r.Msg.LOGIC_HUE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip((()=>this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?r.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?r.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?r.Msg.CONTROLS_IF_TOOLTIP_4:"":r.Msg.CONTROLS_IF_TOOLTIP_1))}})},{blockly:154}],99:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./extensions"),n),i(e("./ifElse"),n)},{"./extensions":97,"./ifElse":98}],100:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldSlider=void 0;const r=e("blockly");class i extends r.FieldNumber{constructor(e,t,n,r,i,s,o,a){super(e,t,n,r,o,a),"string"==typeof i?this.step_=parseFloat(i):"number"==typeof i&&(this.step_=i),this.labelText_=s}hasMin(){return this.getMin()>-1/0}hasMax(){return this.getMax()<1/0}getStep(){return this.step_}getLabel(){return this.labelText_}setLabel(e){this.labelText_=e}setOptions(e,t,n,r){this.setConstraints(e,t,r),this.step_=parseFloat(n)||void 0}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=`${e}`).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);if(isNaN(t))return null;this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_);let n=String(this.precision_);-1!==n.indexOf("e")&&(n=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=n.indexOf(".");let i;return null!==(i=-1===r?this.precision_?0:null:n.length-r-1)&&(t=Number(t.toFixed(i))),t}showEditor_(e,t){super.showEditor_(e,t),r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent();const n=r.DropDownDiv.getContentDiv();n.setAttribute("role","menu"),n.setAttribute("aria-haspopup","true"),this.addSlider_(n),r.DropDownDiv.setColour("#ffffff","#dddddd"),r.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_)}addSlider_(e){if(this.labelText_){let t=this.createLabelDom_(this.labelText_);e.appendChild(t[0]),this.readout_=t[1],this.setReadout(this.value_)}this.slider_=this.createSlider(),e.appendChild(this.slider_);const t=()=>{pxt.BrowserUtils.isFirefox()||this.htmlInput_.focus()};r.browserEvents.bind(this.slider_,"input",this,(e=>{const n=parseFloat(this.slider_.value)||0;if(null!==n){this.setValue(n);const e=this.htmlInput_;e&&(e.value=n+"",t())}})),r.browserEvents.bind(this.slider_,"focus",this,(e=>{t()}))}setValue(e,t){super.setValue(e,t),this.updateDom(),this.slider_&&(this.slider_.value=this.getValue()+"")}createSlider(){const e=document.createElement("input");let t;return e.type="range",e.min=this.getMin()+"",e.max=this.getMax()+"",e.value=this.getValue()+"",this.sourceBlock_ instanceof r.BlockSvg&&("#ffffff"===this.sourceBlock_.getColour()?this.sourceBlock_.getParent()&&(t=this.sourceBlock_.getParent().getColourTertiary()):t=this.sourceBlock_.getColourTertiary()),t&&e.setAttribute("style",`--blocklyFieldSliderBackgroundColor: ${t}`),Number.isNaN(this.step_)||(e.step=this.step_+""),e}updateDom(){this.setReadout(this.getValue())}setReadout(e){this.readout_&&(this.readout_.innerText=e+"")}createLabelDom_(e){const t=document.createElement("div");t.setAttribute("class","blocklyFieldSliderLabel");const n=document.createElement("span");n.setAttribute("class","blocklyFieldSliderReadout");const r=document.createElement("span");return r.setAttribute("class","blocklyFieldSliderLabelText"),r.innerText=e,t.appendChild(r),t.appendChild(n),[t,n]}}n.FieldSlider=i,r.fieldRegistry.register("field_slider",i),r.Css.register('\n:root {\n    --blocklyFieldSliderBackgroundColor: #547AB2;\n}\n.blocklyFieldSliderLabel {\n    font-family: "Helvetica Neue", "Segoe UI", Helvetica, sans-serif;\n    font-size: 0.65rem;\n    color: $colour_toolboxText;\n    margin: 8px;\n}\n.blocklyFieldSliderLabelText {\n    font-weight: bold;\n}\n.blocklyFieldSliderReadout {\n    margin-left: 10px;\n}\n\ninput[type=range] {\n    -webkit-appearance: none;\n    width: 100%;\n}\ninput[type=range]:focus {\n    outline: none;\n}\ninput[type=range]::-webkit-slider-runnable-track {\n    -webkit-appearance: none;\n    margin: 8px;\n    height: 22px;\n    width: 150px;\n    outline: none;\n    border-radius: 11px;\n    margin-bottom: 20px;\n    background: var(--blocklyFieldSliderBackgroundColor);\n}\ninput[type=range]::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    width: 26px;\n    height: 26px;\n    margin-top: -1px;\n    background-color: white;\n    border-radius: 100%;\n    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    cursor: pointer;\n}\ninput[type=range]::-moz-range-track {\n    margin: 8px;\n    height: 22px;\n    width: 95%;\n    outline: none;\n    border-radius: 11px;\n    margin-bottom: 20px;\n    background: #547AB2;\n}\ninput[type=range]::-moz-range-thumb {\n    width: 26px;\n    height: 26px;\n    margin-top: -1px;\n    background-color: white;\n    border-radius: 100%;\n    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);\n    cursor: pointer;\n}\n')},{blockly:154}],101:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./fieldSlider"),n),i(e("./numberBlocks"),n)},{"./fieldSlider":100,"./numberBlocks":102}],102:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i=new r.zelos.ConstantProvider;r.defineBlocksWithJsonArray([{type:"math_integer",message0:"%1",args0:[{type:"field_number",name:"NUM",precision:1}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_whole_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0,precision:1}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_positive_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_number_minmax",message0:"%1",args0:[{type:"field_slider",name:"SLIDER",value:0,step:1,labelText:"Number"}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",mutator:"math_number_minmax_mutator",extensions:["parent_tooltip_when_inline"]}]);const s={mutationToDom:function(){const e=this.inputList[0].fieldRow[0];let t=r.utils.xml.createElement("mutation");return e.hasMin()&&t.setAttribute("min",e.getMin()+""),e.hasMax()&&t.setAttribute("max",e.getMax()+""),null!=e.getLabel()&&t.setAttribute("label",e.getLabel()),null!=e.getStep()&&t.setAttribute("step",e.getStep()+""),null!=e.getPrecision()&&t.setAttribute("precision",e.getPrecision()+""),t},domToMutation:function(e){const t=this.inputList[0].fieldRow[0],n=e.getAttribute("min"),r=e.getAttribute("max"),i=e.getAttribute("step"),s=e.getAttribute("label"),o=e.getAttribute("precision");t.setLabel(s),t.setOptions(n,r,i,o)}};r.Extensions.registerMutator("math_number_minmax_mutator",s)},{blockly:154}],103:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.showEditorMixin=void 0;const r=e("blockly");n.showEditorMixin=function(e){const t=this.getSourceBlock();if(!t)throw new r.UnattachedFieldError;const n=new r.Menu;n.setRole(r.utils.aria.Role.LISTBOX),this.menu_=n;const s=this.getOptions(!1);let o=null;const a=e=>{r.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)};for(let e=0;e<s.length;e++){const[l,c]=s[e];if("SEPARATOR"===c){const e=new i("");n.addChild(e);continue}const u=(()=>{if("object"==typeof l){const e=new Image(l.width,l.height);return e.src=l.src,e.alt=l.alt||"",e}return l})(),d=new r.MenuItem(u,c);d.setRole(r.utils.aria.Role.OPTION),d.setRightToLeft(t.RTL),d.setCheckable(!0),n.addChild(d),d.setChecked(c===this.value_),d.onAction(a,this),c===this.value_&&(o=d)}e&&"number"==typeof e.clientX?this.menu_.openingCoords=new r.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,r.DropDownDiv.clearContent();const l=this.menu_.render(r.DropDownDiv.getContentDiv());if(r.utils.dom.addClass(l,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){const e=t.getColour(),n=this.sourceBlock_.style.colourTertiary;r.DropDownDiv.setColour(e,n)}r.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),o&&(this.menu_.setHighlighted(o),r.utils.style.scrollIntoContainerView(o.getElement(),r.DropDownDiv.getContentDiv(),!0)),this.applyColour()};class i extends r.MenuItem{createDom(){const e=document.createElement("div");return e.id=r.utils.idGenerator.getNextUniqueId(),this.element_=e,e.className="blockly-menuseparator",e.setAttribute("role","separator"),e}getElement(){return this.element_}getId(){return this.element_.id}}r.Css.register("\n.blockly-menuseparator {\n    border-top: 1px solid rgba(0, 0, 0, 0.2);\n    margin: 4px 0;\n    padding: 0;\n}\n")},{blockly:154}],104:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldVariable=void 0;const r=e("blockly"),i=e("./fieldDropdownMixin");class s extends r.FieldVariable{constructor(e,t,n,r,i){super(e,t,n,r,i),this.menuGenerator_=s.dropdownCreate}static dropdownCreate(){const e=r.FieldVariable.dropdownCreate.call(this),t=e.findIndex((e=>"RENAME_VARIABLE_ID"===e[1]));return e.splice(t,0,[r.Msg.NEW_VARIABLE_DROPDOWN,s.CREATE_VARIABLE_ID],[void 0,"SEPARATOR"]),e}onItemSelected_(e,t){!this.sourceBlock_||this.sourceBlock_.isDeadOrDying()||t.getValue()!==s.CREATE_VARIABLE_ID?super.onItemSelected_(e,t):r.Variables.createVariableButtonHandler(this.sourceBlock_.workspace,(e=>{const t=this.sourceBlock_.workspace.getVariable(e);t&&this.setValue(t.getId())}))}showEditor_(e){i.showEditorMixin.call(this,e)}}n.FieldVariable=s,s.CREATE_VARIABLE_ID="CREATE_VARIABLE",r.fieldRegistry.unregister("field_variable"),r.fieldRegistry.register("field_variable",s)},{"./fieldDropdownMixin":103,blockly:154}],105:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./fieldVariable"),n)},{"./fieldVariable":104}],106:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isCollapsedInputRow=n.CollapsedInputRow=void 0;const r=e("blockly");class i extends r.blockRendering.InputRow{constructor(e){super(e),this.type|=r.blockRendering.Types.INPUT_ROW|r.blockRendering.Types.getType("COLLAPSED_INPUT_ROW")}measure(){this.width=this.minWidth,this.height=this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT}}n.CollapsedInputRow=i,n.isCollapsedInputRow=function(e){return!!(e.type&r.blockRendering.Types.getType("COLLAPSED_INPUT_ROW"))}},{blockly:154}],107:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionPreviewer=void 0;const r=e("blockly");class i extends r.InsertionMarkerPreviewer{previewReplacement(e,t,n){super.previewReplacement(e,t,n),this.connectionLine||(this.connectionLine=r.utils.dom.createSvgElement("line",{class:"blocklyConnectionLine",x1:0,y1:0,x2:0,y2:0},e.sourceBlock_.getSvgRoot()),this.draggedConnectionIndicator=this.createConnectionIndicator(e));const s=i.CONNECTION_INDICATOR_RADIUS,o=e.getOffsetInBlock(),a=r.utils.Coordinate.sum(e.sourceBlock_.getRelativeToSurfaceXY(),o),l=r.utils.Coordinate.sum(t.sourceBlock_.getRelativeToSurfaceXY(),t.getOffsetInBlock()),c=l.x-a.x,u=l.y-a.y,d=Math.atan2(u,c);Math.sqrt(c*c+u*u)<2*s+1?r.utils.dom.addClass(this.connectionLine,"hidden"):(r.utils.dom.removeClass(this.connectionLine,"hidden"),this.connectionLine.setAttribute("x1",String(o.x+Math.cos(d)*s)),this.connectionLine.setAttribute("y1",String(o.y+Math.sin(d)*s)),this.connectionLine.setAttribute("x2",String(o.x+c-Math.cos(d)*s)),this.connectionLine.setAttribute("y2",String(o.y+u-Math.sin(d)*s)))}hidePreview(){super.hidePreview(),this.connectionLine&&(this.connectionLine.remove(),this.connectionLine=null,this.draggedConnectionIndicator.remove(),this.draggedConnectionIndicator=null,this.staticConnection=null)}createConnectionIndicator(e){const t=r.utils.dom.createSvgElement("g",{class:"blocklyInputConnectionIndicator"},e.sourceBlock_.getSvgRoot());r.utils.dom.createSvgElement("circle",{r:i.CONNECTION_INDICATOR_RADIUS},t);const n=e.getOffsetInBlock();return t.setAttribute("transform","translate("+n.x+","+n.y+")"),t}}n.ConnectionPreviewer=i,i.CONNECTION_INDICATOR_RADIUS=9},{blockly:154}],108:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ConstantProvider=void 0;const r=e("blockly");class i extends r.zelos.ConstantProvider{constructor(){super(...arguments),this.FIELD_TEXT_FONTFAMILY='"Monaco", "Menlo", "Ubuntu Mono", "Consolas", "source-code-pro", monospace',this.FIELD_TEXT_FONTWEIGHT="600",this.HIGHLIGHT_GLOW_COLOUR="#FFF200",this.ERROR_HIGHLIGHT_GLOW_COLOR="#FF0000",this.HIGHLIGHT_GLOW_SIZE=1.1,this.ELLIPSES_RADIUS=6,this.ELLIPSES_SPACING=8,this.ellipses=this.makeEllipses()}createDom(e,t,n){super.createDom(e,t,n);const i=r.utils.dom.createSvgElement(r.utils.Svg.DEFS,{},e);this.highlightOutlineFilter=this.createHighlight(i,"blocklyHighlightedGlowFilter",this.HIGHLIGHT_GLOW_COLOUR),this.highlightOutlineFilterId=this.highlightOutlineFilter.id,this.errorOutlineFilter=this.createHighlight(i,"blocklyErrorHighlightedGlowFilter",this.ERROR_HIGHLIGHT_GLOW_COLOR),this.errorOutlineFilterId=this.errorOutlineFilter.id,this.embossFilterOverride=this.createOutline(i,"blocklyBubbleEmbossGlowFilter"),this.embossFilterId=this.embossFilterOverride.id}dispose(){super.dispose(),this.highlightOutlineFilter&&r.utils.dom.removeNode(this.highlightOutlineFilter)}makeEllipses(){const e=this.ELLIPSES_RADIUS,t=this.ELLIPSES_SPACING;let n="";for(let i=0;i<3;i++)n+=r.utils.svgPaths.moveBy(t,0)+r.utils.svgPaths.arc("a","180 1,1",e,r.utils.svgPaths.point(2*e,0));for(let i=0;i<3;i++)n+=r.utils.svgPaths.arc("a","180 1,1",e,r.utils.svgPaths.point(2*-e,0))+r.utils.svgPaths.moveBy(-t,0);return n}getCSS_(e){return super.getCSS_(e).concat([e+" .blocklyConnectionIndicator, "+e+" .blocklyInputConnectionIndicator {","fill: #ff0000;","stroke: #ffff00;","stroke-width: 3px;","}",e+" .blocklyConnectionIndicator {","display: none;","}",e+" .blocklyBlockDragSurface > g > .blocklyDraggable > .blocklyConnectionIndicator {","display: block;","}",e+" .blocklyConnectionLine {","stroke: #ffff00;","stroke-width: 4px;","}",e+" .blocklyConnectionLine.hidden {","display: none;","}",e+" .blocklyFlyoutHeading .blocklyFlyoutLabelText {font-size: 1.5rem;","}"])}createHighlight(e,t,n){const i=r.utils.dom.createSvgElement(r.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e);r.utils.dom.createSvgElement(r.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.HIGHLIGHT_GLOW_SIZE},i);const s=r.utils.dom.createSvgElement(r.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},i);return r.utils.dom.createSvgElement(r.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},s),r.utils.dom.createSvgElement(r.utils.Svg.FEFLOOD,{"flood-color":n,"flood-opacity":1,result:"outColor"},i),r.utils.dom.createSvgElement(r.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},i),i}createOutline(e,t){const n=r.utils.dom.createSvgElement(r.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e);r.utils.dom.createSvgElement(r.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:.92},n);const i=r.utils.dom.createSvgElement(r.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},n);r.utils.dom.createSvgElement(r.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),r.utils.dom.createSvgElement(r.utils.Svg.FEFLOOD,{"flood-color":"#000000","flood-opacity":.5,result:"outColor"},n),r.utils.dom.createSvgElement(r.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n);const s=r.utils.dom.createSvgElement("feMerge",{},n);return r.utils.dom.createSvgElement("feMergeNode",{in:"outBlur"},s),r.utils.dom.createSvgElement("feMergeNode",{in:"outGlow"},s),r.utils.dom.createSvgElement("feMergeNode",{in:"SourceGraphic"},s),n}}n.ConstantProvider=i,i.COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",i.EXPAND_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.654)'%3E%3Cpath d='m1611 832q0-53-37-90l-651-651q-38-38-91-38-54 0-90 38l-651 651q-38 36-38 90 0 53 38 91l74 75q39 37 91 37 53 0 90-37l486-486 486 486q37 37 90 37 52 0 91-37l75-75q37-39 37-91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A"},{blockly:154}],109:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Drawer=void 0;const r=e("blockly"),i=e("./collapsedInputRow");class s extends r.zelos.Drawer{drawCollapsedStack_(e){const t=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.constants_.INSIDE_CORNERS.width,n=this.constants_.STATEMENT_INPUT_PADDING_LEFT+2*this.constants_.INSIDE_CORNERS.width+r.utils.svgPaths.lineOnAxis("h",-this.constants_.INSIDE_CORNERS.width)+this.constants_.INSIDE_CORNERS.pathTop,i=e.height-2*this.constants_.INSIDE_CORNERS.height,s=this.constants_.INSIDE_CORNERS.pathBottom+r.utils.svgPaths.lineOnAxis("h",this.constants_.INSIDE_CORNERS.width),o=this.constants_.ellipses;this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.bottomRight+r.utils.svgPaths.lineOnAxis("H",t)+n+r.utils.svgPaths.lineOnAxis("v",i/2)+o+r.utils.svgPaths.lineOnAxis("v",i/2)+s+r.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.constants_.OUTSIDE_CORNERS.rightHeight)+this.constants_.OUTSIDE_CORNERS.topRight}drawOutline_(){if(this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection)this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_();else{this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):(0,i.isCollapsedInputRow)(t)?this.drawCollapsedStack_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}}drawLeft_(){if(super.drawLeft_(),this.info_.rows.find((function(e){return(0,i.isCollapsedInputRow)(e)}))){let e=this.info_.startY;r.blockRendering.Types.isLeftRoundedCorner(this.info_.topRow.elements[0])&&(e+=this.constants_.OUTSIDE_CORNERS.rightHeight),this.outlinePath_=this.outlinePath_.slice(0,-1),this.outlinePath_+=r.utils.svgPaths.lineOnAxis("V",e)}}}n.Drawer=s},{"./collapsedInputRow":106,blockly:154}],110:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./renderer"),n),i(e("./connectionPreviewer"),n)},{"./connectionPreviewer":107,"./renderer":113}],111:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RenderInfo=void 0;const r=e("blockly"),i=e("./collapsedInputRow");class s extends r.zelos.RenderInfo{measure(){if(this.block_)for(const e of this.block_.inputList)e.init();super.measure()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new r.blockRendering.InputRow(this.constants_);this.inputRows.push(e);const t=this.block_.getIcons();for(let n,i=0;n=t[i];i++){const t=new r.blockRendering.Icon(this.constants_,n);this.isCollapsed&&!n.isShownWhenCollapsed()||e.elements.push(t)}let n;for(let t,i=0;t=this.block_.inputList[i];i++)if(t.isVisible()){this.shouldStartNewRow_(t,n)&&(this.rows.push(e),e=new r.blockRendering.InputRow(this.constants_),this.inputRows.push(e));for(let n,i=0;n=t.fieldRow[i];i++)e.elements.push(new r.blockRendering.Field(this.constants_,n,t));this.addInput_(t,e),n=t}this.isCollapsed&&(this.block_.inputList.find((function(e){return e.type==r.inputTypes.STATEMENT}))?e=this.addCollapsedRow_(e):(e.hasJaggedEdge=!0,e.elements.push(new r.blockRendering.JaggedEdge(this.constants_)))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection;const e=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof r.inputs.StatementInput||this.rows.some((e=>(0,i.isCollapsedInputRow)(e)));this.bottomRow.minHeight=e?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new r.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new r.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new r.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new r.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new r.blockRendering.RoundCorner(this.constants_,"right"))}addCollapsedRow_(e){this.rows.push(e);const t=new i.CollapsedInputRow(this.constants_);return t.hasDummyInput=!0,t}}n.RenderInfo=s},{"./collapsedInputRow":106,blockly:154}],112:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PathObject=void 0;const r=e("blockly"),i="blockly-dotted-outline-on-hover",s="hover";class o extends r.zelos.PathObject{constructor(){super(...arguments),this.connectionPointIndicators=new WeakMap}updateHighlighted(e){if(e){if(!this.svgPathHighlighted){const e=this.constants,t=this.hasError?e.errorOutlineFilterId:e.highlightOutlineFilterId;this.svgPathHighlighted=this.svgPath.cloneNode(!0),this.svgPathHighlighted.setAttribute("fill","none"),this.svgPathHighlighted.setAttribute("filter","url(#"+t+")"),this.svgRoot.appendChild(this.svgPathHighlighted)}}else this.svgPathHighlighted&&(this.svgRoot.removeChild(this.svgPathHighlighted),this.svgPathHighlighted=null)}updateSelected(e){e&&this.svgPath.classList.remove(s),super.updateSelected(e)}addConnectionHighlight(e,t,n,i){if(super.addConnectionHighlight(e,t,n,i),e.type===r.INPUT_VALUE||e.type===r.OUTPUT_VALUE){const t=r.utils.dom.createSvgElement("g",{class:"blocklyInputConnectionIndicator"});r.utils.dom.createSvgElement("circle",{r:o.CONNECTION_INDICATOR_RADIUS},t);const n=e.getOffsetInBlock();t.setAttribute("transform","translate("+n.x+","+n.y+")"),this.connectionPointIndicators.set(e,t),this.svgRoot.appendChild(t)}}removeConnectionHighlight(e){super.removeConnectionHighlight(e),this.connectionPointIndicators.has(e)&&(this.connectionPointIndicators.get(e).remove(),this.connectionPointIndicators.delete(e))}applyColour(e){if(super.applyColour(e),e.isShadow()&&e.getParent()){const t=e.getParent().style.colourTertiary;(function(e){return(.2126*e[0]+.7152*e[1]+.0722*e[2])/255})(r.utils.colour.hexToRgb(t))<.15&&this.svgPath.setAttribute("stroke",r.utils.colour.blend("#ffffff",t,.3))}}setHasDottedOutllineOnHover(e){this.hasDottedOutlineOnHover=e,e?(this.svgPath.classList.add(i),this.mouseOverData||(this.mouseOverData=r.browserEvents.bind(this.svgRoot,"mouseover",this,(()=>{this.svgPath.classList.add(s)})),this.mouseLeaveData=r.browserEvents.bind(this.svgRoot,"mouseleave",this,(()=>{this.svgPath.classList.remove(s)})))):(this.svgPath.classList.remove(i),this.mouseOverData&&(r.browserEvents.unbind(this.mouseOverData),r.browserEvents.unbind(this.mouseLeaveData),this.mouseOverData=void 0,this.mouseLeaveData=void 0),this.svgPath.classList.remove(i))}setHasError(e){this.hasError=e}isHighlighted(){return!!this.svgPathHighlighted}resizeHighlight(){this.svgPathHighlighted&&(this.updateHighlighted(!1),this.updateHighlighted(!0))}}n.PathObject=o,o.CONNECTION_INDICATOR_RADIUS=9,r.Css.register("\n.blockly-dotted-outline-on-hover {\n    transition: stroke .4s;\n}\n.blockly-dotted-outline-on-hover.hover {\n    stroke-dasharray: 2;\n    stroke: white;\n    stroke-width: 2;\n}\n")},{blockly:154}],113:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Renderer=void 0;const r=e("blockly"),i=e("./pathObject"),s=e("./constants"),o=e("./info"),a=e("./drawer");class l extends r.zelos.Renderer{makePathObject(e,t){return new i.PathObject(e,t,this.getConstants())}makeConstants_(){return new s.ConstantProvider}makeRenderInfo_(e){return new o.RenderInfo(this,e)}makeDrawer_(e,t){return new a.Drawer(e,t)}render(e){e.updateBeforeRender&&e.updateBeforeRender(),super.render(e)}}n.Renderer=l,r.blockRendering.register("pxt",l)},{"./constants":108,"./drawer":109,"./info":111,"./pathObject":112,blockly:154}],114:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldString=void 0;const r=e("blockly");class i extends r.FieldTextInput{initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=r.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=r.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(e){super.updateSize_(e);const t=this.value_?this.size_.width:1;let n=this.positionLeft(t+3);this.textElement_.setAttribute("x",n+""),n+=this.positionRight(n+t+3),this.size_.width=t+n}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteLeftX_=e+this.quoteWidth_+2*i.quotePadding,t=this.quoteWidth_+i.quotePadding):(this.quoteLeftX_=0,t=this.quoteWidth_+i.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return this.sourceBlock_.RTL?(this.quoteRightX_=i.quotePadding,t=this.quoteWidth_+i.quotePadding):(this.quoteRightX_=e+i.quotePadding,t=this.quoteWidth_+i.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}}n.FieldString=i,i.quotePadding=0,r.Css.register("\n.field-text-quote {\n    fill: #a31515 !important;\n}\n"),r.fieldRegistry.register("field_string",i)},{blockly:154}],115:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./fieldString"),n),i(e("./text"),n),i(e("./join"),n)},{"./fieldString":114,"./join":116,"./text":117}],116:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly"),i={itemCount_:0,valueConnections_:[],mutationToDom:function(){const e=r.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},storeValueConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreValueConnections_:function(){var e;for(let t=0;t<this.itemCount_;t++)null===(e=this.valueConnections_[t])||void 0===e||e.reconnect(this,"ADD"+t)},addItem_:function(){if(this.storeValueConnections_(),this.update_((()=>{this.itemCount_++})),this.restoreValueConnections_(),this.itemCount_>1){const e=this.getInput("ADD0");if(e&&e.connection.targetConnection){const t=this.getInput("ADD"+(this.itemCount_-1)),n=e.connection.getShadowDom();if(n){const e=r.utils.xml.createElement("shadow"),i=n.getAttribute("type");e.setAttribute("type",i),e&&(e.setAttribute("id",r.utils.idGenerator.genUid()),t.connection.setShadowDom(e))}}}},removeItem_:function(){this.storeValueConnections_(),this.update_((()=>{this.itemCount_--})),this.restoreValueConnections_()},update_:function(e){r.Events.setGroup(!0);const t=this,n=t.mutationToDom(),i=n&&r.Xml.domToText(n),s=t.rendered;t.rendered=!1,e&&e.call(this),this.updateShape_(),t.rendered=s,t instanceof r.BlockSvg&&t.initSvg();const o=r.Events.getGroup(),a=t.mutationToDom(),l=a&&r.Xml.domToText(a);i!=l&&(r.Events.fire(new r.Events.BlockChange(t,"mutation",null,i,l)),setTimeout((function(){r.Events.setGroup(o),t.bumpNeighbours(),r.Events.setGroup(!1)}),r.config.bumpDelay)),t.rendered&&t instanceof r.BlockSvg&&t.render(),r.Events.setGroup(!1)},updateShape_:function(){const e=this;let t;for(this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(r.Msg.TEXT_JOIN_TITLE_CREATEWITH),t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||this.appendValueInput("ADD"+t).setAlign(r.ALIGN_LEFT);for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");const n=this.appendDummyInput("BUTTONS");this.itemCount_>1&&n.appendField(new r.FieldImage(this.REMOVE_IMAGE_DATAURI,24,24,"*",(function(){e.removeItem_()}),!1)),n.appendField(new r.FieldImage(this.ADD_IMAGE_DATAURI,24,24,"*",(function(){e.addItem_()}),!1));const i=this.itemCount_<=4;if(this.setInputsInline(i),this.workspace instanceof r.WorkspaceSvg){const e=this.workspace.getRenderer();this.setOutputShape(i?e.getConstants().SHAPES.ROUND:e.getConstants().SHAPES.SQUARE)}}};r.Extensions.registerMutator("pxt_text_join_mutator",i,(function(){r.Extensions.apply("inline-svgs",this,!1),this.itemCount_=2,this.updateShape_()})),r.defineBlocksWithJsonArray([{type:"text_join",message0:"",output:"String",outputShape:(new r.zelos.ConstantProvider).SHAPES.ROUND,style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"pxt_text_join_mutator"}])},{blockly:154}],117:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("blockly");r.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_string",name:"TEXT",text:""}],output:"String",outputShape:(new r.zelos.ConstantProvider).SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}])},{blockly:154}],118:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.blocksMetrics=n.render=n.renderWorkspace=n.cleanRenderingWorkspace=n.initRenderingWorkspace=void 0;const r=e("blockly"),i=e("./layout"),s=e("./importer");let o,a;function l(){return o||((a=document.createElement("div")).style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="1px",a.style.height="1px",document.body.appendChild(a),o=r.inject(a,{move:{scrollbars:!1},readOnly:!0,sounds:!1,media:pxt.webConfig.commitCdnUrl+"blockly/media/",rtl:pxt.Util.isUserLanguageRtl(),renderer:"pxt"})),(0,s.clearWithoutEvents)(o),o}function c(){o&&o.dispose(),o=void 0}function u(e={emPixels:18,layout:1}){switch(e.splitSvg?1:e.layout||4){case 1:(0,i.verticalAlign)(o,e.emPixels||18);break;case 4:(0,i.flow)(o,{ratio:e.aspectRatio,useViewWidth:e.useViewWidth});break;case 3:o.cleanUp_&&o.cleanUp_()}let t=o.getMetrics();const n=a.querySelectorAll("svg")[0].cloneNode(!0);return(0,i.cleanUpBlocklySvg)(n),pxt.U.toArray(n.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach((e=>e.setAttribute("transform",`translate(${-t.contentLeft}, ${-t.contentTop}) scale(1)`))),n.setAttribute("viewBox",`0 0 ${t.contentWidth} ${t.contentHeight}`),e.emPixels&&(n.style.width=t.contentWidth/e.emPixels+"em",n.style.height=t.contentHeight/e.emPixels+"em"),e.splitSvg?(0,i.splitSvg)(n,o,e.emPixels):n}n.initRenderingWorkspace=l,n.cleanRenderingWorkspace=c,n.renderWorkspace=u,n.render=function(e,t={emPixels:18,layout:1}){l();try{let n=e||'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',i=r.utils.xml.textToDom(n);return(0,s.domToWorkspaceNoEvents)(i,o,{applyHideMetaComment:!0}),u(t)}catch(e){return void pxt.reportException(e)}finally{c()}},n.blocksMetrics=function(e){const t=e.getTopBlocks(!1);if(!t.length)return{width:0,height:0};let n;return t.forEach((e=>{const t=e.getBoundingRectangle();n?(n.l=Math.min(n.l,t.left),n.r=Math.max(n.r,t.right),n.t=Math.min(n.t,t.top),n.b=Math.min(n.b,t.bottom)):n={l:t.left,r:t.right,t:t.top,b:t.bottom}})),{width:n.r-n.l,height:n.b-n.t}}},{"./importer":67,"./layout":69,blockly:154}],119:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.findBlockIdByLine=n.findBlockIdByPosition=void 0,n.findBlockIdByPosition=function(e,t){if(!t)return;let n,r;for(let i=0;i<e.length;++i){let s=e[i];s.startPos<=t.start&&s.endPos>=t.start+t.length&&(!n||r>s.endPos-s.startPos)&&(n=s,r=s.endPos-s.startPos)}return n?n.id:void 0},n.findBlockIdByLine=function(e,t){if(!t)return;let n,r;for(let i=0;i<e.length;++i){let s=e[i];s.startLine<=t.start&&s.endLine>t.start+t.length&&(!n||r>s.endLine-s.startLine)&&(n=s,r=s.endLine-s.startLine)}return n?n.id:void 0}},{}],120:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFunctionsFlyoutCategory=n.mkReturnStatementBlock=n.mkVariableFieldBlock=n.mkFieldBlock=n.mkPredicateBlock=n.createToolboxBlock=n.createFlyoutGap=n.createFlyoutButton=n.createFlyoutGroupLabel=n.createFlyoutHeadingLabel=n.createShadowValue=n.isArrayType=void 0;const r=e("blockly"),i=e("./plugins/functions"),s=e("./plugins/duplicateOnDrag"),o=/^(string|number|boolean)$/,a={string:{field:"TEXT",block:"text",defaultValue:""},number:{field:"NUM",block:"math_number",defaultValue:"0"},boolean:{field:"BOOL",block:"logic_boolean",defaultValue:"false"},Array:{field:"VAR",block:"variables_get",defaultValue:"list"}};function l(e){let t=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e);return t?t[1]?t[1]:t[2]:void 0}function c(e,t,n,r){let i;if(r=r||t.defaultValue,!(n=n||t.shadowBlockId)&&t.range&&(n="math_number_minmax"),i=r&&'"'==r.slice(0,1)?JSON.parse(r):r,"number"==t.type&&"value"==n){const e=document.createElement("field");return e.setAttribute("name",t.definitionName),e.appendChild(document.createTextNode("0")),e}if(t.fieldEditor){if(t.defaultValue){const e=document.createElement("field");return e.setAttribute("name",t.definitionName),e.appendChild(document.createTextNode(t.defaultValue)),e}return}let s=pxt.Util.lookup(e.apis.byQName,t.type),o=6==(null==s?void 0:s.kind),c=s&&!!s.attributes.fixedInstances&&!t.shadowBlockId,d="@combined@"==t.type;if(!n&&(o||c||d)){if(r){const e=document.createElement("field");return e.setAttribute("name",t.definitionName),e.appendChild(document.createTextNode(r)),e}return}const p="variables_get"==n,h="text"==n,f=document.createElement("value");f.setAttribute("name",t.definitionName);const m=l(t.type),_=document.createElement(p||m?"block":"shadow");f.appendChild(_);const g=a[m||t.type];if(_.setAttribute("type",n||(m?"lists_create_with":g&&g.block||t.type)),_.setAttribute("colour","#fff"),m){if(g&&!n){let e;switch(m){case"number":e=["0","1"];break;case"string":e=["a","b","c"];break;case"boolean":e=["FALSE","FALSE","FALSE"]}return u(_,g.block,g.field,e),f}if(n&&i)return u(_,i),f}if(!g||n&&g.block!==n&&"math_number_minmax"!==n){if(i){const r=document.createElement("field");if(r.textContent=i,p)r.setAttribute("name","VAR"),_.appendChild(r);else if(h)r.setAttribute("name","TEXT"),_.appendChild(r);else if(n){const t=e.blocksById[n];if(t&&t.attributes._def&&t.attributes._def.parameters.length){const e=t.attributes._def.parameters[0];r.setAttribute("name",e.name),_.appendChild(r)}}else r.setAttribute("name",t.definitionName),_.appendChild(r)}}else{const e=document.createElement("field");let r,s;switch(_.appendChild(e),n){case"variables_get":r="VAR";break;case"math_number_minmax":r="SLIDER";break;default:r=g.field}e.setAttribute("name",r),s="boolean"==t.type?document.createTextNode((i||g.defaultValue).toUpperCase()):document.createTextNode(i||g.defaultValue),e.appendChild(s)}let y;return t.range&&((y=document.createElement("mutation")).setAttribute("min",t.range.min.toString()),y.setAttribute("max",t.range.max.toString()),y.setAttribute("label",t.actualName.charAt(0).toUpperCase()+t.actualName.slice(1)),t.fieldOptions&&(t.fieldOptions.step&&y.setAttribute("step",t.fieldOptions.step),t.fieldOptions.color&&y.setAttribute("color",t.fieldOptions.color),t.fieldOptions.precision&&y.setAttribute("precision",t.fieldOptions.precision))),t.fieldOptions&&(y||(y=document.createElement("mutation")),y.setAttribute("customfield",JSON.stringify(t.fieldOptions))),y&&_.appendChild(y),f}function u(e,t,n,r){const i=r?r.length:2,s=document.createElement("mutation");s.setAttribute("items",""+i),s.setAttribute("horizontalafter",""+i),e.appendChild(s);for(let s=0;s<i;s++){const i=document.createElement("value");i.setAttribute("name","ADD"+s);const o=document.createElement("shadow");if(o.setAttribute("type",t),n){const e=document.createElement("field");e.setAttribute("name",n),r&&e.appendChild(document.createTextNode(r[s])),o.appendChild(e)}i.appendChild(o),e.appendChild(i)}}function d(e,t,n,r){const i=h(e,pxt.toolbox.convertColor(t),n,r);return i.setAttribute("web-class","blocklyFlyoutHeading"),i}function p(e,t,n,r){const i=h(e,void 0,t);return i.setAttribute("web-class","blocklyFlyoutGroup"),i.setAttribute("web-line","1.5"),n&&i.setAttribute("web-line-width",n),r&&(i.setAttribute("web-help-button","true"),i.setAttribute("callbackKey",r)),i}function h(e,t,n,i){let s=r.utils.xml.createElement("label");return s.setAttribute("text",e),t&&s.setAttribute("web-icon-color",pxt.toolbox.convertColor(t)),n&&(1===n.length?(s.setAttribute("web-icon",n),i&&s.setAttribute("web-icon-class",i)):s.setAttribute("web-icon-class",`blocklyFlyoutIcon${e}`)),s}function f(e,t,n,r){const i=document.createElement(r?"shadow":"block");i.setAttribute("type",pxt.Util.htmlEscape(e));const s=document.createElement("field");return s.setAttribute("name",pxt.Util.htmlEscape(t)),s.textContent=pxt.Util.htmlEscape(n),i.appendChild(s),i}function m(){const e=document.createElement("block");e.setAttribute("type","function_return");const t=document.createElement("value");t.setAttribute("name","RETURN_VALUE"),e.appendChild(t);const n=f("math_number","NUM","0",!0);return t.appendChild(n),e}n.isArrayType=l,n.createShadowValue=c,n.createFlyoutHeadingLabel=d,n.createFlyoutGroupLabel=p,n.createFlyoutButton=function(e,t){let n=r.utils.xml.createElement("button");return n.setAttribute("text",t),n.setAttribute("callbackKey",e),n},n.createFlyoutGap=function(e){const t=r.utils.xml.createElement("sep");return t.setAttribute("gap",e+""),t},n.createToolboxBlock=function e(t,n,r){var i,a;let u,d;if(n.attributes.toolboxParent){const r=t.blocksById[n.attributes.toolboxParent];if(r){const i=pxt.blocks.compileInfo(r);if(u=e(t,r,i),n.attributes.toolboxParentArgument)!(d=u.querySelector(`value[name=${n.attributes.toolboxParentArgument}]`))&&i.parameters.some((e=>e.definitionName===n.attributes.toolboxParentArgument))&&((d=document.createElement("value")).setAttribute("name",n.attributes.toolboxParentArgument),u.appendChild(d));else if(!(d=u.querySelector("value")))for(const e of i.parameters)if(!u.querySelector(`field[name=${e.definitionName}]`)){(d=document.createElement("value")).setAttribute("name",e.definitionName),u.appendChild(d);break}if(d)for(;d.firstChild;)d.removeChild(d.firstChild);else u=void 0}}let p=document.createElement(u?"shadow":"block");if(p.setAttribute("type",n.attributes.blockId),n.attributes.blockGap?p.setAttribute("gap",n.attributes.blockGap):pxt.appTarget.appTheme&&pxt.appTarget.appTheme.defaultBlockGap&&p.setAttribute("gap",pxt.appTarget.appTheme.defaultBlockGap.toString()),r.thisParameter){const e=r.thisParameter,n=!!(null===(i=t.apis.byQName[e.type])||void 0===i?void 0:i.attributes.fixedInstances);let s=e.shadowBlockId,o=e.defaultValue;n||s&&"variables_get"!==s||(s="variables_get",o=o||e.definitionName);const a=c(t,e,s,o);a&&p.appendChild(a)}if("ENUM_GET"===n.attributes.shim||"KIND_GET"===n.attributes.shim){if(null===(a=n.parameters)||void 0===a?void 0:a.length){const e=n.parameters[0].default;if(e){const t=document.createElement("field");t.setAttribute("name","MEMBER"),t.textContent=e,p.appendChild(t)}}}else n.parameters&&(r.parameters.filter((e=>o.test(e.type)||o.test(l(e.type))||e.shadowBlockId||e.defaultValue)).forEach((e=>{const n=c(t,e);n&&p.appendChild(n)})),n.attributes.draggableParameters?r.handlerArgs.forEach((e=>{const t="reporter"===n.attributes.draggableParameters,r=document.createElement("value");r.setAttribute("name","HANDLER_DRAG_PARAM_"+e.name);const i=t?pxt.blocks.reporterTypeForArgType(e.type):"variables_get_reporter",o=document.createElement("block");o.setAttribute("type",i);const a=document.createElement("mutation");o.appendChild(a),a.setAttribute(s.DUPLICATE_ON_DRAG_MUTATION_KEY,"true"),t&&"argument_reporter_custom"===i&&a.setAttribute("typename",e.type);const l=document.createElement("field");l.setAttribute("name",t?"VALUE":"VAR"),l.textContent=pxt.Util.htmlEscape(e.name),o.appendChild(l),r.appendChild(o),p.appendChild(r)})):r.handlerArgs.forEach((e=>{const t=document.createElement("field");t.setAttribute("name","HANDLER_"+e.name),t.textContent=e.name,p.appendChild(t)})));return u?(d.appendChild(p),u):p},n.mkPredicateBlock=function(e){const t=document.createElement("block");t.setAttribute("type",e);const n=document.createElement("value");n.setAttribute("name","PREDICATE"),t.appendChild(n);const r=f("logic_boolean","BOOL","TRUE",!0);return n.appendChild(r),t},n.mkFieldBlock=f,n.mkVariableFieldBlock=function(e,t,n,r,i){const s=document.createElement(i?"shadow":"block");s.setAttribute("type",pxt.Util.htmlEscape(e));const o=document.createElement("field");return o.setAttribute("name","VAR"),o.id=t,o.setAttribute("variabletype",pxt.Util.htmlEscape(n)),o.textContent=pxt.Util.htmlEscape(r),s.appendChild(o),s},n.mkReturnStatementBlock=m,n.createFunctionsFlyoutCategory=function(e){const t=(0,i.flyoutCategory)(e);if(t.length>1){let e=m();t.splice(1,0,p(lf("Your Functions"))),t.splice(1,0,e)}const n=(0,i.getAllFunctionDefinitionBlocks)(e).filter((e=>e.getDescendants(!1).some((e=>"function_return"===e.type&&e.getInputTargetBlock("RETURN_VALUE"))))).map((e=>e.getField("function_name").getText())),r=d(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions");t.unshift(r);const s=[];for(const e of t)if(s.push(e),"function_call"===e.getAttribute("type")){const t=e.children.item(0);if(t){const r=t.getAttribute("name");if(n.some((e=>e===r))){const t=e.cloneNode(!0);t.setAttribute("type","function_call_output"),s.push(t)}}}return s}},{"./plugins/duplicateOnDrag":78,"./plugins/functions":93,blockly:154}],121:[function(e,t,n){function r(e,t,n,r){return pxt.Util.toArray(e.getElementsByTagName(t)).filter((e=>e.getAttribute(n)===r))}Object.defineProperty(n,"__esModule",{value:!0}),n.cleanOuterHTML=n.getDirectChildren=n.getFirstChildWithAttr=n.getChildrenWithAttr=n.getBlocksWithType=void 0,n.getBlocksWithType=function(e,t){return r(e,"block","type",t).concat(r(e,"shadow","type",t))},n.getChildrenWithAttr=r,n.getFirstChildWithAttr=function(e,t,n,i){const s=r(e,t,n,i);return s.length?s[0]:void 0},n.getDirectChildren=function(e,t){const n=[];for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes.item(r);i.tagName===t&&n.push(i)}return n},n.cleanOuterHTML=function(e){return e.outerHTML.replace(/^<\?[^>]*>/,"")}},{}],122:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getNestedChildBlocks=void 0,n.getNestedChildBlocks=function(e){return e.getDescendants(!0).filter((t=>t.isEnabled()&&t.getSurroundParent()===e))}},{}],123:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./runValidatorPlan"),n),i(e("./validateBlocksExist"),n),i(e("./validateBlocksInSetExist"),n),i(e("./validateCommentsExist"),n),i(e("./validateSpecificBlockCommentsExist"),n)},{"./runValidatorPlan":124,"./validateBlocksExist":126,"./validateBlocksInSetExist":127,"./validateCommentsExist":128,"./validateSpecificBlockCommentsExist":129}],124:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.runValidatorPlan=void 0;const r=e("./validateBlockFieldValueExists"),i=e("./validateBlocksExist"),s=e("./validateBlocksInSetExist"),o=e("./validateCommentsExist"),a=e("./validateSpecificBlockCommentsExist"),l=e("./getNestedChildBlocks");function c(e,t){const n=t.blockCounts.reduce(((e,t)=>(e[t.blockId]=t.count,e)),{}),r=(0,i.validateBlocksExist)({usedBlocks:e,requiredBlockCounts:n});let s=[];if(r.passed)for(const e of t.blockCounts){const t=e.blockId;s.push(...r.successfulBlocks[t])}return[s,r.passed]}function u(e,t){return(0,o.validateBlockCommentsExist)({usedBlocks:e,numRequired:t.count}).passed}function d(e,t){return(0,a.validateSpecificBlockCommentsExist)({usedBlocks:e,blockType:t.blockType}).passed}function p(e,t){const n=(0,s.validateBlocksInSetExist)({usedBlocks:e,blockIdsToCheck:t.blocks,count:t.count});return[n.successfulBlocks,n.passed]}function h(e,t){const n=(0,r.validateBlockFieldValueExists)({usedBlocks:e,fieldType:t.fieldType,fieldValue:t.fieldValue,specifiedBlock:t.blockType});return[n.successfulBlocks,n.passed]}n.runValidatorPlan=function e(t,n,r){const i=Date.now();let s=0,o=[];for(const i of n.checks){let n=!1;switch(i.validator){case"blocksExist":[o,n]=[...c(t,i)];break;case"blockCommentsExist":n=u(t,i);break;case"specificBlockCommentsExist":n=d(t,i);break;case"blocksInSetExist":[o,n]=[...p(t,i)];break;case"blockFieldValueExists":[o,n]=[...h(t,i)];break;default:pxt.debug(`Unrecognized validator: ${i.validator}`),n=!1}if(n&&i.childValidatorPlans)for(const t of i.childValidatorPlans){let i=0;for(const n of o)i+=e((0,l.getNestedChildBlocks)(n),r.find((e=>e.name===t)),r)?1:0;n=n&&i>0}s+=n?1:0}const a=s>=n.threshold;return pxt.tickEvent("validation.evaluation_complete",{plan:n.name,durationMs:Date.now()-i,passed:`${a}`}),a}},{"./getNestedChildBlocks":122,"./validateBlockFieldValueExists":125,"./validateBlocksExist":126,"./validateBlocksInSetExist":127,"./validateCommentsExist":128,"./validateSpecificBlockCommentsExist":129}],125:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlockFieldValueExists=void 0,n.validateBlockFieldValueExists=function({usedBlocks:e,fieldType:t,fieldValue:n,specifiedBlock:r}){const i=e.filter((e=>e.isEnabled()&&e.type===r)).filter((e=>{var r;return"VAR"===t?(null===(r=e.getVarModels())||void 0===r?void 0:r[0].name)===n:e.getFieldValue(t)===n}));return{successfulBlocks:i,passed:i.length>0}}},{}],126:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlocksExist=void 0,n.validateBlocksExist=function({usedBlocks:e,requiredBlockCounts:t}){let n=[],r=[],i=[],s={};const o=null==e?void 0:e.reduce(((e,t)=>(e[t.type]=(e[t.type]||0)+(t.isEnabled()?1:0),e)),{});for(const[a,l]of Object.entries(t||{})){const t=o[a],c=e.filter((e=>e.isEnabled()&&e.type===a));c.length>0&&(s[a]=c),void 0===t?n.push(a):t?t<l&&i.push(a):r.push(a)}return{missingBlocks:n,disabledBlocks:r,insufficientBlocks:i,successfulBlocks:s,passed:0===n.length&&0===r.length&&0===i.length}}},{}],127:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlocksInSetExist=void 0,n.validateBlocksInSetExist=function({usedBlocks:e,blockIdsToCheck:t,count:n,requireUnique:r}){const i=[],s=e.filter((e=>e.isEnabled()));for(const e of t){const t=s.filter((t=>t.type===e));r&&t.length>=1?i.push(t[0]):i.push(...t)}return{successfulBlocks:i,passed:i.length>=n}}},{}],128:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBlockCommentsExist=void 0,n.validateBlockCommentsExist=function({usedBlocks:e,numRequired:t}){const n=e.filter((e=>!!e.getCommentText()));return{commentedBlocks:n,passed:n.length>=t}}},{}],129:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSpecificBlockCommentsExist=void 0,n.validateSpecificBlockCommentsExist=function({usedBlocks:e,blockType:t}){const n=e.filter((e=>e.type===t)),r=n.filter((e=>!e.getCommentText()));return{uncommentedBlocks:r,passed:0!==n.length&&0===r.length}}},{}],130:[function(e,t,n){let r;Object.defineProperty(n,"__esModule",{value:!0}),n.isBlocks=n.initEditorExtensionsAsync=n.HELP_IMAGE_URI=void 0,n.HELP_IMAGE_URI="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCAyNiAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTMiIGN5PSIxMyIgcj0iMTMiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNy45NTIgOS4xODQwMkMxNy45NTIgMTAuMjU2IDE3LjgxNiAxMS4wNzIgMTcuNTQ0IDExLjYzMkMxNy4yODggMTIuMTkyIDE2Ljc1MiAxMi43OTIgMTUuOTM2IDEzLjQzMkMxNS4xMiAxNC4wNzIgMTQuNTc2IDE0LjU4NCAxNC4zMDQgMTQuOTY4QzE0LjA0OCAxNS4zMzYgMTMuOTIgMTUuNzM2IDEzLjkyIDE2LjE2OFYxNi45NkgxMS44MDhDMTEuNDI0IDE2LjQ2NCAxMS4yMzIgMTUuODQgMTEuMjMyIDE1LjA4OEMxMS4yMzIgMTQuNjg4IDExLjM4NCAxNC4yODggMTEuNjg4IDEzLjg4OEMxMS45OTIgMTMuNDg4IDEyLjUzNiAxMi45NjggMTMuMzIgMTIuMzI4QzE0LjEwNCAxMS42NzIgMTQuNjI0IDExLjE2OCAxNC44OCAxMC44MTZDMTUuMTM2IDEwLjQ0OCAxNS4yNjQgOS45NjgwMiAxNS4yNjQgOS4zNzYwMkMxNS4yNjQgOC4yMDgwMiAxNC40MTYgNy42MjQwMiAxMi43MiA3LjYyNDAyQzExLjc2IDcuNjI0MDIgMTAuNzUyIDcuNzM2MDIgOS42OTYgNy45NjAwMkw5LjE0NCA4LjA4MDAyTDkgNi4wODgwMkMxMC40ODggNS41NjAwMiAxMS44NCA1LjI5NjAyIDEzLjA1NiA1LjI5NjAyQzE0LjczNiA1LjI5NjAyIDE1Ljk2OCA1LjYwODAyIDE2Ljc1MiA2LjIzMjAyQzE3LjU1MiA2Ljg0MDAyIDE3Ljk1MiA3LjgyNDAyIDE3Ljk1MiA5LjE4NDAyWk0xMS40IDIyVjE4LjY0SDE0LjE4NFYyMkgxMS40WiIgZmlsbD0iIzU5NUU3NCIvPgo8L3N2Zz4K",n.initEditorExtensionsAsync=function(){if(!r&&(r=Promise.resolve(),pxt.appTarget&&pxt.appTarget.appTheme&&pxt.appTarget.appTheme.extendFieldEditors)){const e={};r=r.then((()=>pxt.BrowserUtils.loadBlocklyAsync())).then((()=>pxt.BrowserUtils.loadScriptAsync("fieldeditors.js"))).then((()=>pxt.editor.initFieldExtensionsAsync(e))).then((e=>{e.fieldEditors&&e.fieldEditors.forEach((e=>{pxt.blocks.registerFieldEditor(e.selector,e.editor,e.validator)}))}))}return r},n.isBlocks=function(e){return pxt.U.endsWith(e.name,".blocks")}},{}],131:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.postHostMessageAsync=n.shouldPostHostMessages=n.enableControllerAnalytics=n.bindEditorMessages=void 0;const r=e("./code-validation/runValidatorPlan"),i=e("../pxtservices/iframeEmbeddedClient"),s={};let o;function a(e,t,n,r){if(e.response){const i={type:e.type,id:e.id,resp:t,success:n,error:r};o?o.postMessage(i):window.parent.postMessage(i,"*")}}function l(e){return new Promise(((t,n)=>{const r=pxt.Util.clone(e);r.id=ts.pxtc.Util.guidGen(),e.response&&(s[r.id]={resolve:t,reject:n}),o?o.postMessage(r):window.parent.postMessage(r,"*"),e.response||t(void 0)}))}n.bindEditorMessages=function(e){const t=(pxt.appTarget.appTheme.allowParentController||pxt.shell.isControllerMode())&&pxt.BrowserUtils.isIFrame(),n=pxt.appTarget.appTheme.allowPackageExtensions,l=pxt.appTarget.appTheme.allowSimulatorTelemetry;(t||n||l)&&(o=new i.IFrameEmbeddedClient((i=>{const o=i.data;if(!o||!/^pxt(host|editor|pkgext|sim)$/.test(o.type))return!1;if("pxtpkgext"===o.type&&n)e().then((e=>{e.handleExtensionRequest(o)}));else if("pxtsim"===o.type&&l){const e=o;"event"===e.action&&(e.category||e.message?pxt.reportError(e.category,e.message,e.data):pxt.tickEvent(e.tick,e.data))}else if(t){let t,n=Promise.resolve();if("pxthost"==o.type){const e=s[o.id];e?n=n.then((()=>e.resolve(o))):pxt.debug(`pxthost: unknown request ${o.id}`)}else"pxteditor"==o.type&&(n=n.then((()=>e().then((e=>{const n=o;switch(pxt.debug(`pxteditor: ${n.action}`),n.action.toLowerCase()){case"switchjavascript":return Promise.resolve().then((()=>e.openJavaScript()));case"switchpython":return Promise.resolve().then((()=>e.openPython()));case"switchblocks":return Promise.resolve().then((()=>e.openBlocks()));case"startsimulator":return Promise.resolve().then((()=>e.startSimulator()));case"restartsimulator":return Promise.resolve().then((()=>e.restartSimulator()));case"hidesimulator":return Promise.resolve().then((()=>e.collapseSimulator()));case"showsimulator":return Promise.resolve().then((()=>e.expandSimulator()));case"closeflyout":return Promise.resolve().then((()=>e.closeFlyout()));case"unloadproject":return Promise.resolve().then((()=>e.unloadProjectAsync()));case"saveproject":return e.saveProjectAsync();case"redo":return Promise.resolve().then((()=>{const t=e.editor;t&&t.hasRedo()&&t.redo()}));case"undo":return Promise.resolve().then((()=>{const t=e.editor;t&&t.hasUndo()&&t.undo()}));case"setscale":{const t=o;return Promise.resolve().then((()=>e.editor.setScale(t.scale)))}case"stopsimulator":{const t=o;return Promise.resolve().then((()=>e.stopSimulator(t.unload)))}case"newproject":{const t=o;return Promise.resolve().then((()=>e.newProject(t.options)))}case"importproject":{const t=o;return Promise.resolve().then((()=>e.importProjectAsync(t.project,{filters:t.filters,searchBar:t.searchBar})))}case"openheader":{const t=o;return e.openProjectByHeaderIdAsync(t.headerId)}case"startactivity":{const t=o;let n,r=t.path;return/^([jt]s|py|blocks?):/i.test(r)&&(n=/^py:/i.test(r)?pxt.PYTHON_PROJECT_NAME:/^[jt]s:/i.test(r)?pxt.JAVASCRIPT_PROJECT_NAME:pxt.BLOCKS_PROJECT_NAME,r=r.substr(r.indexOf(":")+1)),Promise.resolve().then((()=>e.startActivity({activity:t.activityType,path:r,title:t.title,editor:n,previousProjectHeaderId:t.previousProjectHeaderId,carryoverPreviousCode:t.carryoverPreviousCode})))}case"importtutorial":{const t=o;return Promise.resolve().then((()=>e.importTutorialAsync(t.markdown)))}case"proxytosim":{const t=o;return Promise.resolve().then((()=>e.proxySimulatorMessage(t.content)))}case"renderblocks":{const n=o;return Promise.resolve().then((()=>e.renderBlocksAsync(n))).then((e=>e.xml.then((e=>{t=e.xml}))))}case"renderxml":{const n=o;return Promise.resolve().then((()=>e.renderXml(n).resultXml.then((e=>{t=e.xml}))))}case"renderbyblockid":{const n=o;return Promise.resolve().then((()=>e.renderByBlockIdAsync(n))).then((e=>e.resultXml.then((e=>{t=e.xml}))))}case"runeval":{const n=o,i=n.validatorPlan,s=n.planLib;return Promise.resolve().then((()=>{const t=e.getBlocks();return(0,r.runValidatorPlan)(t,i,s)})).then((e=>{t={result:e}}))}case"gettoolboxcategories":{const n=o;return Promise.resolve().then((()=>{t=e.getToolboxCategories(n.advanced)}))}case"renderpython":{const n=o;return Promise.resolve().then((()=>e.renderPythonAsync(n))).then((e=>{t=e.python}))}case"toggletrace":{const t=o;return Promise.resolve().then((()=>e.toggleTrace(t.intervalSpeed)))}case"settracestate":{const t=o;return Promise.resolve().then((()=>e.setTrace(t.enabled,t.intervalSpeed)))}case"setsimulatorfullscreen":{const t=o;return Promise.resolve().then((()=>e.setSimulatorFullScreen(t.enabled)))}case"togglehighcontrast":return Promise.resolve().then((()=>e.toggleHighContrast()));case"sethighcontrast":{const t=o;return Promise.resolve().then((()=>e.setHighContrast(t.on)))}case"togglegreenscreen":return Promise.resolve().then((()=>e.toggleGreenScreen()));case"print":return Promise.resolve().then((()=>e.printCode()));case"pair":return e.pairAsync().then((()=>{}));case"info":return Promise.resolve().then((()=>{t={versions:pxt.appTarget.versions,locale:ts.pxtc.Util.userLanguage(),availableLocales:pxt.appTarget.appTheme.availableLocales}}));case"shareproject":{const n=o;return e.anonymousPublishHeaderByIdAsync(n.headerId,n.projectName).then((e=>{t=e}))}case"savelocalprojectstocloud":{const n=o;return e.saveLocalProjectsToCloudAsync(n.headerIds).then((e=>{t={headerIdMap:e}}))}case"requestprojectcloudstatus":{const t=o;return e.requestProjectCloudStatus(t.headerIds)}case"convertcloudprojectstolocal":{const t=o;return e.convertCloudProjectsToLocal(t.userId)}case"setlanguagerestriction":{const t=o;if("no-blocks"===t.restriction)throw console.warn("no-blocks language restriction is not supported"),new Error("no-blocks language restriction is not supported");return e.setLanguageRestrictionAsync(t.restriction)}}return Promise.resolve()})))));n.then((()=>a(o,t,!0,void 0)),(e=>a(o,t,!1,e)))}return!0})))},n.enableControllerAnalytics=function(){if(!pxt.appTarget.appTheme.allowParentController||!pxt.BrowserUtils.isIFrame())return;const e=pxt.tickEvent;pxt.tickEvent=function(t,n){e&&e(t,n),l({type:"pxthost",action:"event",tick:t,response:!1,data:n})};const t=pxt.reportException;pxt.reportException=function(e,n){t&&t(e,n);try{l({type:"pxthost",action:"event",tick:"error",message:e.message,response:!1,data:n})}catch(e){}};const n=pxt.reportError;pxt.reportError=function(e,t,r){n&&n(e,t,r),l({type:"pxthost",action:"event",tick:"error",category:e,message:t,data:r})}},n.shouldPostHostMessages=function(){return pxt.appTarget.appTheme.allowParentController&&pxt.BrowserUtils.isIFrame()},n.postHostMessageAsync=l},{"../pxtservices/iframeEmbeddedClient":146,"./code-validation/runValidatorPlan":124}],132:[function(e,t,n){function r(e){return`experiments-${"object"==typeof e?e.id:e}`}function i(){const e=pxt.savedAppTheme(),t={},n=s();return n.forEach((n=>{const r=o(n);e[n.id]=!!r,r&&(t[n.id]=r?1:0)})),n.length&&Object.keys(t).length&&(pxt.tickEvent("experiments.loaded",t),pxt.reloadAppTargetVariant()),pxt.appTarget.appTheme}function s(){const e=pxt.appTarget.appTheme.experiments;return e?[{id:"print",name:lf("Print Code"),description:lf("Print the code from the current project"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4740"},{id:"greenScreen",name:lf("Green screen"),description:lf("Display a webcam video stream or a green background behind the code."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4738"},{id:"allowPackageExtensions",name:lf("Editor Extensions"),description:lf("Allow Extensions to add buttons in the editor."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4741"},{id:"instructions",name:lf("Wiring Instructions"),description:lf("Generate step-by-step assembly instructions for breadboard wiring."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4739"},{id:"debugger",name:lf("Debugger"),description:lf("Step through code and inspect variables in the debugger"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4729"},{id:"bluetoothUartConsole",name:"Bluetooth Console",description:lf("Receives UART message through Web Bluetooth"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4796"},{id:"bluetoothPartialFlashing",name:"Bluetooth Download",description:lf("Download code via Web Bluetooth"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4807"},{id:"simScreenshot",name:lf("Simulator Screenshots"),description:lf("Download screenshots of the simulator"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5232"},{id:"python",name:lf("Static Python"),description:lf("Use Static Python to code your device"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5390"},{id:"simGif",name:lf("Simulator Gifs"),description:lf("Download gifs of the simulator"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5297"},{id:"qrCode",name:lf("Shared QR Code"),description:lf("Generate a QR Code form the shared project url"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5456"},{id:"importExtensionFiles",name:lf("Import Extension Files"),description:lf("Import Extensions from compiled project files")},{id:"debugExtensionCode",name:lf("Debug Extension Code"),description:lf("Use the JavaScript debugger to debug extension code")},{id:"snippetBuilder",name:lf("Snippet Builder"),description:lf("Try out the new snippet dialogs.")},{id:"experimentalHw",name:lf("Experimental Hardware"),description:lf("Enable support for hardware marked 'experimental' in the hardware seletion dialog")},{id:"checkForHwVariantWebUSB",name:lf("Detect Hardware with WebUSB"),description:lf("When compiling, use WebUSB to detect hardware configuration.")},{id:"githubEditor",name:lf("GitHub editor"),description:lf("Review, commit and push to GitHub."),feedbackUrl:"https://github.com/microsoft/pxt/issues/6419",enableOnline:!0},{id:"githubCompiledJs",name:lf("GitHub Pages JavaScript"),description:lf("Commit compiled javascript when creating a release"),enableOnline:!0},{id:"blocksCollapsing",name:lf("Collapse blocks"),description:lf("Collapse and expand functions or event blocks")},{id:"tutorialBlocksDiff",name:lf("Tutorial Block Diffs"),description:lf("Automatially render blocks diff in tutorials")},{id:"openProjectNewTab",name:lf("Open in New Tab"),description:lf("Open an editor in a new tab.")},{id:"openProjectNewDependentTab",name:lf("Open in New Connected Tab"),description:lf("Open connected editors in different browser tabs.")},{id:"accessibleBlocks",name:lf("Accessible Blocks"),description:lf("Use the WASD keys to move and modify blocks."),feedbackUrl:"https://github.com/microsoft/pxt/issues/6850"},{id:"errorList",name:lf("Error List"),description:lf("Show an error list panel for JavaScript and Python.")},{id:"blocksErrorList",name:lf("Blocks Error List"),description:lf("Show an error list panel for Blocks")},{id:"timeMachine",name:lf("Time Machine"),description:lf("Save and restore past versions of a project")}].filter((t=>e.indexOf(t.id)>-1&&!(pxt.BrowserUtils.isPxtElectron()&&t.enableOnline))):[]}function o(e){return!!pxt.storage.getLocal(r(e))}function a(e,t){t!=o(e)&&(t?pxt.storage.setLocal(r(e),"1"):pxt.storage.removeLocal(r(e)),i())}Object.defineProperty(n,"__esModule",{value:!0}),n.setState=n.state=n.toggle=n.isEnabled=n.someEnabled=n.clear=n.all=n.syncTheme=void 0,n.syncTheme=i,n.all=s,n.clear=function(){s().forEach((e=>pxt.storage.removeLocal(r(e)))),i()},n.someEnabled=function(){return s().some((e=>o(e)))},n.isEnabled=o,n.toggle=function(e){a(e,!o(e))},n.state=function(){const e={};return s().forEach((t=>e[t.id]=o(t))),JSON.stringify(e)},n.setState=a},{}],133:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.updateShareHistory=n.pushSnapshotOnHistory=n.updateHistory=n.parseHistoryFile=n.applySnapshot=n.createSnapshot=n.applyDiff=n.diffScriptText=n.collapseHistory=void 0;const r=9e5,i=864e5;function s(e,t,n,r){var i,s;const o=[];for(const n of Object.keys(e))(n.endsWith(".ts")||n.endsWith(".jres")||n.endsWith(".py")||n.endsWith(".blocks")||"pxt.json"===n)&&(null==t[n]?o.push({type:"removed",filename:n,value:e[n]}):e[n]!==t[n]&&o.push({type:"edited",filename:n,patch:r(t[n],e[n])}));for(const n of Object.keys(t))(n.endsWith(".ts")||n.endsWith(".jres")||n.endsWith(".py")||n.endsWith(".blocks")||"pxt.json"===n)&&null==e[n]&&o.push({type:"added",filename:n,value:t[n]});if(o.length)return{timestamp:n,editorVersion:null===(s=null===(i=pxt.appTarget)||void 0===i?void 0:i.versions)||void 0===s?void 0:s.target,changes:o}}function o(e,t,n){const r=Object.assign({},e);for(const i of t.changes)"added"===i.type?delete r[i.filename]:"removed"===i.type?r[i.filename]=i.value:r[i.filename]=n(i.patch,e[i.filename]);return r}function a(e){try{const t={},n=JSON.parse(e[pxt.CONFIG_NAME]);for(const r of n.files)r===pxt.IMAGES_CODE||r===pxt.TILEMAP_CODE?t[r]="":t[r]=e[r];if(t[pxt.CONFIG_NAME]=e[pxt.CONFIG_NAME],n.preferredEditor===pxt.BLOCKS_PROJECT_NAME?t[pxt.MAIN_BLOCKS]&&(t[pxt.MAIN_TS]=""):n.preferredEditor===pxt.PYTHON_PROJECT_NAME&&t[pxt.MAIN_PY]&&(t[pxt.MAIN_TS]=""),n.testFiles)for(const r of n.testFiles)t[r]=e[r];return t}catch(t){return Object.assign({},e)}}function l(e){const t=JSON.parse(e);return t.entries||(t.entries=[]),t.shares||(t.shares=[]),t.snapshots||(t.snapshots=[]),t}function c(e,t){return{timestamp:t,editorVersion:pxt.appTarget.versions.target,text:a(e)}}function u(){var e,t;return null!=(null===(t=null===(e=pxt.appTarget)||void 0===e?void 0:e.appTheme)||void 0===t?void 0:t.timeMachineDiffInterval)?pxt.appTarget.appTheme.timeMachineDiffInterval:3e5}n.collapseHistory=function(e,t,n,r,i){var a,l;const c=[];let u,d,p,h=Object.assign({},t),f=null===(l=null===(a=pxt.appTarget)||void 0===a?void 0:a.versions)||void 0===l?void 0:l.target,{interval:m,minTime:_,maxTime:g}=n;void 0===_&&(_=0),void 0===g&&(g=e[e.length-1].timestamp);for(let t=e.length-1;t>=0;t--){const n=e[t];n.timestamp>g?(c.unshift(n),h=o(h,n,i)):n.timestamp<_?(void 0!==d&&(d-t>1?c.unshift({timestamp:u,editorVersion:f,changes:s(h,p,u,r).changes}):c.unshift(e[d])),c.unshift(n),d=void 0):void 0!==d?u-n.timestamp>m?(d-t>1?c.unshift({timestamp:u,editorVersion:f,changes:s(h,p,u,r).changes}):c.unshift(e[d]),p=Object.assign({},h),h=o(h,n,i),d=t,u=n.timestamp,f=n.editorVersion):h=o(h,n,i):(p=Object.assign({},h),u=n.timestamp,f=n.editorVersion,d=t,h=o(h,n,i))}return void 0!==d&&(d?c.unshift({timestamp:u,editorVersion:f,changes:s(h,p,u,r).changes}):c.unshift(e[0])),c},n.diffScriptText=s,n.applyDiff=o,n.createSnapshot=a,n.applySnapshot=function(e,t){var n;try{const r=Object.assign({},t),i=JSON.parse(e[pxt.CONFIG_NAME]);for(const t of Object.keys(e))-1!==i.files.indexOf(t)||-1!==(null===(n=i.testFiles)||void 0===n?void 0:n.indexOf(t))||r[t]||(r[t]=e[t]);return r}catch(n){const r=Object.assign({},e);for(const e of Object.keys(t))r[e]=t[e];return r}},n.parseHistoryFile=l,n.updateHistory=function(e,t,n,a,d,p){let h;h=e[pxt.HISTORY_FILE]?l(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[c(e,n-1)],shares:[]};for(const e of a)h.shares.some((t=>t.id===e.id))||h.shares.push({id:e.id,timestamp:n});if(function(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n){if(-1===r.indexOf(i))return!1;if(e[i]!==t[i])return!1}return!0}(e,t))return void(t[pxt.HISTORY_FILE]=JSON.stringify(h));let f=!1;if(h.entries.length>1){const e=h.entries[h.entries.length-1].timestamp,t=h.entries[h.entries.length-2].timestamp;n-e<u()&&e-t<u()&&(f=!0)}if(f){const r=s(o(e,h.entries.pop(),p),t,n,d);r&&h.entries.push(r)}else{const r=s(e,t,n,d);r&&h.entries.push(r)}if(0==h.snapshots.length)h.snapshots.push(c(e,n-1));else if(n-h.snapshots[h.snapshots.length-1].timestamp>=function(){var e,t;return null!=(null===(t=null===(e=pxt.appTarget)||void 0===e?void 0:e.appTheme)||void 0===t?void 0:t.timeMachineSnapshotInterval)?pxt.appTarget.appTheme.timeMachineSnapshotInterval:r}()){h.snapshots.push(c(e,n));const t=[];let r=Math.floor(n/i)*i;for(let e=0;e<h.snapshots.length;e++){const s=h.snapshots[h.snapshots.length-1-e];n-s.timestamp<i||e===h.snapshots.length-1?t.unshift(s):s.timestamp<r&&(t.unshift(s),r=Math.floor(s.timestamp/i)*i)}h.snapshots=t}t[pxt.HISTORY_FILE]=JSON.stringify(h)},n.pushSnapshotOnHistory=function(e,t){let n;(n=e[pxt.HISTORY_FILE]?l(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[],shares:[]}).snapshots.push(c(e,t)),e[pxt.HISTORY_FILE]=JSON.stringify(n)},n.updateShareHistory=function(e,t,n){let r;r=e[pxt.HISTORY_FILE]?l(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[],shares:[]};for(const e of n)r.shares.some((t=>t.id===e.id))||r.shares.push({id:e.id,timestamp:t});e[pxt.HISTORY_FILE]=JSON.stringify(r)}},{}],134:[function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.validation=n.experiments=n.workspace=n.monaco=n.history=void 0;const s=e("./history");n.history=s;const o=e("./monaco");n.monaco=o;const a=e("./workspace");n.workspace=a;const l=e("./experiments");n.experiments=l;const c=e("./code-validation");n.validation=c,i(e("./editor"),n),i(e("./editorcontroller"),n),i(e("./monaco-fields/monacoFieldEditor"),n),i(e("./monaco-fields/field_tilemap"),n),i(e("./monaco-fields/field_musiceditor"),n),i(e("./monaco-fields/field_soundEffect"),n),i(e("./monaco-fields/field_sprite"),n),i(e("./monaco-fields/field_react"),n)},{"./code-validation":123,"./editor":130,"./editorcontroller":131,"./experiments":132,"./history":133,"./monaco":141,"./monaco-fields/field_musiceditor":135,"./monaco-fields/field_react":136,"./monaco-fields/field_soundEffect":137,"./monaco-fields/field_sprite":138,"./monaco-fields/field_tilemap":139,"./monaco-fields/monacoFieldEditor":140,"./workspace":142}],135:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.songEditorDefinition=n.MonacoSongEditor=void 0;const r=e("./field_react"),i=e("./monacoFieldEditor"),s="music-editor";class o extends r.MonacoReactFieldEditor{textToValue(e){this.isPython=-1===e.indexOf("`"),this.text=e;const t=pxt.parseAssetTSReference(e);if(t){const{type:e,name:n}=t,r=n.trim(),i=pxt.react.getTilemapProject();this.isAsset=!0;const s=i.lookupAssetByName("song",r);if(s)return s;{const e=i.createNewSong(pxt.assets.music.getEmptySong(2));return r&&!i.isNameTaken("song",r)&&pxt.validateAssetName(r)&&(e.meta.displayName=r),e}}const n=/hex\s*(?:`|\(""")\s*([a-fA-F0-9]*)\s*(?:`|"""\))\s*(?:;?)/m.exec(e);if(n){const e=n[1].trim();return function(e){return{type:"song",id:"",internalID:0,meta:{},song:e}}(e?pxt.assets.music.decodeSongFromHex(e):pxt.assets.music.getEmptySong(2))}}resultToText(e){var t;if(null===(t=e.meta)||void 0===t?void 0:t.displayName){const t=pxt.react.getTilemapProject();return e=this.isAsset||t.lookupAsset(e.type,e.id)?t.updateAsset(e):t.createNewSong(e.song,e.meta.displayName),this.isAsset=!0,pxt.getTSReferenceForAsset(e,this.isPython)}let n=pxt.assets.music.encodeSongToHex(e.song);return n=this.isPython?`hex("""${n}""")`:"hex`"+n+"`",this.text.replace(/hex\s*(?:`|\(""")\s*([a-fA-F0-9]*)\s*(?:`|"""\))\s*(?:;?)/m,n)}getFieldEditorId(){return s}getOptions(){return{blocksInfo:this.host.blocksInfo()}}}n.MonacoSongEditor=o,n.songEditorDefinition={id:s,foldMatches:!0,glyphCssClass:"fas fa-music sprite-focus-hover",heightInPixels:510,matcher:{searchString:'(?:(?:assets\\s*\\.\\s*song)|(?:music\\s*\\.\\s*create(?:S|_s)ong\\s*\\(\\s*hex))\\s*(?:`|\\(\\s*""")(?:(?:[^(){}:\\[\\]"\';?/,+\\-=*&|^%!`~]|\\n)*)\\s*(?:`|"""\\s*\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:o},(0,i.registerMonacoFieldEditor)(s,n.songEditorDefinition)},{"./field_react":136,"./monacoFieldEditor":140}],136:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MonacoReactFieldEditor=void 0;n.MonacoReactFieldEditor=class{getId(){return"image-editor"}showEditorAsync(e,t,n){return this.fileType=e,this.editrange=t,this.host=n,this.initAsync().then((()=>{const e=this.textToValue(n.getText(t));return e?(this.fv=pxt.react.getFieldEditorView(this.getFieldEditorId(),e,this.getOptions()),this.fv.onHide((()=>{this.onClosed()})),this.fv.show(),new Promise(((e,t)=>{this.resolver=e,this.rejecter=t}))):Promise.resolve(null)}))}onClosed(){this.resolver&&(this.resolver({range:this.editrange,replacement:this.resultToText(this.fv.getResult())}),this.editrange=void 0,this.resolver=void 0,this.rejecter=void 0)}dispose(){this.onClosed()}initAsync(){return Promise.resolve()}textToValue(e){return null}resultToText(e){return e+""}getFieldEditorId(){return""}getOptions(){return null}}},{}],137:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.soundEditorDefinition=n.MonacoSoundEffectEditor=void 0;const r=e("./field_react"),i=e("./monacoFieldEditor"),s="soundeffect-editor";class o extends r.MonacoReactFieldEditor{textToValue(e){const t={wave:"sine",startFrequency:5e3,endFrequency:0,startVolume:255,endVolume:0,duration:500,effect:"none",interpolation:"linear"};this.value=t;const n=/\(([^)]*)\)/.exec(e)[1].split(",").map((e=>e.replace(/\s/g,"")));if(8!==n.length)return t;switch(n[0]){case"WaveShape.Sawtooth":t.wave="sawtooth";break;case"WaveShape.Square":t.wave="square";break;case"WaveShape.Noise":t.wave="noise";break;case"WaveShape.Triangle":t.wave="triangle";break;case"WaveShape.Sine":default:t.wave="sine"}const r=(e,t)=>isNaN(e)?t:e;switch(t.startFrequency=r(parseInt(n[1]),t.startFrequency),t.endFrequency=r(parseInt(n[2]),t.endFrequency),t.startVolume=r(parseInt(n[3]),t.startVolume),t.endVolume=r(parseInt(n[4]),t.endVolume),t.duration=r(parseInt(n[5]),t.duration),n[6]){case"SoundExpressionEffect.Vibrato":t.effect="vibrato";break;case"SoundExpressionEffect.Tremolo":t.effect="tremolo";break;case"SoundExpressionEffect.Warble":t.effect="warble";break;case"SoundExpressionEffect.None":default:t.effect="none"}switch(n[7]){case"InterpolationCurve.Logarithmic":t.interpolation="logarithmic";break;case"InterpolationCurve.Curve":t.interpolation="curve";break;case"InterpolationCurve.Linear":default:t.interpolation="linear"}return t}resultToText(e){let t,n,r;switch((e=this.value).wave){case"sine":t="WaveShape.Sine";break;case"square":t="WaveShape.Square";break;case"triangle":t="WaveShape.Triangle";break;case"noise":t="WaveShape.Noise";break;case"sawtooth":t="WaveShape.Sawtooth"}switch(e.effect){case"vibrato":n="SoundExpressionEffect.Vibrato";break;case"tremolo":n="SoundExpressionEffect.Tremolo";break;case"warble":n="SoundExpressionEffect.Warble";break;case"none":n="SoundExpressionEffect.None"}switch(e.interpolation){case"curve":r="InterpolationCurve.Curve";break;case"linear":r="InterpolationCurve.Linear";break;case"logarithmic":r="InterpolationCurve.Logarithmic"}return`music.createSoundEffect(${t}, ${Math.round(e.startFrequency)}, ${Math.round(e.endFrequency)}, ${Math.round(e.startVolume)}, ${Math.round(e.endVolume)}, ${Math.round(e.duration)}, ${n}, ${r})`}getFieldEditorId(){return s}getOptions(){return{onClose:()=>this.fv.hide(),onSoundChange:e=>this.value=e,initialSound:this.value,useFlex:!0,useMixerSynthesizer:"microbit"!==pxt.appTarget.id}}}n.MonacoSoundEffectEditor=o,n.soundEditorDefinition={id:s,foldMatches:!0,glyphCssClass:"fas fa-music sprite-focus-hover",heightInPixels:510,matcher:{searchString:"music\\s*\\.\\s*createSoundEffect\\s*\\(",isRegex:!0,matchCase:!0,matchWholeWord:!1,validateRange:function(e,t){let n=e.startLineNumber,r=0,i=!1,s=0;const o=t.getLineCount();for(;n<o;){const o=t.getLineContent(n),a=o.indexOf("createSoundEffect");if(-1!==a&&(i=!0,r=a+"createSoundEffect".length),i)for(;r<o.length;){const i=o.charAt(r);if("("===i)s++;else if(")"===i&&0==--s)return new monaco.Range(e.startLineNumber,e.startColumn,n,r+t.getLineMinColumn(n)+1);r++}r=0,n++}}},proto:o},(0,i.registerMonacoFieldEditor)(s,n.soundEditorDefinition)},{"./field_react":136,"./monacoFieldEditor":140}],138:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.spriteEditorDefinition=n.MonacoSpriteEditor=void 0;const r=e("./field_react"),i=e("./monacoFieldEditor"),s="image-editor";class o extends r.MonacoReactFieldEditor{textToValue(e){this.isPython=-1===e.indexOf("`"),this.template=e.startsWith("bmp")?"bmp":"img";const t=pxt.parseAssetTSReference(e);if(t){const{type:e,name:n}=t,r=n.trim(),i=pxt.react.getTilemapProject();this.isAsset=!0;const s=i.lookupAssetByName("image",r);if(s)return s;{const e=i.createNewImage();return r&&!i.isNameTaken("image",r)&&pxt.validateAssetName(r)&&(e.meta.displayName=r),e}}return function(e){return{type:"image",id:"",internalID:0,bitmap:e.data(),meta:{},jresData:""}}(pxt.sprite.imageLiteralToBitmap(e,this.template))}resultToText(e){var t;if(null===(t=e.meta)||void 0===t?void 0:t.displayName){const t=pxt.react.getTilemapProject();return e=this.isAsset||t.lookupAsset(e.type,e.id)?t.updateAsset(e):t.createNewProjectImage(e.bitmap,e.meta.displayName),this.isAsset=!0,pxt.getTSReferenceForAsset(e,this.isPython)}return pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e.bitmap),this.isPython?"python":"typescript",this.template)}getFieldEditorId(){return"image-editor"}getOptions(){return{initWidth:16,initHeight:16,blocksInfo:this.host.blocksInfo()}}}n.MonacoSpriteEditor=o,n.spriteEditorDefinition={id:s,foldMatches:!0,glyphCssClass:"sprite-editor-glyph sprite-focus-hover",heightInPixels:510,matcher:{searchString:'(?:img|bmp|assets\\s*\\.\\s*image)\\s*(?:`|\\(\\s*""")(?:(?:[^(){}:\\[\\]"\';?/,+\\-=*&|^%!`~]|\\n)*)\\s*(?:`|"""\\s*\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:o},(0,i.registerMonacoFieldEditor)(s,n.spriteEditorDefinition)},{"./field_react":136,"./monacoFieldEditor":140}],139:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tilemapEditorDefinition=n.MonacoTilemapEditor=void 0;const r=e("./field_react"),i=e("./monacoFieldEditor"),s="tilemap-editor";class o extends r.MonacoReactFieldEditor{textToValue(e){const t=this.readTilemap(e),n=pxt.react.getTilemapProject();return pxt.sprite.addMissingTilemapTilesAndReferences(n,t),t}readTilemap(e){const t=pxt.react.getTilemapProject();if(/^\s*tiles\s*\./.test(e)&&(this.isTilemapLiteral=!1,e)){try{return function(e){return{type:"tilemap",id:"",internalID:0,meta:{},data:e}}(pxt.sprite.decodeTilemap(e,"typescript",t))}catch(e){}return null}this.isTilemapLiteral=!0;const n=/^\s*(tilemap(?:4|8|16|32)?)\s*(?:`([^`]*)`)|(?:\(\s*"""([^"]*)"""\s*\))\s*$/.exec(e),r=(n[2]||n[3]||"").trim();let i,s;if(this.tilemapLiteral=n[1],r&&(s=ts.pxtc.escapeIdentifier(r),i=t.getTilemap(s)||t.lookupAssetByName("tilemap",r)),!i){let e=16;"tilemap8"===this.tilemapLiteral?e=8:"tilemap32"===this.tilemapLiteral?e=32:"tilemap4"===this.tilemapLiteral&&(e=4);const[n]=t.createNewTilemap(s,e,16,16);i=t.getTilemap(n),s=n}return i}resultToText(e){const t=pxt.react.getTilemapProject();return t.pushUndo(),pxt.sprite.updateTilemapReferencesFromResult(t,e),this.isTilemapLiteral?(t.updateAsset(e),pxt.getTSReferenceForAsset(e,"python"===this.fileType)):pxt.sprite.encodeTilemap(e.data,"typescript"===this.fileType?"typescript":"python")}getFieldEditorId(){return"tilemap-editor"}getOptions(){return{initWidth:16,initHeight:16,blocksInfo:this.host.blocksInfo()}}getCreateTilemapRange(){const e=this.editrange.getStartPosition();let t,n=this.editrange.getEndPosition(),r=1;for(;;){t=new monaco.Range(n.lineNumber,n.column,n.lineNumber+1,0);const i=this.host.getText(t);for(let t=0;t<i.length;t++)if("("===i.charAt(t))r++;else if(")"===i.charAt(t)&&0==--r){const r=new monaco.Position(n.lineNumber,n.column+t+2);return monaco.Range.fromPositions(e,r)}if((n=t.getEndPosition()).lineNumber>e.lineNumber+20)return null}}}n.MonacoTilemapEditor=o,n.tilemapEditorDefinition={id:s,foldMatches:!0,alwaysBuildOnClose:!0,glyphCssClass:"sprite-focus-hover ms-Icon ms-Icon--Nav2DMapView",heightInPixels:510,weight:5,matcher:{searchString:'(?:tilemap(?:8|16|32)?\\s*(?:`|\\(""")(?:[ a-zA-Z0-9_]|\\n)*\\s*(?:`|"""\\)))|(?:tiles\\s*\\.\\s*createTilemap\\s*\\([^\\)]+\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:o},(0,i.registerMonacoFieldEditor)(s,n.tilemapEditorDefinition)},{"./field_react":136,"./monacoFieldEditor":140}],140:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMonacoFieldEditor=n.registerMonacoFieldEditor=void 0;const r={};n.registerMonacoFieldEditor=function(e,t){r[e]=t},n.getMonacoFieldEditor=function(e){return r[e]}},{}],141:[function(e,t,n){function r(e){const t=pxt.appTarget.appTheme.invertedMonaco,n=!(!pxt.appTarget.appTheme.monacoFieldEditors||!pxt.appTarget.appTheme.monacoFieldEditors.length),r=pxt.BrowserUtils.isAndroid();let i=monaco.editor.create(e,{model:null,ariaLabel:pxt.Util.lf("JavaScript editor"),fontFamily:"'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', 'monospace'",scrollBeyondLastLine:!0,language:"typescript",mouseWheelZoom:!1,wordBasedSuggestions:!0,lineNumbersMinChars:3,formatOnPaste:!0,folding:n,glyphMargin:n||pxt.appTarget.appTheme.debugger,minimap:{enabled:!1},fixedOverflowWidgets:!0,autoIndent:"full",useTabStops:!0,dragAndDrop:!0,matchBrackets:"always",occurrencesHighlight:!1,quickSuggestionsDelay:200,theme:t?"vs-dark":"vs",renderIndentGuides:!0,accessibilityHelpUrl:"",quickSuggestions:{other:!r,comments:!r,strings:!r},acceptSuggestionOnCommitCharacter:!r,acceptSuggestionOnEnter:r?"off":"on",accessibilitySupport:r?"off":"on"});return i.layout(),i}Object.defineProperty(n,"__esModule",{value:!0}),n.createEditor=n.initMonacoAsync=n.syncModels=void 0,n.syncModels=function(e,t,n,r){if(r)return;let i=monaco.languages.typescript.typescriptDefaults.getExtraLibs(),s={};e.sortedDeps().forEach((e=>{e.getFiles().forEach((r=>{let i=e.id+"/"+r;if(/\.(ts)$/.test(r)&&i!=n){if(!monaco.languages.typescript.typescriptDefaults.getExtraLibs()[i]){let n=e.readFile(r)||"\n";t[i]=monaco.languages.typescript.typescriptDefaults.addExtraLib(n,i)}s[i]="1"}}))})),Object.keys(i).filter((e=>/\.(ts)$/.test(e)&&!s[e])).forEach((e=>{t[e].dispose()}))},n.initMonacoAsync=function(e){return new Promise(((t,n)=>{if("object"==typeof window.monaco)return void t(r(e));let i=window.MonacoPaths,s=()=>{let n=window.require;n.config({paths:i}),n(["vs/editor/editor.main"],(()=>{monaco.languages.register({id:"asm",extensions:[".asm"]}),monaco.languages.setMonarchTokensProvider("asm",{tokenPostfix:"",keywords:["movs","mov","adds","add","adcs","adr","subs","sbcs","sub","rsbs","muls","cmp","cmn","ands","eors","orrs","bics","mvns","tst","lsls","lsrs","asrs","rors","ldr","ldrh","ldrb","ldrsh","ldrsb","ldm","str","strh","strb","stm","push","pop","cbz","cbnz","b","bl","bx","blx","sxth","sxtb","uxth","uxtb","rev","rev16","revsh","svc","cpsid","cpsie","setend","bkpt","nop","sev","wfe","wfi","yield","beq","bne","bcs","bhs","bcc","blo","bmi","bpl","bvs","bvc","bhi","bls","bge","blt","bgt","ble","bal","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","r10","r11","r12","r13","r14","r15","pc","sp","lr"],typeKeywords:[".startaddr",".hex",".short",".space",".section",".string",".byte"],operators:[],symbols:/[:\*]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/(\.)?[a-z_$\.][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/@\s*[a-zA-Z_\$][\w\$]*/,{token:"annotation"}],[/(#|(0[xX]))?[0-9a-fA-F]+/,"number"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/;.*$/,"comment"]]}}),monaco.languages.typescript&&(monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0}),monaco.languages.typescript.typescriptDefaults.setWorkerOptions({customWorkerPath:pxt.webConfig.typeScriptWorkerJs}),monaco.languages.typescript.typescriptDefaults.setCompilerOptions({allowUnreachableCode:!0,noImplicitAny:!0,allowJs:!1,allowUnusedLabels:!0,target:monaco.languages.typescript.ScriptTarget.ES5,outDir:"built",rootDir:".",noLib:!0,mouseWheelZoom:!1})),t(r(e))}))};if(window.require)s();else{let e=document.createElement("script");e.type="text/javascript",e.src=i["vs/loader"],e.addEventListener("load",s),document.body.appendChild(e)}}))},n.createEditor=r},{}],142:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.freshHeader=void 0,n.freshHeader=function(e,t){return{target:pxt.appTarget.id,targetVersion:pxt.appTarget.versions.target,name:e,meta:{},editor:pxt.JAVASCRIPT_PROJECT_NAME,pubId:"",pubCurrent:!1,_rev:null,id:pxt.U.guidGen(),recentUse:t,modificationTime:t,cloudUserId:null,cloudCurrent:!1,cloudVersion:null,cloudLastSyncTime:0,isDeleted:!1}}},{}],143:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("./runner"),i=e("./renderer"),s=e("../pxteditor");window.pxt||(window.pxt={}),window.pxt.runner=Object.assign(Object.assign({},r),i),window.pxt.editor=Object.assign({},s),function(){let e=window.ksRunnerWhenLoaded;e&&e()}()},{"../pxteditor":134,"./renderer":144,"./runner":145}],144:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.renderAsync=n.defaultClientRenderOptions=void 0;const r=e("./runner"),i=e("blockly"),s=e("../pxtblocks"),o=e("../pxtblocks/codecardRenderer");function a(){return{blocksAspectRatio:window.innerHeight<window.innerWidth?1.62:1/1.62,snippetClass:"lang-blocks",signatureClass:"lang-sig",blocksClass:"lang-block",blocksXmlClass:"lang-blocksxml",diffBlocksXmlClass:"lang-diffblocksxml",diffClass:"lang-diff",diffStaticPythonClass:"lang-diffspy",diffBlocksClass:"lang-diffblocks",staticPythonClass:"lang-spy",simulatorClass:"lang-sim",linksClass:"lang-cards",namespacesClass:"lang-namespaces",apisClass:"lang-apis",codeCardClass:"lang-codecard",packageClass:"lang-package",jresClass:"lang-jres",assetJSONClass:"lang-assetsjson",projectClass:"lang-project",snippetReplaceParent:!0,simulator:!0,showEdit:!0,hex:!0,tutorial:!1,showJavaScript:!1,hexName:pxt.appTarget.id}}function l(e){"undefined"!=typeof hljs&&(e.hasClass("highlight")?hljs.highlightBlock(e[0]):e.find("code.highlight").each((function(e,t){hljs.highlightBlock(t)})),c(e))}function c(e){e.find("span.hljs-comment:contains(@highlight)").each(((e,t)=>{try{!function(e){const t=$(e),n=document.createElement("span");n.className="highlight-line";let r=e.nextSibling;if(!r||r.nodeType!=Node.TEXT_NODE)return;let i=r.textContent,s=i.indexOf("\n");if(!(s<0)){for(r.textContent=i.substring(0,s+1),$(document.createTextNode(i.substring(s+1).replace(/^\s+/,""))).insertAfter($(r)),r=r.nextSibling;r;){let e=r.nextSibling;if(r.nodeType==Node.TEXT_NODE){const t=(i=r.textContent).indexOf("\n");if(!(t<0)){n.appendChild(document.createTextNode(i.substring(0,t))),r.textContent=i.substring(t+1);break}n.appendChild(r),r=e}else n.appendChild(r),r=e}$(n).insertAfter(t),t.remove()}}(t)}catch(e){pxt.reportException(e)}}))}function u(e,t,n){e.append($('<div class="ui content js"><div class="subheading"><i class="ui icon xicon js"></i>JavaScript</div></div>').append(t)),l(t)}function d(e,t,n){e.append($('<div class="ui content py"><div class="subheading"><i class="ui icon xicon python"></i>Python</div></div>').append(t)),l(t)}function p(e,t){const n=$('<a class="item" role="button" tabindex="0"><i role="presentation" aria-hidden="true"></i><span class="ui desktop only"></span></a>');return n.attr("aria-label",e),n.attr("title",e),n.find("i").attr("class",t),n.find("span").text(e),function(e){e.keypress((e=>{const t="number"==typeof e.which?e.which:e.keyCode;13!==t&&32!==t||(e.preventDefault(),e.currentTarget.click())}))}(n),n}function h(e,t,n,r,i,s,o={}){let a=$('<div class="ui bottom attached tabular icon small compact menu hideprint"> <div class="right icon menu"></div></div>'),l=$('<div class="ui top attached segment codewidget"></div>'),c=a.find(".right.menu");const h=pxt.appTarget.appTheme||{};if(o.showEdit&&!h.hideDocsEdit&&s){const t=p(lf("Edit"),"edit icon"),{package:n,compileBlocks:o,compilePython:a}=s,l=n.host();if(i&&o?(n.setPreferredEditor(pxt.BLOCKS_PROJECT_NAME),l.writeFile(n,pxt.MAIN_BLOCKS,o.outfiles[pxt.MAIN_BLOCKS])):r&&a?(n.setPreferredEditor(pxt.PYTHON_PROJECT_NAME),l.writeFile(n,pxt.MAIN_PY,o.outfiles[pxt.MAIN_PY])):n.setPreferredEditor(pxt.JAVASCRIPT_PROJECT_NAME),e.assetJSON)for(const t of Object.keys(e.assetJSON))n.config.files.indexOf(t)<0&&n.config.files.push(t),l.writeFile(n,t,e.assetJSON[t]);const u=n.compressToFileAsync();t.click((()=>{pxt.tickEvent("docs.btn",{button:"edit"}),u.then((t=>{window.open(`${function(e){return(e.pxtUrl||pxt.appTarget.appTheme.homeUrl||"").replace(/\/$/,"")}(e)}/#project:${ts.pxtc.encodeBase64(pxt.Util.uint8ArrayToString(t))}`,"pxt")}))})),c.append(t)}if(e.showJavaScript||!i&&!r?(l.append(n),m(),g()):i?(l.append(i),_(),g()):r&&(l.append(r),m(),_()),o.run&&!h.hideDocsSimulator){let t=p(lf("Run"),"play icon").click((()=>{if(pxt.tickEvent("docs.btn",{button:"sim"}),l.find(".sim")[0])l.find(".sim").remove(),y(l);else{let t="81.97%";pxt.appTarget.simulator&&(t=100/pxt.appTarget.simulator.aspectRatio+"%");const r=e.package?"&deps="+encodeURIComponent(e.package):"",i=E(e)+"#nofooter=1"+r,s=e.assetJSON?`data-assets="${encodeURIComponent(JSON.stringify(e.assetJSON))}"`:"",o=encodeURIComponent(n.text());let a=$(`<div class="ui card sim"><div class="ui content"><div style="position:relative;height:0;padding-bottom:${t};overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${i}" data-code="${o}" ${s} allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe></div></div></div>`);l.append(a),y(a)}}));c.append(t)}if(o.hexname&&o.hex){let e=p(lf("Download"),"download icon").click((()=>{pxt.tickEvent("docs.btn",{button:"hex"}),pxt.BrowserUtils.browserDownloadBinText(o.hex,o.hexname,{contentType:pxt.appTarget.compile.hexMimeType})}));c.append(e)}let f=$("<div class=codesnippet></div>");function m(){if(!i)return;const e=p(lf("Blocks"),"icon xicon blocks").click((()=>{pxt.tickEvent("docs.btn",{button:"blocks"}),l.find(".blocks")[0]?(l.find(".blocks").remove(),y(l)):(function(e,t){e.append($('<div class="ui content blocks"/>').append(t))}(n?n.parent():l,i),y(i))}));c.append(e)}function _(){if(n)if(o.showJs)u(l,n);else{const e=p("JavaScript","icon xicon js").click((()=>{pxt.tickEvent("docs.btn",{button:"js"}),l.find(".js")[0]?(l.find(".js").remove(),y(l)):(u(i?i.parent():l,n),y(n))}));c.append(e)}}function g(){if(r)if(o.showPy)d(l,r);else{const e=p("Python","icon xicon python").click((()=>{pxt.tickEvent("docs.btn",{button:"py"}),l.find(".py")[0]?(l.find(".py").remove(),y(l)):(d(i?i.parent():l,r),y(r))}));c.append(e)}}function y(e){var t;null===(t=e[0])||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"})}c.children().length&&f.append(a),f.append(l),t.replaceWith(f)}n.defaultClientRenderOptions=a;let f,m=[];function _(e,t,n){if(!e)return Promise.resolve();let r=$("."+e).first();return r[0]?(n.emPixels||(n.emPixels=18),n.layout||(n.layout=1),n.splitSvg=!0,m.push({el:r,source:r.text(),options:n,render:t}),r.addClass("lang-shadow"),r.removeClass(e),_(e,t,n)):Promise.resolve()}function g(e){if(!e||e.kind!=ts.SyntaxKind.ExpressionStatement)return null;let t=e;if(!t.expression||t.expression.kind!=ts.SyntaxKind.CallExpression)return null;let n=t.expression;return pxtc.pxtInfo(n).callInfo}function y(e){return f||(f=(0,r.decompileSnippetAsync)("",e)),f}function b(e,t){if(!t)return;const n=/^\/(v\d+)/.exec(t.url),r=/^\/(v\d+)/.exec(window.location.pathname),i=/#doc/i.test(window.location.href);t.url&&!n&&r&&!i&&(t.url=`/${r[1]}/${t.url}`),e.append((0,o.renderCodeCard)(t,{hideHeader:!0,shortName:!0}))}function v(e,t,n){const r=t.attributes,s=!r.blockHidden&&i.Blocks[r.blockId];if(null==s?void 0:s.codeCard){const t=pxt.U.clone(s.codeCard);n&&(t.style=n),b(e,t)}else b(e,{name:t.qName,description:r.jsDoc,url:r.help||void 0,style:n})}function T(e,t,n,r){return _(t,((e,t)=>{const s=t.compileProgram;if(!s)return;const o=s.getSourceFile(pxt.MAIN_TS).statements.slice(0),a=$("<div />").addClass("ui cards");a.attr("role","listbox"),o.forEach((e=>{const n=e.kind,s=g(e);if(s&&t.apiInfo&&t.apiInfo.byQName[s.qName]){const e=t.apiInfo.byQName[s.qName],n=e.attributes,o=i.Blocks[n.blockId];if(r){const r=e,i=t.compileBlocks.blocksInfo.apis.byQName[r.namespace];b(a,{name:i.attributes.blockNamespace||i.name,url:i.attributes.help||"reference/"+(i.attributes.blockNamespace||i.name).toLowerCase(),description:i.attributes.jsDoc,blocksXml:o&&o.codeCard?o.codeCard.blocksXml:n.blockId?`<xml xmlns="http://www.w3.org/1999/xhtml"><block type="${n.blockId}"></block></xml>`:void 0})}else v(a,e)}else switch(n){case ts.SyntaxKind.ExpressionStatement:{const t=e;switch(t.expression.kind){case ts.SyntaxKind.TrueKeyword:case ts.SyntaxKind.FalseKeyword:b(a,{name:"Boolean",url:"blocks/logic/boolean",description:lf("True or false values"),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="logic_boolean"><field name="BOOL">TRUE</field></block></xml>'});break;default:pxt.debug(`card expr kind: ${t.expression.kind}`)}break}case ts.SyntaxKind.IfStatement:b(a,{name:r?"Logic":"if",url:"blocks/logic"+(r?"":"/if"),description:lf(r?"Logic operators and constants":"Conditional statement"),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_if"></block></xml>'});break;case ts.SyntaxKind.WhileStatement:b(a,{name:r?"Loops":"while",url:"blocks/loops"+(r?"":"/while"),description:lf(r?"Loops and repetition":"Repeat code while a condition is true."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="device_while"></block></xml>'});break;case ts.SyntaxKind.ForOfStatement:b(a,{name:r?"Loops":"for of",url:"blocks/loops"+(r?"":"/for-of"),description:lf(r?"Loops and repetition":"Repeat code for each item in a list."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_for_of"></block></xml>'});break;case ts.SyntaxKind.BreakStatement:b(a,{name:r?"Loops":"break",url:"blocks/loops"+(r?"":"/break"),description:lf(r?"Loops and repetition":"Break out of the current loop."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="break_keyword"></block></xml>'});break;case ts.SyntaxKind.ContinueStatement:b(a,{name:r?"Loops":"continue",url:"blocks/loops"+(r?"":"/continue"),description:lf(r?"Loops and repetition":"Skip iteration and continue the current loop."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="continue_keyboard"></block></xml>'});break;case ts.SyntaxKind.ForStatement:{let t=e,n=!0;3==t.condition.getChildCount()&&(n=!("0"==t.condition.getChildAt(0).getText()||t.condition.getChildAt(1).kind==ts.SyntaxKind.LessThanToken)),b(a,n?{name:r?"Loops":"for",url:"blocks/loops"+(r?"":"/for"),description:lf(r?"Loops and repetition":"Repeat code for a given number of times using an index."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_simple_for"></block></xml>'}:{name:r?"Loops":"repeat",url:"blocks/loops"+(r?"":"/repeat"),description:lf(r?"Loops and repetition":"Repeat code for a given number of times."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_repeat_ext"></block></xml>'});break}case ts.SyntaxKind.VariableStatement:b(a,{name:r?"Variables":"variable declaration",url:"blocks/variables"+(r?"":"/assign"),description:lf(r?"Variables":"Assign a value to a named variable."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="variables_set"></block></xml>'});break;default:pxt.debug(`card kind: ${n}`)}})),n&&(e=e.parent()),e.replaceWith(a)}),{package:e.package,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}function k(e,t){if(!e)return Promise.resolve();let n=$("."+e).first();if(!n[0])return Promise.resolve();n.removeClass(e);const r=pxt.gallery.parseCodeCardsHtml(n[0]);return r||n.append($("<div/>").addClass("ui segment warning").text("invalid codecard format")),t.snippetReplaceParent&&(n=n.parent()),function(e,t,n){if(!t||0==t.length)return Promise.resolve();if(0==t.length){let r=(0,o.renderCodeCard)(t[0],n);e.replaceWith(r)}else{let r=document.createElement("div");r.className="ui cards",r.setAttribute("role","listbox"),t.forEach((e=>{const t=/^\/(v\d+)/.exec(e.url),i=/^\/(v\d+)/.exec(window.location.pathname),s=/#doc/i.test(window.location.href);e.url&&!t&&i&&!s&&(e.url=`/${i[1]}${e.url}`);const a=(0,o.renderCodeCard)(e,n);if(r.appendChild(a),"package"==e.cardType){const t=pxt.github.parseRepoId((e.url||"").replace(/^\/pkg\//,""));t&&pxt.packagesConfigAsync().then((i=>{switch(pxt.github.repoStatus(t,i)){case pxt.github.GitRepoStatus.Banned:a.remove();break;case pxt.github.GitRepoStatus.Approved:e.imageUrl=pxt.github.mkRepoIconUrl(t),r.insertBefore((0,o.renderCodeCard)(e,n),a),a.remove()}})).catch((t=>{pxt.reportException(t),pxt.debug(`failed to load repo ${e.url}`)}))}})),e.replaceWith(r)}return Promise.resolve()}(n,r,{hideHeader:!0}).then((()=>pxt.U.delay(1,k(e,t))))}function E(e){return e.pxtUrl?e.pxtUrl+"/--run":pxt.webConfig&&pxt.webConfig.runUrl?pxt.webConfig.runUrl:"/--run"}function x(e,t){t.snippetReplaceParent&&(e=e.parent()),e.remove()}function S(e,t,n){$(`code.lang-${e}\\.${t}`).each(((e,t)=>{x($(t),n)}))}n.renderAsync=function(e){return pxt.analytics.enable(pxt.Util.userLanguage()),e||(e=a()),e.pxtUrl&&(e.pxtUrl=e.pxtUrl.replace(/\/$/,"")),e.showEdit&&(e.showEdit=!pxt.BrowserUtils.isIFrame()),function(e){e.packageClass&&($("."+e.packageClass).each(((t,n)=>{let r=$(n),i=r.text().split("\n").map((e=>e.replace(/\s*/g,""))).filter((e=>!!e)).join(",");e.package=e.package?`${e.package},${i}`:i,e.snippetReplaceParent&&(r=r.parent()),r.remove()})),$(".lang-config").each(((t,n)=>{let r=$(n);e.snippetReplaceParent&&(r=r.parent()),r.remove()})))}(e),function(e){let t,n;e.jresClass&&$(`.${e.jresClass}`).each(((e,t)=>{const r=$(t);n=r.text(),t.parentElement.remove()})),e.assetJSONClass&&$(`.${e.assetJSONClass}`).each(((e,n)=>{const r=$(n);t=r.text(),n.parentElement.remove()})),e.assetJSON=function(e,t){if(!e&&!t)return;const n=pxt.tutorial.parseAssetJson(e)||{};if(t){const e=JSON.parse(t);n[pxt.TILEMAP_JRES]=JSON.stringify(e),n[pxt.TILEMAP_CODE]=pxt.emitTilemapsFromJRes(e)}return n}(t,n)}(e),m=[],function(e){x($("code.lang-ghost"),e)}(e),function(e){S("blockconfig","local",e),S("blockconfig","global",e)}(e),function(e){x($("code.lang-template"),e)}(e),function(e){S("validation","local",e),S("validation","global",e)}(e),function(e){e.simulatorClass&&$("."+e.simulatorClass).each(((t,n)=>{let r=$(n),i="81.97%";pxt.appTarget.simulator&&(i=100/pxt.appTarget.simulator.aspectRatio+"%");let s=$(`<div class="ui card"><div class="ui content">\n                    <div style="position:relative;height:0;padding-bottom:${i};overflow:hidden;">\n                    <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" allowfullscreen="allowfullscreen" frameborder="0" sandbox="allow-popups allow-forms allow-scripts allow-same-origin"></iframe>\n                    </div>\n                    </div></div>`);const o=e.package?"&deps="+encodeURIComponent(e.package):"",a=E(e)+"#nofooter=1"+o,l=encodeURIComponent(r.text().trim()),c=s.find("iframe");c.attr("src",a),c.attr("data-code",l),e.assetJSON&&c.attr("data-assets",JSON.stringify(e.assetJSON)),e.snippetReplaceParent&&(r=r.parent()),r.replaceWith(s)}))}(e),function(e){const t={showEdit:!!e.showEdit,run:!!e.simulator};function n(n,r){"undefined"!=typeof hljs&&($(n).text($(n).text().replace(/^\s*\r?\n/,"")),hljs.highlightBlock(n),c($(n)));const i=pxt.U.clone(t);r&&(i.run=!1,i.showEdit=!1),h(e,$(n).parent(),$(n),void 0,void 0,void 0,i)}$("code.lang-typescript").each(((e,t)=>{n(t,!1),$(t).removeClass("lang-typescript")})),$("code.lang-typescript-ignore").each(((e,t)=>{$(t).removeClass("lang-typescript-ignore"),$(t).addClass("lang-typescript"),n(t,!0),$(t).removeClass("lang-typescript")})),$("code.lang-typescript-invalid").each(((e,t)=>{$(t).removeClass("lang-typescript-invalid"),$(t).addClass("lang-typescript"),n(t,!0),$(t).removeClass("lang-typescript"),$(t).parent("div").addClass("invalid"),$(t).parent("div").prepend($("<i>",{class:"icon ban"})),$(t).addClass("invalid")})),$("code.lang-typescript-valid").each(((e,t)=>{$(t).removeClass("lang-typescript-valid"),$(t).addClass("lang-typescript"),n(t,!0),$(t).removeClass("lang-typescript"),$(t).parent("div").addClass("valid"),$(t).parent("div").prepend($("<i>",{class:"icon check"})),$(t).addClass("valid")}))}(e),function(e){const t={showEdit:!!e.showEdit,run:!!e.simulator};$("code.lang-python").each(((n,r)=>{!function(n,r){"undefined"!=typeof hljs&&($(n).text($(n).text().replace(/^\s*\r?\n/,"")),hljs.highlightBlock(n),c($(n)));const i=pxt.U.clone(t);h(e,$(n).parent(),$(n),void 0,void 0,void 0,i)}(r),$(r).removeClass("lang-python")}))}(e),Promise.resolve().then((()=>k(e.codeCardClass,e))).then((()=>function(e){return"core"==pxt.appTarget.id?Promise.resolve():y(e).then((e=>{let t={};const n=e.compileBlocks.blocksInfo;n.blocks.forEach((e=>{const r=(e.attributes.blockNamespace||e.namespace).split(".")[0];if(!t[r]){const e=n.apis.byQName[r];e&&e.attributes.color&&(t[r]=e.attributes.color)}}));let r="";return Object.keys(t).forEach((e=>{const n=t[e]||"#dddddd";r+=`\n                        span.docs.${e.toLowerCase()} {\n                            background-color: ${n} !important;\n                            border-color: ${pxt.toolbox.fadeColor(n,.1,!1)} !important;\n                        }\n                    `})),r})).then((e=>(Object.keys(pxt.toolbox.blockColors).forEach((t=>{const n=pxt.toolbox.getNamespaceColor(t);e+=`\n                        span.docs.${t.toLowerCase()} {\n                            background-color: ${n} !important;\n                            border-color: ${pxt.toolbox.fadeColor(n,.1,!1)} !important;\n                        }\n                    `})),e))).then((e=>{let t=document.createElement("style");t.id="namespaceColors",t.type="text/css",(document.head||document.getElementsByTagName("head")[0]).appendChild(t),t.appendChild(document.createTextNode(e))}))}(e))).then((()=>function(e){(e=pxt.Util.clone(e)).emPixels=18,e.snippetMode=!0;const t=$(":not(pre) > code");let n=0;return function i(){if(n>=t.length)return Promise.resolve();const s=$(t[n++]),o=s.text(),a=/^(\|+)([^\|]+)\|+$/.exec(o);if(a){const e=/^(([^\:\.]*?)[\:\.])?(.*)$/.exec(a[2]),t=e[2]?e[2].trim().toLowerCase():"",n=1==a[1].length?`docs inlinebutton ${t}`:`docs inlineblock ${t}`,r=e[3].trim();return s.replaceWith($(`<span class="${n}"/>`).text(pxt.U.rlf(r))),i()}const l=/^\[(.+)\]$/.exec(o);if(!l)return i();const c=l[1];return(0,r.decompileSnippetAsync)(c,e).then((e=>{if(e.blocksSvg){let t=$('<span class="block"/>').append(e.blocksSvg);const n=g(e.compileProgram.getSourceFile(pxt.MAIN_TS).statements[0]);if(n&&e.apiInfo){const r=e.apiInfo.byQName[n.qName];r&&r.attributes.help&&(t=$('<a class="ui link"/>').attr("href",`/reference/${r.attributes.help}`).append(t))}s.replaceWith(t)}return pxt.U.delay(1,i())}))}()}(e))).then((()=>T(e,e.linksClass,e.snippetReplaceParent,!1))).then((()=>T(e,e.namespacesClass,e.snippetReplaceParent,!0))).then((()=>function(e,t){const n=e.apisClass;if(!n)return Promise.resolve();const r=$("."+n);return r.length?y(e).then((e=>{const n=e.compileBlocks.blocksInfo,s=pxt.Util.values(n.apis.byQName).filter((e=>!(e.attributes.hidden||e.attributes.deprecated||e.attributes.blockAliasFor||!e.attributes.jsDoc||!e.attributes.block||/^__/.test(e.name))));r.each(((e,n)=>{let r=$(n);const o=pxt.Util.toDictionary(r.text().split("\n"),(e=>e)),a=s.filter((e=>!!o[e.attributes.blockNamespace||e.namespace]));if(!a.length)return;a.sort(((e,t)=>{const n=!e.attributes.blockHidden&&i.Blocks[e.attributes.blockId],r=!t.attributes.blockHidden&&i.Blocks[t.attributes.blockId];return!!n!=!!r?(r?1:0)-(n?1:0):e.name.localeCompare(t.name)}));const l=$("<div />").addClass("ui divided items");l.attr("role","listbox"),a.forEach((e=>v(l,e,"item"))),t&&(r=r.parent()),r.replaceWith(l)}))})):Promise.resolve()}(e,e.snippetReplaceParent))).then((()=>function(e){return _(e.signatureClass,((t,n)=>{var r,o,a,l;let c=n.compileProgram;if(!c)return;let u=g(c.getSourceFile(pxt.MAIN_TS).statements[0]);if(!u||!n.apiInfo)return;const d=n.apiInfo.byQName[u.qName];if(!d)return;let p=i.Blocks[d.attributes.blockId],f=(null===(r=null==p?void 0:p.codeCard)||void 0===r?void 0:r.blocksXml)||void 0;const m=f?(0,s.render)(f):(null===(o=n.compileBlocks)||void 0===o?void 0:o.success)?n.blocksSvg:void 0,_=m?$(m):void 0;let y=ts.pxtc.service.displayStringForSymbol(d,!1,n.apiInfo).split("\n")[1]+";";const b=$('<code class="lang-typescript highlight"/>').text(y),v=(null===(l=null===(a=pxt.appTarget)||void 0===a?void 0:a.appTheme)||void 0===l?void 0:l.python)&&ts.pxtc.service.displayStringForSymbol(d,!0,n.apiInfo).split("\n")[1],T=v&&$('<code class="lang-python highlight"/>').text(v);if(e.snippetReplaceParent&&(t=t.parent()),pxt.Util.isTranslationMode()){const e=$('<div class="ui segment" />');e.append($('<div class="ui header"><i class="ui xicon globe"></i></div>')),d.attributes.translationId&&e.append($('<div class="ui message">').text(d.attributes.translationId)),d.attributes.jsDoc&&e.append($('<div class="ui message">').text(d.attributes.jsDoc)),e.insertAfter(t)}h(e,t,b,T,_,n,{showJs:!0,showPy:!0,hideGutter:!0})}),{package:e.package,snippetMode:!0,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}(e))).then((()=>function(e){if(e.tutorial)return _(e.snippetClass,((t,n)=>{const r=n.blocksSvg;e.snippetReplaceParent&&(t=t.parent());const i=$('<div class="ui segment codewidget"/>').append(r);t.replaceWith(i)}),{package:e.package,snippetMode:!1,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON});let t=0;return _(e.snippetClass,((n,r)=>{const i=r.compileBlocks&&r.compileBlocks.success?$(r.blocksSvg):void 0,s=r.compilePython&&r.compilePython.success&&r.compilePython.outfiles[pxt.MAIN_PY],o=$('<code class="lang-typescript highlight"/>').text(n.text().trim()),a=s?$('<code class="lang-python highlight"/>').text(s.trim()):void 0;e.snippetReplaceParent&&(n=n.parent());const l=r.compileJS&&r.compileJS.success,c=e.hex&&l&&r.compileJS.outfiles[pxtc.BINARY_HEX]?r.compileJS.outfiles[pxtc.BINARY_HEX]:void 0,u=`${pxt.appTarget.nickname||pxt.appTarget.id}-${e.hexName||""}-${t++}.hex`;h(e,n,o,a,i,r,{showEdit:e.showEdit,run:e.simulator,hexname:u,hex:c})}),{package:e.package,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}(e))).then((()=>function(e){return _(e.blocksClass,((t,n)=>{const r=n.blocksSvg;e.snippetReplaceParent&&(t=t.parent());const i=$('<div class="ui segment codewidget"/>').append(r);t.replaceWith(i)}),{package:e.package,snippetMode:!0,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}(e))).then((()=>function(e){return e.blocksXmlClass?function e(t,n,i){let s=$("."+t).first();return s[0]?(i.emPixels||(i.emPixels=18),i.splitSvg=!0,(0,r.compileBlocksAsync)(s.text(),i).then((r=>{try{n(s,r)}catch(e){pxt.reportException(e),s.append($("<div/>").addClass("ui segment warning").text(e.message))}return s.removeClass(t),pxt.U.delay(1,e(t,n,i))}))):Promise.resolve()}(e.blocksXmlClass,((t,n)=>{const r=n.blocksSvg;e.snippetReplaceParent&&(t=t.parent());const i=$('<div class="ui segment codewidget"/>').append(r);t.replaceWith(i)}),{package:e.package,snippetMode:!0,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON}):Promise.resolve()}(e))).then((()=>function(e){return e.diffBlocksXmlClass?function e(t,n,i){let o=$("."+t).first();if(!o[0])return Promise.resolve();i.emPixels||(i.emPixels=18),i.splitSvg=!0;const a=o.text().split(/-{10,}/),l=a[0],c=a[1];return(0,r.compileBlocksAsync)("",i).then((r=>{o.removeClass(t);try{const e=(0,s.diffXml)(l,c);e?(r.blocksSvg=e.svg,n(o,r)):o.text("no changes")}catch(e){pxt.reportException(e),o.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,e(t,n,i))}))}(e.diffBlocksXmlClass,((t,n)=>{const r=n.blocksSvg;e.snippetReplaceParent&&(t=t.parent());const i=$('<div class="ui segment codewidget"/>').append(r);t.replaceWith(i)}),{package:e.package,snippetMode:!0,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON}):Promise.resolve()}(e))).then((()=>function(e){return e.diffBlocksClass?function t(n){let i=$("."+n).first();if(!i[0])return Promise.resolve();const{fileA:o,fileB:a}=pxt.diff.split(i.text(),{removeTrailingSemiColumns:!0});return pxt.U.promiseMapAllSeries([o,a],(e=>(0,r.decompileSnippetAsync)(e,{generateSourceMap:!0}))).then((r=>{try{const t=(0,s.decompiledDiffAsync)(o,r[0].compileBlocks,a,r[1].compileBlocks,{hideDeletedTopBlocks:!0,hideDeletedBlocks:!0}),n=pxt.diff.render(o,a,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0});let l;const[c,u]=r.map((e=>e.compilePython&&e.compilePython.outfiles&&e.compilePython.outfiles[pxt.MAIN_PY]));c&&u&&(l=pxt.diff.render(c,u,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0})),h(e,i.parent(),$(n),l&&$(l),$(t.svg),void 0,{showEdit:!1,run:!1,hexname:void 0,hex:void 0})}catch(e){pxt.reportException(e),i.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,t(n))}))}(e.diffBlocksClass):Promise.resolve()}(e))).then((()=>function(e){return e.diffClass?function t(n){let r=$("."+n).first();if(!r[0])return Promise.resolve();const{fileA:i,fileB:s}=pxt.diff.split(r.text());try{const t=pxt.diff.render(i,s,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0});e.snippetReplaceParent&&(r=r.parent());const o=$('<div class="ui segment codewidget"/>').append(t);r.removeClass(n),r.replaceWith(o)}catch(e){pxt.reportException(e),r.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,t(n))}(e.diffClass):Promise.resolve()}(e))).then((()=>function(e){const t={showEdit:!!e.showEdit,run:!!e.simulator};return _(e.staticPythonClass,((n,r)=>{const i=r.compilePython;if(i&&i.success){const s=n.clone().removeClass("lang-shadow").addClass("highlight"),o=s.clone().addClass("lang-python").text(i.outfiles[pxt.MAIN_PY]);s.addClass("lang-typescript"),l(o),h(e,n.parent(),s,o,void 0,r,t)}}),{package:e.package,snippetMode:!0,assets:e.assetJSON})}(e))).then((()=>function(e){return e.projectClass?function t(){let n=$("."+e.projectClass).first(),i=n[0];if(!i)return Promise.resolve();n.removeClass(e.projectClass);let s=pxt.Cloud.parseScriptId(i.innerText);if(s){if(e.snippetReplaceParent){i=i.parentElement;let e=document.createElement("div");i.parentElement.insertBefore(e,i),i.parentElement.removeChild(i),i=e}return(0,r.renderProjectAsync)(i,s).then((()=>t()))}return t()}():Promise.resolve()}(e))).then((()=>function(){const e={};return function t(){const n=m.shift();if(!n)return Promise.resolve();const{el:i,options:s,render:o}=n;return(0,r.decompileSnippetAsync)(i.text(),s).then((t=>{const n=t.compileJS&&t.compileJS.diagnostics&&t.compileJS.diagnostics.filter((e=>e.category==pxtc.DiagnosticCategory.Error));n&&n.length&&n.forEach((e=>pxt.reportError("docs.decompile",""+e.messageText,{code:e.code+""}))),t.blocksSvg.querySelectorAll("defs *").forEach((t=>{e[t.id]?t.remove():e[t.id]=!0})),o(i,t)}),(e=>{pxt.reportException(e),i.append($("<div/>").addClass("ui segment warning").text(e.message))})).finally((()=>(i.removeClass("lang-shadow"),t())))}().then((()=>{i.Workspace.getAll().forEach((e=>e.dispose())),(0,s.cleanRenderingWorkspace)()}))}()))}},{"../pxtblocks":68,"../pxtblocks/codecardRenderer":11,"./runner":145,blockly:154}],145:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.init=n.setInitCallbacks=n.compileBlocksAsync=n.decompileSnippetAsync=n.renderMarkdownAsync=n.renderProjectFilesAsync=n.renderProjectAsync=n.startDocsServer=n.startRenderServer=n.setEditorContextAsync=n.editorLanguageMode=n.LanguageMode=n.buildSimJsInfo=n.fetchSimJsInfo=n.postSimMessage=n.currentDriver=n.preloadSim=n.simulateAsync=n.generateVMFileAsync=n.generateHexFileAsync=n.showError=n.initFooter=n.initHost=n.mainPkg=void 0;const r=e("../pxtblocks"),i=e("../pxteditor/editor"),s=e("./renderer"),o=e("../pxtblocks"),a=e("blockly");pxt.blocks.requirePxtBlockly=()=>o,pxt.blocks.requireBlockly=()=>a,pxt.blocks.registerFieldEditor=(e,t,n)=>o.registerFieldEditor(e,t,n);class l{constructor(e,t){this.ksPkg=e,this.topPkg=t,this.files={}}getKsPkg(){return this.ksPkg}getPkgId(){return this.ksPkg?this.ksPkg.id:this.id}isTopLevel(){return this.ksPkg&&0==this.ksPkg.level}setFiles(e){this.files=e}getAllFiles(){return pxt.Util.mapMap(this.files,((e,t)=>t))}}class c{constructor(){this.githubPackageCache={}}readFile(e,t){let n=m(e);return pxt.U.lookup(n.files,t)}writeFile(e,t,n){m(e).files[t]=n}getHexInfoAsync(e){return pxt.hexloader.getHexInfoAsync(this,e)}cacheStoreAsync(e,t){return Promise.resolve()}cacheGetAsync(e){return Promise.resolve(null)}patchDependencies(e,t,n){if(!n)return!1;const r=pxt.github.parseRepoId(n);if(!r)return!1;for(const t of Object.keys(e.dependencies)){const i=e.dependencies[t],s=pxt.github.parseRepoId(i);if(s&&r.fullName==s.fullName)return pxt.semver.strcmp(r.tag,s.tag)<0&&(e.dependencies[t]=n),!0}return!1}downloadPackageAsync(e,t){let n,r=e.verProtocol();"github"==r&&(n=this.githubPackageCache[e._verspec]);let i=m(e);return(n?Promise.resolve(n):e.commonDownloadAsync()).then((s=>{if(s)return"github"!=r||n||(this.githubPackageCache[e._verspec]=pxt.Util.clone(s)),i.setFiles(s),Promise.resolve();if("empty"==r){if(0==Object.keys(i.files).length&&i.setFiles(_()),t&&t.length){const n=m(e).files,r=JSON.parse(n[pxt.CONFIG_NAME]);t.forEach((e=>{f(r,e)})),n[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(r)}return Promise.resolve()}if("docs"==r){let t=_(),n=JSON.parse(t[pxt.CONFIG_NAME]);return e.verArgument().split(",").forEach((e=>{f(n,e)})),n.yotta||(n.yotta={}),n.yotta.ignoreConflicts=!0,t[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(n),i.setFiles(t),Promise.resolve()}return"invalid"==r?(pxt.log(`skipping invalid pkg ${e.id}`),Promise.resolve()):Promise.reject(`Cannot download ${e.version()}; unknown protocol`)}))}}let u,d,p,h;function f(e,t){let n=/^([a-zA-Z0-9_-]+)(=(.+))?$/.exec(t);return n?e.dependencies[n[1]]=n[3]||"*":console.warn(`unknown package syntax ${t}`),!0}function m(e){let t=e._editorPkg;if(t)return t;let r=null;e!=n.mainPkg&&(r=m(n.mainPkg));let i=new l(e,r);return e==n.mainPkg&&(i.topPkg=i),e._editorPkg=i,i}function _(){let e=pxt.appTarget.tsprj,t=pxt.U.clone(e.files);return t[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(e.config),t[pxt.MAIN_BLOCKS]="",t}function g(){pxt.setAppTarget(window.pxtTargetBundle),pxt.analytics.enable(pxt.Util.userLanguage()),pxt.Util.assert(!!pxt.appTarget);const e=window.location.href;let t,n=!1;if(/[&?]translate=1/.test(e)&&!pxt.BrowserUtils.isIE())t=ts.pxtc.Util.TRANSLATION_LOCALE,n=!0,pxt.Util.enableLiveLocalizationUpdates();else{const r=/PXT_LANG=(.*?)(?:;|$)/.exec(document.cookie),i=/(live)?(force)?lang=([a-z]{2,}(-[A-Z]+)?)/i.exec(e);t=i?i[3]:r&&r[1]||pxt.appTarget.appTheme.defaultLocale||navigator.userLanguage||navigator.language;const s=pxt.appTarget.appTheme.defaultLocale,o=null==t?void 0:t.toLocaleLowerCase(),a=pxt.BrowserUtils.isLocalHostDev()&&(!o||(s?s.toLocaleLowerCase()===o:"en"===o||"en-us"===o));(!(pxt.BrowserUtils.isPxtElectron()||a||pxt.appTarget.appTheme.disableLiveTranslations)||(null==i?void 0:i[1]))&&pxt.Util.enableLiveLocalizationUpdates(),n=!!i&&!!i[2]}pxt.appTarget.versions,$&&$.fn&&$.fn.embed&&$.fn.embed.settings&&$.fn.embed.settings.sources&&$.fn.embed.settings.sources.youtube&&($.fn.embed.settings.sources.youtube.url="//www.youtube.com/embed/{id}?rel=0");const r=pxt.webConfig;return pxt.Util.updateLocalizationAsync({targetId:pxt.appTarget.id,baseUrl:r.commitCdnUrl,code:t,force:n}).then((()=>y()))}function y(){n.mainPkg=new pxt.MainPackage(new c)}function b(e){console.error(e)}function v(e,t,r){const i=e?/\w+:\w+/.test(e)?e:"pub:"+e:"empty:tsprj";let s,o,a;return h&&h._verspec==i?(n.mainPkg=h,s=n.mainPkg.host(),o=Promise.resolve(),a=Promise.resolve()):(s=n.mainPkg.host(),n.mainPkg=new pxt.MainPackage(s),n.mainPkg._verspec=e?/\w+:\w+/.test(e)?e:"pub:"+e:"empty:tsprj",o=s.downloadPackageAsync(n.mainPkg,r),a=n.mainPkg.installAllAsync(),h=n.mainPkg),o.then((()=>s.readFile(n.mainPkg,pxt.CONFIG_NAME))).then((e=>e?a.then((()=>{if(t){let e=m(n.mainPkg);e.files[pxt.MAIN_TS]=t;let r=JSON.parse(e.files[pxt.CONFIG_NAME]);r.name=window.location.href.split("/").pop().split(/[?#]/)[0],e.files[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(r),n.mainPkg.config.name=r.name,-1==n.mainPkg.config.files.indexOf(pxt.MAIN_BLOCKS)&&n.mainPkg.config.files.push(pxt.MAIN_BLOCKS)}})).catch((e=>{b(lf("Cannot load extension: {0}",e.message))})):Promise.resolve()))}function T(e){let t=n.mainPkg.getTargetOptions();return t.isNative=!!e,t.hasHex=!!e,n.mainPkg.getCompileOptionsAsync(t)}function k(e,t){return T(e).then((e=>{t&&t(e);let n=pxtc.compile(e);return n.diagnostics&&n.diagnostics.length>0&&n.diagnostics.forEach((e=>{console.error(e.messageText)})),n}))}function E(e,t,r){var i;d&&t.embedId&&p===t.embedId?d.container=e:(d=new pxsim.SimulatorDriver(e),p=t.embedId);const{fnArgs:s,parts:o,usedBuiltinParts:a}=r||{};let l=pxt.appTarget.simulator.boardDefinition,c=C(t.id),u={debug:t.debug,mute:t.mute,boardDefinition:l,parts:o,builtinParts:a,fnArgs:s,cdnUrl:pxt.webConfig.commitCdnUrl,localizedStrings:pxt.Util.getLocalizedStrings(),highContrast:t.highContrast,storedState:c,light:t.light,single:t.single,hideSimButtons:t.hideSimButtons,autofocus:t.autofocus,queryParameters:t.additionalQueryParameters,mpRole:t.mpRole,theme:null===(i=n.mainPkg.config)||void 0===i?void 0:i.theme};return pxt.appTarget.simulator&&!t.fullScreen&&(u.aspectRatio=o.length&&pxt.appTarget.simulator.partsAspectRatio?pxt.appTarget.simulator.partsAspectRatio:pxt.appTarget.simulator.aspectRatio),d.setRunOptions(u),u}async function x(e){try{const t=Date.now(),n=await pxt.Cloud.downloadBuiltSimJsInfoAsync(e.id);return pxt.tickEvent("perfMeasurement",{durationMs:Date.now()-t,operation:"fetchSimJsInfo"}),n}catch(e){return void pxt.debug(e.toString())}}async function S(e){var t;const r=Date.now();await v(e.id,e.code,e.dependencies);let i=!1;const s=pxt.appTarget.versions.target;let o=await k(!1,(t=>{var r;if(t.computeUsedParts=!0,e.debug&&(t.breakpoints=!0),e.assets){const n=JSON.parse(e.assets);for(const e of Object.keys(n)){const r=n[e];if(t.fileSystem[e]=r,t.sourceFiles.indexOf(e)<0&&t.sourceFiles.push(e),/\.jres$/.test(e)){const e=JSON.parse(r);t.jres=pxt.inflateJRes(e,t.jres)}}}if(e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code),t.target.preferredEditor===pxt.PYTHON_PROJECT_NAME){t.target.preferredEditor=pxt.JAVASCRIPT_PROJECT_NAME,t.ast=!0;const e=M(pxtc.compile(t).ast,t);t.apisInfo=e,t.target.preferredEditor=pxt.PYTHON_PROJECT_NAME}const o=null===(r=n.mainPkg.config.targetVersions)||void 0===r?void 0:r.target;if(o&&s&&pxt.semver.cmp(pxt.semver.parse(o),pxt.semver.parse(s))<0)for(const e of Object.keys(t.fileSystem))!pxt.Util.startsWith(e,"pxt_modules")&&pxt.Util.endsWith(e,".ts")&&(i=!0,t.fileSystem[e]=pxt.patching.patchJavaScript(o,t.fileSystem[e]))}));(null===(t=o.diagnostics)||void 0===t?void 0:t.length)>0&&i&&(pxt.log("Compile with upgrade rules failed, trying again with original code"),o=await k(!1,(t=>{e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code)}))),o.diagnostics&&o.diagnostics.length>0&&console.error("Diagnostics",o.diagnostics);const a=pxtc.buildSimJsInfo(o);return a.parts=o.usedParts,pxt.tickEvent("perfMeasurement",{durationMs:Date.now()-r,operation:"buildSimJsInfo"}),a}function C(e){let t={};try{let n=window.localStorage.getItem(e);n&&(t=JSON.parse(n))}catch(e){}return t}var I;function A(e,t){if(n.editorLanguageMode=e,t!=pxt.Util.localeInfo()){const e=/^live-/;return e.test(t)&&pxt.Util.enableLiveLocalizationUpdates(),pxt.Util.updateLocalizationAsync({targetId:pxt.appTarget.id,baseUrl:pxt.webConfig.commitCdnUrl,code:t.replace(e,"")})}return Promise.resolve()}function w(e){let t=e.data;if(t)switch(t.type){case"fileloaded":let e=t,n=e.name,r=I.Blocks;/\.ts$/i.test(n)?r=I.TypeScript:/\.py$/i.test(n)&&(r=I.Python),A(r,e.locale);break;case"popout":let i=/((\/v[0-9+])\/)?[^\/]*#(doc|md):([^&?:]+)/i.exec(window.location.href);if(i){const e=pxt.webConfig.docsUrl||"/--docs";let t=i[2]||"",n="doc"==i[3]?pxt.webConfig.isStatic?`/docs${i[4]}.html`:`${i[4]}`:`${e}?md=${i[4]}`;window.parent&&window.parent.postMessage({type:"opendoc",url:pxt.BrowserUtils.urlJoin(t,n)},"*")}break;case"localtoken":let s=t;s&&s.localToken&&(pxt.Cloud.localToken=s.localToken,B.forEach((e=>e())),B=[])}}function N(e,t){return pxt.Cloud.privateGetTextAsync(t+"/text").then((e=>JSON.parse(e))).then((n=>D(e,n,t)))}function D(e,t,r=null,i=!1){const s=JSON.parse(t[pxt.CONFIG_NAME])||{};let o=`# ${s.name} ${s.version?s.version:""}\n\n`;t["README.md"]&&(o+=t["README.md"].replace(/^#+/,"$0#")+"\n"),s.files.filter((e=>e!=pxt.CONFIG_NAME&&"README.md"!=e)).filter((e=>function(e,t){switch(t){case I.Blocks:return/\.blocks?$/.test(e);case I.TypeScript:return/\.ts?$/.test(e);case I.Python:return/\.py?$/.test(e)}}(e,n.editorLanguageMode))).forEach((e=>{/^main\.(ts|blocks)$/.test(e)||(o+=`\n## ${e}\n`),/\.ts$/.test(e)?o+=`\`\`\`typescript\n${t[e]}\n\`\`\`\n`:/\.blocks?$/.test(e)?o+=`\`\`\`blocksxml\n${t[e]}\n\`\`\`\n`:o+=`\`\`\`${e.substr(e.indexOf("."))}\n${t[e]}\n\`\`\`\n`}));const a=s&&s.dependencies&&Object.keys(s.dependencies).filter((e=>e!=pxt.appTarget.corepkg));if(a&&a.length&&(o+=`\n## ${lf("Extensions")} #extensions\n\n${a.map((e=>`* ${e}, ${s.dependencies[e]}`)).join("\n")}\n\n\`\`\`package\n${a.map((e=>`${e}=${s.dependencies[e]}`)).join("\n")}\n\`\`\`\n`),r){let e=(pxt.appTarget.appTheme.shareUrl||"https://makecode.com/")+r;i&&(e="`"+e+"`"),o+=`\n${e}\n\n`}return console.debug(`print md: ${o}`),O(e,o,{print:!0})}pxt.react.getTilemapProject||(pxt.react.getTilemapProject=()=>(u||(u=new pxt.TilemapProject).loadPackage(n.mainPkg),u)),n.initHost=y,n.initFooter=function(e,t){if(!e)return;let n=pxt.appTarget.appTheme,r=$("body"),i=$(e),s=$("<a/>").attr("href",n.homeUrl).attr("target","_blank");i.append(s),n.organizationLogo?s.append($("<img/>").attr("src",pxt.Util.toDataUri(n.organizationLogo))):s.append(lf("powered by {0}",n.title)),r.mouseenter((e=>i.fadeOut())),r.mouseleave((e=>i.fadeIn()))},n.showError=b,n.generateHexFileAsync=function(e){return v(e.id).then((()=>k(!0,(t=>{e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code)})))).then((e=>(e.diagnostics&&e.diagnostics.length>0&&console.error("Diagnostics",e.diagnostics),e.outfiles[pxtc.BINARY_HEX])))},n.generateVMFileAsync=function(e){return pxt.setHwVariant("vm"),v(e.id).then((()=>k(!0,(t=>{e.code&&(t.fileSystem[pxt.MAIN_TS]=e.code)})))).then((e=>(console.log(e),e)))},n.simulateAsync=async function(e,t){var n,r;const i=t.builtJsInfo||await x(t)||await S(t),{js:s}=i;if(!s)return void console.error("Program failed to compile");const o=E(e,t,i);return d.options.messageSimulators=null===(r=null===(n=pxt.appTarget)||void 0===n?void 0:n.simulator)||void 0===r?void 0:r.messageSimulators,d.options.onSimulatorCommand=e=>{"restart"===e.command&&(o.storedState=C(t.id),d.run(s,o)),"setstate"==e.command&&e.stateKey&&function(e,t,n){let r=C(e);if(e){null!=n?r[t]=n:delete r[t];try{window.localStorage.setItem(e,JSON.stringify(r))}catch(e){}}}(t.id,e.stateKey,e.stateValue)},i.breakpoints&&t.debug&&d.setBreakpoints(i.breakpoints),d.run(s,o),i},n.preloadSim=function(e,t){var n,r;E(e,t),d.preload((null===(r=null===(n=pxt.appTarget)||void 0===n?void 0:n.simulator)||void 0===r?void 0:r.aspectRatio)||1,!0)},n.currentDriver=function(){return d},n.postSimMessage=function(e){null==d||d.postMessage(e)},n.fetchSimJsInfo=x,n.buildSimJsInfo=S,function(e){e[e.Blocks=0]="Blocks",e[e.TypeScript=1]="TypeScript",e[e.Python=2]="Python"}(I=n.LanguageMode||(n.LanguageMode={})),n.editorLanguageMode=I.Blocks,n.setEditorContextAsync=A,n.startRenderServer=function(){pxt.tickEvent("renderer.ready");const e=[];let t;(0,i.initEditorExtensionsAsync)().then((()=>{window.addEventListener("message",(function(n){const i=n.data;"renderblocks"==i.type&&(e.push(i),function n(){if(t)return;const i=e.shift();if(!i)return;const s=i.options||{};s.splitSvg=!1,pxt.tickEvent("renderer.job");const o=/^\s*<xml/.test(i.code);t=(async()=>{const e=(o?await F(i.code,s):await P(i.code,i.options)).blocksSvg,t=e.viewBox.baseVal.width,n=e.viewBox.baseVal.height,a=e?await(0,r.blocklyToSvgAsync)(e,0,0,t,n):void 0;let l;try{l=a?await pxt.BrowserUtils.encodeToPngAsync(a.xml,{width:t,height:n}):void 0}catch(e){console.warn(e)}window.parent.postMessage({source:"makecode",type:"renderblocks",id:i.id,width:null==a?void 0:a.width,height:null==a?void 0:a.height,svg:null==a?void 0:a.svg,uri:l||(null==a?void 0:a.xml),css:null==a?void 0:a.css},"*")})().catch((e=>{window.parent.postMessage({source:"makecode",type:"renderblocks",id:i.id,error:e.message},"*")})).finally((()=>{t=void 0,n()}))}())}),!1),window.parent.postMessage({source:"makecode",type:"renderready",versions:pxt.appTarget.versions},"*")}))},n.startDocsServer=function(e,t,n){pxt.tickEvent("docrenderer.ready");const r=[];function s(e,t){t?(pxsim.U.addClass(e,"disabled"),e.setAttribute("aria-disabled","true")):(pxsim.U.removeClass(e,"disabled"),e.setAttribute("aria-disabled","false"))}async function o(){let i=/^#(doc|md|tutorial|book|project|projectid|print):([^&?:]+)(:([^&?:]+):([^&?:]+))?/i.exec(window.location.hash);if(i){if(n&&(r.push(window.location.hash),r.length>10&&r.shift(),r.length>1&&s(n,!1)),i[4]){let e=I.TypeScript;/^blocks$/i.test(i[4])?e=I.Blocks:/^python$/i.test(i[4])&&(e=I.Python),await A(e,i[5])}!function r(i,s){pxt.debug(`rendering ${i}`),n&&$(n).hide(),$(t).hide(),$(e).show(),pxt.U.delay(100).then((()=>{switch(i){case"print":const e=window.localStorage.printjob;return delete window.localStorage.printjob,D(t,JSON.parse(e),void 0,!0).then((()=>pxsim.print(1e3)));case"project":return D(t,JSON.parse(s)).then((()=>pxsim.print(1e3)));case"projectid":return N(t,JSON.parse(s)).then((()=>pxsim.print(1e3)));case"doc":return async function(e,t){t=t.replace(/^\//,"");const n=await pxt.Cloud.markdownAsync(t,void 0,!0);try{await O(e,n,{path:t})}catch(e){console.warn(e)}}(t,s);case"book":return function(e,t){let n;return t=t.replace(/^\//,""),pxt.tickEvent("book",{id:t}),pxt.log(`rendering book from ${t}`),$("#loading").find(".loader").addClass("text").text(lf("Compiling your book (this may take a minute)")),pxt.U.delay(100).then((()=>pxt.Cloud.markdownAsync(t,void 0,!0))).then((e=>{n=pxt.docs.buildTOC(e),pxt.log(`TOC: ${JSON.stringify(n,null,2)}`);const t=[];return pxt.docs.visitTOC(n,(e=>{/^\//.test(e.path)&&!/^\/pkg\//.test(e.path)&&t.push(e)})),pxt.U.promisePoolAsync(4,t,(async e=>{try{const t=await pxt.Cloud.markdownAsync(e.path,void 0,!0);e.markdown=t}catch(t){e.markdown=`_${e.path} failed to load._`}}))})).then((t=>{let r=n[0].name;return pxt.docs.visitTOC(n,(e=>{e.markdown&&(r+="\n\n"+e.markdown)})),O(e,r)}))}(t,s);default:return O(t,s)}})).catch((e=>{$(t).html(`\n                <img style="height:4em;" src="${pxt.appTarget.appTheme.docsLogo}" />\n                <h1>${lf("Oops")}</h1>\n                <h3>${lf("We could not load the documentation, please check your internet connection.")}</h3>\n                <button class="ui button primary" id="tryagain">${lf("Try Again")}</button>`),$(t).find("#tryagain").click((()=>{r(i,s)})),window.parent&&window.parent.postMessage({type:"docfailed",docType:i,src:s},"*")})).finally((()=>{$(e).hide(),n&&$(n).show(),$(t).show()})).then((()=>{}))}(i[1],decodeURIComponent(i[2]))}}n&&(n.addEventListener("click",(()=>{n&&(r.length>1&&(r.pop(),window.location.hash=r.pop()),r.length<=1&&s(n,!0))})),s(n,!0)),(0,i.initEditorExtensionsAsync)().then((()=>{window.addEventListener("message",w,!1),window.addEventListener("hashchange",(()=>{o()}),!1),parent.postMessage({type:"sidedocready"},"*"),setTimeout((()=>o()),1)}))},n.renderProjectAsync=N,n.renderProjectFilesAsync=D;function O(e,t,r={}){const i=pxt.docs.renderMarkdown({template:'\n<aside id=button class=box>\n<a class="ui primary button" href="@ARGS@">@BODY@</a>\n</aside>\n\n<aside id=vimeo>\n<div class="ui two column stackable grid container">\n<div class="column">\n<div class="ui embed mdvid" data-source="vimeo" data-id="@ARGS@" data-placeholder="/thumbnail/1024/vimeo/@ARGS@" data-icon="video play">\n</div>\n</div></div>\n</aside>\n\n<aside id=youtube>\n<div class="ui two column stackable grid container">\n<div class="column">\n<div class="ui embed mdvid" data-source="youtube" data-id="@ARGS@" data-placeholder="https://img.youtube.com/vi/@ARGS@/0.jpg">\n</div>\n</div></div>\n</aside>\n\n<aside id=section>\n\x3c!-- section @ARGS@ --\x3e\n</aside>\n\n<aside id=hide class=box>\n<div style=\'display:none\'>\n    @BODY@\n</div>\n</aside>\n\n<aside id=avatar class=box>\n<div class=\'avatar @ARGS@\'>\n    <div class=\'avatar-image\'></div>\n    <div class=\'ui compact message\'>\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=hint class=box>\n<div class="ui info message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=codecard class=box>\n<pre><code class="lang-codecard">@BODY@</code></pre>\n</aside>\n\n<aside id=tutorialhint class=box>\n<div class="ui hint message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=reminder class=box>\n<div class="ui warning message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=alert class=box>\n<div class="ui negative message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n<aside id=tip class=box>\n<div class="ui positive message">\n    <div class="content">\n        @BODY@\n    </div>\n</div>\n</aside>\n\n\x3c!-- wrapped around ordinary content --\x3e\n<aside id=main-container class=box>\n<div class="ui text">\n    @BODY@\n</div>\n</aside>\n\n\x3c!-- used for \'column\' box - they are collected and wrapped in \'column-container\' --\x3e\n<aside id=column class=aside>\n<div class=\'column\'>\n    @BODY@\n</div>\n</aside>\n<aside id=column-container class=box>\n<div class="ui three column stackable grid text">\n    @BODY@\n</div>\n</aside>\n@breadcrumb@\n@body@',markdown:t,theme:pxt.appTarget.appTheme});let o=r.blocksAspectRatio||window.innerHeight<window.innerWidth?1.62:1/1.62;$(e).html(i),$(e).find("a").attr("target","_blank");const a=(0,s.defaultClientRenderOptions)();return a.tutorial=!!r.tutorial,a.blocksAspectRatio=o||a.blocksAspectRatio,a.showJavaScript=n.editorLanguageMode==I.TypeScript,r.print&&(a.showEdit=!1,a.simulator=!1),(0,s.renderAsync)(a).then((()=>{$(e).find('a[href^="/"]').removeAttr("target").each(((e,t)=>{$(t).attr("href","#doc:"+$(t).attr("href").replace(/^\//,""))})),$(e).find(".ui.embed").embed()}))}let R,L;function P(e,t){const{assets:i,forceCompilation:s,snippetMode:o,generateSourceMap:a}=t||{};return v(t&&t.packageId?"pub:"+t.packageId:t&&t.package?"docs:"+t.package:null,e).then((()=>T(!!pxt.appTarget.compile&&pxt.appTarget.compile.hasHex))).then((l=>{if(e&&(l.fileSystem[pxt.MAIN_TS]=e),l.ast=!0,i)for(const e of Object.keys(i))l.sourceFiles.indexOf(e)<0&&l.sourceFiles.push(e),l.fileSystem[e]=i[e];let c,d,p;s?(d=pxtc.compile(l),c=d&&d.ast):c=pxtc.getTSProgram(l,R),R=c,pxt.appTarget.appTheme.python&&(p=ts.pxtc.transpile.tsToPy(c,pxt.MAIN_TS));let h=M(c,l);return ts.pxtc.localizeApisAsync(h,n.mainPkg).then((()=>{let e=pxtc.getBlocksInfo(h);(0,r.initializeAndInject)(e);const s=null==i?void 0:i[pxt.TILEMAP_JRES],l=null==i?void 0:i[pxt.IMAGES_JRES];(s||l)&&((u=new pxt.TilemapProject).loadPackage(n.mainPkg),s&&u.loadTilemapJRes(JSON.parse(s),!0),l&&u.loadAssetsJRes(JSON.parse(l)));let f=pxtc.decompiler.decompileToBlocks(e,c.getSourceFile(pxt.MAIN_TS),{snippetMode:o,generateSourceMap:a});if(f.diagnostics&&f.diagnostics.length>0&&f.diagnostics.forEach((e=>console.error(e.messageText))),!f.success)return{package:n.mainPkg,compileProgram:c,compileJS:d,compileBlocks:f,apiInfo:h};pxt.debug(f.outfiles[pxt.MAIN_BLOCKS]);const m=(0,r.render)(f.outfiles[pxt.MAIN_BLOCKS],t);return(s||l)&&(u=null),{package:n.mainPkg,compileProgram:c,compileJS:d,compileBlocks:f,compilePython:p,apiInfo:h,blocksSvg:m}}))}))}function M(e,t){L||(L={});const n=Object.keys(t.fileSystem).sort().join(";");return L[n]||(L[n]=pxtc.getApiInfo(e,t.jres)),L[n]}function F(e,t){const{assets:i}=t||{};return v(t&&t.packageId?"pub:"+t.packageId:t&&t.package?"docs:"+t.package:null,"").then((()=>T(!!pxt.appTarget.compile&&pxt.appTarget.compile.hasHex))).then((s=>{if(s.ast=!0,i)for(const e of Object.keys(i))s.sourceFiles.indexOf(e)<0&&s.sourceFiles.push(e),s.fileSystem[e]=i[e];const o=M(pxtc.compile(s).ast,s);return ts.pxtc.localizeApisAsync(o,n.mainPkg).then((()=>{const s=pxtc.getBlocksInfo(o);(0,r.initializeAndInject)(s);const a=null==i?void 0:i[pxt.TILEMAP_JRES],l=null==i?void 0:i[pxt.IMAGES_JRES];(a||l)&&((u=new pxt.TilemapProject).loadPackage(n.mainPkg),a&&u.loadTilemapJRes(JSON.parse(a),!0),l&&u.loadAssetsJRes(JSON.parse(l)));const c=(0,r.render)(e,t);return(a||l)&&(u=null),{package:n.mainPkg,blocksSvg:c,apiInfo:o}}))}))}n.renderMarkdownAsync=O,n.decompileSnippetAsync=P,n.compileBlocksAsync=F;let B=[];let U=[];n.setInitCallbacks=function(e){U=e},n.init=function(){g().then((()=>{for(let e=0;e<U.length;++e)U[e]()}))}},{"../pxtblocks":68,"../pxteditor/editor":130,"./renderer":144,blockly:154}],146:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.IFrameEmbeddedClient=void 0;n.IFrameEmbeddedClient=class{constructor(e){this.messageHandler=e,this.onMessageReceived=e=>{const t=e.data;if(t){if("iframeclientsetmessageport"===t.type)return this.port=e.ports[0],this.port.onmessage=this.onMessageReceived,void this.postMessage({type:"iframeclientsetmessageport"});if("iframeclientready"===t.type)return void this.sendReadyMessage()}this.messageHandler(e)},this.frameId=function(){const e=/frameid=([a-zA-Z0-9\-]+)/i.exec(window.location.href);if(e)return e[1]}(),window.addEventListener("message",this.onMessageReceived),this.sendReadyMessage()}dispose(){window.removeEventListener("message",this.onMessageReceived),this.port&&this.port.close()}postMessage(e){this.postMessageCore(e)}postMessageCore(e){this.frameId&&(e.frameId=this.frameId),this.port?this.port.postMessage(e):window.acquireVsCodeApi?window.acquireVsCodeApi().postMessage(e):window.parent.postMessage(e,"*")}sendReadyMessage(){this.postMessage({type:"iframeclientready"})}}},{}],147:[function(e,t,n){
/*! For license information please see index.js.LICENSE.txt */
!function(r,i){if("object"==typeof n&&"object"==typeof t)t.exports=i(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],i);else{var s=i("object"==typeof n?e("blockly/core"):r.Blockly);for(var o in s)("object"==typeof n?n:r)[o]=s[o]}}(this,(e=>(()=>{var t={573:t=>{t.exports=e}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,r),s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{r.r(i),r.d(i,{WorkspaceSearch:()=>n});var e=r(573);const t=function(){let e=!1;return function(){if(e)return;e=!0;const t=document.createElement("style");t.id="blockly-ws-search-style";const n=document.createTextNode("path.blocklyPath.blockly-ws-search-highlight {\n    fill: #000;\n  }\n  path.blocklyPath.blockly-ws-search-highlight.blockly-ws-search-current {\n    fill: grey;\n  }\n  .blockly-ws-search-close-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=) no-repeat top left;\n  }\n  .blockly-ws-search-next-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSA4LjU5TDEyIDEzLjE3bDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNiAxLjQxLTEuNDF6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PC9zdmc+) no-repeat top left;\n  }\n  .blockly-ws-search-previous-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSAxNS40MUwxMiAxMC44M2w0LjU5IDQuNThMMTggMTRsLTYtNi02IDZ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==) no-repeat top left;\n  }\n  .blockly-ws-search {\n    background: #fff;\n    border: solid lightgrey 0.5px;\n    box-shadow: 0px 10px 20px grey;\n    justify-content: center;\n    padding: 0.25em;\n    position: absolute;\n    z-index: 70;\n  }\n  .blockly-ws-search-input input {\n    border: none;\n  }\n  .blockly-ws-search button {\n    border: none;\n  }\n  .blockly-ws-search-actions {\n    display: flex;\n  }\n  .blockly-ws-search-container {\n    display: flex;\n  }\n  .blockly-ws-search-content {\n    display: flex;\n  }");t.appendChild(n),document.head.insertBefore(t,document.head.firstChild)}}();class n{constructor(e){this.workspace=e,this.id="workspaceSearch",this.htmlDiv=null,this.actionDiv=null,this.inputElement=null,this.textInputPlaceholder="Search",this.blocks=[],this.currentBlockIndex=-1,this.searchText="",this.searchOnInput=!0,this.caseSensitive=!1,this.preserveSelected=!0,this.boundEvents=[]}init(){this.workspace.getComponentManager().addComponent({component:this,weight:0,capabilities:[e.ComponentManager.Capability.POSITIONABLE]}),t(),this.createDom(),this.setVisible(!1),this.workspace.resize()}dispose(){for(const t of this.boundEvents)e.browserEvents.unbind(t);this.boundEvents.length=0,this.htmlDiv&&(this.htmlDiv.remove(),this.htmlDiv=null),this.actionDiv=null,this.inputElement=null}createDom(){const t=this.workspace.getInjectionDiv();this.addEvent(t,"keydown",this,(e=>this.onWorkspaceKeyDown(e))),this.htmlDiv=document.createElement("div"),e.utils.dom.addClass(this.htmlDiv,"blockly-ws-search");const n=document.createElement("div");e.utils.dom.addClass(n,"blockly-ws-search-container");const r=document.createElement("div");e.utils.dom.addClass(r,"blockly-ws-search-content"),n.appendChild(r);const i=document.createElement("div");e.utils.dom.addClass(i,"blockly-ws-search-input"),this.inputElement=this.createTextInput(),this.addEvent(this.inputElement,"keydown",this,(e=>this.onKeyDown(e))),this.addEvent(this.inputElement,"input",this,(()=>this.onInput())),this.addEvent(this.inputElement,"click",this,(()=>{this.searchAndHighlight(this.searchText,this.preserveSelected),this.inputElement.select()})),i.appendChild(this.inputElement),r.appendChild(i),this.actionDiv=document.createElement("div"),e.utils.dom.addClass(this.actionDiv,"blockly-ws-search-actions"),r.appendChild(this.actionDiv);const s=this.createNextBtn();s&&this.addActionBtn(s,(()=>this.next()));const o=this.createPreviousBtn();o&&this.addActionBtn(o,(()=>this.previous()));const a=this.createCloseBtn();a&&(this.addBtnListener(a,(()=>this.close())),n.appendChild(a)),this.htmlDiv.appendChild(n),t.insertBefore(this.htmlDiv,this.workspace.getParentSvg())}addEvent(t,n,r,i){const s=e.browserEvents.conditionalBind(t,n,r,i);this.boundEvents.push(s)}addActionBtn(e,t){this.addBtnListener(e,t),this.actionDiv.appendChild(e)}createTextInput(){const e=document.createElement("input");return e.type="text",e.setAttribute("placeholder",this.textInputPlaceholder),e}createNextBtn(){return this.createBtn("blockly-ws-search-next-btn","Find next")}createPreviousBtn(){return this.createBtn("blockly-ws-search-previous-btn","Find previous")}createCloseBtn(){return this.createBtn("blockly-ws-search-close-btn","Close search bar")}createBtn(t,n){const r=document.createElement("button");return e.utils.dom.addClass(r,t),r.setAttribute("aria-label",n),r}addBtnListener(e,t){this.addEvent(e,"click",this,t),this.addEvent(e,"keydown",this,(e=>{"Enter"===e.key?(t(e),e.preventDefault()):"Escape"===e.key&&this.close(),e.stopPropagation()}))}getBoundingRectangle(){return null}position(t,n){this.workspace.RTL?this.htmlDiv.style.left=t.absoluteMetrics.left+"px":t.toolboxMetrics.position===e.TOOLBOX_AT_RIGHT?this.htmlDiv.style.right=t.toolboxMetrics.width+"px":this.htmlDiv.style.right="0",this.htmlDiv.style.top=t.absoluteMetrics.top+"px"}onInput(){if(this.searchOnInput){const e=this.inputElement.value.trim();e!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}}onKeyDown(e){if("Escape"===e.key)this.close();else if("Enter"===e.key)if(this.searchOnInput)this.next();else{const e=this.inputElement.value.trim();e!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}}onWorkspaceKeyDown(e){(e.ctrlKey||e.metaKey)&&"f"===e.key&&(this.open(),e.preventDefault(),e.stopPropagation())}previous(){this.setCurrentBlock(this.currentBlockIndex-1)}next(){this.setCurrentBlock(this.currentBlockIndex+1)}setSearchPlaceholder(e){this.textInputPlaceholder=e,this.inputElement&&this.inputElement.setAttribute("placeholder",this.textInputPlaceholder)}setCurrentBlock(e){if(!this.blocks.length)return;let t=this.blocks[this.currentBlockIndex];t&&this.unhighlightCurrentSelection(t),this.currentBlockIndex=(e%this.blocks.length+this.blocks.length)%this.blocks.length,t=this.blocks[this.currentBlockIndex],this.highlightCurrentSelection(t),this.workspace.centerOnBlock(t.id,!1)}open(){this.setVisible(!0),this.inputElement.focus(),this.searchText&&this.searchAndHighlight(this.searchText)}close(){this.setVisible(!1),this.workspace.markFocused(),this.clearBlocks()}setVisible(e){this.htmlDiv.style.display=e?"flex":"none"}searchAndHighlight(e,t){const n=this.blocks[this.currentBlockIndex];this.searchText=e.trim(),this.clearBlocks(),this.blocks=this.getMatchingBlocks(this.workspace,this.searchText,this.caseSensitive),this.highlightSearchGroup(this.blocks);let r=0;t&&(r=this.blocks.indexOf(n),r=r>-1?r:0),this.setCurrentBlock(r)}getSearchPool(e){return e.getAllBlocks(!0).filter((e=>{const t=e.getSurroundParent();return!t||!t.isCollapsed()}))}isBlockMatch(e,t,n){let r="";if(e.isCollapsed())r=e.toString();else{const t=[];e.inputList.forEach((e=>{e.fieldRow.forEach((e=>{t.push(e.getText())}))})),r=t.join(" ").trim()}return n||(r=r.toLowerCase()),r.indexOf(t)>-1}getMatchingBlocks(e,t,n){return t?(this.caseSensitive||(t=t.toLowerCase()),this.getSearchPool(e).filter((e=>this.isBlockMatch(e,t,n)))):[]}clearBlocks(){this.unhighlightSearchGroup(this.blocks);const e=this.blocks[this.currentBlockIndex];e&&this.unhighlightCurrentSelection(e),this.currentBlockIndex=-1,this.blocks=[]}highlightCurrentSelection(t){const n=t.pathObject.svgPath;e.utils.dom.addClass(n,"blockly-ws-search-current")}unhighlightCurrentSelection(t){const n=t.pathObject.svgPath;e.utils.dom.removeClass(n,"blockly-ws-search-current")}highlightSearchGroup(t){t.forEach((t=>{const n=t.pathObject.svgPath;e.utils.dom.addClass(n,"blockly-ws-search-highlight")}))}unhighlightSearchGroup(t){t.forEach((t=>{const n=t.pathObject.svgPath;e.utils.dom.removeClass(n,"blockly-ws-search-highlight")}))}}})(),i})()))},{"blockly/core":153}],148:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./blockly_compressed"],i):"object"==typeof n?t.exports=e("./blockly_compressed"):r.Blockly=r.Blockly}(this,(function(e){return e}))},{"./blockly_compressed":149}],149:[function(e,t,n){(function(e){(function(){!function(e,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof n?t.exports=r():e.Blockly=r()}(this,(function(){var t,n,r,i,s,o,a,l,c,u,d,p,h,f,m,_,g,y,b,v,T,k,E,x,S,C,I,A,w,N,D,O,R,L,P,M,F,$,B,U,V,H,G,j,K,W,z,q,J,Y,X,Q,Z,ee,te,ne,re,ie,se,oe,ae,le,ce,ue,de,pe,he,fe,me,_e,ge,ye,be,ve,Te,ke,Ee,xe,Se,Ce,Ie,Ae,we,Ne,De,Oe,Re,Le,Pe,Me,Fe,$e,Be,Ue,Ve,He,Ge,je,Ke,We,ze,qe,Je,Ye,Xe,Qe,Ze,et,tt,nt,rt,it,st,ot,at,lt,ct,ut,dt,pt,ht,ft,mt,_t,gt,yt,bt,vt,Tt,kt,Et,xt,St,Ct,It,At,wt,Nt,Dt,Ot,Rt,Lt,Pt,Mt,Ft,$t,Bt,Ut,Vt,Ht,Gt,jt,Kt,Wt,zt,qt,Jt,Yt,Xt,Qt,Zt,en,tn,nn,rn,sn,on,an,ln,cn,un,dn,pn,hn,fn,mn,_n,gn,yn,bn,vn,Tn,kn,En,xn,Sn,Cn,In,An,wn,Nn,Dn,On,Rn,Ln,Pn,Mn,Fn,$n,Bn,Un,Vn,Hn,Gn,jn,Kn,Wn,zn,qn,Jn,Yn,Xn,Qn,Zn,er,tr,nr,rr,ir,sr,or,ar,lr,cr,ur,dr,pr,hr,fr,mr,_r,gr,yr,br,vr,Tr,kr,Er,xr,Sr,Cr,Ir,Ar,wr,Nr,Dr,Or,Rr,Lr,Pr,Mr,Fr,$r,Br,Ur,Vr,Hr,Gr,jr,Kr,Wr,zr,qr,Jr,Yr,Xr,Qr,Zr,ei,ti,ni,ri,ii,si,oi,ai,li,ci,ui,di,pi,hi,fi,mi,_i,gi,yi,bi,vi,Ti,ki,Ei,xi,Si,Ci,Ii,Ai,wi,Ni,Di,Oi,Ri,Li,Pi,Mi,Fi,$i,Bi,Ui,Vi,Hi,Gi,ji,Ki,Wi,zi,qi,Ji,Yi,Xi,Qi,Zi,es,ts,ns,rs,is,ss,os,as,ls,cs,us,ds,ps,hs,fs,ms,_s,gs,ys,bs,vs,Ts,ks,Es,xs,Ss,Cs,Is,As,ws,Ns,Ds,Os,Rs,Ls,Ps,Ms,Fs,$s,Bs,Us,Vs,Hs,Gs,js,Ks,Ws,zs,qs,Js,Ys,Xs,Qs,Zs,eo,to,no,ro,io,so,oo,ao,lo,co,uo,po,ho,fo,mo,_o,go,yo,bo,vo,To,ko,Eo,xo,So,Co,Io,Ao,wo,No,Do,Oo,Ro,Lo,Po={};t=function(e,t,r,i){if(!(e instanceof Uo)&&"string"!=typeof e||""===`${e}`.trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const s=t.toLowerCase();if(!r)throw Error("Can not register a null value");let o=Mo[e],a=$o[e];if(o||(o=Mo[e]=Object.create(null),a=$o[e]=Object.create(null)),n(e,r),!i&&o[s])throw Error('Name "'+s+'" with type "'+e+'" already registered.');o[s]=r,a[s]=t},n=function(e,t){switch(e){case String(Uo.FIELD):if("function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')}},r=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const n=Mo[e];n&&n[t]?(delete Mo[e][t],delete $o[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},i=function(e,t,n){e=`${e}`.toLowerCase(),t=t.toLowerCase();const r=Mo[e];if(!r||!r[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",n)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return r[t]},s=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),!!(e=Mo[e])&&!!e[t]},o=function(e,t,n){return i(e,t,n)},a=function(e,t,n){return i(e,t,n)},l=function(e,t,n){e=`${e}`.toLowerCase();var r=Mo[e];if(!r){if(r=`Unable to find [${e}] in the registry.`,n)throw Error(`${r} You must require or register a ${e} plugin.`);return console.warn(r),null}if(!t)return r;e=$o[e],n=Object.create(null);for(const t of Object.keys(r))n[e[t]]=r[t];return n},c=function(e,t,n){return"function"==typeof(t=t.plugins[String(e)]||Bo)?t:o(e,t,n)},u=function(e){return Ko[e]||null},d=function(){const e=[];for(const t in Ko)e.push(Ko[t]);return e},p=function(e){Ko[e.id]=e},h=function(e){delete Ko[e.id]},f=function(){return Ho},m=function(e){Ho=e},_=function(){return Wo},g=function(e){Wo=e},y=function(){return Go},b=function(e){Go=e},v=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),n=e.getCachedParentSvgSize();var r=t.parentElement;if(r instanceof HTMLElement){var i=r.offsetWidth;r=r.offsetHeight,n.width!==i&&(t.setAttribute("width",i+"px"),e.setCachedParentSvgSize(i,null)),n.height!==r&&(t.setAttribute("height",r+"px"),e.setCachedParentSvgSize(null,r)),e.resize()}},T=function(e,t){const n=Object.create(null),r=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=r.indexOf(e),r.splice(e,r.length-e));for(let e,t=0;e=r[t];t++)n[e.type]?n[e.type]++:n[e.type]=1;return n},k=function(e){return function(){this.jsonInit(e)}},E=function(e){qo.defineBlocksWithJsonArrayInternal(e)},x=function(e){Po.defineBlocks$$module$build$src$core$common(Po.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},Po.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let n=0;n<e.length;n++){const r=e[n];if(!r){console.warn(`Block definition #${n} in JSON array is ${r}. Skipping`);continue}const i=r.type;i?t[i]={init:k(r)}:console.warn(`Block definition #${n} in JSON array is missing a type attribute. Skipping.`)}return t},Po.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const n=e[t];t in jo&&console.warn(`Block definiton "${t}" overwrites previous definition.`),jo[t]=n}},S=function(){return"blockly-"+(ha++).toString(36)},C=function(){return pa.genUid()},I=function(e){Xo=e},A=function(){return Xo},w=function(e){ua.fireInternal(e)},N=function(e){if(L()){if(!ca.length)try{requestAnimationFrame((()=>{setTimeout(D,0)}))}catch(e){setTimeout(D,0)}ca.push(e)}},D=function(){var e=O(ca,!0);ca.length=0;for(let n,r=0;n=e[r];r++)if(n.workspaceId){var t=u(n.workspaceId);t&&t.fireChangeListener(n)}e=new Set(e.map((e=>e.workspaceId)));for(const n of e){if(!n)continue;if(!(e=u(n)))continue;let r;for(t=(e=e.getUndoStack()).length;0<t;t--){const n=e[t-1];if(""===n.group)break;if(void 0===r)r=n.group;else if(n.group!==r)break}r&&t!=e.length-1&&(t=e.splice(t,e.length-t),t=O(t,!0),e.push(...t))}},O=function(e,t){e=e.slice(),t||e.reverse();const n=[],r=Object.create(null);for(let t,o=0;t=e[o];o++)if(!t.isNull()){var i=[t.isUiEvent?ta:t.type,t.blockId,t.workspaceId].join(" "),s=r[i];const e=s?s.event:null;s?t.type===Po.MOVE$$module$build$src$core$events$utils&&s.index===o-1?(i=t,e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,i.reason&&(e.reason?(i=new Set(i.reason.concat(e.reason)),e.reason=Array.from(i)):e.reason=i.reason),s.index=o):t.type===Po.CHANGE$$module$build$src$core$events$utils&&t.element===e.element&&t.name===e.name?e.newValue=t.newValue:t.type===ia?(s=t,e.viewTop=s.viewTop,e.viewLeft=s.viewLeft,e.scale=s.scale,e.oldScale=s.oldScale):t.type===na&&e.type===ra||(r[i]={event:t,index:o},n.push(t)):(r[i]={event:t,index:o},n.push(t))}e=n.filter((function(e){return!e.isNull()})),t||e.reverse();for(let t,n=1;t=e[n];n++)t.type===Po.CHANGE$$module$build$src$core$events$utils&&"mutation"===t.element&&e.unshift(e.splice(n,1)[0]);return e},R=function(){for(let e,t=0;e=ca[t];t++)e.recordUndo=!1},Po.disable$$module$build$src$core$events$utils=function(){Qo++},Po.enable$$module$build$src$core$events$utils=function(){Qo--},L=function(){return 0===Qo},Po.getGroup$$module$build$src$core$events$utils=function(){return Yo},Po.setGroup$$module$build$src$core$events$utils=function(e){ua.setGroupInternal(e)},P=function(e){Yo="boolean"==typeof e?e?C():"":e},M=function(e){const t=[];e=e.getDescendants(!1);for(let n,r=0;n=e[r];r++)t[r]=n.id;return t},F=function(e,t){const n=$(e.type);if(!n)throw Error("Unknown event type.");return n.fromJson(e,t)},$=function(e){const t=o(Uo.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},B=function(e){if((e.type===Po.MOVE$$module$build$src$core$events$utils||e.type===Po.CREATE$$module$build$src$core$events$utils)&&e.workspaceId){var t=u(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const n=Xo;try{Xo=!1;const r=e.getParent();if(r&&r.isEnabled()){const t=e.getDescendants(!1);for(let e,n=0;e=t[n];n++)e.setEnabled(!0)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do{e.setEnabled(!1),e=e.getNextBlock()}while(e)}finally{Xo=n}}}},U=function(e,t){V(),Pa=setTimeout((function(){t&&t.handleRightClick(e)}),Da)},V=function(){Pa&&(clearTimeout(Pa),Pa=0)},H=function(){Ra=null},G=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&K(e)},j=function(e){return`${e.pointerId}`},K=function(e){const t=j(e);return Ra?Ra===t:"pointerdown"===e.type&&(Ra=t,!0)},W=function(e,t,n,r,i){function s(e){(i||G(e))&&(n?r.call(n,e):r(e))}const o=[];if(t in La)for(let n=0;n<La[t].length;n++){const r=La[t][n];e.addEventListener(r,s,!1),o.push([e,r,s])}else e.addEventListener(t,s,!1),o.push([e,t,s]);return o},z=function(e,t,n,r){function i(e){n?r.call(n,e):r(e)}const s=[];if(t in La)for(let n=0;n<La[t].length;n++){const r=La[t][n];e.addEventListener(r,i,!1),s.push([e,r,i])}else e.addEventListener(t,i,!1),s.push([e,t,i]);return s},q=function(e){const t=e[e.length-1][2];for(;e.length;){const[t,n,r]=e.pop();t.removeEventListener(n,r,!1)}return t},J=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},Y=function(e){return!(!e.ctrlKey||!Ha)||2===e.button},X=function(e,t,n){const r=t.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,n||(n=t.getScreenCTM().inverse()),r.matrixTransform(n)},Q=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*Ka,y:e.deltaY*Ka};case 2:return{x:e.deltaX*Wa,y:e.deltaY*Wa}}},Z=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},ee=function(e){if(Xa)throw Error("CSS already injected");Qa+="\n"+e},te=function(e,t){Xa||(Xa=!0,e&&(e=t.replace(/[\\/]$/,""),t=Qa.replace(/<<<PATH>>>/g,e),Qa="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},ne=function(e,t,n,r){e=e+" was deprecated in "+t+" and will be deleted in "+n+".",r&&(e+="\nUse "+r+" instead."),tl.has(e)||(tl.add(e),console.warn(e))},re=function(e,t,n){e=document.createElementNS(il,`${e}`);for(const n in t)e.setAttribute(n,`${t[n]}`);return n&&n.appendChild(e),e},ie=function(e,t){return!(t=t.split(" ")).every((t=>e.classList.contains(t)))&&(e.classList.add(...t),!0)},se=function(e,t){e.classList.remove(...t.split(" "))},oe=function(e,t){return!(t=t.split(" ")).every((t=>!e.classList.contains(t)))&&(e.classList.remove(...t),!0)},ae=function(e,t){return e.classList.contains(t)},le=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},ce=function(e,t){const n=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");n?t.insertBefore(e,n):t.appendChild(e)},ue=function(e,t){return ne("Blockly.utils.dom.containsNode","version 10","version 11",'Use native "contains" DOM method'),e.contains(t)},de=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},pe=function(){ll++,al||(al=Object.create(null))},he=function(){--ll||(al=null)},fe=function(e){const t=e.textContent+"\n"+e.className.baseVal;let n;if(al&&(n=al[t]))return n;try{n=e.getComputedTextLength()}catch(t){return 8*e.textContent.length}return al&&(al[t]=n),n},me=function(e,t,n,r){return _e(e,t+"pt",n,r)},_e=function(e,t,n,r){const i=e.textContent;var s;return e=i+"\n"+e.className.baseVal,al&&(s=al[e])||(cl||((s=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(s),cl=s.getContext("2d")),cl.font=n+" "+t+" "+r,s=i?cl.measureText(i).width:0,al&&(al[e]=s)),s},ge=function(e,t,n,r){const i=document.createElement("span");i.style.font=n+" "+t+" "+r,i.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(i),t.appendChild(e),document.body.appendChild(t),n={height:0,baseline:0};try{t.style.alignItems="baseline",n.baseline=e.offsetTop-i.offsetTop,t.style.alignItems="flex-end",n.height=e.offsetTop-i.offsetTop}finally{document.body.removeChild(t)}return n},ye=function(e){return fl.getSizeInternal(e)},be=function(e){if("none"!==Te(e,"display"))return ve(e);const t=e.style,n=t.display,r=t.visibility,i=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const s=e.offsetWidth;return e=e.offsetHeight,t.display=n,t.position=i,t.visibility=r,new hl(s,e)},ve=function(e){return new hl(e.offsetWidth,e.offsetHeight)},Te=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},ke=function(e){const t=new el(0,0);e=e.getBoundingClientRect();var n=document.documentElement;return n=new el(window.pageXOffset||n.scrollLeft,window.pageYOffset||n.scrollTop),t.x=e.left+n.x,t.y=e.top+n.y,t},Ee=function(){const e=document.body,t=document.documentElement;return new el(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},xe=function(e){const t=parseFloat(Te(e,"borderLeftWidth")),n=parseFloat(Te(e,"borderRightWidth")),r=parseFloat(Te(e,"borderTopWidth"));return e=parseFloat(Te(e,"borderBottomWidth")),new pl(r,e,t,n)},Se=function(e,t,n){e=Ce(e,t,n),t.scrollLeft=e.x,t.scrollTop=e.y},Ce=function(e,t,n){var r=ke(e),i=ke(t),s=xe(t);const o=r.x-i.x-s.left;return r=r.y-i.y-s.top,i=ve(e),e=t.clientWidth-i.width,i=t.clientHeight-i.height,s=t.scrollLeft,t=t.scrollTop,n?(s+=o-e/2,t+=r-i/2):(s+=Math.min(o,Math.max(o-e,0)),t+=Math.min(r,Math.max(r-i,0))),new el(s,t)},Ie=function(e){const t=new el(0,0);var n=e.x&&e.getAttribute("x");const r=e.y&&e.getAttribute("y");return n&&(t.x=parseInt(n)),r&&(t.y=parseInt(r)),(n=(n=e.getAttribute("transform"))&&n.match(_l))&&(t.x+=Number(n[1]),n[3]&&(t.y+=Number(n[3]))),(e=e.getAttribute("style"))&&-1<e.indexOf("translate")&&(e=e.match(gl))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Ae=function(e){let t=0,n=0;for(;e;){const r=Ie(e);if(t+=r.x,n+=r.y,-1!==(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;e=e.parentNode}return new el(t,n)},we=function(){const e=Ee();return new pl(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Ne=function(){const e=document.documentElement,t=window;return new el(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},De=function(e,t){var n=t.x;t=t.y;const r=e.getInjectionDiv().getBoundingClientRect();return n=new el(n-r.left,t-r.top),t=e.getOriginOffsetInPixels(),el.difference(n,t).scale(1/e.scale)},Oe=function(e,t){var n=t.scale(e.scale);t=n.x,n=n.y;const r=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new el(t+r.left+e.x,n+r.top+e.y)},Re=function(e){({document:kl=kl,DOMParser:El=El,XMLSerializer:xl=xl}=e),vl=new El,Tl=new xl},Po.createElement$$module$build$src$core$utils$xml=function(e){return kl.createElementNS(Sl,e)},Po.createTextNode$$module$build$src$core$utils$xml=function(e){return kl.createTextNode(e)},Po.textToDom$$module$build$src$core$utils$xml=function(e){let t=vl.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=vl.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},Le=function(e){return Pe(Tl.serializeToString(e))},Pe=function(e){return e.replace(Cl,(e=>`&#${e.charCodeAt(0)};`))},Me=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=Ke(e),e=He(e)),Fe(e),e):null},Fe=function(e){const t=e.kind;if(e=e.contents,t&&t!==Nl&&t!==wl)throw Error("Invalid toolbox kind "+t+". Please supply either "+Nl+" or "+wl);if(!e)throw Error("Toolbox must have a contents attribute.")},$e=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:Ge(e):[]},Be=function(e){return Ll.hasCategoriesInternal(e)},Ue=function(e){if(!e)return!1;const t=e.kind;return t?t===wl:!!e.contents.filter((function(e){return"CATEGORY"===e.kind.toUpperCase()})).length},Ve=function(e){return!(!e||!e.contents||!e.contents.filter((function(e){return"CATEGORY"===e.kind.toUpperCase()})).length)},He=function(e){const t={contents:Ge(e)};return e instanceof Node&&je(e,t),t},Ge=function(e){const t=[];let n=e.childNodes;n||(n=e);for(let r,i=0;r=n[i];i++){if(!r.tagName)continue;e={};const n=r.tagName.toUpperCase();e.kind=n,"BLOCK"===n?e.blockxml=r:r.childNodes&&0<r.childNodes.length&&(e.contents=Ge(r)),je(r,e),t.push(e)}return t},je=function(e,t){for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n];-1<r.nodeName.indexOf("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[r.nodeName.replace("css-","")]=r.value):t[r.nodeName]=r.value}},Ke=function(e){let t=null;if(e)if("string"==typeof e){if("xml"!==(t=Po.textToDom$$module$build$src$core$utils$xml(e)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},We=function(e,t,n,r,i,s){const o=s.scrollbar&&s.scrollbar.canScrollVertically();return e.horizontal===Ol.LEFT?(n=i.absoluteMetrics.left+n,o&&s.RTL&&(n+=bl.scrollbarThickness)):(n=i.absoluteMetrics.left+i.viewMetrics.width-t.width-n,o&&!s.RTL&&(n-=bl.scrollbarThickness)),e.vertical===Dl.TOP?e=i.absoluteMetrics.top+r:(e=i.absoluteMetrics.top+i.viewMetrics.height-t.height-r,s.scrollbar&&s.scrollbar.canScrollHorizontally()&&(e-=bl.scrollbarThickness)),new pl(e,e+t.height,n,n+t.width)},ze=function(e,t){return{horizontal:t.toolboxMetrics.position===Al.LEFT||e.horizontalLayout&&!e.RTL?Ol.RIGHT:Ol.LEFT,vertical:t.toolboxMetrics.position===Al.BOTTOM?Dl.TOP:Dl.BOTTOM}},qe=function(e,t,n,r){const i=e.left,s=e.right-e.left,o=e.bottom-e.top;for(let a=0;a<r.length;a++){const l=r[a];e.intersects(l)&&(e=n===Rl.UP?l.top-o-t:l.bottom+t,e=new pl(e,e+o,i,i+s),a=-1)}return e},Je=function(e,t){jl(e,t)},Ye=function(e){jl=e},Xe=function(e,t){zl.confirmInternal(e,t)},Qe=function(e,t){Kl(e,t)},Ze=function(e){Kl=e},et=function(e,t,n){Wl(e,t,n)},tt=function(e){Wl=e},nt=function(e){return void 0!==e.getVariableModel},rt=function(e){return void 0!==e.getProcedureDef},it=function(e){return void 0!==e.getProcedureCall&&void 0!==e.renameProcedure},Po.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let n=0;n<e.length;n++){const r=e[n].getVarModels();if(r)for(let e=0;e<r.length;e++){const n=r[e];n.getId()&&t.add(n)}}return Array.from(t.values())},Po.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let r,i=0;r=e[i];i++){var n=r.getDeveloperVariables;if(n){n=n();for(let e=0;e<n.length;e++)t.add(n[e])}}return Array.from(t.values())},st=function(e){let t=[];const n=document.createElement("button");return n.setAttribute("text","%{BKY_NEW_VARIABLE}"),n.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",(function(e){ut(e.getTargetWorkspace())})),t.push(n),e=ot(e),t.concat(e)},ot=function(e){const t=[];if(0<(e=e.getVariablesOfType("")).length){var n=e[e.length-1];if(jo.variables_set){var r=Po.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","variables_set"),r.setAttribute("gap",jo.math_change?"8":"24"),r.appendChild(gt(n)),t.push(r)}if(jo.math_change&&((r=Po.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),r.setAttribute("gap",jo.variables_get?"20":"8"),r.appendChild(gt(n)),n=Po.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),r.appendChild(n),t.push(r)),jo.variables_get){e.sort(Ql.compareByName);for(let r,i=0;r=e[i];i++)(n=Po.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),n.setAttribute("gap","8"),n.appendChild(gt(r)),t.push(n)}}return t},at=function(e){return ec.generateUniqueNameInternal(e)},lt=function(e){return ct(Zl.charAt(0),e.getAllVariableNames())},ct=function(e,t){if(!t.length)return e;const n=Zl;let r="",i=n.indexOf(e);for(;;){let s=!1;for(let n=0;n<t.length;n++)if(t[n].toLowerCase()===e){s=!0;break}if(!s)break;++i===n.length&&(i=0,r=`${Number(r)+1}`),e=n.charAt(i)+r}return e},ut=function(e,t,n){const r=n||"";!function n(i){dt(Po.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,i,(function(i){if(i){var s=ht(i,e);if(s){if(s.type===r)var o=Po.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",s.name);else o=(o=Po.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",s.name).replace("%2",s.type);Je(o,(function(){n(i)}))}else e.createVariable(i,r),t&&t(i)}else t&&t(null)}))}("")},Po.renameVariable$$module$build$src$core$variables=function(e,t,n){!function r(i){const s=Po.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.name);dt(s,i,(function(i){if(i){var s=pt(i,t.type,e),o=ft(t.name,i,e);if(s||o){var a="";s?a=Po.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",s.name).replace("%2",s.type):o&&(a=Po.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",i).replace("%2",o)),Je(a,(function(){r(i)}))}else e.renameVariableById(t.getId(),i),n&&n(i)}else n&&n(null)}))}("")},dt=function(e,t,n){et(e,t,(function(e){e&&((e=e.replace(/[\s\xa0]+/g," ").trim())===Po.Msg$$module$build$src$core$msg.RENAME_VARIABLE||e===Po.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(e=null),n(e)}))},pt=function(e,t,n){n=n.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r,i=0;r=n[i];i++)if(r.name.toLowerCase()===e&&r.type!==t)return r;return null},ht=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let n,r=0;n=t[r];r++)if(n.name.toLowerCase()===e)return n;return null},ft=function(e,t,n){return n.getProcedureMap().getProcedures().length?mt(e,t,n):_t(e,t,n)},mt=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getProcedureMap().getProcedures();for(const i of n){var r=i.getParameters().filter(nt).map((e=>e.getVariableModel().name));if(r&&(n=r.some((t=>t.toLowerCase()===e)),r=r.some((e=>e.toLowerCase()===t)),n&&r))return i.getName()}return null},_t=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),n=n.getAllBlocks(!1);for(const i of n){if(!rt(i))continue;var r=(n=i.getProcedureDef())[1];const s=r.some((t=>t.toLowerCase()===e));if(r=r.some((e=>e.toLowerCase()===t)),s&&r)return n[0]}return null},gt=function(e){const t=Po.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=Po.createTextNode$$module$build$src$core$utils$xml(e.name),t.appendChild(e),t},Po.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,n,r){let i=Po.getVariable$$module$build$src$core$variables(e,t,n,r);return i||(i=yt(e,t,n,r)),i},Po.getVariable$$module$build$src$core$variables=function(e,t,n,r){const i=e.getPotentialVariableMap();let s=null;if(t&&(!(s=e.getVariableById(t))&&i&&(s=i.getVariableById(t)),s))return s;if(n){if(void 0===r)throw Error("Tried to look up a variable by name without a type");!(s=e.getVariable(n,r))&&i&&(s=i.getVariable(n,r))}return s},yt=function(e,t,n,r){const i=e.getPotentialVariableMap();return n||(n=at(e.isFlyout?e.targetWorkspace:e)),i?i.createVariable(n,r,t):e.createVariable(n,r,t)},bt=function(e,t){e=e.getAllVariables();const n=[];if(t.length!==e.length)for(let r=0;r<e.length;r++){const i=e[r];-1===t.indexOf(i)&&n.push(i)}return n},vt=function(e,n){t(Uo.PASTER,e,n)},Tt=function(e){r(Uo.PASTER,e)},kt=function(e){return Ct(e),St()?(It(),Promise.resolve()):(cc||(cc=new Promise((e=>{uc=e,dc=window.requestAnimationFrame((()=>{It(),e()}))}))),cc)},Et=function(){return cc||Promise.resolve()},xt=function(e){e||window.cancelAnimationFrame(dc),It(e),!e&&uc&&uc()},St=function(){return Fa},Ct=function(e){lc.add(e);const t=e.getParent();t?Ct(t):ac.add(e)},It=function(e){const t=e?new Set([e]):new Set([...ac].map((e=>e.workspace))),n=[...ac].filter(wt).filter((e=>t.has(e.workspace)));for(var r of n)Nt(r);for(const e of t)e.resizeContents();for(const e of n)r=e.getRelativeToSurfaceXY(),e.updateComponentLocations(r);for(const e of n)At(e);e||(cc=null)},At=function(e){ac.delete(e),lc.delete(e);for(const t of e.getChildren(!1))At(t)},wt=function(e){return!e.isDisposed()&&!e.getParent()},Nt=function(e){if(lc.has(e)){for(const t of e.getChildren(!1))Nt(t);e.renderEfficiently()}},Dt=function(e,t){const n=Po.createElement$$module$build$src$core$utils$xml("xml");var r=Ot(Po.allUsedVarModels$$module$build$src$core$variables(e));r.hasChildNodes()&&n.appendChild(r),r=e.getTopComments(!0);for(let e=0;e<r.length;e++)n.appendChild(r[e].toXmlWithXY(t));for(e=e.getTopBlocks(!0),r=0;r<e.length;r++)n.appendChild(Rt(e[r],t));return n},Ot=function(e){const t=Po.createElement$$module$build$src$core$utils$xml("variables");for(let n=0;n<e.length;n++){const r=e[n],i=Po.createElement$$module$build$src$core$utils$xml("variable");i.appendChild(Po.createTextNode$$module$build$src$core$utils$xml(r.name)),r.type&&i.setAttribute("type",r.type),i.id=r.getId(),t.appendChild(i)}return t},Rt=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let n=0;if(e.workspace.RTL&&(n=e.workspace.getWidth()),t=Mt(e,t),tn(t)){const r=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?n-r.x:r.x))),t.setAttribute("y",String(Math.round(r.y)))}return t},Lt=function(e){if(e.isSerializable()){const t=Po.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},Pt=function(e,t){for(let n=0;n<e.inputList.length;n++){const r=e.inputList[n];for(let e=0;e<r.fieldRow.length;e++){const n=Lt(r.fieldRow[e]);n&&t.appendChild(n)}}},Mt=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Mt(t):new DocumentFragment;const n=Po.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(n.setAttribute("type",e.type),t||(n.id=e.id),e.mutationToDom){var r=e.mutationToDom();r&&(r.hasChildNodes()||r.hasAttributes())&&n.appendChild(r)}if(Pt(e,n),r=e.getCommentText()){var i=e.getIcon(Vl.COMMENT),s=i.getBubbleSize();i=i.bubbleIsVisible();var o=Po.createElement$$module$build$src$core$utils$xml("comment");o.appendChild(Po.createTextNode$$module$build$src$core$utils$xml(r)),o.setAttribute("pinned",`${i}`),o.setAttribute("h",String(s.height)),o.setAttribute("w",String(s.width)),n.appendChild(o)}for(e.data&&((r=Po.createElement$$module$build$src$core$utils$xml("data")).appendChild(Po.createTextNode$$module$build$src$core$utils$xml(e.data)),n.appendChild(r)),r=0;r<e.inputList.length;r++){var a=void 0;if(i=!0,(s=e.inputList[r]).type!==Po.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&s.type!==Po.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){o=s.connection.targetBlock(),s.type===Po.inputTypes$$module$build$src$core$inputs$input_types.VALUE?a=Po.createElement$$module$build$src$core$utils$xml("value"):s.type===Po.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(a=Po.createElement$$module$build$src$core$utils$xml("statement"));const e=s.connection.getShadowDom();!e||o&&o.isShadow()||a.appendChild(Ft(e,t)),o&&(o=Mt(o,t)).nodeType===rl.ELEMENT_NODE&&(a.appendChild(o),i=!1),a.setAttribute("name",s.name),i||n.appendChild(a)}}let l;return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&n.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&n.setAttribute("collapsed","true"),e.isEnabled()||n.setAttribute("disabled","true"),e.isDeletable()||e.isShadow()||n.setAttribute("deletable","false"),e.isMovable()||e.isShadow()||n.setAttribute("movable","false"),e.isEditable()||n.setAttribute("editable","false"),(a=e.getNextBlock())&&(r=Mt(a,t)).nodeType===rl.ELEMENT_NODE&&((l=Po.createElement$$module$build$src$core$utils$xml("next")).appendChild(r),n.appendChild(l)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||a&&a.isShadow()||l.appendChild(Ft(e,t)),n},Ft=function(e,t){let n,r=e=e.cloneNode(!0);for(;r;)if(t&&"shadow"===r.nodeName&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){let e;n=r,r=r.parentNode,n.nodeType===rl.TEXT_NODE&&""===n.data.trim()&&(null==(e=r)?void 0:e.firstChild)!==n&&le(n)}r&&(n=r,r=r.nextSibling,n.nodeType===rl.TEXT_NODE&&""===n.data.trim()&&le(n))}return e},$t=function(e){return Le(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Bt=function(e){e=$t(e).split("<");let t="";for(let n=1;n<e.length;n++){const r=e[n];"/"===r[0]&&(t=t.substring(2)),e[n]=t+"<"+r,"/"!==r[0]&&"/>"!==r.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Ut=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=Po.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},Po.domToWorkspace$$module$build$src$core$xml=function(e,t){let n=0;t.RTL&&(n=t.getWidth());const r=[];pe();const i=Po.getGroup$$module$build$src$core$events$utils();i||Po.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let s=!0;try{for(let i,o=0;i=e.childNodes[o];o++){const e=i.nodeName.toLowerCase(),o=i;if("block"===e||"shadow"===e&&!A()){const e=Ht(o,t);let i;r.push(e.id);const a=parseInt(null!=(i=o.getAttribute("x"))?i:"10",10);let l;const c=parseInt(null!=(l=o.getAttribute("y"))?l:"10",10);isNaN(a)||isNaN(c)||e.moveBy(t.RTL?n-a:a,c,["create"]),s=!1}else{if("shadow"===e)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===e)t.rendered?oc.fromXmlRendered(o,t,n):nc.fromXml(o,t);else if("variables"===e){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Gt(o,t),s=!1}}}}finally{Po.setGroup$$module$build$src$core$events$utils(i),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&xt(),he()}return w(new($(aa))(t)),r},Vt=function(e,t){if(!t.getBlocksBoundingBox)return Po.domToWorkspace$$module$build$src$core$xml(e,t);var n=t.getBlocksBoundingBox();if(e=Po.domToWorkspace$$module$build$src$core$xml(e,t),n&&n.top!==n.bottom){var r=n.bottom;n=t.RTL?n.right:n.left;var i=1/0;let s=-1/0,o=1/0;for(let n=0;n<e.length;n++){const r=t.getBlockById(e[n]).getRelativeToSurfaceXY();r.y<o&&(o=r.y),r.x<i&&(i=r.x),r.x>s&&(s=r.x)}for(r=r-o+10,n=t.RTL?n-s:n-i,i=0;i<e.length;i++)t.getBlockById(e[i]).moveBy(n,r,["create"])}return e},Po.domToBlock$$module$build$src$core$xml=function(e,t){return e=Ht(e,t),t.rendered&&xt(),e},Ht=function(e,t){Po.disable$$module$build$src$core$events$utils();var n=t.getAllVariables();let r;try{if(r=Qt(e,t),t.rendered){const e=r,n=r.getDescendants(!1);e.setConnectionTracking(!1);for(let e=n.length-1;0<=e;e--)n[e].initSvg();for(let e=n.length-1;0<=e;e--)n[e].queueRender();setTimeout((function(){e.disposed||e.setConnectionTracking(!0)}),1),t.resizeContents()}else{const e=r.getDescendants(!1);for(let t=e.length-1;0<=t;t--)e[t].initModel()}}finally{Po.enable$$module$build$src$core$events$utils()}if(L()){for(e=bt(t,n),t=0;t<e.length;t++)n=e[t],w(new($(ea))(n));w(new($(Po.CREATE$$module$build$src$core$events$utils))(r))}return r},Gt=function(e,t){for(let r=0;r<e.children.length;r++){var n=e.children[r];const i=n.getAttribute("type"),s=n.getAttribute("id");if(!(n=n.textContent))break;t.createVariable(n,i,s)}},jt=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let n=0;n<e.children.length;n++){const r=e.children[n];if(r.nodeType!==rl.TEXT_NODE)switch(r.nodeName.toLowerCase()){case"mutation":t.mutation.push(r);break;case"comment":t.comment.push(r);break;case"data":t.data.push(r);break;case"title":case"field":t.field.push(r);break;case"value":case"statement":t.input.push(r);break;case"next":t.next.push(r);break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}}return t},Kt=function(e,t){let n=!1;for(let r=0;r<e.length;r++){const i=e[r];t.domToMutation&&(t.domToMutation(i),t.initSvg&&(n=!0))}return n},Wt=function(e,t){for(let r=0;r<e.length;r++){var n=e[r];const i=n.textContent,s="true"===n.getAttribute("pinned");let o;const a=parseInt(null!=(o=n.getAttribute("w"))?o:"50",10);let l;n=parseInt(null!=(l=n.getAttribute("h"))?l:"50",10),t.setCommentText(i);const c=t.getIcon(Vl.COMMENT);isNaN(a)||isNaN(n)||c.setBubbleSize(new hl(a,n)),c.setBubbleVisible(s),setTimeout((()=>c.setBubbleVisible(s)),1)}},zt=function(e,t){for(let n=0;n<e.length;n++)t.data=e[n].textContent},qt=function(e,t){for(let n=0;n<e.length;n++){const r=e[n],i=r.getAttribute("name");i?Zt(t,i,r):console.warn(`Ignoring unnamed field in block ${t.type}`)}},Jt=function(e){let t=null,n=null;for(let r=0;r<e.childNodes.length;r++){const i=e.childNodes[r];tn(i)&&("block"===i.nodeName.toLowerCase()?t=i:"shadow"===i.nodeName.toLowerCase()&&(n=i))}return{childBlockElement:t,childShadowElement:n}},Yt=function(e,t,n,r){for(let s=0;s<e.length;s++){var i=e[s];const o=i.getAttribute("name"),a=o?n.getInput(o):null;if(!a){console.warn("Ignoring non-existent input "+o+" in block "+r);break}if((i=Jt(i)).childBlockElement){if(!a.connection)throw TypeError("Input connection does not exist.");Qt(i.childBlockElement,t,a.connection,!1)}if(i.childShadowElement){let e;null==(e=a.connection)||e.setShadowDom(i.childShadowElement)}}},Xt=function(e,t,n){for(let r=0;r<e.length;r++){const i=Jt(e[r]);if(i.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Qt(i.childBlockElement,t,n.nextConnection,!0)}i.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(i.childShadowElement)}},Qt=function(e,t,n,r){var i;const s=e.getAttribute("type");if(!s)throw TypeError("Block type unspecified: "+e.outerHTML);var o=null!=(i=e.getAttribute("id"))?i:void 0;i=t.newBlock(s,o),o=jt(e);const a=Kt(o.mutation,i);if(Wt(o.comment,i),zt(o.data,i),n)if(r){if(!i.previousConnection)throw TypeError("Next block does not have previous statement.");n.connect(i.previousConnection)}else if(i.outputConnection)n.connect(i.outputConnection);else{if(!i.previousConnection)throw TypeError("Child block does not have output or previous statement.");n.connect(i.previousConnection)}if(qt(o.field,i),Yt(o.input,t,i,s),Xt(o.next,t,i),a&&i.initSvg(),(t=e.getAttribute("inline"))&&i.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&i.setEnabled("true"!==t&&"disabled"!==t),(t=e.getAttribute("deletable"))&&i.setDeletable("true"===t),(t=e.getAttribute("movable"))&&i.setMovable("true"===t),(t=e.getAttribute("editable"))&&i.setEditable("true"===t),(t=e.getAttribute("collapsed"))&&i.setCollapsed("true"===t),"shadow"===e.nodeName.toLowerCase()){for(e=i.getChildren(!1),t=0;t<e.length;t++)if(!e[t].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");i.setShadow(!0)}return i},Zt=function(e,t,n){const r=e.getField(t);r?r.fromXml(n):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},en=function(e){for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];if("next"===n.nodeName.toLowerCase()){e.removeChild(n);break}}},tn=function(e){return e.nodeType===rl.ELEMENT_NODE},nn=function(e){return void 0!==e.saveState&&void 0!==e.loadState},rn=function(e,n){t(Uo.SERIALIZER,e,n)},sn=function(e){r(Uo.SERIALIZER,e)},on=function(e,{addCoordinates:t=!1,addInputBlocks:n=!0,addNextBlocks:r=!0,doFullSerialization:i=!0,saveIds:s=!0}={}){if(e.isInsertionMarker())return null;const o={type:e.type,id:s?e.id:void 0};return t&&ln(e,o),an(e,o),cn(e,o,i),un(e,o,i),dn(e,o,i),n&&pn(e,o,i,s),r&&hn(e,o,i,s),o},an=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.enabled=!1),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},ln=function(e,t){const n=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(n.RTL?n.getWidth()-e.x:e.x),t.y=Math.round(e.y)},cn=function(e,t,n){e.saveExtraState?null!==(e=e.saveExtraState(n))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=$t(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},un=function(e,t,n){const r=Object.create(null);for(const t of e.getIcons())nn(t)&&(e=t.saveState(n))&&(r[t.getType().toString()]=e);Object.keys(r).length&&(t.icons=r)},dn=function(e,t,n){const r=Object.create(null);for(let t=0;t<e.inputList.length;t++){const i=e.inputList[t];for(let e=0;e<i.fieldRow.length;e++){const t=i.fieldRow[e];t.isSerializable()&&(r[t.name]=t.saveState(n))}}Object.keys(r).length&&(t.fields=r)},pn=function(e,t,n,r){const i=Object.create(null);for(let t=0;t<e.inputList.length;t++){const s=e.inputList[t];if(!s.connection)continue;const o=fn(s.connection,n,r);o&&(i[s.name]=o)}Object.keys(i).length&&(t.inputs=i)},hn=function(e,t,n,r){e.nextConnection&&(e=fn(e.nextConnection,n,r))&&(t.next=e)},fn=function(e,t,n){const r=e.getShadowState(!0);if(e=e.targetBlock(),!r&&!e)return null;const i=Object.create(null);return r&&(i.shadow=r),e&&!e.isShadow()&&(i.block=on(e,{doFullSerialization:t,saveIds:n})),i},mn=function(e,t,{recordUndo:n=!1}={}){return e=_n(e,t,{recordUndo:n}),t.rendered&&xt(),e},_n=function(e,t,{parentConnection:n,isShadow:r=!1,recordUndo:i=!1}={}){const s=A();let o;I(i),(i=Po.getGroup$$module$build$src$core$events$utils())||Po.setGroup$$module$build$src$core$events$utils(!0),Po.disable$$module$build$src$core$events$utils();try{o=gn(e,t,{parentConnection:n,isShadow:r})}finally{Po.enable$$module$build$src$core$events$utils()}if(L()&&w(new($(Po.CREATE$$module$build$src$core$events$utils))(o)),Po.setGroup$$module$build$src$core$events$utils(i),I(s),t.rendered){const e=o;setTimeout((()=>{e.disposed||e.setConnectionTracking(!0)}),1)}return o},gn=function(e,t,{parentConnection:n,isShadow:r=!1}={}){if(!e.type)throw new mc(e);const i=t.newBlock(e.type,e.id);return i.setShadow(r),yn(i,e),bn(i,e),vn(i,e),Tn(n,i,e),kn(i,e),En(i,e),xn(i,e),Sn(i,e),In(i,t.rendered),i},yn=function(e,t){let n=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;const r=e.workspace;n=r.RTL?r.getWidth()-n:n,e.moveBy(n,t)},bn=function(e,t){t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setEnabled(!1),void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},vn=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(Po.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Tn=function(e,t,n){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new yc(n);if(e.type===Po.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var r=t.outputConnection;if(!r)throw new _c("output",t,n)}else if(!(r=t.previousConnection))throw new _c("previous",t,n);if(!e.connect(r)){const i=t.workspace.connectionChecker;throw new gc(i.getErrorMessage(i.canConnectWithReason(r,e,!1),r,e),e.type===Po.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,n)}}},kn=function(e,t){if(t.icons){var n=Object.keys(t.icons);for(const i of n){n=t.icons[i];var r=e.getIcon(i);if(!r){if(!(r=o(Uo.ICON,i,!1)))throw new bc(i,e,t);r=new r(e),e.addIcon(r)}nn(r)&&r.loadState(n)}}},En=function(e,t){if(t.fields){var n=Object.keys(t.fields);for(let r=0;r<n.length;r++){const i=n[r],s=t.fields[i],o=e.getField(i);o?o.loadState(s):console.warn(`Ignoring non-existant field ${i} in block ${e.type}`)}}},xn=function(e,t){if(t.inputs){var n=Object.keys(t.inputs);for(let r=0;r<n.length;r++){const i=n[r],s=e.getInput(i);if(!s||!s.connection)throw new _c(i,e,t);Cn(s.connection,t.inputs[i])}}},Sn=function(e,t){if(t.next){if(!e.nextConnection)throw new _c("next",e,t);Cn(e.nextConnection,t.next)}},Cn=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&gn(t.block,e.getSourceBlock().workspace,{parentConnection:e})},In=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const t of e.getIcons())t.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},An=function(e){const t=e.workspace,n=Po.config$$module$build$src$core$config.snapRadius,r=e.getRelativeToSurfaceXY(),i=new el(0,0),s=t.getAllBlocks(!1).filter((t=>t.id!=e.id)).map((e=>e.getRelativeToSurfaceXY()));for(;wn(el.sum(r,i),s)||Nn(e,i,n);)t.RTL?i.translate(-n,2*n):i.translate(n,2*n);e.moveTo(el.sum(r,i))},wn=function(e,t){return t.some((t=>1>=Math.abs(t.x-e.x)&&1>=Math.abs(t.y-e.y)))},Nn=function(e,t,n){return e.getConnections_(!1).some((e=>!!e.closest(n,t).connection))},Dn=function(e){return ne("Blockly.clipboard.copy","v11","v12","myCopyable.toCopyData()"),Pc.copyInternal(e)},On=function(e){const t=e.toCopyData();let n;return Rc=t,Lc=null!=(n=e.workspace)?n:null,t},Rn=function(e,t,n){return e&&t?Ln(e,t,n):Rc&&Lc?Ln(Rc,Lc):null},Ln=function(e,t,n){let r,i,s;return t=null!=(r=t.getRootWorkspace())?r:t,null!=(s=null==(i=a(Uo.PASTER,e.paster,!1))?void 0:i.paste(e,t,n))?s:null},Pn=function(e){return ne("Blockly.clipboard.duplicate","v11","v12","Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)"),Pc.duplicateInternal(e)},Mn=function(e){const t=e.toCopyData();return t?Rn(t,e.workspace):null},Fn=function(e,t){e.setAttribute(Uc,t)},$n=function(e,t,n){Array.isArray(n)&&(n=n.join(" ")),e.setAttribute(Bc+t,`${n}`)},Bn=function(){return Hc},Un=function(e){if(Hc=e,null===e){let e;null==(e=document.querySelector("."+zc))||e.remove()}},Vn=function(){document.querySelector("."+zc)||((Hc=document.createElement("div")).className=zc,(y()||document.body).appendChild(Hc))},Hn=function(e,t,n){Gn(),Kc=e,Wc=n,(e=Hc)&&(e.style.direction=t?"rtl":"ltr",e.style.display="block",t=f(),qc=t.getRenderer().getClassName(),Jc=t.getTheme().getClassName(),qc&&ie(e,qc),Jc&&ie(e,Jc))},Gn=function(){if(jn()){Kc=null;var e=Hc;e&&(e.style.display="none",e.style.left="",e.style.top="",Wc&&Wc(),Wc=null,e.textContent="",qc&&(oe(e,qc),qc=""),Jc&&(oe(e,Jc),Jc=""),f().markFocused())}},jn=function(){return!!Kc},Kn=function(e){Kc===e&&Gn()},Wn=function(e,t,n){Hc.style.left=e+"px",Hc.style.top=t+"px",Hc.style.height=n+"px"},zn=function(e,t,n,r){const i=Jn(e,t,n);e=qn(e,t,n,r),0>i?Wn(e,0,n.height+i):Wn(e,i,n.height)},qn=function(e,t,n,r){return r?Math.min(Math.max(t.right-n.width,e.left),e.right-n.width):Math.max(Math.min(t.left,e.right-n.width),e.left)},Jn=function(e,t,n){return t.bottom+n.height>=e.bottom?t.top-n.height:t.bottom},Yn=function(e){return!(null==e||!e.repositionForWindowResize)},Xn=function(){Yn(Kc)&&Kc.repositionForWindowResize()||Gn()},Qn=function(){return Xc},Zn=function(e){Xc=e},er=function(e,t,n){if(Hn(Qc,n,or),t.length){var r=tr(t,n);Zc=r,nr(r,e,n),setTimeout((function(){r.focus()}),1),Xc=null}else sr()},tr=function(e,t){const n=new Gc;n.setRole(Fc.MENU);for(let r=0;r<e.length;r++){const i=e[r],s=new jc(i.text);s.setRightToLeft(t),s.setRole(Fc.MENUITEM),n.addChild(s),s.setEnabled(i.enabled),i.enabled&&s.onAction((function(){sr(),requestAnimationFrame((()=>{setTimeout((()=>{i.callback(i.scope)}),0)}))}),{})}return n},nr=function(e,t,n){const r=we();t=new pl(t.clientY+r.top,t.clientY+r.top,t.clientX+r.left,t.clientX+r.left),rr(e);const i=e.getSize();n&&(t.left+=i.width,t.right+=i.width,r.left+=i.width,r.right+=i.width),zn(r,t,i,n),e.focus()},rr=function(e){var t=Bn();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),ie(t,"blocklyContextMenu"),W(t,"contextmenu",null,ir),e.focus()},ir=function(e){e.preventDefault(),e.stopPropagation()},sr=function(){Kn(Qc),Xc=null},or=function(){Zc&&(Zc.dispose(),Zc=null)},Po.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let n;Po.disable$$module$build$src$core$events$utils();try{n=t instanceof Element?Ht(t,e.workspace):_n(t,e.workspace);const r=e.getRelativeToSurfaceXY();r.x=e.RTL?r.x-Po.config$$module$build$src$core$config.snapRadius:r.x+Po.config$$module$build$src$core$config.snapRadius,r.y+=2*Po.config$$module$build$src$core$config.snapRadius,n.moveBy(r.x,r.y)}finally{Po.enable$$module$build$src$core$events$utils()}return L()&&!n.isShadow()&&w(new($(Po.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}},ar=function(e){return{text:Po.Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function(){Po.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),Po.setGroup$$module$build$src$core$events$utils(!1)}}},lr=function(e){return{text:Po.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){const t=e.toCopyData();t&&Rn(t,e.workspace)}}},cr=function(e,t){const n={enabled:!0};return n.text=Po.Msg$$module$build$src$core$msg.ADD_COMMENT,n.callback=function(){const n=new oc(e,Po.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,oc.DEFAULT_SIZE,oc.DEFAULT_SIZE);var r=e.getInjectionDiv().getBoundingClientRect();r=new el(t.clientX-r.left,t.clientY-r.top);const i=e.getOriginOffsetInPixels();(r=el.difference(r,i)).scale(1/e.scale),n.moveBy(r.x,r.y),e.rendered&&(n.initSvg(),n.render(),n.select())},n},ur=function(e){return e*Math.PI/180},dr=function(e){return 180*e/Math.PI},pr=function(e,t,n){if(n<e){const t=n;n=e,e=t}return Math.max(e,Math.min(t,n))},hr=function(){document.querySelector(".blocklyDropDownDiv")||((su=document.createElement("div")).className="blocklyDropDownDiv",(y()||document.body).appendChild(su),(ou=document.createElement("div")).className="blocklyDropDownContent",su.appendChild(ou),(au=document.createElement("div")).className="blocklyDropDownArrow",su.appendChild(au),su.style.opacity="0",su.style.transition="transform "+pu+"s, opacity "+pu+"s",su.addEventListener("focusin",(function(){ie(su,"blocklyFocused")})),su.addEventListener("focusout",(function(){oe(su,"blocklyFocused")})))},fr=function(e){gu=e},mr=function(){return yu},_r=function(){return ou},gr=function(){ou.textContent="",ou.style.width=""},yr=function(e,t){su.style.backgroundColor=e,su.style.borderColor=t},br=function(e,t,n,r){return Er(Tr(t),e,n,r)},vr=function(e,t,n){return bu=!0,Er(kr(e),e,t,n)},Tr=function(e){var t=e.getSvgRoot();const n=e.workspace.scale,r=e.height*n;return e=e.width*n,t=ke(t),new pl(t.y,t.y+r,t.x,t.x+e)},kr=function(e){return e=e.getScaledBBox(),new pl(e.top,e.bottom,e.left,e.right)},Er=function(e,t,n,r){const i=e.left+(e.right-e.left)/2,s=e.bottom;e=e.top,r&&(e+=r);let o=(r=t.getSourceBlock()).workspace;for(;o.options.parentWorkspace;)o=o.options.parentWorkspace;return fr(o.getParentSvg().parentNode),xr(t,r.RTL,i,s,i,e,n)},xr=function(e,t,n,r,i,s,o){return yu=e,fu=o||null,su.style.direction=t?"rtl":"ltr",e=f(),mu=e.getRenderer().getClassName(),_u=e.getTheme().getClassName(),mu&&ie(su,mu),_u&&ie(su,_u),Rr(n,r,i,s)},Sr=function(e,t,n,r){return{initialX:(e=Ar(e,n.left,n.right,r.width)).divX,initialY:t,finalX:e.divX,finalY:t+du,arrowX:e.arrowX,arrowY:-(lu/2+cu),arrowAtTop:!0,arrowVisible:!0}},Cr=function(e,t,n,r){return{initialX:(e=Ar(e,n.left,n.right,r.width)).divX,initialY:t-r.height,finalX:e.divX,finalY:t-r.height-du,arrowX:e.arrowX,arrowY:r.height-2*cu-lu/2,arrowAtTop:!1,arrowVisible:!0}},Ir=function(e,t,n){return{initialX:(e=Ar(e,t.left,t.right,n.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Ar=function(e,t,n,r){return t=pr(t,e-r/2,n-r),{arrowX:e=pr(n=uu,e=e-lu/2-t,r-n-lu),divX:t}},wr=function(){return!!yu},Nr=function(e,t){return yu===e&&(t?Or():Dr(),!0)},Dr=function(){su.style.transform="translate(0, 0)",su.style.opacity="0",hu=setTimeout((function(){Or()}),1e3*pu),fu&&(fu(),fu=null)},Or=function(){wr()&&(hu&&clearTimeout(hu),su.style.transform="",su.style.left="",su.style.top="",su.style.opacity="0",su.style.display="none",su.style.backgroundColor="",su.style.borderColor="",fu&&(fu(),fu=null),gr(),yu=null,mu&&(oe(su,mu),mu=""),_u&&(oe(su,_u),_u=""),f().markFocused())},Rr=function(e,t,n,r){(e=vu.getPositionMetrics(e,t,n,r)).arrowVisible?(au.style.display="",au.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",au.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):au.style.display="none",t=Math.floor(e.initialX),n=Math.floor(e.initialY),r=Math.floor(e.finalX);const i=Math.floor(e.finalY);return su.style.left=t+"px",su.style.top=n+"px",su.style.display="block",su.style.opacity="1",su.style.transform="translate("+(r-t)+"px,"+(i-n)+"px)",!!e.arrowAtTop},Lr=function(){if(yu){var e=yu.getSourceBlock();const t=(e=bu?kr(yu):Tr(e)).left+(e.right-e.left)/2;Rr(t,e.bottom,t,e.top)}else Dr()},Pr=function(e){if(!(100<e.getDescendants(!1).length)){var t=e.workspace,n=e.getSvgRoot();t.getAudioManager().play("delete");var r=t.getSvgXY(n);(n=n.cloneNode(!0)).setAttribute("transform","translate("+r.x+","+r.y+")"),t.getParentSvg().appendChild(n),Mr(n,{x:r.x,y:r.y,width:e.width,height:e.height},t.RTL,new Date,t.scale)}},Mr=function(e,t,n,r,i){const s=((new Date).getTime()-r.getTime())/150;1<s?le(e):(e.setAttribute("transform","translate("+(t.x+(n?-1:1)*t.width*i/2*s)+","+(t.y+t.height*i*s)+") scale("+(1-s)*i+")"),setTimeout(Mr,10,e,t,n,r,i))},Fr=function(e){var t=e.workspace;const n=t.scale;if(t.getAudioManager().play("click"),!(1>n)){var r=t.getSvgXY(e.getSvgRoot());e.outputConnection?(r.x+=(e.RTL?3:-3)*n,r.y+=13*n):e.previousConnection&&(r.x+=(e.RTL?-23:23)*n,r.y+=3*n);var i=re(dl.CIRCLE,{cx:r.x,cy:r.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=re(dl.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*n},i),t=re(dl.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},i),e.beginElement(),t.beginElement(),setTimeout((()=>{le(i)}),150)}},$r=function(e){if(Ur(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Eu=e,Br(e,t,new Date)}},Br=function(e,t,n){const r=((new Date).getTime()-n.getTime())/200;let i="";1>=r&&(i=`skewX(${Math.round(Math.sin(r*Math.PI*3)*(1-r)*t)})`,ku=setTimeout(Br,10,e,t,n)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${i}`)},Ur=function(){Eu&&(ku&&(clearTimeout(ku),ku=null),Eu.getSvgRoot().setAttribute("transform",Eu.getTranslation()),Eu=null)},Vr=function(e,t){return ne("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),e.startsWith(t)},Hr=function(e){return e.length?e.reduce((function(e,t){return e.length<t.length?e:t})).length:0},Gr=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,r=0;for(t=t||Hr(e),n=0;n<t;n++){for(var i=e[0][n],s=1;s<e.length;s++)if(i!==e[s][n])return r;" "===i&&(r=n+1)}for(i=1;i<e.length;i++)if((s=e[i][n])&&" "!==s)return r;return t},jr=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let n,r=0;for(t=t||Hr(e),n=0;n<t;n++){for(var i=e[0].substr(-n-1,1),s=1;s<e.length;s++)if(i!==e[s].substr(-n-1,1))return r;" "===i&&(r=n+1)}for(i=1;i<e.length;i++)if((s=e[i].charAt(e[i].length-n-1))&&" "!==s)return r;return t},Po.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let n=0;n<e.length;n++)e[n]=Kr(e[n],t);return e.join("\n")},Kr=function(e,t){if(e.length<=t)return e;const n=e.trim().split(/\s+/);for(var r=0;r<n.length;r++)n[r].length>t&&(t=n[r].length);var i=-1/0;let s,o=1;do{r=i,s=e,e=[],i=n.length/o;let a=1;for(let t=0;t<n.length-1;t++)a<(t+1.5)/i?(a++,e[t]=!0):e[t]=!1;e=zr(n,e,t),i=Wr(n,e,t),e=qr(n,e),o++}while(i>r);return s},Wr=function(e,t,n){const r=[0],i=[];for(var s=0;s<e.length;s++)r[r.length-1]+=e[s].length,!0===t[s]?(r.push(0),i.push(e[s].charAt(e[s].length-1))):!1===t[s]&&r[r.length-1]++;for(e=Math.max(...r),t=0,s=0;s<r.length;s++)t-=2*Math.pow(Math.abs(n-r[s]),1.5),t-=Math.pow(e-r[s],1.5),-1!==".?!".indexOf(i[s])?t+=n/3:-1!==",;)]}".indexOf(i[s])&&(t+=n/4);return 1<r.length&&r[r.length-1]<=r[r.length-2]&&(t+=.5),t},zr=function(e,t,n){let r,i=Wr(e,t,n);for(let s=0;s<t.length-1;s++){if(t[s]===t[s+1])continue;const o=[].concat(t);o[s]=!o[s],o[s+1]=!o[s+1];const a=Wr(e,o,n);a>i&&(i=a,r=o)}return r?zr(e,r,n):t},qr=function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e[r]),void 0!==t[r]&&n.push(t[r]?"\n":" ");return n.join("")},Po.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Jr=function(e){Au=e},Yr=function(){return Au},Xr=function(){return wu},Qr=function(){return Gu},Zr=function(e){if(e=ei(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},ei=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},ti=function(){document.querySelector(".blocklyTooltipDiv")||((Gu=document.createElement("div")).className="blocklyTooltipDiv",(y()||document.body).appendChild(Gu))},ni=function(e){e.mouseOverWrapper_=z(e,"pointerover",null,ii),e.mouseOutWrapper_=z(e,"pointerout",null,si),e.addEventListener("pointermove",oi,!1)},ri=function(e){e&&(q(e.mouseOverWrapper_),q(e.mouseOutWrapper_),e.removeEventListener("pointermove",oi))},ii=function(e){Nu||(e=ei(e.currentTarget),Mu!==e&&(li(),Fu=null,Mu=e),clearTimeout(Ou))},si=function(e){Nu||(Ou=setTimeout((function(){Fu=Mu=null,li()}),1),clearTimeout(Ru),Ru=0)},oi=function(e){if(Mu&&Mu.tooltip&&!Nu)if(wu){const t=Lu-e.pageX;e=Pu-e.pageY,Math.sqrt(t*t+e*e)>Uu&&li()}else Fu!==Mu&&(clearTimeout(Ru),Lu=e.pageX,Pu=e.pageY,Ru=setTimeout(fi,Vu))},ai=function(){Fu=Mu=null,li()},li=function(){wu&&(wu=!1,Gu&&(Gu.style.display="none")),Ru&&(clearTimeout(Ru),Ru=0)},ci=function(){li(),Nu=!0},ui=function(){Nu=!1},di=function(){Gu&&Mu&&("function"==typeof Au?Au(Gu,Mu):pi())},pi=function(){var e=Zr(Mu);e=(e=Po.wrap$$module$build$src$core$utils$string(e,Du)).split("\n");for(let t=0;t<e.length;t++){const n=document.createElement("div");n.appendChild(document.createTextNode(e[t])),Gu.appendChild(n)}},hi=function(e){const t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;let r=Lu;r=e?r-($u+Gu.offsetWidth):r+$u;let i=Pu+Bu;return i+Gu.offsetHeight>n+window.scrollY&&(i-=Gu.offsetHeight+2*Bu),e?r=Math.max(Hu-window.scrollX,r):r+Gu.offsetWidth>t+window.scrollX-2*Hu&&(r=t-Gu.offsetWidth-2*Hu),{x:r,y:i}},fi=function(){if(!Nu&&(Fu=Mu,Gu)){Gu.textContent="",di();var e=Mu.RTL;Gu.style.direction=e?"rtl":"ltr",Gu.style.display="block",wu=!0;var{x:t,y:n}=hi(e);Gu.style.left=t+"px",Gu.style.top=n+"px"}},mi=function(e,t){for(const n in t)e[n]=null!==t[n]&&"object"==typeof t[n]?mi(e[n]||Object.create(null),t[n]):t[n];return e},_i=function(e){return void 0!==e.bubbleIsVisible&&void 0!==e.setBubbleVisible},gi=function(){return ed},yi=function(e){ed=e},bi=function(){return td},vi=function(e){td=e},Ti=function(e){e=`${e}`.toLowerCase().trim();var t=nd[e];if(t)return t;if(t="#"===(t="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?t:"#"+t,/^#[0-9a-f]{6}$/.test(t))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var n=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return n&&(e=Number(n[1]),t=Number(n[2]),n=Number(n[3]),0<=e&&256>e&&0<=t&&256>t&&0<=n&&256>n)?ki(e,t,n):null},ki=function(e,t,n){return t=e<<16|t<<8|n,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Ei=function(e){return(e=Ti(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},xi=function(e,t,n){let r=0,i=0,s=0;if(0===t)s=i=r=n;else{const o=Math.floor(e/60),a=e/60-o;e=n*(1-t);const l=n*(1-t*a);switch(t=n*(1-t*(1-a)),o){case 1:r=l,i=n,s=e;break;case 2:r=e,i=n,s=t;break;case 3:r=e,i=l,s=n;break;case 4:r=t,i=e,s=n;break;case 5:r=n,i=e,s=l;break;case 6:case 0:r=n,i=t,s=e}}return ki(Math.floor(r),Math.floor(i),Math.floor(s))},Si=function(e,t,n){return(e=Ti(e))&&(t=Ti(t))?(e=Ei(e),t=Ei(t),ki(Math.round(t[0]+n*(e[0]-t[0])),Math.round(t[1]+n*(e[1]-t[1])),Math.round(t[2]+n*(e[2]-t[2])))):null},Ci=function(e){return xi(e,ed,255*td)},Ii=function(e,t,n){const r=[];var i=e.split("");i.push("");var s=0;e=[];let o=null;for(let c=0;c<i.length;c++){var a=i[c];if(0===s)if("%"===a)(s=e.join(""))&&r.push(s),e.length=0,s=1;else if(n&&"\n"===a){const t=e.join("");t&&r.push(t),e.length=0,r.push(a)}else e.push(a);else if(1===s)"%"===a?(e.push(a),s=0):t&&"0"<=a&&"9">=a?(s=2,o=a,(a=e.join(""))&&r.push(a),e.length=0):"{"===a?s=3:(e.push("%",a),s=0);else if(2===s)if("0"<=a&&"9">=a)o+=a;else{var l=void 0;r.push(parseInt(null!=(l=o)?l:"",10)),c--,s=0}else 3===s&&(""===a?(e.splice(0,0,"%{"),c--,s=0):"}"!==a?e.push(a):(s=e.join(""),/[A-Z]\w*/i.test(s)&&(a=(a=s.toUpperCase()).startsWith("BKY_")?a.substring(4):null)&&a in Po.Msg$$module$build$src$core$msg?"string"==typeof(s=Po.Msg$$module$build$src$core$msg[a])?Array.prototype.push.apply(r,Ii(s,t,n)):t?r.push(`${s}`):r.push(s):r.push("%{"+s+"}"),s=e.length=0))}for((t=e.join(""))&&r.push(t),l=[],e.length=0,i=0;i<r.length;i++)"string"!=typeof r[i]||n&&"\n"===r[i]?((t=e.join(""))&&l.push(t),e.length=0,l.push(r[i])):e.push(r[i]);return(t=e.join(""))&&l.push(t),e.length=0,l},Ai=function(e){return Ii(e,!0,!0)},wi=function(e){return"string"!=typeof e?e:(e=Ii(e,!1,!1)).length?String(e[0]):""},Ni=function(e){let t=!0;const n=Po.Msg$$module$build$src$core$msg,r=e.match(/%{BKY_[A-Z]\w*}/gi);if(r)for(let i=0;i<r.length;i++)void 0===n[r[i].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+r[i]+" in "+e),t=!1);return t},Di=function(e){const t="string"==typeof e?wi(e):e;var n=Number(t);if(!isNaN(n)&&0<=n&&360>=n)return{hue:n,hex:xi(n,gi(),255*bi())};if(n=Ti(t))return{hue:null,hex:n};throw n='Invalid colour: "'+t+'"',e!==t&&(n+=' (from "'+e+'")'),Error(n)},Oi=function(e){return void 0!==e.getProcedureModel&&void 0!==e.doProcedureUpdate&&void 0!==e.isProcedureDef},Ri=function(e){return void 0!==e.startPublishing&&void 0!==e.stopPublishing},Li=function(e,n){t(Uo.FIELD,e,n)},Pi=function(e){r(Uo.FIELD,e)},Po.fromJson$$module$build$src$core$field_registry=function(e){return ud.fromJsonInternal(e)},Mi=function(e){const t=a(Uo.FIELD,e.type);if(t){if("function"!=typeof t.fromJson)throw new TypeError("returned Field was not a IRegistrableField");return t.fromJson(e)}return console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},Fi=function(e){let t=!1;const n=e.map((([e,n])=>"string"==typeof e?[wi(e),n]:(t=!0,[null!==e.alt?Object.assign({},e,{alt:wi(e.alt)}):Object.assign({},e),n])));if(t||2>e.length)return{options:n};var r=n.map((([e])=>e)),i=Hr(r);e=Gr(r,i);const s=jr(r,i);return!e&&!s||i<=e+s?{options:n}:(i=e?r[0].substring(0,e-1):void 0,r=s?r[0].substr(1-s):void 0,{options:$i(n,e,s),prefix:i,suffix:r})},$i=function(e,t,n){return e.map((([e,r])=>[e.substring(t,e.length-n),r]))},Bi=function(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)?"string"!=typeof r[1]?(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!=typeof r[0]&&"string"!=typeof r[0].src&&(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(t=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",r))}if(t)throw TypeError("Found invalid FieldDropdown options.")},Po.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(gd[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');gd[e]=t},Po.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');Po.register$$module$build$src$core$extensions(e,(function(){this.mixin(t)}))},Po.registerMutator$$module$build$src$core$extensions=function(e,t,n,r){const i='Error when registering mutator "'+e+'": ';qi(i,t);const s=Wi(t,i);if(n&&"function"!=typeof n)throw Error(i+'Extension "'+e+'" is not a function');Po.register$$module$build$src$core$extensions(e,(function(){s&&this.setMutator(new Po.MutatorIcon$$module$build$src$core$icons$mutator_icon(r||[],this)),this.mixin(t),n&&n.apply(this)}))},Ui=function(e){Vi(e)?delete gd[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Vi=function(e){return!!gd[e]},Hi=function(e,t,n){const r=gd[e];if("function"!=typeof r)throw Error('Error: Extension "'+e+'" not found.');let i;if(n?Gi(e,t):i=Ji(t),r.apply(t),n)qi('Error after applying mutator "'+e+'": ',t);else if(!Yi(i,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},Gi=function(e,t){if(Ji(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},ji=function(e,t){return zi(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},Ki=function(e,t){return zi(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},Wi=function(e,t){return zi(e.compose,e.decompose,t+" compose/decompose")},zi=function(e,t,n){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(n+" must be a function");return!0}if(!e&&!t)return!1;throw Error(n+"Must have both or neither functions")},qi=function(e,t){const n=ji(t,e),r=Ki(t,e);if(!n&&!r)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");Wi(t,e)},Ji=function(e){const t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},Yi=function(e,t){if((t=Ji(t)).length!==e.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0},Xi=function(e){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{const t=setInterval((function(){"complete"===document.readyState&&(clearInterval(t),e())}),10)}},Po.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const n=[];return function(){-1===n.indexOf(this.type)&&(Qi(this,e,t),n.push(this.type)),this.setTooltip(function(){const n=String(this.getFieldValue(e));return wi(t[n])}.bind(this))}},Qi=function(e,t,n){var r=e.getField(t);if(r instanceof pd&&!r.isOptionListDynamic()){r=r.getOptions();for(const[,i]of r)void 0===n[i]&&console.warn(`No tooltip mapping for value ${i} of field ${t} of block type ${e.type}.`)}},Po.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const n=this.getField(t);return wi(e).replace("%1",n?n.getText():"")}.bind(this))}},Zi=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},es=function(e,t){return" "+e+","+t+" "},ts=function(e,t){return" "+e+t.join("")},ns=function(e,t){return" M "+e+","+t+" "},rs=function(e,t){return" m "+e+","+t+" "},is=function(e,t){return" l "+e+","+t+" "},ss=function(e){return" l"+e.join("")},os=function(e,t){return" "+e+" "+t+" "},as=function(e,t,n,r){return e+" "+n+" "+n+" "+t+r},ls=function(e,n){t(Uo.ICON,e.toString(),n)},cs=function(e){r(Uo.ICON,e)},us=function(e){const t=e.getProcedureMap().getProcedures().filter((e=>!e.getReturnTypes())).map((e=>[e.getName(),e.getParameters().map((e=>e.getName())),!1]));e.getBlocksByType("procedures_defnoreturn",!1).forEach((e=>{!Oi(e)&&rt(e)&&t.push(e.getProcedureDef())}));const n=e.getProcedureMap().getProcedures().filter((e=>!!e.getReturnTypes())).map((e=>[e.getName(),e.getParameters().map((e=>e.getName())),!0]));return e.getBlocksByType("procedures_defreturn",!1).forEach((e=>{!Oi(e)&&rt(e)&&n.push(e.getProcedureDef())})),t.sort(ds),n.sort(ds),[t,n]},ds=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},Po.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||Po.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!ps(e,t.workspace,t);){const t=e.match(/^(.*?)(\d+)$/);e=t?t[1]+(parseInt(t[2])+1):e+"2"}return e},ps=function(e,t,n){return!hs(e,t,n)},hs=function(e,t,n){for(const r of t.getAllBlocks(!1))if(r!==n&&rt(r)&&Po.Names$$module$build$src$core$names.equals(r.getProcedureDef()[0],e))return!0;n=n&&Oi(n)?null==n?void 0:n.getProcedureModel():void 0;for(const r of t.getProcedureMap().getProcedures())if(r!==n&&Po.Names$$module$build$src$core$names.equals(r.getName(),e))return!0;return!1},Po.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new od;e=e.trim();const n=Po.findLegalName$$module$build$src$core$procedures(e,t);Oi(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(n);const r=this.getValue();if(r!==e&&r!==n)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const i=e[t];i.renameProcedure&&i.renameProcedure(r,n)}return n},fs=function(e){function t(e,t){for(let i=0;i<e.length;i++){var r=e[i][0];const s=e[i][1],o=Po.createElement$$module$build$src$core$utils$xml("block");o.setAttribute("type",t),o.setAttribute("gap","16");const a=Po.createElement$$module$build$src$core$utils$xml("mutation");for(a.setAttribute("name",r),o.appendChild(a),r=0;r<s.length;r++){const e=Po.createElement$$module$build$src$core$utils$xml("arg");e.setAttribute("name",s[r]),a.appendChild(e)}n.push(o)}}const n=[];if(jo.procedures_defnoreturn){var r=Po.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","procedures_defnoreturn"),r.setAttribute("gap","16");var i=Po.createElement$$module$build$src$core$utils$xml("field");i.setAttribute("name","NAME"),i.appendChild(Po.createTextNode$$module$build$src$core$utils$xml(Po.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),r.appendChild(i),n.push(r)}return jo.procedures_defreturn&&((r=Po.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),r.setAttribute("gap","16"),(i=Po.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),i.appendChild(Po.createTextNode$$module$build$src$core$utils$xml(Po.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),r.appendChild(i),n.push(r)),jo.procedures_ifreturn&&((r=Po.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),r.setAttribute("gap","16"),n.push(r)),n.length&&n[n.length-1].setAttribute("gap","24"),t((e=us(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),n},ms=function(e){var t=[],n=e.getBlocksByType("procedures_mutatorarg",!1);for(let e,r=0;e=n[r];r++)t.push(e.getFieldValue("NAME"));n=Po.createElement$$module$build$src$core$utils$xml("xml");const r=Po.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","procedures_mutatorarg");const i=Po.createElement$$module$build$src$core$utils$xml("field");i.setAttribute("name","NAME"),t=ct(Po.DEFAULT_ARG$$module$build$src$core$procedures,t),t=Po.createTextNode$$module$build$src$core$utils$xml(t),i.appendChild(t),r.appendChild(i),n.appendChild(r),e.updateToolbox(n)},_s=function(e){if(e.type===ra&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=u(e.workspaceId).getBlockById(e.blockId)).type;"procedures_defnoreturn"!==t&&"procedures_defreturn"!==t||(e=e.getIcon(Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),ms(e),e.addChangeListener(gs))}},gs=function(e){e.type!==Po.CREATE$$module$build$src$core$events$utils&&e.type!==Po.DELETE$$module$build$src$core$events$utils&&e.type!==Po.CHANGE$$module$build$src$core$events$utils&&e.type!==Zo||(e=u(e.workspaceId),ms(e))},ys=function(e,t){return t.getAllBlocks(!1).filter((t=>bs(t,e)||it(t)&&Po.Names$$module$build$src$core$names.equals(t.getProcedureCall(),e)))},bs=function(e,t){return Oi(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&Po.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},Po.mutateCallers$$module$build$src$core$procedures=function(e){const t=A();var n=e.getProcedureDef()[0];const r=e.mutationToDom(!0);e=ys(n,e.workspace);for(let s,o=0;s=e[o];o++){n=(n=s.mutationToDom())&&Le(n),s.domToMutation&&s.domToMutation(r);var i=s.mutationToDom();n!==(i=i&&Le(i))&&(I(!1),w(new($(Po.CHANGE$$module$build$src$core$events$utils))(s,"mutation",null,n,i)),I(t))}},Po.getDefinition$$module$build$src$core$procedures=function(e,t){for(const n of t.getAllBlocks(!1))if(Oi(n)&&n.isProcedureDef()&&Po.Names$$module$build$src$core$names.equals(n.getProcedureModel().getName(),e)||rt(n)&&Po.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],e))return n;return null},vs=function(e){return e.isDynamic},Ts=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},ks=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},Es=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},xs=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Ss=function(e,t){let n=null;const r=null==(t=t.outputConnection)?void 0:t.getConnectionChecker();for(let i,s=0;i=e.inputList[s];s++){const e=i.connection;let s;if(e&&null!=(s=r)&&s.canConnect(t,e,!1)){if(n)return null;n=e}}return n},Cs=function(e,t){let n;for(;n=Ss(e,t);)if(!(e=n.targetBlock())||e.isShadow())return n;return null},Is=function(e,n){t(Uo.RENDERER,e,n)},As=function(e){r(Uo.RENDERER,e)},ws=function(e,t,n){return(e=new(o(Uo.RENDERER,e))(e)).init(t,n),e},Ns=function(e){ut(e.getTargetWorkspace(),void 0,"String")},Ds=function(e){ut(e.getTargetWorkspace(),void 0,"Number")},Os=function(e){ut(e.getTargetWorkspace(),void 0,"Colour")},Rs=function(e){let t=[],n=document.createElement("button");return n.setAttribute("text",Po.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(n),(n=document.createElement("button")).setAttribute("text",Po.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(n),(n=document.createElement("button")).setAttribute("text",Po.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),n.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(n),e.registerButtonCallback("CREATE_VARIABLE_STRING",Ns),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Ds),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",Os),e=Ls(e),t.concat(e)},Ls=function(e){const t=[];if(0<(e=e.getAllVariables()).length){if(jo.variables_set_dynamic){var n=e[e.length-1];const r=Po.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type","variables_set_dynamic"),r.setAttribute("gap","24"),r.appendChild(gt(n)),t.push(r)}if(jo.variables_get_dynamic){e.sort(Ql.compareByName);for(let r,i=0;r=e[i];i++)(n=Po.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(gt(r)),t.push(n)}}return t},Ps=function(e){e.resizeContents()},Ms=function(e){return void 0!==e.toCopyData},Fs=function(){ih.registry.register({name:Up.ESCAPE,preconditionFn:e=>!e.options.readOnly,callback:e=>(e.hideChaff(),!0),keyCodes:[bd.ESC]})},$s=function(){ih.registry.register({name:Up.DELETE,preconditionFn(e){const t=_();return!e.options.readOnly&&null!=t&&t.isDeletable()},callback:(e,t)=>(t.preventDefault(),!Wu.inProgress()&&(_().checkAndDelete(),!0)),keyCodes:[bd.DELETE,bd.BACKSPACE]})},Bs=function(){const e=ih.registry.createSerializedKey(bd.C,[bd.CTRL]),t=ih.registry.createSerializedKey(bd.C,[bd.ALT]),n=ih.registry.createSerializedKey(bd.C,[bd.META]);ih.registry.register({name:Up.COPY,preconditionFn(e){const t=_();return!e.options.readOnly&&!Wu.inProgress()&&null!=t&&t.isDeletable()&&t.isMovable()&&Ms(t)},callback:(e,t)=>(t.preventDefault(),e.hideChaff(),!(!(t=_())||!Ms(t)||(sh=t.toCopyData(),oh=e,!sh))),keyCodes:[e,t,n]})},Us=function(){const e=ih.registry.createSerializedKey(bd.X,[bd.CTRL]),t=ih.registry.createSerializedKey(bd.X,[bd.ALT]),n=ih.registry.createSerializedKey(bd.X,[bd.META]);ih.registry.register({name:Up.CUT,preconditionFn(e){const t=_();return!e.options.readOnly&&!Wu.inProgress()&&null!=t&&t instanceof Bp&&t.isDeletable()&&t.isMovable()&&!t.workspace.isFlyout},callback(e){const t=_();return!(!t||!Ms(t)||(sh=t.toCopyData(),oh=e,t.checkAndDelete(),0))},keyCodes:[e,t,n]})},Vs=function(){const e=ih.registry.createSerializedKey(bd.V,[bd.CTRL]),t=ih.registry.createSerializedKey(bd.V,[bd.ALT]),n=ih.registry.createSerializedKey(bd.V,[bd.META]);ih.registry.register({name:Up.PASTE,preconditionFn:e=>!e.options.readOnly&&!Wu.inProgress(),callback:()=>!(!sh||!oh||!Rn(sh,oh)),keyCodes:[e,t,n]})},Hs=function(){const e=ih.registry.createSerializedKey(bd.Z,[bd.CTRL]),t=ih.registry.createSerializedKey(bd.Z,[bd.ALT]),n=ih.registry.createSerializedKey(bd.Z,[bd.META]);ih.registry.register({name:Up.UNDO,preconditionFn:e=>!e.options.readOnly&&!Wu.inProgress(),callback:e=>(e.hideChaff(),e.undo(!1),!0),keyCodes:[e,t,n]})},Gs=function(){const e=ih.registry.createSerializedKey(bd.Z,[bd.SHIFT,bd.CTRL]),t=ih.registry.createSerializedKey(bd.Z,[bd.SHIFT,bd.ALT]),n=ih.registry.createSerializedKey(bd.Z,[bd.SHIFT,bd.META]),r=ih.registry.createSerializedKey(bd.Y,[bd.CTRL]);ih.registry.register({name:Up.REDO,preconditionFn:e=>!Wu.inProgress()&&!e.options.readOnly,callback:e=>(e.hideChaff(),e.undo(!0),!0),keyCodes:[e,t,n,r]})},js=function(){Fs(),$s(),Bs(),Us(),Vs(),Hs(),Gs()},Ks=function(e){const t={id:e.getId(),name:e.getName(),returnTypes:e.getReturnTypes()};return e.getParameters().length?(t.parameters=e.getParameters().map((e=>Ws(e))),t):t},Ws=function(e){const t={id:e.getId(),name:e.getName()};return e.getTypes().length?(t.types=e.getTypes(),t):t},zs=function(e,t,n,r){if(e=new e(r,n.name,n.id).setReturnTypes(n.returnTypes),!n.parameters)return e;for(const[i,s]of n.parameters.entries())e.insertParameter(qs(t,s,r),i);return e},qs=function(e,t,n){return e=new e(n,t.name,t.id),t.types&&e.setTypes(t.types),e},Js=function(e){const t=Object.create(null),n=l(Uo.SERIALIZER,!0);for(const r in n){let i;const s=null==(i=n[r])?void 0:i.save(e);s&&(t[r]=s)}return t},Ys=function(e,t,{recordUndo:n=!1}={}){var r=l(Uo.SERIALIZER,!0);if(r){r=Object.entries(r).sort(((e,t)=>t[1].priority-e[1].priority));var i=A();I(n),(n=Po.getGroup$$module$build$src$core$events$utils())||Po.setGroup$$module$build$src$core$events$utils(!0),pe(),t instanceof Ip&&t.setResizesEnabled(!1);for(const[,e]of r.reverse()){let n;null==(n=e)||n.clear(t)}for(let[n,i]of r.reverse())if(e[n]){let r;null==(r=i)||r.load(e[n],t)}t instanceof Ip&&t.setResizesEnabled(!0),he(),w(new($(aa))(t)),Po.setGroup$$module$build$src$core$events$utils(n),I(i)}},Xs=function(e,t,n){const r=n.getBoundingRectangle(),i=r.right-r.left,s=pr(t.top,r.top,t.top+t.height-(r.bottom-r.top))-r.top;let o=t.left;return t=t.left+t.width-i,e.RTL?o=Math.min(t,o):t=Math.max(o,t),!(!(e=pr(o,r.left,t)-r.left)&&!s||(n.moveBy(e,s,["inbounds"]),0))},Qs=function(e){return t=>{var n,r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging())if(-1!==la.indexOf(null!=(n=t.type)?n:"")){n=r.getScrollMetrics(!0);const i=Zs(e,t);i&&(r=Po.getGroup$$module$build$src$core$events$utils()||!1,Po.setGroup$$module$build$src$core$events$utils(t.group),Xs(e,n,i)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),Po.setGroup$$module$build$src$core$events$utils(r))}else t.type===ia&&t.scale&&t.oldScale&&t.scale>t.oldScale&&eo(e)}},Zs=function(e,t){let n=null;switch(t.type){case Po.CREATE$$module$build$src$core$events$utils:case Po.MOVE$$module$build$src$core$events$utils:(n=e.getBlockById(t.blockId))&&(n=n.getRootBlock());break;case sa:case oa:n=e.getCommentById(t.commentId)}return n},eo=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var n=e.getTopBoundedElements();for(let r,i=0;r=n[i];i++)Xs(e,t,r)}},to=function(e,t){const n=[];for(const r of e.getIcons())_i(r)&&!r.bubbleIsVisible()||(n.push({location:t,icon:r}),r.onLocationChange(t));for(const r of e.getChildren(!1))n.push(...to(r,el.sum(t,r.relativeCoords)));return n},no=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>0<e.workspace.getUndoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:tu.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},ro=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>0<e.workspace.getRedoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:tu.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},io=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:tu.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},so=function(e,t){function n(t){i--,t.setCollapsed(e),0===i&&Po.setGroup$$module$build$src$core$events$utils(!1)}let r=0,i=0;Po.setGroup$$module$build$src$core$events$utils(!0);for(let e=0;e<t.length;e++){let s=t[e];for(;s;)i++,setTimeout(n.bind(null,s),r),s=s.getNextBlock(),r+=10}},oo=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(!n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){so(!0,e.workspace.getTopBlocks(!0))},scopeType:tu.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},ao=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let n=e[t];for(;n;){if(n.isCollapsed())return"enabled";n=n.getNextBlock()}}return"disabled"}return"hidden"},callback(e){so(!1,e.workspace.getTopBlocks(!0))},scopeType:tu.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},lo=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let n=0;n<e.length;n++)lo(e[n],t)}},co=function(e){const t=[];e=e.getTopBlocks(!0);for(let n=0;n<e.length;n++)lo(e[n],t);return t},uo=function(e,t){t?Po.setGroup$$module$build$src$core$events$utils(t):(Po.setGroup$$module$build$src$core$events$utils(!0),t=Po.getGroup$$module$build$src$core$events$utils());const n=e.shift();n&&(n.isDeadOrDying()?uo(e,t):(n.dispose(!1,!0),setTimeout(uo,10,e,t))),Po.setGroup$$module$build$src$core$events$utils(!1)},po=function(){tu.registry.register({displayText:e=>e.workspace?1===(e=co(e.workspace).length)?Po.Msg$$module$build$src$core$msg.DELETE_BLOCK:Po.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`):"",preconditionFn:e=>e.workspace&&0<co(e.workspace).length?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=co(e.workspace);2>t.length?uo(t):Xe(Po.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),(function(e){e&&uo(t)}))}},scopeType:tu.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},ho=function(){no(),ro(),io(),oo(),ao(),po()},fo=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&Rn(t,e.block.workspace)}},scopeType:tu.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},mo=function(){tu.registry.register({displayText:e=>e.block.hasIcon(Cd.TYPE)?Po.Msg$$module$build$src$core$msg.REMOVE_COMMENT:Po.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(Cd.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:tu.ScopeType.BLOCK,id:"blockComment",weight:2})},_o=function(){tu.registry.register({displayText:e=>e.block.getInputsInline()?Po.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:Po.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed())for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof $h||e.inputList[t]instanceof $h))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:tu.ScopeType.BLOCK,id:"blockInline",weight:3})},go=function(){tu.registry.register({displayText:e=>e.block.isCollapsed()?Po.Msg$$module$build$src$core$msg.EXPAND_BLOCK:Po.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:tu.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},yo=function(){tu.registry.register({displayText:e=>e.block.isEnabled()?Po.Msg$$module$build$src$core$msg.DISABLE_BLOCK:Po.Msg$$module$build$src$core$msg.ENABLE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?e.getInheritedDisabled()?"disabled":"enabled":"hidden",callback(e){e=e.block;const t=Po.getGroup$$module$build$src$core$events$utils();t||Po.setGroup$$module$build$src$core$events$utils(!0),e.setEnabled(!e.isEnabled()),Po.setGroup$$module$build$src$core$events$utils(t)},scopeType:tu.ScopeType.BLOCK,id:"blockDisable",weight:5})},bo=function(){tu.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?Po.Msg$$module$build$src$core$msg.DELETE_BLOCK:Po.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:tu.ScopeType.BLOCK,id:"blockDelete",weight:6})},vo=function(){tu.registry.register({displayText:()=>Po.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:tu.ScopeType.BLOCK,id:"blockHelp",weight:7})},To=function(){fo(),mo(),_o(),go(),yo(),bo(),vo()},ko=function(){ho(),To()},Eo=function(e,t){var n=null;let r;if(n="string"==typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(n)&&document!==(null==(r=n)?void 0:r.ownerDocument))throw Error("Error: container is not in current document");e=new Qu(t||{}),(t=document.createElement("div")).className="injectionDiv",t.tabIndex=0,$n(t,$c.LABEL,Po.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),n.appendChild(t),n=xo(t,e);const i=So(t,n,e);return Co(i),m(i),v(i),t.addEventListener("focusin",(function(){m(i)})),i},xo=function(e,t){e.setAttribute("dir","LTR"),te(t.hasCss,t.pathToMedia),e=re(dl.SVG,{xmlns:il,"xmlns:html":sl,"xmlns:xlink":ol,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const n=re(dl.DEFS,{},e),r=String(Math.random()).substring(2);return t.gridPattern=zu.createDom(r,t.gridOptions,n),e},So=function(e,t,n){n.parentWorkspace=null;const r=(n=new Ip(n)).options;n.scale=r.zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground",e));var i=n.getRenderer().getClassName();return i&&ie(e,i),(i=n.getTheme().getClassName())&&ie(e,i),!r.hasCategories&&r.languageTree&&(e=n.addFlyout(dl.SVG),ce(e,t)),r.hasTrashcan&&n.addTrashcan(),r.zoomOptions&&r.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(Qs(n)),v(n),Vn(),hr(),ti(),n},Co=function(e){const t=e.options;var n=e.getParentSvg();if(W(n.parentNode,"contextmenu",null,(function(e){J(e)||e.preventDefault()})),n=W(window,"resize",null,(function(){li(),e.hideComponents(!0),Lr(),Xn(),v(e),eo(e)})),e.setResizeHandlerWrapper(n),Ao(),t.languageTree){n=e.getToolbox();const r=e.getFlyout(!0);n?n.init():r&&(r.init(e),r.show(t.languageTree),"function"==typeof r.scrollToStart&&r.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new hh(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&wo(t.pathToMedia,e)},Io=function(e){const t=f();t&&!(J(e)||t.rendered&&!t.isVisible())&&ih.registry.onKeyDown(t,e)},Ao=function(){cf||(W(document,"scroll",null,(function(){const e=d();for(let t,n=0;t=e[n];n++)t instanceof Ip&&t.updateInverseScreenCTM()})),W(document,"keydown",null,Io),z(document,"touchend",null,V),z(document,"touchcancel",null,V),Ua&&W(window,"orientationchange",document,(function(){v(f())}))),cf=!0},wo=function(e,t){function n(){for(;i.length;){const e=i.pop();e&&q(e)}r.preload()}const r=t.getAudioManager();r.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),r.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),r.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const i=[];i.push(W(document,"pointermove",null,n,!0)),i.push(W(document,"touchstart",null,n,!0))},No=function(e){return void 0!==e.getType&&void 0!==e.initView&&void 0!==e.dispose&&void 0!==e.getWeight&&void 0!==e.getSize&&void 0!==e.applyColour&&void 0!==e.hideForInsertionMarker&&void 0!==e.updateEditable&&void 0!==e.updateCollapsed&&void 0!==e.isShownWhenCollapsed&&void 0!==e.setOffsetInBlock&&void 0!==e.onLocationChange&&void 0!==e.onClick},Do=function(e){return void 0!==e.paste},Oo=function(e){return e.isSelectable()},Ro=function(e){f().hideChaff(e)},(Lo=Lo||{}).scope={},Lo.ASSUME_ES5=!1,Lo.ASSUME_NO_NATIVE_MAP=!1,Lo.ASSUME_NO_NATIVE_SET=!1,Lo.SIMPLE_FROUND_POLYFILL=!1,Lo.ISOLATE_POLYFILLS=!1,Lo.FORCE_POLYFILL_PROMISE=!1,Lo.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Lo.defineProperty=Lo.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},Lo.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof e&&e];for(var n=0;n<t.length;++n){var r=t[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},Lo.global=Lo.getGlobal(this),Lo.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),Lo.TRUST_ES6_POLYFILLS=!Lo.ISOLATE_POLYFILLS||Lo.IS_SYMBOL_NATIVE,Lo.polyfills={},Lo.propertyToPolyfillSymbol={},Lo.POLYFILL_PREFIX="$jscp$",Lo.polyfill=function(e,t,n,r){t&&(Lo.ISOLATE_POLYFILLS?Lo.polyfillIsolated(e,t,n,r):Lo.polyfillUnisolated(e,t,n,r))},Lo.polyfillUnisolated=function(e,t,n,r){for(n=Lo.global,e=e.split("."),r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))return;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&Lo.defineProperty(n,e,{configurable:!0,writable:!0,value:t})},Lo.polyfillIsolated=function(e,t,n,r){var i=e.split(".");e=1===i.length,r=i[0],r=!e&&r in Lo.polyfills?Lo.polyfills:Lo.global;for(var s=0;s<i.length-1;s++){var o=i[s];if(!(o in r))return;r=r[o]}i=i[i.length-1],null!=(t=t(n=Lo.IS_SYMBOL_NATIVE&&"es6"===n?r[i]:null))&&(e?Lo.defineProperty(Lo.polyfills,i,{configurable:!0,writable:!0,value:t}):t!==n&&(void 0===Lo.propertyToPolyfillSymbol[i]&&(n=1e9*Math.random()>>>0,Lo.propertyToPolyfillSymbol[i]=Lo.IS_SYMBOL_NATIVE?Lo.global.Symbol(i):Lo.POLYFILL_PREFIX+n+"$"+i),Lo.defineProperty(r,Lo.propertyToPolyfillSymbol[i],{configurable:!0,writable:!0,value:t})))},Lo.polyfill("globalThis",(function(e){return e||Lo.global}),"es_2020","es3"),Lo.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},Lo.arrayIterator=function(e){return{next:Lo.arrayIteratorImpl(e)}},Lo.initSymbol=function(){},Lo.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},Lo.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i},Lo.polyfill("Array.prototype.values",(function(e){return e||function(){return Lo.iteratorFromArray(this,(function(e,t){return t}))}}),"es8","es3"),Lo.polyfill("Array.prototype.flat",(function(e){return e||function(e){e=void 0===e?1:e;var t=[];return Array.prototype.forEach.call(this,(function(n){Array.isArray(n)&&0<e?(n=Array.prototype.flat.call(n,e-1),t.push.apply(t,n)):t.push(n)})),t}}),"es9","es5"),Lo.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Lo.polyfill("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)Lo.owns(e,t)&&n.push([t,e[t]]);return n}}),"es8","es3"),Lo.polyfill("Object.values",(function(e){return e||function(e){var t,n=[];for(t in e)Lo.owns(e,t)&&n.push(e[t]);return n}}),"es8","es3");var Mo=Object.create(null),Fo={typeMap:Mo},$o=Object.create(null),Bo="default",Uo=class{constructor(e){this.name=e}toString(){return this.name}};Uo.CONNECTION_CHECKER=new Uo("connectionChecker"),Uo.CONNECTION_PREVIEWER=new Uo("connectionPreviewer"),Uo.CURSOR=new Uo("cursor"),Uo.EVENT=new Uo("event"),Uo.FIELD=new Uo("field"),Uo.INPUT=new Uo("input"),Uo.RENDERER=new Uo("renderer"),Uo.TOOLBOX=new Uo("toolbox"),Uo.THEME=new Uo("theme"),Uo.TOOLBOX_ITEM=new Uo("toolboxItem"),Uo.FLYOUTS_VERTICAL_TOOLBOX=new Uo("flyoutsVerticalToolbox"),Uo.FLYOUTS_HORIZONTAL_TOOLBOX=new Uo("flyoutsHorizontalToolbox"),Uo.METRICS_MANAGER=new Uo("metricsManager"),Uo.BLOCK_DRAGGER=new Uo("blockDragger"),Uo.SERIALIZER=new Uo("serializer"),Uo.ICON=new Uo("icon"),Uo.PASTER=new Uo("paster");var Vo={DEFAULT:Bo,TEST_ONLY:Fo};Vo.Type=Uo,Vo.getAllItems=l,Vo.getClass=o,Vo.getClassFromOptions=c,Vo.getObject=a,Vo.hasItem=s,Vo.register=t,Vo.unregister=r;var Ho,Go,jo=Object.create(null),Ko=Object.create(null),Wo=null,zo=[],qo={defineBlocksWithJsonArrayInternal:x},Jo={TEST_ONLY:qo};Jo.createBlockDefinitionsFromJsonArray=Po.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,Jo.defineBlocks=Po.defineBlocks$$module$build$src$core$common,Jo.defineBlocksWithJsonArray=E,Jo.draggingConnections=zo,Jo.getAllWorkspaces=d,Jo.getBlockTypeCounts=T,Jo.getMainWorkspace=f,Jo.getParentContainer=y,Jo.getSelected=_,Jo.getWorkspaceById=u,Jo.registerWorkspace=p,Jo.setMainWorkspace=m,Jo.setParentContainer=b,Jo.setSelected=g,Jo.svgResize=v,Jo.unregisterWorkpace=h;var Yo,Xo,Qo,Zo,ea,ta,na,ra,ia,sa,oa,aa,la,ca,ua,da,pa={genUid:()=>{const e="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".length,t=[];for(let n=0;20>n;n++)t[n]="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.random()*e);return t.join("")}},ha=0,fa={TEST_ONLY:pa};fa.genUid=C,fa.getNextUniqueId=S,Yo="",Xo=!0,Qo=0,Po.CREATE$$module$build$src$core$events$utils="create",Po.CREATE$$module$build$src$core$events$utils,Po.DELETE$$module$build$src$core$events$utils="delete",Po.DELETE$$module$build$src$core$events$utils,Po.CHANGE$$module$build$src$core$events$utils="change",Po.CHANGE$$module$build$src$core$events$utils,Zo="block_field_intermediate_change",Po.MOVE$$module$build$src$core$events$utils="move",Po.MOVE$$module$build$src$core$events$utils,ea="var_create",ta="ui",na="click",ra="bubble_open",ia="viewport_change",sa="comment_create",oa="comment_move",aa="finished_loading",la=[Po.CREATE$$module$build$src$core$events$utils,Po.MOVE$$module$build$src$core$events$utils,sa,oa],ua={FIRE_QUEUE:ca=[],fireNow:D,fireInternal:N,setGroupInternal:P},(da={BLOCK_CHANGE:Po.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:Po.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:Po.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:"drag",BLOCK_FIELD_INTERMEDIATE_CHANGE:Zo,BLOCK_MOVE:Po.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:ra,BUMP_EVENTS:la,CHANGE:Po.CHANGE$$module$build$src$core$events$utils,CLICK:na,COMMENT_CHANGE:"comment_change",COMMENT_CREATE:sa,COMMENT_DELETE:"comment_delete",COMMENT_MOVE:oa,CREATE:Po.CREATE$$module$build$src$core$events$utils,DELETE:Po.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:aa,MARKER_MOVE:"marker_move",MOVE:Po.MOVE$$module$build$src$core$events$utils,SELECTED:"selected",TEST_ONLY:ua,THEME_CHANGE:"theme_change",TOOLBOX_ITEM_SELECT:"toolbox_item_select",TRASHCAN_OPEN:"trashcan_open",UI:ta,VAR_CREATE:ea,VAR_DELETE:"var_delete",VAR_RENAME:"var_rename",VIEWPORT_CHANGE:ia}).clearPendingUndo=R,da.disable=Po.disable$$module$build$src$core$events$utils,da.disableOrphans=B,da.enable=Po.enable$$module$build$src$core$events$utils,da.filter=O,da.fire=w,da.fromJson=F,da.get=$,da.getDescendantIds=M,da.getGroup=Po.getGroup$$module$build$src$core$events$utils,da.getRecordUndo=A,da.isEnabled=L,da.setGroup=Po.setGroup$$module$build$src$core$events$utils,da.setRecordUndo=I;var ma,_a,ga=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=Po.getGroup$$module$build$src$core$events$utils(),this.recordUndo=A()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,n){return n.isBlank=!1,n.group=e.group||"",n.workspaceId=t.id,n}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=u(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},ya=class extends ga{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===e,this.workspaceId=e||""}},ba=class extends ya{constructor(e,t,n){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=na,this.blockId=e?e.id:void 0,this.targetType=n}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new ba)).targetType=e.targetType,t.blockId=e.blockId,t}};(_a=ma||(ma={})).BLOCK="block",_a.WORKSPACE="workspace",_a.ZOOM_CONTROLS="zoom_controls",t(Uo.EVENT,na,ba);var va={};va.Click=ba,va.ClickTarget=ma;var Ta,ka,Ea,xa,Sa,Ca,Ia,Aa,wa,Na,Da=750,Oa="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Ra=null,La={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Pa=0,Ma={TOUCH_ENABLED:Oa,TOUCH_MAP:La};Ma.checkTouchIdentifier=K,Ma.clearTouchIdentifier=H,Ma.getTouchIdentifierFromEvent=j,Ma.longStart=U,Ma.longStop=V,Ma.shouldHandleEvent=G,function(e){function t(e){return-1!==n.indexOf(e.toUpperCase())}const n=(Ta=e).toUpperCase();ka=t("JavaFX"),Ea=t("WebKit"),xa=t("Gecko")&&!Ea,Sa=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Ca=t("iPad")||t("Macintosh")&&0<e,Ia=t("iPhone")&&!Ca,Aa=t("Macintosh"),wa=Ca||Sa&&!t("Mobile")||t("Silk"),Na=!wa&&(Ia||Sa)}(globalThis.navigator&&globalThis.navigator.userAgent||"");var Fa=ka,$a=xa,Ba=Sa,Ua=Ca,Va=Ia,Ha=Aa,Ga=Na,ja={ANDROID:Ba,GECKO:$a,IPAD:Ua,IPHONE:Va,JavaFx:Fa,MAC:Ha,MOBILE:Ga,raw:Ta},Ka=40,Wa=125,za={};za.bind=z,za.conditionalBind=W,za.getScrollDeltaPixels=Q,za.isRightButton=Y,za.isTargetInput=J,za.mouseToSvg=X,za.unbind=q;var qa={};qa.removeElem=Z;var Ja=class{constructor(e){this.name_=e}toString(){return this.name_}};Ja.POSITIONABLE=new Ja("positionable"),Ja.DRAG_TARGET=new Ja("drag_target"),Ja.DELETE_AREA=new Ja("delete_area"),Ja.AUTOHIDEABLE=new Ja("autohideable");var Ya=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const n=e.component.id;var r;if(!t&&this.componentData.has(n))throw Error('Plugin "'+n+'" with capabilities "'+(null==(r=this.componentData.get(n))?void 0:r.capabilities)+'" already added.');for(this.componentData.set(n,e),t=[],r=0;r<e.capabilities.length;r++){const i=String(e.capabilities[r]).toLowerCase();if(t.push(i),this.capabilityToComponentIds.has(i)){let e;null==(e=this.capabilityToComponentIds.get(i))||e.push(n)}else this.capabilityToComponentIds.set(i,[n])}this.componentData.get(n).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let n=0;n<t.capabilities.length;n++){const r=String(t.capabilities[n]).toLowerCase();Z(this.capabilityToComponentIds.get(r),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var n,r;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t=`${t}`.toLowerCase(),null==(n=this.componentData.get(e))||n.capabilities.push(t),null==(r=this.capabilityToComponentIds.get(t))||r.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),Z(this.componentData.get(e).capabilities,t),Z(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&-1!==this.componentData.get(e).capabilities.indexOf(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];const n=[];if(t){const t=[];e.forEach((e=>{t.push(this.componentData.get(e))})),t.sort((function(e,t){return e.weight-t.weight})),t.forEach((function(e){n.push(e.component)}))}else e.forEach((e=>{n.push(this.componentData.get(e).component)}));return n}};Ya.Capability=Ja;var Xa=!1,Qa='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyBlockDragSurface {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n',Za={};Za.inject=te,Za.register=ee;var el=class{constructor(e,t){this.x=e,this.y=t}clone(){return new el(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){const n=e.x-t.x;return e=e.y-t.y,Math.sqrt(n*n+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new el(e.x-t.x,e.y-t.y)}static sum(e,t){return new el(e.x+t.x,e.y+t.y)}},tl=new Set,nl={};nl.warn=ne;var rl,il="http://www.w3.org/2000/svg",sl="http://www.w3.org/1999/xhtml",ol="http://www.w3.org/1999/xlink";!function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"}(rl||(rl={}));var al=null,ll=0,cl=null,ul={HTML_NS:sl};ul.NodeType=rl,ul.SVG_NS=il,ul.XLINK_NS=ol,ul.addClass=ie,ul.containsNode=ue,ul.createSvgElement=re,ul.getFastTextWidth=me,ul.getFastTextWidthWithSizeString=_e,ul.getTextWidth=fe,ul.hasClass=ae,ul.insertAfter=ce,ul.measureFontMetrics=ge,ul.removeClass=oe,ul.removeClasses=se,ul.removeNode=le,ul.setCssTransform=de,ul.startTextWidthCache=pe,ul.stopTextWidthCache=he;var dl=class{constructor(e){this.tagName=e}toString(){return this.tagName}};dl.ANIMATE=new dl("animate"),dl.CIRCLE=new dl("circle"),dl.CLIPPATH=new dl("clipPath"),dl.DEFS=new dl("defs"),dl.FECOMPOSITE=new dl("feComposite"),dl.FECOMPONENTTRANSFER=new dl("feComponentTransfer"),dl.FEFLOOD=new dl("feFlood"),dl.FEFUNCA=new dl("feFuncA"),dl.FEGAUSSIANBLUR=new dl("feGaussianBlur"),dl.FEPOINTLIGHT=new dl("fePointLight"),dl.FESPECULARLIGHTING=new dl("feSpecularLighting"),dl.FILTER=new dl("filter"),dl.FOREIGNOBJECT=new dl("foreignObject"),dl.G=new dl("g"),dl.IMAGE=new dl("image"),dl.LINE=new dl("line"),dl.PATH=new dl("path"),dl.PATTERN=new dl("pattern"),dl.POLYGON=new dl("polygon"),dl.RECT=new dl("rect"),dl.SVG=new dl("svg"),dl.TEXT=new dl("text"),dl.TSPAN=new dl("tspan");var pl=class{constructor(e,t,n,r){this.top=e,this.bottom=t,this.left=n,this.right=r}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return!(this.left>e.right||this.right<e.left||this.top>e.bottom||this.bottom<e.top)}},hl=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}},fl={getSizeInternal:be},ml={TEST_ONLY:fl};ml.getBorderBox=xe,ml.getComputedStyle=Te,ml.getContainerOffsetToScrollInto=Ce,ml.getPageOffset=ke,ml.getSize=ye,ml.getViewportPageOffset=Ee,ml.scrollIntoContainerView=Se;var _l=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,gl=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,yl={TEST_ONLY:{XY_REGEX:_l,XY_STYLE_REGEX:gl}};yl.getDocumentScroll=Ne,yl.getInjectionDivXY=Ae,yl.getRelativeXY=Ie,yl.getViewportBBox=we,yl.screenToWsCoordinates=De,yl.wsToScreenCoordinates=Oe;var bl=class{constructor(e,t,n,r,i){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new el(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new el(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=n||!1,this.margin=void 0!==i?i:bl.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),r&&(e+=" "+r),this.outerSvg=re(dl.SVG,{class:e}),r=re(dl.G,{},this.outerSvg),this.svgBackground=re(dl.RECT,{class:"blocklyScrollbarBackground"},r),e=Math.floor((bl.scrollbarThickness-5)/2),this.svgHandle=re(dl.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},r),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),ce(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=W(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=W(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=bl.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),q(this.onMouseDownBarWrapper_),q(this.onMouseDownHandleWrapper_),le(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return 0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,de(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){(e||(e=this.workspace.getMetrics()))&&(this.oldHostMetrics&&bl.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics()))}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=bl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=bl.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-bl.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var n=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=bl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-bl.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var n=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*n,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=n/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),H(),this.cleanUp(),Y(e))e.stopPropagation();else{var t=X(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var n=Ae(this.svgHandle);n=this.horizontal?n.x:n.y;var r=this.handlePosition,i=.95*this.handleLength;t<=n?r-=i:t>=n+this.handleLength&&(r+=i),this.setHandlePosition(this.constrainHandlePosition(r)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),Y(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=W(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=W(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){H(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(q(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(q(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new el(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};bl.scrollbarThickness=Oa?25:15,bl.DEFAULT_SCROLLBAR_MARGIN=.5;var vl={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},Tl={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:kl,DOMParser:El,XMLSerializer:xl}=globalThis;El&&(vl=new El),xl&&(Tl=new xl);var Sl="https://developers.google.com/blockly/xml",Cl=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Il={NAME_SPACE:Sl};Il.createElement=Po.createElement$$module$build$src$core$utils$xml,Il.createTextNode=Po.createTextNode$$module$build$src$core$utils$xml,Il.domToText=Le,Il.injectDependencies=Re,Il.textToDom=Po.textToDom$$module$build$src$core$utils$xml;var Al,wl="categoryToolbox",Nl="flyoutToolbox";!function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(Al||(Al={}));var Dl,Ol,Rl,Ll={hasCategoriesInternal:Ue},Pl={};Pl.Position=Al,Pl.TEST_ONLY=Ll,Pl.convertFlyoutDefToJsonArray=$e,Pl.convertToolboxDefToJson=Me,Pl.hasCategories=Be,Pl.isCategoryCollapsible=Ve,Pl.parseToolboxTree=Ke,function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"}(Dl||(Dl={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"}(Ol||(Ol={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(Rl||(Rl={}));var Ml={};Ml.bumpDirection=Rl,Ml.bumpPositionRect=qe,Ml.getCornerOppositeToolbox=ze,Ml.getStartPositionRect=We,Ml.horizontalPosition=Ol,Ml.verticalPosition=Dl;var Fl=96,$l=124,Bl="sprites.png",Ul=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=re(dl.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[Ya.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&le(this.svgGroup);for(const e of this.boundEvents)q(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new pl(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var n,r=ze(this.workspace,e),i=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(i+=this.LARGE_SPACING+this.HEIGHT),e=We(r,new hl(this.WIDTH,i),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=qe(e,this.MARGIN_VERTICAL,r===Dl.TOP?Rl.DOWN:Rl.UP,t),r===Dl.TOP){var s,o=this.SMALL_SPACING+this.HEIGHT;null==(s=this.zoomInGroup)||s.setAttribute("transform","translate(0, "+o+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(o+this.LARGE_SPACING+this.HEIGHT)+")")}else{let e;s=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(e=this.zoomInGroup)||e.setAttribute("transform","translate(0, "+s+")"),s=s+this.SMALL_SPACING+this.HEIGHT,null==(o=this.zoomOutGroup)||o.setAttribute("transform","translate(0, "+s+")")}this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=re(dl.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=re(dl.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);re(dl.RECT,{width:32,height:32},t),re(dl.IMAGE,{width:Fl,height:$l,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(ol,"xlink:href",this.workspace.options.pathToMedia+Bl),this.boundEvents.push(W(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=re(dl.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=re(dl.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);re(dl.RECT,{width:32,height:32},t),re(dl.IMAGE,{width:Fl,height:$l,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(ol,"xlink:href",this.workspace.options.pathToMedia+Bl),this.boundEvents.push(W(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),H(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=re(dl.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=re(dl.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);re(dl.RECT,{width:32,height:32},t),re(dl.IMAGE,{width:Fl,height:$l,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(ol,"xlink:href",this.workspace.options.pathToMedia+Bl),this.boundEvents.push(W(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),H(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new($(na))(null,this.workspace.id,"zoom_controls");w(e)}};ee("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var Vl=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Vl.MUTATOR=new Vl("mutator"),Vl.WARNING=new Vl("warning"),Vl.COMMENT=new Vl("comment"),function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"}(Po.inputTypes$$module$build$src$core$inputs$input_types||(Po.inputTypes$$module$build$src$core$inputs$input_types={})),Po.inputTypes$$module$build$src$core$inputs$input_types;var Hl,Gl,jl=function(e,t){window.alert(e),t&&t()},Kl=function(e,t){t(window.confirm(e))},Wl=function(e,t,n){n(window.prompt(e,t))},zl={confirmInternal:Qe},ql={TEST_ONLY:zl};ql.alert=Je,ql.confirm=Xe,ql.prompt=et,ql.setAlert=Ye,ql.setConfirm=Ze,ql.setPrompt=tt,Po.Msg$$module$build$src$core$msg=Object.create(null),Hl=function(e){Object.keys(e).forEach((function(t){Po.Msg$$module$build$src$core$msg[t]=e[t]}))},Gl={Msg:Po.Msg$$module$build$src$core$msg,setLocale:Hl};var Jl={};Jl.isLegacyProcedureCallBlock=it,Jl.isLegacyProcedureDefBlock=rt;var Yl=class extends ga{constructor(e){super(),this.isBlank=void 0===e,e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Yl)).varId=e.varId,t}},Xl=class extends Yl{constructor(e){super(e),this.type=ea,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Xl)).varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};t(Uo.EVENT,ea,Xl);var Ql=class{constructor(e,t,n,r){this.workspace=e,this.name=t,this.type=n||"",this.id_=r||C()}getId(){return this.id_}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},Zl="ijkmnopqrstuvwxyzabcdefgh",ec={generateUniqueNameInternal:lt},tc={CATEGORY_NAME:"VARIABLE",TEST_ONLY:ec,VAR_LETTER_OPTIONS:Zl};tc.allDeveloperVariables=Po.allDeveloperVariables$$module$build$src$core$variables,tc.allUsedVarModels=Po.allUsedVarModels$$module$build$src$core$variables,tc.createVariableButtonHandler=ut,tc.flyoutCategory=st,tc.flyoutCategoryBlocks=ot,tc.generateUniqueName=at,tc.generateUniqueNameFromOptions=ct,tc.generateVariableFieldDom=gt,tc.getAddedVariables=bt,tc.getOrCreateVariablePackage=Po.getOrCreateVariablePackage$$module$build$src$core$variables,tc.getVariable=Po.getVariable$$module$build$src$core$variables,tc.nameUsedWithAnyType=ht,tc.nameUsedWithConflictingParam=ft,tc.promptName=dt,tc.renameVariable=Po.renameVariable$$module$build$src$core$variables;var nc=class{constructor(e,t,n,r,i){this.workspace=e,this.editable=this.movable=this.deletable=!0,this.disposed_=!1,this.isComment=!0,this.id=i&&!e.getCommentById(i)?i:C(),e.addTopComment(this),this.xy_=new el(0,0),this.height_=n,this.width_=r,this.RTL=e.RTL,this.content_=t,nc.fireCreateEvent(this)}dispose(){this.disposed_||(L()&&w(new($("comment_delete"))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(e){this.height_=e}getWidth(){return this.width_}setWidth(e){this.width_=e}getRelativeToSurfaceXY(){return new el(this.xy_.x,this.xy_.y)}moveBy(e,t){const n=new($(oa))(this);this.xy_.translate(e,t),n.recordNew(),w(n)}isDeletable(){return this.deletable&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(e){this.movable=e}isEditable(){return this.editable&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(e){this.editable=e}getContent(){return this.content_}setContent(e){this.content_!==e&&(w(new($("comment_change"))(this,this.content_,e)),this.content_=e)}toXmlWithXY(e){return(e=this.toXml(e)).setAttribute("x",String(Math.round(this.xy_.x))),e.setAttribute("y",String(Math.round(this.xy_.y))),e.setAttribute("h",String(this.height_)),e.setAttribute("w",String(this.width_)),e}toXml(e){const t=Po.createElement$$module$build$src$core$utils$xml("comment");return e||(t.id=this.id),t.textContent=this.getContent(),t}static fireCreateEvent(e){if(L()){const t=Po.getGroup$$module$build$src$core$events$utils();t||Po.setGroup$$module$build$src$core$events$utils(!0);try{w(new($(sa))(e))}finally{Po.setGroup$$module$build$src$core$events$utils(t)}}}static fromXml(e,t){var n=nc.parseAttributes(e);return t=new nc(t,n.content,n.h,n.w,n.id),n=e.getAttribute("x"),e=e.getAttribute("y"),n=n?parseInt(n,10):NaN,e=e?parseInt(e,10):NaN,isNaN(n)||isNaN(e)||t.moveBy(n,e),nc.fireCreateEvent(t),t}static parseAttributes(e){const t=e.getAttribute("h"),n=e.getAttribute("w"),r=e.getAttribute("x"),i=e.getAttribute("y"),s=e.getAttribute("id");if(!s)throw Error("No ID present in XML comment definition.");let o;return{id:s,h:t?parseInt(t):100,w:n?parseInt(n):100,x:r?parseInt(r):NaN,y:i?parseInt(i):NaN,content:null!=(o=e.textContent)?o:""}}},rc=class extends ya{constructor(e,t,n){super(n),this.type="selected",this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new rc)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};t(Uo.EVENT,"selected",rc);var ic={};ic.register=vt,ic.unregister=Tt;var sc=class{paste(e,t,n){const r=e.commentState;if(n)r.setAttribute("x",`${n.x}`),r.setAttribute("y",`${n.y}`);else{var i;let e;n=parseInt(null!=(i=r.getAttribute("x"))?i:"0")+50,i=parseInt(null!=(e=r.getAttribute("y"))?e:"0")+50,r.setAttribute("x",`${n}`),r.setAttribute("y",`${i}`)}return oc.fromXmlRendered(e.commentState,t)}};sc.TYPE="workspace-comment",vt(sc.TYPE,new sc);var oc=class extends nc{constructor(e,t,n,r,i){super(e,t,n,r,i),this.onMouseMoveWrapper=this.onMouseUpWrapper=null,this.eventsInit=!1,this.deleteIconBorder=this.deleteGroup=this.resizeGroup=this.foreignObject=this.svgHandleTarget=this.svgRectTarget=this.textarea=null,this.rendered=this.autoLayout=this.focused=!1,this.svgGroup=re(dl.G,{class:"blocklyComment"}),this.workspace=e,this.svgRect_=re(dl.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:3,ry:3}),this.svgGroup.appendChild(this.svgRect_),this.render()}dispose(){this.disposed_||(_()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),L()&&w(new($("comment_delete"))(this)),le(this.svgGroup),Po.disable$$module$build$src$core$events$utils(),super.dispose(),Po.enable$$module$build$src$core$events$utils())}initSvg(e){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit||(W(this.svgRectTarget,"pointerdown",this,this.pathMouseDown),W(this.svgHandleTarget,"pointerdown",this,this.pathMouseDown)),this.eventsInit=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!e&&this.textarea&&this.textarea.select()}pathMouseDown(e){const t=this.workspace.getGesture(e);t&&t.handleBubbleStart(e,this)}showContextMenu(e){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(_()!==this){var e=null;if(_()){e=_().id,Po.disable$$module$build$src$core$events$utils();try{_().unselect()}finally{Po.enable$$module$build$src$core$events$utils()}}e=new($("selected"))(e,this.id,this.workspace.id),w(e),g(this),this.addSelect()}}unselect(){if(_()===this){var e=new($("selected"))(this.id,null,this.workspace.id);w(e),g(null),this.removeSelect(),this.blurFocus()}}addSelect(){ie(this.svgGroup,"blocklySelected"),this.setFocus()}removeSelect(){ie(this.svgGroup,"blocklySelected"),this.blurFocus()}addFocus(){ie(this.svgGroup,"blocklyFocused")}removeFocus(){oe(this.svgGroup,"blocklyFocused")}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,r=this.getSvgRoot();if(r)do{const e=Ie(r);t+=e.x,n+=e.y,r=r.parentNode}while(r&&!e.hasLayer(r)&&null!==r);return this.xy_=new el(t,n)}moveBy(e,t){const n=new($(oa))(this),r=this.getRelativeToSurfaceXY();this.translate(r.x+e,r.y+t),this.xy_=new el(r.x+e,r.y+t),n.recordNew(),w(n),this.workspace.resizeContents()}translate(e,t){this.xy_=new el(e,t),this.getSvgRoot().setAttribute("transform","translate("+e+","+t+")")}moveDuringDrag(e){e=`translate(${e.x}, ${e.y})`,this.getSvgRoot().setAttribute("transform",e)}moveTo(e,t){this.translate(e,t)}clearTransformAttributes(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var e=this.getRelativeToSurfaceXY();const t=this.getHeightWidth(),n=e.y,r=e.y+t.height;let i;return this.RTL?(i=e.x-t.width,e=e.x):(i=e.x,e=e.x+t.width),new pl(n,r,i,e)}updateMovable(){this.isMovable()?ie(this.svgGroup,"blocklyDraggable"):oe(this.svgGroup,"blocklyDraggable")}setMovable(e){super.setMovable(e),this.updateMovable()}setEditable(e){super.setEditable(e),this.textarea&&(this.textarea.readOnly=!e)}setDragging(e){e?ie(this.getSvgRoot(),"blocklyDragging"):oe(this.getSvgRoot(),"blocklyDragging")}getSvgRoot(){return this.svgGroup}getContent(){return this.textarea?this.textarea.value:this.content_}setContent(e){super.setContent(e),this.textarea&&(this.textarea.value=e)}setDeleteStyle(e){e?ie(this.svgGroup,"blocklyDraggingDelete"):oe(this.svgGroup,"blocklyDraggingDelete")}setAutoLayout(e){}toXmlWithXY(e){let t=0;this.workspace.RTL&&(t=this.workspace.getWidth()),e=this.toXml(e);const n=this.getRelativeToSurfaceXY();return e.setAttribute("x",String(Math.round(this.workspace.RTL?t-n.x:n.x))),e.setAttribute("y",String(Math.round(n.y))),e.setAttribute("h",String(this.getHeight())),e.setAttribute("w",String(this.getWidth())),e}toCopyData(){return{paster:sc.TYPE,commentState:this.toXmlWithXY()}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered){var e=this.getHeightWidth(),t=this.createEditor();this.svgGroup.appendChild(t),this.svgHandleTarget=re(dl.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup.appendChild(this.svgHandleTarget),this.svgRectTarget=re(dl.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:3,ry:3}),this.svgGroup.appendChild(this.svgRectTarget),this.addResizeDom(),this.isDeletable()&&this.addDeleteDom(),this.setSize(e.width,e.height),this.textarea.value=this.content_,this.rendered=!0,this.resizeGroup&&W(this.resizeGroup,"pointerdown",this,this.resizeMouseDown),this.isDeletable()&&(W(this.deleteGroup,"pointerdown",this,this.deleteMouseDown),W(this.deleteGroup,"pointerout",this,this.deleteMouseOut),W(this.deleteGroup,"pointerup",this,this.deleteMouseUp))}}createEditor(){this.foreignObject=re(dl.FOREIGNOBJECT,{x:0,y:oc.TOP_OFFSET,class:"blocklyCommentForeignObject"});const e=document.createElementNS(sl,"body");e.setAttribute("xmlns",sl),e.className="blocklyMinimalBody";const t=document.createElementNS(sl,"textarea");return t.className="blocklyCommentTextarea",t.setAttribute("dir",this.RTL?"RTL":"LTR"),t.readOnly=!this.isEditable(),e.appendChild(t),this.textarea=t,this.foreignObject.appendChild(e),W(t,"wheel",this,(function(e){e.stopPropagation()})),W(t,"change",this,(function(e){this.setContent(t.value)})),this.foreignObject}addResizeDom(){this.resizeGroup=re(dl.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup),re(dl.POLYGON,{points:"0,8 8,8 8,0"},this.resizeGroup),re(dl.LINE,{class:"blocklyResizeLine",x1:8/3,y1:7,x2:7,y2:8/3},this.resizeGroup),re(dl.LINE,{class:"blocklyResizeLine",x1:16/3,y1:7,x2:7,y2:16/3},this.resizeGroup)}addDeleteDom(){this.deleteGroup=re(dl.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup),this.deleteIconBorder=re(dl.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup),re(dl.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup),re(dl.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup)}resizeMouseDown(e){this.unbindDragEvents(),Y(e)||(this.workspace.startDrag(e,new el(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper=W(document,"pointerup",this,this.resizeMouseUp),this.onMouseMoveWrapper=W(document,"pointermove",this,this.resizeMouseMove),this.workspace.hideChaff()),e.stopPropagation()}deleteMouseDown(e){this.deleteIconBorder&&ie(this.deleteIconBorder,"blocklyDeleteIconHighlighted"),e.stopPropagation()}deleteMouseOut(e){this.deleteIconBorder&&oe(this.deleteIconBorder,"blocklyDeleteIconHighlighted")}deleteMouseUp(e){this.dispose(),e.stopPropagation()}unbindDragEvents(){this.onMouseUpWrapper&&(q(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onMouseMoveWrapper&&(q(this.onMouseMoveWrapper),this.onMouseMoveWrapper=null)}resizeMouseUp(e){H(),this.unbindDragEvents()}resizeMouseMove(e){this.autoLayout=!1,e=this.workspace.moveDrag(e),this.setSize(this.RTL?-e.x:e.x,e.y)}resizeComment(){const e=this.getHeightWidth(),t=oc.TOP_OFFSET;let n,r;if(null==(n=this.foreignObject)||n.setAttribute("width",String(e.width)),null==(r=this.foreignObject)||r.setAttribute("height",String(e.height-t)),this.RTL){let t;null==(t=this.foreignObject)||t.setAttribute("x",String(-e.width))}this.textarea&&(this.textarea.style.width=e.width-4+"px",this.textarea.style.height=e.height-4-t+"px")}setSize(e,t){let n,r,i,s;if(e=Math.max(e,45),t=Math.max(t,20+oc.TOP_OFFSET),this.width_=e,this.height_=t,this.svgRect_.setAttribute("width",`${e}`),this.svgRect_.setAttribute("height",`${t}`),null==(n=this.svgRectTarget)||n.setAttribute("width",`${e}`),null==(r=this.svgRectTarget)||r.setAttribute("height",`${t}`),null==(i=this.svgHandleTarget)||i.setAttribute("width",`${e}`),null==(s=this.svgHandleTarget)||s.setAttribute("height",String(oc.TOP_OFFSET)),this.RTL){let e;this.svgRect_.setAttribute("transform","scale(-1 1)"),null==(e=this.svgRectTarget)||e.setAttribute("transform","scale(-1 1)")}if(this.resizeGroup)if(this.RTL){let n;this.resizeGroup.setAttribute("transform","translate("+(8-e)+","+(t-8)+") scale(-1 1)"),null==(n=this.deleteGroup)||n.setAttribute("transform","translate("+(8-e)+","+"-8) scale(-1 1)")}else{let n;this.resizeGroup.setAttribute("transform","translate("+(e-8)+","+(t-8)+")"),null==(n=this.deleteGroup)||n.setAttribute("transform","translate("+(e-8)+","+"-8)")}this.resizeComment()}setFocus(){this.focused=!0,setTimeout((()=>{this.disposed_||(this.textarea.focus(),this.addFocus(),this.svgRectTarget&&ie(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&ie(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))}),0)}blurFocus(){this.focused=!1,setTimeout((()=>{this.disposed_||(this.textarea.blur(),this.removeFocus(),this.svgRectTarget&&oe(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&oe(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))}),0)}static fromXmlRendered(e,t,n){let r;Po.disable$$module$build$src$core$events$utils();try{const i=nc.parseAttributes(e);if(r=new oc(t,i.content,i.h,i.w,i.id),t.rendered&&(r.initSvg(!0),r.render()),!isNaN(i.x)&&!isNaN(i.y))if(t.RTL){const e=n||t.getWidth();r.moveBy(e-i.x,i.y)}else r.moveBy(i.x,i.y)}finally{Po.enable$$module$build$src$core$events$utils()}return nc.fireCreateEvent(r),r}};oc.DEFAULT_SIZE=100,oc.TOP_OFFSET=10,ee("\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n");var ac=new Set,lc=new WeakSet,cc=null,uc=null,dc=0,pc={};pc.finishQueuedRenders=Et,pc.queueRender=kt,pc.triggerQueuedRenders=xt;var hc={};hc.appendDomToWorkspace=Vt,hc.blockToDom=Mt,hc.blockToDomWithXY=Rt,hc.clearWorkspaceAndLoadFromXml=Ut,hc.deleteNext=en,hc.domToBlock=Po.domToBlock$$module$build$src$core$xml,hc.domToBlockInternal=Ht,hc.domToPrettyText=Bt,hc.domToText=$t,hc.domToVariables=Gt,hc.domToWorkspace=Po.domToWorkspace$$module$build$src$core$xml,hc.variablesToDom=Ot,hc.workspaceToDom=Dt;var fc=class extends Error{},mc=class extends fc{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},_c=class extends fc{constructor(e,t,n){super(`The block ${t.toDevString()} is missing a(n) ${e}\nconnection`),this.block=t,this.state=n}},gc=class extends fc{constructor(e,t,n,r){super(`The block ${n.toDevString()} could not connect its\n${t} to its parent, because: ${e}`),this.childBlock=n,this.childState=r}},yc=class extends fc{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},bc=class extends fc{constructor(e,t,n){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=n}},vc={};vc.BadConnectionCheck=gc,vc.DeserializationError=fc,vc.MissingBlockType=mc,vc.MissingConnection=_c,vc.RealChildOfShadow=yc,vc.UnregisteredIcon=bc;var Tc={};Tc.register=rn,Tc.unregister=sn;var kc=class{constructor(){this.priority=50}save(e){const t=[];for(const n of e.getTopBlocks(!1))(e=on(n,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const n of e)mn(n,t,{recordUndo:A()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};rn("blocks",new kc);var Ec={};Ec.BlockSerializer=kc,Ec.append=mn,Ec.appendInternal=_n,Ec.save=on;var xc=class extends ga{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new xc)).blockId=e.blockId,t}},Sc=class extends xc{constructor(e){super(e),this.type=Po.CREATE$$module$build$src$core$events$utils,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Rt(e),this.ids=M(e),this.json=on(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=$t(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Sc)).xml=Po.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!Cc(t,this.ids))if(e)mn(this.json,t);else for(e=0;e<this.ids.length;e++){const n=this.ids[e],r=t.getBlockById(n);r?r.dispose(!1):n===this.blockId&&console.warn("Can't uncreate non-existent block: "+n)}}},Cc=function(e,t){return t.map((t=>e.getBlockById(t))).filter((e=>e&&e.isShadow())).length===t.length};t(Uo.EVENT,Po.CREATE$$module$build$src$core$events$utils,Sc);var Ic=class extends ya{constructor(e,t){super(t),this.type="theme_change",this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ic)).themeName=e.themeName,t}};t(Uo.EVENT,"theme_change",Ic);var Ac,wc=class extends ya{constructor(e,t,n,r,i){super(r),this.type=ia,this.viewTop=e,this.viewLeft=t,this.scale=n,this.oldScale=i}toJson(){const e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new wc)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};t(Uo.EVENT,ia,wc),Po.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},Po.config$$module$build$src$core$config,function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"}(Ac||(Ac={}));var Nc=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const n=this.calculateIndexForYPos(t);if(n>=this.connections.length)return-1;t=e.y;let r=n;for(;0<=r&&this.connections[r].y===t;){if(this.connections[r]===e)return r;r--}for(r=n;r<this.connections.length&&this.connections[r].y===t;){if(this.connections[r]===e)return r;r++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,n=this.connections.length;for(;t<n;){const r=Math.floor((t+n)/2);if(this.connections[r].y<e)t=r+1;else{if(!(this.connections[r].y>e)){t=r;break}n=r}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function n(e){const n=i-r[e].x,o=s-r[e].y;return Math.sqrt(n*n+o*o)<=t&&l.push(r[e]),o<t}const r=this.connections,i=e.x,s=e.y;e=0;let o=r.length-2,a=o;for(;e<a;)r[a].y<s?e=a:o=a,a=Math.floor((e+o)/2);const l=[];if(o=e=a,r.length){for(;0<=e&&n(e);)e--;do{o++}while(o<r.length&&n(o))}return l}isInYRange(e,t,n){return Math.abs(this.connections[e].y-t)<=n}searchForClosest(e,t,n){if(!this.connections.length)return{connection:null,radius:t};const r=e.y,i=e.x;e.x=i+n.x,e.y=r+n.y;var s=this.calculateIndexForYPos(e.y);n=null;let o,a=t,l=s-1;for(;0<=l&&this.isInYRange(l,e.y,t);)o=this.connections[l],this.connectionChecker.canConnect(e,o,!0,a)&&(n=o,a=o.distanceFrom(e)),l--;for(;s<this.connections.length&&this.isInYRange(s,e.y,t);)o=this.connections[s],this.connectionChecker.canConnect(e,o,!0,a)&&(n=o,a=o.distanceFrom(e)),s++;return e.x=i,e.y=r,{connection:n,radius:a}}static init(e){const t=[];return t[Ac.INPUT_VALUE]=new Nc(e),t[Ac.OUTPUT_VALUE]=new Nc(e),t[Ac.NEXT_STATEMENT]=new Nc(e),t[Ac.PREVIOUS_STATEMENT]=new Nc(e),t}},Dc=class{paste(e,t,n){if(!t.isCapacityAvailable(e.typeCounts))return null;let r;n&&(e.blockState.x=n.x,e.blockState.y=n.y),Po.disable$$module$build$src$core$events$utils();try{r=mn(e.blockState,t),An(r)}finally{Po.enable$$module$build$src$core$events$utils()}return r?(L()&&!r.isShadow()&&w(new($(Po.CREATE$$module$build$src$core$events$utils))(r)),r.select(),r):r}};Dc.TYPE="block",vt(Dc.TYPE,new Dc);var Oc={};Oc.BlockPaster=Dc,Oc.moveBlockToNotConflict=An;var Rc=null,Lc=null,Pc={duplicateInternal:Mn,copyInternal:On},Mc={};Mc.BlockPaster=Dc,Mc.TEST_ONLY=Pc,Mc.copy=Dn,Mc.duplicate=Pn,Mc.paste=Rn,Mc.registry=ic;var Fc,$c,Bc="aria-",Uc="role";!function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"}(Fc||(Fc={})),function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"}($c||($c={}));var Vc={};Vc.Role=Fc,Vc.State=$c,Vc.setRole=Fn,Vc.setState=$n;var Hc,Gc=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&Fn(t,this.roleName),this.element=t;for(let e,n=0;e=this.menuItems[n];n++)t.appendChild(e.createDom());return this.mouseOverHandler=W(t,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=W(t,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=W(t,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=W(t,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=W(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:!0}),ie(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),oe(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.mouseOverHandler&&(q(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(q(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(q(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(q(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(q(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e,t=0;e=this.menuItems[t];t++)e.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem"))for(let t,n=0;t=this.menuItems[n];n++)if(t.getElement()===e)return t;e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;t&&(t.setHighlighted(!1),this.highlightedItem=null),e&&(e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement(),Se(e.getElement(),t),$n(t,$c.ACTIVEDESCENDANT,e.getId()))}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let n;for(e+=t;n=this.menuItems[e];){if(n.isEnabled()){this.setHighlighted(n);break}e+=t}}handleMouseOver(e){(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){const n=new el(e.clientX,e.clientY);if(1>el.distance(t,n))return}(e=this.getMenuItem(e.target))&&e.performAction()}handleMouseEnter(e){this.focus()}handleMouseLeave(e){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=ye(e);return t.height=e.scrollHeight,t}},jc=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=S(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var n=document.createElement("div");n.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(n)}return n=this.content,"string"==typeof this.content&&(n=document.createTextNode(this.content)),t.appendChild(n),e.appendChild(t),this.roleName&&Fn(e,this.roleName),$n(e,$c.SELECTED,this.checkable&&this.checked||!1),$n(e,$c.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(ie(t,"blocklyMenuItemHighlight"),ie(t,"goog-menuitem-highlight")):(oe(t,"blocklyMenuItemHighlight"),oe(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},Kc=null,Wc=null,zc="blocklyWidgetDiv",qc="",Jc="",Yc={};Yc.createDom=Vn,Yc.getDiv=Bn,Yc.hide=Gn,Yc.hideIfOwner=Kn,Yc.isVisible=jn,Yc.positionWithAnchor=zn,Yc.repositionForWindowResize=Xn,Yc.show=Hn,Yc.testOnly_setDiv=Un;var Xc=null,Qc={},Zc=null,eu={};eu.callbackFactory=Po.callbackFactory$$module$build$src$core$contextmenu,eu.commentDeleteOption=ar,eu.commentDuplicateOption=lr,eu.dispose=or,eu.getCurrentBlock=Qn,eu.hide=sr,eu.setCurrentBlock=Zn,eu.show=er,eu.workspaceCommentOption=cr;var tu=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(e){if(this.registry_.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registry_.set(e.id,e)}unregister(e){if(!this.registry_.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registry_.delete(e)}getItem(e){let t;return null!=(t=this.registry_.get(e))?t:null}getContextMenuOptions(e,t){const n=[];for(const i of this.registry_.values())if(e===i.scopeType){var r=i.preconditionFn(t);"hidden"!==r&&(r={text:"function"==typeof i.displayText?i.displayText(t):i.displayText,enabled:"enabled"===r,callback:i.callback,scope:t,weight:i.weight},n.push(r))}return n.sort((function(e,t){return e.weight-t.weight})),n}};!function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",e.registry=new e}(tu||(tu={}));var nu=tu.ScopeType,ru={};ru.ContextMenuRegistry=tu,ru.ScopeType=nu;var iu={};iu.clamp=pr,iu.toDegrees=dr,iu.toRadians=ur;var su,ou,au,lu=16,cu=1,uu=12,du=16,pu=.25,hu=null,fu=null,mu="",_u="",gu=null,yu=null,bu=null,vu={getBoundsInfo:function(){const e=ke(gu),t=ye(gu);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,n,r){const i=vu.getBoundsInfo(),s=ye(su);return t+s.height<i.bottom?Sr(e,t,i,s):r-s.height>i.top?Cr(n,r,i,s):t+s.height<document.documentElement.clientHeight?Sr(e,t,i,s):r-s.height>document.documentElement.clientTop?Cr(n,r,i,s):Ir(e,i,s)}},Tu={ANIMATION_TIME:pu,ARROW_HORIZONTAL_PADDING:uu,ARROW_SIZE:lu,BORDER_SIZE:cu,PADDING_Y:du,TEST_ONLY:vu};Tu.clearContent=gr,Tu.createDom=hr,Tu.getContentDiv=_r,Tu.getOwner=mr,Tu.getPositionX=Ar,Tu.hide=Dr,Tu.hideIfOwner=Nr,Tu.hideWithoutAnimation=Or,Tu.isVisible=wr,Tu.repositionForWindowResize=Lr,Tu.setBoundsElement=fr,Tu.setColour=yr,Tu.show=xr,Tu.showPositionedByBlock=br,Tu.showPositionedByField=vr;var ku=null,Eu=null,xu={};xu.connectionUiEffect=Fr,xu.disconnectUiEffect=$r,xu.disconnectUiStop=Ur,xu.disposeUiEffect=Pr;var Su=class{constructor(e,t){this.bubble=e,this.workspace=t,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.bubble.getRelativeToSurfaceXY()}startBubbleDrag(){let e;Po.getGroup$$module$build$src$core$events$utils()||Po.setGroup$$module$build$src$core$events$utils(!0),this.workspace.setResizesEnabled(!1),this.bubble.setAutoLayout&&this.bubble.setAutoLayout(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(e,t){t=this.pixelsToWorkspaceUnits_(t),t=el.sum(this.startXY_,t),this.bubble.moveDuringDrag(t),t=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(e),e=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),e!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==t&&(t&&t.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(e){return!(!e||!this.workspace.getComponentManager().hasCapability(e.id,Ya.Capability.DELETE_AREA))&&e.wouldDelete(this.bubble,!1)}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(e,t){if(this.dragBubble(e,t),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?e=this.startXY_:(e=this.pixelsToWorkspaceUnits_(t),e=el.sum(this.startXY_,e)),this.bubble.moveTo(e.x,e.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_)this.fireMoveEvent_(),this.bubble.dispose();else{if(this.bubble.setDragging){let e;this.bubble.setDragging(!1),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,100)}this.fireMoveEvent_()}this.workspace.setResizesEnabled(!0),Po.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent_(){if(this.bubble instanceof oc){const e=new($(oa))(this.bubble);e.setOldCoordinate(this.startXY_),e.recordNew(),w(e)}}pixelsToWorkspaceUnits_(e){return e=new el(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}},Cu=[];Cu[Ac.INPUT_VALUE]=Ac.OUTPUT_VALUE,Cu[Ac.OUTPUT_VALUE]=Ac.INPUT_VALUE,Cu[Ac.NEXT_STATEMENT]=Ac.PREVIOUS_STATEMENT,Cu[Ac.PREVIOUS_STATEMENT]=Ac.NEXT_STATEMENT;var Iu={};Iu.commonWordPrefix=Gr,Iu.commonWordSuffix=jr,Iu.isNumber=Po.isNumber$$module$build$src$core$utils$string,Iu.shortestStringLength=Hr,Iu.startsWith=Vr,Iu.wrap=Po.wrap$$module$build$src$core$utils$string;var Au=void 0,wu=!1,Nu=!1,Du=50,Ou=0,Ru=0,Lu=0,Pu=0,Mu=null,Fu=null,$u=0,Bu=10,Uu=10,Vu=750,Hu=5,Gu=null,ju={HOVER_MS:Vu,LIMIT:Du,MARGINS:Hu,OFFSET_X:$u,OFFSET_Y:Bu,RADIUS_OK:Uu};ju.bindMouseEvents=ni,ju.block=ci,ju.createDom=ti,ju.dispose=ai,ju.getCustomTooltip=Yr,ju.getDiv=Qr,ju.getTooltipOfObject=Zr,ju.hide=li,ju.isVisible=Xr,ju.setCustomTooltip=Jr,ju.unbindMouseEvents=ri,ju.unblock=ui;var Ku=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new el(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){_()&&_().unselect()}endDrag(e){this.drag(e)}drag(e){if(e=el.sum(this.startScrollXY_,e),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},Wu=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new el(0,0),this.startWorkspace_=this.targetBlock=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.flyout=this.workspaceDragger=this.blockDragger=this.bubbleDragger=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new el(0,0),this.healStack=!1}dispose(){H(),ui(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)q(e);this.boundEvents.length=0,this.blockDragger&&this.blockDragger.dispose(),this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new el(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(),V()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=el.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=el.magnitude(this.currentDragDeltaXY)>(this.flyout?Po.config$$module$build$src$core$config.flyoutDragRadius:Po.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Po.getGroup$$module$build$src$core$events$utils()||Po.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),this.targetBlock.select(),0))}updateIsDraggingBubble(){return!!this.startBubble&&(this.startDraggingBubble(),!0)}updateIsDraggingBlock(){if(!this.targetBlock)return!1;if(this.flyout){if(this.updateIsDraggingFromFlyout())return this.startDraggingBlock(),!0}else if(this.targetBlock.isMovable())return this.startDraggingBlock(),!0;return!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger=new Ku(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(){if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.updateIsDraggingBubble()||this.updateIsDraggingBlock()||this.updateIsDraggingWorkspace()}startDraggingBlock(){this.blockDragger=new(c(Uo.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock,this.startWorkspace_),this.blockDragger.startDrag(this.currentDragDeltaXY,this.healStack),this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY)}startDraggingBubble(){if(!this.startBubble)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger=new Su(this.startBubble,this.startWorkspace_),this.bubbleDragger.startBubbleDrag(),this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,J(e)?this.cancel():(this.gestureHasStarted=!0,Ur(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=mr(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,ci(),this.targetBlock&&this.targetBlock.select(),Y(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&U(e,this),this.mouseDownXY=new el(e.clientX,e.clientY),this.healStack=e.altKey||e.ctrlKey||e.metaKey,this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(W(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(W(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(W(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&V())}handleMove(e){this.isDragging()&&G(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.blockDragger?this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY):this.bubbleDragger&&this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),V())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!G(e))return;if(this.updateFromEvent(e),V(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.bubbleDragger?this.bubbleDragger.endBubbleDrag(e,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(e,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()?this.doBubbleClick():this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e)}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=j(e);this.cachedPoints.set(t,this.getTouchPoint(e));var n=Array.from(this.cachedPoints.keys());2===n.length&&(t=this.cachedPoints.get(n[0]),n=this.cachedPoints.get(n[1]),this.startDistance=el.distance(t,n),this.isMultiTouch_=!0,e.preventDefault())}handleTouchMove(e){const t=j(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):this.handleMove(e)}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),n=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),n=el.distance(n,t)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(t=0<(t=n-this.previousScale)?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const r=this.startWorkspace_,i=X(e,r.getParentSvg(),r.getInverseScreenCTM());r.zoom(i.x,i.y,t)}this.previousScale=n,e.preventDefault()}handleTouchEnd(e){e=j(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new el(e.pageX,e.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(V(),this.bubbleDragger?this.bubbleDragger.endBubbleDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.doStart(e)}fireWorkspaceClick(e){w(new($(na))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}doBubbleClick(){this.startBubble instanceof oc&&(this.startBubble.setFocus(),this.startBubble.select())}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock.isEnabled()&&(Po.getGroup$$module$build$src$core$events$utils()||Po.setGroup$$module$build$src$core$events$utils(!0),this.flyout.createBlock(this.targetBlock).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const e=new($(na))(this.startBlock,this.startWorkspace_.id,"block");w(e)}this.bringBlockToFront(),Po.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){e=this.creatorWorkspace,_()&&_().unselect(),this.fireWorkspaceClick(this.startWorkspace_||e)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):this.targetBlock=e}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}isDragging(){return!!this.workspaceDragger||!!this.blockDragger||!!this.bubbleDragger}hasStarted(){return this.gestureHasStarted}getInsertionMarkers(){return this.blockDragger?this.blockDragger.getInsertionMarkers():[]}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.blockDragger)?e:this.workspaceDragger)?t:this.bubbleDragger}static inProgress(){const e=d();for(let t,n=0;t=e[n];n++)if(t.currentGesture_)return!0;return!1}},zu=class{constructor(e,t){let n,r,i;this.pattern=e,this.scale=1,this.spacing=null!=(n=t.spacing)?n:0,this.length=null!=(r=t.length)?r:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(i=t.snap)&&i}setSpacing(e){this.spacing=e,this.update(this.scale)}setLength(e){this.length=e,this.update(this.scale)}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`);let n=(t=Math.floor(this.spacing/2)+.5)-this.length/2,r=t+this.length/2;t*=e,n*=e,r*=e,this.setLineAttributes(this.line1,e,n,r,t,t),this.setLineAttributes(this.line2,e,t,t,n,r)}setLineAttributes(e,t,n,r,i,s){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${n}`),e.setAttribute("y1",`${i}`),e.setAttribute("x2",`${r}`),e.setAttribute("y2",`${s}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}static createDom(e,t,n){let r,i;if(e=re(dl.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},n),0<(null!=(r=t.length)?r:1)&&0<(null!=(i=t.spacing)?i:0)){let n;re(dl.LINE,{stroke:t.colour},e),null!=(n=t.length)&&n&&re(dl.LINE,{stroke:t.colour},e)}else re(dl.LINE,{},e);return e}},qu=class{constructor(e){this.workspace=e,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor_}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(e),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg_=e):this.cursorSvg_=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t,n=0;t=e[n];n++)this.unregisterMarker(t);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};qu.LOCAL_MARKER="local_marker_1";var Ju={};Ju.deepMerge=mi;var Yu=class{constructor(e,n,r,i){this.name=e,this.startHats=!1,this.blockStyles=n||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=i||Object.create(null),this.fontStyle=Object.create(null),t(Uo.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const n=new Yu(e);let r=t.base;if(r){if("string"==typeof r){let e;r=null!=(e=a(Uo.THEME,r))?e:void 0}r instanceof Yu&&(mi(n,r),n.name=e)}return mi(n.blockStyles,t.blockStyles),mi(n.categoryStyles,t.categoryStyles),mi(n.componentStyles,t.componentStyles),mi(n.fontStyle,t.fontStyle),null!==t.startHats&&(n.startHats=t.startHats),n}},Xu=new Yu("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Qu=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,n=!1;var r=!1,i=!1,s=!1,o=!1,a=!1;const l=!!e.readOnly;var c;l||(t=Me(null!=(c=e.toolbox)?c:null),n=Be(t),r=void 0===(r=e.trashcan)?n:r,i=void 0===(i=e.collapse)?n:i,s=void 0===(s=e.comments)?n:s,o=void 0===(o=e.disable)?n:o,a=void 0===(a=e.sounds)||a),c=e.maxTrashcanContents,r?void 0===c&&(c=32):c=0;const u=!!e.rtl;let d=e.horizontalLayout;void 0===d&&(d=!1);var p="end"!==e.toolboxPosition;p=d?p?Al.TOP:Al.BOTTOM:p===u?Al.RIGHT:Al.LEFT;let h=e.css;void 0===h&&(h=!0);let f="https://blockly-demo.appspot.com/static/media/";e.media?f=e.media.endsWith("/")?e.media:e.media+"/":"path"in e&&(ne("path","Nov 2014","Jul 2023","media"),f=e.path+"media/");const m=e.oneBasedIndex,_=e.renderer||"geras",g=e.plugins||{};let y,b,v,T=e.modalInputs;void 0===T&&(T=!0),this.RTL=u,this.oneBasedIndex=void 0===m||m,this.collapse=i,this.comments=s,this.disable=o,this.readOnly=l,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(y=e.maxInstances)?y:null,this.modalInputs=T,this.pathToMedia=f,this.hasCategories=n,this.moveOptions=Qu.parseMoveOptions_(e,n),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=r,this.maxTrashcanContents=c,this.hasSounds=a,this.hasCss=h,this.horizontalLayout=d,this.languageTree=t,this.gridOptions=Qu.parseGridOptions_(e),this.zoomOptions=Qu.parseZoomOptions_(e),this.toolboxPosition=p,this.theme=Qu.parseThemeOptions_(e),this.renderer=_,this.rendererOverrides=null!=(b=e.rendererOverrides)?b:null,this.parentWorkspace=null!=(v=e.parentWorkspace)?v:null,this.plugins=g}static parseMoveOptions_(e,t){const n=e.move||{},r={};return void 0===n.scrollbars&&void 0===e.scrollbars?r.scrollbars=t:"object"==typeof n.scrollbars?(r.scrollbars={horizontal:!!n.scrollbars.horizontal,vertical:!!n.scrollbars.vertical},r.scrollbars.horizontal&&r.scrollbars.vertical?r.scrollbars=!0:r.scrollbars.horizontal||r.scrollbars.vertical||(r.scrollbars=!1)):r.scrollbars=!!n.scrollbars||!!e.scrollbars,r.wheel=r.scrollbars&&void 0!==n.wheel?!!n.wheel:"object"==typeof r.scrollbars,r.drag=!(!r.scrollbars||void 0!==n.drag&&!n.drag),r}static parseZoomOptions_(e){e=e.zoom||{};const t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions_(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions_(e){return"string"==typeof(e=e.theme||Xu)?a(Uo.THEME,e):e instanceof Yu?e:Yu.defineTheme(e.name||"builtin"+S(),e)}},Zu=class extends xc{constructor(e,t,n,r,i){super(e),this.type=Po.CHANGE$$module$build$src$core$events$utils,e&&(this.element=t,this.name=n||void 0,this.oldValue=r,this.newValue=i)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Zu)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getIcon(Vl.MUTATOR);switch(n&&_i(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setEnabled(!e);break;case"inline":t.setInputsInline(!!e);break;case"mutation":n=Zu.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(Po.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),w(new Zu(t,"mutation",null,n,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?$t(e):""}};t(Uo.EVENT,Po.CHANGE$$module$build$src$core$events$utils,Zu);var ed=.45,td=.65,nd={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},rd={};rd.blend=Si,rd.getHsvSaturation=gi,rd.getHsvValue=bi,rd.hexToRgb=Ei,rd.hsvToHex=xi,rd.hueToHex=Ci,rd.names=nd,rd.parse=Ti,rd.rgbToHex=ki,rd.setHsvSaturation=yi,rd.setHsvValue=vi;var id={};id.checkMessageReferences=Ni,id.parseBlockColour=Di,id.replaceMessageReferences=wi,id.tokenizeInterpolation=Ai;var sd=class{constructor(e,t,n){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new hl(0,0),e!==sd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(wi(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=re(dl.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=re(dl.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=re(dl.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");ni(e),this.mouseDownWrapper_=W(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(sd))?e:this.getValue()}loadState(e){this.loadLegacyState(sd,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=Po.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Le(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(Po.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;Nr(this),Kn(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||le(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(ie(e,"blocklyEditableText"),oe(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(ie(e,"blocklyNonEditableText"),oe(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==sd.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();let n=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),r=t.FIELD_TEXT_HEIGHT,i=0;this.textElement_&&(n+=i=me(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY)),this.isFullBlockField()||(r=Math.max(r,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=r,this.size_.width=n,this.positionTextElement_(e,i),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var n,r=this.getConstants(),i=this.size_.height/2;this.textElement_.setAttribute("x",String(null!=(n=this.getSourceBlock())&&n.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(r.FIELD_TEXT_BASELINE_CENTER?i:i-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(this.render_(),0!==this.size_.width&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new hl(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new od;if(this.isFullBlockField()){var n=this.sourceBlock_.getHeightWidth();const r=t.workspace.scale;e=this.getAbsoluteXY_(),t=(n.width+1)*r,n=(n.height+1)*r,$a?(e.x+=1.5*r,e.y+=1.5*r):(e.x-=.5*r,e.y-=.5*r)}else n=this.borderRect_.getBoundingClientRect(),e=ke(this.borderRect_),t=n.width,n=n.height;return new pl(e.y,e.y+n,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+""),e=e.replace(/\s/g,sd.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+=""),e):sd.NBSP}getText(){const e=this.getText_();return String(null!==e?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.queueRender(),this.sourceBlock_.bumpNeighbours())}setValue(e,t=!0){if(null!==e){var n,r=this.doClassValidation_(e);(e=this.processValidation_(e,r))instanceof Error||(r=null==(n=this.getValidator())?void 0:n.call(this,e),(n=this.processValidation_(e,r))instanceof Error||(e=this.sourceBlock_)&&e.disposed||((r=this.getValue())===n?this.doValueUpdate_(n):(this.doValueUpdate_(n),t&&e&&L()&&w(new($(Po.CHANGE$$module$build$src$core$events$utils))(e,"field",this.name||null,r,n)),this.isDirty_&&this.forceRerender())))}}processValidation_(e,t){return null===t?(this.doValueInvalid_(e),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null==e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip_=e}getTooltip(){const e=this.getClickTarget_();return Zr(e||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return ke(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new od;const n=t.inputList;for(let r=0;r<t.inputList.length;r++){const t=n[r],i=t.fieldRow;for(let n=0;n<i.length;n++)if(i[n]===this){e=t;break}}return e}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(e){return!1}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.cursorSvg_=e}else this.cursorSvg_=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.markerSvg_=e}else this.markerSvg_=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new od;(e=e.workspace).keyboardAccessibilityMode&&this.cursorSvg_&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg_&&e.getMarker(qu.LOCAL_MARKER).draw()}};sd.NBSP="",sd.SKIP_SETUP=Symbol("SKIP_SETUP");var od=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},ad={};ad.Field=sd,ad.UnattachedFieldError=od,Po.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.name:null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=Po.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),Po.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let n=e;t===Po.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(n=e),e=n.toLowerCase();const r=t===Po.NameType$$module$build$src$core$names.VARIABLE||t===Po.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const i=this.db.get(t);return i.has(e)?r+i.get(e):(t=this.getDistinctName(n,t),i.set(e,t.substr(r.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let n,r,i,s=null;for(;this.dbReverse.has(e+(null!=(n=s)?n:""))||this.reservedWords.has(e+(null!=(r=s)?r:""));)s=s?s+1:2;return e+=null!=(i=s)?i:"",this.dbReverse.add(e),(t===Po.NameType$$module$build$src$core$names.VARIABLE||t===Po.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!=="0123456789".indexOf(e[0])&&(e="my_"+e)):e=Po.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){(e=e.NameType||(e.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(Po.Names$$module$build$src$core$names||(Po.Names$$module$build$src$core$names={})),Po.NameType$$module$build$src$core$names=Po.Names$$module$build$src$core$names.NameType,Po.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=Po.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,{NameType:Po.NameType$$module$build$src$core$names}.Names=Po.Names$$module$build$src$core$names;var ld=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),Ri(t)&&t.startPublishing()),this}delete(e){const t=this.get(e);return(e=super.delete(e))?(Ri(t)&&t.stopPublishing(),e):e}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},cd=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new el(0,0),this.workspaceLocation=new el(0,0),this.svgRoot=null,this.tooltip=e}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=re(dl.G,{class:"blocklyIconGroup"}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),W(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,ni(this.svgRoot)}}dispose(){ri(this.svgRoot),le(this.svgRoot)}getWeight(){return-1}getSize(){return new hl(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",_i(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=el.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}setVisible(e){ne("setVisible","v10","v11","setBubbleVisible"),_i(this)&&this.setBubbleVisible(e)}},ud={fromJsonInternal:Mi},dd={TEST_ONLY:ud};dd.fromJson=Po.fromJson$$module$build$src$core$field_registry,dd.register=Li,dd.unregister=Pi;var pd=class extends sd{constructor(e,t,n){super(sd.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==sd.SKIP_SETUP&&(Array.isArray(e)?(Bi(e),e=Fi(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],n&&this.configure_(n),this.setValue(this.selectedOption[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(pd,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=re(dl.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&ie(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){let e,t;this.arrow=re(dl.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?pd.ARROW_CHAR+" ":" "+pd.ARROW_CHAR)),null!=(t=this.getSourceBlock())&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=re(dl.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(ol,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new od;this.dropdownCreate(),this.menu_.openingCoords=e&&"number"==typeof e.clientX?new el(e.clientX,e.clientY):null,gr(),e=this.menu_.render(_r()),ie(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),yr(t,this.sourceBlock_.style.colourTertiary)),vr(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Se(this.selectedMenuItem.getElement(),_r(),!0)),this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new od;const t=new Gc;t.setRole(Fc.LISTBOX),this.menu_=t;const n=this.getOptions(!1);this.selectedMenuItem=null;for(let i=0;i<n.length;i++){const[s,o]=n[i];if("object"==typeof s){var r=new Image(s.width,s.height);r.src=s.src,r.alt=s.alt||""}else r=s;(r=new jc(r,o)).setRole(Fc.OPTION),r.setRightToLeft(e.RTL),r.setCheckable(!0),t.addChild(r),r.setChecked(o===this.value_),o===this.value_&&(this.selectedMenuItem=r),r.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Nr(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),Bi(this.generatedOptions)),this.generatedOptions)}doClassValidation_(e){return this.getOptions(!0).some((t=>t[1]===e))?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t,n=0;t=e[n];n++)t[1]===this.value_&&(this.selectedOption=t)}applyColour(){const e=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",e.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=e.colourSecondary:this.arrow.style.fill=e.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];e&&"object"==typeof e?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new od;this.imageElement.style.display="",this.imageElement.setAttributeNS(ol,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const n=Number(e.height);e=Number(e.width);var r=!!this.borderRect_;const i=Math.max(r?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+hd);let s;r=r?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.svgArrow?this.positionSVGArrow(e+r,i/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):me(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+s+2*r,this.size_.height=i;let o=0;t.RTL?this.imageElement.setAttribute("x",`${r+s}`):(o=e+s,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${r}`)),this.imageElement.setAttribute("y",String(i/2-n/2)),this.positionTextElement_(o+r,e+s)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();ie(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const n=me(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let r=0;this.svgArrow&&(r=this.positionSVGArrow(n+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=n+r+2*t,this.size_.height=e,this.positionTextElement_(t,n)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const n=this.getSourceBlock();if(!n)throw new od;const r=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,i=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,s=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(n.RTL?r:e+i)+","+t+")"),s+i}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];return"object"==typeof e?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}};pd.CHECKMARK_OVERHANG=25,pd.MAX_MENU_HEIGHT_VH=.45,pd.ARROW_CHAR="";var hd=10;Li("field_dropdown",pd);var fd,md=class{constructor(e,t,n){this.workspace=e,this.anchor=t,this.ownerRect=n,this.size=new hl(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.svgRoot=re(dl.G,{},e.getBubbleCanvas()),e=re(dl.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=re(dl.PATH,{},e),this.background=re(dl.RECT,{class:"blocklyDraggable",x:0,y:0,rx:fd.BORDER_WIDTH,ry:fd.BORDER_WIDTH},e),this.contentContainer=re(dl.G,{},this.svgRoot),W(this.background,"pointerdown",this,this.onMouseDown)}dispose(){le(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,fd.MIN_SIZE),e.height=Math.max(e.height,fd.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new pl(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft(t),r=this.getOptimalRelativeTop(t);const i={x:n,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},s={x:-this.size.width-30,y:r};r={x:e.getWidth(),y:r};var o={x:n,y:e.getHeight()};n=e.getWidth()<e.getHeight()?r:o,e=e.getWidth()<e.getHeight()?o:r,r=this.getOverlap(i,t),o=this.getOverlap(s,t);const a=this.getOverlap(n,t);t=this.getOverlap(e,t),r===(t=Math.max(r,o,a,t))?(this.relativeLeft=i.x,this.relativeTop=i.y):o===t?(this.relativeLeft=s.x,this.relativeTop=s.y):a===t?(this.relativeLeft=n.x,this.relativeTop=n.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var n=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(n+this.size.width,t.left+t.width)-Math.max(n,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var n=this.anchor.x-t;n-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):n>e.right&&(t=-(e.right-this.anchor.x))}else{const r=(n=t+this.anchor.x)+this.size.width;n<e.left?t=e.left-this.anchor.x:r>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const n=this.anchor.y+t,r=n+this.size.height;return n<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:r>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let n=e.top+e.height,r=e.left;return e=e.left+e.width,n-=this.getScrollbarThickness(),this.workspace.RTL?r-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new pl(t,n,r,e)}getScrollbarThickness(){return bl.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,n=this.size.height/2,r=-this.relativeLeft,i=-this.relativeTop;if(t===r&&n===i)e.push("M "+t+","+n);else{i-=n,r-=t,this.workspace.RTL&&(r*=-1);var s=Math.sqrt(i*i+r*r),o=Math.acos(r/s);0>i&&(o=2*Math.PI-o);var a=o+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a);const c=Math.cos(a);let u=(this.size.width+this.size.height)/fd.TAIL_THICKNESS;u=Math.min(u,this.size.width,this.size.height)/4,r=t+(a=1-fd.ANCHOR_RADIUS/s)*r,i=n+a*i,a=t+u*c;const d=n+u*l;t-=u*c,n-=u*l,(l=o+(l=ur(this.workspace.RTL?-fd.TAIL_ANGLE:fd.TAIL_ANGLE)))>2*Math.PI&&(l-=2*Math.PI),o=Math.sin(l)*s/fd.TAIL_BEND,s=Math.cos(l)*s/fd.TAIL_BEND,e.push("M"+a+","+d),e.push("C"+(a+s)+","+(d+o)+" "+r+","+i+" "+r+","+i),e.push("C"+r+","+i+" "+(t+s)+","+(n+o)+" "+t+","+n)}let c;e.push("z"),null==(c=this.tail)||c.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==t?void 0:t.lastChild)===this.svgRoot||(null==t||t.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new el(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}};fd=md,md.BORDER_WIDTH=6,md.DOUBLE_BORDER=2*fd.BORDER_WIDTH,md.MIN_SIZE=fd.DOUBLE_BORDER,md.TAIL_THICKNESS=1,md.TAIL_ANGLE=20,md.TAIL_BEND=4,md.ANCHOR_RADIUS=8;var _d=class extends md{constructor(e,t,n,r){let i,s;super(t,n,r),this.workspace=t,this.anchor=n,this.ownerRect=r,this.autoLayout=!0,t=new Qu(e),this.validateWorkspaceOptions(t),this.svgDialog=re(dl.SVG,{x:md.BORDER_WIDTH,y:md.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Qu(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(dl.G),this.miniWorkspace.getCanvas()),null==(e=this.miniWorkspace.getFlyout())||e.init(this.miniWorkspace),null==e||e.show(t.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(i=this.miniWorkspace.getFlyout())||null==(s=i.getWorkspace())||s.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(20>t.y&&e.moveBy(0,20-t.y),e.RTL){let n=-20;const r=this.miniWorkspace.getFlyout();r&&(n-=r.getWidth()),t.x>n&&e.moveBy(n-t.x,0)}else 20>t.x&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<_d.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<_d.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new hl(t.width+md.DOUBLE_BORDER,t.height+md.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+_d.MARGIN;e=e.height+_d.MARGIN;const n=this.miniWorkspace.getFlyout();if(n){const r=n.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,r.height+20),t+=n.getWidth()}return new hl(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(const t of e.getAllBlocks(!1))t.setStyle(t.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};_d.MINIMUM_VIEW_CHANGE=10,_d.MARGIN=3*md.DOUBLE_BORDER,Po.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends cd{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),re(dl.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),re(dl.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),re(dl.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),ie(this.svgRoot,"blockly-icon-mutator"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new hl(17,17)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.style.colourPrimary),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){if(this.bubbleIsVisible()!==e){if(e){let e;this.miniWorkspaceBubble=new _d(this.getMiniWorkspaceConfig(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour(),this.createRootBlock(),this.addSaveConnectionsListener(),null==(e=this.miniWorkspaceBubble)||e.addWorkspaceChangeListener(this.createMiniWorkspaceChangeListener())}else{let e;null==(e=this.miniWorkspaceBubble)||e.dispose(),this.miniWorkspaceBubble=null,this.saveConnectionsListener&&this.sourceBlock.workspace.removeChangeListener(this.saveConnectionsListener),this.saveConnectionsListener=null}w(new($(ra))(this.sourceBlock,e,"mutator"))}}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map((e=>({kind:"block",type:e})))}),t}getAnchorLocation(){return el.sum(this.workspaceLocation,new el(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new pl(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var e of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))e.queueRender();let t,n,r,i;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(i=null==(t=this.miniWorkspaceBubble)||null==(n=t.getWorkspace())||null==(r=n.getFlyout())?void 0:r.getWidth())?i:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout((()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()}),0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||e.type===Po.CREATE$$module$build$src$core$events$utils||e.type===Po.CHANGE$$module$build$src$core$events$utils&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=Po.getGroup$$module$build$src$core$events$utils();e||Po.setGroup$$module$build$src$core$events$utils(!0);var t=Zu.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var n=Zu.getExtraBlockState_(this.sourceBlock);t!==n&&w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,t,n)),Po.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}static reconnect(e,t,n){return ne("MutatorIcon.reconnect","v10","v11","connection.reconnect"),!!e&&e.reconnect(t,n)}static findParentWs(e){return ne("MutatorIcon.findParentWs","v10","v11","workspace.getRootWorkspace"),e.getRootWorkspace()}},Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Vl.MUTATOR,Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,Po.MutatorIcon$$module$build$src$core$icons$mutator_icon;var gd=Object.create(null),yd={allExtensions:gd};Po.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Zi);var bd,vd={TEST_ONLY:yd};vd.apply=Hi,vd.buildTooltipForDropdown=Po.buildTooltipForDropdown$$module$build$src$core$extensions,vd.buildTooltipWithFieldText=Po.buildTooltipWithFieldText$$module$build$src$core$extensions,vd.isRegistered=Vi,vd.register=Po.register$$module$build$src$core$extensions,vd.registerMixin=Po.registerMixin$$module$build$src$core$extensions,vd.registerMutator=Po.registerMutator$$module$build$src$core$extensions,vd.runAfterPageLoad=Xi,vd.unregister=Ui,function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"}(bd||(bd={}));var Td={};Td.arc=as,Td.curve=ts,Td.line=ss,Td.lineOnAxis=os,Td.lineTo=is,Td.moveBy=rs,Td.moveTo=ns,Td.point=es;var kd={};kd.Coordinate=el,kd.KeyCodes=bd,kd.Rect=pl,kd.Size=hl,kd.Svg=dl,kd.aria=Vc,kd.array=qa,kd.browserEvents=za,kd.colour=rd,kd.deprecation=nl,kd.dom=ul,kd.extensions=vd,kd.idGenerator=fa,kd.math=iu,kd.object=Ju,kd.parsing=id,kd.string=Iu,kd.style=ml,kd.svgMath=yl,kd.svgPaths=Td,kd.toolbox=Pl,kd.userAgent=ja,kd.xml=Il;var Ed={};Ed.register=ls,Ed.unregister=cs;var xd=class extends md{constructor(e,t,n,r){super(t,n,r),this.text=e,this.workspace=t,this.anchor=n,this.ownerRect=r,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(e){this.text=e,le(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createSpans(t,e),this.workspace.RTL&&this.rightAlignSpans(t.getBBox().width,e),t}createParagraph(e){return re(dl.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:md.BORDER_WIDTH},e)}createSpans(e,t){return t.split("\n").map((t=>{const n=re(dl.TSPAN,{dy:"1em",x:md.BORDER_WIDTH},e);return t=document.createTextNode(t),n.appendChild(t),n}))}rightAlignSpans(e,t){for(const n of t)n.setAttribute("text-anchor","end"),n.setAttribute("x",`${e+md.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new hl(e.width+2*md.BORDER_WIDTH,e.height+2*md.BORDER_WIDTH),!0)}},Sd=class extends md{constructor(e,t,n){super(e,t,n),this.workspace=e,this.anchor=t,this.ownerRect=n,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new hl(160+md.DOUBLE_BORDER,80+md.DOUBLE_BORDER),this.MIN_SIZE=new hl(45+md.DOUBLE_BORDER,20+md.DOUBLE_BORDER),({inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer)),this.resizeGroup=this.createResizeHandle(this.svgRoot),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}createEditor(e){e=re(dl.FOREIGNOBJECT,{x:md.BORDER_WIDTH,y:md.BORDER_WIDTH},e);const t=document.createElementNS(sl,"body");t.setAttribute("xmlns",sl),t.className="blocklyMinimalBody";const n=document.createElementNS(sl,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),t.appendChild(n),e.appendChild(t),this.bindTextAreaEvents(n),setTimeout((()=>{n.focus()}),0),{inputRoot:e,textArea:n}}bindTextAreaEvents(e){W(e,"wheel",this,(e=>{e.stopPropagation()})),W(e,"focus",this,this.onStartEdit,!0),W(e,"change",this,this.onTextChange)}createResizeHandle(e){e=re(dl.G,{class:this.workspace.RTL?"blocklyResizeSW":"blocklyResizeSE"},e);const t=2*md.BORDER_WIDTH;return re(dl.POLYGON,{points:`0,${t} ${t},${t} ${t},0`},e),re(dl.LINE,{class:"blocklyResizeLine",x1:t/3,y1:t-1,x2:t-1,y2:t/3},e),re(dl.LINE,{class:"blocklyResizeLine",x1:2*t/3,y1:t-1,x2:t-1,y2:2*t/3},e),W(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const n=e.width-md.DOUBLE_BORDER,r=e.height-md.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${n}`),this.inputRoot.setAttribute("height",`${r}`),this.textArea.style.width=n-4+"px",this.textArea.style.height=r-4+"px",this.workspace.RTL?this.resizeGroup.setAttribute("transform",`translate(${md.DOUBLE_BORDER}, ${r}) scale(-1 1)`):this.resizeGroup.setAttribute("transform",`translate(${n}, ${r})`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(e){this.bringToFront(),Y(e)||(this.workspace.startDrag(e,new el(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=W(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=W(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){H(),this.resizePointerUpListener&&(q(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(q(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=this.workspace.moveDrag(e),this.setSize(new hl(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}};ee("\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n");var Cd=class extends cd{constructor(e){super(e),this.sourceBlock=e,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new hl(160,80),this.bubbleVisiblity=!1}getType(){return Cd.TYPE}initView(e){this.svgRoot||(super.initView(e),re(dl.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),re(dl.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),re(dl.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),ie(this.svgRoot,"blockly-icon-comment"))}dispose(){let e,t;super.dispose(),null==(e=this.textInputBubble)||e.dispose(),null==(t=this.textBubble)||t.dispose()}getWeight(){return Cd.WEIGHT}getSize(){return new hl(17,17)}applyColour(){super.applyColour();const e=this.sourceBlock.style.colourPrimary;let t,n;null==(t=this.textInputBubble)||t.setColour(e),null==(n=this.textBubble)||n.setColour(e)}updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(this.setBubbleVisible(!1),this.setBubbleVisible(!0))}onLocationChange(e){let t,n;super.onLocationChange(e),e=this.getAnchorLocation(),null==(t=this.textInputBubble)||t.setAnchorLocation(e),null==(n=this.textBubble)||n.setAnchorLocation(e)}setText(e){const t=this.text;let n,r;w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,t,e)),this.text=e,null==(n=this.textInputBubble)||n.setText(this.text),null==(r=this.textBubble)||r.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){let t,n,r,i;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new hl(null!=(n=e.width)?n:160,null!=(r=e.height)?r:80),this.bubbleVisiblity=null!=(i=e.pinned)&&i,setTimeout((()=>this.setBubbleVisible(this.bubbleVisiblity)),1)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){e&&(this.textBubble||this.textInputBubble)||(e||this.textBubble||this.textInputBubble)&&(this.bubbleVisiblity=e,this.sourceBlock.rendered&&!this.sourceBlock.isInFlyout&&(e?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),w(new($(ra))(this.sourceBlock,e,"comment"))))}showEditableBubble(){this.textInputBubble=new Sd(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener((()=>this.onTextChange())),this.textInputBubble.addSizeChangeListener((()=>this.onSizeChange()))}showNonEditableBubble(){this.textBubble=new xd(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let e,t;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null,null==(t=this.textBubble)||t.dispose(),this.textBubble=null}getAnchorLocation(){return el.sum(this.workspaceLocation,new el(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new pl(e.y,e.y+e.height,e.x,e.x+e.width)}};Cd.TYPE=Vl.COMMENT,Cd.WEIGHT=3,ls(Cd.TYPE,Cd);var Id=class extends cd{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return Id.TYPE}initView(e){this.svgRoot||(super.initView(e),re(dl.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),re(dl.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),re(dl.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),ie(this.svgRoot,"blockly-icon-warning"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return Id.WEIGHT}getSize(){return new hl(17,17)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;let n;return e?this.textMap.set(t,e):this.textMap.delete(t),null==(n=this.textBubble)||n.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){if(this.bubbleIsVisible()!==e){if(e)this.textBubble=new xd(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour();else{let e;null==(e=this.textBubble)||e.dispose(),this.textBubble=null}w(new($(ra))(this.sourceBlock,e,"warning"))}}getAnchorLocation(){return el.sum(this.workspaceLocation,new el(8.5,8.5))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new pl(e.y,e.y+e.height,e.x,e.x+e.width)}};Id.TYPE=Vl.WARNING,Id.WEIGHT=2;var Ad=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},wd={};wd.DuplicateIconType=Ad;var Nd,Dd={};Dd.CommentIcon=Cd,Dd.Icon=cd,Dd.IconType=Vl,Dd.MutatorIcon=Po.MutatorIcon$$module$build$src$core$icons$mutator_icon,Dd.WarningIcon=Id,Dd.exceptions=wd,Dd.registry=Ed,Po.DEFAULT_ARG$$module$build$src$core$procedures="x",(Nd={CATEGORY_NAME:"PROCEDURE",DEFAULT_ARG:Po.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=ld,Nd.allProcedures=us,Nd.findLegalName=Po.findLegalName$$module$build$src$core$procedures,Nd.flyoutCategory=fs,Nd.getCallers=ys,Nd.getDefinition=Po.getDefinition$$module$build$src$core$procedures,Nd.isNameUsed=hs,Nd.isProcedureBlock=Oi,Nd.mutateCallers=Po.mutateCallers$$module$build$src$core$procedures,Nd.mutatorOpenListener=_s,Nd.rename=Po.rename$$module$build$src$core$procedures;var Od=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},Rd=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=Od.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},Ld=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=Od.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Od.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(Od.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(Od.isSpacer(t))return t}return null}},Pd=class extends Ld{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=Od.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let r=0;r<this.elements.length;r++){const i=this.elements[r];t+=i.width,Od.isSpacer(i)||(Od.isNextConnection(i)?n=Math.max(n,i.height):e=Math.max(e,i.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Md=class extends Rd{constructor(e,t){super(e),this.connectionModel=t,this.type|=Od.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},Fd=class extends Md{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=Od.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},$d=class extends Fd{constructor(e,t){super(e,t),this.height=0,this.type|=Od.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},Bd=class extends Rd{constructor(e,t,n){super(e),this.field=t,this.parentInput=n,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=Od.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},Ud=class extends Rd{constructor(e){super(e),this.type|=Od.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},Vd=class extends Rd{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.isVisible=_i(t)&&t.bubbleIsVisible(),this.type|=Od.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},Hd=class extends Rd{constructor(e,t){super(e),this.type=this.type|Od.SPACER|Od.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},Gd=class extends Fd{constructor(e,t){super(e,t),this.type|=Od.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},jd=class extends Fd{constructor(e,t){super(e,t),this.type|=Od.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Kd=class extends Ld{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=Od.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const n=this.elements[t];this.width+=n.width,Od.isInput(n)&&n instanceof Fd&&(Od.isStatementInput(n)&&n instanceof jd?e+=n.connectedBlockWidth:Od.isExternalInput(n)&&n instanceof $d&&0!==n.connectedBlockWidth&&(e+=n.connectedBlockWidth-n.connectionWidth)),Od.isSpacer(n)||(this.height=Math.max(this.height,n.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Wd=class extends Rd{constructor(e){super(e),this.type|=Od.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},zd=class extends Md{constructor(e,t){super(e,t),this.type|=Od.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},qd=class extends Md{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=Od.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},Jd=class extends Md{constructor(e,t){super(e,t),this.type|=Od.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},Yd=class extends Rd{constructor(e,t){super(e),this.type=(t&&"left"!==t?Od.RIGHT_ROUND_CORNER:Od.LEFT_ROUND_CORNER)|Od.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},Xd=class extends Ld{constructor(e,t,n){super(e),this.height=t,this.width=n,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|Od.SPACER|Od.BETWEEN_ROW_SPACER,this.elements=[new Hd(this.constants_,n)]}measure(){}},Qd=class extends Rd{constructor(e,t){super(e),this.type=(t&&"left"!==t?Od.RIGHT_SQUARE_CORNER:Od.LEFT_SQUARE_CORNER)|Od.CORNER,this.width=this.height=this.constants_.NO_PADDING}},Zd=class extends Ld{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=Od.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,n=e.getPreviousBlock();return!!e.outputConnection||t||!!n&&n.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,n=0;for(let r=0;r<this.elements.length;r++){const i=this.elements[r];t+=i.width,Od.isSpacer(i)||(Od.isHat(i)&&i instanceof Ud?n=Math.max(n,i.ascenderHeight):e=Math.max(e,i.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},ep=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=rs(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const e in t)this.blockStyles[e]=this.validatedBlockStyle_(t[e]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=ge("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&0===e.indexOf("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=Di(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?Di(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?Di(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Si("#fff",e,.6)||e}generateTertiaryColour_(e){return Si("#fff",e,.3)||e}dispose(){this.embossFilter&&le(this.embossFilter),this.disabledPattern&&le(this.disabledPattern),this.debugFilter&&le(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:ss([es(t,e/4),es(2*-t,e/2),es(t,e/4)])}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:e,width:t,path:ts("c",[es(30,-e),es(70,-e),es(t,0)])}}makePuzzleTab(){function e(e){const r=-(e=e?-1:1);var i=n/2;const s=i+2.5,o=i+.5,a=es(-t,e*i);return i=es(t,e*i),ts("c",[es(0,e*s),es(-t,r*o),a])+ts("s",[es(t,2.5*r),i])}const t=this.TAB_WIDTH,n=this.TAB_HEIGHT,r=e(!0),i=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:n,pathDown:i,pathUp:r}}makeNotch(){function e(e){return ss([es(e*r,n),es(3*e,0),es(e*r,-n)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,r=(t-3)/2,i=e(1),s=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:i,pathRight:s}}makeInsideCorners(){const e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:as("a","0 0,0",e,es(-e,e)),pathBottom:as("a","0 0,0",e,es(e,e))}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=rs(0,e)+as("a","0 0,1",e,es(e,-e)),n=as("a","0 0,1",e,es(e,e)),r=as("a","0 0,1",e,es(-e,-e));return{topLeft:t,topRight:n,bottomRight:as("a","0 0,1",e,es(-e,e)),bottomLeft:r,rightHeight:e}}shapeFor(e){switch(e.type){case Ac.INPUT_VALUE:case Ac.OUTPUT_VALUE:return this.PUZZLE_TAB;case Ac.PREVIOUS_STATEMENT:case Ac.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,n){this.injectCSS_(t,n),this.defs=re(dl.DEFS,{},e),e=re(dl.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),re(dl.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=re(dl.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),re(dl.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),re(dl.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),re(dl.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=re(dl.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),re(dl.RECT,{width:10,height:10,fill:"#aaa"},e),re(dl.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const e=re(dl.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=re(dl.FECOMPONENTTRANSFER,{result:"outBlur"},e);re(dl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),re(dl.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),re(dl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const n=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=n:((t=document.createElement("style")).id=e,e=document.createTextNode(n),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect,`,`${e} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},tp={};tp.ConstantProvider=ep,tp.isDynamicShape=vs,tp.isNotch=ks,tp.isPuzzleTab=Ts;var np=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}hideHiddenIcons_(){ne("hideHiddenIcons_","v10","v11")}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=rs(e.xPos,this.info_.startY);for(let e,n=0;e=t[n];n++)Od.isLeftRoundedCorner(e)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Od.isRightRoundedCorner(e)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Od.isPreviousConnection(e)&&e instanceof Md?this.outlinePath_+=e.shape.pathLeft:Od.isHat(e)?this.outlinePath_+=this.constants_.START_HAT.path:Od.isSpacer(e)&&(this.outlinePath_+=os("h",e.width));this.outlinePath_+=os("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+os("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const n=vs(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=os("H",t.xPos+t.width)+n+os("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var n=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+os("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var r=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=os("H",n)+t+os("v",r)+this.constants_.INSIDE_CORNERS.pathBottom+os("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=os("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let n=0,r="";for(let i,s=t.length-1;i=t[s];s--)Od.isNextConnection(i)&&i instanceof Md?r+=i.shape.pathRight:Od.isLeftSquareCorner(i)?r+=os("H",e.xPos):Od.isLeftRoundedCorner(i)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Od.isRightRoundedCorner(i)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,n=this.constants_.OUTSIDE_CORNERS.rightHeight):Od.isSpacer(i)&&(r+=os("h",-1*i.width));this.outlinePath_+=os("V",e.baseline-n),this.outlinePath_+=r}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=vs(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=os("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e,t=0;e=this.info_.rows[t];t++)for(let t,n=0;t=e.elements[n];n++)Od.isInlineInput(t)?this.drawInlineInput_(t):(Od.isIcon(t)||Od.isField(t))&&this.layoutField_(t)}layoutField_(e){const t=e.centerline-e.height/2;let n=e.xPos;var r="";this.info_.RTL&&(n=-(n+e.width),e.flipRtl&&(n+=e.width,r="scale(-1 1)")),Od.isIcon(e)?((r=e.icon).setOffsetInBlock(new el(n,t)),this.info_.isInsertionMarker&&r.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+n+","+t+")"+r),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,n=e.height,r=e.connectionOffsetY,i=e.connectionHeight+r;this.inlinePath_+=ns(e.xPos+e.connectionWidth,e.centerline-n/2)+os("v",r)+e.shape.pathDown+os("v",n-i)+os("h",t-e.connectionWidth)+os("v",-n)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements)if(t instanceof Md)if(t.highlighted)this.drawConnectionHighlightPath(t);else{let e,n;null==(n=(e=this.block_.pathObject).removeConnectionHighlight)||n.call(e,t.connectionModel)}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===Ac.INPUT_VALUE||t.type===Ac.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const n=t.getSourceBlock();let r,i;null==(i=(r=n.pathObject).addConnectionHighlight)||i.call(r,t,e,t.getOffsetInBlock(),n.RTL)}getExpressionConnectionHighlightPath(e){let t="";return vs(e.shape)?t=e.shape.pathDown(e.height):Ts(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,rs(0,-e)+os("v",e)+t+os("v",e)}getStatementConnectionHighlightPath(e){if(!ks(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return rs(-t,0)+os("h",t)+e.shape.pathLeft+os("h",t)}};!function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"}(Po.Align$$module$build$src$core$inputs$align||(Po.Align$$module$build$src$core$inputs$align={})),Po.Align$$module$build$src$core$inputs$align;var rp=class extends sd{constructor(e,t,n){super(sd.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==sd.SKIP_SETUP&&(n?this.configure_(n):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&ie(this.getTextElement(),this.class)}doClassValidation_(e){return null==e?null:`${e}`}setClass(e){this.textElement_&&(this.class&&oe(this.textElement_,this.class),e&&ie(this.textElement_,e)),this.class=e}static fromJson(e){return new this(wi(e.text),void 0,e)}};Li("field_label",rp),rp.prototype.DEFAULT_VALUE="";var ip=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=Po.Align$$module$build$src$core$inputs$input.LEFT,this.visible=!0,this.type=Po.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,n){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return t||""===t&&n?("string"==typeof t&&(t=Po.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(t.init(),t.applyColour()),t.name=n,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),e):e}removeField(e,t){for(let t,n=0;t=this.fieldRow[n];n++)if(t.name===e)return t.dispose(),this.fieldRow.splice(n,1),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let t,n=0;t=this.fieldRow[n];n++)t.setVisible(e);if(this.connection){var n=this.connection;e?t=n.startTrackingAll():n.stopTrackingAll(),(n=n.targetBlock())&&(n.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e,t=0;e=this.fieldRow[t];t++)e.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let e=0;e<this.fieldRow.length;e++)this.fieldRow[e].init()}dispose(){for(let e,t=0;e=this.fieldRow[t];t++)e.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}};!function(e){(e=e.Align||(e.Align={}))[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"}(ip||(ip={})),Po.Align$$module$build$src$core$inputs$input=ip.Align,{Align:Po.Align$$module$build$src$core$inputs$input}.Input=ip;var sp=class extends ip{constructor(e,t){super(e,t),this.name=e,this.type=Po.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},op=class extends ip{constructor(e,t){super(e,t),this.name=e,this.type=Po.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},ap=class extends ip{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=Po.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Ac.NEXT_STATEMENT)}};Po.ValueInput$$module$build$src$core$inputs$value_input=class extends ip{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=Po.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Ac.INPUT_VALUE)}},Po.ValueInput$$module$build$src$core$inputs$value_input;var lp=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new qd(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new Zd(this.constants_),this.bottomRow=new Pd(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new Kd(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let n,r=0;n=t[r];r++){const t=new Vd(this.constants_,n);this.isCollapsed&&!n.isShownWhenCollapsed()||e.elements.push(t)}t=void 0;for(let n,r=0;n=this.block_.inputList[r];r++)if(n.isVisible()){this.shouldStartNewRow_(n,t)&&(this.rows.push(e),e=new Kd(this.constants_),this.inputRows.push(e));for(let t,r=0;t=n.fieldRow[r];r++)e.elements.push(new Bd(this.constants_,t,n));this.addInput_(n,e),t=n}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Wd(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let n=this.topRow.hasLeftSquareCorner(this.block_)?Qd:Yd;this.topRow.elements.push(new n(this.constants_)),t?(e=new Ud(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new Jd(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof ap&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,n=this.topRow.hasRightSquareCorner(this.block_)?Qd:Yd,this.topRow.elements.push(new n(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof ap?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Qd(this.constants_)):this.bottomRow.elements.push(new Yd(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new zd(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new Qd(this.constants_,"right")):this.bottomRow.elements.push(new Yd(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof Po.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new Gd(this.constants_,e)),t.hasInlineInput=!0):e instanceof ap?(t.elements.push(new jd(this.constants_,e)),t.hasStatement=!0):e instanceof Po.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new $d(this.constants_,e)),t.hasExternalInput=!0):(e instanceof sp||e instanceof op)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof op||e instanceof ap||t instanceof ap||(e instanceof Po.ValueInput$$module$build$src$core$inputs$value_input||e instanceof sp||t instanceof Po.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e,t=0;e=this.rows[t];t++){const t=e.elements;if(e.elements=[],e.startsWithElemSpacer()&&e.elements.push(new Hd(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let n=0;n<t.length-1;n++){e.elements.push(t[n]);const r=this.getInRowSpacing_(t[n],t[n+1]);e.elements.push(new Hd(this.constants_,r))}e.elements.push(t[t.length-1]),e.endsWithElemSpacer()&&e.elements.push(new Hd(this.constants_,this.getInRowSpacing_(t[t.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&Od.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&Od.isInput(e)&&!t){if(Od.isExternalInput(e))return this.constants_.NO_PADDING;if(Od.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Od.isStatementInput(e))return this.constants_.NO_PADDING}return e&&Od.isLeftSquareCorner(e)&&t&&(Od.isPreviousConnection(t)||Od.isNextConnection(t))?t.notchOffset:e&&Od.isLeftRoundedCorner(e)&&t&&(Od.isPreviousConnection(t)||Od.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,n=0;for(let i,s=0;i=this.rows[s];s++){if(i.measure(),t=Math.max(t,i.width),i.hasStatement){var r=i.getLastInput();let t,n;r=i.width-(null!=(n=null==(t=r)?void 0:t.width)?n:0),e=Math.max(e,r)}n=Math.max(n,i.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let e,t=0;e=this.rows[t];t++)e.hasStatement&&(e.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,n),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t,n=0;t=this.rows[n];n++)if(t.hasStatement)this.alignStatementRow_(t);else{var e=t.width;0<(e=this.getDesiredRowWidth_(t)-e)&&this.addAlignmentPadding_(t,e),Od.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const n=e.getFirstSpacer(),r=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===Po.Align$$module$build$src$core$inputs$align.LEFT&&r)r.width+=t;else if(e.align===Po.Align$$module$build$src$core$inputs$align.CENTRE&&n&&r)n.width+=t/2,r.width+=t/2;else if(e.align===Po.Align$$module$build$src$core$inputs$align.RIGHT&&n)n.width+=t;else{if(!r)return;r.width+=t}e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var n=e.width-t.width,r=this.statementEdge;0<(n=r-n)&&this.addAlignmentPadding_(e,n),n=e.width,r=this.getDesiredRowWidth_(e),t.width+=r-n,t.height=Math.max(t.height,e.height),e.width+=r-n,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var n=this.getSpacerRowHeight_(e,t);const r=this.getSpacerRowWidth_(e,t);return n=new Xd(this.constants_,n,r),e.hasStatement&&(n.followsStatement=!0),t.hasStatement&&(n.precedesStatement=!0),n}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return Od.isSpacer(t)?e.yPos+t.height/2:Od.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,Od.isNextConnection(t)?e+t.height/2:e-t.height/2):Od.isTopRow(e)?Od.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let n,r=0;n=e.elements[r];r++)Od.isSpacer(n)&&(n.height=e.height),n.xPos=t,n.centerline=this.getElemCenterline_(e,n),t+=n.width}finalize_(){let e=0,t=0;for(let n,r=0;n=this.rows[r];r++)n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks),this.recordElemPositions_(n);if(this.outputConnection&&this.block_.nextConnection){const t=this.block_.nextConnection.targetBlock();t&&(e=Math.max(e,t.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(const t of this.rows)for(const n of t.elements)if(n instanceof Md&&n.connectionModel===e)return n;return null}},cp=class{constructor(e,t,n){if(this.wsCoordinate=null,!t)throw Error("Cannot create a node without a location.");this.type=e,this.isConnectionLocation=cp.isConnectionType(e),this.location=t,this.processParams(n||null)}processParams(e){e&&e.wsCoordinate&&(this.wsCoordinate=e.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var e=this.location.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const n=t.inputList[e],r=n.fieldRow;for(let e=0;e<r.length;e++){const t=r[e];if(t.isClickable()||cp.NAVIGATE_ALL_FIELDS)return cp.createFieldNode(t)}if(n.connection)return cp.createInputNode(n)}return null}findNextForField(){var e=this.location,t=e.getParentInput();const n=e.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var r=n.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;r<n.inputList.length;r++){const i=(t=n.inputList[r]).fieldRow;for(;e<i.length;){if(i[e].isClickable()||cp.NAVIGATE_ALL_FIELDS)return cp.createFieldNode(i[e]);e++}if(e=0,t.connection)return cp.createInputNode(t)}return null}findPrevForInput(){const e=this.location.getParentInput(),t=e.getSourceBlock();for(var n=t.inputList.indexOf(e);0<=n;n--){var r=t.inputList[n];if(r.connection&&r!==e)return cp.createInputNode(r);for(let e=(r=r.fieldRow).length-1;0<=e;e--){const t=r[e];if(t.isClickable()||cp.NAVIGATE_ALL_FIELDS)return cp.createFieldNode(t)}}return null}findPrevForField(){var e=this.location;const t=e.getParentInput(),n=e.getSourceBlock();if(!n)throw Error("The current AST location is not associated with a block");var r=n.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=r;r--){var i=n.inputList[r];if(i.connection&&i!==t)return cp.createInputNode(i);for(i=i.fieldRow;-1<e;){if(i[e].isClickable()||cp.NAVIGATE_ALL_FIELDS)return cp.createFieldNode(i[e]);e--}0<=r-1&&(e=n.inputList[r-1].fieldRow.length-1)}return null}navigateBetweenStacks(e){var t=this.getLocation();if(t.getSourceBlock){var n=t.getSourceBlock();n&&(t=n)}if(!t||t.isDeadOrDying())return null;n=t.getRootBlock(),t=n.workspace.getTopBlocks(!0);for(let r=0;r<t.length;r++)if(n.id===t[r].id)return-1===(e=r+(e?1:-1))||e===t.length?null:cp.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}findTopASTNodeForBlock(e){const t=Es(e);return t?cp.createConnectionNode(t):cp.createBlockNode(e)}getOutAstNodeForBlock(e){if(!e)return null;e=e.getTopStackBlock();const t=Es(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?cp.createInputNode(t.targetConnection.getParentInput()):cp.createStackNode(e)}findFirstFieldOrInput(e){e=e.inputList;for(let t=0;t<e.length;t++){const n=e[t],r=n.fieldRow;for(let e=0;e<r.length;e++){const t=r[e];if(t.isClickable()||cp.NAVIGATE_ALL_FIELDS)return cp.createFieldNode(t)}if(n.connection)return cp.createInputNode(n)}return null}getSourceBlock(){return this.getType()===cp.types.BLOCK||this.getType()===cp.types.STACK?this.getLocation():this.getType()===cp.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case cp.types.STACK:return this.navigateBetweenStacks(!0);case cp.types.OUTPUT:return cp.createBlockNode(this.location.getSourceBlock());case cp.types.FIELD:return this.findNextForField();case cp.types.INPUT:return this.findNextForInput();case cp.types.BLOCK:const e=this.location.nextConnection;if(!e)break;return cp.createConnectionNode(e);case cp.types.PREVIOUS:return cp.createBlockNode(this.location.getSourceBlock());case cp.types.NEXT:return cp.createConnectionNode(this.location.targetConnection)}return null}in(){switch(this.type){case cp.types.WORKSPACE:const e=this.location.getTopBlocks(!0);if(0<e.length)return cp.createStackNode(e[0]);break;case cp.types.STACK:return this.findTopASTNodeForBlock(this.location);case cp.types.BLOCK:return this.findFirstFieldOrInput(this.location);case cp.types.INPUT:return cp.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case cp.types.STACK:return this.navigateBetweenStacks(!1);case cp.types.FIELD:return this.findPrevForField();case cp.types.INPUT:return this.findPrevForInput();case cp.types.BLOCK:var e=Es(this.location);if(!e)break;return cp.createConnectionNode(e);case cp.types.PREVIOUS:if((e=this.location.targetConnection)&&!e.getParentInput())return cp.createConnectionNode(e);break;case cp.types.NEXT:return cp.createBlockNode(this.location.getSourceBlock())}return null}out(){switch(this.type){case cp.types.STACK:var e=this.location,t=e.getRelativeToSurfaceXY();return t=new el(t.x,t.y+cp.DEFAULT_OFFSET_Y),cp.createWorkspaceNode(e.workspace,t);case cp.types.OUTPUT:return(t=(e=this.location).targetConnection)?cp.createConnectionNode(t):cp.createStackNode(e.getSourceBlock());case cp.types.FIELD:if(!(e=this.location.getSourceBlock()))throw Error("The current AST location is not associated with a block");return cp.createBlockNode(e);case cp.types.INPUT:return cp.createBlockNode(this.location.getSourceBlock());case cp.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case cp.types.PREVIOUS:case cp.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(e){switch(e){case cp.types.PREVIOUS:case cp.types.NEXT:case cp.types.INPUT:case cp.types.OUTPUT:return!0}return!1}static createFieldNode(e){return e?new cp(cp.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Ac.INPUT_VALUE||t===Ac.NEXT_STATEMENT&&e.getParentInput()?cp.createInputNode(e.getParentInput()):t===Ac.NEXT_STATEMENT?new cp(cp.types.NEXT,e):t===Ac.OUTPUT_VALUE?new cp(cp.types.OUTPUT,e):t===Ac.PREVIOUS_STATEMENT?new cp(cp.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new cp(cp.types.INPUT,e.connection):null}static createBlockNode(e){return e?new cp(cp.types.BLOCK,e):null}static createStackNode(e){return e?new cp(cp.types.STACK,e):null}static createWorkspaceNode(e,t){return t&&e?new cp(cp.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=Es(e);return t?cp.createConnectionNode(t):cp.createBlockNode(e)}};cp.NAVIGATE_ALL_FIELDS=!1,cp.DEFAULT_OFFSET_Y=-20,function(e){(e=e.types||(e.types={})).FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace"}(cp||(cp={}));var up=class extends ya{constructor(e,t,n,r){let i=e?e.workspace.id:void 0;r&&r.getType()===cp.types.WORKSPACE&&(i=r.getLocation().id),super(i),this.type="marker_move",this.blockId=null==e?void 0:e.id,this.oldNode=n||void 0,this.newNode=r,this.isCursor=t}toJson(){const e=super.toJson();if(void 0===this.isCursor)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new up)).isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};t(Uo.EVENT,"marker_move",up);var dp=class{constructor(e,t,n){this.workspace=e,this.marker=n,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=n.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return"cursor"===this.marker.type}createDom(){const e=this.isCursor()?"blocklyCursor":"blocklyMarker";return this.svgGroup_=re(dl.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var n=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||n,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent(e,t),void 0!==(e=this.currentMarkerSvg.childNodes[0])&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===cp.types.BLOCK?this.showWithBlock_(e):e.getType()===cp.types.OUTPUT?this.showWithOutput_(e):t===Ac.INPUT_VALUE?this.showWithInput_(e):t===Ac.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===cp.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===cp.types.FIELD?this.showWithField_(e):e.getType()===cp.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===cp.types.STACK&&this.showWithStack_(e)}showWithBlockPrevOutput(e){const t=(e=e.getSourceBlock()).width;var n=e.height,r=.75*n;const i=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(n=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,i,r,n)):e.outputConnection?(r=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,n,r)):this.positionBlock_(t,i,r),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput(e)}showWithPrevious_(e){this.showWithBlockPrevOutput(e)}showWithOutput_(e){this.showWithBlockPrevOutput(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){const t=(e=e.getLocation()).getSize().width,n=e.getSize().height;this.positionRect_(0,0,t,n),this.setParent_(e),this.showCurrent_()}showWithInput_(e){const t=(e=e.getLocation()).getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let n=0;t=t.getOffsetInBlock().y;const r=e.getHeightWidth().width;this.workspace.RTL&&(n=-r),this.positionLine_(n,t,r),this.setParent_(e),this.showCurrent_()}showWithStack_(e){var t=(e=e.getLocation()).getHeightWidth();const n=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const r=-this.constants_.CURSOR_STACK_PADDING/2,i=-this.constants_.CURSOR_STACK_PADDING/2;let s=r;this.workspace.RTL&&(s=-(n+r)),this.positionRect_(s,i,n,t),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,n){if(e=rs(-t,n)+os("V",-t)+os("H",e+2*t)+os("V",n),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,n=e.getOffsetInBlock().y;e=ns(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+n+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,n){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${e}`),this.markerSvgLine_.setAttribute("y",`${t}`),this.markerSvgLine_.setAttribute("width",`${n}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,n){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=rs(e,0)+os("h",-(e-n.width))+os("v",this.constants_.TAB_OFFSET_FROM_TOP)+n.pathDown+os("V",t)+os("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,n,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=rs(-t,n)+os("V",-t)+os("H",this.constants_.NOTCH_OFFSET_LEFT)+r.pathLeft+os("H",e+2*t)+os("V",n),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,n,r){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${e}`),this.markerSvgRect_.setAttribute("y",`${t}`),this.markerSvgRect_.setAttribute("width",`${n}`),this.markerSvgRect_.setAttribute("height",`${r}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(e,t){const n=t.getSourceBlock();e=new($("marker_move"))(n,this.isCursor(),e,t),w(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=re(dl.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=re(dl.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=re(dl.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=re(dl.PATH,{transform:""},this.markerSvg_),this.markerBlock_=re(dl.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();re(dl.ANIMATE,e,this.markerSvgLine_),re(dl.ANIMATE,e,this.markerInput_),re(dl.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&le(this.svgGroup_)}},pp=class{constructor(e,t,n){this.markerSvg=this.cursorSvg=null,this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=n,this.style=t,this.svgRoot=e,this.svgPath=re(dl.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?ie(this.svgRoot,e):oe(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,n,r){if(this.connectionHighlights.has(e)){if(this.currentHighlightMatchesNew(e,t,n))return;this.removeConnectionHighlight(e)}t=re(dl.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:`translate(${n.x}, ${n.y})`+(r?" scale(-1 1)":"")},this.svgRoot),this.connectionHighlights.set(e,t)}currentHighlightMatchesNew(e,t,n){let r;const i=null==(r=this.connectionHighlights.get(e))?void 0:r.getAttribute("d");return e=this.highlightOffsets.get(e),i===t&&el.equals(e,n)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(le(t),this.connectionHighlights.delete(e))}},hp=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e}connect_(e){const t=Ac.INPUT_VALUE,n=this.getSourceBlock();var r=e.getSourceBlock();let i,s;if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){const e=this.stashShadowState(),t=this.targetBlock();t.isShadow()?t.dispose(!1):(this.disconnectInternal(),i=t),this.applyShadowState(e)}L()&&(s=new($(Po.MOVE$$module$build$src$core$events$utils))(r)).setReason(["connect"]),xs(this,e),r.setParent(n),s&&(s.recordNew(),w(s)),i&&(e=this.type===t?i.outputConnection:i.previousConnection)&&((r=hp.getConnectionForOrphanedConnection(r,e))?e.connect(r):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Ac.INPUT_VALUE||this.type===Ac.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=Po.getGroup$$module$build$src$core$events$utils();t||Po.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),Po.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(!t||!n)throw Error("Source connection not connected.");const r=Po.getGroup$$module$build$src$core$events$utils();let i;r||Po.setGroup$$module$build$src$core$events$utils(!0),L()&&(i=new($(Po.MOVE$$module$build$src$core$events$utils))(n.getSourceBlock())).setReason(["disconnect"]);const s=this.targetConnection;s&&(s.targetConnection=null),this.targetConnection=null,e&&n.getSourceBlock().setParent(null),i&&(i.recordNew(),w(i)),n.getSourceBlock().isShadow()||t.respawnShadow_(),Po.setGroup$$module$build$src$core$events$utils(r)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){return!(this.getSourceBlock().isDeadOrDying()||(t=null==(n=e.getInput(t))?void 0:n.connection,(n=this.targetBlock())&&n!==e||!t||t.targetConnection===this||(t.isConnected()&&t.disconnect(),t.connect(this),0)));var n}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Mt(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?on(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let n=0;n<t.length;n++)if(t[n].connection===this){e=t[n];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let n,r=0;n=e.inputList[r];r++)if(n.connection===this){t=n;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,(e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.getSourceBlock().isDeadOrDying()||(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))}createShadowBlock(e){var t=this.getSourceBlock();const n=this.getShadowState(),r=this.getShadowDom();if(t.isDeadOrDying()||!n&&!r)return null;if(n)return _n(n,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(r){if(t=Ht(r,t.workspace),e)if(this.type===Ac.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==Ac.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}return null}serializeShadow(e){e&&(this.shadowDom=Mt(e),this.shadowState=on(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Ac.OUTPUT_VALUE)return Cs(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const n=t.getConnectionChecker();return e&&n.canConnect(t,e,!1)?e:null}};hp.CAN_CONNECT=0,hp.REASON_SELF_CONNECTION=1,hp.REASON_WRONG_TYPE=2,hp.REASON_TARGET_NULL=3,hp.REASON_CHECKS_FAILED=4,hp.REASON_DIFFERENT_WORKSPACES=5,hp.REASON_SHADOW_PARENT=6,hp.REASON_DRAG_CHECKS_FAILED=7,hp.REASON_PREVIOUS_AND_OUTPUT=8;var fp=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,g(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){Po.disable$$module$build$src$core$events$utils(),this.hidePreview(),Po.enable$$module$build$src$core$events$utils();var{local:e,closest:t}=this.activeCandidate;if(e.connect(t),this.topBlock.rendered){const n=e.isSuperior()?t:e,r=this.topBlock.getRootBlock();Et().then((()=>{Fr(n.getSourceBlock()),setTimeout((()=>{r.bringToFront()}),0)}))}}}update(e,t){const n=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!n,t))||this.shouldUpdatePreviews(n,e))&&(Po.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(n),this.maybeShowPreview(n),Po.enable$$module$build$src$core$events$utils())}createMarkerBlock(e){var t=e.type;let n;Po.disable$$module$build$src$core$events$utils();try{if((n=this.workspace.newBlock(t)).setInsertionMarker(!0),e.saveExtraState){var r=e.saveExtraState(!0);r&&n.loadExtraState&&n.loadExtraState(r)}else if(e.mutationToDom){const t=e.mutationToDom();t&&n.domToMutation&&n.domToMutation(t)}for(t=0;t<e.inputList.length;t++){const i=e.inputList[t];if("_TEMP_COLLAPSED_INPUT"===i.name)continue;const s=n.inputList[t];if(!s)throw Error("The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.".replace("%1","an input"));for(r=0;r<i.fieldRow.length;r++){const e=i.fieldRow[r],t=s.fieldRow[r];if(!t)throw Error("The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.".replace("%1","a field"));t.setValue(e.getValue())}}for(const e of n.getDescendants(!1))e.setInsertionMarker(!0);n.setCollapsed(e.isCollapsed()),n.setInputsInline(e.getInputsInline()),n.initSvg(),n.getSvgRoot().setAttribute("visibility","hidden")}finally{Po.enable$$module$build$src$core$events$utils()}return n}initAvailableConnections(){const e=this.topBlock.getConnections_(!1),t=this.topBlock.lastConnectionInStack(!0);return t&&t!==this.topBlock.nextConnection&&(e.push(t),this.lastOnStack=t),e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:n,closest:r}=this.activeCandidate;if(r===e.closest&&n===e.local)return!1;const i=n.x+t.x-r.x;return t=n.y+t.y-r.y,e.radius<Math.sqrt(i*i+t*t)-Po.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),n=null;for(let r=0;r<this.availableConnections.length;r++){const i=this.availableConnections[r],s=i.closest(t,e);s.connection&&(n={closest:s.connection,local:i,radius:s.radius},t=s.radius)}return n}getStartRadius(){return this.activeCandidate?Po.config$$module$build$src$core$config.connectingSnapRadius:Po.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return!(!t||!this.workspace.getComponentManager().hasCapability(t.id,Ya.Capability.DELETE_AREA))&&t.wouldDelete(this.topBlock,e)}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t,n=e.closest;n===(null==(t=this.activeCandidate)?void 0:t.closest)||n.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case fp.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case fp.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case fp.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(e){if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}}else this.hidePreview();this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=null==(e=this.activeCandidate)?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:n}=e;let r,i=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!i)throw Error("Cannot show the insertion marker because there is no insertion marker block");try{r=i.getMatchingConnection(t.getSourceBlock(),t)}catch(n){if(e&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),i=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),i=this.firstMarker=this.createMarkerBlock(this.topBlock)),!i)throw Error("Cannot show the insertion marker because there is no insertion marker block");r=i.getMatchingConnection(t.getSourceBlock(),t)}if(!r)throw Error("Cannot show the insertion marker because there is no associated connection");if(r===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");i.queueRender(),xt(),r.connect(n);const s={x:n.x-r.x,y:n.y-r.y},o=r.getOffsetInBlock().clone(),a=r;Et().then((()=>{let e,t;null==(e=i)||e.positionNearConnection(a,s,o),null==(t=i)||t.getSvgRoot().setAttribute("visibility","visible")})),this.markerConnection=r}hideInsertionMarker(){if(this.markerConnection){var e,t=this.markerConnection,n=t.getSourceBlock(),r=n.outputConnection;if(null!=(e=n.previousConnection)&&e.targetConnection||null!=r&&r.targetConnection)n.unplug(!0);else{let e;null==(e=t.targetBlock())||e.unplug(!1)}if(t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=n.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}disposeInsertionMarker(e){if(e){Po.disable$$module$build$src$core$events$utils();try{e.dispose()}finally{Po.enable$$module$build$src$core$events$utils()}}}};!function(e){(e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}))[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"}(fp||(fp={}));var mp=fp.PREVIEW_TYPE,_p={};_p.InsertionMarkerManager=fp,_p.PreviewType=mp;var gp=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const n=this.getConstants();n.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=n.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new ep}makeRenderInfo_(e){return new lp(this,e)}makeDrawer_(e,t){return new np(e,t)}makeMarkerDrawer(e,t){return new dp(e,this.getConstants(),t)}makePathObject(e,t){return new pp(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,n){return!!hp.getConnectionForOrphanedConnection(e,n===Ac.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,n){return ne("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),t.type===Ac.OUTPUT_VALUE||t.type===Ac.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(n,e.targetBlock(),t.type)?fp.PREVIEW_TYPE.INSERTION_MARKER:fp.PREVIEW_TYPE.REPLACEMENT_FADE:fp.PREVIEW_TYPE.INSERTION_MARKER}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},yp={};yp.BottomRow=Pd,yp.Connection=Md,yp.ConstantProvider=ep,yp.Drawer=np,yp.ExternalValueInput=$d,yp.Field=Bd,yp.Hat=Ud,yp.Icon=Vd,yp.InRowSpacer=Hd,yp.InlineInput=Gd,yp.InputConnection=Fd,yp.InputRow=Kd,yp.JaggedEdge=Wd,yp.MarkerSvg=dp,yp.Measurable=Rd,yp.NextConnection=zd,yp.OutputConnection=qd,yp.PathObject=pp,yp.PreviousConnection=Jd,yp.RenderInfo=lp,yp.Renderer=gp,yp.RoundCorner=Yd,yp.Row=Ld,yp.SpacerRow=Xd,yp.SquareCorner=Qd,yp.StatementInput=jd,yp.TopRow=Zd,yp.Types=Od,yp.init=ws,yp.register=Is,yp.unregister=As;var bp=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&oe(e,t),(t=this.theme.getClassName())&&ie(e,t));for(let e,t=0;e=this.subscribedWorkspaces_[t];t++)e.refreshTheme();for(const[n,r]of this.componentDB)for(const i of r){e=i.element,t=i.propertyName;const r=this.theme&&this.theme.getComponentStyle(n);e.style.setProperty(t,r||"")}for(const e of this.subscribedWorkspaces_)e.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces_.push(e)}unsubscribeWorkspace(e){if(!Z(this.subscribedWorkspaces_,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,n){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:n}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(n,t||"")}unsubscribe(e){if(e)for(const[t,n]of this.componentDB){for(let t=n.length-1;0<=t;t--)n[t].element===e&&n.splice(t,1);n.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},vp={CATEGORY_NAME:"VARIABLE_DYNAMIC"};vp.flyoutCategory=Rs,vp.flyoutCategoryBlocks=Ls,vp.onCreateVariableButtonClick_Colour=Os,vp.onCreateVariableButtonClick_Number=Ds,vp.onCreateVariableButtonClick_String=Ns;var Tp=class{canConnect(e,t,n,r){return this.canConnectWithReason(e,t,n,r)===hp.CAN_CONNECT}canConnectWithReason(e,t,n,r){const i=this.doSafetyChecks(e,t);return i!==hp.CAN_CONNECT?i:this.doTypeChecks(e,t)?n&&!this.doDragChecks(e,t,r||0)?hp.REASON_DRAG_CHECKS_FAILED:hp.CAN_CONNECT:hp.REASON_CHECKS_FAILED}getErrorMessage(e,t,n){switch(e){case hp.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case hp.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case hp.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case hp.REASON_TARGET_NULL:return"Target connection is null.";case hp.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+n.getCheck();case hp.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case hp.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case hp.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return hp.REASON_TARGET_NULL;let n,r,i;return e.isSuperior()?(n=e.getSourceBlock(),r=t.getSourceBlock(),i=t):(r=e.getSourceBlock(),n=t.getSourceBlock(),i=e,e=t),n===r?hp.REASON_SELF_CONNECTION:i.type!==Cu[e.type]?hp.REASON_WRONG_TYPE:n.workspace!==r.workspace?hp.REASON_DIFFERENT_WORKSPACES:n.isShadow()&&!r.isShadow()?hp.REASON_SHADOW_PARENT:i.type===Ac.OUTPUT_VALUE&&r.previousConnection&&r.previousConnection.isConnected()||i.type===Ac.PREVIOUS_STATEMENT&&r.outputConnection&&r.outputConnection.isConnected()?hp.REASON_PREVIOUS_AND_OUTPUT:hp.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let n=0;n<e.length;n++)if(-1!==t.indexOf(e[n]))return!0;return!1}doDragChecks(e,t,n){if(e.distanceFrom(t)>n||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case Ac.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Ac.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case Ac.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Ac.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return-1===zo.indexOf(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||-1!==zo.indexOf(t)||t.targetConnection&&(!(e=t.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}};t(Uo.CONNECTION_CHECKER,Bo,Tp);var kp=class extends Yl{constructor(e){super(e),this.type="var_delete",e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new kp)).varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};t(Uo.EVENT,"var_delete",kp);var Ep=class extends Yl{constructor(e,t){super(e),this.type="var_rename",e&&(this.oldName=e.name,this.newName=void 0===t?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ep)).oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};t(Uo.EVENT,"var_rename",Ep);var xp=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(;0<e.length;)this.deleteVariable(e[0]);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.name!==t){var n=this.getVariable(t,e.type),r=this.workspace.getAllBlocks(!1),i=Po.getGroup$$module$build$src$core$events$utils();i||Po.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==e.getId()?this.renameVariableWithConflict_(e,t,n,r):this.renameVariableAndUses_(e,t,r)}finally{Po.setGroup$$module$build$src$core$events$utils(i)}}}renameVariableById(e,t){const n=this.getVariableById(e);if(!n)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(n,t)}renameVariableAndUses_(e,t,n){for(w(new($("var_rename"))(e,t)),e.name=t,t=0;t<n.length;t++)n[t].updateVarName(e)}renameVariableWithConflict_(e,t,n,r){const i=e.type;for(t!==n.name&&this.renameVariableAndUses_(n,t,r),t=0;t<r.length;t++)r[t].renameVarById(e.getId(),n.getId());w(new($("var_delete"))(e)),Z(this.variableMap.get(i),e)}createVariable(e,t,n){var r=this.getVariable(e,t);if(r){if(n&&r.getId()!==n)throw Error('Variable "'+e+'" is already in use and its id is "'+r.getId()+'" which conflicts with the passed in id, "'+n+'".');return r}if(n&&this.getVariableById(n))throw Error('Variable id, "'+n+'", is already in use.');return r=n||C(),t=t||"",r=new Ql(this.workspace,e,t,r),(e=this.variableMap.get(t)||[]).push(r),this.variableMap.delete(t),this.variableMap.set(t,e),w(new($(ea))(r)),r}deleteVariable(e){const t=e.getId(),n=this.variableMap.get(e.type);if(n)for(let r=0;r<n.length;r++)if(n[r].getId()===t){n.splice(r,1),w(new($("var_delete"))(e)),0===n.length&&this.variableMap.delete(e.type);break}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var n=t.name;const r=this.getVariableUsesById(e);for(let t,i=0;t=r[i];i++)if("procedures_defnoreturn"===t.type||"procedures_defreturn"===t.type)return e=String(t.getFieldValue("NAME")),n=Po.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",n).replace("%2",e),void Je(n);1<r.length?(n=Po.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length)).replace("%2",n),Xe(n,(e=>{e&&t&&this.deleteVariableInternal(t,r)}))):this.deleteVariableInternal(t,r)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const n=Po.getGroup$$module$build$src$core$events$utils();n||Po.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);this.deleteVariable(e)}finally{Po.setGroup$$module$build$src$core$events$utils(n)}}getVariable(e,t){if(t=this.variableMap.get(t||""))for(let n,r=0;n=t[r];r++)if(Po.Names$$module$build$src$core$names.equals(n.name,e))return n;return null}getVariableById(e){for(const t of this.variableMap.values())for(const n of t)if(n.getId()===e)return n;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const n of e.getPotentialVariableMap().variableMap.keys())t.add(n);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map((e=>e.name))}getVariableUsesById(e){const t=[],n=this.workspace.getAllBlocks(!1);for(let r=0;r<n.length;r++){const i=n[r].getVarModels();if(i)for(let s=0;s<i.length;s++)i[s].getId()===e&&t.push(n[r])}return t}},Sp=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new ld,this.potentialVariableMap=null,this.id=C(),p(this),this.options=e||new Qu({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(c(Uo.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new xp(this)}dispose(){this.listeners.length=0,this.clear(),h(this)}sortObjects_(e,t){const n=Math.sin(ur(Sp.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+n*e.x-(t.y+n*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!Z(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){Z(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects_.bind(this)),e.filter((function(e){return!e.isInsertionMarker()}))):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!Z(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let n=0;n<t.length;n++)e.push(...t[n].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter((function(e){return!e.isInsertionMarker()}))}clear(){this.isClearing=!0;try{const e=Po.getGroup$$module$build$src$core$events$utils();for(e||Po.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();Po.setGroup$$module$build$src$core$events$utils(e),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,n){return this.variableMap.createVariable(e,t,n)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const n in e){if(e[n]>this.remainingCapacityOfType(n))return!1;t+=e[n]}return!(t>this.remainingCapacity())}hasBlockLimits(){return 1/0!==this.options.maxBlocks||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,n=e?this.undoStack_:this.redoStack_;const r=t.pop();if(r){for(var i=[r];t.length&&r.group&&r.group===t[t.length-1].group;){const e=t.pop();e&&i.push(e)}for(t=0;t<i.length;t++)n.push(i[t]);i=O(i,e),I(!1);try{for(n=0;n<i.length;n++)i[n].run(e)}finally{I(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,R()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){Z(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let n=0;n<t.length;n++)if(!t[n].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new xp(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return u(e)}static getAll(){return d()}};Sp.SCAN_ANGLE=3;var Cp=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound_=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var n=new globalThis.Audio}catch(e){return}for(let t=0;t<e.length;t++){const i=e[t],s=i.match(/\.(\w+)$/);if(s&&n.canPlayType("audio/"+s[1])){var r=new globalThis.Audio(i);break}}r&&this.sounds.set(t,r)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(void 0!==t?t.then(e.pause).catch((function(){})):e.pause(),Ua||Va)break}}play(e,t){if(!this.muted){var n=this.sounds.get(e);n?(e=new Date,null!==this.lastSound_&&e.getTime()-this.lastSound_.getTime()<100||(this.lastSound_=e,(n=Ua||Ba?n:n.cloneNode()).volume=void 0===t?1:t,n.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},Ip=class extends Sp{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(c(Uo.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Ip.setTopLevelWorkspaceMetrics_,this.componentManager=new Ya,this.connectionDBList=Nc.init(this.connectionChecker),this.audioManager=new Cp(e.parentWorkspace),this.grid=this.options.gridPattern?new zu(this.options.gridPattern,e.gridOptions):null,this.markerManager=new qu(this),tc&&st&&this.registerToolboxCategoryCallback("VARIABLE",st),vp&&Rs&&this.registerToolboxCategoryCallback("VARIABLE_DYNAMIC",Rs),Nd&&fs&&(this.registerToolboxCategoryCallback("PROCEDURE",fs),this.addChangeListener(_s)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new bp(this,this.options.theme||Xu),this.themeManager_.subscribeWorkspace(this),this.renderer=ws(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new hl(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=Xu),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter((function(e){return!!e.getStyleName()}))),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const e=new($("theme_change"))(this.getTheme().name,this.id);w(e)}updateBlockStyles_(e){for(let t,n=0;t=e[n];n++){const e=t.getStyleName();e&&t.setStyle(e)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(e){let t=0,n=0,r=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(r=this.scale);do{const i=Ie(e);e!==this.getCanvas()&&e!==this.getBubbleCanvas()||(r=1),t+=i.x*r,n+=i.y*r,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new el(t,n)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new hl(e.width,e.height)}getOriginOffsetInPixels(){return Ae(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if(-1!==(" "+(e.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=re(dl.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=re(dl.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e)),e=this.createLayer(50),ie(e,"blocklyBlockCanvas"),e=this.createLayer(100),ie(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=re(dl.SVG,{class:"blocklyBlockDragSurface",xmlns:il,"xmlns:html":sl,"xmlns:xlink":ol,version:"1.1"});return e.append(t),re(dl.G,{},t)}translateLayers(e,t){let n;e=`translate(${e.x}, ${e.y}) scale(${t})`,null==(n=this.dragLayer)||n.setAttribute("transform",e);for(const[,t]of this.layers)t.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot())}moveOffDragLayer(e,t){this.append(e,t)}append(e,t){let n;this.layers.has(t)||this.createLayer(t),null==(n=this.layers.get(t))||n.appendChild(e.getSvgRoot())}createLayer(e){const t=this.workspace.getSvgGroup(),n=re(dl.G,{});let r=!1;const i=[...this.layers].sort(((e,t)=>e[0]-t[0]));for(const[s,o]of i)if(e<s){t.insertBefore(n,o),r=!0;break}return r||t.appendChild(n),this.layers.set(e,n),n}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}}(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(W(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),W(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(c(Uo.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=c(Uo.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&le(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&le(e.parentNode)}this.resizeHandlerWrapper&&(q(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=Ip.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new Ul(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new Qu({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(c(Uo.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(c(Uo.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(Ya.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),n=[];for(let r,i=0;r=e[i];i++){r.position(t,n);const e=r.getBoundingRectangle();e&&n.push(e)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const e=Ne();el.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const n=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,n.setAttribute("data-cached-width",`${e}`)),null!=t&&(this.cachedParentSvgSize.height=t,n.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(L()){var e=this.scale,t=-this.scrollY,n=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(n-this.oldLeft))){var r=new($(ia))(t,n,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=n,w(r)}}}translate(e,t){let n,r;null==(n=this.layerManager)||n.translateLayers(new el(e,t),this.scale),null==(r=this.grid)||r.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.isVisible_=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox_&&this.toolbox_.setVisible(e),e||this.hideChaff(!0))}render(){for(var e=this.getAllBlocks(!1),t=e.length-1;0<=t;t--)e[t].queueRender();if(this.currentGesture_)for(e=this.currentGesture_.getInsertionMarkers(),t=0;t<e.length;t++)e[t].queueRender();Et().then((()=>{this.markerManager.updateMarkers()}))}highlightBlock(e,t){if(void 0===t){for(let e,t=0;e=this.highlightedBlocks[t];t++)e.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?-1===this.highlightedBlocks.indexOf(e)&&this.highlightedBlocks.push(e):Z(this.highlightedBlocks,e),e.setHighlighted(t))}paste(e){if(ne("Blockly.WorkspaceSvg.prototype.paste","v10","v11","Blockly.clipboard.paste"),!this.rendered||!e.type&&!e.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const t=Po.getGroup$$module$build$src$core$events$utils();let n;t||Po.setGroup$$module$build$src$core$events$utils(!0);try{n=e.type?this.pasteBlock_(null,e):"comment"===e.tagName.toLowerCase()?this.pasteWorkspaceComment_(e):this.pasteBlock_(e,null)}finally{Po.setGroup$$module$build$src$core$events$utils(t)}return n}pasteBlock_(e,t){let n;Po.disable$$module$build$src$core$events$utils();try{let r=0,i=0;if(e){let t,s;n=Ht(e,this),r=parseInt(null!=(t=e.getAttribute("x"))?t:"0"),this.RTL&&(r=-r),i=parseInt(null!=(s=e.getAttribute("y"))?s:"0")}else t&&(n=mn(t,this),r=t.x||10,this.RTL&&(r=this.getWidth()-r),i=t.y||10);if(!isNaN(r)&&!isNaN(i)){let e;do{e=!1;const t=this.getAllBlocks(!1);for(let n,s=0;n=t[s];s++){const t=n.getRelativeToSurfaceXY();if(1>=Math.abs(r-t.x)&&1>=Math.abs(i-t.y)){e=!0;break}}if(!e){const t=n.getConnections_(!1);for(let n,s=0;n=t[s];s++)if(n.closest(Po.config$$module$build$src$core$config.snapRadius,new el(r,i)).connection){e=!0;break}}e&&(r=this.RTL?r-Po.config$$module$build$src$core$config.snapRadius:r+Po.config$$module$build$src$core$config.snapRadius,i+=2*Po.config$$module$build$src$core$config.snapRadius)}while(e);n.moveTo(new el(r,i))}}finally{Po.enable$$module$build$src$core$events$utils()}return L()&&!n.isShadow()&&w(new($(Po.CREATE$$module$build$src$core$events$utils))(n)),n.select(),n}pasteWorkspaceComment_(e){let t;Po.disable$$module$build$src$core$events$utils();try{t=oc.fromXmlRendered(e,this);let n,r,i=parseInt(null!=(n=e.getAttribute("x"))?n:"0"),s=parseInt(null!=(r=e.getAttribute("y"))?r:"0");isNaN(i)||isNaN(s)||(this.RTL&&(i=-i),t.moveBy(i+50,s+50))}finally{Po.enable$$module$build$src$core$events$utils()}return L()&&nc.fireCreateEvent(t),t.select(),t}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox_&&e.toolbox_.getFlyout()&&e.toolbox_.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,n){return e=super.createVariable(e,t,n),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(Ya.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t,n=0;t=e[n];n++){const e=t.getClientRect();e&&this.dragTargetAreas.push({component:t,clientRect:e})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t,n=0;t=this.dragTargetAreas[n];n++)if(t.clientRect.contains(e.clientX,e.clientY))return t.component;return null}onMouseDown_(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){(e=X(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,this.dragDeltaXY=el.difference(t,e)}moveDrag(e){return(e=X(e,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,e.y/=this.scale,el.sum(this.dragDeltaXY,e)}isDragging(){return null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel_(e){if(Wu.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,n=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||n){var r=Q(e);if(Ha)var i=e.metaKey;t&&(e.ctrlKey||i||!n)?(r=-r.y/50,t=X(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,r)):(t=this.scrollX-r.x,n=this.scrollY-r.y,e.shiftKey&&!r.x&&(t=this.scrollX-r.y,n=this.scrollY),this.scroll(t,n)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new pl(0,0,0,0);const t=e[0].getBoundingRectangle();for(let r=1;r<e.length;r++){var n=e[r];n.isInsertionMarker&&n.isInsertionMarker()||((n=n.getBoundingRectangle()).top<t.top&&(t.top=n.top),n.bottom>t.bottom&&(t.bottom=n.bottom),n.left<t.left&&(t.left=n.left),n.right>t.right&&(t.right=n.right))}return t}cleanUp(){this.setResizesEnabled(!1),Po.setGroup$$module$build$src$core$events$utils(!0);const e=this.getTopBlocks(!0);let t=0;for(let n,r=0;n=e[r];r++){if(!n.isMovable())continue;const e=n.getRelativeToSurfaceXY();n.moveBy(-e.x,t-e.y,["cleanup"]),n.snapToGrid(),t=n.getRelativeToSurfaceXY().y+n.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}Po.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=tu.registry.getContextMenuOptions(tu.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),er(e,t,this.RTL)}}updateToolbox(e){if(e=Me(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Be(e)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox_.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(m(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,n){n=Math.pow(this.options.zoomOptions.scaleSpeed,n);const r=this.scale*n;if(this.scale!==r){r>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:r<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale);var i=this.getCanvas().getCTM(),s=this.getParentSvg().createSVGPoint();s.x=e,s.y=t,e=(s=s.matrixTransform(i.inverse())).x,t=s.y,i=i.translate(e*(1-n),t*(1-n)).scale(n),this.scrollX=i.e,this.scrollY=i.f,this.setScale(r)}}zoomCenter(e){var t=this.getMetrics();let n;this.flyout?(n=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(n=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(n,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var n=this.getBlocksBoundingBox(),r=n.right-n.left+40;if(n=n.bottom-n.top+40,r){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),r+=this.flyout.getWidth()/this.scale)),t/=r,e/=n,Po.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{Po.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){ie(this.getCanvas(),"blocklyCanvasTransitioning"),ie(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){oe(this.getCanvas(),"blocklyCanvasTransitioning"),oe(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,n=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,n=-n-e.scrollTop,this.scroll(t,n)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var n=e?this.getBlockById(e):null;if(n){e=n.getRelativeToSurfaceXY(),n=t?{height:n.height,width:n.width}:n.getHeightWidth();var r=this.scale;t=(e.x+(this.RTL?-1:1)*n.width/2)*r,e=(e.y+n.height/2)*r,n=this.getMetrics(),this.scroll(-(t-n.viewWidth/2),-(e-n.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(!0);const n=this.getMetrics();e=Math.min(e,-n.scrollLeft),t=Math.min(t,-n.scrollTop);const r=n.scrollTop+Math.max(0,n.scrollHeight-n.viewHeight);e=Math.max(e,-(n.scrollLeft+Math.max(0,n.scrollWidth-n.viewWidth))),t=Math.max(t,-r),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+n.scrollLeft),-(t+n.scrollTop),!1),e+=n.absoluteLeft,t+=n.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){Z(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t="pointerdown"===e.type,n=this.currentGesture_;return n?t&&n.hasStarted()?(console.warn("Tried to start the same gesture twice."),n.cancel(),null):n:t?this.currentGesture_=new Wu(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){li(),Gn(),Or(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(Ya.Capability.AUTOHIDEABLE,!0).forEach((t=>t.autoHide(e)))}static setTopLevelWorkspaceMetrics_(e){const t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},Ap={};Ap.WorkspaceSvg=Ip,Ap.resizeSvgContents=Ps;var wp=class extends ya{constructor(e,t){super(t),this.type="trashcan_open",this.isOpen=e}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new wp)).isOpen=e.isOpen,t}};t(Uo.EVENT,"trashcan_open",wp);var Np=class extends xc{constructor(e){if(super(e),this.type=Po.DELETE$$module$build$src$core$events$utils,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Rt(e),this.ids=M(e),this.wasShadow=e.isShadow(),this.oldJson=on(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=$t(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Np)).oldXml=Po.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const n=this.ids[e],r=t.getBlockById(n);r?r.dispose(!1):n===this.blockId&&console.warn("Can't delete non-existent block: "+n)}else mn(this.oldJson,t)}};t(Uo.EVENT,Po.DELETE$$module$build$src$core$events$utils,Np);var Dp=class{constructor(e,t,n){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.isInsertionMarker_=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=e,this.id=n&&!e.getBlockById(n)?n:C(),e.setBlockById(this.id,this),this.xy_=new el(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(n=jo[t])||"object"!=typeof n)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,n)}e.addTopBlock(this),e.addTypedBlock(this),new.target===Dp&&this.doInit_()}doInit_(){const e=Po.getGroup$$module$build$src$core$events$utils();e||Po.setGroup$$module$build$src$core$events$utils(!0);const t=A();try{"function"==typeof this.init&&(I(!1),this.init(),I(t)),L()&&w(new($(Po.CREATE$$module$build$src$core$events$utils))(this))}finally{Po.setGroup$$module$build$src$core$events$utils(e),I(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(e),L()&&w(new($(Po.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal())}disposeInternal(){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0,"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach((e=>e.disposeInternal())),this.inputList.forEach((e=>e.dispose())),this.inputList.length=0,this.getConnections_(!0).forEach((e=>e.dispose())),this.disposed=!0)}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(const e of this.inputList)for(const t of e.fieldRow)t.initModel&&t.initModel()}unplug(e){this.outputConnection&&this.unplugFromRow_(e),this.previousConnection&&this.unplugFromStack_(e)}unplugFromRow_(e){let t,n=null;null!=(t=this.outputConnection)&&t.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&e&&(e=this.getOnlyValueConnection_())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null==(e=e.targetConnection)||e.disconnect(),this.workspace.connectionChecker.canConnect(e,n,!1)?n.connect(e):null==e||e.onFailedConnect(n))}getOnlyValueConnection_(){let e=null;for(let t=0;t<this.inputList.length;t++){const n=this.inputList[t].connection;if(n&&n.type===Ac.INPUT_VALUE&&n.targetConnection){if(e)return null;e=n}}return e}unplugFromStack_(e){let t=null;var n;if(null!=(n=this.previousConnection)&&n.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),n=this.getNextBlock(),e&&n&&!n.isShadow()){let n,r;null==(e=null!=(r=null==(n=this.nextConnection)?void 0:n.targetConnection)?r:null)||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t,n=0;t=this.inputList[n];n++)t.connection&&e.push(t.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const n=t.targetBlock();if(!n||e&&n.isShadow())return t;t=n.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t,n=0;t=this.inputList[n];n++)if(t.connection&&t.connection.targetBlock()===e)return t;return null}getSurroundParent(){let e,t=this;do{if(e=t,!(t=t.getParent()))return null}while(t.getNextBlock()===e);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do{t=(e=t).parentBlock_}while(t);return e}getTopStackBlock(){let e,t=this;do{e=t.getPreviousBlock()}while(e&&e.getNextBlock()===t&&(t=e));return t}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let n,r=0;n=this.inputList[r];r++)if(n.connection){var t=n.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),n=!!t;if(n&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!n&&e)throw Error("Block not connected to new parent.");if(n&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?Z(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],n=this.getChildren(e);for(let r,i=0;r=n[i];i++)t.push(...r.getDescendants(e));return t}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(e){this.deletable_=e}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(e){this.movable_=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(T(this,!0))}isShadow(){return this.isShadow_}setShadow(e){this.isShadow_=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(e){this.editable_=e;for(let e,t=0;e=this.inputList[t];t++)for(let t,n=0;t=e.fieldRow[n];n++)t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(e,t){const n=this.getConnections_(!0);if(e=e.getConnections_(!0),n.length!==e.length)throw Error("Connection lists did not match in length.");for(let r=0;r<e.length;r++)if(e[r]===t)return n[r];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return Zr(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(e){e=Di(e),this.hue_=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=e,this.onchangeWrapper_=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(let t,n=0;t=this.inputList[n];n++)for(let n,r=0;n=t.fieldRow[r];r++)if(n.name===e)return n;return null}getVars(){const e=[];for(let t,n=0;t=this.inputList[n];n++)for(let n,r=0;n=t.fieldRow[r];r++)n.referencesVariables()&&e.push(n.getValue());return e}getVarModels(){const e=[];for(let t,n=0;t=this.inputList[n];n++)for(let n,r=0;n=t.fieldRow[r];r++)if(n.referencesVariables()){const t=this.workspace.getVariableById(n.getValue());t&&e.push(t)}return e}updateVarName(e){for(let t,n=0;t=this.inputList[n];n++)for(let n,r=0;n=t.fieldRow[r];r++)n.referencesVariables()&&e.getId()===n.getValue()&&n.refreshVariableName()}renameVarById(e,t){for(let n,r=0;n=this.inputList[r];r++)for(let r,i=0;r=n.fieldRow[i];i++)r.referencesVariables()&&e===r.getValue()&&r.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const n=this.getField(t);if(!n)throw Error('Field "'+t+'" not found.');n.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Ac.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Ac.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Ac.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof sp&&this.inputList[e]instanceof sp)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Po.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof sp)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof op)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(e){if(this.isEnabled()!==e){const t=this.disabled;this.disabled=!e,w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,t,!e))}}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(e.disabled)return!0;e=e.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let e=2;e<t.length;e++)"("===t[e-2]&&")"===t[e]&&(t[e-2]=t[e-1],t.splice(e-1,2));let n="";return t=(t=t.reduce(((e,t)=>(e=e+("("===n||")"===t?"":" ")+t,n=t[t.length-1],e)),"")).trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const r of this.inputList)if("_TEMP_COLLAPSED_INPUT"!=r.name){for(const e of r.fieldRow)t.push(e.getText());if(r.connection){const i=r.connection.targetBlock();if(i){var n=r.connection;let s=n.getCheck();!s&&n.targetConnection&&(s=n.targetConnection.getCheck()),(n=!!s&&(-1!==s.indexOf("Boolean")||-1!==s.indexOf("Number")))&&t.push("("),t.push(...i.toTokens(e)),n&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new Po.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new ap(e,this))}appendDummyInput(e=""){return this.appendInput(new sp(e,this))}appendEndRowInput(e=""){return this.appendInput(new op(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=o(Uo.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var n=0;e["args"+n];){if(void 0===e["message"+n])throw Error(t+`args${n} must have a corresponding message (message${n}).`);n++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle_(e,t):this.jsonInitColour_(e,t),n=0;void 0!==e["message"+n];)this.interpolate_(e["message"+n],e["args"+n]||[],e["implicitAlign"+n]||e["lastDummyAlign"+n],t),n++;if(void 0!==e.inputsInline&&(Po.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),Po.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(n=wi(e.tooltip),this.setTooltip(n)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(n=wi(e.helpUrl),this.setHelpUrl(n)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Hi(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Hi(e[t],this,!1)}jsonInitColour_(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(n){console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle_(e,t){e=e.style;try{this.setStyle(e)}catch(n){console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const n in e)void 0!==this[n]&&t.push(n);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate_(e,t,n,r){e=Ai(e),this.validateTokens_(e,t.length),t=this.interpolateArguments_(e,t,n),n=[];for(let i,s=0;i=t[s];s++)if(this.isInputKeyword_(i.type)){if(e=this.inputFromJson_(i,r)){for(let t,r=0;t=n[r];r++)e.appendField(t[0],t[1]);n.length=0}}else(e=this.fieldFromJson_(i))&&n.push([e,i.name])}validateTokens_(e,t){const n=[];let r=0;for(let i=0;i<e.length;i++){const s=e[i];if("number"==typeof s){if(1>s||s>t)throw Error('Block "'+this.type+'": Message index %'+s+" out of range.");if(n[s])throw Error('Block "'+this.type+'": Message index %'+s+" duplicated.");n[s]=!0,r++}}if(r!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments_(e,t,n){const r=[];for(let s=0;s<e.length;s++){var i=e[s];if("number"==typeof i&&(i=t[i-1]),"string"==typeof i)if("\n"===i)i={type:"input_end_row"},n&&(i.align=n);else if(!(i=this.stringToFieldJson_(i)))continue;r.push(i)}return(e=r.length)&&!this.isInputKeyword_(r[e-1].type)&&(e={type:"input_dummy"},n&&(e.align=n),r.push(e)),r}fieldFromJson_(e){const t=Po.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson_(e.alt))?this.fieldFromJson_(e):null:this.fieldFromJson_(e.alt):t}inputFromJson_(e,t){var n={LEFT:Po.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:Po.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:Po.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:Po.Align$$module$build$src$core$inputs$align.CENTRE};let r;switch(e.type){case"input_value":r=this.appendValueInput(e.name);break;case"input_statement":r=this.appendStatementInput(e.name);break;case"input_dummy":r=this.appendDummyInput(e.name);break;case"input_end_row":r=this.appendEndRowInput(e.name);break;default:r=this.appendInputFromRegistry(e.type,e.name)}return r?(e.check&&r.setCheck(e.check),e.align&&(void 0===(n=n[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):r.setAlign(n)),r):null}isInputKeyword_(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||s(Uo.INPUT,e)}stringToFieldJson_(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var n=-1,r=t?-1:this.inputList.length;for(let i,s=0;i=this.inputList[s];s++)if(i.name===e){if(n=s,-1!==r)break}else if(t&&i.name===t&&(r=s,-1!==n))break;if(-1===n)throw Error('Named input "'+e+'" not found.');if(-1===r)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(n,r)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const n=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,n)}removeInput(e,t){for(let t,n=0;t=this.inputList[n];n++)if(t.name===e)return t instanceof ap&&this.statementInputCount--,t.dispose(),this.inputList.splice(n,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t,n=0;t=this.inputList[n];n++)if(t.name===e)return t;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(Cd.TYPE))?void 0:e.getText())?t:null}setCommentText(e){var t;let n;const r=null!=(n=null==(t=this.getIcon(Cd.TYPE))?void 0:t.getText())?n:null;r!==e&&(null!==e?((t=this.getIcon(Cd.TYPE))||(t=this.addIcon(new Cd(this))),Po.disable$$module$build$src$core$events$utils(),t.setText(e),Po.enable$$module$build$src$core$events$utils()):this.removeIcon(Cd.TYPE),w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,r,e)))}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new Ad(e);return this.icons.push(e),this.icons.sort(((e,t)=>e.getWeight()-t.getWeight())),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter((t=>!t.getType().equals(e))),!0}hasIcon(e){return this.icons.some((t=>t.getType().equals(e)))}getIcon(e){return e instanceof Vl?this.icons.find((t=>t.getType().equals(e))):this.icons.find((t=>t.getType().toString()===e))}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const r=new($(Po.MOVE$$module$build$src$core$events$utils))(this);n&&r.setReason(n),this.xy_.translate(e,t),r.recordNew(),w(r)}makeConnection_(e){return new hp(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let n,r=0;n=this.inputList[r];r++)if(n.connection){var t=n.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};Dp.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",Dp.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD";var Op=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(e){this.drawer=e}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(e){const t=this.curNode;this.curNode=e,this.drawer&&this.drawer.draw(t,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},Rp=class extends Op{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===cp.types.NEXT||e.getType()===cp.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;let t,n;return e.getType()!==cp.types.PREVIOUS&&e.getType()!==cp.types.OUTPUT||(e=e.next()),(e=null!=(n=null==(t=e)?void 0:t.in())?n:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===cp.types.NEXT||e.getType()===cp.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===cp.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};t(Uo.CURSOR,Bo,Rp);var Lp=class extends Rp{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const n=e.in()||e.next();return t(n)?n:n?this.getNextNode_(n,t):t(e=this.findSiblingOrParent(e.out()))?e:e?this.getNextNode_(e,t):null}getPreviousNode_(e,t){if(!e)return null;let n=e.prev();return t(n=n?this.getRightMostChild(n):e.out())?n:n?this.getPreviousNode_(n,t):null}validNode_(e){let t=!1;return(e=e&&e.getType())!==cp.types.OUTPUT&&e!==cp.types.INPUT&&e!==cp.types.FIELD&&e!==cp.types.NEXT&&e!==cp.types.PREVIOUS&&e!==cp.types.WORKSPACE||(t=!0),t}findSiblingOrParent(e){if(!e)return null;return e.next()||this.findSiblingOrParent(e.out())}getRightMostChild(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild(e)}};Lp.registrationName="basicCursor",t(Uo.CURSOR,Lp.registrationName,Lp);var Pp=class extends Lp{validNode_(e){let t=!1;const n=e&&e.getType();return e&&(e=e.getLocation(),n===cp.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=!0)),t}},Mp=class extends hp{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[Cu[t]],this.offsetInBlock=new el(0,0),this.trackedState=Mp.TrackedState.WILL_TRACK}dispose(){let e,t;super.dispose(),this.trackedState===Mp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e){if(!this.sourceBlock_.workspace.isDragging()){var t=this.sourceBlock_.getRootBlock();if(!t.isInFlyout){var n=!1;if(!t.isMovable()){if(!(t=e.getSourceBlock().getRootBlock()).isMovable())return;e=this,n=!0}var r=_()==t;r||t.addSelect();var i=e.x+Po.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random())-this.x,s=e.y+Po.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random())-this.y;n&&(s=-s),t.RTL&&(i=e.x-Po.config$$module$build$src$core$config.snapRadius-Math.floor(10*Math.random())-this.x),t.moveBy(i,s,["bump"]),r||t.removeSelect()}}}moveTo(e,t){let n=!1;return this.trackedState===Mp.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Mp.TrackedState.TRACKED,n=!0):this.trackedState===Mp.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),n=!0),this.x=e,this.y=t,n}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=el.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0,this.getSourceBlock().queueRender()}unhighlight(){this.highlighted=!1,this.getSourceBlock().queueRender()}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Mp.TrackedState.TRACKED||!e&&this.trackedState===Mp.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Mp.TrackedState.TRACKED):(this.trackedState===Mp.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Mp.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const n=e[t],r=n.getConnections_(!0);for(let e=0;e<r.length;e++)r[e].setTracking(!1);for(const e of n.getIcons())_i(e)&&e.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==Ac.INPUT_VALUE&&this.type!==Ac.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let n;t.isCollapsed()?(n=[],t.outputConnection&&n.push(t.outputConnection),t.nextConnection&&n.push(t.nextConnection),t.previousConnection&&n.push(t.previousConnection)):n=t.getConnections_(!0);for(let t=0;t<n.length;t++)e.push(...n[t].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(A()){const n=Po.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(Po.setGroup$$module$build$src$core$events$utils(n),this.bumpAwayFrom(e),Po.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),Po.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:n}=this.getParentAndChildConnections();if(t&&n){var r=t.getSourceBlock(),i=n.getSourceBlock();super.disconnectInternal(e),r.rendered&&r.queueRender(),i.rendered&&(i.updateDisabled(),i.queueRender(),i.getSvgRoot().style.display="block")}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock();const n=t.rendered,r=e.rendered;n&&t.updateDisabled(),r&&e.updateDisabled(),n&&r&&(this.type===Ac.NEXT_STATEMENT||this.type===Ac.PREVIOUS_STATEMENT?e.queueRender():t.queueRender()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}setCheck(e){return super.setCheck(e),this.sourceBlock_.rendered&&this.sourceBlock_.queueRender(),this}};!function(e){(e=e.TrackedState||(e.TrackedState={}))[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"}(Mp||(Mp={}));var Fp=Mp.TrackedState,$p={};$p.RenderedConnection=Mp,$p.TrackedState=Fp;var Bp=class extends Dp{constructor(e,t,n){super(e,t,n),this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=this.rendered=!1,this.translation="",this.bumpNeighboursPid=0,this.dragging=!1,this.relativeCoords=new el(0,0),this.workspace=e,this.svgGroup_=re(dl.G,{}),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup_,this.style),(e=this.pathObject.svgPath).tooltip=this,ni(e),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let e,t=0;e=this.inputList[t];t++)e.init();for(var e of this.getIcons())e.initView(this.createIconPointerDownListener(e)),e.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||W(e,"pointerdown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(_()!==this){var e=null;if(_()){e=_().id,Po.disable$$module$build$src$core$events$utils();try{_().unselect()}finally{Po.enable$$module$build$src$core$events$utils()}}e=new($("selected"))(e,this.id,this.workspace.id),w(e),g(this),this.addSelect()}}unselect(){if(_()===this){var e=new($("selected"))(this.id,null,this.workspace.id);e.workspaceId=this.workspace.id,w(e),g(null),this.removeSelect()}}setParent(e){const t=this.parentBlock_;if(e!==t){pe(),super.setParent(e),he();var n=this.getSvgRoot();if(!this.workspace.isClearing&&n){var r=this.getRelativeToSurfaceXY();e?e.getSvgRoot().appendChild(n):t&&((e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(n,e):this.workspace.getCanvas().appendChild(n),this.translate(r.x,r.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,n=0,r=this.getSvgRoot();if(r)do{const e=Ie(r);t+=e.x,n+=e.y,r=r.parentNode}while(r&&!e.hasLayer(r));return new el(t,n)}moveBy(e,t,n){if(this.parentBlock_)throw Error("Block has parent");const r=L();let i=null;r&&(i=new($(Po.MOVE$$module$build$src$core$events$utils))(this),n&&i.setReason(n)),e=new el(e,t),t=this.getRelativeToSurfaceXY(),e=el.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),r&&i&&(i.recordNew(),w(i)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new el(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const n=this.getRelativeToSurfaceXY();this.moveBy(e.x-n.x,e.y-n.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var e=this.workspace.getGrid();if(e&&e.shouldSnap()){var t=e.getSpacing(),n=t/2,r=this.getRelativeToSurfaceXY();e=Math.round(Math.round((r.x-n)/t)*t+n-r.x),t=Math.round(Math.round((r.y-n)/t)*t+n-r.y),(e||t)&&this.moveBy(e,t,["snap"])}}}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY(),t=this.getHeightWidth();let n,r;return this.RTL?(n=e.x-t.width,r=e.x):(n=e.x,r=e.x+t.width),new pl(e.y,e.y+t.height,n,r)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e,t=0;e=this.inputList[t];t++)e.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed_())}updateCollapsed_(){var e=this.isCollapsed();const t="_TEMP_COLLAPSED_INPUT",n="_TEMP_COLLAPSED_FIELD";for(let n,r=0;n=this.inputList[r];r++)n.name!==t&&n.setVisible(!e);for(var r of this.getIcons())r.updateCollapsed();e?(e=this.toString(30),(r=this.getField(n))?r.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new rp(e),n)):(this.updateDisabled(),this.removeInput(t))}tab(e,t){const n=new Pp;n.setCurNode(cp.createFieldNode(e)),e=n.getCurNode(),t?n.next():n.prev(),(t=n.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown_(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=tu.registry.getContextMenuOptions(tu.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(er(e,t,this.RTL),Zn(this))}updateComponentLocations(e){if(this.rendered){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(el.sum(e,t.relativeCoords))}}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const n of t.fieldRow)n.onLocationChange(e)}setDragging(e){(this.dragging=e)?(this.translation="",zo.push(...this.getConnections_(!0)),ie(this.svgGroup_,"blocklyDragging")):(zo.length=0,oe(this.svgGroup_,"blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(e,t){this.isDeadOrDying()||(ai(),sr(),t&&this.rendered&&(this.unplug(e),Pr(this)),super.dispose(!!e),le(this.svgGroup_))}disposeInternal(){this.isDeadOrDying()||(super.disposeInternal(),this.rendered=!1,_()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach((e=>clearTimeout(e))),this.warningTextDb.clear(),this.getIcons().forEach((e=>e.dispose())))}checkAndDelete(){this.workspace.isFlyout||(Po.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),Po.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:Dc.TYPE,blockState:on(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:T(this,!0)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let e,t=0;e=this.inputList[t];t++)for(let t,n=0;t=e.fieldRow[n];n++)t.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let e;null==(e=this.getNextBlock())||e.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const e of this.getChildren(!1))e.updateDisabled()}}getCommentIcon(){let e;return ne("getCommentIcon","v10","v11","getIcon"),null!=(e=this.getIcon(Cd.TYPE))?e:null}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var n of this.warningTextDb.values())clearTimeout(n);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout((()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))}),100));else if(this.isInFlyout&&(e=null),n=this.getIcon(Id.TYPE),e){let r=this.getSurroundParent(),i=null;for(;r;)r.isCollapsed()&&(i=r),r=r.getSurroundParent();i&&i.setWarningText(Po.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Bp.COLLAPSED_WARNING_ID),n?n.addMessage(e,t):this.addIcon(new Id(this).addMessage(e,t))}else n&&(t?(n.addMessage("",t),n.getText()||this.removeIcon(Id.TYPE)):this.removeIcon(Id.TYPE))}setMutator(e){this.removeIcon(Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof Id&&(this.warning=e),e instanceof Po.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),this.rendered&&(e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),xt(),this.bumpNeighbours()),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(Id.TYPE)&&(this.warning=null),e.equals(Po.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.rendered&&(this.queueRender(),xt(),this.bumpNeighbours()),t}setEnabled(e){this.isEnabled()!==e&&(super.setEnabled(e),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(e){this.rendered&&this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,!t)throw Error("Invalid style name: "+e);this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour()}bringToFront(e=!1){let t=this;if(!t.isDeadOrDying())do{const n=t.getSvgRoot(),r=n.parentNode,i=r.childNodes;if(i[i.length-1]!==n&&r.appendChild(n),e)break;t=t.getParent()}while(t)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setNextStatement(e,t){super.setNextStatement(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setOutput(e,t){super.setOutput(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setInputsInline(e){super.setInputsInline(e),this.rendered&&(this.queueRender(),this.bumpNeighbours())}removeInput(e,t){return e=super.removeInput(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours()),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}appendInput(e){return super.appendInput(e),this.rendered&&(this.queueRender(),this.bumpNeighbours()),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var n=this.inputList[t].connection;n&&(n.setTracking(e),(n=n.targetBlock())&&n.setConnectionTracking(e))}}getConnections_(e){const t=[];if((e||this.rendered)&&(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_))for(let e,n=0;e=this.inputList[n];n++)e.connection&&t.push(e.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Mp(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){if(!this.bumpNeighboursPid){var e=Po.getGroup$$module$build$src$core$events$utils();this.bumpNeighboursPid=setTimeout((()=>{const t=Po.getGroup$$module$build$src$core$events$utils();Po.setGroup$$module$build$src$core$events$utils(e),this.getRootBlock().bumpNeighboursInternal(),Po.setGroup$$module$build$src$core$events$utils(t),this.bumpNeighboursPid=0}),Po.config$$module$build$src$core$config.bumpDelay)}}bumpNeighboursInternal(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let e;null==(e=t.targetBlock())||e.bumpNeighboursInternal()}for(const n of t.neighbours(Po.config$$module$build$src$core$config.snapRadius))n.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&n.isConnected()||(t.isSuperior()?n.bumpAwayFrom(t):t.bumpAwayFrom(n)))}}scheduleSnapAndBump(){const e=Po.getGroup$$module$build$src$core$events$utils();setTimeout((()=>{Po.setGroup$$module$build$src$core$events$utils(e),this.snapToGrid(),Po.setGroup$$module$build$src$core$events$utils(!1)}),Po.config$$module$build$src$core$config.bumpDelay/2),this.bumpNeighbours()}positionNearConnection(e,t,n){if(e.type===Ac.NEXT_STATEMENT||e.type===Ac.INPUT_VALUE){let r=t.x;t=t.y,r+=n.x-e.getOffsetInBlock().x,t+=n.y-e.getOffsetInBlock().y,this.moveBy(r,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return kt(this)}render(){this.queueRender(),xt()}renderEfficiently(){this.rendered=!0,pe(),this.isCollapsed()&&this.updateCollapsed_(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),he(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(qu.LOCAL_MARKER).draw();for(const e of this.inputList)for(const t of e.fieldRow)t.updateMarkers_()}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var n=this.getNextBlock();if(n){n=n.getHeightWidth();const r=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=n.height-r,t=Math.max(t,n.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}};Bp.INLINE=-1,Bp.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var Up,Vp=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},Hp=class extends Vp{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e,t){return e instanceof Bp?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e&&!t)):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Gp=class extends Hp{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(e=new Qu({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Al.TOP?Al.BOTTOM:Al.TOP,this.flyout=new(c(Uo.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Al.RIGHT?Al.LEFT:Al.RIGHT,this.flyout=new(c(Uo.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=re(dl.G,{class:"blocklyTrash"});const t=String(Math.random()).substring(2);e=re(dl.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),re(dl.RECT,{width:jp,height:Kp,y:Wp},e);const n=re(dl.IMAGE,{width:Fl,x:-Yp,height:$l,y:-Xp,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return n.setAttributeNS(ol,"xlink:href",this.workspace.options.pathToMedia+Bl),e=re(dl.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),re(dl.RECT,{width:jp,height:Wp},e),this.svgLid=re(dl.IMAGE,{width:Fl,x:-Yp,height:$l,y:-Xp,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(ol,"xlink:href",this.workspace.options.pathToMedia+Bl),z(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),z(this.svgGroup,"pointerup",this,this.click),z(n,"pointerover",this,this.mouseOver),z(n,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(ce(this.flyout.createDom(dl.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ya.Capability.AUTOHIDEABLE,Ya.Capability.DELETE_AREA,Ya.Capability.DRAG_TARGET,Ya.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&le(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map((function(e){return JSON.parse(e)})),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout((()=>{let n,r;null==(n=this.flyout)||n.show(e),t.cursor="",null==(r=this.workspace.scrollbar)||r.setVisible(!1)}),10),this.fireUiEvent(!0)}}closeFlyout(){var e,t;this.contentsIsOpen()&&(null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var n,r=ze(this.workspace,e);e=We(r,new hl(jp,Kp+Wp),qp,zp,e,this.workspace),t=qe(e,zp,r.vertical===Dl.TOP?Rl.DOWN:Rl.UP,t),this.top=t.top,this.left=t.left,null==(n=this.svgGroup)||n.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new pl(this.top,this.top+Kp+Wp,this.left,this.left+jp)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+Xp-Jp;return e=e.left+Yp-Jp,new pl(t,t+Wp+Kp+2*Jp,e,e+jp+2*Jp)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=eh;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*rh),t=th+this.lidOpen*(nh-th),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),Zp/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===Al.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let n;null==(n=this.svgLid)||n.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:jp-4)+","+(Wp-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*rh)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new($("trashcan_open"))(e,this.workspace.id),w(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(0>=this.workspace.options.maxTrashcanContents||e.type!==Po.DELETE$$module$build$src$core$events$utils||e.type!==Po.DELETE$$module$build$src$core$events$utils||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),-1===this.contents.indexOf(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(Qp)}}}cleanBlockJson(e){return function e(t){if(t){if(delete t.id,delete t.x,delete t.y,delete t.enabled,t.icons&&t.icons.comment){var n=t.icons.comment;delete n.height,delete n.width,delete n.pinned}for(var r in n=t.inputs){var i=n[r];const t=i.block;i=i.shadow,t&&e(t),i&&e(i)}t.next&&(t=(r=t.next).block,r=r.shadow,t&&e(t),r&&e(r))}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},jp=47,Kp=44,Wp=16,zp=20,qp=20,Jp=10,Yp=0,Xp=32,Qp=.1,Zp=80,eh=4,th=.4,nh=.8,rh=45,ih=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),(t=e.keyCodes)&&0<t.length)for(let n=0;n<t.length;n++)this.addKeyMapping(t[n],e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,n){e=`${e}`;const r=this.keyMap.get(e);if(r&&!n)throw Error(`Shortcut named "${t}" collides with shortcuts "${r}"`);r&&n?r.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,n){const r=this.keyMap.get(e);if(!r)return n||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const i=r.indexOf(t);return-1<i?(r.splice(i,1),0===r.length&&this.keyMap.delete(e),!0):(n||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,n]of this.keyMap)e[t]=n;return e}getRegistry(){const e=Object.create(null);for(const[t,n]of this.shortcuts)e[t]=n;return mi(Object.create(null),e)}onKeyDown(e,t){var n=this.serializeKeyEvent_(t);if(!(n=this.getShortcutNamesByKeyCode(n)))return!1;for(let r,i=0;r=n[i];i++){const n=this.shortcuts.get(r);let i,s;if(null==(i=n)||!i.preconditionFn||null!=(s=n)&&s.preconditionFn(e)){let r,i;if(null!=(r=n)&&r.callback&&null!=(i=n)&&i.callback(e,t,n))return!0}}return!1}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[n,r]of this.keyMap)-1<r.indexOf(e)&&t.push(n);return t}serializeKeyEvent_(e){let t="";for(const n in ih.modifierKeys)e.getModifierState(n)&&(""!==t&&(t+="+"),t+=n);return""!==t&&e.keyCode?t=t+"+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers_(e){for(let t,n=0;t=e[n];n++)if(!(t in ih.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let n="";if(t){this.checkModifiers_(t);for(const e in ih.modifierKeys)-1<t.indexOf(ih.modifierKeys[e])&&(""!==n&&(n+="+"),n+=e)}return""!==n&&e?n=n+"+"+e:e&&(n=`${e}`),n}};ih.registry=new ih,function(e){(e=e.modifierKeys||(e.modifierKeys={}))[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(ih||(ih={})),function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"}(Up||(Up={}));var sh=null,oh=null;js();var ah={};ah.names=Up,ah.registerCopy=Bs,ah.registerCut=Us,ah.registerDefaultShortcuts=js,ah.registerDelete=$s,ah.registerEscape=Fs,ah.registerPaste=Vs,ah.registerRedo=Gs,ah.registerUndo=Hs;var lh={ProcedureSerializer:class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map((e=>Ks(e)))).length?e:null}load(e,t){const n=t.getProcedureMap();for(const r of e)n.add(zs(this.procedureModelClass,this.parameterModelClass,r,t))}clear(e){e.getProcedureMap().clear()}}};lh.loadParameter=qs,lh.loadProcedure=zs,lh.saveParameter=Ws,lh.saveProcedure=Ks;var ch=class{constructor(){this.priority=100}save(e){const t=[];for(const n of e.getAllVariables())e={name:n.name,id:n.getId()},n.type&&(e.type=n.type),t.push(e);return t.length?t:null}load(e,t){for(const n of e)t.createVariable(n.name,n.type,n.id)}clear(e){e.getVariableMap().clear()}};rn("variables",new ch);var uh={};uh.VariableSerializer=ch;var dh={};dh.load=Ys,dh.save=Js;var ph={blocks:Ec,exceptions:vc,priorities:{BLOCKS:50,PROCEDURES:75,VARIABLES:100},procedures:lh,registry:Tc,variables:uh,workspaces:dh},hh=class{constructor(e,t,n,r,i){this.workspace=e,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,n=void 0===n||n;const s=(t=void 0===t||t)&&n;t&&(this.hScroll=new bl(e,!0,s,r,i)),n&&(this.vScroll=new bl(e,!1,s,r,i)),s&&(this.corner_=re(dl.RECT,{height:bl.scrollbarThickness,width:bl.scrollbarThickness,class:"blocklyScrollbarBackground"}),ce(this.corner_,e.getBubbleCanvas()))}dispose(){le(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,n=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===e.viewWidth&&this.oldHostMetrics_.viewHeight===e.viewHeight&&this.oldHostMetrics_.absoluteTop===e.absoluteTop&&this.oldHostMetrics_.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===e.scrollWidth&&this.oldHostMetrics_.viewLeft===e.viewLeft&&this.oldHostMetrics_.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===e.scrollHeight&&this.oldHostMetrics_.viewTop===e.viewTop&&this.oldHostMetrics_.scrollTop===e.scrollTop||(n=!0)):n=t=!0,t||n){try{Po.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&n&&this.vScroll.resize(e)}finally{Po.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==e.viewWidth||this.oldHostMetrics_.absoluteLeft!==e.absoluteLeft){let e;null==(e=this.corner_)||e.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==e.viewHeight||this.oldHostMetrics_.absoluteTop!==e.absoluteTop){let e;null==(e=this.corner_)||e.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,n){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(n||void 0===n)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},fh=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,n=0;return e&&(t=e.getWidth(),n=e.getHeight()),new hl(t,n)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const n=this.getToolboxMetrics(),r=this.getFlyoutMetrics(),i=!!this.workspace_.getToolbox();var s;const o=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=i?n.position:r.position)===Al.TOP;return s===Al.LEFT&&(i&&(e+=n.width),o&&(e+=r.width)),a&&(i&&(t+=n.height),o&&(t+=r.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),n=this.getToolboxMetrics(),r=this.getFlyoutMetrics(),i=!!this.workspace_.getToolbox();var s;const o=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),a=(s=i?n.position:r.position)===Al.LEFT||s===Al.RIGHT;return s!==Al.TOP&&s!==Al.BOTTOM||(i&&(t.height-=n.height),o&&(t.height-=r.height)),a&&(i&&(t.width-=n.width),o&&(t.width-=r.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),n=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const r={};return n||(r.top=e.top,r.bottom=e.top+e.height),t||(r.left=e.left,r.right=e.left+e.width),r}getPaddedContent_(e,t){const n=t.top+t.height,r=t.left+t.width,i=e.width,s=i/2,o=(e=e.height)/2;return{top:Math.min(t.top-o,n-e),bottom:Math.max(n+o,t.top+e),left:Math.min(t.left-s,r-i),right:Math.max(r+s,t.left+i)}}getScrollMetrics(e,t,n){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var r=n||this.getContentMetrics();n=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,r),r=void 0!==n.top?n.top:t.top;const i=void 0!==n.left?n.left:t.left;return{top:r/e,left:i/e,width:((void 0!==n.right?n.right:t.right)-i)/e,height:((void 0!==n.bottom?n.bottom:t.bottom)-r)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),n=this.getSvgMetrics(),r=this.getAbsoluteMetrics(),i=this.getViewMetrics(),s=this.getContentMetrics(),o=this.getScrollMetrics(!1,i,s);return{contentHeight:s.height,contentWidth:s.width,contentTop:s.top,contentLeft:s.left,scrollHeight:o.height,scrollWidth:o.width,scrollTop:o.top,scrollLeft:o.left,viewHeight:i.height,viewWidth:i.width,viewTop:i.top,viewLeft:i.left,absoluteTop:r.top,absoluteLeft:r.left,svgHeight:n.height,svgWidth:n.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};t(Uo.METRICS_MANAGER,Bo,fh);var mh=class extends ga{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=aa,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};t(Uo.EVENT,aa,mh);var _h=class extends ya{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type="drag",e&&(this.blockId=e.id,this.isStart=t,this.blocks=n)}toJson(){const e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new _h)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};t(Uo.EVENT,"drag",_h);var gh={};gh.bumpIntoBounds=Xs,gh.bumpIntoBoundsHandler=Qs,gh.bumpTopObjectsIntoBounds=eo;var yh=class{constructor(e,t){this.connectionCandidate=this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.dragIconData_=[],this.draggingBlock_=e,this.workspace_=t,this.connectionPreviewer=new(c(Uo.CONNECTION_PREVIEWER,this.workspace_.options))(e),this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=to(e,this.startXY_)}dispose(){this.dragIconData_.length=0,this.connectionPreviewer.dispose()}startDrag(e,t){let n;Po.getGroup$$module$build$src$core$events$utils()||Po.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent_(),this.draggingBlock_.bringToFront(!0),pe(),this.workspace_.setResizesEnabled(!1),Ur(),this.shouldDisconnect_(t)&&this.disconnectBlock_(t,e),this.draggingBlock_.setDragging(!0),null==(n=this.workspace_.getLayerManager())||n.moveToDragLayer(this.draggingBlock_)}shouldDisconnect_(e){return!!(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(e,t){this.draggingBlock_.unplug(e),e=this.pixelsToWorkspaceUnits_(t),e=el.sum(this.startXY_,e),this.draggingBlock_.translate(e.x,e.y),$r(this.draggingBlock_)}fireDragStartEvent_(){const e=new($("drag"))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));w(e)}drag(e,t){const n=this.draggingBlock_;this.moveBlock(n,t),this.updateDragTargets(e,n),this.wouldDeleteBlock_=this.wouldDeleteBlock(e,n,t),this.updateCursorDuringBlockDrag_(),this.updateConnectionPreview(n,t)}moveBlock(e,t){t=this.pixelsToWorkspaceUnits_(t),t=el.sum(this.startXY_,t),e.moveDuringDrag(t)}updateDragTargets(e,t){if(e=this.workspace_.getDragTarget(e),this.dragTarget_!==e){let n;null==(n=this.dragTarget_)||n.onDragExit(t),null==e||e.onDragEnter(t)}null==e||e.onDragOver(t),this.dragTarget_=e}wouldDeleteBlock(e,t,n){return!(!(e=this.workspace_.getDragTarget(e))||!this.workspace_.getComponentManager().hasCapability(e.id,Ya.Capability.DELETE_AREA))&&e.wouldDelete(t,!!this.getConnectionCandidate(t,n))}updateConnectionPreview(e,t){const n=this.connectionCandidate,r=this.getConnectionCandidate(e,t);if(r){this.connectionCandidate=t=n&&this.currCandidateIsBetter(n,t,r)?n:r;var{local:i,neighbour:s}=t;i.type!==Ac.OUTPUT_VALUE&&i.type!==Ac.PREVIOUS_STATEMENT||!s.isConnected()||s.targetBlock().isInsertionMarker()||this.orphanCanConnectAtEnd(e,s.targetBlock(),i.type)?this.connectionPreviewer.previewConnection(i,s):this.connectionPreviewer.previewReplacement(i,s,s.targetBlock())}else this.connectionPreviewer.hidePreview(),this.connectionCandidate=null}orphanCanConnectAtEnd(e,t,n){return!!hp.getConnectionForOrphanedConnection(e,n===Ac.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,n){const{local:r,neighbour:i}=e;e=new el(r.x,r.y);const s=new el(i.x,i.y);return t=el.distance(el.sum(e,t),s),n.distance>t-Po.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let n=Po.config$$module$build$src$core$config.snapRadius,r=null;for(const i of e){const{connection:e,radius:s}=i.closest(n,t);e&&(r={local:i,neighbour:e,distance:s},n=s)}return r}getLocalConnections(e){const t=e.getConnections_(!1),n=e.lastConnectionInStack(!0);return n&&n!==e.nextConnection&&t.push(n),t}endDrag(e,t){if(this.drag(e,t),this.fireDragEndEvent_(),he(),Ur(),this.connectionPreviewer.hidePreview(),e=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)||(e=this.getNewLocationAfterDrag_(t).delta),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),!this.maybeDeleteBlock_()){let t;null==(t=this.workspace_.getLayerManager())||t.moveOffDragLayer(this.draggingBlock_,50),this.draggingBlock_.setDragging(!1),e?this.updateBlockAfterMove_():Xs(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)}this.connectionPreviewer.dispose(),this.workspace_.setResizesEnabled(!0),Po.setGroup$$module$build$src$core$events$utils(!1)}getNewLocationAfterDrag_(e){return{delta:e=this.pixelsToWorkspaceUnits_(e),newLocation:el.sum(this.startXY_,e)}}maybeDeleteBlock_(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),zo.length=0,!0)}updateBlockAfterMove_(){this.fireMoveEvent_(),this.connectionCandidate?this.applyConnections(this.connectionCandidate):this.draggingBlock_.queueRender(),this.draggingBlock_.scheduleSnapAndBump()}applyConnections(e){const{local:t,neighbour:n}=e;if(t.connect(n),this.draggingBlock_.rendered){const e=t.isSuperior()?n:t,r=this.draggingBlock_.getRootBlock();Et().then((()=>{Fr(e.getSourceBlock()),setTimeout((()=>{r.bringToFront()}),0)}))}}fireDragEndEvent_(){const e=new($("drag"))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));w(e)}updateToolboxStyle_(e){const t=this.workspace_.getToolbox();if(t){const n=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";e&&"function"==typeof t.removeStyle?t.removeStyle(n):e||"function"!=typeof t.addStyle||t.addStyle(n)}}fireMoveEvent_(){if(!this.draggingBlock_.isDeadOrDying()){var e=new($(Po.MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);e.setReason(["drag"]),e.oldCoordinate=this.startXY_,e.recordNew(),w(e)}}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(e){return e=new el(e.x/this.workspace_.scale,e.y/this.workspace_.scale),this.workspace_.isMutator&&e.scale(1/this.workspace_.options.parentWorkspace.scale),e}dragIcons_(){ne("Blockly.BlockDragger.prototype.dragIcons_","v10","v11")}getInsertionMarkers(){return this.workspace_.getAllBlocks().filter((e=>e.isInsertionMarker()))}};t(Uo.BLOCK_DRAGGER,Bo,yh);var bh={};bh.Bubble=md,bh.MiniWorkspaceBubble=_d,bh.TextBubble=xd,bh.TextInputBubble=Sd;var vh=class extends xc{constructor(e,t,n,r){super(e),this.type=Zo,this.recordUndo=!1,e&&(this.name=t,this.oldValue=n,this.newValue=r)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new vh)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};t(Uo.EVENT,Zo,vh);var Th=class extends xc{constructor(e){super(e),this.type=Po.MOVE$$module$build$src$core$events$utils,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation_(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Th)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(n=e.oldCoordinate.split(","),t.oldCoordinate=new el(Number(n[0]),Number(n[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(n=e.newCoordinate.split(","),t.newCoordinate=new el(Number(n[0]),Number(n[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation_();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation_(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const n=t.getParent();return n?(e.parentId=n.id,(t=n.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&el.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var n=t.getBlockById(this.blockId);if(n){var r=e?this.newParentId:this.oldParentId,i=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,r){var s=t.getBlockById(r);if(!s)return void console.warn("Can't connect to non-existent block: "+r)}if(n.getParent()&&n.unplug(),e)i=n.getRelativeToSurfaceXY(),n.moveBy(e.x-i.x,e.y-i.y,this.reason);else{let e,r;(!(t=n.outputConnection)||n.previousConnection&&n.previousConnection.isConnected())&&(t=n.previousConnection),n=null==(r=t)?void 0:r.type,i?(n=s.getInput(i))&&(e=n.connection):n===Ac.PREVIOUS_STATEMENT&&(e=s.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+i)}}else console.warn("Can't move non-existent block: "+this.blockId)}};t(Uo.EVENT,Po.MOVE$$module$build$src$core$events$utils,Th);var kh,Eh=class extends ya{constructor(e,t,n){super(e?e.workspace.id:void 0),this.type=ra,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=n)}toJson(){const e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Eh)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};!function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"}(kh||(kh={})),t(Uo.EVENT,ra,Eh);var xh={};xh.BubbleOpen=Eh,xh.BubbleType=kh;var Sh=class extends ga{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=Po.getGroup$$module$build$src$core$events$utils(),this.recordUndo=A())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Sh)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var n=e.getEventWorkspace_();if(t){if(t=Po.createElement$$module$build$src$core$utils$xml("xml"),!e.xml)throw Error("Ecountered a comment event without proper xml");t.appendChild(e.xml),Po.domToWorkspace$$module$build$src$core$xml(t,n)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(n=n.getCommentById(e.commentId))?n.dispose():console.warn("Can't uncreate non-existent comment: "+e.commentId)}}},Ch=class extends Sh{constructor(e,t,n){super(e),this.type="comment_change",e&&(this.oldContents_=void 0===t?"":t,this.newContents_=void 0===n?"":n)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ch)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var n=e?this.newContents_:this.oldContents_;if(!n){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setContent(n)}else console.warn("Can't change non-existent comment: "+this.commentId)}};t(Uo.EVENT,"comment_change",Ch);var Ih=class extends Sh{constructor(e){super(e),this.type=sa,e&&(this.xml=e.toXmlWithXY())}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=$t(this.xml),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ih)).xml=Po.textToDom$$module$build$src$core$utils$xml(e.xml),t}run(e){Sh.CommentCreateDeleteHelper(this,e)}};t(Uo.EVENT,sa,Ih);var Ah=class extends Sh{constructor(e){super(e),this.type="comment_delete",e&&(this.xml=e.toXmlWithXY())}run(e){Sh.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return e.xml=$t(this.xml),e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Ah)).xml=Po.textToDom$$module$build$src$core$utils$xml(e.xml),t}};t(Uo.EVENT,"comment_delete",Ah);var wh=class extends Sh{constructor(e){super(e),this.type=oa,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,n){return t=super.fromJson(e,t,null!=n?n:new wh),n=e.oldCoordinate.split(","),t.oldCoordinate_=new el(Number(n[0]),Number(n[1])),n=e.newCoordinate.split(","),t.newCoordinate_=new el(Number(n[0]),Number(n[1])),t}isNull(){return el.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var n=t.getRelativeToSurfaceXY();t.moveBy(e.x-n.x,e.y-n.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};t(Uo.EVENT,oa,wh);var Nh=class extends ya{constructor(e,t,n){super(n),this.type="toolbox_item_select",this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,n){return(t=super.fromJson(e,t,null!=n?n:new Nh)).oldItem=e.oldItem,t.newItem=e.newItem,t}};t(Uo.EVENT,"toolbox_item_select",Nh),Po.CHANGE$$module$build$src$core$events$utils,Po.CREATE$$module$build$src$core$events$utils,Po.DELETE$$module$build$src$core$events$utils,Po.MOVE$$module$build$src$core$events$utils,Po.CHANGE$$module$build$src$core$events$utils,Po.CREATE$$module$build$src$core$events$utils,Po.DELETE$$module$build$src$core$events$utils,Po.MOVE$$module$build$src$core$events$utils,Po.disable$$module$build$src$core$events$utils,Po.enable$$module$build$src$core$events$utils,Po.getGroup$$module$build$src$core$events$utils,Po.setGroup$$module$build$src$core$events$utils;var Dh={};Dh.Abstract=ga,Dh.BLOCK_CHANGE=Po.CHANGE$$module$build$src$core$events$utils,Dh.BLOCK_CREATE=Po.CREATE$$module$build$src$core$events$utils,Dh.BLOCK_DELETE=Po.DELETE$$module$build$src$core$events$utils,Dh.BLOCK_DRAG="drag",Dh.BLOCK_FIELD_INTERMEDIATE_CHANGE=Zo,Dh.BLOCK_MOVE=Po.MOVE$$module$build$src$core$events$utils,Dh.BUBBLE_OPEN=ra,Dh.BUMP_EVENTS=la,Dh.BlockBase=xc,Dh.BlockChange=Zu,Dh.BlockCreate=Sc,Dh.BlockDelete=Np,Dh.BlockDrag=_h,Dh.BlockFieldIntermediateChange=vh,Dh.BlockMove=Th,Dh.BubbleOpen=Eh,Dh.BubbleType=kh,Dh.CHANGE=Po.CHANGE$$module$build$src$core$events$utils,Dh.CLICK=na,Dh.COMMENT_CHANGE="comment_change",Dh.COMMENT_CREATE=sa,Dh.COMMENT_DELETE="comment_delete",Dh.COMMENT_MOVE=oa,Dh.CREATE=Po.CREATE$$module$build$src$core$events$utils,Dh.Click=ba,Dh.ClickTarget=ma,Dh.CommentBase=Sh,Dh.CommentChange=Ch,Dh.CommentCreate=Ih,Dh.CommentDelete=Ah,Dh.CommentMove=wh,Dh.DELETE=Po.DELETE$$module$build$src$core$events$utils,Dh.FINISHED_LOADING=aa,Dh.FinishedLoading=mh,Dh.MARKER_MOVE="marker_move",Dh.MOVE=Po.MOVE$$module$build$src$core$events$utils,Dh.MarkerMove=up,Dh.SELECTED="selected",Dh.Selected=rc,Dh.THEME_CHANGE="theme_change",Dh.TOOLBOX_ITEM_SELECT="toolbox_item_select",Dh.TRASHCAN_OPEN="trashcan_open",Dh.ThemeChange=Ic,Dh.ToolboxItemSelect=Nh,Dh.TrashcanOpen=wp,Dh.UI=ta,Dh.UiBase=ya,Dh.VAR_CREATE=ea,Dh.VAR_DELETE="var_delete",Dh.VAR_RENAME="var_rename",Dh.VIEWPORT_CHANGE=ia,Dh.VarBase=Yl,Dh.VarCreate=Xl,Dh.VarDelete=kp,Dh.VarRename=Ep,Dh.ViewportChange=wc,Dh.clearPendingUndo=R,Dh.disable=Po.disable$$module$build$src$core$events$utils,Dh.disableOrphans=B,Dh.enable=Po.enable$$module$build$src$core$events$utils,Dh.filter=O,Dh.fire=w,Dh.fromJson=F,Dh.get=$,Dh.getDescendantIds=M,Dh.getGroup=Po.getGroup$$module$build$src$core$events$utils,Dh.getRecordUndo=A,Dh.isEnabled=L,Dh.setGroup=Po.setGroup$$module$build$src$core$events$utils,Dh.setRecordUndo=I;var Oh=class extends ep{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&le(this.selectedGlowFilter),this.replacementGlowFilter&&le(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:e,width:t,path:ts("c",[es(25,-e),es(71,-e),es(t,0)])}}makeHexagonal(){function e(e,n,r){var i=e/2;return is(-(r=r?-1:1)*(i=i>t?t:i),e=(n?-1:1)*e/2)+is(r*i,e)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeRounded(){function e(e,t,r){const i=e>n?e-n:0,s=r===t?"0":"1";return as("a","0 0,"+s,e=(e>n?n:e)/2,es((r?1:-1)*e,(t?-1:1)*e))+os("v",(t?-1:1)*i)+as("a","0 0,"+s,e,es((r?-1:1)*e,(t?-1:1)*e))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,n=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeSquared(){function e(e,n,r){e-=2*t;const i=r===n?"0":"1";return as("a","0 0,"+i,t,es((r?1:-1)*t,(n?-1:1)*t))+os("v",(n?-1:1)*e)+as("a","0 0,"+i,t,es((r?-1:1)*t,(n?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:e=>t,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Ac.INPUT_VALUE:case Ac.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&-1!==t.indexOf("Boolean")?this.HEXAGONAL:(t&&-1!==t.indexOf("Number")||t&&t.indexOf("String"),this.ROUNDED);case Ac.PREVIOUS_STATEMENT:case Ac.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return ts("c",[es(e*i/2,0),es(e*i*3/4,o/2),es(e*i,o)])+ss([es(e*i,s)])+ts("c",[es(e*i/4,o/2),es(e*i/2,o),es(e*i,o)])+os("h",e*r)+ts("c",[es(e*i/2,0),es(e*i*3/4,-o/2),es(e*i,-o)])+ss([es(e*i,-s)])+ts("c",[es(e*i/4,-o/2),es(e*i/2,-o),es(e*i,-o)])}const t=this.NOTCH_WIDTH,n=this.NOTCH_HEIGHT,r=t/3,i=r/3,s=n/2,o=s/2,a=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:n,pathLeft:a,pathRight:l}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=as("a","0 0,0",e,es(-e,e)),n=as("a","0 0,1",e,es(-e,e));return{width:e,height:e,pathTop:t,pathBottom:as("a","0 0,0",e,es(e,e)),rightWidth:e,rightHeight:e,pathTopRight:n,pathBottomRight:as("a","0 0,1",e,es(e,e))}}generateSecondaryColour_(e){return Si("#000",e,.15)||e}generateTertiaryColour_(e){return Si("#000",e,.25)||e}createDom(e,t,n){super.createDom(e,t,n),e=re(dl.DEFS,{},e),t=re(dl.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),re(dl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),n=re(dl.FECOMPONENTTRANSFER,{result:"outBlur"},t),re(dl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),re(dl.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),re(dl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=re(dl.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),re(dl.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=re(dl.FECOMPONENTTRANSFER,{result:"outBlur"},e),re(dl.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),re(dl.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),re(dl.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),re(dl.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text,`,`${e} .blocklyNonEditableText>g>text,`,`${e} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .goog-menuitem,`,`${e}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Rh=class extends np{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height)){if(Od.isSpacer(e)){const r=e.precedesStatement;var t=e.followsStatement;if(r||t){const i=this.constants_.INSIDE_CORNERS;var n=i.rightHeight;return n=e.height-(r?n:0),t=t?i.pathBottomRight:"",e=0<n?os("V",e.yPos+n):"",void(this.outlinePath_+=t+e+(r?i.pathTopRight:""))}}this.outlinePath_+=os("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=rs(e.xPos,this.info_.startY),this.outlinePath_+=os("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=os("V",e.baseline),this.outlinePath_+=os("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=ns(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-2*e.connectionWidth,n=e.height;return os("h",t)+e.shape.pathRightDown(n)+os("h",-t)+e.shape.pathUp(n)+"z"}drawStatementInput_(e){var t=e.getLastInput();const n=t.xPos+t.notchOffset+t.shape.width,r=this.constants_.INSIDE_CORNERS,i=t.shape.pathRight+os("h",-(t.notchOffset-r.width))+r.pathTop,s=e.height-2*r.height;t=r.pathBottom+os("h",t.notchOffset-r.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=os("H",n)+i+os("v",s)+t+os("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===Ac.NEXT_STATEMENT||t.type===Ac.PREVIOUS_STATEMENT||t.type===Ac.OUTPUT_VALUE&&!e.isDynamicShape)super.drawConnectionHighlightPath(e);else{e=t.type===Ac.INPUT_VALUE?ns(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):ns(e.width,-e.height/2)+e.shape.pathDown(e.height);var n,r,i=t.getSourceBlock();null==(r=(n=i.pathObject).addConnectionHighlight)||r.call(n,t,e,t.getOffsetInBlock(),i.RTL)}}},Lh=class extends sd{constructor(e,t,n,r,i,s,o){if(super(sd.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",n=Number(wi(n)),t=Number(wi(t)),isNaN(n)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=n||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new hl(t,n+Lh.Y_PADDING),this.imageHeight=n,"function"==typeof i&&(this.clickHandler=i),e!==sd.SKIP_SETUP&&(o?this.configure_(o):(this.flipRtl=!!s,this.altText=wi(r)||""),this.setValue(wi(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=wi(e.alt))}initView(){this.imageElement=re(dl.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(ol,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(ol,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};Lh.Y_PADDING=1,Li("field_image",Lh),Lh.prototype.DEFAULT_VALUE="";var Ph=class extends sd{constructor(e,t,n){super(sd.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",e!==sd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new od;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new od;let t;return this.fullBlockClickTarget_=!(null==(t=this.getConstants())||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&L()&&w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new od;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.style.colourTertiary)):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(oe(e,"blocklyInvalidInput"),$n(e,$c.INVALID,!1)):(ie(e,"blocklyInvalidInput"),$n(e,$c.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new od;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(Ga||Ba||Ua)?this.showPromptEditor_():this.showInlineEditor_(t)}showPromptEditor_(){et(Po.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),(e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)}))}showInlineEditor_(e){const t=this.getSourceBlock();if(!t)throw new od;Hn(this,t.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new od;Po.setGroup$$module$build$src$core$events$utils(!0);const t=Bn();var n=this.getClickTarget_();if(!n)throw Error("A click target has not been set.");ie(n,"editing"),(n=document.createElement("input")).className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);const r=this.workspace_.getScale();var i=this.getConstants().FIELD_TEXT_FONTSIZE*r+"pt";return t.style.fontSize=i,n.style.fontSize=i,i=Ph.BORDERRADIUS*r+"px",this.isFullBlockField()&&(i=((i=this.getScaledBBox()).bottom-i.top)/2+"px",e=e.getParent()?e.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,n.style.border=1*r+"px solid "+e,t.style.borderRadius=i,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*r+"px")),n.style.borderRadius=i,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(n),n}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&L()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(w(new($(Po.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),Po.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=Bn().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");oe(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper_=W(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=W(e,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(q(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(q(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(e){"Enter"===e.key?(Gn(),Or()):"Escape"===e.key?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),Gn(),Or()):"Tab"===e.key&&(Gn(),Or(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange_(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&L()&&this.value_!==e&&w(new($(Zo))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){var e=this.getSourceBlock();if(!e)throw new od;const t=Bn(),n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px",e=new el(e.RTL?n.right-t.offsetWidth:n.left,n.top),t.style.left=e.x+"px",t.style.top=e.y+"px"}repositionForWindowResize(){const e=this.getSourceBlock();return e instanceof Bp&&(Xs(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),e)||this.resizeEditor_(),!0)}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};Ph.BORDERRADIUS=4;var Mh=class extends Ph{constructor(e,t,n){super(e,t,n)}doClassValidation_(e){return void 0===e?null:`${e}`}static fromJson(e){return new this(wi(e.text),void 0,e)}};Li("field_input",Mh),Mh.prototype.DEFAULT_VALUE="";var Fh=class extends Pd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},$h=class extends jd{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},Bh=class extends Rd{constructor(e){super(e),this.width=this.height=0,this.type|=Od.getType("RIGHT_CONNECTION")}},Uh=class extends Zd{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},Vh=class extends lp{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new Uh(this.constants_),this.bottomRow=new Fh(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new Bh(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof op||e instanceof ap||t instanceof ap||(e instanceof Po.ValueInput$$module$build$src$core$inputs$value_input||e instanceof sp||e instanceof op)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&Od.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&Od.isLeftRoundedCorner(e)&&t&&(Od.isPreviousConnection(t)||Od.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&Od.isLeftSquareCorner(e)&&t&&Od.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(Od.isTopRow(e)&&Od.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const n=Od.isInputRow(e)&&e.hasStatement,r=Od.isInputRow(t)&&t.hasStatement;return r||n?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),r&&n?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):Od.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Od.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const n=this.width-this.startX;return Od.isInputRow(e)&&e.hasStatement||Od.isInputRow(t)&&t.hasStatement?Math.max(n,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):n}getElemCenterline_(e,t){if(e.hasStatement&&!Od.isSpacer(t)&&!Od.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(Od.isInlineInput(t)&&t instanceof Fd){const n=t.connectedBlock;if(n&&n.outputConnection&&n.nextConnection)return e.yPos+n.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof sp||e instanceof op)&&t.hasDummyInput&&t.align===Po.Align$$module$build$src$core$inputs$align.LEFT&&e.align===Po.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof ap)return t.elements.push(new $h(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let n;for(let t=0;t<e.elements.length;t++){const r=e.elements[t];if(Od.isSpacer(r)&&(n=r),Od.isField(r)&&r instanceof Bd&&r.parentInput===this.rightAlignedDummyInputs.get(e))break}if(n)return n.width+=t,void(e.width+=t)}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let i=2;i<this.rows.length-1;i+=2){var n=this.rows[i-1];const s=this.rows[i];var r=this.rows[i+1];if(n=2===i?!!this.topRow.hasPreviousConnection:!!n.followsStatement,r=i+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement,Od.isInputRow(s)&&s.hasStatement){let n,r;s.measure(),t=s.width-(null!=(r=null==(n=s.getLastInput())?void 0:n.width)?r:0)+e}else if(n&&(2===i||r)&&Od.isInputRow(s)&&!s.hasStatement){r=s.xPos,n=null;for(let e=0;e<s.elements.length;e++){const i=s.elements[e];Od.isSpacer(i)&&(n=i),n&&(Od.isField(i)||Od.isInput(i))&&r<t&&!(Od.isField(i)&&i instanceof Bd&&(i.field instanceof rp||i.field instanceof Lh))&&(n.width+=t-r),r+=i.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,n=0;n<this.rows.length;n++){const e=this.rows[n];e.yPos=t,t+=e.height}this.height=t,n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(n),n=e.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(n),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=n,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=n,this.width+=n+e,this.widthWithChildren+=n+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var n=this.rows[t];if(!Od.isInputRow(n))continue;e=n.elements[n.elements.length-2];let r=this.getNegativeSpacing_(n.elements[1]),i=this.getNegativeSpacing_(e);e=r+i;const s=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<s&&(r=(e=this.width-s)/2,i=e/2),n.elements.unshift(new Hd(this.constants_,-r)),n.elements.push(new Hd(this.constants_,-i))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)n=this.rows[t],Od.isTopOrBottomRow(n)&&(n.elements[1].width-=e),n.width-=e,n.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var n=this.outputConnection.shape.type;const r=this.constants_;if(1<this.inputRows.length)switch(n){case r.SHAPES.ROUND:return n=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(n=this.height/2>n?n:this.height/2)*(1-Math.sin(Math.acos((n-this.constants_.SMALL_PADDING)/n)));default:return 0}if(Od.isInlineInput(e)&&e instanceof Fd){const i=e.connectedBlock;return null==(e=i?i.pathObject.outputShapeType:e.shape.type)||i&&i.outputConnection&&(i.statementInputCount||i.nextConnection)||n===r.SHAPES.HEXAGONAL&&n!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][e]}return Od.isField(e)&&e instanceof Bd?n===r.SHAPES.ROUND&&e.field instanceof Mh?t-2.75*r.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[n][0]:Od.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let r=2;r<this.rows.length-1;r+=2){const i=this.rows[r-1],s=this.rows[r],o=this.rows[r+1];var e=2===r,t=r+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!o.precedesStatement;if(e?this.topRow.hasPreviousConnection:i.followsStatement){var n=s.elements[1];if(n=3===s.elements.length&&n instanceof Bd&&(n.field instanceof rp||n.field instanceof Lh),!e&&n)i.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING,s.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(e=!1,t=0;t<s.elements.length;t++)if((n=s.elements[t])instanceof Fd&&Od.isInlineInput(n)&&n.connectedBlock&&!n.connectedBlock.isShadow()&&40<=n.connectedBlock.getHeightWidth().height){e=!0;break}e&&(i.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING)}}else i.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},Hh=class extends dp{constructor(e,t,n){super(e,t,n),this.markerCircle=null}showWithInputOutput(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput(e)}showWithInput_(e){this.showWithInputOutput(e)}showWithBlock_(e){const t=(e=e.getLocation()).getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle(e,t){let n,r;null==(n=this.markerCircle)||n.setAttribute("cx",`${e}`),null==(r=this.markerCircle)||r.setAttribute("cy",`${t}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=re(dl.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();re(dl.ANIMATE,e,this.markerCircle)}return this.markerSvg_}applyColour_(e){let t,n;if(super.applyColour_(e),null==(t=this.markerCircle)||t.setAttribute("fill",this.colour_),null==(n=this.markerCircle)||n.setAttribute("stroke",this.colour_),this.isCursor()){let t;e=this.colour_+";transparent;transparent;",null==(t=this.markerCircle)||t.firstElementChild.setAttribute("values",e)}}},Gh=class extends pp{constructor(e,t,n){super(e,t,n),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=n}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.style.colourTertiary);for(const e of this.outlines.values())e.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,re(dl.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,n;null==(t=this.outlines.get(e))||null==(n=t.parentNode)||n.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},jh=class extends gp{constructor(e){super(e)}makeConstants_(){return new Oh}makeRenderInfo_(e){return new Vh(this,e)}makeDrawer_(e,t){return new Rh(e,t)}makeMarkerDrawer(e,t){return new Hh(e,this.getConstants(),t)}makePathObject(e,t){return new Gh(e,t,this.getConstants())}getConstants(){return this.constants_}getConnectionPreviewMethod(e,t,n){return ne("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),t.type===Ac.OUTPUT_VALUE?e.isConnected()?fp.PREVIEW_TYPE.REPLACEMENT_FADE:fp.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,n)}};Is("zelos",jh);var Kh={};Kh.BottomRow=Fh,Kh.ConstantProvider=Oh,Kh.Drawer=Rh,Kh.MarkerSvg=Hh,Kh.PathObject=Gh,Kh.RenderInfo=Vh,Kh.Renderer=jh,Kh.RightConnectionShape=Bh,Kh.StatementInput=$h,Kh.TopRow=Uh,ko();var Wh={};Wh.registerCleanup=io,Wh.registerCollapse=oo,Wh.registerCollapseExpandBlock=go,Wh.registerComment=mo,Wh.registerDefaultOptions=ko,Wh.registerDelete=bo,Wh.registerDeleteAll=po,Wh.registerDisable=yo,Wh.registerDuplicate=fo,Wh.registerExpand=ao,Wh.registerHelp=vo,Wh.registerInline=_o,Wh.registerRedo=ro,Wh.registerUndo=no;var zh,qh=class extends Ph{constructor(e,t,n){super(sd.SKIP_SETUP),this.clockwise=qh.CLOCKWISE,this.offset=qh.OFFSET,this.wrap=qh.WRAP,this.round=qh.ROUND,this.boundEvents=[],this.symbol_=this.gauge=this.line=null,e!==sd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){switch(super.configure_(e),e.mode){case zh.COMPASS:this.clockwise=!0,this.offset=90;break;case zh.PROTRACTOR:this.clockwise=!1,this.offset=0}e.clockwise&&(this.clockwise=e.clockwise),e.offset&&(this.offset=e.offset),e.wrap&&(this.wrap=e.wrap),e.round&&(this.round=e.round)}initView(){super.initView(),this.symbol_=re(dl.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph()}showEditor_(e){super.showEditor_(e,Ga||Ba||Ua),e=this.dropdownCreate(),_r().appendChild(e),this.sourceBlock_ instanceof Bp&&yr(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),vr(this,this.dropdownDispose.bind(this)),this.updateGraph()}dropdownCreate(){const e=re(dl.SVG,{xmlns:il,"xmlns:html":sl,"xmlns:xlink":ol,version:"1.1",height:2*qh.HALF+"px",width:2*qh.HALF+"px"});e.style.touchAction="none";const t=re(dl.CIRCLE,{cx:qh.HALF,cy:qh.HALF,r:qh.RADIUS,class:"blocklyAngleCircle"},e);this.gauge=re(dl.PATH,{class:"blocklyAngleGauge"},e),this.line=re(dl.LINE,{x1:qh.HALF,y1:qh.HALF,class:"blocklyAngleLine"},e);for(let t=0;360>t;t+=15)re(dl.LINE,{x1:qh.HALF+qh.RADIUS,y1:qh.HALF,x2:qh.HALF+qh.RADIUS-(0==t%45?10:5),y2:qh.HALF,class:"blocklyAngleMarks",transform:"rotate("+t+","+qh.HALF+","+qh.HALF+")"},e);return this.boundEvents.push(W(e,"click",this,this.hide)),this.boundEvents.push(W(t,"pointerdown",this,this.onMouseMove_,!0)),this.boundEvents.push(W(t,"pointermove",this,this.onMouseMove_,!0)),e}dropdownDispose(){for(const e of this.boundEvents)q(e);this.boundEvents.length=0,this.line=this.gauge=null}hide(){Nr(this),Gn()}onMouseMove_(e){var t=this.gauge.ownerSVGElement.getBoundingClientRect();const n=e.clientX-t.left-qh.HALF;e=e.clientY-t.top-qh.HALF,t=Math.atan(-e/n),isNaN(t)||(t=dr(t),0>n?t+=180:0<e&&(t+=360),t=this.clockwise?this.offset+360-t:360-(this.offset-t),this.displayMouseOrKeyboardValue(t))}displayMouseOrKeyboardValue(e){if(this.round&&(e=Math.round(e/this.round)*this.round),(e=this.wrapValue(e))!==this.value_){const t=this.value_;this.setEditorValue_(e,!1),this.sourceBlock_&&L()&&this.value_!==t&&w(new($(Zo))(this.sourceBlock_,this.name||null,t,this.value_))}}updateGraph(){if(this.gauge&&this.line){var e=Number(this.getText())+this.offset,t=ur(e%360);e=["M ",qh.HALF,",",qh.HALF];var n=qh.HALF,r=qh.HALF;if(!isNaN(t)){const i=Number(this.clockwise),s=ur(this.offset),o=Math.cos(s)*qh.RADIUS,a=Math.sin(s)*-qh.RADIUS;i&&(t=2*s-t),n+=Math.cos(t)*qh.RADIUS,r-=Math.sin(t)*qh.RADIUS,t=Math.abs(Math.floor((t-s)/Math.PI)%2),i&&(t=1-t),e.push(" l ",o,",",a," A ",qh.RADIUS,",",qh.RADIUS," 0 ",t," ",i," ",n,",",r," z")}this.gauge.setAttribute("d",e.join("")),this.line.setAttribute("x2",`${n}`),this.line.setAttribute("y2",`${r}`)}}onHtmlInputKeyDown_(e){super.onHtmlInputKeyDown_(e);var t=this.getSourceBlock();if(!t)throw new od;let n=0;switch(e.key){case"ArrowLeft":n=t.RTL?1:-1;break;case"ArrowRight":n=t.RTL?-1:1;break;case"ArrowDown":n=-1;break;case"ArrowUp":n=1}n&&(t=this.getValue(),this.displayMouseOrKeyboardValue(t+n*this.round),e.preventDefault(),e.stopPropagation())}doClassValidation_(e){return e=Number(e),isNaN(e)||!isFinite(e)?null:this.wrapValue(e)}wrapValue(e){return 0>(e%=360)&&(e+=360),e>this.wrap&&(e-=360),e}static fromJson(e){return new this(e.angle,void 0,e)}};qh.HALF=50,qh.RADIUS=qh.HALF-1,qh.CLOCKWISE=!1,qh.OFFSET=0,qh.WRAP=360,qh.ROUND=15,Li("field_angle",qh),qh.prototype.DEFAULT_VALUE=0,ee("\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: 0.8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: 0.8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n"),function(e){e.COMPASS="compass",e.PROTRACTOR="protractor"}(zh||(zh={}));var Jh={};Jh.FieldAngle=qh,Jh.Mode=zh;var Yh=class extends sd{constructor(e,t,n){super(sd.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=Yh.CHECK_CHAR,e!==sd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(Yh);return null!==e?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();ie(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||Yh.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool_(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};Yh.CHECK_CHAR="",Li("field_checkbox",Yh),Yh.prototype.DEFAULT_VALUE=!1;var Xh=class extends sd{constructor(e,t,n){super(sd.SKIP_SETUP),this.highlightedIndex=this.picker=null,this.boundEvents=[],this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.titles=this.colours=null,this.columns=0,e!==sd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.colourOptions&&(this.colours=e.colourOptions),e.colourTitles&&(this.titles=e.colourTitles),e.columns&&(this.columns=e.columns)}initView(){this.size_=new hl(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new od;const t=this.getConstants();return e.isSimpleReporter()&&!(null==t||!t.FIELD_COLOUR_FULL_BLOCK)}applyColour(){const e=this.getSourceBlock();if(!e)throw new od;if(this.fieldGroup_){var t=this.borderRect_;if(!t)throw Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getValue()),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getValue())}}getSize(){let e;return null!=(e=this.getConstants())&&e.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const e=this.getSourceBlock();if(!e)throw new od;e.applyColour()}updateSize_(e){var t=this.getConstants();this.isFullBlockField()?(e=2*(null!=e?e:0),t=t.FIELD_TEXT_HEIGHT):(e=t.FIELD_COLOUR_DEFAULT_WIDTH,t=t.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=t,this.size_.width=e,this.positionBorderRect_()}doClassValidation_(e){return"string"!=typeof e?null:Ti(e)}getText(){let e=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(e)&&(e="#"+e[1]+e[3]+e[5]),e}setColours(e,t){return this.colours=e,t&&(this.titles=t),this}setColumns(e){return this.columns=e,this}showEditor_(){this.dropdownCreate(),_r().appendChild(this.picker),vr(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(e){null!==(e=(e=e.target)&&e.getAttribute("data-colour"))&&(this.setValue(e),Nr(this))}onKeyDown(e){let t=!0;var n;switch(e.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":(n=this.getHighlighted())&&null!==(n=n.getAttribute("data-colour"))&&this.setValue(n),Or();break;default:t=!1}t&&e.stopPropagation()}moveHighlightBy(e,t){if(this.highlightedIndex){var n=this.colours||Xh.COLOURS,r=this.columns||Xh.COLUMNS,i=this.highlightedIndex%r,s=Math.floor(this.highlightedIndex/r);i+=e,s+=t,0>e?0>i&&0<s?(i=r-1,s--):0>i&&(i=0):0<e?i>r-1&&s<Math.floor(n.length/r)-1?(i=0,s++):i>r-1&&i--:0>t?0>s&&(s=0):0<t&&s>Math.floor(n.length/r)-1&&(s=Math.floor(n.length/r)-1),this.setHighlightedCell(this.picker.childNodes[s].childNodes[i],s*r+i)}}onMouseMove(e){const t=(e=e.target)&&Number(e.getAttribute("data-index"));null!==t&&t!==this.highlightedIndex&&this.setHighlightedCell(e,t)}onMouseEnter(){let e;null==(e=this.picker)||e.focus({preventScroll:!0})}onMouseLeave(){var e;null==(e=this.picker)||e.blur(),(e=this.getHighlighted())&&oe(e,"blocklyColourHighlighted")}getHighlighted(){if(!this.highlightedIndex)return null;const e=this.columns||Xh.COLUMNS,t=this.picker.childNodes[Math.floor(this.highlightedIndex/e)];return t?t.childNodes[this.highlightedIndex%e]:null}setHighlightedCell(e,t){const n=this.getHighlighted();n&&oe(n,"blocklyColourHighlighted"),ie(e,"blocklyColourHighlighted"),this.highlightedIndex=t,(e=e.getAttribute("id"))&&this.picker&&$n(this.picker,$c.ACTIVEDESCENDANT,e)}dropdownCreate(){const e=this.columns||Xh.COLUMNS,t=this.colours||Xh.COLOURS,n=this.titles||Xh.TITLES,r=this.getValue(),i=document.createElement("table");let s;i.className="blocklyColourTable",i.tabIndex=0,i.dir="ltr",Fn(i,Fc.GRID),$n(i,$c.EXPANDED,!0),$n(i,$c.ROWCOUNT,Math.floor(t.length/e)),$n(i,$c.COLCOUNT,e);for(let o=0;o<t.length;o++){0==o%e&&(s=document.createElement("tr"),Fn(s,Fc.ROW),i.appendChild(s));const a=document.createElement("td");s.appendChild(a),a.setAttribute("data-colour",t[o]),a.title=n[o]||t[o],a.id=S(),a.setAttribute("data-index",`${o}`),Fn(a,Fc.GRIDCELL),$n(a,$c.LABEL,t[o]),$n(a,$c.SELECTED,t[o]===r),a.style.backgroundColor=t[o],t[o]===r&&(a.className="blocklyColourSelected",this.highlightedIndex=o)}this.boundEvents.push(W(i,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(W(i,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(W(i,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(W(i,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(W(i,"keydown",this,this.onKeyDown,!1)),this.picker=i}dropdownDispose(){for(const e of this.boundEvents)q(e);this.boundEvents.length=0,this.highlightedIndex=this.picker=null}static fromJson(e){return new this(e.colour,void 0,e)}};Xh.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),Xh.TITLES=[],Xh.COLUMNS=7,Xh.prototype.DEFAULT_VALUE=Xh.COLOURS[0],Li("field_colour",Xh),ee("\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: 0.5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n");var Qh=class extends rp{constructor(e,t,n){super(String(null!=e?e:""),t,n),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(wi(e.text),void 0,e)}};Li("field_label_serializable",Qh);var Zh=class extends Mh{constructor(e,t,n){super(sd.SKIP_SETUP),this.textGroup=null,this.maxLines_=1/0,this.isOverflowedY_=!1,e!==sd.SKIP_SETUP&&(n&&this.configure_(n),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.maxLines&&this.setMaxLines(e.maxLines)}toXml(e){return e.textContent=this.getValue().replace(/\n/g,"&#10;"),e}fromXml(e){this.setValue(e.textContent.replace(/&#10;/g,"\n"))}saveState(){const e=this.saveLegacyState(Zh);return null!==e?e:this.getValue()}loadState(e){this.loadLegacyState(sd,e)||this.setValue(e)}initView(){this.createBorderRect_(),this.textGroup=re(dl.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const e=this.getSourceBlock();if(!e)throw new od;let t=this.getText();if(!t)return sd.NBSP;const n=t.split("\n");t="";const r=this.isOverflowedY_?this.maxLines_:n.length;for(let e=0;e<r;e++){let i=n[e];i.length>this.maxDisplayLength?i=i.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&e===r-1&&(i=i.substring(0,i.length-3)+"..."),t+=i=i.replace(/\s/g,sd.NBSP),e!==r-1&&(t+="\n")}return e.RTL&&(t+=""),t}doValueUpdate_(e){super.doValueUpdate_(e),null!==this.value_&&(this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_)}render_(){var e=this.getSourceBlock();if(!e)throw new od;for(var t,n=this.textGroup;t=n.firstChild;)n.removeChild(t);t=this.getDisplayText_().split("\n");let r=0;for(let e=0;e<t.length;e++){const i=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;re(dl.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:r+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},n).appendChild(document.createTextNode(t[e])),r+=i}this.isBeingEdited_&&(n=this.htmlInput_,this.isOverflowedY_?ie(n,"blocklyHtmlTextAreaInputOverflowedY"):oe(n,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(e.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),e=this.htmlInput_,this.isTextValid_?(oe(e,"blocklyInvalidInput"),$n(e,$c.INVALID,!1)):(ie(e,"blocklyInvalidInput"),$n(e,$c.INVALID,!0)))}updateSize_(){var e=this.textGroup.childNodes;const t=this.getConstants().FIELD_TEXT_FONTSIZE,n=this.getConstants().FIELD_TEXT_FONTWEIGHT,r=this.getConstants().FIELD_TEXT_FONTFAMILY;let i=0,s=0;for(var o=0;o<e.length;o++){var a=me(e[o],t,n,r);a>i&&(i=a),s+=this.getConstants().FIELD_TEXT_HEIGHT+(0<o?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(e=String(this.value_).split("\n"),o=re(dl.TEXT,{class:"blocklyText blocklyMultilineText"}),a=0;a<e.length;a++){e[a].length>this.maxDisplayLength&&(e[a]=e[a].substring(0,this.maxDisplayLength)),o.textContent=e[a];const s=me(o,t,n,r);s>i&&(i=s)}i+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(s+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,i+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",`${i}`),this.borderRect_.setAttribute("height",`${s}`)),this.size_.width=i,this.size_.height=s,this.positionBorderRect_()}showEditor_(e,t){super.showEditor_(e,t),this.forceRerender()}widgetCreate_(){const e=Bn(),t=this.workspace_.getScale(),n=document.createElement("textarea");n.className="blocklyHtmlInput blocklyHtmlTextAreaInput",n.setAttribute("spellcheck",String(this.spellcheck_));var r=this.getConstants().FIELD_TEXT_FONTSIZE*t+"pt";e.style.fontSize=r,n.style.fontSize=r,n.style.borderRadius=Mh.BORDERRADIUS*t+"px",r=this.getConstants().FIELD_BORDER_RECT_X_PADDING*t;const i=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*t/2;return n.style.padding=i+"px "+r+"px "+i+"px "+r+"px",r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n.style.lineHeight=r*t+"px",e.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.setAttribute("data-untyped-default-value",String(this.value_)),n.setAttribute("data-old-value",""),$a?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(n),n}setMaxLines(e){"number"==typeof e&&0<e&&e!==this.maxLines_&&(this.maxLines_=e,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(e){"Enter"!==e.key&&super.onHtmlInputKeyDown_(e)}static fromJson(e){return new this(wi(e.text),void 0,e)}};Li("field_multilinetext",Zh),ee("\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n");var ef=class extends Ph{constructor(e,t,n,r,i,s){super(sd.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==sd.SKIP_SETUP&&(s?this.configure_(s):this.setConstraints(t,n,r),this.setValue(e),i&&this.setValidator(i))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,n){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(n),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);-1!==t.indexOf("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const n=t.indexOf(".");this.decimalPlaces=-1===n?e?0:null:t.length-n-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e?null:(e=(e=(e=`${e}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e)?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e))}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&(e.min=`${this.min_}`,$n(e,$c.VALUEMIN,this.min_)),1/0>this.max_&&(e.max=`${this.max_}`,$n(e,$c.VALUEMAX,this.max_)),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Li("field_number",ef),ef.prototype.DEFAULT_VALUE=0;var tf=class extends pd{constructor(e,t,n,r,i){super(sd.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=tf.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new hl(0,0),e!==sd.SKIP_SETUP&&(i?this.configure_(i):this.setTypes(n,r),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new od;this.variable||(e=Po.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new od;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new od;const n=e.getAttribute("id"),r=e.textContent,i=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=Po.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,n,r,i),null!==i&&i!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+$t(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.name,this.variable.type&&e.setAttribute("variabletype",this.variable.type),e}saveState(e){var t=this.saveLegacyState(tf);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.name,t.type=this.variable.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new od;this.loadLegacyState(tf,e)||(e=Po.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new od;return(t=Po.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.type,this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new od;this.variable=Po.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let n=0;n<t.length;n++)if(e===t[n])return!0;return!1}getVariableTypes(){var e=this.variableTypes;if(null===e&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(0===(e=e||[""]).length)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes(e=null,t=""){if(Array.isArray(e)){let n=!1;for(let r=0;r<e.length;r++)e[r]===t&&(n=!0);if(!n)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if("RENAME_VARIABLE_ID"===e)return void Po.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if("DELETE_VARIABLE_ID"===e)return void this.sourceBlock_.workspace.deleteVariableById(this.variable.getId())}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(wi(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var n=this.getVariableTypes(),r=0;r<n.length;r++){const e=this.sourceBlock_.workspace.getVariablesOfType(n[r]);t=t.concat(e)}for(t.sort(Ql.compareByName),n=[],r=0;r<t.length;r++)n[r]=[t[r].name,t[r].getId()];return n.push([Po.Msg$$module$build$src$core$msg.RENAME_VARIABLE,"RENAME_VARIABLE_ID"]),Po.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&n.push([Po.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),"DELETE_VARIABLE_ID"]),n}};Li("field_variable",tf);var nf=class{constructor(e,t,n,r){this.workspace=e,this.targetWorkspace=t,this.isLabel_=r,this.onMouseUpWrapper=null,this.height=this.width=0,this.svgText=this.svgGroup=null,this.text=n.text,this.position=new el(0,0),this.callbackKey=n.callbackKey||n.callbackkey,this.cssClass=n["web-class"]||null,this.info=n}createDom(){var e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";let t;this.cssClass&&(e+=" "+this.cssClass),this.svgGroup=re(dl.G,{class:e},this.workspace.getCanvas()),this.isLabel_||(t=re(dl.RECT,{class:"blocklyFlyoutButtonShadow",rx:nf.BORDER_RADIUS,ry:nf.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=re(dl.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:nf.BORDER_RADIUS,ry:nf.BORDER_RADIUS},this.svgGroup);const n=re(dl.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var r=wi(this.text);this.workspace.RTL&&(r+=""),n.textContent=r,this.isLabel_&&(this.svgText=n,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const i=Te(n,"fontSize"),s=Te(n,"fontWeight"),o=Te(n,"fontFamily");if(this.width=_e(n,i,s,o),r=ge(r,i,s,o),this.height=r.height,!this.isLabel_){let e,n;this.width+=2*nf.TEXT_MARGIN_X,this.height+=2*nf.TEXT_MARGIN_Y,null==(e=t)||e.setAttribute("width",String(this.width)),null==(n=t)||n.setAttribute("height",String(this.height))}return e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),n.setAttribute("x",String(this.width/2)),n.setAttribute("y",String(this.height/2-r.height/2+r.baseline)),this.updateTransform(),this.onMouseUpWrapper=W(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}isLabel(){return this.isLabel_}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper&&q(this.onMouseUpWrapper),this.svgGroup&&le(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isLabel_&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isLabel_||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isLabel_||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};nf.TEXT_MARGIN_X=5,nf.TEXT_MARGIN_Y=2,nf.BORDER_RADIUS=4,ee("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var rf,sf=class extends fh{constructor(e,t){super(e),this.flyout_=t}getBoundingBox_(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox_();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,n){return t=n||this.getContentMetrics(),n=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*n)/e,width:(t.width+t.left+n)/e,top:0,left:0}}};!function(e){e.BLOCK="block",e.BUTTON="button"}(rf||(rf={}));var of=class extends Hp{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Ip(e),this.workspace_.setMetricsManager(new sf(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=C(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=re(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=re(dl.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new hh(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(W(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(W(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ya.Capability.AUTOHIDEABLE,Ya.Capability.DELETE_AREA,Ya.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)q(e);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&le(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}isVisible(){return this.isVisible_}setVisible(e){const t=e!==this.isVisible();this.isVisible_=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,n,r){let i,s;null==(i=this.svgGroup_)||i.setAttribute("width",`${e}`),null==(s=this.svgGroup_)||s.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&de(this.svgGroup_,"translate("+n+"px,"+r+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(n,r),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const e of this.listeners)q(e);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=$e(e),e=this.createFlyoutInfo(e),xt(this.workspace_),this.layout_(e.contents,e.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(e){const t=[],n=[];this.permanentlyDisabled.length=0;const r=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const i of e){if("custom"in i){e=this.getDynamicCategoryContents(i.custom),e=$e(e);const{contents:r,gaps:s}=this.createFlyoutInfo(e);t.push(...r),n.push(...s)}switch(i.kind.toUpperCase()){case"BLOCK":e=i;const s=this.createFlyoutBlock(e);t.push({type:rf.BLOCK,block:s}),this.addBlockGap(e,n,r);break;case"SEP":this.addSeparatorGap(i,n,r);break;case"LABEL":e=this.createButton(i,!0),t.push({type:rf.BUTTON,button:e}),n.push(r);break;case"BUTTON":e=this.createButton(i,!1),t.push({type:rf.BUTTON,button:e}),n.push(r)}}return{contents:t,gaps:n}}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton(e,t){return new nf(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock(e){let t;return e.blockxml?(e="string"==typeof e.blockxml?Po.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,(t=this.getRecycledBlock(e.getAttribute("type")))||(t=Ht(e,this.workspace_))):(t=this.getRecycledBlock(e.type))||(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),t=_n(e,this.workspace_)),t.isEnabled()||this.permanentlyDisabled.push(t),t}getRecycledBlock(e){let t=-1;for(let n=0;n<this.recycledBlocks.length;n++)if(this.recycledBlocks[n].type===e){t=n;break}return-1===t?void 0:this.recycledBlocks.splice(t,1)[0]}addBlockGap(e,t,n){let r;e.gap?r=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?Po.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,r=parseInt(e.getAttribute("gap"))),t.push(!r||isNaN(r)?n:r)}addSeparatorGap(e,t,n){e=parseInt(String(e.gap)),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(n)}clearOldBlocks(){var e=this.workspace_.getTopBlocks(!1);for(let t,n=0;t=e[n];n++)this.blockIsRecyclable_(t)?this.recycleBlock(t):t.dispose(!1,!1);for(e=0;e<this.mats.length;e++){const t=this.mats[e];t&&(ri(t),le(t))}this.mats.length=0;for(let e,t=0;e=this.buttons_[t];t++)e.dispose();let t;this.buttons_.length=0,null==(t=this.workspace_.getPotentialVariableMap())||t.clear()}emptyRecycledBlocks(){for(let e=0;e<this.recycledBlocks.length;e++)this.recycledBlocks[e].dispose();this.recycledBlocks=[]}blockIsRecyclable_(e){return!1}recycleBlock(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks.push(e)}addBlockListeners_(e,t,n){this.listeners.push(W(e,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(W(n,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(z(e,"pointerenter",t,(()=>{this.targetWorkspace.isDragging()||t.addSelect()}))),this.listeners.push(z(e,"pointerleave",t,(()=>{this.targetWorkspace.isDragging()||t.removeSelect()}))),this.listeners.push(z(n,"pointerenter",t,(()=>{this.targetWorkspace.isDragging()||t.addSelect()}))),this.listeners.push(z(n,"pointerleave",t,(()=>{this.targetWorkspace.isDragging()||t.removeSelect()})))}blockMouseDown(e){return t=>{const n=this.targetWorkspace.getGesture(t);n&&(n.setStartBlock(e),n.handleFlyoutStart(t,this))}}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;Po.disable$$module$build$src$core$events$utils();var n=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{Po.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=bt(this.targetWorkspace,n),L()){for(Po.setGroup$$module$build$src$core$events$utils(!0),n=0;n<e.length;n++){const t=e[n];w(new($(ea))(t))}w(new($(Po.CREATE$$module$build$src$core$events$utils))(t))}return this.autoClose?this.hide():this.filterForCapacity(),t}initFlyoutButton_(e,t,n){const r=e.createDom();e.moveTo(t,n),e.show(),this.listeners.push(W(r,"pointerdown",this,this.onMouseDown)),this.buttons_.push(e)}createRect_(e,t,n,r,i){return(t=re(dl.RECT,{"fill-opacity":0,x:t,y:n,height:r.height,width:r.width})).tooltip=e,ni(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats[i]=t}moveRectToBlock_(e,t){const n=t.getHeightWidth();e.setAttribute("width",String(n.width)),e.setAttribute("height",String(n.height)),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",String(t.y)),e.setAttribute("x",String(this.RTL?t.x-n.width:t.x))}filterForCapacity(){const e=this.workspace_.getTopBlocks(!1);for(let t,n=0;t=e[n];n++)if(-1===this.permanentlyDisabled.indexOf(t)){const e=this.targetWorkspace.isCapacityAvailable(T(t));for(;t;)t.setEnabled(e),t=t.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const n=on(e);return t.setResizesEnabled(!1),t=mn(n,t),this.positionNewBlock(e,t),t}positionNewBlock(e,t){const n=this.targetWorkspace;var r=n.getOriginOffsetInPixels(),i=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),i=el.sum(i,e),(r=el.difference(i,r)).scale(1/n.scale),t.moveTo(new el(r.x,r.y))}};of.FlyoutItemType=rf;var af=class extends of{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),r=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(n.left+(n.width-r.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();e=e.getToolboxMetrics();const r=this.toolboxPosition_===Al.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?r?e.height:n.height-this.height_:r?0:n.height:r?0:n.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Al.TOP,r=["M 0,"+(n?0:this.CORNER_RADIUS)];n?(r.push("h",e+2*this.CORNER_RADIUS),r.push("v",t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",-e),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),r.push("h",e),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",t),r.push("h",-e-2*this.CORNER_RADIUS)),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=Q(e);if(t=t.x||t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let r;t=e.getViewMetrics().left-n.left+t,null==(r=this.workspace_.scrollbar)||r.setX(t),Gn(),Or()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const n=this.MARGIN;let r=n+this.tabWidth_;this.RTL&&(e=e.reverse());for(let a,l=0;a=e[l];l++)if("block"===a.type){var i=a.block,s=i.getDescendants(!1);for(let e,t=0;e=s[t];t++)e.isInFlyout=!0;s=i.getSvgRoot();const e=i.getHeightWidth();var o=i.outputConnection?this.tabWidth_:0;o=this.RTL?r+e.width:r-o,i.moveBy(o,n),o=this.createRect_(i,o,n,e,l),r+=e.width+t[l],this.addBlockListeners_(s,i,o)}else"button"===a.type&&(i=a.button,this.initFlyoutButton_(i,r,n),r+=i.width+t[l])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Al.TOP?new pl(-1e9,t+e.height,-1e9,1e9):new pl(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(!1);for(let n,r=0;n=t[r];r++)e=Math.max(e,n.getHeightWidth().height);const n=this.buttons_;for(let t,r=0;t=n[r];r++)e=Math.max(e,t.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=bl.scrollbarThickness,this.height_!==e){for(let e,n=0;e=t[n];n++)this.rectMap_.has(e)&&this.moveRectToBlock_(this.rectMap_.get(e),e);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Al.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};t(Uo.FLYOUTS_HORIZONTAL_TOOLBOX,Bo,af);var lf=class extends of{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),n=t.getScrollMetrics(),r=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(n.top+(n.height-r.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),n=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Al.LEFT?e.width:n.width-this.width_:this.toolboxPosition_===Al.LEFT?0:n.width:this.toolboxPosition_===Al.LEFT?0:n.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const n=this.toolboxPosition_===Al.RIGHT;var r=e+this.CORNER_RADIUS;(r=["M "+(n?r:0)+",0"]).push("h",n?-e:e),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",Math.max(0,t)),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,n?0:1,n?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",n?e:-e),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=Q(e);if(t.y){const e=this.workspace_.getMetricsManager(),n=e.getScrollMetrics();let r;t=e.getViewMetrics().top-n.top+t.y,null==(r=this.workspace_.scrollbar)||r.setY(t),Gn(),Or()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var n=this.MARGIN;const r=this.RTL?n:n+this.tabWidth_;for(let a,l=0;a=e[l];l++)if("block"===a.type){var i=a.block,s=i.getDescendants(!1);for(let e,t=0;e=s[t];t++)e.isInFlyout=!0;s=i.getSvgRoot();const e=i.getHeightWidth();var o=i.outputConnection?r-this.tabWidth_:r;i.moveBy(o,n),o=this.createRect_(i,this.RTL?o-e.width:o,n,e,l),this.addBlockListeners_(s,i,o),n+=e.height+t[l]}else"button"===a.type&&(i=a.button,this.initFlyoutButton_(i,r,n),n+=i.height+t[l])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Al.LEFT?new pl(-1e9,1e9,-1e9,t+e.width):new pl(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(!1);for(let r,i=0;r=t[i];i++){var n=r.getHeightWidth().width;r.outputConnection&&(n-=this.tabWidth_),e=Math.max(e,n)}for(let t,n=0;t=this.buttons_[n];n++)e=Math.max(e,t.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=bl.scrollbarThickness,this.width_!==e){for(let r,i=0;r=t[i];i++){if(this.RTL){n=r.getRelativeToSurfaceXY().x;let t=e/this.workspace_.scale-this.MARGIN;r.outputConnection||(t-=this.tabWidth_),r.moveBy(t-n,0)}this.rectMap_.has(r)&&this.moveRectToBlock_(this.rectMap_.get(r),r)}if(this.RTL)for(let n,r=0;n=this.buttons_[r];r++)t=n.getPosition().y,n.moveTo(e/this.workspace_.scale-n.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Al.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};lf.registryName="verticalFlyout",t(Uo.FLYOUTS_VERTICAL_TOOLBOX,Bo,lf),Po.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=f());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let n,r=0;n=e[r];r++){let e=this.blockToCode(n);Array.isArray(e)&&(e=e[0]),e&&(n.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,n)+e),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,n))),t.push(e))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let n=0;n<e.length;n++){const r=e[n].getCommentText();r&&t.push(r)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var n=this.forBlock[e.type];if(!n&&this[e.type]&&(ne("block generator functions on CodeGenerator objects","10.0","11.0","the .forBlock[blockType] dictionary"),n=this[e.type]),"function"!=typeof n)throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(n=n.call(e,e,this),Array.isArray(n)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,n[0],t),n[1]]}if("string"==typeof n)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,e)+n),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,n,t);if(null===n)return"";throw SyntaxError("Invalid code generated: "+n)}valueToCode(e,t,n){if(isNaN(n))throw TypeError("Expecting valid order from block: "+e.type);var r=e.getInputTargetBlock(t);if(!r)return"";if(""===(t=this.blockToCode(r)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${r.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+r.type);if(!e)return"";r=!1;var i=Math.floor(n);const s=Math.floor(t);if(i<=s&&(i!==s||0!==i&&99!==i))for(r=!0,i=0;i<this.ORDER_OVERRIDES.length;i++)if(this.ORDER_OVERRIDES[i][0]===n&&this.ORDER_OVERRIDES[i][1]===t){r=!1;break}return r&&(e="("+e+")"),e}statementToCode(e,t){if(e=e.getInputTargetBlock(t),"string"!=typeof(t=this.blockToCode(e)))throw TypeError("Expecting code from statement block: "+(e&&e.type));return t&&(t=this.prefixLines(t,this.INDENT)),t}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const n=this.nameDB_.getDistinctName(e,Po.NameType$$module$build$src$core$names.PROCEDURE);let r;for(this.functionNames_[e]=n,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);r!==t;)r=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,Po.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,Po.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,n){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},Po.CodeGenerator$$module$build$src$core$generator;var cf=!1,uf={};uf.Align=Po.Align$$module$build$src$core$inputs$align,uf.DummyInput=sp,uf.EndRowInput=op,uf.Input=ip,uf.StatementInput=ap,uf.ValueInput=Po.ValueInput$$module$build$src$core$inputs$value_input,uf.inputTypes=Po.inputTypes$$module$build$src$core$inputs$input_types;var df=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,n){Po.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=n,n.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{Po.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){Po.disable$$module$build$src$core$events$utils();try{this.hidePreview();const n=e.getSourceBlock(),r=this.createInsertionMarker(n),i=this.getMatchingConnection(n,r,e);if(!i)throw Error("Could not create insertion marker to preview connection");r.queueRender(),xt(),i.connect(t);const s={x:t.x-i.x,y:t.y-i.y},o=i.getOffsetInBlock().clone();Et().then((()=>{null==r||r.positionNearConnection(i,s,o),null==r||r.getSvgRoot().setAttribute("visibility","visible")})),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.markerConn=i,this.draggedConn=e,this.staticConn=t}finally{Po.enable$$module$build$src$core$events$utils()}}}createInsertionMarker(e){const t=this.workspace.newBlock(e.type);if(t.setInsertionMarker(!0),e.saveExtraState){var n=e.saveExtraState(!0);n&&t.loadExtraState&&t.loadExtraState(n)}else e.mutationToDom&&(n=e.mutationToDom())&&t.domToMutation&&t.domToMutation(n);for(n=0;n<e.inputList.length;n++){const r=e.inputList[n];if("_TEMP_COLLAPSED_INPUT"===r.name)continue;const i=t.inputList[n];if(!i)throw Error("The insertion marker previewer tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.".replace("%1","an input"));for(let e=0;e<r.fieldRow.length;e++){const t=r.fieldRow[e],n=i.fieldRow[e];if(!n)throw Error("The insertion marker previewer tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.".replace("%1","a field"));n.setValue(t.getValue())}}for(const e of t.getDescendants(!1))e.setInsertionMarker(!0);return t.setCollapsed(e.isCollapsed()),t.setInputsInline(e.getInputsInline()),t.initSvg(),t.getSvgRoot().setAttribute("visibility","hidden"),t}getMatchingConnection(e,t,n){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let r=0;r<e.length;r++)if(e[r]===n)return t[r];return null}hidePreview(){Po.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{Po.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),n=t.outputConnection;let r;if(null!=(r=t.previousConnection)&&r.targetConnection||null!=n&&n.targetConnection)t.unplug(!0);else{let t;null==(t=e.targetBlock())||t.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};t(Uo.CONNECTION_PREVIEWER,Bo,df);var pf=class extends ep{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},hf=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=rs(e.xPos,this.info_.startY);for(let t,n=0;t=e.elements[n];n++)Od.isLeftSquareCorner(t)?this.steps_+=this.highlightConstants_.START_POINT:Od.isLeftRoundedCorner(t)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Od.isPreviousConnection(t)?this.steps_+=this.notchPaths_.pathLeft:Od.isHat(t)?this.steps_+=this.startPaths_.path(this.RTL_):Od.isSpacer(t)&&0!==t.width&&(this.steps_+=os("H",t.xPos+t.width-this.highlightOffset));this.steps_+=os("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+os("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const n=e.height-t.connectionHeight;this.steps_+=ns(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+os("v",n)}else this.steps_+=ns(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const n=e.height-2*this.insideCornerPaths_.height;this.steps_+=ns(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+os("v",n)+this.insideCornerPaths_.pathBottom(this.RTL_)+is(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=ns(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+is(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof Xd&&e.followsStatement&&(this.steps_+=os("H",t)),this.RTL_&&(this.steps_+=os("H",t),e.height>this.highlightOffset&&(this.steps_+=os("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=os("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];Od.isLeftSquareCorner(t)?this.steps_+=ns(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):Od.isLeftRoundedCorner(t)&&(this.steps_+=ns(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=ns(this.info_.startX,e):(this.steps_+=ns(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=os("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,Od.isLeftRoundedCorner(e.elements[0])?this.steps_+=os("V",this.outsideCornerPaths_.height):this.steps_+=os("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,n=e.xPos+e.connectionWidth;var r=e.centerline-e.height/2;const i=e.width-e.connectionWidth,s=r+t;this.RTL_?(r=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=ns(n-t,s)+os("v",r)+this.puzzleTabPaths_.pathDown(this.RTL_)+os("v",e)+os("h",i)):this.inlineSteps_+=ns(e.xPos+e.width+t,s)+os("v",e.height)+os("h",-i)+ns(n,r+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},ff=class extends np{constructor(e,t){super(e,t),this.highlighter_=new hf(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=os("H",e.xPos+e.width)+os("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let n=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(null!=t&&t.connectionModel){let n=e.xPos+e.statementEdge+t.notchOffset;n=this.info_.RTL?-1*n:n+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(n,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let n=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,n=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-n:n)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},mf=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=rs(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e+t)-t,r=rs(n,n)+as("a","0 0,0",e,es(-n-t,e-n)),i=as("a","0 0,0",e+t,es(e+t,e+t)),s=rs(n,-n)+as("a","0 0,0",e+t,es(e-n,n+t));return{width:e+t,height:e,pathTop:e=>e?r:"",pathBottom:e=>e?i:s}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,n=(1-Math.SQRT1_2)*(e-t)+t,r=rs(n,n)+as("a","0 0,1",e-t,es(e-n,-n+t)),i=rs(t,e)+as("a","0 0,1",e-t,es(e,-e+t)),s=-n,o=rs(n,s)+as("a","0 0,1",e-t,es(-n+t,-s-e));return{height:e,topLeft:e=>e?r:i,bottomLeft:()=>o}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,n=rs(-2,3.4-t)+is(-.45*e,-2.1),r=os("v",2.5)+rs(.97*-e,2.5)+ts("q",[es(.05*-e,10),es(.3*e,9.5)])+rs(.67*e,-1.9)+os("v",2.5),i=os("v",-1.5)+rs(-.92*e,-.5)+ts("q",[es(-.19*e,-5.5),es(0,-11)])+rs(.92*e,1),s=rs(-5,t-.7)+is(.46*e,-2.1);return{width:e,height:t,pathUp:e=>e?n:i,pathDown:e=>e?r:s}}makeNotch(){return{pathLeft:os("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:is(5.1,2.6)+rs(-10.2,6.8)+is(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=rs(25,-8.7)+ts("c",[es(29.7,-6.2),es(57.2,-.5),es(75,8.7)]),n=ts("c",[es(17.8,-9.2),es(45.3,-14.9),es(75,-8.7)])+ns(100.5,e+.5);return{path:e=>e?t:n}}},_f=class extends Gd{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},gf=class extends jd{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},yf=class extends lp{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof ap||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof Po.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new _f(this.constants_,e)),t.hasInlineInput=!0):e instanceof ap?(t.elements.push(new gf(this.constants_,e)),t.hasStatement=!0):e instanceof Po.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new $d(this.constants_,e)),t.hasExternalInput=!0):(e instanceof sp||e instanceof op)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let t,n=0;t=this.rows[n];n++)t.hasExternalInput&&(e=!0);for(let n,r=0;n=this.rows[r];r++){var t=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new Hd(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let e=0;e<t.length-1;e++){n.elements.push(t[e]);const r=this.getInRowSpacing_(t[e],t[e+1]);n.elements.push(new Hd(this.constants_,r))}n.elements.push(t[t.length-1]),n.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&n.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),n.elements.push(new Hd(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&Od.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Od.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Od.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Od.isInput(e)&&(!t||Od.isStatementInput(t)))return Od.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Od.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Od.isHat(e)?this.constants_.NO_PADDING:Od.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Od.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Od.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Od.isInput(e)&&!t){if(Od.isExternalInput(e))return this.constants_.NO_PADDING;if(Od.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Od.isStatementInput(e))return this.constants_.NO_PADDING}if(!Od.isInput(e)&&t&&Od.isInput(t)){if(Od.isField(e)&&e.isEditable){if(Od.isInlineInput(t)||Od.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Od.isInlineInput(t)||Od.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Od.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Od.isIcon(e)&&t&&!Od.isInput(t))return this.constants_.LARGE_PADDING;if(Od.isInlineInput(e)&&t&&Od.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Od.isLeftSquareCorner(e)&&t){if(Od.isHat(t))return this.constants_.NO_PADDING;if(Od.isPreviousConnection(t))return t.notchOffset;if(Od.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Od.isLeftRoundedCorner(e)&&t){if(Od.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(Od.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return Od.isField(e)&&t&&Od.isField(t)&&e.isEditable===t.isEditable||t&&Od.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Od.isTopRow(e)&&Od.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Od.isTopRow(e)||Od.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Od.isSpacer(t))return e.yPos+t.height/2;if(Od.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Od.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Od.isTopRow(e))return Od.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return Od.isField(t)||Od.isIcon(t)?(n+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(n+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):n=Od.isInlineInput(t)?n+t.height/2:n+e.height/2,n}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,n=null;for(let r,i=this.rows.length-1;r=this.rows[i];i--)t.set(r,e),Od.isInputRow(r)&&(r.hasStatement&&this.alignStatementRow_(r),n&&n.hasStatement&&r.width<n.width?t.set(r,n.width):e=r.hasStatement?r.width:Math.max(e,r.width),n=r);e=0;for(let r,i=0;r=this.rows[i];i++)r.hasStatement?e=this.getDesiredRowWidth_(r):Od.isSpacer(r)?r.width=Math.max(e,t.get(r)):(n=r.width,0<(e=Math.max(e,t.get(r))-n)&&this.addAlignmentPadding_(r,e),e=r.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let r,i=0;r=this.rows[i];i++){r.yPos=t,r.xPos=this.startX,t+=r.height,e=Math.max(e,r.widthWithConnectedBlocks);var n=t-this.topRow.ascenderHeight;r===this.bottomRow&&n<this.constants_.MIN_BLOCK_HEIGHT&&(n=this.constants_.MIN_BLOCK_HEIGHT-n,this.bottomRow.height+=n,t+=n),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},bf=class extends pp{constructor(e,t,n){super(e,t,n),this.constants=n,this.colourDark="#000000",this.svgPathDark=re(dl.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=re(dl.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Si("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},vf=class extends gp{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new pf}makeRenderInfo_(e){return new yf(this,e)}makeDrawer_(e,t){return new ff(e,t)}makePathObject(e,t){return new bf(e,t,this.getConstants())}makeHighlightConstants_(){return new mf(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};Is("geras",vf);var Tf={};Tf.ConstantProvider=pf,Tf.Drawer=ff,Tf.HighlightConstantProvider=mf,Tf.Highlighter=hf,Tf.InlineInput=_f,Tf.PathObject=bf,Tf.RenderInfo=yf,Tf.Renderer=vf,Tf.StatementInput=gf;var kf=class extends ep{constructor(){super(),ne("Blockly.minimalist.ConstantProvider","v10","v11","Blockly.blockRendering.ConstantProvider")}},Ef=class extends np{constructor(e,t){super(e,t),ne("Blockly.minimalist.Drawer","v10","v11","Blockly.blockRendering.Drawer")}},xf=class extends lp{constructor(e,t){super(e,t),ne("Blockly.minimalist.RenderInfo","v10","v11","Blockly.blockRendering.RenderInfo")}getRenderer(){return this.renderer_}},Sf=class extends gp{constructor(e){super(e),ne("Blockly.minimalist.Renderer","v10","v11","Blockly.blockRendering.Renderer")}makeConstants_(){return new kf}makeRenderInfo_(e){return new xf(this,e)}makeDrawer_(e,t){return new Ef(e,t)}};Is("minimalist",Sf);var Cf={};Cf.ConstantProvider=kf,Cf.Drawer=Ef,Cf.RenderInfo=xf,Cf.Renderer=Sf;var If=class extends lp{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const r=this.rows[t];var n=r.elements;if(r.elements=[],r.startsWithElemSpacer()&&r.elements.push(new Hd(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){r.elements.push(n[e]);const t=this.getInRowSpacing_(n[e],n[e+1]);r.elements.push(new Hd(this.constants_,t))}r.elements.push(n[n.length-1]),r.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),e&&r.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),r.elements.push(new Hd(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&Od.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&Od.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&Od.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Od.isInput(e)&&!t)return Od.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:Od.isIcon(e)?2*this.constants_.LARGE_PADDING+1:Od.isHat(e)?this.constants_.NO_PADDING:Od.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:Od.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:Od.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Od.isInput(e)&&!t){if(Od.isExternalInput(e))return this.constants_.NO_PADDING;if(Od.isInlineInput(e))return this.constants_.LARGE_PADDING;if(Od.isStatementInput(e))return this.constants_.NO_PADDING}if(!Od.isInput(e)&&t&&Od.isInput(t)){if(Od.isField(e)&&e.isEditable){if(Od.isInlineInput(t)||Od.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(Od.isInlineInput(t)||Od.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(Od.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Od.isIcon(e)&&t&&!Od.isInput(t))return this.constants_.LARGE_PADDING;if(Od.isInlineInput(e)&&t&&Od.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Od.isLeftSquareCorner(e)&&t){if(Od.isHat(t))return this.constants_.NO_PADDING;if(Od.isPreviousConnection(t)||Od.isNextConnection(t))return t.notchOffset}return Od.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:Od.isField(e)&&t&&Od.isField(t)&&e.isEditable===t.isEditable||t&&Od.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return Od.isTopRow(e)&&Od.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Od.isTopRow(e)||Od.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(Od.isSpacer(t))return e.yPos+t.height/2;if(Od.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,Od.isNextConnection(t)?e+t.height/2:e-t.height/2;if(Od.isTopRow(e))return Od.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let n=e.yPos;return Od.isField(t)&&e.hasStatement?n+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):n+e.height/2}finalize_(){let e=0,t=0;for(var n=0;n<this.rows.length;n++){const i=this.rows[n];i.yPos=t,i.xPos=this.startX,t+=i.height,e=Math.max(e,i.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;i===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(i)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(n=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,n.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},Af=class extends gp{constructor(e){super(e)}makeRenderInfo_(e){return new If(this,e)}};Is("thrasos",Af);var wf={};wf.RenderInfo=If,wf.Renderer=Af;var Nf=new Yu("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),Df={Classic:Xu,Zelos:Nf},Of=class{constructor(e,t,n){this.id_=e.toolboxitemid||S(),this.level_=(this.parent_=n||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}},Rf=class extends Of{constructor(e,t,n){super(e,t,n),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const n=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(n)}}parseCategoryDef_(e){this.name_="name"in e?wi(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Fn(this.htmlDiv_,Fc.TREEITEM),$n(this.htmlDiv_,$c.SELECTED,!1),$n(this.htmlDiv_,$c.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Fn(this.iconDom_,Fc.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&$n(this.htmlDiv_,$c.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ie(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&ie(e,t),t=Rf.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&ie(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ie(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&ie(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Rf.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle_(t);if(e)return this.parseColour_(e)}return""}getColourfromStyle_(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour_(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(e){if(null==(e=wi(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=Ti(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Ci(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&se(e,t),(t=this.cssConfig_.openicon)&&ie(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&se(e,t),(t=this.cssConfig_.closedicon)&&ie(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(!(e=e.getParent()).isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const e=this.parseColour_(Rf.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,t&&ie(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&oe(this.rowDiv_,t);$n(this.htmlDiv_,$c.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:$e(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){le(this.htmlDiv_)}};Rf.registrationName="category",Rf.nestedPadding=19,Rf.borderWidth=8,Rf.defaultBackgroundColour="#57e",ee('\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n'),t(Uo.TOOLBOX_ITEM,Rf.registrationName,Rf);var Lf=class extends Of{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&ie(e,t),this.htmlDiv_=e}getDiv(){return this.htmlDiv_}dispose(){le(this.htmlDiv_)}};Lf.registrationName="sep",ee('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),t(Uo.TOOLBOX_ITEM,Lf.registrationName,Lf);var Pf=class extends Rf{constructor(e,t,n){super(e,t,n),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let n=0;n<t.length;n++){const r=t[n];!s(Uo.TOOLBOX_ITEM,r.kind)||r.kind.toLowerCase()===Lf.registrationName&&e?(this.flyoutItems_.push(r),e=!0):(this.createToolboxItem_(r),e=!1)}}}}createToolboxItem_(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&Ve(e)&&(t=Pf.registrationName),e=new(o(Uo.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Fn(this.subcategoriesDiv_,Fc.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),$n(this.htmlDiv_,$c.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&ie(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var n=this.cssConfig_.contents;for(n&&ie(t,n),n=0;n<e.length;n++){const r=e[n];r.init();const i=r.getDiv();if(t.appendChild(i),r.getClickTarget){let e;null==(e=r.getClickTarget())||e.setAttribute("id",r.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let e;null==(e=this.parentToolbox_.getFlyout())||e.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}$n(this.htmlDiv_,$c.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let n=0;n<t.length;n++)t[n].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Pf.registrationName="collapsibleCategory",t(Uo.TOOLBOX_ITEM,Pf.registrationName,Pf);var Mf=class extends Hp{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout_=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),ce(this.flyout_.createDom("svg"),t),this.setVisible(!0),this.flyout_.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[Ya.Capability.AUTOHIDEABLE,Ya.Capability.DELETE_AREA,Ya.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,Fn(this.contentsDiv_,Fc.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),ie(e,"blocklyToolboxDiv"),ie(e,"blocklyNonSelectable"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return ie(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=W(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=W(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(Y(e)||e.target===this.HtmlDiv)f().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),f().hideChaff(!0)}H()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext_();break;case"ArrowUp":t=this.selectPrevious_();break;case"ArrowLeft":t=this.selectParent_();break;case"ArrowRight":t=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new Qu({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?c(Uo.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):c(Uo.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e;for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t&&t.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let n=0;n<e.length;n++)this.createToolboxItem_(e[n],t);this.contentsDiv_.appendChild(t)}createToolboxItem_(e,t){var n=e.kind;"CATEGORY"===n.toUpperCase()&&Ve(e)&&(n=Pf.registrationName),(n=o(Uo.TOOLBOX_ITEM,n.toLowerCase()))&&((e=new n(e,this)).init(),this.addToolboxItem_(e),(n=e.getDiv())&&t.appendChild(n),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&ie(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&oe(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,n=t+e.height,r=e.left;return e=r+e.width,this.toolboxPosition===Al.TOP?new pl(-1e7,n,-1e7,1e7):this.toolboxPosition===Al.BOTTOM?new pl(t,1e7,-1e7,1e7):this.toolboxPosition===Al.LEFT?new pl(-1e7,1e7,-1e7,e):new pl(-1e7,1e7,r,1e7)}wouldDelete(e,t){return e instanceof Bp?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Al.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Al.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===Al.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===Al.TOP?e.scrollY+t.height:e.scrollY),v(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Oo(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent_(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),$n(this.contentsDiv_,$c.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),$n(this.contentsDiv_,$c.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e]).isSelectable()&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout_.show(t.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(e,t){const n=e&&e.getName();let r=t&&t.getName();e===t&&(r=null),e=new($("toolbox_item_select"))(n,r,this.workspace_.id),w(e)}selectParent_(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext_():e.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)q(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),le(this.HtmlDiv))}};ee('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n'),t(Uo.TOOLBOX,Bo,Mf);var Ff=Po.Align$$module$build$src$core$inputs$align.LEFT,$f=Po.Align$$module$build$src$core$inputs$align.CENTRE,Bf=Po.Align$$module$build$src$core$inputs$align.RIGHT,Uf=Ac.INPUT_VALUE,Vf=Ac.OUTPUT_VALUE,Hf=Ac.NEXT_STATEMENT,Gf=Ac.PREVIOUS_STATEMENT,jf=Po.inputTypes$$module$build$src$core$inputs$input_types.DUMMY,Kf=Al.TOP,Wf=Al.BOTTOM,zf=Al.LEFT,qf=Al.RIGHT;Sp.prototype.newBlock=function(e,t){return new Dp(this,e,t)},Ip.prototype.newBlock=function(e,t){return new Bp(this,e,t)},Ip.newTrashcan=function(e){return new Gp(e)},oc.prototype.showContextMenu=function(e){if(!this.workspace.options.readOnly){var t=[];this.isDeletable()&&this.isMovable()&&(t.push(lr(this)),t.push(ar(this))),er(e,t,this.RTL)}},_d.prototype.newWorkspaceSvg=function(e){return new Ip(e)},Po.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=us(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],Po.Names$$module$build$src$core$names.NameType.PROCEDURE)};var Jf=Ac,Yf={ALIGN_CENTRE:$f,ALIGN_LEFT:Ff,ALIGN_RIGHT:Bf};return Yf.ASTNode=cp,Yf.BasicCursor=Lp,Yf.Block=Dp,Yf.BlockDragger=yh,Yf.BlockSvg=Bp,Yf.Blocks=jo,Yf.Bubble=md,Yf.BubbleDragger=Su,Yf.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",Yf.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",Yf.COLLAPSE_CHARS=30,Yf.CodeGenerator=Po.CodeGenerator$$module$build$src$core$generator,Yf.CollapsibleToolboxCategory=Pf,Yf.ComponentManager=Ya,Yf.Connection=hp,Yf.ConnectionChecker=Tp,Yf.ConnectionDB=Nc,Yf.ConnectionType=Ac,Yf.ContextMenu=eu,Yf.ContextMenuItems=Wh,Yf.ContextMenuRegistry=tu,Yf.Css=Za,Yf.Cursor=Rp,Yf.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",Yf.DRAG_STACK=!0,Yf.DUMMY_INPUT=jf,Yf.DeleteArea=Hp,Yf.DragTarget=Vp,Yf.DropDownDiv=Tu,Yf.Events=Dh,Yf.Extensions=vd,Yf.Field=sd,Yf.FieldAngle=qh,Yf.FieldCheckbox=Yh,Yf.FieldColour=Xh,Yf.FieldDropdown=pd,Yf.FieldImage=Lh,Yf.FieldLabel=rp,Yf.FieldLabelSerializable=Qh,Yf.FieldMultilineInput=Zh,Yf.FieldNumber=ef,Yf.FieldTextInput=Mh,Yf.FieldVariable=tf,Yf.Flyout=of,Yf.FlyoutButton=nf,Yf.FlyoutMetricsManager=sf,Yf.Generator=Po.CodeGenerator$$module$build$src$core$generator,Yf.Gesture=Wu,Yf.Grid=zu,Yf.HorizontalFlyout=af,Yf.INPUT_VALUE=Uf,Yf.Input=ip,Yf.InsertionMarkerManager=fp,Yf.InsertionMarkerPreviewer=df,Yf.Marker=Op,Yf.MarkerManager=qu,Yf.Menu=Gc,Yf.MenuItem=jc,Yf.MetricsManager=fh,Yf.Msg=Po.Msg$$module$build$src$core$msg,Yf.NEXT_STATEMENT=Hf,Yf.Names=Po.Names$$module$build$src$core$names,Yf.OPPOSITE_TYPE=Cu,Yf.OUTPUT_VALUE=Vf,Yf.Options=Qu,Yf.PREVIOUS_STATEMENT=Gf,Yf.PROCEDURE_CATEGORY_NAME="PROCEDURE",Yf.Procedures=Nd,Yf.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",Yf.RenderedConnection=Mp,Yf.Scrollbar=bl,Yf.ScrollbarPair=hh,Yf.ShortcutItems=ah,Yf.ShortcutRegistry=ih,Yf.TOOLBOX_AT_BOTTOM=Wf,Yf.TOOLBOX_AT_LEFT=zf,Yf.TOOLBOX_AT_RIGHT=qf,Yf.TOOLBOX_AT_TOP=Kf,Yf.TabNavigateCursor=Pp,Yf.Theme=Yu,Yf.ThemeManager=bp,Yf.Themes=Df,Yf.Toolbox=Mf,Yf.ToolboxCategory=Rf,Yf.ToolboxItem=Of,Yf.ToolboxSeparator=Lf,Yf.Tooltip=ju,Yf.Touch=Ma,Yf.Trashcan=Gp,Yf.UnattachedFieldError=od,Yf.VARIABLE_CATEGORY_NAME="VARIABLE",Yf.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",Yf.VERSION="10.4.1",Yf.VariableMap=xp,Yf.VariableModel=Ql,Yf.Variables=tc,Yf.VariablesDynamic=vp,Yf.VerticalFlyout=lf,Yf.WidgetDiv=Yc,Yf.Workspace=Sp,Yf.WorkspaceAudio=Cp,Yf.WorkspaceComment=nc,Yf.WorkspaceCommentSvg=oc,Yf.WorkspaceDragger=Ku,Yf.WorkspaceSvg=Ip,Yf.Xml=hc,Yf.ZoomControls=Ul,Yf.blockAnimations=xu,Yf.blockRendering=yp,Yf.browserEvents=za,Yf.bubbles=bh,Yf.bumpObjects=gh,Yf.clipboard=Mc,Yf.common=Jo,Yf.config=Po.config$$module$build$src$core$config,Yf.connectionTypes=Jf,Yf.constants={COLLAPSED_FIELD_NAME:"_TEMP_COLLAPSED_FIELD",COLLAPSED_INPUT_NAME:"_TEMP_COLLAPSED_INPUT"},Yf.defineBlocksWithJsonArray=E,Yf.dialog=ql,Yf.fieldRegistry=dd,Yf.geras=Tf,Yf.getMainWorkspace=f,Yf.getSelected=_,Yf.hasBubble=_i,Yf.hideChaff=Ro,Yf.icons=Dd,Yf.inject=Eo,Yf.inputTypes=Po.inputTypes$$module$build$src$core$inputs$input_types,Yf.inputs=uf,Yf.isCopyable=Ms,Yf.isIcon=No,Yf.isObservable=Ri,Yf.isPaster=Do,Yf.isSerializable=nn,Yf.isVariableBackedParameterModel=nt,Yf.minimalist=Cf,Yf.procedures=Nd,Yf.registry=Vo,Yf.renderManagement=pc,Yf.serialization=ph,Yf.setLocale=Hl,Yf.setParentContainer=b,Yf.svgResize=v,Yf.thrasos=wf,Yf.uiPosition=Ml,Yf.utils=kd,Yf.zelos=Kh,Object.defineProperties(Yf,{HSV_SATURATION:{get:function(){return ne("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.getHsvSaturation()"),gi()},set:function(e){ne("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.setHsvSaturation()"),yi(e)}},HSV_VALUE:{get:function(){return ne("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.getHsvValue()"),bi()},set:function(e){ne("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.setHsvValue()"),vi(e)}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:Gl}),Yf.__namespace__=Po,Yf}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],150:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./blocks_compressed"],i):"object"==typeof n?t.exports=e("./blocks_compressed"):r.BlocklyBlocks=r.BlocklyBlocks}(this,(function(e){return e}))},{"./blocks_compressed":151}],151:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],i):"object"==typeof n?t.exports=i(e("./blockly_compressed.js")):r.Blockly.libraryBlocks=i(r.Blockly)}(this,(function(e){var t=e.__namespace__,n=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),r={customContextMenu:function(e){if(this.isInFlyout)"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(r={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:i(this)},o=this.getField("VAR").getText(),o={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",o),enabled:!0,callback:s(this)},e.unshift(r),e.unshift(o));else{if("variables_get_dynamic"===this.type)var n="variables_set_dynamic",r=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get_dynamic",r=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var o=this.getField("VAR");n={type:n,fields:{VAR:o.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:r.replace("%1",o.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}},onchange:function(e){e=this.getFieldValue("VAR"),e=t.getVariable$$module$build$src$core$variables(this.workspace,e),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(e.type):this.getInput("VALUE").connection.setCheck(e.type)}},i=function(e){return function(){const n=e.workspace,r=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,r)}},s=function(e){return function(){const t=e.workspace,n=e.getField("VAR").getVariable();t.deleteVariableById(n.getId()),t.refreshToolboxSelection()}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",r),t.defineBlocks$$module$build$src$core$common(n);var o={blocks:n},a=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),l={customContextMenu:function(e){if(this.isInFlyout)"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(r={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:c(this)},i=this.getField("VAR").getText(),i={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",i),enabled:!0,callback:u(this)},e.unshift(r),e.unshift(i));else{if("variables_get"===this.type)var n="variables_set",r=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else n="variables_get",r=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var i=this.getField("VAR");n={type:n,fields:{VAR:i.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:r.replace("%1",i.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}},c=function(e){return function(){const n=e.workspace,r=e.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(n,r)}},u=function(e){return function(){const t=e.workspace,n=e.getField("VAR").getVariable();t.deleteVariableById(n.getId()),t.refreshToolboxSelection()}};t.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",l),t.defineBlocks$$module$build$src$core$common(a);var d={blocks:a},p=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:""},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),h={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",`${n}`),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",`${n}`),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const r=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});r.setValidator((function(t){const r="FROM_START"===t||"FROM_END"===t;if(r!==n){const n=this.getSourceBlock();return n.updateAt_(e,r),n.setFieldValue(t,"WHERE"+e),null}})),this.getInput("AT"+e).appendField(r,"WHERE"+e),1===e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};p.text_getSubstring=h,p.text_changeCase={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},p.text_trim={init:function(){const e=[[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},p.text_print={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var f={updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}};p.text_prompt_ext=Object.assign({},f,{init:function(){var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((e=>{this.updateType_(e)})),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});var m=Object.assign({},f,{init:function(){this.mixin(_);var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((e=>{this.updateType_(e)})),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER))}});p.text_prompt=m,p.text_count={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},p.text_replace={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},p.text_reverse={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var _={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(e){for(let t,n=0;t=this.inputList[n];n++)for(let n,r=0;n=t.fieldRow[r];r++)if(e===n.name)return t.insertFieldAt(r,this.newQuote_(!0)),void t.insertFieldAt(r+2,this.newQuote_(!1));console.warn('field named "'+e+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,t.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"":""})}},g={itemCount_:0,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",`${this.itemCount_}`),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("text_create_join_container");t.initSvg();let n=t.getInput("STACK").connection;for(let t=0;t<this.itemCount_;t++){const t=e.newBlock("text_create_join_item");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&-1===e.indexOf(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);e.valueConnection_=n&&n.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}};t.register$$module$build$src$core$extensions("text_append_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var y={isAt_:!1,mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at",`${this.isAt_}`),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}};t.register$$module$build$src$core$extensions("text_indexOf_tooltip",(function(){this.setTooltip((()=>t.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))})),t.register$$module$build$src$core$extensions("text_quotes",(function(){this.mixin(_),this.quoteField_("TEXT")})),t.registerMixin$$module$build$src$core$extensions("quote_image_mixin",_),t.registerMutator$$module$build$src$core$extensions("text_join_mutator",g,(function(){this.mixin(_),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))})),t.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",y,(function(){this.getField("WHERE").setValidator((function(e){e="FROM_START"===e||"FROM_END"===e;const t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)})),this.updateAt_(!0),this.setTooltip((()=>{var e=this.getFieldValue("WHERE");let n=t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===e||"FROM_END"===e)&&(e="FROM_START"===e?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(n+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),n}))})),t.defineBlocks$$module$build$src$core$common(p);var b={blocks:p},v={},T={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=t.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{t.enable$$module$build$src$core$events$utils()}},mutationToDom:function(e){const n=t.createElement$$module$build$src$core$utils$xml("mutation");e&&n.setAttribute("name",this.getFieldValue("NAME"));for(let r=0;r<this.argumentVarModels_.length;r++){const i=t.createElement$$module$build$src$core$utils$xml("arg"),s=this.argumentVarModels_[r];i.setAttribute("name",s.name),i.setAttribute("varid",s.getId()),e&&this.paramIds_&&i.setAttribute("paramId",this.paramIds_[r]),n.appendChild(i)}return this.hasStatements_||n.setAttribute("statements","false"),n},domToMutation:function(e){this.arguments_=[],this.argumentVarModels_=[];for(let r,i=0;r=e.childNodes[i];i++)if("arg"===r.nodeName.toLowerCase()){var n=r;const e=n.getAttribute("name");n=n.getAttribute("varid")||n.getAttribute("varId"),this.arguments_.push(e),null!==(n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n,e,""))?this.argumentVarModels_.push(n):console.log(`Failed to create a variable named "${e}", ignoring.`)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==e.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const e=Object.create(null);if(this.argumentVarModels_.length){e.params=[];for(let t=0;t<this.argumentVarModels_.length;t++)e.params.push({name:this.argumentVarModels_[t].name,id:this.argumentVarModels_[t].getId()})}return this.hasStatements_||(e.hasStatements=!1),e},loadExtraState:function(e){if(this.arguments_=[],this.argumentVarModels_=[],e.params)for(let r=0;r<e.params.length;r++){var n=e.params[r];n=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,n.id,n.name,""),this.arguments_.push(n.name),this.argumentVarModels_.push(n)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==e.hasStatements)},decompose:function(e){const n=t.createElement$$module$build$src$core$utils$xml("block");n.setAttribute("type","procedures_mutatorcontainer");var r=t.createElement$$module$build$src$core$utils$xml("statement");r.setAttribute("name","STACK"),n.appendChild(r);for(let e=0;e<this.arguments_.length;e++){const n=t.createElement$$module$build$src$core$utils$xml("block");n.setAttribute("type","procedures_mutatorarg");var i=t.createElement$$module$build$src$core$utils$xml("field");i.setAttribute("name","NAME");const s=t.createTextNode$$module$build$src$core$utils$xml(this.arguments_[e]);i.appendChild(s),n.appendChild(i),i=t.createElement$$module$build$src$core$utils$xml("next"),n.appendChild(i),r.appendChild(n),r=i}return e=t.domToBlock$$module$build$src$core$xml(n,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),t.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let n=e.getInputTargetBlock("STACK");for(;n&&!n.isInsertionMarker();){var r=n.getFieldValue("NAME");this.arguments_.push(r),r=this.workspace.getVariable(r,""),this.argumentVarModels_.push(r),this.paramIds_.push(n.id),n=n.nextConnection&&n.nextConnection.targetBlock()}if(this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&(e="TRUE"===e,this.hasStatements_!==e))if(e){var i;this.setStatements_(!0),null==(i=this.statementConnection_)||i.reconnect(this,"STACK"),this.statementConnection_=null}else i=this.getInput("STACK").connection,(this.statementConnection_=i.targetConnection)&&((i=i.targetBlock()).unplug(),i.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(e,n){var r=this.workspace.getVariableById(e);if(""===r.type){r=r.name,n=this.workspace.getVariableById(n);var i=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e&&(this.arguments_[t]=n.name,this.argumentVarModels_[t]=n,i=!0);i&&(this.displayRenamedVar_(r,n.name),t.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(e){const n=e.name;let r,i=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e.getId()&&(r=this.arguments_[t],this.arguments_[t]=n,i=!0);i&&(this.displayRenamedVar_(r,n),t.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(e,n){this.updateParams_();var r=this.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(r&&r.bubbleIsVisible()){r=r.getWorkspace().getAllBlocks(!1);for(let i,s=0;i=r[s];s++)"procedures_mutatorarg"===i.type&&t.Names$$module$build$src$core$names.equals(e,i.getFieldValue("NAME"))&&i.setFieldValue(n,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var n=this.getFieldValue("NAME"),r={type:this.callType_,extraState:{name:n,params:this.arguments_}};if(e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",n),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,r)}),!this.isCollapsed())for(n=0;n<this.argumentVarModels_.length;n++){const i={type:"variables_get",fields:{VAR:{name:(r=this.argumentVarModels_[n]).name,id:r.getId(),type:r.type}}};e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",r.name),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,i)})}}}};v.procedures_defnoreturn=Object.assign({},T,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),v.procedures_defreturn=Object.assign({},T,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.Align$$module$build$src$core$inputs$input.RIGHT).appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var k={init:function(){this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};v.procedures_mutatorcontainer=k;var E={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:t.DEFAULT_ARG$$module$build$src$core$procedures});e.setValidator(this.validator_),e.oldShowEditorFn_=e.showEditor_,e.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,e.onFinishEditing_=this.deleteIntermediateVars_,e.createdVariables_=[],e.onFinishEditing_("x")},validator_:function(e){var t=this.getSourceBlock();const n=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;const r=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),i=e.toLowerCase();for(let e=0;e<r.length;e++){if(r[e].id===this.getSourceBlock().id)continue;const t=r[e].getFieldValue("NAME");if(t&&t.toLowerCase()===i)return null}return t.isInFlyout||((t=n.getVariable(e,""))&&t.name!==e&&n.renameVariableById(t.getId(),e),t||(t=n.createVariable(e,""))&&this.createdVariables_&&this.createdVariables_.push(t)),e},deleteIntermediateVars_:function(e){const t=this.getSourceBlock().workspace.getRootWorkspace();if(t)for(let n=0;n<this.createdVariables_.length;n++){const r=this.createdVariables_[n];r.name!==e&&t.deleteVariableById(r.getId())}}};v.procedures_mutatorarg=E;var x={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,n){t.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(n,"NAME"),this.setTooltip((this.outputConnection?t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",n)))},setProcedureParameters_:function(e,n){var r=t.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((r=(r=r&&r.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&r.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=n;else{if(n.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var i=this.getInput("ARG"+e);i&&(i=i.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=i,r&&i&&-1===n.indexOf(this.quarkIds_[e])&&(i.disconnect(),i.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)r=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(r);if(this.updateShape_(),this.quarkIds_=n)for(n=0;n<this.arguments_.length;n++)if((e=this.quarkIds_[n])in this.quarkConnections_){let t;null!=(t=this.quarkConnections_[e])&&t.reconnect(this,"ARG"+n)||delete this.quarkConnections_[e]}}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var n=this.getField("ARGNAME"+e);if(n){t.disable$$module$build$src$core$events$utils();try{n.setValue(this.arguments_[e])}finally{t.enable$$module$build$src$core$events$utils()}}else n=t.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(t.Align$$module$build$src$core$inputs$input.RIGHT).appendField(n,"ARGNAME"+e).init()}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(e.appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),e.init()):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("name",this.getProcedureCall());for(let n=0;n<this.arguments_.length;n++){const r=t.createElement$$module$build$src$core$utils$xml("arg");r.setAttribute("name",this.arguments_[n]),e.appendChild(r)}return e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t),t=[];const n=[];for(let r,i=0;r=e.childNodes[i];i++)"arg"===r.nodeName.toLowerCase()&&(t.push(r.getAttribute("name")),n.push(r.getAttribute("paramId")));this.setProcedureParameters_(t,n)},saveExtraState:function(){const e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){if(this.renameProcedure(this.getProcedureCall(),e.name),e=e.params){const t=[];t.length=e.length,t.fill(null),this.setProcedureParameters_(e,t)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===t.CREATE$$module$build$src$core$events$utils&&-1!==e.ids.indexOf(this.id)){var n=this.getProcedureCall();if(!(n=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))||n.type===this.defType_&&JSON.stringify(n.getVars())===JSON.stringify(this.arguments_)||(n=null),!n){t.setGroup$$module$build$src$core$events$utils(e.group),e=t.createElement$$module$build$src$core$utils$xml("xml"),(n=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var r=this.getRelativeToSurfaceXY(),i=r.y+2*t.config$$module$build$src$core$config.snapRadius;n.setAttribute("x",`${r.x+t.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),n.setAttribute("y",`${i}`),r=this.mutationToDom(),n.appendChild(r),(r=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),i=this.getProcedureCall();const s=t.findLegalName$$module$build$src$core$procedures(i,this);i!==s&&this.renameProcedure(i,s),r.appendChild(t.createTextNode$$module$build$src$core$utils$xml(i)),n.appendChild(r),e.appendChild(n),t.domToWorkspace$$module$build$src$core$xml(e,this.workspace),t.setGroup$$module$build$src$core$events$utils(!1)}}else e.type===t.DELETE$$module$build$src$core$events$utils?(n=this.getProcedureCall(),t.getDefinition$$module$build$src$core$procedures(n,this.workspace)||(t.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),t.setGroup$$module$build$src$core$events$utils(!1))):e.type===t.CHANGE$$module$build$src$core$events$utils&&"disabled"===e.element&&(n=this.getProcedureCall(),(n=t.getDefinition$$module$build$src$core$procedures(n,this.workspace))&&n.id===e.blockId&&((n=t.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),t.setGroup$$module$build$src$core$events$utils(e.group),e.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),t.setGroup$$module$build$src$core$events$utils(n)))},customContextMenu:function(e){if(this.workspace.isMovable()){var n=this.getProcedureCall(),r=this.workspace;e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const e=t.getDefinition$$module$build$src$core$procedures(n,r);e&&(r.centerOnBlock(e.id),e.select())}})}}};v.procedures_callnoreturn=Object.assign({},x,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),v.procedures_callreturn=Object.assign({},x,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"});var S={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==t.MOVE$$module$build$src$core$events$utils)){var n=!1,r=this;do{if(-1!==this.FUNCTION_TYPES.indexOf(r.type)){n=!0;break}r=r.getSurroundParent()}while(r);n?("procedures_defnoreturn"===r.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==r.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(r=t.getGroup$$module$build$src$core$events$utils(),t.setGroup$$module$build$src$core$events$utils(e.group),this.setEnabled(n),t.setGroup$$module$build$src$core$events$utils(r))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};v.procedures_ifreturn=S,t.defineBlocks$$module$build$src$core$common(v);var C={blocks:v},I=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);t.register$$module$build$src$core$extensions("math_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"}));var A={mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(n)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){const t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}};t.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",A,(function(){this.getField("PROPERTY").setValidator((function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)}))})),t.register$$module$build$src$core$extensions("math_change_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var w={updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(e)}};t.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",w,(function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))})),t.defineBlocks$$module$build$src$core$common(I);var N={blocks:I},D=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);t.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),t.register$$module$build$src$core$extensions("controls_flow_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"}));var O={customContextMenu:function(e){if(!this.isInFlyout){var n=this.getField("VAR"),r=n.getVariable().name;this.isCollapsed()||null===r||(n={type:"variables_get",fields:{VAR:n.saveState(!0)}},e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",r),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,n)}))}}};t.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",O),t.register$$module$build$src$core$extensions("controls_for_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.register$$module$build$src$core$extensions("controls_forEach_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var R=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),L={getSurroundLoop:function(){let e=this;do{if(R.has(e.type))return e;e=e.getSurroundParent()}while(e);return null},onchange:function(e){var n=this.workspace;if(n.isDragging&&!n.isDragging()&&e.type===t.MOVE$$module$build$src$core$events$utils&&(n=!!this.getSurroundLoop(),this.setWarningText(n?null:t.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout)){const r=t.getGroup$$module$build$src$core$events$utils();t.setGroup$$module$build$src$core$events$utils(e.group),this.setEnabled(n),t.setGroup$$module$build$src$core$events$utils(r)}}};t.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",L),t.defineBlocks$$module$build$src$core$common(D);var P={blocks:D,loopTypes:R},M=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);t.register$$module$build$src$core$extensions("logic_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"}));var F={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=t.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const e=Object.create(null);return this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=e.hasElse?1:0,this.updateShape_()},decompose:function(e){const t=e.newBlock("controls_if_if");t.initSvg();let n=t.nextConnection;for(let t=1;t<=this.elseifCount_;t++){const t=e.newBlock("controls_if_elseif");t.initSvg(),n.connect(t.previousConnection),n=t.nextConnection}return this.elseCount_&&((e=e.newBlock("controls_if_else")).initSvg(),n.connect(e.previousConnection)),t},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const t=[null],n=[null];let r=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),n.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,r=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,n,r)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var n=this.getInput("IF"+t);const r=this.getInput("DO"+t);e.valueConnection_=n&&n.connection.targetConnection,e.statementConnection_=r&&r.connection.targetConnection,t++;break;case"controls_if_else":n=this.getInput("ELSE"),e.statementConnection_=n&&n.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){const e=[null],t=[null];let n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);for(let n=1;this.getInput("IF"+n);n++){const r=this.getInput("IF"+n),i=this.getInput("DO"+n);e.push(r.connection.targetConnection),t.push(i.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(e,t,n)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(e,t,n){for(let n=1;n<=this.elseifCount_;n++){let r,i;null==(r=e[n])||r.reconnect(this,"IF"+n),null==(i=t[n])||i.reconnect(this,"DO"+n)}null==n||n.reconnect(this,"ELSE")}};t.registerMutator$$module$build$src$core$extensions("controls_if_mutator",F,null,["controls_if_elseif","controls_if_else"]),t.register$$module$build$src$core$extensions("controls_if_tooltip",(function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))}));var $={onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var n=this.getInputTargetBlock("A");const r=this.getInputTargetBlock("B");n&&r&&!this.workspace.connectionChecker.doTypeChecks(n.outputConnection,r.outputConnection)&&(t.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==n&&(n.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(n=this.prevBlocks_[1])!==r&&(r.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("B").connection.connect(n.outputConnection)),this.bumpNeighbours(),t.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};t.register$$module$build$src$core$extensions("logic_compare",(function(){this.mixin($)}));var B={prevParentConnection_:null,onchange:function(e){const n=this.getInputTargetBlock("THEN"),r=this.getInputTargetBlock("ELSE"),i=this.outputConnection.targetConnection;if((n||r)&&i)for(let s=0;2>s;s++){const o=1===s?n:r;o&&!o.workspace.connectionChecker.doTypeChecks(o.outputConnection,i)&&(t.setGroup$$module$build$src$core$events$utils(e.group),i===this.prevParentConnection_?(this.unplug(),i.getSourceBlock().bumpNeighbours()):(o.unplug(),o.bumpNeighbours()),t.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=i}};t.registerMixin$$module$build$src$core$extensions("logic_ternary",B),t.defineBlocks$$module$build$src$core$common(M);var U=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),V={init:function(){this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){const t=e.newBlock("lists_create_with_container");t.initSvg();let n=t.getInput("STACK").connection;for(let t=0;t<this.itemCount_;t++){const t=e.newBlock("lists_create_with_item");if(t.initSvg(),!t.previousConnection)throw Error("itemBlock has no previousConnection");n.connect(t.previousConnection),n=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){const n=this.getInput("ADD"+t).connection.targetConnection;n&&-1===e.indexOf(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let n;null==(n=e[t])||n.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}const n=this.getInput("ADD"+t);let r;e.valueConnection_=null==(r=n)?void 0:r.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){const n=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&n.appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}};U.lists_create_with=V;var H={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};U.lists_create_with_container=H;var G={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};U.lists_create_with_item=G;var j={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip((()=>t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1")))}};U.lists_indexOf=j;var K={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator((function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)})),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip((()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let r="";switch(e+" "+n){case"GET FROM_START":case"GET FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(r+="  "+("FROM_START"===n?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),r}))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("statement",String(!this.outputConnection));const n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"==typeof e&&this.domToMutation(t.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});n.setValidator((function(t){const n="FROM_START"===t||"FROM_END"===t;if(n!==e){const e=this.getSourceBlock();return e.updateAt_(n),e.setFieldValue(t,"WHERE"),null}})),this.getInput("AT").appendField(n,"WHERE"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};U.lists_getIndex=K;var W={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip((()=>{const e=this.getFieldValue("MODE"),n=this.getFieldValue("WHERE");let r="";switch(e+" "+n){case"SET FROM_START":case"SET FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":r=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==n&&"FROM_END"!==n||(r+="  "+t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),r}))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation"),n=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(n)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const n=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});n.setValidator((function(t){const n="FROM_START"===t||"FROM_END"===t;if(n!==e){const e=this.getSourceBlock();return e.updateAt_(n),e.setFieldValue(t,"WHERE"),null}})),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(n,"WHERE")}};U.lists_setIndex=W;var z={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");var n=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(n)),n=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(n)),e},domToMutation:function(e){const t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,n){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),n?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e);const r=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});r.setValidator((function(t){const r="FROM_START"===t||"FROM_END"===t;if(r!==n){const n=this.getSourceBlock();return n.updateAt_(e,r),n.setFieldValue(t,"WHERE"+e),null}})),this.getInput("AT"+e).appendField(r,"WHERE"+e),1===e&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};U.lists_getSublist=z,U.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},U.lists_split={init:function(){const e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator((e=>{this.updateType_(e)})),this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((()=>{const e=this.getFieldValue("MODE");if("SPLIT"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)}))},updateType_:function(e){if(this.getFieldValue("MODE")!==e){const e=this.getInput("INPUT").connection;e.setShadowDom(null);const t=e.targetBlock();t&&(e.disconnect(),t.isShadow()?t.dispose(!1):this.bumpNeighbours())}"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},t.defineBlocks$$module$build$src$core$common(U);var q={blocks:U},J=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]);t.defineBlocks$$module$build$src$core$common(J);var Y={blocks:J},X={blocks:Object.assign({},J,U,M,D,I,v,a,n),colour:Y,lists:q,loops:P,math:N,procedures:C,texts:b,variables:d,variablesDynamic:o};return X.__namespace__=t,X}))},{"./blockly_compressed.js":149}],152:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./core-browser","./msg/en","./blocks","./javascript"],i):"object"==typeof n?t.exports=i(e("./core-browser"),e("./msg/en"),e("./blocks"),e("./javascript")):r.Blockly=i(r.Blockly,r.En,r.BlocklyBlocks,r.BlocklyJS)}(this,(function(e,t,n,r){return e.setLocale(t),e}))},{"./blocks":150,"./core-browser":153,"./javascript":155,"./msg/en":157}],153:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./blockly"],i):"object"==typeof n?t.exports=i(e("./blockly")):r.Blockly=i(r.Blockly)}(this,(function(e){return e}))},{"./blockly":148}],154:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./browser"],i):"object"==typeof n?t.exports=e("./node"):r.Blockly=r.Blockly}(this,(function(e){return e}))},{"./node":152}],155:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./core","./javascript_compressed.js"],i):"object"==typeof n?t.exports=i(e("./core"),e("./javascript_compressed.js")):r.BlocklyJavaScript=i(r.Blockly,r.BlocklyJavaScript)}(this,(function(e,t){return t}))},{"./core":153,"./javascript_compressed.js":156}],156:[function(e,t,n){!function(r,i){"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],i):"object"==typeof n?t.exports=i(e("./blockly_compressed.js")):(r.javascript=i(r.Blockly),r.Blockly.JavaScript=r.javascript.javascriptGenerator)}(this,(function(e){var t,n,r=e.__namespace__,i=function(e,n){var r=0;let i="";n.STATEMENT_PREFIX&&(i+=n.injectId(n.STATEMENT_PREFIX,e));do{const s=n.valueToCode(e,"IF"+r,t.NONE)||"false";let o=n.statementToCode(e,"DO"+r);n.STATEMENT_SUFFIX&&(o=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)+o),i+=(0<r?" else ":"")+"if ("+s+") {\n"+o+"}",r++}while(e.getInput("IF"+r));return(e.getInput("ELSE")||n.STATEMENT_SUFFIX)&&(r=n.statementToCode(e,"ELSE"),n.STATEMENT_SUFFIX&&(r=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)+r),i+=" else {\n"+r+"}"),i+"\n"},s=function(e,n){let i;i=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):n.valueToCode(e,"TIMES",t.ASSIGNMENT)||"0";let s=n.statementToCode(e,"DO");s=n.addLoopTrap(s,e),e="";const o=n.nameDB_.getDistinctName("count",r.NameType$$module$build$src$core$names.VARIABLE);let a=i;return i.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(i)||(e+="var "+(a=n.nameDB_.getDistinctName("repeat_end",r.NameType$$module$build$src$core$names.VARIABLE))+" = "+i+";\n"),e+"for (var "+o+" = 0; "+o+" < "+a+"; "+o+"++) {\n"+s+"}\n"},o=function(e,n){const r=e.getFieldValue("OP");let i;if("NEG"===r)return"-"===(e=n.valueToCode(e,"NUM",t.UNARY_NEGATION)||"0")[0]&&(e=" "+e),["-"+e,t.UNARY_NEGATION];switch(e="SIN"===r||"COS"===r||"TAN"===r?n.valueToCode(e,"NUM",t.DIVISION)||"0":n.valueToCode(e,"NUM",t.NONE)||"0",r){case"ABS":i="Math.abs("+e+")";break;case"ROOT":i="Math.sqrt("+e+")";break;case"LN":i="Math.log("+e+")";break;case"EXP":i="Math.exp("+e+")";break;case"POW10":i="Math.pow(10,"+e+")";break;case"ROUND":i="Math.round("+e+")";break;case"ROUNDUP":i="Math.ceil("+e+")";break;case"ROUNDDOWN":i="Math.floor("+e+")";break;case"SIN":i="Math.sin("+e+" / 180 * Math.PI)";break;case"COS":i="Math.cos("+e+" / 180 * Math.PI)";break;case"TAN":i="Math.tan("+e+" / 180 * Math.PI)"}if(i)return[i,t.FUNCTION_CALL];switch(r){case"LOG10":i="Math.log("+e+") / Math.log(10)";break;case"ASIN":i="Math.asin("+e+") / Math.PI * 180";break;case"ACOS":i="Math.acos("+e+") / Math.PI * 180";break;case"ATAN":i="Math.atan("+e+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+r)}return[i,t.DIVISION]},a=function(e,n){const r=n.getProcedureName(e.getFieldValue("NAME"));var i="";n.STATEMENT_PREFIX&&(i+=n.injectId(n.STATEMENT_PREFIX,e)),n.STATEMENT_SUFFIX&&(i+=n.injectId(n.STATEMENT_SUFFIX,e)),i&&(i=n.prefixLines(i,n.INDENT));let s="";n.INFINITE_LOOP_TRAP&&(s=n.prefixLines(n.injectId(n.INFINITE_LOOP_TRAP,e),n.INDENT));const o=n.statementToCode(e,"STACK");let a=n.valueToCode(e,"RETURN",t.NONE)||"",l="";o&&a&&(l=i),a&&(a=n.INDENT+"return "+a+";\n");const c=[],u=e.getVars();for(let e=0;e<u.length;e++)c[e]=n.getVariableName(u[e]);return i="function "+r+"("+c.join(", ")+") {\n"+i+s+o+l+a+"}",i=n.scrub_(e,i),n.definitions_["%"+r]=i,null},l=function(e,n){return n="window.prompt("+(e.getField("TEXT")?n.quote_(e.getFieldValue("TEXT")):n.valueToCode(e,"TEXT",t.NONE)||"''")+")","NUMBER"===e.getFieldValue("TYPE")&&(n="Number("+n+")"),[n,t.FUNCTION_CALL]},c=function(e,n){return[n.getVariableName(e.getFieldValue("VAR")),t.ATOMIC]},u=function(e,n){const r=n.valueToCode(e,"VALUE",t.ASSIGNMENT)||"0";return n.getVariableName(e.getFieldValue("VAR"))+" = "+r+";\n"};(n=t||(t={}))[n.ATOMIC=0]="ATOMIC",n[n.NEW=1.1]="NEW",n[n.MEMBER=1.2]="MEMBER",n[n.FUNCTION_CALL=2]="FUNCTION_CALL",n[n.INCREMENT=3]="INCREMENT",n[n.DECREMENT=3]="DECREMENT",n[n.BITWISE_NOT=4.1]="BITWISE_NOT",n[n.UNARY_PLUS=4.2]="UNARY_PLUS",n[n.UNARY_NEGATION=4.3]="UNARY_NEGATION",n[n.LOGICAL_NOT=4.4]="LOGICAL_NOT",n[n.TYPEOF=4.5]="TYPEOF",n[n.VOID=4.6]="VOID",n[n.DELETE=4.7]="DELETE",n[n.AWAIT=4.8]="AWAIT",n[n.EXPONENTIATION=5]="EXPONENTIATION",n[n.MULTIPLICATION=5.1]="MULTIPLICATION",n[n.DIVISION=5.2]="DIVISION",n[n.MODULUS=5.3]="MODULUS",n[n.SUBTRACTION=6.1]="SUBTRACTION",n[n.ADDITION=6.2]="ADDITION",n[n.BITWISE_SHIFT=7]="BITWISE_SHIFT",n[n.RELATIONAL=8]="RELATIONAL",n[n.IN=8]="IN",n[n.INSTANCEOF=8]="INSTANCEOF",n[n.EQUALITY=9]="EQUALITY",n[n.BITWISE_AND=10]="BITWISE_AND",n[n.BITWISE_XOR=11]="BITWISE_XOR",n[n.BITWISE_OR=12]="BITWISE_OR",n[n.LOGICAL_AND=13]="LOGICAL_AND",n[n.LOGICAL_OR=14]="LOGICAL_OR",n[n.CONDITIONAL=15]="CONDITIONAL",n[n.ASSIGNMENT=16]="ASSIGNMENT",n[n.YIELD=17]="YIELD",n[n.COMMA=18]="COMMA",n[n.NONE=99]="NONE";var d=class extends r.CodeGenerator$$module$build$src$core$generator{constructor(e="JavaScript"){super(e),this.ORDER_OVERRIDES=[[t.FUNCTION_CALL,t.MEMBER],[t.FUNCTION_CALL,t.FUNCTION_CALL],[t.MEMBER,t.MEMBER],[t.MEMBER,t.FUNCTION_CALL],[t.LOGICAL_NOT,t.LOGICAL_NOT],[t.MULTIPLICATION,t.MULTIPLICATION],[t.ADDITION,t.ADDITION],[t.LOGICAL_AND,t.LOGICAL_AND],[t.LOGICAL_OR,t.LOGICAL_OR]],this.isInitialized=!1;for(const n in t)"string"!=typeof(e=t[n])&&(this["ORDER_"+n]=e);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(e){super.init(e),this.nameDB_?this.nameDB_.reset():this.nameDB_=new r.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(e.getVariableMap()),this.nameDB_.populateVariables(e),this.nameDB_.populateProcedures(e);const t=[];var n=r.allDeveloperVariables$$module$build$src$core$variables(e);for(let e=0;e<n.length;e++)t.push(this.nameDB_.getName(n[e],r.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(e=r.allUsedVarModels$$module$build$src$core$variables(e),n=0;n<e.length;n++)t.push(this.nameDB_.getName(e[n].getId(),r.NameType$$module$build$src$core$names.VARIABLE));t.length&&(this.definitions_.variables="var "+t.join(", ")+";"),this.isInitialized=!0}finish(e){const t=Object.values(this.definitions_);return super.finish(e),this.isInitialized=!1,this.nameDB_.reset(),t.join("\n\n")+"\n\n\n"+e}scrubNakedValue(e){return e+";\n"}quote_(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"}multiline_quote_(e){return e.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")}scrub_(e,t,n=!1){let i="";if(!e.outputConnection||!e.outputConnection.targetConnection){var s=e.getCommentText();s&&(s=r.wrap$$module$build$src$core$utils$string(s,this.COMMENT_WRAP-3),i+=this.prefixLines(s+"\n","// "));for(let t=0;t<e.inputList.length;t++)e.inputList[t].type===r.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(s=e.inputList[t].connection.targetBlock())&&(s=this.allNestedComments(s))&&(i+=this.prefixLines(s,"// "))}return e=e.nextConnection&&e.nextConnection.targetBlock(),i+t+(n?"":this.blockToCode(e))}getAdjusted(e,n,i=0,s=!1,o=t.NONE){e.workspace.options.oneBasedIndex&&i--;const a=e.workspace.options.oneBasedIndex?"1":"0";let l=o;return 0<i?l=t.ADDITION:0>i?l=t.SUBTRACTION:s&&(l=t.UNARY_NEGATION),e=this.valueToCode(e,n,l)||a,0!==i||s?r.isNumber$$module$build$src$core$utils$string(e)?(e=String(Number(e)+i),s&&(e=String(-Number(e))),e):(0<i?e=`${e} + ${i}`:0>i&&(e=`${e} - ${-i}`),s&&(e=i?`-(${e})`:`-${e}`),Math.floor(o)>=Math.floor(l)&&(e=`(${e})`),e):e}},p={};p.JavascriptGenerator=d,p.Order=t;var h={colour_blend:function(e,n){const r=n.valueToCode(e,"COLOUR1",t.NONE)||"'#000000'",i=n.valueToCode(e,"COLOUR2",t.NONE)||"'#000000'";return e=n.valueToCode(e,"RATIO",t.NONE)||.5,[n.provideFunction_("colourBlend",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {\n  ratio = Math.max(Math.min(Number(ratio), 1), 0);\n  var r1 = parseInt(c1.substring(1, 3), 16);\n  var g1 = parseInt(c1.substring(3, 5), 16);\n  var b1 = parseInt(c1.substring(5, 7), 16);\n  var r2 = parseInt(c2.substring(1, 3), 16);\n  var g2 = parseInt(c2.substring(3, 5), 16);\n  var b2 = parseInt(c2.substring(5, 7), 16);\n  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);\n  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);\n  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);\n  r = ('0' + (r || 0).toString(16)).slice(-2);\n  g = ('0' + (g || 0).toString(16)).slice(-2);\n  b = ('0' + (b || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n`)+"("+r+", "+i+", "+e+")",t.FUNCTION_CALL]},colour_picker:function(e,n){return[n.quote_(e.getFieldValue("COLOUR")),t.ATOMIC]},colour_random:function(e,n){return[n.provideFunction_("colourRandom",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}() {\n  var num = Math.floor(Math.random() * Math.pow(2, 24));\n  return '#' + ('00000' + num.toString(16)).substr(-6);\n}\n`)+"()",t.FUNCTION_CALL]},colour_rgb:function(e,n){const r=n.valueToCode(e,"RED",t.NONE)||0,i=n.valueToCode(e,"GREEN",t.NONE)||0;return e=n.valueToCode(e,"BLUE",t.NONE)||0,[n.provideFunction_("colourRgb",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {\n  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;\n  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;\n  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;\n  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);\n  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);\n  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n`)+"("+r+", "+i+", "+e+")",t.FUNCTION_CALL]}},f=function(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n},m={lists_create_empty:function(e,n){return["[]",t.ATOMIC]},lists_create_with:function(e,n){const r=Array(e.itemCount_);for(let i=0;i<e.itemCount_;i++)r[i]=n.valueToCode(e,"ADD"+i,t.NONE)||"null";return["["+r.join(", ")+"]",t.ATOMIC]},lists_getIndex:function(e,n){const r=e.getFieldValue("MODE")||"GET",i=e.getFieldValue("WHERE")||"FROM_START";var s=n.valueToCode(e,"VALUE","RANDOM"===i?t.NONE:t.MEMBER)||"[]";switch(i){case"FIRST":if("GET"===r)return[s+"[0]",t.MEMBER];if("GET_REMOVE"===r)return[s+".shift()",t.MEMBER];if("REMOVE"===r)return s+".shift();\n";break;case"LAST":if("GET"===r)return[s+".slice(-1)[0]",t.MEMBER];if("GET_REMOVE"===r)return[s+".pop()",t.MEMBER];if("REMOVE"===r)return s+".pop();\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"GET"===r)return[s+"["+e+"]",t.MEMBER];if("GET_REMOVE"===r)return[s+".splice("+e+", 1)[0]",t.FUNCTION_CALL];if("REMOVE"===r)return s+".splice("+e+", 1);\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!0),"GET"===r)return[s+".slice("+e+")[0]",t.FUNCTION_CALL];if("GET_REMOVE"===r)return[s+".splice("+e+", 1)[0]",t.FUNCTION_CALL];if("REMOVE"===r)return s+".splice("+e+", 1);";break;case"RANDOM":if(s=n.provideFunction_("listsGetRandomItem",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {\n  var x = Math.floor(Math.random() * list.length);\n  if (remove) {\n    return list.splice(x, 1)[0];\n  } else {\n    return list[x];\n  }\n}\n`)+"("+s+", "+("GET"!==r)+")","GET"===r||"GET_REMOVE"===r)return[s,t.FUNCTION_CALL];if("REMOVE"===r)return s+";\n"}throw Error("Unhandled combination (lists_getIndex).")},lists_getSublist:function(e,n){var r={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},i=n.valueToCode(e,"LIST",t.MEMBER)||"[]";const s=e.getFieldValue("WHERE1"),o=e.getFieldValue("WHERE2");if("FIRST"===s&&"LAST"===o)i+=".slice(0)";else if(i.match(/^\w+$/)||"FROM_END"!==s&&"FROM_START"===o){switch(s){case"FROM_START":r=n.getAdjusted(e,"AT1");break;case"FROM_END":r=i+".length - "+(r=n.getAdjusted(e,"AT1",1,!1,t.SUBTRACTION));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(o){case"FROM_START":n=n.getAdjusted(e,"AT2",1);break;case"FROM_END":n=i+".length - "+(n=n.getAdjusted(e,"AT2",0,!1,t.SUBTRACTION));break;case"LAST":n=i+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}i=i+".slice("+r+", "+n+")"}else{const t=n.getAdjusted(e,"AT1");e=n.getAdjusted(e,"AT2"),i=n.provideFunction_("subsequence"+r[s]+r[o],`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(sequence${"FROM_END"===s||"FROM_START"===s?", at1":""}${"FROM_END"===o||"FROM_START"===o?", at2":""}) {\n  var start = ${f("sequence",s,"at1")};\n  var end = ${f("sequence",o,"at2")} + 1;\n  return sequence.slice(start, end);\n}\n`)+"("+i+("FROM_END"===s||"FROM_START"===s?", "+t:"")+("FROM_END"===o||"FROM_START"===o?", "+e:"")+")"}return[i,t.FUNCTION_CALL]},lists_indexOf:function(e,n){const r="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.valueToCode(e,"FIND",t.NONE)||"''";return n=(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+"."+r+"("+i+")",e.workspace.options.oneBasedIndex?[n+" + 1",t.ADDITION]:[n,t.FUNCTION_CALL]},lists_isEmpty:function(e,n){return["!"+(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+".length",t.LOGICAL_NOT]},lists_length:function(e,n){return[(n.valueToCode(e,"VALUE",t.MEMBER)||"[]")+".length",t.MEMBER]},lists_repeat:function(e,n){return[n.provideFunction_("listsRepeat",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(value, n) {\n  var array = [];\n  for (var i = 0; i < n; i++) {\n    array[i] = value;\n  }\n  return array;\n}\n`)+"("+(n.valueToCode(e,"ITEM",t.NONE)||"null")+", "+(e=n.valueToCode(e,"NUM",t.NONE)||"0")+")",t.FUNCTION_CALL]},lists_reverse:function(e,n){return[(n.valueToCode(e,"LIST",t.FUNCTION_CALL)||"[]")+".slice().reverse()",t.FUNCTION_CALL]},lists_setIndex:function(e,n){function i(){if(s.match(/^\w+$/))return"";const e=n.nameDB_.getDistinctName("tmpList",r.NameType$$module$build$src$core$names.VARIABLE),t="var "+e+" = "+s+";\n";return s=e,t}let s=n.valueToCode(e,"LIST",t.MEMBER)||"[]";const o=e.getFieldValue("MODE")||"GET";var a=e.getFieldValue("WHERE")||"FROM_START";const l=n.valueToCode(e,"TO",t.ASSIGNMENT)||"null";switch(a){case"FIRST":if("SET"===o)return s+"[0] = "+l+";\n";if("INSERT"===o)return s+".unshift("+l+");\n";break;case"LAST":if("SET"===o)return i()+(s+"[")+s+".length - 1] = "+l+";\n";if("INSERT"===o)return s+".push("+l+");\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"SET"===o)return s+"["+e+"] = "+l+";\n";if("INSERT"===o)return s+".splice("+e+", 0, "+l+");\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!1,t.SUBTRACTION),a=i(),"SET"===o)return a+(s+"[")+s+".length - "+e+"] = "+l+";\n";if("INSERT"===o)return a+(s+".splice(")+s+".length - "+e+", 0, "+l+");\n";break;case"RANDOM":if(e=i(),e+="var "+(a=n.nameDB_.getDistinctName("tmpX",r.NameType$$module$build$src$core$names.VARIABLE))+" = Math.floor(Math.random() * "+s+".length);\n","SET"===o)return e+(s+"[")+a+"] = "+l+";\n";if("INSERT"===o)return e+(s+".splice(")+a+", 0, "+l+");\n"}throw Error("Unhandled combination (lists_setIndex).")},lists_sort:function(e,n){const r=n.valueToCode(e,"LIST",t.FUNCTION_CALL)||"[]",i="1"===e.getFieldValue("DIRECTION")?1:-1;return e=e.getFieldValue("TYPE"),[r+".slice().sort("+(n=n.provideFunction_("listsGetSortCompare",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {\n  var compareFuncs = {\n    'NUMERIC': function(a, b) {\n        return Number(a) - Number(b); },\n    'TEXT': function(a, b) {\n        return String(a) > String(b) ? 1 : -1; },\n    'IGNORE_CASE': function(a, b) {\n        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },\n  };\n  var compare = compareFuncs[type];\n  return function(a, b) { return compare(a, b) * direction; };\n}\n      `))+'("'+e+'", '+i+"))",t.FUNCTION_CALL]},lists_split:function(e,n){let r=n.valueToCode(e,"INPUT",t.MEMBER);if(n=n.valueToCode(e,"DELIM",t.NONE)||"''","SPLIT"===(e=e.getFieldValue("MODE")))r||(r="''"),e="split";else{if("JOIN"!==e)throw Error("Unknown mode: "+e);r||(r="[]"),e="join"}return[r+"."+e+"("+n+")",t.FUNCTION_CALL]}},_={};_.controls_if=i,_.controls_ifelse=i,_.logic_boolean=function(e,n){return["TRUE"===e.getFieldValue("BOOL")?"true":"false",t.ATOMIC]},_.logic_compare=function(e,n){const r={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],i="=="===r||"!="===r?t.EQUALITY:t.RELATIONAL;return[(n.valueToCode(e,"A",i)||"0")+" "+r+" "+(e=n.valueToCode(e,"B",i)||"0"),i]},_.logic_negate=function(e,n){const r=t.LOGICAL_NOT;return["!"+(n.valueToCode(e,"BOOL",r)||"true"),r]},_.logic_null=function(e,n){return["null",t.ATOMIC]},_.logic_operation=function(e,n){const r="AND"===e.getFieldValue("OP")?"&&":"||",i="&&"===r?t.LOGICAL_AND:t.LOGICAL_OR;let s=n.valueToCode(e,"A",i);return e=n.valueToCode(e,"B",i),s||e?(n="&&"===r?"true":"false",s||(s=n),e||(e=n)):e=s="false",[s+" "+r+" "+e,i]},_.logic_ternary=function(e,n){return[(n.valueToCode(e,"IF",t.CONDITIONAL)||"false")+" ? "+(n.valueToCode(e,"THEN",t.CONDITIONAL)||"null")+" : "+(e=n.valueToCode(e,"ELSE",t.CONDITIONAL)||"null"),t.CONDITIONAL]};var g={controls_flow_statements:function(e,t){let n="";if(t.STATEMENT_PREFIX&&(n+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(n+=t.injectId(t.STATEMENT_SUFFIX,e)),t.STATEMENT_PREFIX){const r=e.getSurroundLoop();r&&!r.suppressPrefixSuffix&&(n+=t.injectId(t.STATEMENT_PREFIX,r))}switch(e.getFieldValue("FLOW")){case"BREAK":return n+"break;\n";case"CONTINUE":return n+"continue;\n"}throw Error("Unknown flow statement.")},controls_for:function(e,n){var i=n.getVariableName(e.getFieldValue("VAR")),s=n.valueToCode(e,"FROM",t.ASSIGNMENT)||"0",o=n.valueToCode(e,"TO",t.ASSIGNMENT)||"0";const a=n.valueToCode(e,"BY",t.ASSIGNMENT)||"1";let l=n.statementToCode(e,"DO");if(l=n.addLoopTrap(l,e),r.isNumber$$module$build$src$core$utils$string(s)&&r.isNumber$$module$build$src$core$utils$string(o)&&r.isNumber$$module$build$src$core$utils$string(a))e="for ("+i+" = "+s+"; "+i+((n=Number(s)<=Number(o))?" <= ":" >= ")+o+"; "+i,e=1===(i=Math.abs(Number(a)))?e+(n?"++":"--"):e+(n?" += ":" -= ")+i,e+=") {\n"+l+"}\n";else{e="";let t=s;s.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(s)||(e+="var "+(t=n.nameDB_.getDistinctName(i+"_start",r.NameType$$module$build$src$core$names.VARIABLE))+" = "+s+";\n"),s=o,o.match(/^\w+$/)||r.isNumber$$module$build$src$core$utils$string(o)||(e+="var "+(s=n.nameDB_.getDistinctName(i+"_end",r.NameType$$module$build$src$core$names.VARIABLE))+" = "+o+";\n"),e+="var "+(o=n.nameDB_.getDistinctName(i+"_inc",r.NameType$$module$build$src$core$names.VARIABLE))+" = ",e=r.isNumber$$module$build$src$core$utils$string(a)?e+(Math.abs(Number(a))+";\n"):e+"Math.abs("+a+");\n",e+="if ("+t+" > "+s+") {\n",e=(e+=n.INDENT+o+" = -"+o+";\n")+"}\nfor ("+i+" = "+t+"; "+o+" >= 0 ? "+i+" <= "+s+" : "+i+" >= "+s+"; "+i+" += "+o+") {\n"+l+"}\n"}return e},controls_forEach:function(e,n){const i=n.getVariableName(e.getFieldValue("VAR"));var s=n.valueToCode(e,"LIST",t.ASSIGNMENT)||"[]";let o=n.statementToCode(e,"DO");o=n.addLoopTrap(o,e),e="";let a=s;return s.match(/^\w+$/)||(e+="var "+(a=n.nameDB_.getDistinctName(i+"_list",r.NameType$$module$build$src$core$names.VARIABLE))+" = "+s+";\n"),e+"for (var "+(s=n.nameDB_.getDistinctName(i+"_index",r.NameType$$module$build$src$core$names.VARIABLE))+" in "+a+") {\n"+(o=n.INDENT+i+" = "+a+"["+s+"];\n"+o)+"}\n"}};g.controls_repeat=s,g.controls_repeat_ext=s,g.controls_whileUntil=function(e,n){const r="UNTIL"===e.getFieldValue("MODE");let i=n.valueToCode(e,"BOOL",r?t.LOGICAL_NOT:t.NONE)||"false",s=n.statementToCode(e,"DO");return r&&(i="!"+i),"while ("+i+") {\n"+(s=n.addLoopTrap(s,e))+"}\n"};var y={math_arithmetic:function(e,n){var r={ADD:[" + ",t.ADDITION],MINUS:[" - ",t.SUBTRACTION],MULTIPLY:[" * ",t.MULTIPLICATION],DIVIDE:[" / ",t.DIVISION],POWER:[null,t.NONE]}[e.getFieldValue("OP")];const i=r[0];r=r[1];const s=n.valueToCode(e,"A",r)||"0";return e=n.valueToCode(e,"B",r)||"0",i?[s+i+e,r]:["Math.pow("+s+", "+e+")",t.FUNCTION_CALL]},math_atan2:function(e,n){const r=n.valueToCode(e,"X",t.NONE)||"0";return["Math.atan2("+(n.valueToCode(e,"Y",t.NONE)||"0")+", "+r+") / Math.PI * 180",t.DIVISION]},math_change:function(e,n){const r=n.valueToCode(e,"DELTA",t.ADDITION)||"0";return(e=n.getVariableName(e.getFieldValue("VAR")))+" = (typeof "+e+" === 'number' ? "+e+" : 0) + "+r+";\n"},math_constant:function(e,n){return{PI:["Math.PI",t.MEMBER],E:["Math.E",t.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",t.DIVISION],SQRT2:["Math.SQRT2",t.MEMBER],SQRT1_2:["Math.SQRT1_2",t.MEMBER],INFINITY:["Infinity",t.ATOMIC]}[e.getFieldValue("CONSTANT")]},math_constrain:function(e,n){return["Math.min(Math.max("+(n.valueToCode(e,"VALUE",t.NONE)||"0")+", "+(n.valueToCode(e,"LOW",t.NONE)||"0")+"), "+(e=n.valueToCode(e,"HIGH",t.NONE)||"Infinity")+")",t.FUNCTION_CALL]},math_modulo:function(e,n){return[(n.valueToCode(e,"DIVIDEND",t.MODULUS)||"0")+" % "+(e=n.valueToCode(e,"DIVISOR",t.MODULUS)||"0"),t.MODULUS]},math_number:function(e,n){return e=Number(e.getFieldValue("NUM")),[String(e),0<=e?t.ATOMIC:t.UNARY_NEGATION]},math_number_property:function(e,n){var r={EVEN:[" % 2 === 0",t.MODULUS,t.EQUALITY],ODD:[" % 2 === 1",t.MODULUS,t.EQUALITY],WHOLE:[" % 1 === 0",t.MODULUS,t.EQUALITY],POSITIVE:[" > 0",t.RELATIONAL,t.RELATIONAL],NEGATIVE:[" < 0",t.RELATIONAL,t.RELATIONAL],DIVISIBLE_BY:[null,t.MODULUS,t.EQUALITY],PRIME:[null,t.NONE,t.FUNCTION_CALL]};const i=e.getFieldValue("PROPERTY"),[s,o,a]=r[i];return r=n.valueToCode(e,"NUMBER_TO_CHECK",o)||"0",[e="PRIME"===i?n.provideFunction_("mathIsPrime",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(n) {\n  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods\n  if (n == 2 || n == 3) {\n    return true;\n  }\n  // False if n is NaN, negative, is 1, or not whole.\n  // And false if n is divisible by 2 or 3.\n  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {\n    return false;\n  }\n  // Check all the numbers of form 6k +/- 1, up to sqrt(n).\n  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {\n    if (n % (x - 1) === 0 || n % (x + 1) === 0) {\n      return false;\n    }\n  }\n  return true;\n}\n`)+"("+r+")":"DIVISIBLE_BY"===i?r+" % "+(e=n.valueToCode(e,"DIVISOR",t.MODULUS)||"0")+" === 0":r+s,a]},math_on_list:function(e,n){var r=e.getFieldValue("OP");switch(r){case"SUM":e=n.valueToCode(e,"LIST",t.MEMBER)||"[]",e+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":e="Math.min.apply(null, "+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MAX":e="Math.max.apply(null, "+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"AVERAGE":e=(r=n.provideFunction_("mathMean",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(myList) {\n  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;\n}\n`))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MEDIAN":e=(r=n.provideFunction_("mathMedian",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(myList) {\n  var localList = myList.filter(function (x) {return typeof x === 'number';});\n  if (!localList.length) return null;\n  localList.sort(function(a, b) {return b - a;});\n  if (localList.length % 2 === 0) {\n    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;\n  } else {\n    return localList[(localList.length - 1) / 2];\n  }\n}\n`))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"MODE":e=(r=n.provideFunction_("mathModes",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(values) {\n  var modes = [];\n  var counts = [];\n  var maxCount = 0;\n  for (var i = 0; i < values.length; i++) {\n    var value = values[i];\n    var found = false;\n    var thisCount;\n    for (var j = 0; j < counts.length; j++) {\n      if (counts[j][0] === value) {\n        thisCount = ++counts[j][1];\n        found = true;\n        break;\n      }\n    }\n    if (!found) {\n      counts.push([value, 1]);\n      thisCount = 1;\n    }\n    maxCount = Math.max(thisCount, maxCount);\n  }\n  for (var j = 0; j < counts.length; j++) {\n    if (counts[j][1] === maxCount) {\n        modes.push(counts[j][0]);\n    }\n  }\n  return modes;\n}\n`))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"STD_DEV":e=(r=n.provideFunction_("mathStandardDeviation",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(numbers) {\n  var n = numbers.length;\n  if (!n) return null;\n  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;\n  var variance = 0;\n  for (var j = 0; j < n; j++) {\n    variance += Math.pow(numbers[j] - mean, 2);\n  }\n  variance = variance / n;\n  return Math.sqrt(variance);\n}\n`))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;case"RANDOM":e=(r=n.provideFunction_("mathRandomList",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(list) {\n  var x = Math.floor(Math.random() * list.length);\n  return list[x];\n}\n`))+"("+(e=n.valueToCode(e,"LIST",t.NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+r)}return[e,t.FUNCTION_CALL]},math_random_float:function(e,n){return["Math.random()",t.FUNCTION_CALL]},math_random_int:function(e,n){const r=n.valueToCode(e,"FROM",t.NONE)||"0";return e=n.valueToCode(e,"TO",t.NONE)||"0",[n.provideFunction_("mathRandomInt",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(a, b) {\n  if (a > b) {\n    // Swap a and b to ensure a is smaller.\n    var c = a;\n    a = b;\n    b = c;\n  }\n  return Math.floor(Math.random() * (b - a + 1) + a);\n}\n`)+"("+r+", "+e+")",t.FUNCTION_CALL]}};y.math_round=o,y.math_single=o,y.math_trig=o;var b={procedures_callnoreturn:function(e,t){return t.forBlock.procedures_callreturn(e,t)[0]+";\n"},procedures_callreturn:function(e,n){const r=n.getProcedureName(e.getFieldValue("NAME")),i=[],s=e.getVars();for(let r=0;r<s.length;r++)i[r]=n.valueToCode(e,"ARG"+r,t.NONE)||"null";return[r+"("+i.join(", ")+")",t.FUNCTION_CALL]}};b.procedures_defnoreturn=a,b.procedures_defreturn=a,b.procedures_ifreturn=function(e,n){let r="if ("+(n.valueToCode(e,"CONDITION",t.NONE)||"false")+") {\n";return n.STATEMENT_SUFFIX&&(r+=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,e),n.INDENT)),e.hasReturnValue_?(e=n.valueToCode(e,"VALUE",t.NONE)||"null",r+=n.INDENT+"return "+e+";\n"):r+=n.INDENT+"return;\n",r+"}\n"};var v=/^\s*'([^']|\\')*'\s*$/,T=function(e){return v.test(e)?[e,t.ATOMIC]:["String("+e+")",t.FUNCTION_CALL]},k=function(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n},E={text:function(e,n){return[n.quote_(e.getFieldValue("TEXT")),t.ATOMIC]},text_append:function(e,n){const r=n.getVariableName(e.getFieldValue("VAR"));return e=n.valueToCode(e,"TEXT",t.NONE)||"''",r+" += "+T(e)[0]+";\n"},text_changeCase:function(e,n){const r={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[e.getFieldValue("CASE")];return e=n.valueToCode(e,"TEXT",r?t.MEMBER:t.NONE)||"''",[r?e+r:n.provideFunction_("textToTitleCase",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(str) {\n  return str.replace(/\\S+/g,\n      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});\n}\n`)+"("+e+")",t.FUNCTION_CALL]},text_charAt:function(e,n){const r=e.getFieldValue("WHERE")||"FROM_START",i=n.valueToCode(e,"VALUE","RANDOM"===r?t.NONE:t.MEMBER)||"''";switch(r){case"FIRST":return[i+".charAt(0)",t.FUNCTION_CALL];case"LAST":return[i+".slice(-1)",t.FUNCTION_CALL];case"FROM_START":return[i+".charAt("+(e=n.getAdjusted(e,"AT"))+")",t.FUNCTION_CALL];case"FROM_END":return[i+".slice("+(e=n.getAdjusted(e,"AT",1,!0))+").charAt(0)",t.FUNCTION_CALL];case"RANDOM":return[n.provideFunction_("textRandomLetter",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(text) {\n  var x = Math.floor(Math.random() * text.length);\n  return text[x];\n}\n`)+"("+i+")",t.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},text_count:function(e,n){const r=n.valueToCode(e,"TEXT",t.NONE)||"''";return e=n.valueToCode(e,"SUB",t.NONE)||"''",[n.provideFunction_("textCount",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {\n  if (needle.length === 0) {\n    return haystack.length + 1;\n  } else {\n    return haystack.split(needle).length - 1;\n  }\n}\n`)+"("+r+", "+e+")",t.FUNCTION_CALL]},text_getSubstring:function(e,n){var r={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};const i=e.getFieldValue("WHERE1"),s=e.getFieldValue("WHERE2");var o="FROM_END"!==i&&"LAST"!==i&&"FROM_END"!==s&&"LAST"!==s,a=n.valueToCode(e,"STRING",o?t.MEMBER:t.NONE)||"''";if("FIRST"===i&&"LAST"===s)return[a,t.NONE];if(a.match(/^'?\w+'?$/)||o){switch(i){case"FROM_START":r=n.getAdjusted(e,"AT1");break;case"FROM_END":r=a+".length - "+(r=n.getAdjusted(e,"AT1",1,!1,t.SUBTRACTION));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(s){case"FROM_START":n=n.getAdjusted(e,"AT2",1);break;case"FROM_END":n=a+".length - "+(n=n.getAdjusted(e,"AT2",0,!1,t.SUBTRACTION));break;case"LAST":n=a+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}a=a+".slice("+r+", "+n+")"}else o=n.getAdjusted(e,"AT1"),e=n.getAdjusted(e,"AT2"),a=n.provideFunction_("subsequence"+r[i]+r[s],`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(sequence${"FROM_END"===i||"FROM_START"===i?", at1":""}${"FROM_END"===s||"FROM_START"===s?", at2":""}) {\n  var start = ${k("sequence",i,"at1")};\n  var end = ${k("sequence",s,"at2")} + 1;\n  return sequence.slice(start, end);\n}\n`)+"("+a+("FROM_END"===i||"FROM_START"===i?", "+o:"")+("FROM_END"===s||"FROM_START"===s?", "+e:"")+")";return[a,t.FUNCTION_CALL]},text_indexOf:function(e,n){const r="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.valueToCode(e,"FIND",t.NONE)||"''";return n=(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+"."+r+"("+i+")",e.workspace.options.oneBasedIndex?[n+" + 1",t.ADDITION]:[n,t.FUNCTION_CALL]},text_isEmpty:function(e,n){return["!"+(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+".length",t.LOGICAL_NOT]},text_join:function(e,n){switch(e.itemCount_){case 0:return["''",t.ATOMIC];case 1:return e=n.valueToCode(e,"ADD0",t.NONE)||"''",T(e);case 2:var r=n.valueToCode(e,"ADD0",t.NONE)||"''";return e=n.valueToCode(e,"ADD1",t.NONE)||"''",[T(r)[0]+" + "+T(e)[0],t.ADDITION];default:r=Array(e.itemCount_);for(let i=0;i<e.itemCount_;i++)r[i]=n.valueToCode(e,"ADD"+i,t.NONE)||"''";return["["+r.join(",")+"].join('')",t.FUNCTION_CALL]}},text_length:function(e,n){return[(n.valueToCode(e,"VALUE",t.MEMBER)||"''")+".length",t.MEMBER]},text_multiline:function(e,n){return e=n.multiline_quote_(e.getFieldValue("TEXT")),n=-1!==e.indexOf("+")?t.ADDITION:t.ATOMIC,[e,n]},text_print:function(e,n){return"window.alert("+(n.valueToCode(e,"TEXT",t.NONE)||"''")+");\n"}};E.text_prompt=l,E.text_prompt_ext=l,E.text_replace=function(e,n){const r=n.valueToCode(e,"TEXT",t.NONE)||"''",i=n.valueToCode(e,"FROM",t.NONE)||"''";return e=n.valueToCode(e,"TO",t.NONE)||"''",[n.provideFunction_("textReplace",`\nfunction ${n.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {\n  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')\n                 .replace(/\\x08/g, '\\\\x08');\n  return haystack.replace(new RegExp(needle, 'g'), replacement);\n}\n`)+"("+r+", "+i+", "+e+")",t.FUNCTION_CALL]},E.text_reverse=function(e,n){return[(n.valueToCode(e,"TEXT",t.MEMBER)||"''")+".split('').reverse().join('')",t.FUNCTION_CALL]},E.text_trim=function(e,n){const r={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[e.getFieldValue("MODE")];return[(n.valueToCode(e,"TEXT",t.MEMBER)||"''")+r,t.FUNCTION_CALL]};var x={};x.variables_get=c,x.variables_set=u;var S={};S.variables_get_dynamic=c,S.variables_set_dynamic=u;var C=new d,I=Object.assign({},h,m,_,g,y,b,E,x,S);for(const e in I)C.forBlock[e]=I[e];var A={};return A.JavascriptGenerator=d,A.Order=t,A.javascriptGenerator=C,A.__namespace__=r,A}))},{"./blockly_compressed.js":149}],157:[function(e,t,n){!function(e,r){if("function"==typeof define&&define.amd)define([],r);else if("object"==typeof n)t.exports=r();else{var i=r();for(var s in i)e.Blockly.Msg[s]=i[s]}}(this,(function(){var e=e||{Msg:Object.create(null)};return e.Msg.ADD_COMMENT="Add Comment",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1  %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg}))},{}]},{},[143]);